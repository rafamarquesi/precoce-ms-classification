
*****INICIO LOAD DATA******

*****INICIO PRINT INFOS******
Número total de linhas do DataFrame: 49641
Número de colunas: 25
Informações do DataFrame:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 49641 entries, 0 to 49640
Data columns (total 25 columns):
 #   Column                            Non-Null Count  Dtype         
---  ------                            --------------  -----         
 0   DataAbate                         49641 non-null  datetime64[ns]
 1   EstabelecimentoIdentificador      49641 non-null  uint16        
 2   Tipificacao                       49641 non-null  category      
 3   QTD_ANIMAIS_LOTE                  49641 non-null  uint16        
 4   Peso                              49641 non-null  float32       
 5   QuestionarioClassificacaoEstabel  49641 non-null  uint8         
 6   ILP                               49641 non-null  uint8         
 7   IFP                               49641 non-null  uint8         
 8   ILPF                              49641 non-null  uint8         
 9   QuestionarioPossuiOutrosIncentiv  49641 non-null  uint8         
 10  QuestionarioFabricaRacao          49641 non-null  uint8         
 11  regua de manejo                   49633 non-null  UInt8         
 12  identificacao individual          49633 non-null  UInt8         
 13  rastreamento SISBOV               49631 non-null  UInt8         
 14  participa de aliancas mercadolog  49633 non-null  UInt8         
 15  QuestionarioPraticaRecuperacaoPa  49641 non-null  uint8         
 16  Confinamento                      49633 non-null  UInt8         
 17  Suplementacao_a_campo             49633 non-null  UInt8         
 18  SemiConfinamento                  49633 non-null  UInt8         
 19  tot3m_Chuva                       48290 non-null  float32       
 20  med3m_formITUinst                 49629 non-null  float32       
 21  med3m_NDVI                        48081 non-null  float32       
 22  med3m_preR_milho                  49629 non-null  float32       
 23  med3m_preR_boi                    49629 non-null  float32       
 24  CATEGORIA_BINARIA                 49641 non-null  category      
dtypes: UInt8(7), category(2), datetime64[ns](1), float32(6), uint16(2), uint8(7)
memory usage: 2.8 MB
*****FIM PRINT INFOS*********
Function informations Took 0:00:00.009014

*****INICIO DELETE COLUNAS******
!!!>>> Coluna " EstabelecimentoMunicipio " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Frigorifico_ID " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Frigorifico_CNPJ " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Frigorifico_RazaoSocial " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Municipio_Frigorifico " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Maturidade " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Acabamento " não encontrada no DataFrame para exclusão.
Coluna EstabelecimentoIdentificador excluída.
!!!>>> Coluna " Questionario_ID " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " FERTIIRRIGACAO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " CONCEN_VOLUM " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " CREEPFEEDING " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " FORN_ESTRAT_SILAGEM " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " PROTEICO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " PROTEICO_ENERGETICO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " RACAO_BAL_CONS_INFERIOR " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " SAL_MINERAL " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " SALMINERAL_UREIA " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " RACAOO_BAL_CONSUMO_IG " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " GRAO_INTEIRO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " ALTO_CONCENTR_VOLUM " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " ALTO_CONCENTRADO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " area so confinamento " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " boa cobertura vegetal, com baixa " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " erosaoo laminar ou em sulco igua " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Lista Trace " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " BPA " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " dif_datas " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " tot7d_Chuva " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_TempInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_TempMin " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_UmidInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_formITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_formITUmax " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_NDVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_EVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_preR_soja " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_preR_milho " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med7d_preR_boi " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " tot1m_Chuva " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_TempInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_UmidInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_formITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_NDVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_EVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_preR_soja " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_preR_milho " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med1m_preR_boi " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med3m_TempInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med3m_UmidInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med3m_formITUmax " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med3m_EVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med3m_preR_soja " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " tot6m_Chuva " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_TempInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_UmidInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_formITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_NDVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_EVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_preR_soja " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_preR_milho " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med6m_preR_boi " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " tot12m_Chuva " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_TempInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_TempMin " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_UmidInst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_formITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_NDVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_EVI " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_preR_soja " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_preR_milho " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " med12m_preR_boi " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " cnt7d_CL_ITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " cnt1m_CL_ITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " cnt3m_CL_ITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " cnt6m_CL_ITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " cnt12m_CL_ITUinst " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " ANO " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " Motivo " não encontrada no DataFrame para exclusão.
Coluna DataAbate excluída.
!!!>>> Coluna " Data_homol " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " DataAbate_6m_ANT " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data_homol_select " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data12m " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data6m " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data3m " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data1m " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " data7d " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " classificacao " não encontrada no DataFrame para exclusão.
!!!>>> Coluna " CATEGORIA " não encontrada no DataFrame para exclusão.
*****FIM DELETE COLUNAS*********

*****INICIO PRINT INFOS******
Número total de linhas do DataFrame: 49641
Número de colunas: 23
Informações do DataFrame:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 49641 entries, 0 to 49640
Data columns (total 23 columns):
 #   Column                            Non-Null Count  Dtype   
---  ------                            --------------  -----   
 0   Tipificacao                       49641 non-null  category
 1   QTD_ANIMAIS_LOTE                  49641 non-null  uint16  
 2   Peso                              49641 non-null  float32 
 3   QuestionarioClassificacaoEstabel  49641 non-null  uint8   
 4   ILP                               49641 non-null  uint8   
 5   IFP                               49641 non-null  uint8   
 6   ILPF                              49641 non-null  uint8   
 7   QuestionarioPossuiOutrosIncentiv  49641 non-null  uint8   
 8   QuestionarioFabricaRacao          49641 non-null  uint8   
 9   regua de manejo                   49633 non-null  UInt8   
 10  identificacao individual          49633 non-null  UInt8   
 11  rastreamento SISBOV               49631 non-null  UInt8   
 12  participa de aliancas mercadolog  49633 non-null  UInt8   
 13  QuestionarioPraticaRecuperacaoPa  49641 non-null  uint8   
 14  Confinamento                      49633 non-null  UInt8   
 15  Suplementacao_a_campo             49633 non-null  UInt8   
 16  SemiConfinamento                  49633 non-null  UInt8   
 17  tot3m_Chuva                       48290 non-null  float32 
 18  med3m_formITUinst                 49629 non-null  float32 
 19  med3m_NDVI                        48081 non-null  float32 
 20  med3m_preR_milho                  49629 non-null  float32 
 21  med3m_preR_boi                    49629 non-null  float32 
 22  CATEGORIA_BINARIA                 49641 non-null  category
dtypes: UInt8(7), category(2), float32(6), uint16(1), uint8(7)
memory usage: 2.3 MB
*****FIM PRINT INFOS*********
Function informations Took 0:00:00.006459

*****FIM LOAD DATA******
Function load_data Took 0:00:00.408040

*****INICIO SHOW SETTINGS******
os = <module 'os' from '/usr/local/lib/python3.8/os.py'>
pd = <module 'pandas' from '/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pandas/__init__.py'>
torch = <module 'torch' from '/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/torch/__init__.py'>
PANDAS_MAX_ROWS = 5000
random_seed = 42
n_jobs = 1
dataset_folder_path = /home/externo/rafaelrm/base_dados/
csv_path = /home/externo/rafaelrm/base_dados/TAB_MODELAGEM_RAFAEL_2020_1-ANIMAIS-POR-LOTE-CATEGORIA_BINARIA.csv
number_csv_lines = None
dtype_dict = {'ID_ANIMAL': 'uint32', 'EstabelecimentoMunicipio': 'category', 'Frigorifico_ID': 'uint8', 'Frigorifico_CNPJ': 'uint64', 'Frigorifico_RazaoSocial': 'category', 'Municipio_Frigorifico': 'category', 'Tipificacao': 'category', 'Maturidade': 'category', 'Acabamento': 'category', 'Peso': 'float32', 'EstabelecimentoIdentificador': 'uint16', 'Questionario_ID': 'uint16', 'QuestionarioClassificacaoEstabel': 'uint8', 'FERTIIRRIGACAO': 'uint8', 'ILP': 'uint8', 'IFP': 'uint8', 'ILPF': 'uint8', 'CONCEN_VOLUM': 'UInt8', 'CREEPFEEDING': 'UInt8', 'FORN_ESTRAT_SILAGEM': 'UInt8', 'PROTEICO': 'UInt8', 'PROTEICO_ENERGETICO': 'UInt8', 'RACAO_BAL_CONS_INFERIOR': 'UInt8', 'SAL_MINERAL': 'UInt8', 'SALMINERAL_UREIA': 'UInt8', 'RACAOO_BAL_CONSUMO_IG': 'UInt8', 'GRAO_INTEIRO': 'UInt8', 'ALTO_CONCENTR_VOLUM': 'UInt8', 'ALTO_CONCENTRADO': 'UInt8', 'QuestionarioPossuiOutrosIncentiv': 'uint8', 'QuestionarioFabricaRacao': 'uint8', 'area so confinamento': 'UInt8', 'regua de manejo': 'UInt8', 'boa cobertura vegetal, com baixa': 'UInt8', 'erosaoo laminar ou em sulco igua': 'UInt8', 'identificacao individual': 'UInt8', 'rastreamento SISBOV': 'UInt8', 'Lista Trace': 'UInt8', 'BPA': 'UInt8', 'participa de aliancas mercadolog': 'UInt8', 'QuestionarioPraticaRecuperacaoPa': 'uint8', 'Confinamento': 'UInt8', 'Suplementacao_a_campo': 'UInt8', 'SemiConfinamento': 'UInt8', 'dif_datas': 'uint16', 'tot7d_Chuva': 'float32', 'med7d_TempInst': 'float32', 'med7d_TempMin': 'float32', 'med7d_UmidInst': 'float32', 'med7d_formITUinst': 'float32', 'med7d_formITUmax': 'float32', 'med7d_NDVI': 'float32', 'med7d_EVI': 'float32', 'med7d_preR_soja': 'float32', 'med7d_preR_milho': 'float32', 'med7d_preR_boi': 'float32', 'tot1m_Chuva': 'float32', 'med1m_TempInst': 'float32', 'med1m_UmidInst': 'float32', 'med1m_formITUinst': 'float32', 'med1m_NDVI': 'float32', 'med1m_EVI': 'float32', 'med1m_preR_soja': 'float32', 'med1m_preR_milho': 'float32', 'med1m_preR_boi': 'float32', 'tot3m_Chuva': 'float32', 'med3m_TempInst': 'float32', 'med3m_UmidInst': 'float32', 'med3m_formITUinst': 'float32', 'med3m_formITUmax': 'float32', 'med3m_NDVI': 'float32', 'med3m_EVI': 'float32', 'med3m_preR_soja': 'float32', 'med3m_preR_milho': 'float32', 'med3m_preR_boi': 'float32', 'tot6m_Chuva': 'float32', 'med6m_TempInst': 'float32', 'med6m_UmidInst': 'float32', 'med6m_formITUinst': 'float32', 'med6m_NDVI': 'float32', 'med6m_EVI': 'float32', 'med6m_preR_soja': 'float32', 'med6m_preR_milho': 'float32', 'med6m_preR_boi': 'float32', 'tot12m_Chuva': 'float32', 'med12m_TempInst': 'float32', 'med12m_TempMin': 'float32', 'med12m_UmidInst': 'float32', 'med12m_formITUinst': 'float32', 'med12m_NDVI': 'float32', 'med12m_EVI': 'float32', 'med12m_preR_soja': 'float32', 'med12m_preR_milho': 'float32', 'med12m_preR_boi': 'float32', 'cnt7d_CL_ITUinst': 'float32', 'cnt1m_CL_ITUinst': 'float32', 'cnt3m_CL_ITUinst': 'float32', 'cnt6m_CL_ITUinst': 'float32', 'cnt12m_CL_ITUinst': 'float32', 'ANO': 'uint16', 'CATEGORIA': 'category', 'classificacao': 'category', 'Motivo': 'category', 'QTD_ANIMAIS_LOTE': 'uint16', 'CATEGORIA_BINARIA': 'category'}
parse_dates = ['DataAbate']
delete_columns_names_on_load_data = ['EstabelecimentoMunicipio', 'Frigorifico_ID', 'Frigorifico_CNPJ', 'Frigorifico_RazaoSocial', 'Municipio_Frigorifico', 'Maturidade', 'Acabamento', 'EstabelecimentoIdentificador', 'Questionario_ID', 'FERTIIRRIGACAO', 'CONCEN_VOLUM', 'CREEPFEEDING', 'FORN_ESTRAT_SILAGEM', 'PROTEICO', 'PROTEICO_ENERGETICO', 'RACAO_BAL_CONS_INFERIOR', 'SAL_MINERAL', 'SALMINERAL_UREIA', 'RACAOO_BAL_CONSUMO_IG', 'GRAO_INTEIRO', 'ALTO_CONCENTR_VOLUM', 'ALTO_CONCENTRADO', 'area so confinamento', 'boa cobertura vegetal, com baixa', 'erosaoo laminar ou em sulco igua', 'Lista Trace', 'BPA', 'dif_datas', 'tot7d_Chuva', 'med7d_TempInst', 'med7d_TempMin', 'med7d_UmidInst', 'med7d_formITUinst', 'med7d_formITUmax', 'med7d_NDVI', 'med7d_EVI', 'med7d_preR_soja', 'med7d_preR_milho', 'med7d_preR_boi', 'tot1m_Chuva', 'med1m_TempInst', 'med1m_UmidInst', 'med1m_formITUinst', 'med1m_NDVI', 'med1m_EVI', 'med1m_preR_soja', 'med1m_preR_milho', 'med1m_preR_boi', 'med3m_TempInst', 'med3m_UmidInst', 'med3m_formITUmax', 'med3m_EVI', 'med3m_preR_soja', 'tot6m_Chuva', 'med6m_TempInst', 'med6m_UmidInst', 'med6m_formITUinst', 'med6m_NDVI', 'med6m_EVI', 'med6m_preR_soja', 'med6m_preR_milho', 'med6m_preR_boi', 'tot12m_Chuva', 'med12m_TempInst', 'med12m_TempMin', 'med12m_UmidInst', 'med12m_formITUinst', 'med12m_NDVI', 'med12m_EVI', 'med12m_preR_soja', 'med12m_preR_milho', 'med12m_preR_boi', 'cnt7d_CL_ITUinst', 'cnt1m_CL_ITUinst', 'cnt3m_CL_ITUinst', 'cnt6m_CL_ITUinst', 'cnt12m_CL_ITUinst', 'ANO', 'Motivo', 'DataAbate', 'Data_homol', 'DataAbate_6m_ANT', 'data_homol_select', 'data12m', 'data6m', 'data3m', 'data1m', 'data7d', 'classificacao', 'CATEGORIA']
PATH_SAVE_PLOTS = ./plots
PATH_SAVE_ESTIMATORS_REPR = ./runs/estimators_repr
PATH_SAVE_BEST_ESTIMATORS = ./runs/best_estimators
PATH_SAVE_RESULTS = ./runs/results
PATH_SAVE_LOGS = ./logs
PATH_SAVE_ENCODERS_SCALERS = ./runs/encoders_scalers
ordinal_encoder_columns_names = {'QuestionarioClassificacaoEstabel': ['0', '21', '26', '30']}
columns_ordinal_encoded = {}
label_encoder_columns_names = ['CATEGORIA_BINARIA']
columns_label_encoded = {}
one_hot_encoder_columns_names = ['Tipificacao']
columns_one_hot_encoded = {}
min_max_scaler_columns_names = ['QTD_ANIMAIS_LOTE', 'Peso', 'tot3m_Chuva', 'med3m_formITUinst', 'med3m_NDVI', 'med3m_preR_milho', 'med3m_preR_boi']
columns_min_max_scaled = {}
columns_label_binarized = {}
simple_imputer_columns_names = ['rastreamento SISBOV', 'regua de manejo', 'identificacao individual', 'participa de aliancas mercadolog', 'Confinamento', 'Suplementacao_a_campo', 'SemiConfinamento']
columns_names_drop_feature_by_correlation = ['med3m_formITUinst', 'med3m_preR_boi', 'CATEGORIA_BINARIA']
class_column = CATEGORIA_BINARIA
classifiers = {}
models_results = {}
device_name = auto
use_embeddings = True
cat_idxs = []
cat_dims = []
use_cat_emb_dim = True
cat_emb_dim = 1
threshold_categorical_features = 150
num_workers = 0
eval_metric = ['auc', 'balanced_accuracy', 'accuracy']
augmentations = None
save_results_during_run = True
new_run = True
PATH_OBJECTS_PERSISTED_RESULTS_RUNS = ./runs/objects_persisted_results_runs
PARAMETERS_PERSIST_FILENAME = ./runs/objects_persisted_results_runs/parameters_persist
RESULTS_PERSIST_FILENAME = ./runs/objects_persisted_results_runs/results_persist
SPLIT_PERSIST_FILENAME = ./runs/objects_persisted_results_runs/split_persist
tree_method = hist
objective = binary:logistic
*****FIM SHOW SETTINGS******


*****INICIO DELETE DUPLICATE ROWS BY ATTRIBUTE******
!!!>>> Atributo ID_ANIMAL não encontrado no DataFrame para delete duplicates rows by attibute.
*****FIM DELETE DUPLICATE ROWS BY ATTRIBUTE*********
Function delete_duplicate_rows_by_attribute Took 0:00:00.000053

*****INICIO DELETE COLUNAS******
!!!>>> Coluna " ID_ANIMAL " não encontrada no DataFrame para exclusão.
*****FIM DELETE COLUNAS*********

*****INICIO DELETE COLUMNS WITH SINGLE VALUE******
>>> Nenhuma coluna com valor único encontrada.
*****FIM DELETE COLUMNS WITH SINGLE VALUE*********
Function delete_columns_with_single_value Took 0:00:00.021890


*****INICIO LABEL ENCODER******
*****FIM LABEL ENCODER*********
Function label_encoder_columns Took 0:00:00.008833

Object saved in file: ./runs/encoders_scalers/target_encoded-17-02-2023_15:04:11.joblib

*****INICIO RELATÓRIO DISTRIBUIÇÃO DE CLASSES******
Distribuição da classe 1: 50%
Distribuição da classe 0: 50%
Erro majoritário: 50%
*****FIM RELATÓRIO DISTRIBUIÇÃO DE CLASSES******
Function class_distribution Took 0:00:00.001706

/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
Number of folds for cross validation: 5
Scoring strategy for grid search: accuracy
Test Size: 0.2

x_train shape: (39712, 22)
y_train shape: (39712,)
x_test shape: (9929, 22)
y_test shape: (9929,)
Removing all files in directory: ./runs/objects_persisted_results_runs
Do you want to continue? (y/n): 
All files in directory ./runs/objects_persisted_results_runs were removed.
Fitting 5 folds for each of 69 candidates, totalling 345 fits
[CV 1/5; 1/69] START classifier__estimator=GaussianNB().........................
[CV 1/5; 1/69] END classifier__estimator=GaussianNB();, score=0.636 total time=   2.2s
[CV 2/5; 1/69] START classifier__estimator=GaussianNB().........................
[CV 2/5; 1/69] END classifier__estimator=GaussianNB();, score=0.638 total time=   1.5s
[CV 3/5; 1/69] START classifier__estimator=GaussianNB().........................
[CV 3/5; 1/69] END classifier__estimator=GaussianNB();, score=0.625 total time=   1.4s
[CV 4/5; 1/69] START classifier__estimator=GaussianNB().........................
[CV 4/5; 1/69] END classifier__estimator=GaussianNB();, score=0.631 total time=   1.5s
[CV 5/5; 1/69] START classifier__estimator=GaussianNB().........................
[CV 5/5; 1/69] END classifier__estimator=GaussianNB();, score=0.640 total time=   0.3s
[CV 1/5; 2/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 1/5; 2/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.709 total time=   1.4s
[CV 2/5; 2/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 2/5; 2/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.699 total time=   1.1s
[CV 3/5; 2/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 3/5; 2/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.696 total time=   0.9s
[CV 4/5; 2/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 4/5; 2/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.695 total time=   1.0s
[CV 5/5; 2/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 5/5; 2/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.702 total time=   1.1s
[CV 1/5; 3/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 1/5; 3/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.698 total time=   1.1s
[CV 2/5; 3/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 2/5; 3/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.693 total time=   1.0s
[CV 3/5; 3/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 3/5; 3/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.695 total time=   1.1s
[CV 4/5; 3/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 4/5; 3/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.702 total time=   1.0s
[CV 5/5; 3/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 5/5; 3/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.697 total time=   1.0s
[CV 1/5; 4/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 1/5; 4/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.699 total time=   1.1s
[CV 2/5; 4/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 2/5; 4/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.693 total time=   1.1s
[CV 3/5; 4/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 3/5; 4/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.694 total time=   1.1s
[CV 4/5; 4/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 4/5; 4/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.701 total time=   1.1s
[CV 5/5; 4/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 5/5; 4/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.701 total time=   0.9s
[CV 1/5; 5/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 1/5; 5/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.698 total time=   1.1s
[CV 2/5; 5/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 2/5; 5/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.685 total time=   1.1s
[CV 3/5; 5/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 3/5; 5/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.695 total time=   1.1s
[CV 4/5; 5/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 4/5; 5/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.695 total time=   1.1s
[CV 5/5; 5/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 5/5; 5/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=minkowski, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.700 total time=   1.1s
[CV 1/5; 6/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 1/5; 6/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.709 total time=   1.0s
[CV 2/5; 6/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 2/5; 6/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.699 total time=   0.9s
[CV 3/5; 6/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 3/5; 6/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.696 total time=   1.1s
[CV 4/5; 6/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 4/5; 6/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.695 total time=   1.1s
[CV 5/5; 6/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5
[CV 5/5; 6/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=5;, score=0.702 total time=   1.0s
[CV 1/5; 7/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 1/5; 7/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.698 total time=   0.9s
[CV 2/5; 7/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 2/5; 7/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.693 total time=   0.9s
[CV 3/5; 7/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 3/5; 7/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.695 total time=   0.9s
[CV 4/5; 7/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 4/5; 7/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.702 total time=   1.0s
[CV 5/5; 7/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8
[CV 5/5; 7/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=8;, score=0.697 total time=   0.9s
[CV 1/5; 8/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 1/5; 8/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.699 total time=   1.1s
[CV 2/5; 8/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 2/5; 8/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.693 total time=   1.1s
[CV 3/5; 8/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 3/5; 8/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.694 total time=   1.1s
[CV 4/5; 8/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 4/5; 8/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.701 total time=   0.9s
[CV 5/5; 8/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11
[CV 5/5; 8/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=11;, score=0.701 total time=   1.1s
[CV 1/5; 9/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 1/5; 9/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.698 total time=   1.0s
[CV 2/5; 9/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 2/5; 9/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.685 total time=   1.0s
[CV 3/5; 9/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 3/5; 9/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.695 total time=   1.1s
[CV 4/5; 9/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 4/5; 9/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.695 total time=   1.1s
[CV 5/5; 9/69] START classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14
[CV 5/5; 9/69] END classifier__estimator=KNeighborsClassifier(), classifier__estimator__algorithm=kd_tree, classifier__estimator__metric=euclidean, classifier__estimator__n_jobs=-1, classifier__estimator__n_neighbors=14;, score=0.700 total time=   1.0s
[CV 1/5; 10/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 10/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 2/5; 10/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 10/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 3/5; 10/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 10/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 4/5; 10/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 10/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 5/5; 10/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 10/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 1/5; 11/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 11/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.641 total time=   0.7s
[CV 2/5; 11/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 11/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.631 total time=   0.6s
[CV 3/5; 11/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 11/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.643 total time=   0.5s
[CV 4/5; 11/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 11/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.641 total time=   0.5s
[CV 5/5; 11/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 11/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.630 total time=   0.5s
[CV 1/5; 12/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 12/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.661 total time=   0.5s
[CV 2/5; 12/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 12/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.659 total time=   0.4s
[CV 3/5; 12/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 12/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.672 total time=   0.4s
[CV 4/5; 12/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 12/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.659 total time=   0.5s
[CV 5/5; 12/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 12/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.653 total time=   0.5s
[CV 1/5; 13/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 13/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.677 total time=   0.4s
[CV 2/5; 13/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 13/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.675 total time=   0.4s
[CV 3/5; 13/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 13/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.681 total time=   0.4s
[CV 4/5; 13/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 13/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.670 total time=   0.4s
[CV 5/5; 13/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 13/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=gini, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.665 total time=   0.6s
[CV 1/5; 14/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 14/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 2/5; 14/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 14/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 3/5; 14/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 14/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 4/5; 14/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 14/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 5/5; 14/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 14/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=1, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=nan total time=   0.1s
[CV 1/5; 15/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 15/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.642 total time=   0.8s
[CV 2/5; 15/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 15/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.644 total time=   0.6s
[CV 3/5; 15/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 15/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.647 total time=   0.6s
[CV 4/5; 15/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 15/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.644 total time=   0.8s
[CV 5/5; 15/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 15/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=2, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.647 total time=   0.6s
[CV 1/5; 16/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 16/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.665 total time=   0.5s
[CV 2/5; 16/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 16/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.663 total time=   0.5s
[CV 3/5; 16/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 16/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.671 total time=   0.5s
[CV 4/5; 16/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 16/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.658 total time=   0.5s
[CV 5/5; 16/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 16/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=50, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.660 total time=   0.5s
[CV 1/5; 17/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 1/5; 17/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.676 total time=   0.5s
[CV 2/5; 17/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 2/5; 17/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.678 total time=   0.5s
[CV 3/5; 17/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 3/5; 17/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.678 total time=   0.5s
[CV 4/5; 17/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 4/5; 17/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.668 total time=   0.5s
[CV 5/5; 17/69] START classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best
[CV 5/5; 17/69] END classifier__estimator=DecisionTreeClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__min_samples_split=100, classifier__estimator__random_state=42, classifier__estimator__splitter=best;, score=0.665 total time=   0.5s
[CV 1/5; 18/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 1/5; 18/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.671 total time=   0.2s
[CV 2/5; 18/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 2/5; 18/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.662 total time=   0.2s
[CV 3/5; 18/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 3/5; 18/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.667 total time=   0.2s
[CV 4/5; 18/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 4/5; 18/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.664 total time=   0.2s
[CV 5/5; 18/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 5/5; 18/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.663 total time=   0.2s
[CV 1/5; 19/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 1/5; 19/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.670 total time=   0.2s
[CV 2/5; 19/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 2/5; 19/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.2s
[CV 3/5; 19/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 3/5; 19/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.661 total time=   0.2s
[CV 4/5; 19/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 4/5; 19/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.2s
[CV 5/5; 19/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 5/5; 19/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0010004043579101562, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.662 total time=   0.2s
[CV 1/5; 20/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 1/5; 20/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.673 total time=   0.3s
[CV 2/5; 20/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 2/5; 20/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.662 total time=   0.4s
[CV 3/5; 20/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 3/5; 20/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.664 total time=   0.4s
[CV 4/5; 20/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 4/5; 20/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.664 total time=   0.3s
[CV 5/5; 20/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 5/5; 20/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.666 total time=   0.3s
[CV 1/5; 21/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 1/5; 21/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.671 total time=   0.2s
[CV 2/5; 21/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 2/5; 21/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.662 total time=   0.2s
[CV 3/5; 21/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 3/5; 21/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.2s
[CV 4/5; 21/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 4/5; 21/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.665 total time=   0.2s
[CV 5/5; 21/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 5/5; 21/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.01000213623046875, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.663 total time=   0.2s
[CV 1/5; 22/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 1/5; 22/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.671 total time=   0.4s
[CV 2/5; 22/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 2/5; 22/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.662 total time=   0.4s
[CV 3/5; 22/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 3/5; 22/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.665 total time=   0.5s
[CV 4/5; 22/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 4/5; 22/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.665 total time=   0.3s
[CV 5/5; 22/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 5/5; 22/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.664 total time=   0.3s
[CV 1/5; 23/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 1/5; 23/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.670 total time=   0.3s
[CV 2/5; 23/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 2/5; 23/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.662 total time=   0.3s
[CV 3/5; 23/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 3/5; 23/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.3s
[CV 4/5; 23/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 4/5; 23/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.665 total time=   0.3s
[CV 5/5; 23/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 5/5; 23/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=0.0999755859375, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.3s
[CV 1/5; 24/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 1/5; 24/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.671 total time=   0.5s
[CV 2/5; 24/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 2/5; 24/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.662 total time=   0.5s
[CV 3/5; 24/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 3/5; 24/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.664 total time=   0.6s
[CV 4/5; 24/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 4/5; 24/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.666 total time=   0.5s
[CV 5/5; 24/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42
[CV 5/5; 24/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l1, classifier__estimator__random_state=42;, score=0.665 total time=   0.5s
[CV 1/5; 25/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 1/5; 25/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.670 total time=   0.3s
[CV 2/5; 25/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 2/5; 25/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.661 total time=   0.3s
[CV 3/5; 25/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 3/5; 25/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.664 total time=   0.3s
[CV 4/5; 25/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 4/5; 25/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.666 total time=   0.3s
[CV 5/5; 25/69] START classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42
[CV 5/5; 25/69] END classifier__estimator=LinearSVC(), classifier__estimator__C=1.0, classifier__estimator__dual=False, classifier__estimator__penalty=l2, classifier__estimator__random_state=42;, score=0.665 total time=   0.3s
[CV 1/5; 26/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 1/5; 26/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.669 total time=   4.9s
[CV 2/5; 26/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 2/5; 26/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.664 total time=   8.0s
[CV 3/5; 26/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 3/5; 26/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.662 total time=   5.6s
[CV 4/5; 26/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 4/5; 26/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.665 total time=   9.6s
[CV 5/5; 26/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 5/5; 26/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.663 total time=   7.1s
[CV 1/5; 27/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 1/5; 27/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.671 total time=   5.8s
[CV 2/5; 27/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 2/5; 27/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.662 total time=   2.2s
[CV 3/5; 27/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 3/5; 27/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.666 total time=   4.2s
[CV 4/5; 27/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 4/5; 27/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.666 total time=   2.1s
[CV 5/5; 27/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 5/5; 27/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.665 total time=   3.4s
[CV 1/5; 28/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 1/5; 28/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.672 total time=  20.1s
[CV 2/5; 28/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 2/5; 28/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.665 total time=  11.1s
[CV 3/5; 28/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 3/5; 28/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.662 total time=  14.1s
[CV 4/5; 28/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 4/5; 28/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.667 total time=   7.2s
[CV 5/5; 28/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 5/5; 28/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=logistic, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.664 total time=   8.2s
[CV 1/5; 29/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 1/5; 29/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.704 total time=  12.4s
[CV 2/5; 29/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 2/5; 29/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.706 total time=  17.3s
[CV 3/5; 29/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 3/5; 29/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.695 total time=  10.0s
[CV 4/5; 29/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 4/5; 29/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.703 total time=  16.4s
[CV 5/5; 29/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000
[CV 5/5; 29/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(50, 100, 50), classifier__estimator__max_iter=1000;, score=0.701 total time=  17.5s
[CV 1/5; 30/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 1/5; 30/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.683 total time=   3.7s
[CV 2/5; 30/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 2/5; 30/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.679 total time=   3.9s
[CV 3/5; 30/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 3/5; 30/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.691 total time=   7.5s
[CV 4/5; 30/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 4/5; 30/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.697 total time=  11.2s
[CV 5/5; 30/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000
[CV 5/5; 30/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(100,), classifier__estimator__max_iter=1000;, score=0.689 total time=   5.6s
[CV 1/5; 31/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 1/5; 31/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.709 total time=  24.9s
[CV 2/5; 31/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 2/5; 31/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.700 total time=  21.1s
[CV 3/5; 31/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 3/5; 31/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.701 total time=  18.3s
[CV 4/5; 31/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 4/5; 31/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.689 total time=  10.7s
[CV 5/5; 31/69] START classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000
[CV 5/5; 31/69] END classifier__estimator=MLPClassifier(), classifier__estimator__activation=relu, classifier__estimator__early_stopping=True, classifier__estimator__hidden_layer_sizes=(200, 100), classifier__estimator__max_iter=1000;, score=0.719 total time=  28.2s
[CV 1/5; 32/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 32/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.737 total time=   1.0s
[CV 2/5; 32/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 32/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.730 total time=   1.1s
[CV 3/5; 32/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 32/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.735 total time=   1.0s
[CV 4/5; 32/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 32/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.733 total time=   1.2s
[CV 5/5; 32/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 32/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.730 total time=   1.2s
[CV 1/5; 33/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 33/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.737 total time=   4.3s
[CV 2/5; 33/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 33/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.735 total time=   4.9s
[CV 3/5; 33/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 33/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.736 total time=   4.7s
[CV 4/5; 33/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 33/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.733 total time=   4.2s
[CV 5/5; 33/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 33/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.732 total time=   4.5s
[CV 1/5; 34/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 34/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.739 total time=   7.7s
[CV 2/5; 34/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 34/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.734 total time=   8.6s
[CV 3/5; 34/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 34/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.735 total time=   7.6s
[CV 4/5; 34/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 34/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.732 total time=   7.3s
[CV 5/5; 34/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 34/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=gini, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.732 total time=   7.2s
[CV 1/5; 35/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 35/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.741 total time=   1.2s
[CV 2/5; 35/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 35/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.727 total time=   1.3s
[CV 3/5; 35/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 35/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.736 total time=   1.3s
[CV 4/5; 35/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 35/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.731 total time=   1.3s
[CV 5/5; 35/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 35/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=120, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.735 total time=   1.2s
[CV 1/5; 36/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 36/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.739 total time=   4.8s
[CV 2/5; 36/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 36/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.733 total time=   4.2s
[CV 3/5; 36/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 36/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.736 total time=   4.1s
[CV 4/5; 36/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 36/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.734 total time=   4.4s
[CV 5/5; 36/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 36/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=700, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.733 total time=   4.0s
[CV 1/5; 37/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 1/5; 37/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.739 total time=   6.9s
[CV 2/5; 37/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 2/5; 37/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.734 total time=   6.9s
[CV 3/5; 37/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 3/5; 37/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.736 total time=   7.0s
[CV 4/5; 37/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 4/5; 37/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.735 total time=   6.9s
[CV 5/5; 37/69] START classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42
[CV 5/5; 37/69] END classifier__estimator=RandomForestClassifier(), classifier__estimator__criterion=entropy, classifier__estimator__n_estimators=1200, classifier__estimator__n_jobs=-1, classifier__estimator__random_state=42;, score=0.731 total time=   6.9s
[CV 1/5; 38/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 38/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.704 total time=   0.6s
[CV 2/5; 38/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 38/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.703 total time=   0.5s
[CV 3/5; 38/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 38/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.710 total time=   0.4s
[CV 4/5; 38/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 38/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.705 total time=   0.4s
[CV 5/5; 38/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 38/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   0.5s
[CV 1/5; 39/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 39/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.709 total time=   0.9s
[CV 2/5; 39/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 39/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.705 total time=   0.7s
[CV 3/5; 39/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 39/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.709 total time=   0.6s
[CV 4/5; 39/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 39/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   0.6s
[CV 5/5; 39/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 39/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.705 total time=   0.7s
[CV 1/5; 40/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 40/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.708 total time=   0.8s
[CV 2/5; 40/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 40/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.704 total time=   0.8s
[CV 3/5; 40/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 40/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   0.9s
[CV 4/5; 40/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 40/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   0.9s
[CV 5/5; 40/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 40/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.703 total time=   1.0s
[CV 1/5; 41/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 41/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   1.1s
[CV 2/5; 41/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 41/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   1.1s
[CV 3/5; 41/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 41/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   1.1s
[CV 4/5; 41/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 41/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   1.2s
[CV 5/5; 41/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 41/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=1, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   1.1s
[CV 1/5; 42/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 42/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   0.4s
[CV 2/5; 42/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 42/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.704 total time=   0.4s
[CV 3/5; 42/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 42/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.712 total time=   0.5s
[CV 4/5; 42/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 42/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.709 total time=   0.4s
[CV 5/5; 42/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 42/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=50, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   0.5s
[CV 1/5; 43/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 43/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.708 total time=   0.7s
[CV 2/5; 43/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 43/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.708 total time=   0.7s
[CV 3/5; 43/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 43/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.712 total time=   0.6s
[CV 4/5; 43/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 43/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.711 total time=   0.6s
[CV 5/5; 43/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 43/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=100, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   0.6s
[CV 1/5; 44/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 44/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.710 total time=   0.9s
[CV 2/5; 44/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 44/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.705 total time=   1.0s
[CV 3/5; 44/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 44/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.706 total time=   0.8s
[CV 4/5; 44/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 44/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.709 total time=   0.8s
[CV 5/5; 44/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 44/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=150, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.708 total time=   1.0s
[CV 1/5; 45/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 1/5; 45/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   1.2s
[CV 2/5; 45/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 2/5; 45/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.707 total time=   1.1s
[CV 3/5; 45/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 3/5; 45/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.708 total time=   1.1s
[CV 4/5; 45/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 4/5; 45/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.709 total time=   1.1s
[CV 5/5; 45/69] START classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist
[CV 5/5; 45/69] END classifier__estimator=XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, gamma=None,
              gpu_id=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, n_estimators=100, n_jobs=None,
              num_parallel_tree=None, predictor=None, random_state=None,
              reg_alpha=None, reg_lambda=None, ...), classifier__estimator__max_delta_step=1.0, classifier__estimator__min_child_weight=7, classifier__estimator__n_estimators=200, classifier__estimator__n_jobs=-1, classifier__estimator__objective=binary:logistic, classifier__estimator__random_state=42, classifier__estimator__tree_method=hist;, score=0.704 total time=   1.1s
[CV 1/5; 46/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70373 | train_auc: 0.59145 | train_balanced_accuracy: 0.5726  | train_accuracy: 0.57214 | valid_auc: 0.58871 | valid_balanced_accuracy: 0.56174 | valid_accuracy: 0.56122 |  0:00:16s
epoch 1  | loss: 0.6539  | train_auc: 0.61593 | train_balanced_accuracy: 0.57996 | train_accuracy: 0.58088 | valid_auc: 0.60243 | valid_balanced_accuracy: 0.57569 | valid_accuracy: 0.57664 |  0:00:34s
epoch 2  | loss: 0.63612 | train_auc: 0.63121 | train_balanced_accuracy: 0.58102 | train_accuracy: 0.58265 | valid_auc: 0.61552 | valid_balanced_accuracy: 0.56726 | valid_accuracy: 0.56893 |  0:00:50s
epoch 3  | loss: 0.62381 | train_auc: 0.65057 | train_balanced_accuracy: 0.60254 | train_accuracy: 0.6037  | valid_auc: 0.63716 | valid_balanced_accuracy: 0.59798 | valid_accuracy: 0.59915 |  0:01:06s
epoch 4  | loss: 0.61425 | train_auc: 0.67736 | train_balanced_accuracy: 0.60308 | train_accuracy: 0.60476 | valid_auc: 0.66645 | valid_balanced_accuracy: 0.60182 | valid_accuracy: 0.60356 |  0:01:22s
epoch 5  | loss: 0.61348 | train_auc: 0.6938  | train_balanced_accuracy: 0.63314 | train_accuracy: 0.63443 | valid_auc: 0.68668 | valid_balanced_accuracy: 0.63526 | valid_accuracy: 0.63661 |  0:01:39s
epoch 6  | loss: 0.61296 | train_auc: 0.70232 | train_balanced_accuracy: 0.64388 | train_accuracy: 0.64493 | valid_auc: 0.69278 | valid_balanced_accuracy: 0.63744 | valid_accuracy: 0.6385  |  0:01:56s
epoch 7  | loss: 0.60838 | train_auc: 0.70599 | train_balanced_accuracy: 0.64245 | train_accuracy: 0.64332 | valid_auc: 0.69966 | valid_balanced_accuracy: 0.63868 | valid_accuracy: 0.6396  |  0:02:12s
epoch 8  | loss: 0.59789 | train_auc: 0.71052 | train_balanced_accuracy: 0.65025 | train_accuracy: 0.65119 | valid_auc: 0.69914 | valid_balanced_accuracy: 0.64275 | valid_accuracy: 0.64369 |  0:02:27s
epoch 9  | loss: 0.60338 | train_auc: 0.7167  | train_balanced_accuracy: 0.65615 | train_accuracy: 0.65697 | valid_auc: 0.71148 | valid_balanced_accuracy: 0.65149 | valid_accuracy: 0.65234 |  0:02:43s
epoch 10 | loss: 0.59305 | train_auc: 0.71583 | train_balanced_accuracy: 0.65275 | train_accuracy: 0.6532  | valid_auc: 0.70954 | valid_balanced_accuracy: 0.64956 | valid_accuracy: 0.64998 |  0:02:59s
epoch 11 | loss: 0.59623 | train_auc: 0.7196  | train_balanced_accuracy: 0.65495 | train_accuracy: 0.65552 | valid_auc: 0.71019 | valid_balanced_accuracy: 0.6461  | valid_accuracy: 0.64668 |  0:03:15s
epoch 12 | loss: 0.5982  | train_auc: 0.72298 | train_balanced_accuracy: 0.66469 | train_accuracy: 0.66536 | valid_auc: 0.71131 | valid_balanced_accuracy: 0.6534  | valid_accuracy: 0.65408 |  0:03:33s
epoch 13 | loss: 0.5978  | train_auc: 0.72633 | train_balanced_accuracy: 0.66016 | train_accuracy: 0.66126 | valid_auc: 0.71721 | valid_balanced_accuracy: 0.65152 | valid_accuracy: 0.65266 |  0:03:48s
epoch 14 | loss: 0.59502 | train_auc: 0.72774 | train_balanced_accuracy: 0.66523 | train_accuracy: 0.66595 | valid_auc: 0.71655 | valid_balanced_accuracy: 0.65968 | valid_accuracy: 0.66037 |  0:04:05s
epoch 15 | loss: 0.59186 | train_auc: 0.7317  | train_balanced_accuracy: 0.66837 | train_accuracy: 0.66827 | valid_auc: 0.72115 | valid_balanced_accuracy: 0.65971 | valid_accuracy: 0.65958 |  0:04:22s
epoch 16 | loss: 0.58667 | train_auc: 0.72987 | train_balanced_accuracy: 0.66088 | train_accuracy: 0.66103 | valid_auc: 0.7175  | valid_balanced_accuracy: 0.65427 | valid_accuracy: 0.65439 |  0:04:39s
epoch 17 | loss: 0.58882 | train_auc: 0.72972 | train_balanced_accuracy: 0.66373 | train_accuracy: 0.66374 | valid_auc: 0.71953 | valid_balanced_accuracy: 0.65442 | valid_accuracy: 0.65439 |  0:04:57s
epoch 18 | loss: 0.58861 | train_auc: 0.73469 | train_balanced_accuracy: 0.67293 | train_accuracy: 0.67358 | valid_auc: 0.72145 | valid_balanced_accuracy: 0.65862 | valid_accuracy: 0.65927 |  0:05:19s
epoch 19 | loss: 0.59101 | train_auc: 0.7365  | train_balanced_accuracy: 0.67237 | train_accuracy: 0.67283 | valid_auc: 0.72375 | valid_balanced_accuracy: 0.65837 | valid_accuracy: 0.6588  |  0:05:36s
epoch 20 | loss: 0.59071 | train_auc: 0.73833 | train_balanced_accuracy: 0.67406 | train_accuracy: 0.67488 | valid_auc: 0.72595 | valid_balanced_accuracy: 0.66161 | valid_accuracy: 0.66242 |  0:05:53s
epoch 21 | loss: 0.58697 | train_auc: 0.74374 | train_balanced_accuracy: 0.67579 | train_accuracy: 0.67665 | valid_auc: 0.72927 | valid_balanced_accuracy: 0.65761 | valid_accuracy: 0.65848 |  0:06:10s
epoch 22 | loss: 0.59035 | train_auc: 0.74063 | train_balanced_accuracy: 0.67907 | train_accuracy: 0.67944 | valid_auc: 0.72946 | valid_balanced_accuracy: 0.66659 | valid_accuracy: 0.66698 |  0:06:27s
epoch 23 | loss: 0.58358 | train_auc: 0.75211 | train_balanced_accuracy: 0.68297 | train_accuracy: 0.68345 | valid_auc: 0.73783 | valid_balanced_accuracy: 0.67125 | valid_accuracy: 0.6717  |  0:06:42s
epoch 24 | loss: 0.58974 | train_auc: 0.74976 | train_balanced_accuracy: 0.67975 | train_accuracy: 0.68035 | valid_auc: 0.73167 | valid_balanced_accuracy: 0.66042 | valid_accuracy: 0.661   |  0:06:59s
epoch 25 | loss: 0.58095 | train_auc: 0.7619  | train_balanced_accuracy: 0.69595 | train_accuracy: 0.69585 | valid_auc: 0.74641 | valid_balanced_accuracy: 0.6836  | valid_accuracy: 0.68351 |  0:07:17s
epoch 26 | loss: 0.5836  | train_auc: 0.74763 | train_balanced_accuracy: 0.68267 | train_accuracy: 0.68326 | valid_auc: 0.72935 | valid_balanced_accuracy: 0.66608 | valid_accuracy: 0.66667 |  0:07:35s
epoch 27 | loss: 0.58195 | train_auc: 0.75853 | train_balanced_accuracy: 0.68822 | train_accuracy: 0.68877 | valid_auc: 0.7374  | valid_balanced_accuracy: 0.66719 | valid_accuracy: 0.66777 |  0:07:51s
epoch 28 | loss: 0.57962 | train_auc: 0.75783 | train_balanced_accuracy: 0.69045 | train_accuracy: 0.69089 | valid_auc: 0.73591 | valid_balanced_accuracy: 0.66925 | valid_accuracy: 0.66966 |  0:08:07s
epoch 29 | loss: 0.57559 | train_auc: 0.7643  | train_balanced_accuracy: 0.69451 | train_accuracy: 0.69479 | valid_auc: 0.74597 | valid_balanced_accuracy: 0.6762  | valid_accuracy: 0.67642 |  0:08:26s
epoch 30 | loss: 0.58072 | train_auc: 0.76003 | train_balanced_accuracy: 0.6891  | train_accuracy: 0.68951 | valid_auc: 0.73985 | valid_balanced_accuracy: 0.67482 | valid_accuracy: 0.67517 |  0:08:43s
epoch 31 | loss: 0.57676 | train_auc: 0.76823 | train_balanced_accuracy: 0.69787 | train_accuracy: 0.69786 | valid_auc: 0.75105 | valid_balanced_accuracy: 0.68666 | valid_accuracy: 0.68665 |  0:08:59s
epoch 32 | loss: 0.57889 | train_auc: 0.76929 | train_balanced_accuracy: 0.69937 | train_accuracy: 0.69982 | valid_auc: 0.747   | valid_balanced_accuracy: 0.68149 | valid_accuracy: 0.68193 |  0:09:16s
epoch 33 | loss: 0.5772  | train_auc: 0.77173 | train_balanced_accuracy: 0.69879 | train_accuracy: 0.69923 | valid_auc: 0.74862 | valid_balanced_accuracy: 0.68279 | valid_accuracy: 0.68319 |  0:09:33s
epoch 34 | loss: 0.57221 | train_auc: 0.77427 | train_balanced_accuracy: 0.70561 | train_accuracy: 0.70572 | valid_auc: 0.75116 | valid_balanced_accuracy: 0.68152 | valid_accuracy: 0.68162 |  0:09:48s
epoch 35 | loss: 0.57483 | train_auc: 0.76845 | train_balanced_accuracy: 0.69492 | train_accuracy: 0.69546 | valid_auc: 0.74826 | valid_balanced_accuracy: 0.68047 | valid_accuracy: 0.68099 |  0:10:06s
epoch 36 | loss: 0.57745 | train_auc: 0.77029 | train_balanced_accuracy: 0.6998  | train_accuracy: 0.70014 | valid_auc: 0.74435 | valid_balanced_accuracy: 0.67783 | valid_accuracy: 0.67816 |  0:10:21s
epoch 37 | loss: 0.57147 | train_auc: 0.7712  | train_balanced_accuracy: 0.69904 | train_accuracy: 0.69963 | valid_auc: 0.75063 | valid_balanced_accuracy: 0.68042 | valid_accuracy: 0.68099 |  0:10:37s
epoch 38 | loss: 0.56952 | train_auc: 0.76455 | train_balanced_accuracy: 0.69316 | train_accuracy: 0.69286 | valid_auc: 0.74118 | valid_balanced_accuracy: 0.6805  | valid_accuracy: 0.6802  |  0:10:53s
epoch 39 | loss: 0.57565 | train_auc: 0.76815 | train_balanced_accuracy: 0.69499 | train_accuracy: 0.69518 | valid_auc: 0.74513 | valid_balanced_accuracy: 0.68084 | valid_accuracy: 0.68099 |  0:11:09s
epoch 40 | loss: 0.57531 | train_auc: 0.77317 | train_balanced_accuracy: 0.70194 | train_accuracy: 0.70226 | valid_auc: 0.74971 | valid_balanced_accuracy: 0.68759 | valid_accuracy: 0.68791 |  0:11:27s
epoch 41 | loss: 0.57478 | train_auc: 0.7523  | train_balanced_accuracy: 0.68547 | train_accuracy: 0.68511 | valid_auc: 0.73264 | valid_balanced_accuracy: 0.66766 | valid_accuracy: 0.6673  |  0:11:45s
epoch 42 | loss: 0.57169 | train_auc: 0.77491 | train_balanced_accuracy: 0.70025 | train_accuracy: 0.70053 | valid_auc: 0.75431 | valid_balanced_accuracy: 0.68844 | valid_accuracy: 0.6887  |  0:12:03s
epoch 43 | loss: 0.57492 | train_auc: 0.77678 | train_balanced_accuracy: 0.70328 | train_accuracy: 0.70348 | valid_auc: 0.75416 | valid_balanced_accuracy: 0.69043 | valid_accuracy: 0.69059 |  0:12:18s
epoch 44 | loss: 0.57173 | train_auc: 0.77804 | train_balanced_accuracy: 0.70322 | train_accuracy: 0.70348 | valid_auc: 0.75365 | valid_balanced_accuracy: 0.68485 | valid_accuracy: 0.68508 |  0:12:36s
epoch 45 | loss: 0.566   | train_auc: 0.78032 | train_balanced_accuracy: 0.70628 | train_accuracy: 0.70679 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69089 | valid_accuracy: 0.69138 |  0:12:54s
epoch 46 | loss: 0.56908 | train_auc: 0.77998 | train_balanced_accuracy: 0.70578 | train_accuracy: 0.70604 | valid_auc: 0.75318 | valid_balanced_accuracy: 0.68062 | valid_accuracy: 0.68083 |  0:13:10s
epoch 47 | loss: 0.56659 | train_auc: 0.78671 | train_balanced_accuracy: 0.71334 | train_accuracy: 0.71352 | valid_auc: 0.75911 | valid_balanced_accuracy: 0.6915  | valid_accuracy: 0.69169 |  0:13:27s
epoch 48 | loss: 0.56319 | train_auc: 0.7815  | train_balanced_accuracy: 0.70671 | train_accuracy: 0.70663 | valid_auc: 0.75571 | valid_balanced_accuracy: 0.68785 | valid_accuracy: 0.68776 |  0:13:43s
epoch 49 | loss: 0.5658  | train_auc: 0.77584 | train_balanced_accuracy: 0.70382 | train_accuracy: 0.70407 | valid_auc: 0.75266 | valid_balanced_accuracy: 0.68843 | valid_accuracy: 0.6887  |  0:13:58s
epoch 50 | loss: 0.56111 | train_auc: 0.78402 | train_balanced_accuracy: 0.70538 | train_accuracy: 0.70545 | valid_auc: 0.75649 | valid_balanced_accuracy: 0.68219 | valid_accuracy: 0.68225 |  0:14:14s
epoch 51 | loss: 0.55917 | train_auc: 0.78127 | train_balanced_accuracy: 0.70369 | train_accuracy: 0.70352 | valid_auc: 0.75568 | valid_balanced_accuracy: 0.68325 | valid_accuracy: 0.68303 |  0:14:32s
epoch 52 | loss: 0.56006 | train_auc: 0.78554 | train_balanced_accuracy: 0.70813 | train_accuracy: 0.70805 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.68187 | valid_accuracy: 0.68178 |  0:14:47s
epoch 53 | loss: 0.56161 | train_auc: 0.78808 | train_balanced_accuracy: 0.71139 | train_accuracy: 0.71155 | valid_auc: 0.75821 | valid_balanced_accuracy: 0.68963 | valid_accuracy: 0.6898  |  0:15:03s
epoch 54 | loss: 0.56057 | train_auc: 0.77994 | train_balanced_accuracy: 0.70595 | train_accuracy: 0.7058  | valid_auc: 0.75363 | valid_balanced_accuracy: 0.68424 | valid_accuracy: 0.68414 |  0:15:20s
epoch 55 | loss: 0.56522 | train_auc: 0.78395 | train_balanced_accuracy: 0.71046 | train_accuracy: 0.71053 | valid_auc: 0.75655 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69043 |  0:15:36s
epoch 56 | loss: 0.5605  | train_auc: 0.78423 | train_balanced_accuracy: 0.70704 | train_accuracy: 0.70698 | valid_auc: 0.76122 | valid_balanced_accuracy: 0.69129 | valid_accuracy: 0.69122 |  0:15:52s
epoch 57 | loss: 0.56166 | train_auc: 0.78344 | train_balanced_accuracy: 0.70564 | train_accuracy: 0.70569 | valid_auc: 0.75289 | valid_balanced_accuracy: 0.68554 | valid_accuracy: 0.68555 |  0:16:09s
epoch 58 | loss: 0.55822 | train_auc: 0.78253 | train_balanced_accuracy: 0.70902 | train_accuracy: 0.70938 | valid_auc: 0.75011 | valid_balanced_accuracy: 0.67688 | valid_accuracy: 0.67721 |  0:16:26s
epoch 59 | loss: 0.55847 | train_auc: 0.7861  | train_balanced_accuracy: 0.70766 | train_accuracy: 0.70765 | valid_auc: 0.75647 | valid_balanced_accuracy: 0.69091 | valid_accuracy: 0.6909  |  0:16:41s
epoch 60 | loss: 0.55935 | train_auc: 0.79227 | train_balanced_accuracy: 0.71396 | train_accuracy: 0.71379 | valid_auc: 0.7595  | valid_balanced_accuracy: 0.68588 | valid_accuracy: 0.68571 |  0:16:57s
epoch 61 | loss: 0.55507 | train_auc: 0.79061 | train_balanced_accuracy: 0.71039 | train_accuracy: 0.71049 | valid_auc: 0.75943 | valid_balanced_accuracy: 0.68594 | valid_accuracy: 0.68602 |  0:17:12s
epoch 62 | loss: 0.55361 | train_auc: 0.789   | train_balanced_accuracy: 0.71169 | train_accuracy: 0.71186 | valid_auc: 0.7598  | valid_balanced_accuracy: 0.68869 | valid_accuracy: 0.68886 |  0:17:29s
epoch 63 | loss: 0.5584  | train_auc: 0.78517 | train_balanced_accuracy: 0.71052 | train_accuracy: 0.71037 | valid_auc: 0.75462 | valid_balanced_accuracy: 0.68023 | valid_accuracy: 0.68004 |  0:17:45s
epoch 64 | loss: 0.55961 | train_auc: 0.79262 | train_balanced_accuracy: 0.7128  | train_accuracy: 0.71245 | valid_auc: 0.75621 | valid_balanced_accuracy: 0.68384 | valid_accuracy: 0.68351 |  0:18:02s
epoch 65 | loss: 0.5516  | train_auc: 0.78437 | train_balanced_accuracy: 0.70858 | train_accuracy: 0.70895 | valid_auc: 0.75278 | valid_balanced_accuracy: 0.68411 | valid_accuracy: 0.68445 |  0:18:17s
epoch 66 | loss: 0.55216 | train_auc: 0.79643 | train_balanced_accuracy: 0.71722 | train_accuracy: 0.71753 | valid_auc: 0.75789 | valid_balanced_accuracy: 0.68542 | valid_accuracy: 0.68571 |  0:18:34s
epoch 67 | loss: 0.55408 | train_auc: 0.79665 | train_balanced_accuracy: 0.71692 | train_accuracy: 0.7171  | valid_auc: 0.75694 | valid_balanced_accuracy: 0.68349 | valid_accuracy: 0.68366 |  0:18:50s

Early stopping occurred at epoch 67 with best_epoch = 47 and best_valid_accuracy = 0.69169
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 46/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=18.9min
[CV 2/5; 46/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70019 | train_auc: 0.54644 | train_balanced_accuracy: 0.53322 | train_accuracy: 0.53437 | valid_auc: 0.555   | valid_balanced_accuracy: 0.53929 | valid_accuracy: 0.54045 |  0:00:15s
epoch 1  | loss: 0.64397 | train_auc: 0.64596 | train_balanced_accuracy: 0.61096 | train_accuracy: 0.61125 | valid_auc: 0.63826 | valid_balanced_accuracy: 0.60662 | valid_accuracy: 0.60686 |  0:00:31s
epoch 2  | loss: 0.62352 | train_auc: 0.62434 | train_balanced_accuracy: 0.50174 | train_accuracy: 0.50529 | valid_auc: 0.6274  | valid_balanced_accuracy: 0.50079 | valid_accuracy: 0.50441 |  0:00:48s
epoch 3  | loss: 0.61951 | train_auc: 0.64446 | train_balanced_accuracy: 0.5044  | train_accuracy: 0.50789 | valid_auc: 0.63771 | valid_balanced_accuracy: 0.50417 | valid_accuracy: 0.50771 |  0:01:03s
epoch 4  | loss: 0.60661 | train_auc: 0.67973 | train_balanced_accuracy: 0.55106 | train_accuracy: 0.55404 | valid_auc: 0.67472 | valid_balanced_accuracy: 0.54749 | valid_accuracy: 0.55052 |  0:01:19s
epoch 5  | loss: 0.6073  | train_auc: 0.70372 | train_balanced_accuracy: 0.58287 | train_accuracy: 0.58528 | valid_auc: 0.69773 | valid_balanced_accuracy: 0.58588 | valid_accuracy: 0.58829 |  0:01:36s
epoch 6  | loss: 0.60454 | train_auc: 0.71407 | train_balanced_accuracy: 0.61082 | train_accuracy: 0.61283 | valid_auc: 0.7139  | valid_balanced_accuracy: 0.61362 | valid_accuracy: 0.61568 |  0:01:51s
epoch 7  | loss: 0.6015  | train_auc: 0.71186 | train_balanced_accuracy: 0.61196 | train_accuracy: 0.61397 | valid_auc: 0.70845 | valid_balanced_accuracy: 0.61459 | valid_accuracy: 0.61662 |  0:02:09s
epoch 8  | loss: 0.596   | train_auc: 0.71459 | train_balanced_accuracy: 0.63252 | train_accuracy: 0.63415 | valid_auc: 0.711   | valid_balanced_accuracy: 0.63999 | valid_accuracy: 0.64164 |  0:02:26s
epoch 9  | loss: 0.6004  | train_auc: 0.71788 | train_balanced_accuracy: 0.65237 | train_accuracy: 0.65371 | valid_auc: 0.71406 | valid_balanced_accuracy: 0.65588 | valid_accuracy: 0.65722 |  0:02:41s
epoch 10 | loss: 0.59073 | train_auc: 0.72073 | train_balanced_accuracy: 0.66348 | train_accuracy: 0.66433 | valid_auc: 0.71596 | valid_balanced_accuracy: 0.66804 | valid_accuracy: 0.66887 |  0:02:56s
epoch 11 | loss: 0.59409 | train_auc: 0.72647 | train_balanced_accuracy: 0.66526 | train_accuracy: 0.6661  | valid_auc: 0.71927 | valid_balanced_accuracy: 0.66505 | valid_accuracy: 0.66588 |  0:03:11s
epoch 12 | loss: 0.59312 | train_auc: 0.72302 | train_balanced_accuracy: 0.65943 | train_accuracy: 0.6604  | valid_auc: 0.71454 | valid_balanced_accuracy: 0.66273 | valid_accuracy: 0.66368 |  0:03:28s
epoch 13 | loss: 0.58984 | train_auc: 0.72682 | train_balanced_accuracy: 0.66522 | train_accuracy: 0.66598 | valid_auc: 0.7218  | valid_balanced_accuracy: 0.66453 | valid_accuracy: 0.66525 |  0:03:44s
epoch 14 | loss: 0.59459 | train_auc: 0.73318 | train_balanced_accuracy: 0.66852 | train_accuracy: 0.66945 | valid_auc: 0.72709 | valid_balanced_accuracy: 0.66387 | valid_accuracy: 0.66478 |  0:04:01s
epoch 15 | loss: 0.59136 | train_auc: 0.73601 | train_balanced_accuracy: 0.67349 | train_accuracy: 0.67389 | valid_auc: 0.7286  | valid_balanced_accuracy: 0.66469 | valid_accuracy: 0.66509 |  0:04:16s
epoch 16 | loss: 0.58698 | train_auc: 0.74605 | train_balanced_accuracy: 0.67984 | train_accuracy: 0.68023 | valid_auc: 0.73499 | valid_balanced_accuracy: 0.66708 | valid_accuracy: 0.66745 |  0:04:33s
epoch 17 | loss: 0.58672 | train_auc: 0.74003 | train_balanced_accuracy: 0.67389 | train_accuracy: 0.67421 | valid_auc: 0.73087 | valid_balanced_accuracy: 0.667   | valid_accuracy: 0.6673  |  0:04:49s
epoch 18 | loss: 0.586   | train_auc: 0.74475 | train_balanced_accuracy: 0.67756 | train_accuracy: 0.67806 | valid_auc: 0.73459 | valid_balanced_accuracy: 0.66849 | valid_accuracy: 0.66903 |  0:05:08s
epoch 19 | loss: 0.58328 | train_auc: 0.7481  | train_balanced_accuracy: 0.68216 | train_accuracy: 0.68247 | valid_auc: 0.73998 | valid_balanced_accuracy: 0.67564 | valid_accuracy: 0.67595 |  0:05:25s
epoch 20 | loss: 0.5844  | train_auc: 0.7471  | train_balanced_accuracy: 0.68208 | train_accuracy: 0.68275 | valid_auc: 0.73494 | valid_balanced_accuracy: 0.67749 | valid_accuracy: 0.67816 |  0:05:41s
epoch 21 | loss: 0.58367 | train_auc: 0.75095 | train_balanced_accuracy: 0.68718 | train_accuracy: 0.68786 | valid_auc: 0.73752 | valid_balanced_accuracy: 0.67556 | valid_accuracy: 0.67627 |  0:05:57s
epoch 22 | loss: 0.59152 | train_auc: 0.75454 | train_balanced_accuracy: 0.68858 | train_accuracy: 0.68924 | valid_auc: 0.74317 | valid_balanced_accuracy: 0.68125 | valid_accuracy: 0.68193 |  0:06:12s
epoch 23 | loss: 0.58647 | train_auc: 0.75529 | train_balanced_accuracy: 0.68606 | train_accuracy: 0.68672 | valid_auc: 0.74257 | valid_balanced_accuracy: 0.67757 | valid_accuracy: 0.67816 |  0:06:27s
epoch 24 | loss: 0.58898 | train_auc: 0.76103 | train_balanced_accuracy: 0.694   | train_accuracy: 0.69451 | valid_auc: 0.74799 | valid_balanced_accuracy: 0.68283 | valid_accuracy: 0.68335 |  0:06:43s
epoch 25 | loss: 0.57982 | train_auc: 0.76102 | train_balanced_accuracy: 0.69434 | train_accuracy: 0.69416 | valid_auc: 0.74985 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68445 |  0:07:01s
epoch 26 | loss: 0.58252 | train_auc: 0.76465 | train_balanced_accuracy: 0.6992  | train_accuracy: 0.69955 | valid_auc: 0.74821 | valid_balanced_accuracy: 0.68425 | valid_accuracy: 0.68461 |  0:07:16s
epoch 27 | loss: 0.58234 | train_auc: 0.7638  | train_balanced_accuracy: 0.69607 | train_accuracy: 0.69652 | valid_auc: 0.75034 | valid_balanced_accuracy: 0.684   | valid_accuracy: 0.68445 |  0:07:31s
epoch 28 | loss: 0.57931 | train_auc: 0.76014 | train_balanced_accuracy: 0.69274 | train_accuracy: 0.69325 | valid_auc: 0.74246 | valid_balanced_accuracy: 0.68206 | valid_accuracy: 0.68256 |  0:07:49s
epoch 29 | loss: 0.57995 | train_auc: 0.76502 | train_balanced_accuracy: 0.69653 | train_accuracy: 0.6966  | valid_auc: 0.75357 | valid_balanced_accuracy: 0.68535 | valid_accuracy: 0.6854  |  0:08:05s
epoch 30 | loss: 0.57827 | train_auc: 0.76628 | train_balanced_accuracy: 0.69818 | train_accuracy: 0.69833 | valid_auc: 0.75007 | valid_balanced_accuracy: 0.681   | valid_accuracy: 0.68115 |  0:08:22s
epoch 31 | loss: 0.5811  | train_auc: 0.76478 | train_balanced_accuracy: 0.6972  | train_accuracy: 0.69754 | valid_auc: 0.74515 | valid_balanced_accuracy: 0.68145 | valid_accuracy: 0.68178 |  0:08:38s
epoch 32 | loss: 0.58595 | train_auc: 0.76096 | train_balanced_accuracy: 0.69262 | train_accuracy: 0.69262 | valid_auc: 0.74579 | valid_balanced_accuracy: 0.67929 | valid_accuracy: 0.67926 |  0:08:54s
epoch 33 | loss: 0.58431 | train_auc: 0.76354 | train_balanced_accuracy: 0.69771 | train_accuracy: 0.69833 | valid_auc: 0.74888 | valid_balanced_accuracy: 0.68285 | valid_accuracy: 0.68351 |  0:09:08s
epoch 34 | loss: 0.57884 | train_auc: 0.76089 | train_balanced_accuracy: 0.69287 | train_accuracy: 0.69321 | valid_auc: 0.74748 | valid_balanced_accuracy: 0.68334 | valid_accuracy: 0.68366 |  0:09:23s
epoch 35 | loss: 0.57885 | train_auc: 0.76857 | train_balanced_accuracy: 0.70089 | train_accuracy: 0.70144 | valid_auc: 0.74955 | valid_balanced_accuracy: 0.68786 | valid_accuracy: 0.68839 |  0:09:40s
epoch 36 | loss: 0.57712 | train_auc: 0.77021 | train_balanced_accuracy: 0.69892 | train_accuracy: 0.69919 | valid_auc: 0.75267 | valid_balanced_accuracy: 0.68482 | valid_accuracy: 0.68508 |  0:09:55s
epoch 37 | loss: 0.58    | train_auc: 0.76563 | train_balanced_accuracy: 0.69557 | train_accuracy: 0.69557 | valid_auc: 0.74433 | valid_balanced_accuracy: 0.67503 | valid_accuracy: 0.67501 |  0:10:12s
epoch 38 | loss: 0.5742  | train_auc: 0.76044 | train_balanced_accuracy: 0.6903  | train_accuracy: 0.68999 | valid_auc: 0.74517 | valid_balanced_accuracy: 0.67864 | valid_accuracy: 0.67831 |  0:10:29s
epoch 39 | loss: 0.57547 | train_auc: 0.76861 | train_balanced_accuracy: 0.70359 | train_accuracy: 0.70392 | valid_auc: 0.75012 | valid_balanced_accuracy: 0.69043 | valid_accuracy: 0.69075 |  0:10:44s
epoch 40 | loss: 0.57768 | train_auc: 0.77208 | train_balanced_accuracy: 0.70536 | train_accuracy: 0.70584 | valid_auc: 0.75101 | valid_balanced_accuracy: 0.68823 | valid_accuracy: 0.6887  |  0:10:59s
epoch 41 | loss: 0.57409 | train_auc: 0.76398 | train_balanced_accuracy: 0.69465 | train_accuracy: 0.69451 | valid_auc: 0.74803 | valid_balanced_accuracy: 0.68331 | valid_accuracy: 0.68319 |  0:11:15s
epoch 42 | loss: 0.57029 | train_auc: 0.77513 | train_balanced_accuracy: 0.70534 | train_accuracy: 0.7058  | valid_auc: 0.75515 | valid_balanced_accuracy: 0.69328 | valid_accuracy: 0.69374 |  0:11:34s
epoch 43 | loss: 0.57649 | train_auc: 0.77355 | train_balanced_accuracy: 0.70402 | train_accuracy: 0.70407 | valid_auc: 0.75409 | valid_balanced_accuracy: 0.68852 | valid_accuracy: 0.68854 |  0:11:52s
epoch 44 | loss: 0.57062 | train_auc: 0.77287 | train_balanced_accuracy: 0.70525 | train_accuracy: 0.70569 | valid_auc: 0.75198 | valid_balanced_accuracy: 0.69379 | valid_accuracy: 0.69421 |  0:12:07s
epoch 45 | loss: 0.57014 | train_auc: 0.7701  | train_balanced_accuracy: 0.70027 | train_accuracy: 0.70089 | valid_auc: 0.74493 | valid_balanced_accuracy: 0.68576 | valid_accuracy: 0.68634 |  0:12:23s
epoch 46 | loss: 0.57275 | train_auc: 0.76976 | train_balanced_accuracy: 0.70132 | train_accuracy: 0.70144 | valid_auc: 0.74676 | valid_balanced_accuracy: 0.68981 | valid_accuracy: 0.68996 |  0:12:38s
epoch 47 | loss: 0.57172 | train_auc: 0.77517 | train_balanced_accuracy: 0.70524 | train_accuracy: 0.70569 | valid_auc: 0.75285 | valid_balanced_accuracy: 0.68764 | valid_accuracy: 0.68807 |  0:12:55s
epoch 48 | loss: 0.56871 | train_auc: 0.77504 | train_balanced_accuracy: 0.70685 | train_accuracy: 0.70702 | valid_auc: 0.74881 | valid_balanced_accuracy: 0.69016 | valid_accuracy: 0.69027 |  0:13:12s
epoch 49 | loss: 0.56943 | train_auc: 0.77614 | train_balanced_accuracy: 0.70681 | train_accuracy: 0.70726 | valid_auc: 0.75122 | valid_balanced_accuracy: 0.6928  | valid_accuracy: 0.69326 |  0:13:30s
epoch 50 | loss: 0.56988 | train_auc: 0.77861 | train_balanced_accuracy: 0.70729 | train_accuracy: 0.70746 | valid_auc: 0.757   | valid_balanced_accuracy: 0.69028 | valid_accuracy: 0.69043 |  0:13:46s
epoch 51 | loss: 0.56824 | train_auc: 0.778   | train_balanced_accuracy: 0.70879 | train_accuracy: 0.70903 | valid_auc: 0.75726 | valid_balanced_accuracy: 0.69633 | valid_accuracy: 0.69657 |  0:14:04s
epoch 52 | loss: 0.56696 | train_auc: 0.78051 | train_balanced_accuracy: 0.70828 | train_accuracy: 0.70836 | valid_auc: 0.75782 | valid_balanced_accuracy: 0.6929  | valid_accuracy: 0.69295 |  0:14:21s
epoch 53 | loss: 0.5643  | train_auc: 0.77904 | train_balanced_accuracy: 0.70855 | train_accuracy: 0.70879 | valid_auc: 0.75301 | valid_balanced_accuracy: 0.69049 | valid_accuracy: 0.69075 |  0:14:37s
epoch 54 | loss: 0.56965 | train_auc: 0.77778 | train_balanced_accuracy: 0.7061  | train_accuracy: 0.7062  | valid_auc: 0.75377 | valid_balanced_accuracy: 0.68987 | valid_accuracy: 0.68996 |  0:14:53s
epoch 55 | loss: 0.57229 | train_auc: 0.77874 | train_balanced_accuracy: 0.70812 | train_accuracy: 0.70864 | valid_auc: 0.75451 | valid_balanced_accuracy: 0.68819 | valid_accuracy: 0.6887  |  0:15:11s
epoch 56 | loss: 0.5686  | train_auc: 0.77481 | train_balanced_accuracy: 0.70379 | train_accuracy: 0.70399 | valid_auc: 0.75174 | valid_balanced_accuracy: 0.69483 | valid_accuracy: 0.695   |  0:15:28s
epoch 57 | loss: 0.5685  | train_auc: 0.78432 | train_balanced_accuracy: 0.71071 | train_accuracy: 0.7108  | valid_auc: 0.75701 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69263 |  0:15:43s
epoch 58 | loss: 0.56326 | train_auc: 0.78295 | train_balanced_accuracy: 0.7125  | train_accuracy: 0.71265 | valid_auc: 0.75568 | valid_balanced_accuracy: 0.69316 | valid_accuracy: 0.69326 |  0:15:59s
epoch 59 | loss: 0.56346 | train_auc: 0.78059 | train_balanced_accuracy: 0.7098  | train_accuracy: 0.71013 | valid_auc: 0.75486 | valid_balanced_accuracy: 0.68963 | valid_accuracy: 0.68996 |  0:16:16s
epoch 60 | loss: 0.56607 | train_auc: 0.77752 | train_balanced_accuracy: 0.70662 | train_accuracy: 0.70698 | valid_auc: 0.75267 | valid_balanced_accuracy: 0.69103 | valid_accuracy: 0.69138 |  0:16:32s
epoch 61 | loss: 0.56572 | train_auc: 0.7828  | train_balanced_accuracy: 0.71053 | train_accuracy: 0.71088 | valid_auc: 0.75945 | valid_balanced_accuracy: 0.69228 | valid_accuracy: 0.69263 |  0:16:49s
epoch 62 | loss: 0.5644  | train_auc: 0.78137 | train_balanced_accuracy: 0.71118 | train_accuracy: 0.71135 | valid_auc: 0.75524 | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69263 |  0:17:05s
epoch 63 | loss: 0.56734 | train_auc: 0.7805  | train_balanced_accuracy: 0.71212 | train_accuracy: 0.71226 | valid_auc: 0.75408 | valid_balanced_accuracy: 0.69299 | valid_accuracy: 0.69311 |  0:17:22s
epoch 64 | loss: 0.56514 | train_auc: 0.78294 | train_balanced_accuracy: 0.70912 | train_accuracy: 0.70923 | valid_auc: 0.75318 | valid_balanced_accuracy: 0.69031 | valid_accuracy: 0.69043 |  0:17:38s
epoch 65 | loss: 0.55873 | train_auc: 0.78485 | train_balanced_accuracy: 0.71325 | train_accuracy: 0.71348 | valid_auc: 0.75611 | valid_balanced_accuracy: 0.69275 | valid_accuracy: 0.69295 |  0:17:56s
epoch 66 | loss: 0.56147 | train_auc: 0.78594 | train_balanced_accuracy: 0.71485 | train_accuracy: 0.71493 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69414 | valid_accuracy: 0.69421 |  0:18:11s
epoch 67 | loss: 0.55798 | train_auc: 0.78098 | train_balanced_accuracy: 0.71113 | train_accuracy: 0.71163 | valid_auc: 0.75589 | valid_balanced_accuracy: 0.68821 | valid_accuracy: 0.6887  |  0:18:29s
epoch 68 | loss: 0.56427 | train_auc: 0.78585 | train_balanced_accuracy: 0.71421 | train_accuracy: 0.71462 | valid_auc: 0.75804 | valid_balanced_accuracy: 0.69382 | valid_accuracy: 0.69421 |  0:18:45s
epoch 69 | loss: 0.56133 | train_auc: 0.78468 | train_balanced_accuracy: 0.71367 | train_accuracy: 0.71395 | valid_auc: 0.75874 | valid_balanced_accuracy: 0.69646 | valid_accuracy: 0.69673 |  0:19:02s
epoch 70 | loss: 0.56145 | train_auc: 0.78738 | train_balanced_accuracy: 0.7169  | train_accuracy: 0.71721 | valid_auc: 0.75828 | valid_balanced_accuracy: 0.69312 | valid_accuracy: 0.69342 |  0:19:20s
epoch 71 | loss: 0.56237 | train_auc: 0.7834  | train_balanced_accuracy: 0.7108  | train_accuracy: 0.71076 | valid_auc: 0.75596 | valid_balanced_accuracy: 0.69157 | valid_accuracy: 0.69153 |  0:19:36s
epoch 72 | loss: 0.55967 | train_auc: 0.78873 | train_balanced_accuracy: 0.71481 | train_accuracy: 0.71513 | valid_auc: 0.76291 | valid_balanced_accuracy: 0.70037 | valid_accuracy: 0.70066 |  0:19:54s
epoch 73 | loss: 0.55797 | train_auc: 0.78875 | train_balanced_accuracy: 0.71525 | train_accuracy: 0.71544 | valid_auc: 0.76324 | valid_balanced_accuracy: 0.69637 | valid_accuracy: 0.69657 |  0:20:11s
epoch 74 | loss: 0.56024 | train_auc: 0.78855 | train_balanced_accuracy: 0.71734 | train_accuracy: 0.7178  | valid_auc: 0.76015 | valid_balanced_accuracy: 0.69673 | valid_accuracy: 0.6972  |  0:20:25s
epoch 75 | loss: 0.56185 | train_auc: 0.78759 | train_balanced_accuracy: 0.71638 | train_accuracy: 0.71678 | valid_auc: 0.75902 | valid_balanced_accuracy: 0.70374 | valid_accuracy: 0.70412 |  0:20:42s
epoch 76 | loss: 0.56551 | train_auc: 0.79103 | train_balanced_accuracy: 0.71428 | train_accuracy: 0.71418 | valid_auc: 0.75998 | valid_balanced_accuracy: 0.69087 | valid_accuracy: 0.69075 |  0:20:57s
epoch 77 | loss: 0.55937 | train_auc: 0.78844 | train_balanced_accuracy: 0.71431 | train_accuracy: 0.71446 | valid_auc: 0.76228 | valid_balanced_accuracy: 0.69365 | valid_accuracy: 0.69374 |  0:21:12s
epoch 78 | loss: 0.55546 | train_auc: 0.78517 | train_balanced_accuracy: 0.70626 | train_accuracy: 0.70604 | valid_auc: 0.75996 | valid_balanced_accuracy: 0.68942 | valid_accuracy: 0.68917 |  0:21:29s
epoch 79 | loss: 0.55596 | train_auc: 0.79062 | train_balanced_accuracy: 0.71695 | train_accuracy: 0.71698 | valid_auc: 0.75819 | valid_balanced_accuracy: 0.6898  | valid_accuracy: 0.6898  |  0:21:45s
epoch 80 | loss: 0.55926 | train_auc: 0.79177 | train_balanced_accuracy: 0.71958 | train_accuracy: 0.71989 | valid_auc: 0.75809 | valid_balanced_accuracy: 0.69577 | valid_accuracy: 0.6961  |  0:22:03s
epoch 81 | loss: 0.55466 | train_auc: 0.79181 | train_balanced_accuracy: 0.71609 | train_accuracy: 0.71603 | valid_auc: 0.75912 | valid_balanced_accuracy: 0.6933  | valid_accuracy: 0.69326 |  0:22:20s
epoch 82 | loss: 0.55788 | train_auc: 0.79339 | train_balanced_accuracy: 0.71792 | train_accuracy: 0.71836 | valid_auc: 0.76136 | valid_balanced_accuracy: 0.69849 | valid_accuracy: 0.69893 |  0:22:36s
epoch 83 | loss: 0.5551  | train_auc: 0.78895 | train_balanced_accuracy: 0.7141  | train_accuracy: 0.71434 | valid_auc: 0.75322 | valid_balanced_accuracy: 0.69274 | valid_accuracy: 0.69295 |  0:22:53s
epoch 84 | loss: 0.56032 | train_auc: 0.79518 | train_balanced_accuracy: 0.71906 | train_accuracy: 0.71942 | valid_auc: 0.75927 | valid_balanced_accuracy: 0.69919 | valid_accuracy: 0.69956 |  0:23:10s
epoch 85 | loss: 0.55404 | train_auc: 0.79326 | train_balanced_accuracy: 0.71618 | train_accuracy: 0.71651 | valid_auc: 0.76088 | valid_balanced_accuracy: 0.69485 | valid_accuracy: 0.69515 |  0:23:27s
epoch 86 | loss: 0.5613  | train_auc: 0.78968 | train_balanced_accuracy: 0.71366 | train_accuracy: 0.71387 | valid_auc: 0.76372 | valid_balanced_accuracy: 0.70439 | valid_accuracy: 0.7046  |  0:23:43s
epoch 87 | loss: 0.55532 | train_auc: 0.791   | train_balanced_accuracy: 0.7196  | train_accuracy: 0.71989 | valid_auc: 0.75894 | valid_balanced_accuracy: 0.69582 | valid_accuracy: 0.6961  |  0:24:01s
epoch 88 | loss: 0.55582 | train_auc: 0.79488 | train_balanced_accuracy: 0.71749 | train_accuracy: 0.71761 | valid_auc: 0.76071 | valid_balanced_accuracy: 0.69643 | valid_accuracy: 0.69657 |  0:24:18s
epoch 89 | loss: 0.55779 | train_auc: 0.79542 | train_balanced_accuracy: 0.72021 | train_accuracy: 0.72052 | valid_auc: 0.75951 | valid_balanced_accuracy: 0.69582 | valid_accuracy: 0.6961  |  0:24:35s
epoch 90 | loss: 0.55815 | train_auc: 0.7971  | train_balanced_accuracy: 0.72107 | train_accuracy: 0.72123 | valid_auc: 0.76014 | valid_balanced_accuracy: 0.6991  | valid_accuracy: 0.69924 |  0:24:51s
epoch 91 | loss: 0.55123 | train_auc: 0.7978  | train_balanced_accuracy: 0.72017 | train_accuracy: 0.7204  | valid_auc: 0.76044 | valid_balanced_accuracy: 0.69524 | valid_accuracy: 0.69547 |  0:25:08s
epoch 92 | loss: 0.54959 | train_auc: 0.80037 | train_balanced_accuracy: 0.72475 | train_accuracy: 0.72485 | valid_auc: 0.75922 | valid_balanced_accuracy: 0.69949 | valid_accuracy: 0.69956 |  0:25:23s
epoch 93 | loss: 0.55068 | train_auc: 0.7967  | train_balanced_accuracy: 0.72073 | train_accuracy: 0.72099 | valid_auc: 0.75886 | valid_balanced_accuracy: 0.70074 | valid_accuracy: 0.70098 |  0:25:38s
epoch 94 | loss: 0.55312 | train_auc: 0.79347 | train_balanced_accuracy: 0.72004 | train_accuracy: 0.72036 | valid_auc: 0.75391 | valid_balanced_accuracy: 0.69503 | valid_accuracy: 0.69531 |  0:25:55s
epoch 95 | loss: 0.55374 | train_auc: 0.78796 | train_balanced_accuracy: 0.71113 | train_accuracy: 0.71163 | valid_auc: 0.75673 | valid_balanced_accuracy: 0.69331 | valid_accuracy: 0.69374 |  0:26:12s
epoch 96 | loss: 0.54905 | train_auc: 0.79998 | train_balanced_accuracy: 0.7215  | train_accuracy: 0.7215  | valid_auc: 0.76025 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69515 |  0:26:29s
epoch 97 | loss: 0.54686 | train_auc: 0.79841 | train_balanced_accuracy: 0.72286 | train_accuracy: 0.72327 | valid_auc: 0.75751 | valid_balanced_accuracy: 0.69573 | valid_accuracy: 0.6961  |  0:26:45s
epoch 98 | loss: 0.54797 | train_auc: 0.79935 | train_balanced_accuracy: 0.72362 | train_accuracy: 0.7239  | valid_auc: 0.76029 | valid_balanced_accuracy: 0.69975 | valid_accuracy: 0.70003 |  0:27:04s
epoch 99 | loss: 0.54716 | train_auc: 0.79839 | train_balanced_accuracy: 0.71926 | train_accuracy: 0.71934 | valid_auc: 0.7585  | valid_balanced_accuracy: 0.68989 | valid_accuracy: 0.68996 |  0:27:20s
epoch 100| loss: 0.54805 | train_auc: 0.80247 | train_balanced_accuracy: 0.72714 | train_accuracy: 0.72725 | valid_auc: 0.76019 | valid_balanced_accuracy: 0.69976 | valid_accuracy: 0.69987 |  0:27:39s
epoch 101| loss: 0.54661 | train_auc: 0.80046 | train_balanced_accuracy: 0.72382 | train_accuracy: 0.7239  | valid_auc: 0.76195 | valid_balanced_accuracy: 0.69321 | valid_accuracy: 0.69326 |  0:27:54s
epoch 102| loss: 0.54735 | train_auc: 0.79656 | train_balanced_accuracy: 0.72226 | train_accuracy: 0.72229 | valid_auc: 0.75442 | valid_balanced_accuracy: 0.68965 | valid_accuracy: 0.68964 |  0:28:12s
epoch 103| loss: 0.54981 | train_auc: 0.80337 | train_balanced_accuracy: 0.72509 | train_accuracy: 0.72544 | valid_auc: 0.76136 | valid_balanced_accuracy: 0.69876 | valid_accuracy: 0.69909 |  0:28:31s
epoch 104| loss: 0.55076 | train_auc: 0.79723 | train_balanced_accuracy: 0.72015 | train_accuracy: 0.7202  | valid_auc: 0.75802 | valid_balanced_accuracy: 0.69355 | valid_accuracy: 0.69358 |  0:28:50s
epoch 105| loss: 0.54823 | train_auc: 0.79969 | train_balanced_accuracy: 0.72196 | train_accuracy: 0.72205 | valid_auc: 0.76031 | valid_balanced_accuracy: 0.6979  | valid_accuracy: 0.69799 |  0:29:05s
epoch 106| loss: 0.54925 | train_auc: 0.80039 | train_balanced_accuracy: 0.7256  | train_accuracy: 0.72587 | valid_auc: 0.75849 | valid_balanced_accuracy: 0.69647 | valid_accuracy: 0.69673 |  0:29:22s

Early stopping occurred at epoch 106 with best_epoch = 86 and best_valid_accuracy = 0.7046
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 46/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.698 total time=29.5min
[CV 3/5; 46/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7069  | train_auc: 0.5728  | train_balanced_accuracy: 0.56376 | train_accuracy: 0.56409 | valid_auc: 0.57576 | valid_balanced_accuracy: 0.56488 | valid_accuracy: 0.56516 |  0:00:14s
epoch 1  | loss: 0.6612  | train_auc: 0.62493 | train_balanced_accuracy: 0.50015 | train_accuracy: 0.5037  | valid_auc: 0.6384  | valid_balanced_accuracy: 0.50129 | valid_accuracy: 0.50488 |  0:00:30s
epoch 2  | loss: 0.64547 | train_auc: 0.6741  | train_balanced_accuracy: 0.5945  | train_accuracy: 0.59651 | valid_auc: 0.67451 | valid_balanced_accuracy: 0.60391 | valid_accuracy: 0.60592 |  0:00:48s
epoch 3  | loss: 0.63474 | train_auc: 0.67966 | train_balanced_accuracy: 0.62287 | train_accuracy: 0.62437 | valid_auc: 0.67757 | valid_balanced_accuracy: 0.62192 | valid_accuracy: 0.62339 |  0:01:03s
epoch 4  | loss: 0.62549 | train_auc: 0.69944 | train_balanced_accuracy: 0.62872 | train_accuracy: 0.63031 | valid_auc: 0.70011 | valid_balanced_accuracy: 0.63314 | valid_accuracy: 0.63472 |  0:01:20s
epoch 5  | loss: 0.62079 | train_auc: 0.7089  | train_balanced_accuracy: 0.65228 | train_accuracy: 0.65341 | valid_auc: 0.70681 | valid_balanced_accuracy: 0.65279 | valid_accuracy: 0.65392 |  0:01:36s
epoch 6  | loss: 0.61804 | train_auc: 0.71286 | train_balanced_accuracy: 0.6586  | train_accuracy: 0.65939 | valid_auc: 0.70949 | valid_balanced_accuracy: 0.6585  | valid_accuracy: 0.65927 |  0:01:54s
epoch 7  | loss: 0.61781 | train_auc: 0.71128 | train_balanced_accuracy: 0.65924 | train_accuracy: 0.66002 | valid_auc: 0.71072 | valid_balanced_accuracy: 0.65759 | valid_accuracy: 0.65833 |  0:02:12s
epoch 8  | loss: 0.61364 | train_auc: 0.71932 | train_balanced_accuracy: 0.66053 | train_accuracy: 0.66175 | valid_auc: 0.71423 | valid_balanced_accuracy: 0.65793 | valid_accuracy: 0.65911 |  0:02:29s
epoch 9  | loss: 0.61242 | train_auc: 0.71999 | train_balanced_accuracy: 0.66096 | train_accuracy: 0.66179 | valid_auc: 0.71298 | valid_balanced_accuracy: 0.6624  | valid_accuracy: 0.6632  |  0:02:45s
epoch 10 | loss: 0.60392 | train_auc: 0.71773 | train_balanced_accuracy: 0.66218 | train_accuracy: 0.66309 | valid_auc: 0.71532 | valid_balanced_accuracy: 0.65773 | valid_accuracy: 0.65864 |  0:03:00s
epoch 11 | loss: 0.60758 | train_auc: 0.72225 | train_balanced_accuracy: 0.6633  | train_accuracy: 0.66395 | valid_auc: 0.7145  | valid_balanced_accuracy: 0.6638  | valid_accuracy: 0.66446 |  0:03:17s
epoch 12 | loss: 0.60537 | train_auc: 0.72401 | train_balanced_accuracy: 0.66431 | train_accuracy: 0.66501 | valid_auc: 0.71705 | valid_balanced_accuracy: 0.66284 | valid_accuracy: 0.66352 |  0:03:33s
epoch 13 | loss: 0.60684 | train_auc: 0.72096 | train_balanced_accuracy: 0.66411 | train_accuracy: 0.66486 | valid_auc: 0.71171 | valid_balanced_accuracy: 0.66181 | valid_accuracy: 0.66257 |  0:03:51s
epoch 14 | loss: 0.60429 | train_auc: 0.72398 | train_balanced_accuracy: 0.66925 | train_accuracy: 0.66993 | valid_auc: 0.72131 | valid_balanced_accuracy: 0.66882 | valid_accuracy: 0.6695  |  0:04:08s
epoch 15 | loss: 0.60469 | train_auc: 0.72501 | train_balanced_accuracy: 0.6675  | train_accuracy: 0.668   | valid_auc: 0.72354 | valid_balanced_accuracy: 0.66679 | valid_accuracy: 0.6673  |  0:04:25s
epoch 16 | loss: 0.60188 | train_auc: 0.72723 | train_balanced_accuracy: 0.6658  | train_accuracy: 0.66596 | valid_auc: 0.72126 | valid_balanced_accuracy: 0.66152 | valid_accuracy: 0.66163 |  0:04:44s
epoch 17 | loss: 0.59625 | train_auc: 0.72737 | train_balanced_accuracy: 0.66447 | train_accuracy: 0.66482 | valid_auc: 0.72131 | valid_balanced_accuracy: 0.66313 | valid_accuracy: 0.66352 |  0:05:03s
epoch 18 | loss: 0.60782 | train_auc: 0.72573 | train_balanced_accuracy: 0.66744 | train_accuracy: 0.66816 | valid_auc: 0.71817 | valid_balanced_accuracy: 0.66109 | valid_accuracy: 0.66179 |  0:05:22s
epoch 19 | loss: 0.6016  | train_auc: 0.7299  | train_balanced_accuracy: 0.66871 | train_accuracy: 0.66934 | valid_auc: 0.72207 | valid_balanced_accuracy: 0.66367 | valid_accuracy: 0.66431 |  0:05:39s
epoch 20 | loss: 0.5996  | train_auc: 0.73143 | train_balanced_accuracy: 0.67016 | train_accuracy: 0.67072 | valid_auc: 0.72159 | valid_balanced_accuracy: 0.66247 | valid_accuracy: 0.66305 |  0:05:56s
epoch 21 | loss: 0.59074 | train_auc: 0.73818 | train_balanced_accuracy: 0.67178 | train_accuracy: 0.67229 | valid_auc: 0.72841 | valid_balanced_accuracy: 0.66711 | valid_accuracy: 0.66761 |  0:06:14s
epoch 22 | loss: 0.59991 | train_auc: 0.7348  | train_balanced_accuracy: 0.6742  | train_accuracy: 0.67469 | valid_auc: 0.7274  | valid_balanced_accuracy: 0.66586 | valid_accuracy: 0.66635 |  0:06:32s
epoch 23 | loss: 0.59541 | train_auc: 0.74121 | train_balanced_accuracy: 0.67818 | train_accuracy: 0.67871 | valid_auc: 0.73703 | valid_balanced_accuracy: 0.67861 | valid_accuracy: 0.6791  |  0:06:48s
epoch 24 | loss: 0.5953  | train_auc: 0.73885 | train_balanced_accuracy: 0.67694 | train_accuracy: 0.67737 | valid_auc: 0.73324 | valid_balanced_accuracy: 0.67081 | valid_accuracy: 0.67123 |  0:07:03s
epoch 25 | loss: 0.59386 | train_auc: 0.74703 | train_balanced_accuracy: 0.68475 | train_accuracy: 0.68512 | valid_auc: 0.74031 | valid_balanced_accuracy: 0.67999 | valid_accuracy: 0.68036 |  0:07:19s
epoch 26 | loss: 0.59163 | train_auc: 0.7518  | train_balanced_accuracy: 0.68501 | train_accuracy: 0.68571 | valid_auc: 0.74463 | valid_balanced_accuracy: 0.68169 | valid_accuracy: 0.6824  |  0:07:38s
epoch 27 | loss: 0.59224 | train_auc: 0.75398 | train_balanced_accuracy: 0.68689 | train_accuracy: 0.68713 | valid_auc: 0.74529 | valid_balanced_accuracy: 0.6817  | valid_accuracy: 0.68193 |  0:07:54s
epoch 28 | loss: 0.5896  | train_auc: 0.75324 | train_balanced_accuracy: 0.68812 | train_accuracy: 0.68839 | valid_auc: 0.7434  | valid_balanced_accuracy: 0.68514 | valid_accuracy: 0.6854  |  0:08:10s
epoch 29 | loss: 0.58846 | train_auc: 0.75379 | train_balanced_accuracy: 0.68905 | train_accuracy: 0.68921 | valid_auc: 0.7429  | valid_balanced_accuracy: 0.68415 | valid_accuracy: 0.68429 |  0:08:26s
epoch 30 | loss: 0.58788 | train_auc: 0.75724 | train_balanced_accuracy: 0.69061 | train_accuracy: 0.69094 | valid_auc: 0.74561 | valid_balanced_accuracy: 0.68289 | valid_accuracy: 0.68319 |  0:08:42s
epoch 31 | loss: 0.5916  | train_auc: 0.75252 | train_balanced_accuracy: 0.68878 | train_accuracy: 0.68909 | valid_auc: 0.74634 | valid_balanced_accuracy: 0.68035 | valid_accuracy: 0.68067 |  0:09:00s
epoch 32 | loss: 0.58357 | train_auc: 0.7515  | train_balanced_accuracy: 0.68662 | train_accuracy: 0.68685 | valid_auc: 0.74728 | valid_balanced_accuracy: 0.67901 | valid_accuracy: 0.67926 |  0:09:18s
epoch 33 | loss: 0.58831 | train_auc: 0.75111 | train_balanced_accuracy: 0.68728 | train_accuracy: 0.68768 | valid_auc: 0.74843 | valid_balanced_accuracy: 0.68484 | valid_accuracy: 0.68524 |  0:09:34s
epoch 34 | loss: 0.58608 | train_auc: 0.75643 | train_balanced_accuracy: 0.6863  | train_accuracy: 0.68669 | valid_auc: 0.74927 | valid_balanced_accuracy: 0.68247 | valid_accuracy: 0.68288 |  0:09:53s
epoch 35 | loss: 0.58595 | train_auc: 0.75582 | train_balanced_accuracy: 0.68716 | train_accuracy: 0.68748 | valid_auc: 0.74711 | valid_balanced_accuracy: 0.68224 | valid_accuracy: 0.68256 |  0:10:11s
epoch 36 | loss: 0.58966 | train_auc: 0.75629 | train_balanced_accuracy: 0.68727 | train_accuracy: 0.68748 | valid_auc: 0.74659 | valid_balanced_accuracy: 0.68027 | valid_accuracy: 0.68052 |  0:10:27s
epoch 37 | loss: 0.58418 | train_auc: 0.75731 | train_balanced_accuracy: 0.68729 | train_accuracy: 0.6878  | valid_auc: 0.74794 | valid_balanced_accuracy: 0.68314 | valid_accuracy: 0.68366 |  0:10:43s
epoch 38 | loss: 0.58334 | train_auc: 0.75937 | train_balanced_accuracy: 0.6895  | train_accuracy: 0.68964 | valid_auc: 0.74747 | valid_balanced_accuracy: 0.67689 | valid_accuracy: 0.67705 |  0:10:58s
epoch 39 | loss: 0.57972 | train_auc: 0.71891 | train_balanced_accuracy: 0.66861 | train_accuracy: 0.66856 | valid_auc: 0.71836 | valid_balanced_accuracy: 0.66499 | valid_accuracy: 0.66494 |  0:11:16s
epoch 40 | loss: 0.58399 | train_auc: 0.71959 | train_balanced_accuracy: 0.6648  | train_accuracy: 0.66494 | valid_auc: 0.72021 | valid_balanced_accuracy: 0.66432 | valid_accuracy: 0.66446 |  0:11:31s
epoch 41 | loss: 0.58325 | train_auc: 0.74244 | train_balanced_accuracy: 0.68049 | train_accuracy: 0.68079 | valid_auc: 0.74049 | valid_balanced_accuracy: 0.681   | valid_accuracy: 0.6813  |  0:11:47s
epoch 42 | loss: 0.57848 | train_auc: 0.74525 | train_balanced_accuracy: 0.68663 | train_accuracy: 0.68693 | valid_auc: 0.74221 | valid_balanced_accuracy: 0.68683 | valid_accuracy: 0.68713 |  0:12:03s
epoch 43 | loss: 0.58579 | train_auc: 0.75874 | train_balanced_accuracy: 0.68989 | train_accuracy: 0.68996 | valid_auc: 0.75351 | valid_balanced_accuracy: 0.69117 | valid_accuracy: 0.69122 |  0:12:19s
epoch 44 | loss: 0.5854  | train_auc: 0.76255 | train_balanced_accuracy: 0.69065 | train_accuracy: 0.69063 | valid_auc: 0.75377 | valid_balanced_accuracy: 0.68292 | valid_accuracy: 0.68288 |  0:12:36s
epoch 45 | loss: 0.58241 | train_auc: 0.7655  | train_balanced_accuracy: 0.69477 | train_accuracy: 0.69496 | valid_auc: 0.75325 | valid_balanced_accuracy: 0.68555 | valid_accuracy: 0.68571 |  0:12:49s
epoch 46 | loss: 0.5831  | train_auc: 0.76682 | train_balanced_accuracy: 0.69385 | train_accuracy: 0.69421 | valid_auc: 0.7516  | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68618 |  0:13:04s
epoch 47 | loss: 0.58127 | train_auc: 0.7628  | train_balanced_accuracy: 0.69172 | train_accuracy: 0.69208 | valid_auc: 0.74984 | valid_balanced_accuracy: 0.68175 | valid_accuracy: 0.68209 |  0:13:21s
epoch 48 | loss: 0.58456 | train_auc: 0.76006 | train_balanced_accuracy: 0.68828 | train_accuracy: 0.68839 | valid_auc: 0.74338 | valid_balanced_accuracy: 0.67187 | valid_accuracy: 0.67202 |  0:13:37s
epoch 49 | loss: 0.58219 | train_auc: 0.75866 | train_balanced_accuracy: 0.68738 | train_accuracy: 0.68787 | valid_auc: 0.74084 | valid_balanced_accuracy: 0.67733 | valid_accuracy: 0.67784 |  0:13:54s
epoch 50 | loss: 0.58451 | train_auc: 0.76443 | train_balanced_accuracy: 0.69238 | train_accuracy: 0.69263 | valid_auc: 0.74852 | valid_balanced_accuracy: 0.68313 | valid_accuracy: 0.68335 |  0:14:11s
epoch 51 | loss: 0.57794 | train_auc: 0.7608  | train_balanced_accuracy: 0.69144 | train_accuracy: 0.69177 | valid_auc: 0.74252 | valid_balanced_accuracy: 0.68303 | valid_accuracy: 0.68335 |  0:14:26s
epoch 52 | loss: 0.57385 | train_auc: 0.76979 | train_balanced_accuracy: 0.6955  | train_accuracy: 0.69574 | valid_auc: 0.74939 | valid_balanced_accuracy: 0.67948 | valid_accuracy: 0.67973 |  0:14:45s
epoch 53 | loss: 0.57706 | train_auc: 0.76394 | train_balanced_accuracy: 0.69374 | train_accuracy: 0.69385 | valid_auc: 0.74848 | valid_balanced_accuracy: 0.69079 | valid_accuracy: 0.6909  |  0:15:03s
epoch 54 | loss: 0.5772  | train_auc: 0.76905 | train_balanced_accuracy: 0.69666 | train_accuracy: 0.697   | valid_auc: 0.75407 | valid_balanced_accuracy: 0.68693 | valid_accuracy: 0.68728 |  0:15:21s
epoch 55 | loss: 0.57713 | train_auc: 0.76693 | train_balanced_accuracy: 0.69503 | train_accuracy: 0.69523 | valid_auc: 0.7483  | valid_balanced_accuracy: 0.68722 | valid_accuracy: 0.68744 |  0:15:39s
epoch 56 | loss: 0.57403 | train_auc: 0.76506 | train_balanced_accuracy: 0.69229 | train_accuracy: 0.69228 | valid_auc: 0.74533 | valid_balanced_accuracy: 0.67739 | valid_accuracy: 0.67737 |  0:15:56s
epoch 57 | loss: 0.58363 | train_auc: 0.76759 | train_balanced_accuracy: 0.69409 | train_accuracy: 0.69401 | valid_auc: 0.75459 | valid_balanced_accuracy: 0.68354 | valid_accuracy: 0.68351 |  0:16:12s
epoch 58 | loss: 0.5802  | train_auc: 0.77201 | train_balanced_accuracy: 0.69884 | train_accuracy: 0.69909 | valid_auc: 0.7516  | valid_balanced_accuracy: 0.68464 | valid_accuracy: 0.68492 |  0:16:30s
epoch 59 | loss: 0.57057 | train_auc: 0.77276 | train_balanced_accuracy: 0.69831 | train_accuracy: 0.69862 | valid_auc: 0.7533  | valid_balanced_accuracy: 0.68575 | valid_accuracy: 0.68602 |  0:16:46s
epoch 60 | loss: 0.57363 | train_auc: 0.77274 | train_balanced_accuracy: 0.69677 | train_accuracy: 0.6972  | valid_auc: 0.75389 | valid_balanced_accuracy: 0.68438 | valid_accuracy: 0.68477 |  0:17:01s
epoch 61 | loss: 0.57562 | train_auc: 0.77307 | train_balanced_accuracy: 0.6976  | train_accuracy: 0.69806 | valid_auc: 0.75383 | valid_balanced_accuracy: 0.68919 | valid_accuracy: 0.68964 |  0:17:17s
epoch 62 | loss: 0.572   | train_auc: 0.7692  | train_balanced_accuracy: 0.69493 | train_accuracy: 0.69531 | valid_auc: 0.75189 | valid_balanced_accuracy: 0.68674 | valid_accuracy: 0.68713 |  0:17:32s
epoch 63 | loss: 0.57309 | train_auc: 0.77697 | train_balanced_accuracy: 0.69926 | train_accuracy: 0.69983 | valid_auc: 0.75574 | valid_balanced_accuracy: 0.68721 | valid_accuracy: 0.68776 |  0:17:49s

Early stopping occurred at epoch 63 with best_epoch = 43 and best_valid_accuracy = 0.69122
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 46/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=17.9min
[CV 4/5; 46/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6899  | train_auc: 0.62752 | train_balanced_accuracy: 0.59074 | train_accuracy: 0.58935 | valid_auc: 0.61906 | valid_balanced_accuracy: 0.58684 | valid_accuracy: 0.58546 |  0:00:17s
epoch 1  | loss: 0.64866 | train_auc: 0.65866 | train_balanced_accuracy: 0.59744 | train_accuracy: 0.59632 | valid_auc: 0.64946 | valid_balanced_accuracy: 0.59067 | valid_accuracy: 0.58955 |  0:00:33s
epoch 2  | loss: 0.63531 | train_auc: 0.65955 | train_balanced_accuracy: 0.60024 | train_accuracy: 0.59927 | valid_auc: 0.65391 | valid_balanced_accuracy: 0.59307 | valid_accuracy: 0.59207 |  0:00:49s
epoch 3  | loss: 0.63559 | train_auc: 0.67019 | train_balanced_accuracy: 0.58153 | train_accuracy: 0.57932 | valid_auc: 0.66462 | valid_balanced_accuracy: 0.57289 | valid_accuracy: 0.57066 |  0:01:06s
epoch 4  | loss: 0.62564 | train_auc: 0.68339 | train_balanced_accuracy: 0.62223 | train_accuracy: 0.62103 | valid_auc: 0.68118 | valid_balanced_accuracy: 0.61847 | valid_accuracy: 0.61725 |  0:01:22s
epoch 5  | loss: 0.62472 | train_auc: 0.68716 | train_balanced_accuracy: 0.62162 | train_accuracy: 0.62055 | valid_auc: 0.68522 | valid_balanced_accuracy: 0.61596 | valid_accuracy: 0.61489 |  0:01:38s
epoch 6  | loss: 0.61868 | train_auc: 0.6976  | train_balanced_accuracy: 0.6317  | train_accuracy: 0.63047 | valid_auc: 0.69313 | valid_balanced_accuracy: 0.62102 | valid_accuracy: 0.61977 |  0:01:56s
epoch 7  | loss: 0.61683 | train_auc: 0.70895 | train_balanced_accuracy: 0.6446  | train_accuracy: 0.64357 | valid_auc: 0.70383 | valid_balanced_accuracy: 0.63511 | valid_accuracy: 0.63409 |  0:02:12s
epoch 8  | loss: 0.61919 | train_auc: 0.70794 | train_balanced_accuracy: 0.64417 | train_accuracy: 0.64393 | valid_auc: 0.7033  | valid_balanced_accuracy: 0.63855 | valid_accuracy: 0.63834 |  0:02:28s
epoch 9  | loss: 0.61257 | train_auc: 0.70493 | train_balanced_accuracy: 0.64025 | train_accuracy: 0.64011 | valid_auc: 0.70103 | valid_balanced_accuracy: 0.63862 | valid_accuracy: 0.6385  |  0:02:44s
epoch 10 | loss: 0.61007 | train_auc: 0.71505 | train_balanced_accuracy: 0.65982 | train_accuracy: 0.65962 | valid_auc: 0.7092  | valid_balanced_accuracy: 0.66084 | valid_accuracy: 0.66069 |  0:03:01s
epoch 11 | loss: 0.60816 | train_auc: 0.72384 | train_balanced_accuracy: 0.66633 | train_accuracy: 0.66631 | valid_auc: 0.7166  | valid_balanced_accuracy: 0.6641  | valid_accuracy: 0.66415 |  0:03:18s
epoch 12 | loss: 0.60208 | train_auc: 0.73148 | train_balanced_accuracy: 0.66949 | train_accuracy: 0.66922 | valid_auc: 0.7231  | valid_balanced_accuracy: 0.66778 | valid_accuracy: 0.66761 |  0:03:34s
epoch 13 | loss: 0.60219 | train_auc: 0.72994 | train_balanced_accuracy: 0.6703  | train_accuracy: 0.67044 | valid_auc: 0.72075 | valid_balanced_accuracy: 0.66456 | valid_accuracy: 0.66478 |  0:03:51s
epoch 14 | loss: 0.60263 | train_auc: 0.73073 | train_balanced_accuracy: 0.66799 | train_accuracy: 0.66789 | valid_auc: 0.72186 | valid_balanced_accuracy: 0.65742 | valid_accuracy: 0.65738 |  0:04:09s
epoch 15 | loss: 0.60241 | train_auc: 0.73475 | train_balanced_accuracy: 0.66913 | train_accuracy: 0.66895 | valid_auc: 0.72645 | valid_balanced_accuracy: 0.66272 | valid_accuracy: 0.66257 |  0:04:26s
epoch 16 | loss: 0.59562 | train_auc: 0.73646 | train_balanced_accuracy: 0.67507 | train_accuracy: 0.67501 | valid_auc: 0.73017 | valid_balanced_accuracy: 0.67437 | valid_accuracy: 0.67438 |  0:04:41s
epoch 17 | loss: 0.59809 | train_auc: 0.73562 | train_balanced_accuracy: 0.67224 | train_accuracy: 0.67225 | valid_auc: 0.72688 | valid_balanced_accuracy: 0.66378 | valid_accuracy: 0.66383 |  0:05:01s
epoch 18 | loss: 0.59814 | train_auc: 0.73952 | train_balanced_accuracy: 0.67206 | train_accuracy: 0.67237 | valid_auc: 0.72732 | valid_balanced_accuracy: 0.66504 | valid_accuracy: 0.66541 |  0:05:17s
epoch 19 | loss: 0.59384 | train_auc: 0.73775 | train_balanced_accuracy: 0.67181 | train_accuracy: 0.67218 | valid_auc: 0.72792 | valid_balanced_accuracy: 0.66298 | valid_accuracy: 0.66336 |  0:05:33s
epoch 20 | loss: 0.59861 | train_auc: 0.73492 | train_balanced_accuracy: 0.67185 | train_accuracy: 0.67257 | valid_auc: 0.72132 | valid_balanced_accuracy: 0.66478 | valid_accuracy: 0.66556 |  0:05:50s
epoch 21 | loss: 0.59655 | train_auc: 0.74286 | train_balanced_accuracy: 0.67199 | train_accuracy: 0.6728  | valid_auc: 0.72834 | valid_balanced_accuracy: 0.66489 | valid_accuracy: 0.66572 |  0:06:08s
epoch 22 | loss: 0.59794 | train_auc: 0.73897 | train_balanced_accuracy: 0.67436 | train_accuracy: 0.67465 | valid_auc: 0.72951 | valid_balanced_accuracy: 0.66729 | valid_accuracy: 0.66761 |  0:06:25s
epoch 23 | loss: 0.59929 | train_auc: 0.74517 | train_balanced_accuracy: 0.68615 | train_accuracy: 0.68614 | valid_auc: 0.73148 | valid_balanced_accuracy: 0.67906 | valid_accuracy: 0.6791  |  0:06:43s
epoch 24 | loss: 0.59672 | train_auc: 0.74691 | train_balanced_accuracy: 0.6828  | train_accuracy: 0.68303 | valid_auc: 0.73539 | valid_balanced_accuracy: 0.67326 | valid_accuracy: 0.67359 |  0:06:59s
epoch 25 | loss: 0.59144 | train_auc: 0.75267 | train_balanced_accuracy: 0.68639 | train_accuracy: 0.68661 | valid_auc: 0.74251 | valid_balanced_accuracy: 0.68162 | valid_accuracy: 0.68193 |  0:07:16s
epoch 26 | loss: 0.58879 | train_auc: 0.75687 | train_balanced_accuracy: 0.69116 | train_accuracy: 0.69145 | valid_auc: 0.74102 | valid_balanced_accuracy: 0.6835  | valid_accuracy: 0.68382 |  0:07:33s
epoch 27 | loss: 0.59203 | train_auc: 0.75718 | train_balanced_accuracy: 0.69026 | train_accuracy: 0.69043 | valid_auc: 0.7408  | valid_balanced_accuracy: 0.67843 | valid_accuracy: 0.67863 |  0:07:48s
epoch 28 | loss: 0.58775 | train_auc: 0.7591  | train_balanced_accuracy: 0.69095 | train_accuracy: 0.6911  | valid_auc: 0.74218 | valid_balanced_accuracy: 0.67954 | valid_accuracy: 0.67973 |  0:08:06s
epoch 29 | loss: 0.5881  | train_auc: 0.76182 | train_balanced_accuracy: 0.69087 | train_accuracy: 0.69079 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.67723 | valid_accuracy: 0.67721 |  0:08:22s
epoch 30 | loss: 0.58049 | train_auc: 0.76216 | train_balanced_accuracy: 0.69079 | train_accuracy: 0.69075 | valid_auc: 0.74131 | valid_balanced_accuracy: 0.67913 | valid_accuracy: 0.6791  |  0:08:39s
epoch 31 | loss: 0.58256 | train_auc: 0.75983 | train_balanced_accuracy: 0.69236 | train_accuracy: 0.69271 | valid_auc: 0.74294 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.6813  |  0:08:54s
epoch 32 | loss: 0.58213 | train_auc: 0.75701 | train_balanced_accuracy: 0.69011 | train_accuracy: 0.69023 | valid_auc: 0.74378 | valid_balanced_accuracy: 0.68054 | valid_accuracy: 0.68067 |  0:09:11s
epoch 33 | loss: 0.5868  | train_auc: 0.75646 | train_balanced_accuracy: 0.68621 | train_accuracy: 0.68646 | valid_auc: 0.74251 | valid_balanced_accuracy: 0.67439 | valid_accuracy: 0.67469 |  0:09:25s
epoch 34 | loss: 0.58197 | train_auc: 0.75932 | train_balanced_accuracy: 0.69106 | train_accuracy: 0.69118 | valid_auc: 0.74493 | valid_balanced_accuracy: 0.6816  | valid_accuracy: 0.68178 |  0:09:43s
epoch 35 | loss: 0.57583 | train_auc: 0.76372 | train_balanced_accuracy: 0.69141 | train_accuracy: 0.69181 | valid_auc: 0.74155 | valid_balanced_accuracy: 0.67631 | valid_accuracy: 0.67674 |  0:10:00s
epoch 36 | loss: 0.57787 | train_auc: 0.76493 | train_balanced_accuracy: 0.69337 | train_accuracy: 0.69346 | valid_auc: 0.75012 | valid_balanced_accuracy: 0.68213 | valid_accuracy: 0.68225 |  0:10:16s
epoch 37 | loss: 0.5792  | train_auc: 0.75942 | train_balanced_accuracy: 0.69098 | train_accuracy: 0.6909  | valid_auc: 0.73805 | valid_balanced_accuracy: 0.67442 | valid_accuracy: 0.67438 |  0:10:33s
epoch 38 | loss: 0.57843 | train_auc: 0.76521 | train_balanced_accuracy: 0.68745 | train_accuracy: 0.68724 | valid_auc: 0.7402  | valid_balanced_accuracy: 0.67001 | valid_accuracy: 0.66981 |  0:10:48s
epoch 39 | loss: 0.57879 | train_auc: 0.76716 | train_balanced_accuracy: 0.69203 | train_accuracy: 0.69212 | valid_auc: 0.74241 | valid_balanced_accuracy: 0.67821 | valid_accuracy: 0.67831 |  0:11:06s
epoch 40 | loss: 0.57474 | train_auc: 0.76757 | train_balanced_accuracy: 0.6944  | train_accuracy: 0.69452 | valid_auc: 0.74455 | valid_balanced_accuracy: 0.68085 | valid_accuracy: 0.68099 |  0:11:22s
epoch 41 | loss: 0.57792 | train_auc: 0.76492 | train_balanced_accuracy: 0.69208 | train_accuracy: 0.69244 | valid_auc: 0.74394 | valid_balanced_accuracy: 0.67619 | valid_accuracy: 0.67658 |  0:11:39s
epoch 42 | loss: 0.57222 | train_auc: 0.76617 | train_balanced_accuracy: 0.69411 | train_accuracy: 0.69468 | valid_auc: 0.74332 | valid_balanced_accuracy: 0.67994 | valid_accuracy: 0.68052 |  0:11:54s
epoch 43 | loss: 0.5765  | train_auc: 0.76183 | train_balanced_accuracy: 0.69274 | train_accuracy: 0.69299 | valid_auc: 0.74676 | valid_balanced_accuracy: 0.68178 | valid_accuracy: 0.68209 |  0:12:09s
epoch 44 | loss: 0.57857 | train_auc: 0.76502 | train_balanced_accuracy: 0.69546 | train_accuracy: 0.69582 | valid_auc: 0.74779 | valid_balanced_accuracy: 0.6842  | valid_accuracy: 0.68461 |  0:12:26s
epoch 45 | loss: 0.57285 | train_auc: 0.76516 | train_balanced_accuracy: 0.69125 | train_accuracy: 0.69212 | valid_auc: 0.74746 | valid_balanced_accuracy: 0.67863 | valid_accuracy: 0.67957 |  0:12:42s
epoch 46 | loss: 0.57846 | train_auc: 0.77428 | train_balanced_accuracy: 0.69845 | train_accuracy: 0.69854 | valid_auc: 0.74513 | valid_balanced_accuracy: 0.67459 | valid_accuracy: 0.67469 |  0:12:58s
epoch 47 | loss: 0.57294 | train_auc: 0.77754 | train_balanced_accuracy: 0.70302 | train_accuracy: 0.70322 | valid_auc: 0.74998 | valid_balanced_accuracy: 0.6842  | valid_accuracy: 0.68445 |  0:13:14s
epoch 48 | loss: 0.56861 | train_auc: 0.77769 | train_balanced_accuracy: 0.70221 | train_accuracy: 0.70247 | valid_auc: 0.75125 | valid_balanced_accuracy: 0.68465 | valid_accuracy: 0.68492 |  0:13:31s
epoch 49 | loss: 0.56762 | train_auc: 0.77287 | train_balanced_accuracy: 0.69676 | train_accuracy: 0.69716 | valid_auc: 0.74175 | valid_balanced_accuracy: 0.67583 | valid_accuracy: 0.67627 |  0:13:47s
epoch 50 | loss: 0.56942 | train_auc: 0.77955 | train_balanced_accuracy: 0.70087 | train_accuracy: 0.70113 | valid_auc: 0.74897 | valid_balanced_accuracy: 0.68571 | valid_accuracy: 0.68602 |  0:14:01s
epoch 51 | loss: 0.56608 | train_auc: 0.77563 | train_balanced_accuracy: 0.6987  | train_accuracy: 0.69885 | valid_auc: 0.74665 | valid_balanced_accuracy: 0.68111 | valid_accuracy: 0.6813  |  0:14:18s
epoch 52 | loss: 0.56623 | train_auc: 0.77436 | train_balanced_accuracy: 0.69735 | train_accuracy: 0.69747 | valid_auc: 0.74688 | valid_balanced_accuracy: 0.67815 | valid_accuracy: 0.67831 |  0:14:34s
epoch 53 | loss: 0.56964 | train_auc: 0.77982 | train_balanced_accuracy: 0.70783 | train_accuracy: 0.70802 | valid_auc: 0.75291 | valid_balanced_accuracy: 0.68833 | valid_accuracy: 0.68854 |  0:14:50s
epoch 54 | loss: 0.57012 | train_auc: 0.78147 | train_balanced_accuracy: 0.70707 | train_accuracy: 0.70723 | valid_auc: 0.74858 | valid_balanced_accuracy: 0.67748 | valid_accuracy: 0.67768 |  0:15:07s
epoch 55 | loss: 0.56564 | train_auc: 0.77863 | train_balanced_accuracy: 0.70268 | train_accuracy: 0.70267 | valid_auc: 0.74775 | valid_balanced_accuracy: 0.67958 | valid_accuracy: 0.67957 |  0:15:24s
epoch 56 | loss: 0.56651 | train_auc: 0.78393 | train_balanced_accuracy: 0.70635 | train_accuracy: 0.70652 | valid_auc: 0.74923 | valid_balanced_accuracy: 0.67998 | valid_accuracy: 0.6802  |  0:15:39s
epoch 57 | loss: 0.56726 | train_auc: 0.78188 | train_balanced_accuracy: 0.7055  | train_accuracy: 0.70578 | valid_auc: 0.74785 | valid_balanced_accuracy: 0.68383 | valid_accuracy: 0.68414 |  0:15:55s
epoch 58 | loss: 0.5703  | train_auc: 0.78314 | train_balanced_accuracy: 0.70335 | train_accuracy: 0.70338 | valid_auc: 0.74929 | valid_balanced_accuracy: 0.68232 | valid_accuracy: 0.6824  |  0:16:11s
epoch 59 | loss: 0.56519 | train_auc: 0.78255 | train_balanced_accuracy: 0.70609 | train_accuracy: 0.70629 | valid_auc: 0.75094 | valid_balanced_accuracy: 0.68488 | valid_accuracy: 0.68508 |  0:16:29s
epoch 60 | loss: 0.5627  | train_auc: 0.78755 | train_balanced_accuracy: 0.70663 | train_accuracy: 0.70711 | valid_auc: 0.75494 | valid_balanced_accuracy: 0.68439 | valid_accuracy: 0.68492 |  0:16:44s
epoch 61 | loss: 0.56118 | train_auc: 0.78428 | train_balanced_accuracy: 0.70614 | train_accuracy: 0.70652 | valid_auc: 0.75146 | valid_balanced_accuracy: 0.68701 | valid_accuracy: 0.68744 |  0:16:58s
epoch 62 | loss: 0.56375 | train_auc: 0.78256 | train_balanced_accuracy: 0.70415 | train_accuracy: 0.70432 | valid_auc: 0.74869 | valid_balanced_accuracy: 0.68048 | valid_accuracy: 0.68067 |  0:17:15s
epoch 63 | loss: 0.56197 | train_auc: 0.78573 | train_balanced_accuracy: 0.70873 | train_accuracy: 0.70896 | valid_auc: 0.74998 | valid_balanced_accuracy: 0.68761 | valid_accuracy: 0.68791 |  0:17:32s
epoch 64 | loss: 0.55855 | train_auc: 0.78592 | train_balanced_accuracy: 0.70826 | train_accuracy: 0.70829 | valid_auc: 0.74618 | valid_balanced_accuracy: 0.67997 | valid_accuracy: 0.68004 |  0:17:46s
epoch 65 | loss: 0.55885 | train_auc: 0.78283 | train_balanced_accuracy: 0.70611 | train_accuracy: 0.70633 | valid_auc: 0.74509 | valid_balanced_accuracy: 0.67916 | valid_accuracy: 0.67941 |  0:18:05s
epoch 66 | loss: 0.565   | train_auc: 0.77977 | train_balanced_accuracy: 0.70106 | train_accuracy: 0.70098 | valid_auc: 0.7409  | valid_balanced_accuracy: 0.67048 | valid_accuracy: 0.67044 |  0:18:20s
epoch 67 | loss: 0.55989 | train_auc: 0.7817  | train_balanced_accuracy: 0.70541 | train_accuracy: 0.70574 | valid_auc: 0.75149 | valid_balanced_accuracy: 0.68879 | valid_accuracy: 0.68917 |  0:18:35s
epoch 68 | loss: 0.56381 | train_auc: 0.78484 | train_balanced_accuracy: 0.70547 | train_accuracy: 0.70593 | valid_auc: 0.75133 | valid_balanced_accuracy: 0.68772 | valid_accuracy: 0.68823 |  0:18:52s
epoch 69 | loss: 0.56447 | train_auc: 0.78545 | train_balanced_accuracy: 0.70719 | train_accuracy: 0.70747 | valid_auc: 0.75384 | valid_balanced_accuracy: 0.69091 | valid_accuracy: 0.69122 |  0:19:07s
epoch 70 | loss: 0.55904 | train_auc: 0.78656 | train_balanced_accuracy: 0.70723 | train_accuracy: 0.70763 | valid_auc: 0.75307 | valid_balanced_accuracy: 0.68464 | valid_accuracy: 0.68508 |  0:19:23s
epoch 71 | loss: 0.55948 | train_auc: 0.78862 | train_balanced_accuracy: 0.70925 | train_accuracy: 0.70967 | valid_auc: 0.75429 | valid_balanced_accuracy: 0.69076 | valid_accuracy: 0.69122 |  0:19:39s
epoch 72 | loss: 0.55621 | train_auc: 0.78962 | train_balanced_accuracy: 0.71092 | train_accuracy: 0.71132 | valid_auc: 0.75442 | valid_balanced_accuracy: 0.68972 | valid_accuracy: 0.69012 |  0:19:55s
epoch 73 | loss: 0.55805 | train_auc: 0.79077 | train_balanced_accuracy: 0.71119 | train_accuracy: 0.71124 | valid_auc: 0.75516 | valid_balanced_accuracy: 0.69238 | valid_accuracy: 0.69248 |  0:20:12s
epoch 74 | loss: 0.55938 | train_auc: 0.79105 | train_balanced_accuracy: 0.70787 | train_accuracy: 0.70845 | valid_auc: 0.74791 | valid_balanced_accuracy: 0.6837  | valid_accuracy: 0.68429 |  0:20:29s
epoch 75 | loss: 0.55983 | train_auc: 0.78567 | train_balanced_accuracy: 0.70737 | train_accuracy: 0.70759 | valid_auc: 0.749   | valid_balanced_accuracy: 0.68486 | valid_accuracy: 0.68508 |  0:20:45s
epoch 76 | loss: 0.55969 | train_auc: 0.788   | train_balanced_accuracy: 0.70836 | train_accuracy: 0.70837 | valid_auc: 0.74847 | valid_balanced_accuracy: 0.68001 | valid_accuracy: 0.68004 |  0:21:03s
epoch 77 | loss: 0.55716 | train_auc: 0.79316 | train_balanced_accuracy: 0.71325 | train_accuracy: 0.71345 | valid_auc: 0.75298 | valid_balanced_accuracy: 0.685   | valid_accuracy: 0.68524 |  0:21:17s
epoch 78 | loss: 0.54592 | train_auc: 0.79711 | train_balanced_accuracy: 0.7149  | train_accuracy: 0.71506 | valid_auc: 0.7599  | valid_balanced_accuracy: 0.6934  | valid_accuracy: 0.69358 |  0:21:33s
epoch 79 | loss: 0.54794 | train_auc: 0.79425 | train_balanced_accuracy: 0.70866 | train_accuracy: 0.70857 | valid_auc: 0.75905 | valid_balanced_accuracy: 0.68702 | valid_accuracy: 0.68697 |  0:21:51s
epoch 80 | loss: 0.55553 | train_auc: 0.79708 | train_balanced_accuracy: 0.71628 | train_accuracy: 0.71632 | valid_auc: 0.75546 | valid_balanced_accuracy: 0.68531 | valid_accuracy: 0.6854  |  0:22:07s
epoch 81 | loss: 0.55152 | train_auc: 0.79697 | train_balanced_accuracy: 0.71216 | train_accuracy: 0.71203 | valid_auc: 0.75199 | valid_balanced_accuracy: 0.67682 | valid_accuracy: 0.67674 |  0:22:24s
epoch 82 | loss: 0.55002 | train_auc: 0.79726 | train_balanced_accuracy: 0.71639 | train_accuracy: 0.71679 | valid_auc: 0.75628 | valid_balanced_accuracy: 0.69031 | valid_accuracy: 0.69075 |  0:22:42s
epoch 83 | loss: 0.55084 | train_auc: 0.79579 | train_balanced_accuracy: 0.71081 | train_accuracy: 0.71065 | valid_auc: 0.75236 | valid_balanced_accuracy: 0.68017 | valid_accuracy: 0.68004 |  0:22:57s
epoch 84 | loss: 0.54972 | train_auc: 0.78729 | train_balanced_accuracy: 0.7077  | train_accuracy: 0.70814 | valid_auc: 0.75208 | valid_balanced_accuracy: 0.68606 | valid_accuracy: 0.6865  |  0:23:13s
epoch 85 | loss: 0.5516  | train_auc: 0.79159 | train_balanced_accuracy: 0.7104  | train_accuracy: 0.71069 | valid_auc: 0.75121 | valid_balanced_accuracy: 0.68649 | valid_accuracy: 0.68681 |  0:23:31s
epoch 86 | loss: 0.55637 | train_auc: 0.79237 | train_balanced_accuracy: 0.71224 | train_accuracy: 0.71246 | valid_auc: 0.75133 | valid_balanced_accuracy: 0.68593 | valid_accuracy: 0.68618 |  0:23:47s
epoch 87 | loss: 0.54922 | train_auc: 0.79793 | train_balanced_accuracy: 0.71431 | train_accuracy: 0.71412 | valid_auc: 0.75385 | valid_balanced_accuracy: 0.6846  | valid_accuracy: 0.68445 |  0:24:03s
epoch 88 | loss: 0.54855 | train_auc: 0.79998 | train_balanced_accuracy: 0.71906 | train_accuracy: 0.71943 | valid_auc: 0.75803 | valid_balanced_accuracy: 0.69146 | valid_accuracy: 0.69185 |  0:24:19s
epoch 89 | loss: 0.54597 | train_auc: 0.80267 | train_balanced_accuracy: 0.7183  | train_accuracy: 0.71825 | valid_auc: 0.75986 | valid_balanced_accuracy: 0.68935 | valid_accuracy: 0.68933 |  0:24:36s
epoch 90 | loss: 0.54515 | train_auc: 0.80315 | train_balanced_accuracy: 0.72097 | train_accuracy: 0.72092 | valid_auc: 0.75512 | valid_balanced_accuracy: 0.68336 | valid_accuracy: 0.68335 |  0:24:51s
epoch 91 | loss: 0.54457 | train_auc: 0.8024  | train_balanced_accuracy: 0.7201  | train_accuracy: 0.72018 | valid_auc: 0.75373 | valid_balanced_accuracy: 0.68486 | valid_accuracy: 0.68492 |  0:25:08s
epoch 92 | loss: 0.54505 | train_auc: 0.79974 | train_balanced_accuracy: 0.71631 | train_accuracy: 0.71632 | valid_auc: 0.75462 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68839 |  0:25:24s
epoch 93 | loss: 0.54359 | train_auc: 0.80317 | train_balanced_accuracy: 0.71894 | train_accuracy: 0.71907 | valid_auc: 0.75434 | valid_balanced_accuracy: 0.68525 | valid_accuracy: 0.6854  |  0:25:41s
epoch 94 | loss: 0.54731 | train_auc: 0.79937 | train_balanced_accuracy: 0.71634 | train_accuracy: 0.71644 | valid_auc: 0.74997 | valid_balanced_accuracy: 0.67773 | valid_accuracy: 0.67784 |  0:25:58s
epoch 95 | loss: 0.54388 | train_auc: 0.79816 | train_balanced_accuracy: 0.71603 | train_accuracy: 0.71644 | valid_auc: 0.75481 | valid_balanced_accuracy: 0.68387 | valid_accuracy: 0.68429 |  0:26:16s
epoch 96 | loss: 0.55004 | train_auc: 0.80321 | train_balanced_accuracy: 0.71838 | train_accuracy: 0.71841 | valid_auc: 0.7581  | valid_balanced_accuracy: 0.68238 | valid_accuracy: 0.6824  |  0:26:32s
epoch 97 | loss: 0.54104 | train_auc: 0.8061  | train_balanced_accuracy: 0.72239 | train_accuracy: 0.72266 | valid_auc: 0.75837 | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69059 |  0:26:50s
epoch 98 | loss: 0.54143 | train_auc: 0.80652 | train_balanced_accuracy: 0.72321 | train_accuracy: 0.72348 | valid_auc: 0.75827 | valid_balanced_accuracy: 0.68512 | valid_accuracy: 0.6854  |  0:27:05s

Early stopping occurred at epoch 98 with best_epoch = 78 and best_valid_accuracy = 0.69358
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 46/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=27.2min
[CV 5/5; 46/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70686 | train_auc: 0.54833 | train_balanced_accuracy: 0.53252 | train_accuracy: 0.53329 | valid_auc: 0.54612 | valid_balanced_accuracy: 0.52356 | valid_accuracy: 0.52439 |  0:00:15s
epoch 1  | loss: 0.65533 | train_auc: 0.58648 | train_balanced_accuracy: 0.5342  | train_accuracy: 0.53702 | valid_auc: 0.58064 | valid_balanced_accuracy: 0.53148 | valid_accuracy: 0.53431 |  0:00:32s
epoch 2  | loss: 0.64457 | train_auc: 0.61412 | train_balanced_accuracy: 0.55297 | train_accuracy: 0.55477 | valid_auc: 0.61396 | valid_balanced_accuracy: 0.55201 | valid_accuracy: 0.55382 |  0:00:48s
epoch 3  | loss: 0.63623 | train_auc: 0.64475 | train_balanced_accuracy: 0.57475 | train_accuracy: 0.57664 | valid_auc: 0.63451 | valid_balanced_accuracy: 0.56669 | valid_accuracy: 0.56862 |  0:01:04s
epoch 4  | loss: 0.62185 | train_auc: 0.68832 | train_balanced_accuracy: 0.64393 | train_accuracy: 0.64487 | valid_auc: 0.68562 | valid_balanced_accuracy: 0.63993 | valid_accuracy: 0.64086 |  0:01:19s
epoch 5  | loss: 0.61422 | train_auc: 0.70358 | train_balanced_accuracy: 0.65289 | train_accuracy: 0.65286 | valid_auc: 0.69942 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65061 |  0:01:37s
epoch 6  | loss: 0.61313 | train_auc: 0.71045 | train_balanced_accuracy: 0.64676 | train_accuracy: 0.64802 | valid_auc: 0.70435 | valid_balanced_accuracy: 0.64509 | valid_accuracy: 0.64636 |  0:01:55s
epoch 7  | loss: 0.61043 | train_auc: 0.70869 | train_balanced_accuracy: 0.65223 | train_accuracy: 0.65317 | valid_auc: 0.70512 | valid_balanced_accuracy: 0.64994 | valid_accuracy: 0.65093 |  0:02:10s
epoch 8  | loss: 0.61251 | train_auc: 0.71745 | train_balanced_accuracy: 0.65652 | train_accuracy: 0.65699 | valid_auc: 0.71241 | valid_balanced_accuracy: 0.65416 | valid_accuracy: 0.65471 |  0:02:25s
epoch 9  | loss: 0.60476 | train_auc: 0.72138 | train_balanced_accuracy: 0.66498 | train_accuracy: 0.66533 | valid_auc: 0.71588 | valid_balanced_accuracy: 0.6611  | valid_accuracy: 0.66147 |  0:02:42s
epoch 10 | loss: 0.60071 | train_auc: 0.71852 | train_balanced_accuracy: 0.66251 | train_accuracy: 0.66324 | valid_auc: 0.71349 | valid_balanced_accuracy: 0.662   | valid_accuracy: 0.66273 |  0:03:00s
epoch 11 | loss: 0.60028 | train_auc: 0.71757 | train_balanced_accuracy: 0.66292 | train_accuracy: 0.66352 | valid_auc: 0.71267 | valid_balanced_accuracy: 0.65913 | valid_accuracy: 0.65974 |  0:03:18s
epoch 12 | loss: 0.59934 | train_auc: 0.72066 | train_balanced_accuracy: 0.66539 | train_accuracy: 0.66619 | valid_auc: 0.71955 | valid_balanced_accuracy: 0.66271 | valid_accuracy: 0.66352 |  0:03:34s
epoch 13 | loss: 0.60198 | train_auc: 0.72944 | train_balanced_accuracy: 0.6719  | train_accuracy: 0.67221 | valid_auc: 0.72727 | valid_balanced_accuracy: 0.66223 | valid_accuracy: 0.66257 |  0:03:50s
epoch 14 | loss: 0.59291 | train_auc: 0.72996 | train_balanced_accuracy: 0.67385 | train_accuracy: 0.67418 | valid_auc: 0.7289  | valid_balanced_accuracy: 0.67229 | valid_accuracy: 0.67265 |  0:04:07s
epoch 15 | loss: 0.59168 | train_auc: 0.7267  | train_balanced_accuracy: 0.66677 | train_accuracy: 0.66737 | valid_auc: 0.72665 | valid_balanced_accuracy: 0.66525 | valid_accuracy: 0.66588 |  0:04:24s
epoch 16 | loss: 0.59464 | train_auc: 0.73382 | train_balanced_accuracy: 0.6771  | train_accuracy: 0.67745 | valid_auc: 0.73252 | valid_balanced_accuracy: 0.6753  | valid_accuracy: 0.67564 |  0:04:40s
epoch 17 | loss: 0.59628 | train_auc: 0.7392  | train_balanced_accuracy: 0.67453 | train_accuracy: 0.6752  | valid_auc: 0.73339 | valid_balanced_accuracy: 0.66773 | valid_accuracy: 0.6684  |  0:04:57s
epoch 18 | loss: 0.59076 | train_auc: 0.73824 | train_balanced_accuracy: 0.67121 | train_accuracy: 0.67198 | valid_auc: 0.72887 | valid_balanced_accuracy: 0.66306 | valid_accuracy: 0.66383 |  0:05:13s
epoch 19 | loss: 0.5927  | train_auc: 0.73499 | train_balanced_accuracy: 0.66924 | train_accuracy: 0.66997 | valid_auc: 0.73115 | valid_balanced_accuracy: 0.66499 | valid_accuracy: 0.66572 |  0:05:31s
epoch 20 | loss: 0.5907  | train_auc: 0.74215 | train_balanced_accuracy: 0.67419 | train_accuracy: 0.67485 | valid_auc: 0.73294 | valid_balanced_accuracy: 0.66855 | valid_accuracy: 0.66918 |  0:05:47s
epoch 21 | loss: 0.58653 | train_auc: 0.73841 | train_balanced_accuracy: 0.6754  | train_accuracy: 0.67599 | valid_auc: 0.73525 | valid_balanced_accuracy: 0.66894 | valid_accuracy: 0.6695  |  0:06:02s
epoch 22 | loss: 0.58615 | train_auc: 0.74825 | train_balanced_accuracy: 0.68223 | train_accuracy: 0.68268 | valid_auc: 0.73872 | valid_balanced_accuracy: 0.6741  | valid_accuracy: 0.67454 |  0:06:17s
epoch 23 | loss: 0.58351 | train_auc: 0.74799 | train_balanced_accuracy: 0.67939 | train_accuracy: 0.67997 | valid_auc: 0.74361 | valid_balanced_accuracy: 0.67305 | valid_accuracy: 0.67359 |  0:06:34s
epoch 24 | loss: 0.58928 | train_auc: 0.75516 | train_balanced_accuracy: 0.68746 | train_accuracy: 0.68799 | valid_auc: 0.74432 | valid_balanced_accuracy: 0.67749 | valid_accuracy: 0.678   |  0:06:51s
epoch 25 | loss: 0.58617 | train_auc: 0.75543 | train_balanced_accuracy: 0.68828 | train_accuracy: 0.68858 | valid_auc: 0.74609 | valid_balanced_accuracy: 0.68004 | valid_accuracy: 0.68036 |  0:07:07s
epoch 26 | loss: 0.58619 | train_auc: 0.75292 | train_balanced_accuracy: 0.68515 | train_accuracy: 0.68567 | valid_auc: 0.74237 | valid_balanced_accuracy: 0.66863 | valid_accuracy: 0.66918 |  0:07:24s
epoch 27 | loss: 0.58507 | train_auc: 0.75679 | train_balanced_accuracy: 0.68767 | train_accuracy: 0.68807 | valid_auc: 0.74931 | valid_balanced_accuracy: 0.68091 | valid_accuracy: 0.6813  |  0:07:40s
epoch 28 | loss: 0.58562 | train_auc: 0.76247 | train_balanced_accuracy: 0.69751 | train_accuracy: 0.69783 | valid_auc: 0.75097 | valid_balanced_accuracy: 0.69012 | valid_accuracy: 0.69043 |  0:07:56s
epoch 29 | loss: 0.58441 | train_auc: 0.7624  | train_balanced_accuracy: 0.69104 | train_accuracy: 0.69138 | valid_auc: 0.74828 | valid_balanced_accuracy: 0.68199 | valid_accuracy: 0.68225 |  0:08:13s
epoch 30 | loss: 0.58573 | train_auc: 0.76423 | train_balanced_accuracy: 0.69574 | train_accuracy: 0.69602 | valid_auc: 0.75001 | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69059 |  0:08:30s
epoch 31 | loss: 0.58351 | train_auc: 0.76514 | train_balanced_accuracy: 0.69188 | train_accuracy: 0.69201 | valid_auc: 0.75445 | valid_balanced_accuracy: 0.68467 | valid_accuracy: 0.68477 |  0:08:47s
epoch 32 | loss: 0.5876  | train_auc: 0.74838 | train_balanced_accuracy: 0.68162 | train_accuracy: 0.68174 | valid_auc: 0.73567 | valid_balanced_accuracy: 0.67633 | valid_accuracy: 0.67642 |  0:09:02s
epoch 33 | loss: 0.58852 | train_auc: 0.76467 | train_balanced_accuracy: 0.69184 | train_accuracy: 0.69248 | valid_auc: 0.74749 | valid_balanced_accuracy: 0.67607 | valid_accuracy: 0.67674 |  0:09:17s
epoch 34 | loss: 0.57921 | train_auc: 0.76897 | train_balanced_accuracy: 0.69621 | train_accuracy: 0.69637 | valid_auc: 0.75699 | valid_balanced_accuracy: 0.69172 | valid_accuracy: 0.69185 |  0:09:35s
epoch 35 | loss: 0.57694 | train_auc: 0.76846 | train_balanced_accuracy: 0.69513 | train_accuracy: 0.69527 | valid_auc: 0.75235 | valid_balanced_accuracy: 0.68719 | valid_accuracy: 0.68728 |  0:09:51s
epoch 36 | loss: 0.5721  | train_auc: 0.76903 | train_balanced_accuracy: 0.69613 | train_accuracy: 0.6959  | valid_auc: 0.75767 | valid_balanced_accuracy: 0.68735 | valid_accuracy: 0.68713 |  0:10:06s
epoch 37 | loss: 0.57698 | train_auc: 0.76671 | train_balanced_accuracy: 0.69637 | train_accuracy: 0.69657 | valid_auc: 0.75347 | valid_balanced_accuracy: 0.68615 | valid_accuracy: 0.68634 |  0:10:22s
epoch 38 | loss: 0.57553 | train_auc: 0.76726 | train_balanced_accuracy: 0.69409 | train_accuracy: 0.69381 | valid_auc: 0.7522  | valid_balanced_accuracy: 0.68427 | valid_accuracy: 0.68398 |  0:10:38s
epoch 39 | loss: 0.57932 | train_auc: 0.77162 | train_balanced_accuracy: 0.69716 | train_accuracy: 0.69755 | valid_auc: 0.75723 | valid_balanced_accuracy: 0.6952  | valid_accuracy: 0.69562 |  0:10:54s
epoch 40 | loss: 0.57503 | train_auc: 0.76942 | train_balanced_accuracy: 0.69818 | train_accuracy: 0.6981  | valid_auc: 0.7532  | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68823 |  0:11:10s
epoch 41 | loss: 0.57482 | train_auc: 0.76774 | train_balanced_accuracy: 0.69793 | train_accuracy: 0.69834 | valid_auc: 0.75389 | valid_balanced_accuracy: 0.68703 | valid_accuracy: 0.68744 |  0:11:27s
epoch 42 | loss: 0.57591 | train_auc: 0.77058 | train_balanced_accuracy: 0.69481 | train_accuracy: 0.69543 | valid_auc: 0.75529 | valid_balanced_accuracy: 0.68569 | valid_accuracy: 0.68634 |  0:11:42s
epoch 43 | loss: 0.57186 | train_auc: 0.7774  | train_balanced_accuracy: 0.70433 | train_accuracy: 0.70467 | valid_auc: 0.75817 | valid_balanced_accuracy: 0.69357 | valid_accuracy: 0.69389 |  0:11:57s
epoch 44 | loss: 0.57093 | train_auc: 0.7731  | train_balanced_accuracy: 0.70346 | train_accuracy: 0.70377 | valid_auc: 0.75282 | valid_balanced_accuracy: 0.68807 | valid_accuracy: 0.68839 |  0:12:14s
epoch 45 | loss: 0.57389 | train_auc: 0.76537 | train_balanced_accuracy: 0.69554 | train_accuracy: 0.69598 | valid_auc: 0.75171 | valid_balanced_accuracy: 0.68639 | valid_accuracy: 0.68681 |  0:12:29s
epoch 46 | loss: 0.57928 | train_auc: 0.64282 | train_balanced_accuracy: 0.59027 | train_accuracy: 0.58959 | valid_auc: 0.64188 | valid_balanced_accuracy: 0.591   | valid_accuracy: 0.59034 |  0:12:46s
epoch 47 | loss: 0.57327 | train_auc: 0.65582 | train_balanced_accuracy: 0.61028 | train_accuracy: 0.61111 | valid_auc: 0.65745 | valid_balanced_accuracy: 0.6142  | valid_accuracy: 0.61505 |  0:13:02s
epoch 48 | loss: 0.5709  | train_auc: 0.73557 | train_balanced_accuracy: 0.67337 | train_accuracy: 0.67391 | valid_auc: 0.72752 | valid_balanced_accuracy: 0.66648 | valid_accuracy: 0.66698 |  0:13:17s
epoch 49 | loss: 0.56672 | train_auc: 0.76252 | train_balanced_accuracy: 0.68942 | train_accuracy: 0.68996 | valid_auc: 0.74296 | valid_balanced_accuracy: 0.66947 | valid_accuracy: 0.66997 |  0:13:34s
epoch 50 | loss: 0.56913 | train_auc: 0.77547 | train_balanced_accuracy: 0.70232 | train_accuracy: 0.70259 | valid_auc: 0.75924 | valid_balanced_accuracy: 0.6905  | valid_accuracy: 0.69075 |  0:13:52s
epoch 51 | loss: 0.56813 | train_auc: 0.77404 | train_balanced_accuracy: 0.70527 | train_accuracy: 0.70566 | valid_auc: 0.75259 | valid_balanced_accuracy: 0.68484 | valid_accuracy: 0.68524 |  0:14:10s
epoch 52 | loss: 0.56797 | train_auc: 0.77608 | train_balanced_accuracy: 0.70411 | train_accuracy: 0.70416 | valid_auc: 0.75798 | valid_balanced_accuracy: 0.68519 | valid_accuracy: 0.68524 |  0:14:27s
epoch 53 | loss: 0.57678 | train_auc: 0.77867 | train_balanced_accuracy: 0.70331 | train_accuracy: 0.70369 | valid_auc: 0.7599  | valid_balanced_accuracy: 0.69149 | valid_accuracy: 0.69185 |  0:14:42s
epoch 54 | loss: 0.56986 | train_auc: 0.78206 | train_balanced_accuracy: 0.70353 | train_accuracy: 0.70404 | valid_auc: 0.76183 | valid_balanced_accuracy: 0.68879 | valid_accuracy: 0.68933 |  0:14:57s
epoch 55 | loss: 0.57096 | train_auc: 0.77915 | train_balanced_accuracy: 0.70515 | train_accuracy: 0.70519 | valid_auc: 0.76208 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68839 |  0:15:14s
epoch 56 | loss: 0.57262 | train_auc: 0.77532 | train_balanced_accuracy: 0.70245 | train_accuracy: 0.70235 | valid_auc: 0.75583 | valid_balanced_accuracy: 0.683   | valid_accuracy: 0.68288 |  0:15:33s
epoch 57 | loss: 0.57163 | train_auc: 0.75731 | train_balanced_accuracy: 0.69242 | train_accuracy: 0.69252 | valid_auc: 0.74247 | valid_balanced_accuracy: 0.67427 | valid_accuracy: 0.67438 |  0:15:48s
epoch 58 | loss: 0.58089 | train_auc: 0.75275 | train_balanced_accuracy: 0.67801 | train_accuracy: 0.6776  | valid_auc: 0.73959 | valid_balanced_accuracy: 0.66787 | valid_accuracy: 0.66745 |  0:16:06s
epoch 59 | loss: 0.57753 | train_auc: 0.7594  | train_balanced_accuracy: 0.6906  | train_accuracy: 0.69114 | valid_auc: 0.74766 | valid_balanced_accuracy: 0.67648 | valid_accuracy: 0.67705 |  0:16:23s

Early stopping occurred at epoch 59 with best_epoch = 39 and best_valid_accuracy = 0.69562
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 46/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=16.5min
[CV 1/5; 47/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71515 | train_auc: 0.55501 | train_balanced_accuracy: 0.54364 | train_accuracy: 0.54232 | valid_auc: 0.55585 | valid_balanced_accuracy: 0.54248 | valid_accuracy: 0.54108 |  0:00:18s
epoch 1  | loss: 0.65681 | train_auc: 0.5719  | train_balanced_accuracy: 0.54086 | train_accuracy: 0.53909 | valid_auc: 0.57031 | valid_balanced_accuracy: 0.54325 | valid_accuracy: 0.54139 |  0:00:34s
epoch 2  | loss: 0.64269 | train_auc: 0.64193 | train_balanced_accuracy: 0.54369 | train_accuracy: 0.54133 | valid_auc: 0.64525 | valid_balanced_accuracy: 0.54727 | valid_accuracy: 0.54485 |  0:00:51s
epoch 3  | loss: 0.63264 | train_auc: 0.65036 | train_balanced_accuracy: 0.55085 | train_accuracy: 0.54849 | valid_auc: 0.65276 | valid_balanced_accuracy: 0.55213 | valid_accuracy: 0.54973 |  0:01:09s
epoch 4  | loss: 0.62125 | train_auc: 0.66768 | train_balanced_accuracy: 0.5867  | train_accuracy: 0.58509 | valid_auc: 0.67028 | valid_balanced_accuracy: 0.58775 | valid_accuracy: 0.58609 |  0:01:24s
epoch 5  | loss: 0.61887 | train_auc: 0.67078 | train_balanced_accuracy: 0.60286 | train_accuracy: 0.60165 | valid_auc: 0.67601 | valid_balanced_accuracy: 0.60649 | valid_accuracy: 0.60529 |  0:01:39s
epoch 6  | loss: 0.61729 | train_auc: 0.67767 | train_balanced_accuracy: 0.61535 | train_accuracy: 0.61448 | valid_auc: 0.67983 | valid_balanced_accuracy: 0.62218 | valid_accuracy: 0.62134 |  0:01:55s
epoch 7  | loss: 0.61434 | train_auc: 0.68656 | train_balanced_accuracy: 0.62305 | train_accuracy: 0.62239 | valid_auc: 0.68692 | valid_balanced_accuracy: 0.62233 | valid_accuracy: 0.62166 |  0:02:13s
epoch 8  | loss: 0.6073  | train_auc: 0.68764 | train_balanced_accuracy: 0.62668 | train_accuracy: 0.6264  | valid_auc: 0.68772 | valid_balanced_accuracy: 0.62899 | valid_accuracy: 0.62874 |  0:02:31s
epoch 9  | loss: 0.61271 | train_auc: 0.69218 | train_balanced_accuracy: 0.62036 | train_accuracy: 0.61932 | valid_auc: 0.69368 | valid_balanced_accuracy: 0.6147  | valid_accuracy: 0.61363 |  0:02:51s
epoch 10 | loss: 0.60388 | train_auc: 0.69501 | train_balanced_accuracy: 0.63013 | train_accuracy: 0.62982 | valid_auc: 0.69836 | valid_balanced_accuracy: 0.6358  | valid_accuracy: 0.63551 |  0:03:08s
epoch 11 | loss: 0.60453 | train_auc: 0.70933 | train_balanced_accuracy: 0.65723 | train_accuracy: 0.65772 | valid_auc: 0.70683 | valid_balanced_accuracy: 0.65161 | valid_accuracy: 0.65219 |  0:03:26s
epoch 12 | loss: 0.60336 | train_auc: 0.70872 | train_balanced_accuracy: 0.65194 | train_accuracy: 0.65257 | valid_auc: 0.70762 | valid_balanced_accuracy: 0.65234 | valid_accuracy: 0.65297 |  0:03:41s
epoch 13 | loss: 0.60441 | train_auc: 0.71138 | train_balanced_accuracy: 0.65081 | train_accuracy: 0.65127 | valid_auc: 0.71065 | valid_balanced_accuracy: 0.652   | valid_accuracy: 0.6525  |  0:03:58s
epoch 14 | loss: 0.60154 | train_auc: 0.71664 | train_balanced_accuracy: 0.65916 | train_accuracy: 0.65985 | valid_auc: 0.70935 | valid_balanced_accuracy: 0.65716 | valid_accuracy: 0.65785 |  0:04:13s
epoch 15 | loss: 0.60013 | train_auc: 0.72602 | train_balanced_accuracy: 0.66648 | train_accuracy: 0.66701 | valid_auc: 0.7167  | valid_balanced_accuracy: 0.66109 | valid_accuracy: 0.66163 |  0:04:28s
epoch 16 | loss: 0.59778 | train_auc: 0.72877 | train_balanced_accuracy: 0.66614 | train_accuracy: 0.66665 | valid_auc: 0.71849 | valid_balanced_accuracy: 0.66378 | valid_accuracy: 0.66431 |  0:04:45s
epoch 17 | loss: 0.59821 | train_auc: 0.72227 | train_balanced_accuracy: 0.66453 | train_accuracy: 0.6652  | valid_auc: 0.71487 | valid_balanced_accuracy: 0.66231 | valid_accuracy: 0.66305 |  0:05:02s
epoch 18 | loss: 0.59694 | train_auc: 0.72803 | train_balanced_accuracy: 0.6717  | train_accuracy: 0.67228 | valid_auc: 0.71715 | valid_balanced_accuracy: 0.66416 | valid_accuracy: 0.66478 |  0:05:19s
epoch 19 | loss: 0.59905 | train_auc: 0.74009 | train_balanced_accuracy: 0.67738 | train_accuracy: 0.6781  | valid_auc: 0.72749 | valid_balanced_accuracy: 0.67111 | valid_accuracy: 0.67186 |  0:05:34s
epoch 20 | loss: 0.59431 | train_auc: 0.73858 | train_balanced_accuracy: 0.67769 | train_accuracy: 0.67834 | valid_auc: 0.7289  | valid_balanced_accuracy: 0.66664 | valid_accuracy: 0.6673  |  0:05:50s
epoch 21 | loss: 0.5955  | train_auc: 0.7397  | train_balanced_accuracy: 0.67598 | train_accuracy: 0.67657 | valid_auc: 0.72791 | valid_balanced_accuracy: 0.66906 | valid_accuracy: 0.66966 |  0:06:06s
epoch 22 | loss: 0.59587 | train_auc: 0.74074 | train_balanced_accuracy: 0.67852 | train_accuracy: 0.67913 | valid_auc: 0.72576 | valid_balanced_accuracy: 0.66938 | valid_accuracy: 0.66997 |  0:06:22s
epoch 23 | loss: 0.59176 | train_auc: 0.74586 | train_balanced_accuracy: 0.68123 | train_accuracy: 0.68176 | valid_auc: 0.73162 | valid_balanced_accuracy: 0.67368 | valid_accuracy: 0.67422 |  0:06:39s
epoch 24 | loss: 0.59814 | train_auc: 0.74423 | train_balanced_accuracy: 0.67661 | train_accuracy: 0.67708 | valid_auc: 0.7306  | valid_balanced_accuracy: 0.66872 | valid_accuracy: 0.66918 |  0:06:56s
epoch 25 | loss: 0.58782 | train_auc: 0.75378 | train_balanced_accuracy: 0.68769 | train_accuracy: 0.68794 | valid_auc: 0.73849 | valid_balanced_accuracy: 0.6779  | valid_accuracy: 0.67816 |  0:07:11s
epoch 26 | loss: 0.59047 | train_auc: 0.74687 | train_balanced_accuracy: 0.683   | train_accuracy: 0.68338 | valid_auc: 0.73275 | valid_balanced_accuracy: 0.66959 | valid_accuracy: 0.66997 |  0:07:28s
epoch 27 | loss: 0.59331 | train_auc: 0.75351 | train_balanced_accuracy: 0.68756 | train_accuracy: 0.68786 | valid_auc: 0.73843 | valid_balanced_accuracy: 0.67154 | valid_accuracy: 0.67186 |  0:07:46s
epoch 28 | loss: 0.59213 | train_auc: 0.75583 | train_balanced_accuracy: 0.6909  | train_accuracy: 0.69128 | valid_auc: 0.74174 | valid_balanced_accuracy: 0.68045 | valid_accuracy: 0.68083 |  0:08:03s
epoch 29 | loss: 0.58497 | train_auc: 0.7586  | train_balanced_accuracy: 0.6903  | train_accuracy: 0.69038 | valid_auc: 0.74347 | valid_balanced_accuracy: 0.67933 | valid_accuracy: 0.67941 |  0:08:20s
epoch 30 | loss: 0.58847 | train_auc: 0.75344 | train_balanced_accuracy: 0.68625 | train_accuracy: 0.68652 | valid_auc: 0.73945 | valid_balanced_accuracy: 0.67555 | valid_accuracy: 0.67579 |  0:08:36s
epoch 31 | loss: 0.58676 | train_auc: 0.75035 | train_balanced_accuracy: 0.68565 | train_accuracy: 0.68609 | valid_auc: 0.73631 | valid_balanced_accuracy: 0.67287 | valid_accuracy: 0.67328 |  0:08:53s
epoch 32 | loss: 0.59161 | train_auc: 0.75812 | train_balanced_accuracy: 0.69148 | train_accuracy: 0.69152 | valid_auc: 0.74311 | valid_balanced_accuracy: 0.67668 | valid_accuracy: 0.67674 |  0:09:09s
epoch 33 | loss: 0.59082 | train_auc: 0.75492 | train_balanced_accuracy: 0.68969 | train_accuracy: 0.68995 | valid_auc: 0.73923 | valid_balanced_accuracy: 0.67522 | valid_accuracy: 0.67548 |  0:09:25s
epoch 34 | loss: 0.58484 | train_auc: 0.75574 | train_balanced_accuracy: 0.68885 | train_accuracy: 0.6892  | valid_auc: 0.74119 | valid_balanced_accuracy: 0.68014 | valid_accuracy: 0.68052 |  0:09:42s
epoch 35 | loss: 0.58697 | train_auc: 0.75888 | train_balanced_accuracy: 0.69169 | train_accuracy: 0.69207 | valid_auc: 0.74339 | valid_balanced_accuracy: 0.68565 | valid_accuracy: 0.68602 |  0:10:00s
epoch 36 | loss: 0.58464 | train_auc: 0.75978 | train_balanced_accuracy: 0.69082 | train_accuracy: 0.69069 | valid_auc: 0.74321 | valid_balanced_accuracy: 0.67986 | valid_accuracy: 0.67973 |  0:10:17s
epoch 37 | loss: 0.58431 | train_auc: 0.74962 | train_balanced_accuracy: 0.68797 | train_accuracy: 0.68837 | valid_auc: 0.7414  | valid_balanced_accuracy: 0.67763 | valid_accuracy: 0.678   |  0:10:35s
epoch 38 | loss: 0.57827 | train_auc: 0.75886 | train_balanced_accuracy: 0.68736 | train_accuracy: 0.68707 | valid_auc: 0.7458  | valid_balanced_accuracy: 0.67906 | valid_accuracy: 0.67879 |  0:10:49s
epoch 39 | loss: 0.58178 | train_auc: 0.76272 | train_balanced_accuracy: 0.69287 | train_accuracy: 0.69286 | valid_auc: 0.74462 | valid_balanced_accuracy: 0.67879 | valid_accuracy: 0.67879 |  0:11:05s
epoch 40 | loss: 0.58315 | train_auc: 0.76575 | train_balanced_accuracy: 0.69755 | train_accuracy: 0.69754 | valid_auc: 0.74759 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68461 |  0:11:22s
epoch 41 | loss: 0.58217 | train_auc: 0.7618  | train_balanced_accuracy: 0.69326 | train_accuracy: 0.69317 | valid_auc: 0.74467 | valid_balanced_accuracy: 0.6786  | valid_accuracy: 0.67847 |  0:11:38s
epoch 42 | loss: 0.58212 | train_auc: 0.75694 | train_balanced_accuracy: 0.6945  | train_accuracy: 0.69483 | valid_auc: 0.74283 | valid_balanced_accuracy: 0.68684 | valid_accuracy: 0.68713 |  0:11:54s
epoch 43 | loss: 0.58595 | train_auc: 0.75499 | train_balanced_accuracy: 0.68407 | train_accuracy: 0.68408 | valid_auc: 0.74337 | valid_balanced_accuracy: 0.67455 | valid_accuracy: 0.67454 |  0:12:11s
epoch 44 | loss: 0.57931 | train_auc: 0.75903 | train_balanced_accuracy: 0.69166 | train_accuracy: 0.69172 | valid_auc: 0.74561 | valid_balanced_accuracy: 0.67889 | valid_accuracy: 0.67894 |  0:12:28s
epoch 45 | loss: 0.57973 | train_auc: 0.76666 | train_balanced_accuracy: 0.69743 | train_accuracy: 0.69782 | valid_auc: 0.74664 | valid_balanced_accuracy: 0.68361 | valid_accuracy: 0.68398 |  0:12:44s
epoch 46 | loss: 0.57756 | train_auc: 0.76602 | train_balanced_accuracy: 0.69638 | train_accuracy: 0.69636 | valid_auc: 0.74633 | valid_balanced_accuracy: 0.68293 | valid_accuracy: 0.68288 |  0:13:02s
epoch 47 | loss: 0.57936 | train_auc: 0.76898 | train_balanced_accuracy: 0.69698 | train_accuracy: 0.69738 | valid_auc: 0.74576 | valid_balanced_accuracy: 0.67761 | valid_accuracy: 0.678   |  0:13:18s
epoch 48 | loss: 0.57335 | train_auc: 0.76727 | train_balanced_accuracy: 0.6971  | train_accuracy: 0.69719 | valid_auc: 0.75241 | valid_balanced_accuracy: 0.68767 | valid_accuracy: 0.68776 |  0:13:35s
epoch 49 | loss: 0.57989 | train_auc: 0.7698  | train_balanced_accuracy: 0.69784 | train_accuracy: 0.69817 | valid_auc: 0.7529  | valid_balanced_accuracy: 0.68884 | valid_accuracy: 0.68917 |  0:13:50s
epoch 50 | loss: 0.57591 | train_auc: 0.766   | train_balanced_accuracy: 0.69836 | train_accuracy: 0.69852 | valid_auc: 0.74828 | valid_balanced_accuracy: 0.68398 | valid_accuracy: 0.68414 |  0:14:08s
epoch 51 | loss: 0.57276 | train_auc: 0.76675 | train_balanced_accuracy: 0.69694 | train_accuracy: 0.69742 | valid_auc: 0.74737 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.68571 |  0:14:24s
epoch 52 | loss: 0.57512 | train_auc: 0.76155 | train_balanced_accuracy: 0.69219 | train_accuracy: 0.69247 | valid_auc: 0.74322 | valid_balanced_accuracy: 0.68577 | valid_accuracy: 0.68602 |  0:14:39s
epoch 53 | loss: 0.5796  | train_auc: 0.7664  | train_balanced_accuracy: 0.69666 | train_accuracy: 0.69715 | valid_auc: 0.74806 | valid_balanced_accuracy: 0.68727 | valid_accuracy: 0.68776 |  0:14:54s
epoch 54 | loss: 0.57129 | train_auc: 0.76572 | train_balanced_accuracy: 0.69557 | train_accuracy: 0.69581 | valid_auc: 0.7489  | valid_balanced_accuracy: 0.68313 | valid_accuracy: 0.68335 |  0:15:11s
epoch 55 | loss: 0.5764  | train_auc: 0.77143 | train_balanced_accuracy: 0.69958 | train_accuracy: 0.69967 | valid_auc: 0.75177 | valid_balanced_accuracy: 0.6877  | valid_accuracy: 0.68776 |  0:15:27s
epoch 56 | loss: 0.5709  | train_auc: 0.77624 | train_balanced_accuracy: 0.70381 | train_accuracy: 0.70399 | valid_auc: 0.75308 | valid_balanced_accuracy: 0.68617 | valid_accuracy: 0.68634 |  0:15:42s
epoch 57 | loss: 0.57301 | train_auc: 0.77545 | train_balanced_accuracy: 0.70403 | train_accuracy: 0.70411 | valid_auc: 0.74861 | valid_balanced_accuracy: 0.68077 | valid_accuracy: 0.68083 |  0:15:59s
epoch 58 | loss: 0.5747  | train_auc: 0.7735  | train_balanced_accuracy: 0.70215 | train_accuracy: 0.70234 | valid_auc: 0.74688 | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.67816 |  0:16:17s
epoch 59 | loss: 0.57385 | train_auc: 0.7697  | train_balanced_accuracy: 0.69742 | train_accuracy: 0.69727 | valid_auc: 0.74862 | valid_balanced_accuracy: 0.68209 | valid_accuracy: 0.68193 |  0:16:35s
epoch 60 | loss: 0.5735  | train_auc: 0.7776  | train_balanced_accuracy: 0.70518 | train_accuracy: 0.70521 | valid_auc: 0.75377 | valid_balanced_accuracy: 0.68757 | valid_accuracy: 0.6876  |  0:16:52s
epoch 61 | loss: 0.57091 | train_auc: 0.77386 | train_balanced_accuracy: 0.70153 | train_accuracy: 0.70171 | valid_auc: 0.75104 | valid_balanced_accuracy: 0.68508 | valid_accuracy: 0.68524 |  0:17:07s
epoch 62 | loss: 0.56677 | train_auc: 0.77539 | train_balanced_accuracy: 0.70183 | train_accuracy: 0.70171 | valid_auc: 0.75295 | valid_balanced_accuracy: 0.68233 | valid_accuracy: 0.68225 |  0:17:25s
epoch 63 | loss: 0.57129 | train_auc: 0.78043 | train_balanced_accuracy: 0.70872 | train_accuracy: 0.70879 | valid_auc: 0.75329 | valid_balanced_accuracy: 0.68722 | valid_accuracy: 0.68728 |  0:17:41s
epoch 64 | loss: 0.56887 | train_auc: 0.7776  | train_balanced_accuracy: 0.70445 | train_accuracy: 0.70431 | valid_auc: 0.75174 | valid_balanced_accuracy: 0.68425 | valid_accuracy: 0.68414 |  0:17:58s
epoch 65 | loss: 0.56721 | train_auc: 0.77913 | train_balanced_accuracy: 0.70755 | train_accuracy: 0.70769 | valid_auc: 0.75506 | valid_balanced_accuracy: 0.68619 | valid_accuracy: 0.68634 |  0:18:14s
epoch 66 | loss: 0.56928 | train_auc: 0.77805 | train_balanced_accuracy: 0.70692 | train_accuracy: 0.70702 | valid_auc: 0.75657 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68854 |  0:18:31s
epoch 67 | loss: 0.56793 | train_auc: 0.7819  | train_balanced_accuracy: 0.70936 | train_accuracy: 0.70954 | valid_auc: 0.75667 | valid_balanced_accuracy: 0.68963 | valid_accuracy: 0.6898  |  0:18:47s
epoch 68 | loss: 0.56818 | train_auc: 0.77384 | train_balanced_accuracy: 0.70247 | train_accuracy: 0.70281 | valid_auc: 0.74596 | valid_balanced_accuracy: 0.68113 | valid_accuracy: 0.68146 |  0:19:04s
epoch 69 | loss: 0.5687  | train_auc: 0.7672  | train_balanced_accuracy: 0.69696 | train_accuracy: 0.69746 | valid_auc: 0.74121 | valid_balanced_accuracy: 0.67342 | valid_accuracy: 0.67391 |  0:19:20s
epoch 70 | loss: 0.56361 | train_auc: 0.77557 | train_balanced_accuracy: 0.7039  | train_accuracy: 0.70419 | valid_auc: 0.74686 | valid_balanced_accuracy: 0.68242 | valid_accuracy: 0.68272 |  0:19:36s
epoch 71 | loss: 0.56949 | train_auc: 0.78114 | train_balanced_accuracy: 0.70833 | train_accuracy: 0.70844 | valid_auc: 0.75276 | valid_balanced_accuracy: 0.68604 | valid_accuracy: 0.68618 |  0:19:51s
epoch 72 | loss: 0.56206 | train_auc: 0.78412 | train_balanced_accuracy: 0.71018 | train_accuracy: 0.71021 | valid_auc: 0.75265 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68901 |  0:20:06s
epoch 73 | loss: 0.56138 | train_auc: 0.78216 | train_balanced_accuracy: 0.70835 | train_accuracy: 0.70844 | valid_auc: 0.75032 | valid_balanced_accuracy: 0.67711 | valid_accuracy: 0.67721 |  0:20:23s
epoch 74 | loss: 0.56402 | train_auc: 0.78498 | train_balanced_accuracy: 0.70912 | train_accuracy: 0.70954 | valid_auc: 0.75621 | valid_balanced_accuracy: 0.68924 | valid_accuracy: 0.68964 |  0:20:39s
epoch 75 | loss: 0.56888 | train_auc: 0.78676 | train_balanced_accuracy: 0.7137  | train_accuracy: 0.71379 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.69031 | valid_accuracy: 0.69043 |  0:20:54s
epoch 76 | loss: 0.56807 | train_auc: 0.78496 | train_balanced_accuracy: 0.70799 | train_accuracy: 0.70781 | valid_auc: 0.75211 | valid_balanced_accuracy: 0.6826  | valid_accuracy: 0.6824  |  0:21:11s
epoch 77 | loss: 0.56549 | train_auc: 0.7856  | train_balanced_accuracy: 0.70808 | train_accuracy: 0.70773 | valid_auc: 0.75434 | valid_balanced_accuracy: 0.68793 | valid_accuracy: 0.6876  |  0:21:28s
epoch 78 | loss: 0.55762 | train_auc: 0.78212 | train_balanced_accuracy: 0.70718 | train_accuracy: 0.70718 | valid_auc: 0.75029 | valid_balanced_accuracy: 0.6851  | valid_accuracy: 0.68508 |  0:21:44s
epoch 79 | loss: 0.56488 | train_auc: 0.74796 | train_balanced_accuracy: 0.67476 | train_accuracy: 0.67464 | valid_auc: 0.73268 | valid_balanced_accuracy: 0.65918 | valid_accuracy: 0.65911 |  0:21:59s
epoch 80 | loss: 0.56786 | train_auc: 0.76172 | train_balanced_accuracy: 0.68547 | train_accuracy: 0.6853  | valid_auc: 0.74291 | valid_balanced_accuracy: 0.67549 | valid_accuracy: 0.67532 |  0:22:16s
epoch 81 | loss: 0.55719 | train_auc: 0.75977 | train_balanced_accuracy: 0.68667 | train_accuracy: 0.6866  | valid_auc: 0.74079 | valid_balanced_accuracy: 0.67272 | valid_accuracy: 0.67265 |  0:22:32s
epoch 82 | loss: 0.56473 | train_auc: 0.76955 | train_balanced_accuracy: 0.6966  | train_accuracy: 0.69675 | valid_auc: 0.74657 | valid_balanced_accuracy: 0.67945 | valid_accuracy: 0.67957 |  0:22:49s
epoch 83 | loss: 0.56105 | train_auc: 0.75412 | train_balanced_accuracy: 0.68024 | train_accuracy: 0.68023 | valid_auc: 0.74032 | valid_balanced_accuracy: 0.67377 | valid_accuracy: 0.67375 |  0:23:07s
epoch 84 | loss: 0.56297 | train_auc: 0.76373 | train_balanced_accuracy: 0.68992 | train_accuracy: 0.68995 | valid_auc: 0.74127 | valid_balanced_accuracy: 0.67906 | valid_accuracy: 0.6791  |  0:23:23s
epoch 85 | loss: 0.56261 | train_auc: 0.78824 | train_balanced_accuracy: 0.71076 | train_accuracy: 0.711   | valid_auc: 0.75689 | valid_balanced_accuracy: 0.68862 | valid_accuracy: 0.68886 |  0:23:39s
epoch 86 | loss: 0.56333 | train_auc: 0.77737 | train_balanced_accuracy: 0.70199 | train_accuracy: 0.70207 | valid_auc: 0.74463 | valid_balanced_accuracy: 0.68169 | valid_accuracy: 0.68178 |  0:23:54s
epoch 87 | loss: 0.55702 | train_auc: 0.78398 | train_balanced_accuracy: 0.70791 | train_accuracy: 0.70793 | valid_auc: 0.74981 | valid_balanced_accuracy: 0.686   | valid_accuracy: 0.68602 |  0:24:12s
epoch 88 | loss: 0.56044 | train_auc: 0.75487 | train_balanced_accuracy: 0.68256 | train_accuracy: 0.68204 | valid_auc: 0.73082 | valid_balanced_accuracy: 0.66389 | valid_accuracy: 0.66336 |  0:24:28s
epoch 89 | loss: 0.56129 | train_auc: 0.77886 | train_balanced_accuracy: 0.70209 | train_accuracy: 0.70242 | valid_auc: 0.74312 | valid_balanced_accuracy: 0.67893 | valid_accuracy: 0.67926 |  0:24:45s
epoch 90 | loss: 0.56139 | train_auc: 0.74452 | train_balanced_accuracy: 0.6718  | train_accuracy: 0.67181 | valid_auc: 0.73065 | valid_balanced_accuracy: 0.66102 | valid_accuracy: 0.661   |  0:25:01s
epoch 91 | loss: 0.55334 | train_auc: 0.74594 | train_balanced_accuracy: 0.67568 | train_accuracy: 0.67551 | valid_auc: 0.7311  | valid_balanced_accuracy: 0.66674 | valid_accuracy: 0.66651 |  0:25:18s
epoch 92 | loss: 0.55764 | train_auc: 0.77182 | train_balanced_accuracy: 0.69675 | train_accuracy: 0.69699 | valid_auc: 0.74979 | valid_balanced_accuracy: 0.68343 | valid_accuracy: 0.68366 |  0:25:36s
epoch 93 | loss: 0.56019 | train_auc: 0.78902 | train_balanced_accuracy: 0.71362 | train_accuracy: 0.71371 | valid_auc: 0.75321 | valid_balanced_accuracy: 0.6902  | valid_accuracy: 0.69027 |  0:25:51s
epoch 94 | loss: 0.55736 | train_auc: 0.78745 | train_balanced_accuracy: 0.70826 | train_accuracy: 0.70864 | valid_auc: 0.74882 | valid_balanced_accuracy: 0.68374 | valid_accuracy: 0.68414 |  0:26:06s
epoch 95 | loss: 0.55255 | train_auc: 0.7861  | train_balanced_accuracy: 0.70682 | train_accuracy: 0.70714 | valid_auc: 0.75054 | valid_balanced_accuracy: 0.68035 | valid_accuracy: 0.68067 |  0:26:23s

Early stopping occurred at epoch 95 with best_epoch = 75 and best_valid_accuracy = 0.69043
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 47/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=26.5min
[CV 2/5; 47/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71088 | train_auc: 0.57038 | train_balanced_accuracy: 0.53955 | train_accuracy: 0.53764 | valid_auc: 0.57993 | valid_balanced_accuracy: 0.54808 | valid_accuracy: 0.54611 |  0:00:18s
epoch 1  | loss: 0.65897 | train_auc: 0.60197 | train_balanced_accuracy: 0.51792 | train_accuracy: 0.51474 | valid_auc: 0.60446 | valid_balanced_accuracy: 0.51486 | valid_accuracy: 0.51165 |  0:00:32s
epoch 2  | loss: 0.6411  | train_auc: 0.64605 | train_balanced_accuracy: 0.53157 | train_accuracy: 0.52859 | valid_auc: 0.64319 | valid_balanced_accuracy: 0.52993 | valid_accuracy: 0.52691 |  0:00:50s
epoch 3  | loss: 0.63353 | train_auc: 0.64366 | train_balanced_accuracy: 0.53624 | train_accuracy: 0.53331 | valid_auc: 0.64596 | valid_balanced_accuracy: 0.5401  | valid_accuracy: 0.53714 |  0:01:04s
epoch 4  | loss: 0.62579 | train_auc: 0.65715 | train_balanced_accuracy: 0.54015 | train_accuracy: 0.53716 | valid_auc: 0.66033 | valid_balanced_accuracy: 0.53845 | valid_accuracy: 0.53541 |  0:01:24s
epoch 5  | loss: 0.62251 | train_auc: 0.6642  | train_balanced_accuracy: 0.56313 | train_accuracy: 0.56077 | valid_auc: 0.66842 | valid_balanced_accuracy: 0.56046 | valid_accuracy: 0.55807 |  0:01:40s
epoch 6  | loss: 0.61844 | train_auc: 0.67957 | train_balanced_accuracy: 0.58123 | train_accuracy: 0.57938 | valid_auc: 0.68412 | valid_balanced_accuracy: 0.58357 | valid_accuracy: 0.58168 |  0:01:54s
epoch 7  | loss: 0.61479 | train_auc: 0.68475 | train_balanced_accuracy: 0.59777 | train_accuracy: 0.59618 | valid_auc: 0.68897 | valid_balanced_accuracy: 0.59232 | valid_accuracy: 0.59065 |  0:02:11s
epoch 8  | loss: 0.60412 | train_auc: 0.69081 | train_balanced_accuracy: 0.62125 | train_accuracy: 0.62034 | valid_auc: 0.69541 | valid_balanced_accuracy: 0.62041 | valid_accuracy: 0.61945 |  0:02:26s
epoch 9  | loss: 0.61013 | train_auc: 0.69496 | train_balanced_accuracy: 0.58871 | train_accuracy: 0.5867  | valid_auc: 0.69216 | valid_balanced_accuracy: 0.5756  | valid_accuracy: 0.5735  |  0:02:41s
epoch 10 | loss: 0.6018  | train_auc: 0.70369 | train_balanced_accuracy: 0.62422 | train_accuracy: 0.62298 | valid_auc: 0.70032 | valid_balanced_accuracy: 0.61773 | valid_accuracy: 0.61646 |  0:02:59s
epoch 11 | loss: 0.60544 | train_auc: 0.71317 | train_balanced_accuracy: 0.6441  | train_accuracy: 0.64332 | valid_auc: 0.71042 | valid_balanced_accuracy: 0.63773 | valid_accuracy: 0.63692 |  0:03:16s
epoch 12 | loss: 0.60376 | train_auc: 0.7143  | train_balanced_accuracy: 0.64854 | train_accuracy: 0.64796 | valid_auc: 0.71091 | valid_balanced_accuracy: 0.64491 | valid_accuracy: 0.64432 |  0:03:31s
epoch 13 | loss: 0.59889 | train_auc: 0.71966 | train_balanced_accuracy: 0.65978 | train_accuracy: 0.65977 | valid_auc: 0.71442 | valid_balanced_accuracy: 0.65987 | valid_accuracy: 0.6599  |  0:03:47s
epoch 14 | loss: 0.59892 | train_auc: 0.72294 | train_balanced_accuracy: 0.66305 | train_accuracy: 0.66307 | valid_auc: 0.7182  | valid_balanced_accuracy: 0.66033 | valid_accuracy: 0.66037 |  0:04:03s
epoch 15 | loss: 0.59774 | train_auc: 0.72278 | train_balanced_accuracy: 0.66134 | train_accuracy: 0.66122 | valid_auc: 0.71956 | valid_balanced_accuracy: 0.66141 | valid_accuracy: 0.66132 |  0:04:20s
epoch 16 | loss: 0.596   | train_auc: 0.71994 | train_balanced_accuracy: 0.65887 | train_accuracy: 0.6591  | valid_auc: 0.71861 | valid_balanced_accuracy: 0.66628 | valid_accuracy: 0.66651 |  0:04:37s
epoch 17 | loss: 0.5959  | train_auc: 0.72294 | train_balanced_accuracy: 0.65799 | train_accuracy: 0.65784 | valid_auc: 0.71865 | valid_balanced_accuracy: 0.65441 | valid_accuracy: 0.65423 |  0:04:54s
epoch 18 | loss: 0.59622 | train_auc: 0.7267  | train_balanced_accuracy: 0.66655 | train_accuracy: 0.66693 | valid_auc: 0.72322 | valid_balanced_accuracy: 0.66013 | valid_accuracy: 0.66053 |  0:05:12s
epoch 19 | loss: 0.59507 | train_auc: 0.72341 | train_balanced_accuracy: 0.65682 | train_accuracy: 0.65682 | valid_auc: 0.72192 | valid_balanced_accuracy: 0.65568 | valid_accuracy: 0.65565 |  0:05:29s
epoch 20 | loss: 0.59314 | train_auc: 0.71835 | train_balanced_accuracy: 0.65242 | train_accuracy: 0.65233 | valid_auc: 0.71814 | valid_balanced_accuracy: 0.65089 | valid_accuracy: 0.65077 |  0:05:46s
epoch 21 | loss: 0.59473 | train_auc: 0.72639 | train_balanced_accuracy: 0.66224 | train_accuracy: 0.66256 | valid_auc: 0.72429 | valid_balanced_accuracy: 0.65939 | valid_accuracy: 0.65974 |  0:06:03s
epoch 22 | loss: 0.59706 | train_auc: 0.74124 | train_balanced_accuracy: 0.67865 | train_accuracy: 0.67893 | valid_auc: 0.73632 | valid_balanced_accuracy: 0.6733  | valid_accuracy: 0.67359 |  0:06:18s
epoch 23 | loss: 0.59007 | train_auc: 0.73077 | train_balanced_accuracy: 0.67121 | train_accuracy: 0.67169 | valid_auc: 0.72686 | valid_balanced_accuracy: 0.66996 | valid_accuracy: 0.67044 |  0:06:34s
epoch 24 | loss: 0.59458 | train_auc: 0.74271 | train_balanced_accuracy: 0.67667 | train_accuracy: 0.67704 | valid_auc: 0.73668 | valid_balanced_accuracy: 0.67356 | valid_accuracy: 0.67391 |  0:06:49s
epoch 25 | loss: 0.58569 | train_auc: 0.75732 | train_balanced_accuracy: 0.68854 | train_accuracy: 0.68841 | valid_auc: 0.74647 | valid_balanced_accuracy: 0.68053 | valid_accuracy: 0.68036 |  0:07:07s
epoch 26 | loss: 0.58702 | train_auc: 0.75632 | train_balanced_accuracy: 0.68874 | train_accuracy: 0.689   | valid_auc: 0.74677 | valid_balanced_accuracy: 0.68922 | valid_accuracy: 0.68949 |  0:07:24s
epoch 27 | loss: 0.59153 | train_auc: 0.7577  | train_balanced_accuracy: 0.68682 | train_accuracy: 0.68704 | valid_auc: 0.74462 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.6854  |  0:07:41s
epoch 28 | loss: 0.58584 | train_auc: 0.75915 | train_balanced_accuracy: 0.68868 | train_accuracy: 0.68936 | valid_auc: 0.74745 | valid_balanced_accuracy: 0.6863  | valid_accuracy: 0.68697 |  0:07:57s
epoch 29 | loss: 0.58724 | train_auc: 0.76057 | train_balanced_accuracy: 0.69177 | train_accuracy: 0.69187 | valid_auc: 0.74772 | valid_balanced_accuracy: 0.68405 | valid_accuracy: 0.68414 |  0:08:12s
epoch 30 | loss: 0.58327 | train_auc: 0.76005 | train_balanced_accuracy: 0.69321 | train_accuracy: 0.69353 | valid_auc: 0.74657 | valid_balanced_accuracy: 0.68102 | valid_accuracy: 0.6813  |  0:08:28s
epoch 31 | loss: 0.5896  | train_auc: 0.76046 | train_balanced_accuracy: 0.69207 | train_accuracy: 0.69223 | valid_auc: 0.7471  | valid_balanced_accuracy: 0.68498 | valid_accuracy: 0.68508 |  0:08:44s
epoch 32 | loss: 0.58634 | train_auc: 0.76093 | train_balanced_accuracy: 0.69332 | train_accuracy: 0.69357 | valid_auc: 0.74625 | valid_balanced_accuracy: 0.6869  | valid_accuracy: 0.68713 |  0:09:01s
epoch 33 | loss: 0.58466 | train_auc: 0.75958 | train_balanced_accuracy: 0.69314 | train_accuracy: 0.69333 | valid_auc: 0.74401 | valid_balanced_accuracy: 0.68449 | valid_accuracy: 0.68461 |  0:09:15s
epoch 34 | loss: 0.58066 | train_auc: 0.71731 | train_balanced_accuracy: 0.66721 | train_accuracy: 0.66779 | valid_auc: 0.71396 | valid_balanced_accuracy: 0.66673 | valid_accuracy: 0.6673  |  0:09:31s
epoch 35 | loss: 0.58133 | train_auc: 0.74106 | train_balanced_accuracy: 0.67799 | train_accuracy: 0.6785  | valid_auc: 0.73212 | valid_balanced_accuracy: 0.66665 | valid_accuracy: 0.66714 |  0:09:46s
epoch 36 | loss: 0.57954 | train_auc: 0.73347 | train_balanced_accuracy: 0.66592 | train_accuracy: 0.66575 | valid_auc: 0.72399 | valid_balanced_accuracy: 0.65359 | valid_accuracy: 0.65345 |  0:10:03s
epoch 37 | loss: 0.58302 | train_auc: 0.74074 | train_balanced_accuracy: 0.67425 | train_accuracy: 0.67421 | valid_auc: 0.73486 | valid_balanced_accuracy: 0.66814 | valid_accuracy: 0.66808 |  0:10:19s
epoch 38 | loss: 0.58052 | train_auc: 0.76299 | train_balanced_accuracy: 0.69792 | train_accuracy: 0.69797 | valid_auc: 0.74749 | valid_balanced_accuracy: 0.68052 | valid_accuracy: 0.68052 |  0:10:35s
epoch 39 | loss: 0.58141 | train_auc: 0.72194 | train_balanced_accuracy: 0.66406 | train_accuracy: 0.66398 | valid_auc: 0.72063 | valid_balanced_accuracy: 0.65886 | valid_accuracy: 0.6588  |  0:10:53s
epoch 40 | loss: 0.58561 | train_auc: 0.72373 | train_balanced_accuracy: 0.66221 | train_accuracy: 0.66217 | valid_auc: 0.71994 | valid_balanced_accuracy: 0.65288 | valid_accuracy: 0.65282 |  0:11:10s
epoch 41 | loss: 0.58179 | train_auc: 0.73823 | train_balanced_accuracy: 0.66947 | train_accuracy: 0.66933 | valid_auc: 0.72498 | valid_balanced_accuracy: 0.65832 | valid_accuracy: 0.65817 |  0:11:26s
epoch 42 | loss: 0.57647 | train_auc: 0.76882 | train_balanced_accuracy: 0.70026 | train_accuracy: 0.70041 | valid_auc: 0.75119 | valid_balanced_accuracy: 0.6892  | valid_accuracy: 0.68933 |  0:11:43s
epoch 43 | loss: 0.58503 | train_auc: 0.75924 | train_balanced_accuracy: 0.69351 | train_accuracy: 0.69376 | valid_auc: 0.74808 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68917 |  0:12:00s
epoch 44 | loss: 0.57892 | train_auc: 0.73937 | train_balanced_accuracy: 0.68201 | train_accuracy: 0.68251 | valid_auc: 0.73029 | valid_balanced_accuracy: 0.6796  | valid_accuracy: 0.68004 |  0:12:16s
epoch 45 | loss: 0.57686 | train_auc: 0.75959 | train_balanced_accuracy: 0.69191 | train_accuracy: 0.69262 | valid_auc: 0.74373 | valid_balanced_accuracy: 0.68377 | valid_accuracy: 0.68445 |  0:12:33s
epoch 46 | loss: 0.57447 | train_auc: 0.70683 | train_balanced_accuracy: 0.66207 | train_accuracy: 0.66315 | valid_auc: 0.70643 | valid_balanced_accuracy: 0.67037 | valid_accuracy: 0.67139 |  0:12:51s

Early stopping occurred at epoch 46 with best_epoch = 26 and best_valid_accuracy = 0.68949
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 47/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.673 total time=13.0min
[CV 3/5; 47/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.72152 | train_auc: 0.54989 | train_balanced_accuracy: 0.532   | train_accuracy: 0.53053 | valid_auc: 0.54798 | valid_balanced_accuracy: 0.52657 | valid_accuracy: 0.52502 |  0:00:17s
epoch 1  | loss: 0.66928 | train_auc: 0.55413 | train_balanced_accuracy: 0.52942 | train_accuracy: 0.52821 | valid_auc: 0.5455  | valid_balanced_accuracy: 0.52094 | valid_accuracy: 0.51967 |  0:00:33s
epoch 2  | loss: 0.64925 | train_auc: 0.61833 | train_balanced_accuracy: 0.53762 | train_accuracy: 0.53506 | valid_auc: 0.61614 | valid_balanced_accuracy: 0.53631 | valid_accuracy: 0.53368 |  0:00:50s
epoch 3  | loss: 0.63883 | train_auc: 0.63192 | train_balanced_accuracy: 0.54285 | train_accuracy: 0.54021 | valid_auc: 0.63432 | valid_balanced_accuracy: 0.54361 | valid_accuracy: 0.54092 |  0:01:08s
epoch 4  | loss: 0.62709 | train_auc: 0.65506 | train_balanced_accuracy: 0.55928 | train_accuracy: 0.55689 | valid_auc: 0.6507  | valid_balanced_accuracy: 0.56235 | valid_accuracy: 0.55996 |  0:01:24s
epoch 5  | loss: 0.62151 | train_auc: 0.67555 | train_balanced_accuracy: 0.59638 | train_accuracy: 0.59474 | valid_auc: 0.66548 | valid_balanced_accuracy: 0.59041 | valid_accuracy: 0.58876 |  0:01:41s
epoch 6  | loss: 0.62058 | train_auc: 0.68573 | train_balanced_accuracy: 0.62128 | train_accuracy: 0.62036 | valid_auc: 0.67661 | valid_balanced_accuracy: 0.61348 | valid_accuracy: 0.61253 |  0:01:59s
epoch 7  | loss: 0.62021 | train_auc: 0.68699 | train_balanced_accuracy: 0.63263 | train_accuracy: 0.63216 | valid_auc: 0.67888 | valid_balanced_accuracy: 0.62824 | valid_accuracy: 0.62779 |  0:02:17s
epoch 8  | loss: 0.61296 | train_auc: 0.69432 | train_balanced_accuracy: 0.63757 | train_accuracy: 0.63771 | valid_auc: 0.68908 | valid_balanced_accuracy: 0.64057 | valid_accuracy: 0.6407  |  0:02:34s
epoch 9  | loss: 0.61319 | train_auc: 0.69354 | train_balanced_accuracy: 0.63431 | train_accuracy: 0.63436 | valid_auc: 0.6899  | valid_balanced_accuracy: 0.63562 | valid_accuracy: 0.63566 |  0:02:50s
epoch 10 | loss: 0.60517 | train_auc: 0.70003 | train_balanced_accuracy: 0.638   | train_accuracy: 0.63775 | valid_auc: 0.6941  | valid_balanced_accuracy: 0.63516 | valid_accuracy: 0.63488 |  0:03:06s
epoch 11 | loss: 0.60709 | train_auc: 0.70688 | train_balanced_accuracy: 0.6471  | train_accuracy: 0.64711 | valid_auc: 0.70374 | valid_balanced_accuracy: 0.64104 | valid_accuracy: 0.64101 |  0:03:23s
epoch 12 | loss: 0.60511 | train_auc: 0.71314 | train_balanced_accuracy: 0.65175 | train_accuracy: 0.65215 | valid_auc: 0.70577 | valid_balanced_accuracy: 0.64425 | valid_accuracy: 0.64463 |  0:03:41s
epoch 13 | loss: 0.60159 | train_auc: 0.71243 | train_balanced_accuracy: 0.64895 | train_accuracy: 0.64912 | valid_auc: 0.70508 | valid_balanced_accuracy: 0.64587 | valid_accuracy: 0.64605 |  0:03:57s
epoch 14 | loss: 0.59913 | train_auc: 0.72287 | train_balanced_accuracy: 0.65716 | train_accuracy: 0.65726 | valid_auc: 0.71445 | valid_balanced_accuracy: 0.6529  | valid_accuracy: 0.65297 |  0:04:13s
epoch 15 | loss: 0.60062 | train_auc: 0.72289 | train_balanced_accuracy: 0.66069 | train_accuracy: 0.661   | valid_auc: 0.71379 | valid_balanced_accuracy: 0.65693 | valid_accuracy: 0.65722 |  0:04:31s
epoch 16 | loss: 0.5963  | train_auc: 0.72775 | train_balanced_accuracy: 0.66516 | train_accuracy: 0.66517 | valid_auc: 0.7206  | valid_balanced_accuracy: 0.66449 | valid_accuracy: 0.66446 |  0:04:46s
epoch 17 | loss: 0.59382 | train_auc: 0.7316  | train_balanced_accuracy: 0.66789 | train_accuracy: 0.66824 | valid_auc: 0.72311 | valid_balanced_accuracy: 0.66318 | valid_accuracy: 0.66352 |  0:05:05s
epoch 18 | loss: 0.60048 | train_auc: 0.73699 | train_balanced_accuracy: 0.67329 | train_accuracy: 0.67402 | valid_auc: 0.72787 | valid_balanced_accuracy: 0.67065 | valid_accuracy: 0.67139 |  0:05:19s
epoch 19 | loss: 0.59525 | train_auc: 0.7383  | train_balanced_accuracy: 0.67109 | train_accuracy: 0.67147 | valid_auc: 0.72774 | valid_balanced_accuracy: 0.67495 | valid_accuracy: 0.67532 |  0:05:35s
epoch 20 | loss: 0.59528 | train_auc: 0.74428 | train_balanced_accuracy: 0.68313 | train_accuracy: 0.68374 | valid_auc: 0.73268 | valid_balanced_accuracy: 0.67721 | valid_accuracy: 0.67784 |  0:05:52s
epoch 21 | loss: 0.5892  | train_auc: 0.7464  | train_balanced_accuracy: 0.68061 | train_accuracy: 0.68083 | valid_auc: 0.73453 | valid_balanced_accuracy: 0.6759  | valid_accuracy: 0.67611 |  0:06:08s
epoch 22 | loss: 0.59643 | train_auc: 0.75196 | train_balanced_accuracy: 0.6871  | train_accuracy: 0.68752 | valid_auc: 0.73961 | valid_balanced_accuracy: 0.67992 | valid_accuracy: 0.68036 |  0:06:23s
epoch 23 | loss: 0.59301 | train_auc: 0.75357 | train_balanced_accuracy: 0.69026 | train_accuracy: 0.69039 | valid_auc: 0.74341 | valid_balanced_accuracy: 0.6815  | valid_accuracy: 0.68162 |  0:06:37s
epoch 24 | loss: 0.59505 | train_auc: 0.74709 | train_balanced_accuracy: 0.68323 | train_accuracy: 0.68382 | valid_auc: 0.73661 | valid_balanced_accuracy: 0.67979 | valid_accuracy: 0.68036 |  0:06:54s
epoch 25 | loss: 0.58962 | train_auc: 0.75324 | train_balanced_accuracy: 0.68294 | train_accuracy: 0.68284 | valid_auc: 0.73985 | valid_balanced_accuracy: 0.67767 | valid_accuracy: 0.67753 |  0:07:10s
epoch 26 | loss: 0.5893  | train_auc: 0.75596 | train_balanced_accuracy: 0.69165 | train_accuracy: 0.69193 | valid_auc: 0.7443  | valid_balanced_accuracy: 0.68419 | valid_accuracy: 0.68445 |  0:07:26s
epoch 27 | loss: 0.58715 | train_auc: 0.75951 | train_balanced_accuracy: 0.69323 | train_accuracy: 0.69334 | valid_auc: 0.74605 | valid_balanced_accuracy: 0.68249 | valid_accuracy: 0.68256 |  0:07:41s
epoch 28 | loss: 0.58407 | train_auc: 0.75748 | train_balanced_accuracy: 0.69314 | train_accuracy: 0.6935  | valid_auc: 0.73941 | valid_balanced_accuracy: 0.68092 | valid_accuracy: 0.6813  |  0:07:57s
epoch 29 | loss: 0.58738 | train_auc: 0.7595  | train_balanced_accuracy: 0.69243 | train_accuracy: 0.6926  | valid_auc: 0.74231 | valid_balanced_accuracy: 0.68582 | valid_accuracy: 0.68602 |  0:08:14s
epoch 30 | loss: 0.58761 | train_auc: 0.75854 | train_balanced_accuracy: 0.69397 | train_accuracy: 0.69425 | valid_auc: 0.7396  | valid_balanced_accuracy: 0.687   | valid_accuracy: 0.68728 |  0:08:31s
epoch 31 | loss: 0.5884  | train_auc: 0.75949 | train_balanced_accuracy: 0.69348 | train_accuracy: 0.69338 | valid_auc: 0.74371 | valid_balanced_accuracy: 0.68443 | valid_accuracy: 0.68429 |  0:08:47s
epoch 32 | loss: 0.58325 | train_auc: 0.76062 | train_balanced_accuracy: 0.69323 | train_accuracy: 0.69342 | valid_auc: 0.74243 | valid_balanced_accuracy: 0.68272 | valid_accuracy: 0.68288 |  0:09:03s
epoch 33 | loss: 0.58491 | train_auc: 0.75415 | train_balanced_accuracy: 0.68794 | train_accuracy: 0.68823 | valid_auc: 0.73644 | valid_balanced_accuracy: 0.68324 | valid_accuracy: 0.68351 |  0:09:19s
epoch 34 | loss: 0.58627 | train_auc: 0.75275 | train_balanced_accuracy: 0.68749 | train_accuracy: 0.6878  | valid_auc: 0.73783 | valid_balanced_accuracy: 0.68656 | valid_accuracy: 0.68681 |  0:09:36s
epoch 35 | loss: 0.58157 | train_auc: 0.75033 | train_balanced_accuracy: 0.68536 | train_accuracy: 0.6854  | valid_auc: 0.74035 | valid_balanced_accuracy: 0.68082 | valid_accuracy: 0.68083 |  0:09:52s
epoch 36 | loss: 0.58718 | train_auc: 0.76207 | train_balanced_accuracy: 0.69593 | train_accuracy: 0.69618 | valid_auc: 0.74652 | valid_balanced_accuracy: 0.68546 | valid_accuracy: 0.68571 |  0:10:09s
epoch 37 | loss: 0.58339 | train_auc: 0.75722 | train_balanced_accuracy: 0.68718 | train_accuracy: 0.68756 | valid_auc: 0.74307 | valid_balanced_accuracy: 0.68456 | valid_accuracy: 0.68492 |  0:10:25s
epoch 38 | loss: 0.58169 | train_auc: 0.71827 | train_balanced_accuracy: 0.66058 | train_accuracy: 0.66073 | valid_auc: 0.72035 | valid_balanced_accuracy: 0.66334 | valid_accuracy: 0.66352 |  0:10:42s
epoch 39 | loss: 0.57921 | train_auc: 0.71703 | train_balanced_accuracy: 0.65852 | train_accuracy: 0.65903 | valid_auc: 0.7147  | valid_balanced_accuracy: 0.66176 | valid_accuracy: 0.66226 |  0:10:58s
epoch 40 | loss: 0.58254 | train_auc: 0.75991 | train_balanced_accuracy: 0.69441 | train_accuracy: 0.69452 | valid_auc: 0.74504 | valid_balanced_accuracy: 0.68405 | valid_accuracy: 0.68414 |  0:11:15s
epoch 41 | loss: 0.58244 | train_auc: 0.74337 | train_balanced_accuracy: 0.68121 | train_accuracy: 0.68142 | valid_auc: 0.73518 | valid_balanced_accuracy: 0.677   | valid_accuracy: 0.67721 |  0:11:30s
epoch 42 | loss: 0.57795 | train_auc: 0.73304 | train_balanced_accuracy: 0.6736  | train_accuracy: 0.67438 | valid_auc: 0.72422 | valid_balanced_accuracy: 0.66888 | valid_accuracy: 0.66966 |  0:11:47s
epoch 43 | loss: 0.58557 | train_auc: 0.74116 | train_balanced_accuracy: 0.68235 | train_accuracy: 0.6828  | valid_auc: 0.72774 | valid_balanced_accuracy: 0.67615 | valid_accuracy: 0.67658 |  0:12:03s
epoch 44 | loss: 0.58437 | train_auc: 0.73813 | train_balanced_accuracy: 0.68026 | train_accuracy: 0.68059 | valid_auc: 0.7277  | valid_balanced_accuracy: 0.67436 | valid_accuracy: 0.67469 |  0:12:20s
epoch 45 | loss: 0.58118 | train_auc: 0.74958 | train_balanced_accuracy: 0.68472 | train_accuracy: 0.68528 | valid_auc: 0.73699 | valid_balanced_accuracy: 0.6778  | valid_accuracy: 0.67831 |  0:12:37s
epoch 46 | loss: 0.58297 | train_auc: 0.74334 | train_balanced_accuracy: 0.67816 | train_accuracy: 0.67882 | valid_auc: 0.73255 | valid_balanced_accuracy: 0.67216 | valid_accuracy: 0.6728  |  0:12:53s
epoch 47 | loss: 0.58018 | train_auc: 0.76595 | train_balanced_accuracy: 0.6953  | train_accuracy: 0.69594 | valid_auc: 0.74944 | valid_balanced_accuracy: 0.68442 | valid_accuracy: 0.68508 |  0:13:10s
epoch 48 | loss: 0.58082 | train_auc: 0.76016 | train_balanced_accuracy: 0.69114 | train_accuracy: 0.69118 | valid_auc: 0.74407 | valid_balanced_accuracy: 0.68586 | valid_accuracy: 0.68587 |  0:13:26s
epoch 49 | loss: 0.57706 | train_auc: 0.76509 | train_balanced_accuracy: 0.69681 | train_accuracy: 0.69712 | valid_auc: 0.74709 | valid_balanced_accuracy: 0.69016 | valid_accuracy: 0.69043 |  0:13:42s
epoch 50 | loss: 0.57811 | train_auc: 0.75421 | train_balanced_accuracy: 0.68428 | train_accuracy: 0.68418 | valid_auc: 0.74239 | valid_balanced_accuracy: 0.67718 | valid_accuracy: 0.67705 |  0:13:58s
epoch 51 | loss: 0.57491 | train_auc: 0.70877 | train_balanced_accuracy: 0.65541 | train_accuracy: 0.65541 | valid_auc: 0.70589 | valid_balanced_accuracy: 0.6555  | valid_accuracy: 0.65549 |  0:14:16s
epoch 52 | loss: 0.57371 | train_auc: 0.76925 | train_balanced_accuracy: 0.7017  | train_accuracy: 0.70196 | valid_auc: 0.75054 | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68681 |  0:14:31s
epoch 53 | loss: 0.57497 | train_auc: 0.7513  | train_balanced_accuracy: 0.68601 | train_accuracy: 0.68638 | valid_auc: 0.73756 | valid_balanced_accuracy: 0.67759 | valid_accuracy: 0.678   |  0:14:47s
epoch 54 | loss: 0.57662 | train_auc: 0.7227  | train_balanced_accuracy: 0.66945 | train_accuracy: 0.66993 | valid_auc: 0.71791 | valid_balanced_accuracy: 0.67096 | valid_accuracy: 0.67139 |  0:15:03s
epoch 55 | loss: 0.57579 | train_auc: 0.71148 | train_balanced_accuracy: 0.65205 | train_accuracy: 0.65191 | valid_auc: 0.70995 | valid_balanced_accuracy: 0.65442 | valid_accuracy: 0.65423 |  0:15:20s
epoch 56 | loss: 0.57278 | train_auc: 0.71063 | train_balanced_accuracy: 0.64642 | train_accuracy: 0.64593 | valid_auc: 0.71145 | valid_balanced_accuracy: 0.64842 | valid_accuracy: 0.64794 |  0:15:35s
epoch 57 | loss: 0.58225 | train_auc: 0.71964 | train_balanced_accuracy: 0.65025 | train_accuracy: 0.64959 | valid_auc: 0.71659 | valid_balanced_accuracy: 0.64974 | valid_accuracy: 0.64904 |  0:15:52s
epoch 58 | loss: 0.58113 | train_auc: 0.73004 | train_balanced_accuracy: 0.66506 | train_accuracy: 0.66505 | valid_auc: 0.72756 | valid_balanced_accuracy: 0.66794 | valid_accuracy: 0.66793 |  0:16:09s
epoch 59 | loss: 0.57629 | train_auc: 0.73232 | train_balanced_accuracy: 0.66904 | train_accuracy: 0.66895 | valid_auc: 0.72591 | valid_balanced_accuracy: 0.66622 | valid_accuracy: 0.66604 |  0:16:24s
epoch 60 | loss: 0.58047 | train_auc: 0.74179 | train_balanced_accuracy: 0.6747  | train_accuracy: 0.67465 | valid_auc: 0.73128 | valid_balanced_accuracy: 0.6691  | valid_accuracy: 0.66903 |  0:16:39s
epoch 61 | loss: 0.57895 | train_auc: 0.74846 | train_balanced_accuracy: 0.682   | train_accuracy: 0.68221 | valid_auc: 0.735   | valid_balanced_accuracy: 0.67291 | valid_accuracy: 0.67312 |  0:16:56s
epoch 62 | loss: 0.57477 | train_auc: 0.75914 | train_balanced_accuracy: 0.69104 | train_accuracy: 0.69098 | valid_auc: 0.74589 | valid_balanced_accuracy: 0.68028 | valid_accuracy: 0.6802  |  0:17:14s
epoch 63 | loss: 0.57474 | train_auc: 0.75953 | train_balanced_accuracy: 0.69296 | train_accuracy: 0.69311 | valid_auc: 0.74234 | valid_balanced_accuracy: 0.68243 | valid_accuracy: 0.68256 |  0:17:30s
epoch 64 | loss: 0.57311 | train_auc: 0.76707 | train_balanced_accuracy: 0.69768 | train_accuracy: 0.69783 | valid_auc: 0.74845 | valid_balanced_accuracy: 0.68778 | valid_accuracy: 0.68791 |  0:17:45s
epoch 65 | loss: 0.56754 | train_auc: 0.77362 | train_balanced_accuracy: 0.70186 | train_accuracy: 0.70196 | valid_auc: 0.75593 | valid_balanced_accuracy: 0.69144 | valid_accuracy: 0.69153 |  0:18:01s
epoch 66 | loss: 0.57285 | train_auc: 0.77418 | train_balanced_accuracy: 0.70121 | train_accuracy: 0.70117 | valid_auc: 0.75382 | valid_balanced_accuracy: 0.68858 | valid_accuracy: 0.68854 |  0:18:15s
epoch 67 | loss: 0.56954 | train_auc: 0.77634 | train_balanced_accuracy: 0.70106 | train_accuracy: 0.70121 | valid_auc: 0.75232 | valid_balanced_accuracy: 0.68914 | valid_accuracy: 0.68933 |  0:18:31s
epoch 68 | loss: 0.57105 | train_auc: 0.77715 | train_balanced_accuracy: 0.70406 | train_accuracy: 0.70448 | valid_auc: 0.7545  | valid_balanced_accuracy: 0.68967 | valid_accuracy: 0.69012 |  0:18:47s
epoch 69 | loss: 0.57104 | train_auc: 0.77767 | train_balanced_accuracy: 0.70296 | train_accuracy: 0.70314 | valid_auc: 0.75272 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69279 |  0:19:03s
epoch 70 | loss: 0.56935 | train_auc: 0.78114 | train_balanced_accuracy: 0.70692 | train_accuracy: 0.70715 | valid_auc: 0.75567 | valid_balanced_accuracy: 0.69174 | valid_accuracy: 0.69201 |  0:19:20s
epoch 71 | loss: 0.57087 | train_auc: 0.78071 | train_balanced_accuracy: 0.70614 | train_accuracy: 0.70633 | valid_auc: 0.75421 | valid_balanced_accuracy: 0.69193 | valid_accuracy: 0.69216 |  0:19:37s
epoch 72 | loss: 0.57324 | train_auc: 0.77801 | train_balanced_accuracy: 0.70418 | train_accuracy: 0.70436 | valid_auc: 0.75287 | valid_balanced_accuracy: 0.69544 | valid_accuracy: 0.69562 |  0:19:53s
epoch 73 | loss: 0.56492 | train_auc: 0.78068 | train_balanced_accuracy: 0.70687 | train_accuracy: 0.707   | valid_auc: 0.75712 | valid_balanced_accuracy: 0.69562 | valid_accuracy: 0.69578 |  0:20:10s
epoch 74 | loss: 0.56989 | train_auc: 0.78213 | train_balanced_accuracy: 0.70775 | train_accuracy: 0.7081  | valid_auc: 0.75709 | valid_balanced_accuracy: 0.69195 | valid_accuracy: 0.69232 |  0:20:27s
epoch 75 | loss: 0.57016 | train_auc: 0.78298 | train_balanced_accuracy: 0.70707 | train_accuracy: 0.70715 | valid_auc: 0.75642 | valid_balanced_accuracy: 0.69333 | valid_accuracy: 0.69342 |  0:20:43s
epoch 76 | loss: 0.56793 | train_auc: 0.78389 | train_balanced_accuracy: 0.70532 | train_accuracy: 0.70526 | valid_auc: 0.75733 | valid_balanced_accuracy: 0.69185 | valid_accuracy: 0.69185 |  0:20:58s
epoch 77 | loss: 0.56331 | train_auc: 0.78248 | train_balanced_accuracy: 0.70809 | train_accuracy: 0.70814 | valid_auc: 0.75469 | valid_balanced_accuracy: 0.69321 | valid_accuracy: 0.69326 |  0:21:15s
epoch 78 | loss: 0.56081 | train_auc: 0.77972 | train_balanced_accuracy: 0.70723 | train_accuracy: 0.70755 | valid_auc: 0.75235 | valid_balanced_accuracy: 0.69182 | valid_accuracy: 0.69216 |  0:21:32s
epoch 79 | loss: 0.56262 | train_auc: 0.77901 | train_balanced_accuracy: 0.70784 | train_accuracy: 0.70802 | valid_auc: 0.75256 | valid_balanced_accuracy: 0.69254 | valid_accuracy: 0.69279 |  0:21:50s
epoch 80 | loss: 0.5691  | train_auc: 0.78241 | train_balanced_accuracy: 0.70808 | train_accuracy: 0.70841 | valid_auc: 0.75423 | valid_balanced_accuracy: 0.6945  | valid_accuracy: 0.69484 |  0:22:06s
epoch 81 | loss: 0.57111 | train_auc: 0.78051 | train_balanced_accuracy: 0.70435 | train_accuracy: 0.70475 | valid_auc: 0.75253 | valid_balanced_accuracy: 0.68939 | valid_accuracy: 0.6898  |  0:22:24s
epoch 82 | loss: 0.56635 | train_auc: 0.78011 | train_balanced_accuracy: 0.70533 | train_accuracy: 0.70566 | valid_auc: 0.75424 | valid_balanced_accuracy: 0.69295 | valid_accuracy: 0.69326 |  0:22:40s
epoch 83 | loss: 0.56882 | train_auc: 0.78414 | train_balanced_accuracy: 0.71087 | train_accuracy: 0.71105 | valid_auc: 0.75751 | valid_balanced_accuracy: 0.69372 | valid_accuracy: 0.69389 |  0:22:57s
epoch 84 | loss: 0.56607 | train_auc: 0.78585 | train_balanced_accuracy: 0.71086 | train_accuracy: 0.71124 | valid_auc: 0.75578 | valid_balanced_accuracy: 0.69444 | valid_accuracy: 0.69484 |  0:23:14s
epoch 85 | loss: 0.56749 | train_auc: 0.7574  | train_balanced_accuracy: 0.69036 | train_accuracy: 0.69027 | valid_auc: 0.7444  | valid_balanced_accuracy: 0.6855  | valid_accuracy: 0.6854  |  0:23:30s
epoch 86 | loss: 0.56655 | train_auc: 0.757   | train_balanced_accuracy: 0.68619 | train_accuracy: 0.68591 | valid_auc: 0.74349 | valid_balanced_accuracy: 0.67937 | valid_accuracy: 0.6791  |  0:23:47s
epoch 87 | loss: 0.56056 | train_auc: 0.76978 | train_balanced_accuracy: 0.69385 | train_accuracy: 0.69354 | valid_auc: 0.75075 | valid_balanced_accuracy: 0.68572 | valid_accuracy: 0.6854  |  0:24:02s
epoch 88 | loss: 0.5597  | train_auc: 0.77686 | train_balanced_accuracy: 0.70596 | train_accuracy: 0.70601 | valid_auc: 0.75464 | valid_balanced_accuracy: 0.69402 | valid_accuracy: 0.69405 |  0:24:19s
epoch 89 | loss: 0.56378 | train_auc: 0.78069 | train_balanced_accuracy: 0.70674 | train_accuracy: 0.70711 | valid_auc: 0.75502 | valid_balanced_accuracy: 0.69527 | valid_accuracy: 0.69562 |  0:24:37s
epoch 90 | loss: 0.56573 | train_auc: 0.78801 | train_balanced_accuracy: 0.71088 | train_accuracy: 0.71073 | valid_auc: 0.75983 | valid_balanced_accuracy: 0.69169 | valid_accuracy: 0.69153 |  0:24:53s
epoch 91 | loss: 0.56111 | train_auc: 0.7898  | train_balanced_accuracy: 0.71257 | train_accuracy: 0.71266 | valid_auc: 0.75735 | valid_balanced_accuracy: 0.68985 | valid_accuracy: 0.68996 |  0:25:08s
epoch 92 | loss: 0.5603  | train_auc: 0.78834 | train_balanced_accuracy: 0.71333 | train_accuracy: 0.71345 | valid_auc: 0.75176 | valid_balanced_accuracy: 0.69389 | valid_accuracy: 0.69405 |  0:25:25s
epoch 93 | loss: 0.55886 | train_auc: 0.78784 | train_balanced_accuracy: 0.71121 | train_accuracy: 0.71124 | valid_auc: 0.75456 | valid_balanced_accuracy: 0.69163 | valid_accuracy: 0.69169 |  0:25:41s

Early stopping occurred at epoch 93 with best_epoch = 73 and best_valid_accuracy = 0.69578
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 47/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=25.8min
[CV 4/5; 47/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70962 | train_auc: 0.59534 | train_balanced_accuracy: 0.57096 | train_accuracy: 0.57047 | valid_auc: 0.5918  | valid_balanced_accuracy: 0.56928 | valid_accuracy: 0.56878 |  0:00:17s
epoch 1  | loss: 0.66147 | train_auc: 0.61945 | train_balanced_accuracy: 0.58813 | train_accuracy: 0.5868  | valid_auc: 0.61322 | valid_balanced_accuracy: 0.58384 | valid_accuracy: 0.58247 |  0:00:32s
epoch 2  | loss: 0.64046 | train_auc: 0.63466 | train_balanced_accuracy: 0.5673  | train_accuracy: 0.56492 | valid_auc: 0.62843 | valid_balanced_accuracy: 0.56601 | valid_accuracy: 0.56358 |  0:00:49s
epoch 3  | loss: 0.63426 | train_auc: 0.64819 | train_balanced_accuracy: 0.57399 | train_accuracy: 0.57169 | valid_auc: 0.63932 | valid_balanced_accuracy: 0.55886 | valid_accuracy: 0.5565  |  0:01:06s
epoch 4  | loss: 0.6272  | train_auc: 0.65565 | train_balanced_accuracy: 0.59039 | train_accuracy: 0.58841 | valid_auc: 0.64774 | valid_balanced_accuracy: 0.58143 | valid_accuracy: 0.57948 |  0:01:22s
epoch 5  | loss: 0.62754 | train_auc: 0.66543 | train_balanced_accuracy: 0.60774 | train_accuracy: 0.60651 | valid_auc: 0.65886 | valid_balanced_accuracy: 0.60364 | valid_accuracy: 0.60246 |  0:01:39s
epoch 6  | loss: 0.61963 | train_auc: 0.67288 | train_balanced_accuracy: 0.61155 | train_accuracy: 0.61021 | valid_auc: 0.66545 | valid_balanced_accuracy: 0.60094 | valid_accuracy: 0.59962 |  0:01:55s
epoch 7  | loss: 0.61806 | train_auc: 0.68385 | train_balanced_accuracy: 0.62352 | train_accuracy: 0.6226  | valid_auc: 0.67489 | valid_balanced_accuracy: 0.61106 | valid_accuracy: 0.61017 |  0:02:11s
epoch 8  | loss: 0.61647 | train_auc: 0.69546 | train_balanced_accuracy: 0.64555 | train_accuracy: 0.64562 | valid_auc: 0.68327 | valid_balanced_accuracy: 0.63571 | valid_accuracy: 0.63582 |  0:02:27s
epoch 9  | loss: 0.61296 | train_auc: 0.69922 | train_balanced_accuracy: 0.63814 | train_accuracy: 0.63747 | valid_auc: 0.68438 | valid_balanced_accuracy: 0.62827 | valid_accuracy: 0.62764 |  0:02:42s
epoch 10 | loss: 0.60666 | train_auc: 0.70877 | train_balanced_accuracy: 0.6538  | train_accuracy: 0.65396 | valid_auc: 0.69808 | valid_balanced_accuracy: 0.64964 | valid_accuracy: 0.64983 |  0:02:59s
epoch 11 | loss: 0.60532 | train_auc: 0.71037 | train_balanced_accuracy: 0.65747 | train_accuracy: 0.6577  | valid_auc: 0.69596 | valid_balanced_accuracy: 0.65383 | valid_accuracy: 0.65408 |  0:03:16s
epoch 12 | loss: 0.60247 | train_auc: 0.71501 | train_balanced_accuracy: 0.65992 | train_accuracy: 0.66049 | valid_auc: 0.70099 | valid_balanced_accuracy: 0.65378 | valid_accuracy: 0.65439 |  0:03:33s
epoch 13 | loss: 0.60328 | train_auc: 0.71858 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.6612  | valid_auc: 0.7035  | valid_balanced_accuracy: 0.65527 | valid_accuracy: 0.65549 |  0:03:49s
epoch 14 | loss: 0.6073  | train_auc: 0.72359 | train_balanced_accuracy: 0.66307 | train_accuracy: 0.66328 | valid_auc: 0.70947 | valid_balanced_accuracy: 0.65403 | valid_accuracy: 0.65423 |  0:04:07s
epoch 15 | loss: 0.60599 | train_auc: 0.72815 | train_balanced_accuracy: 0.6609  | train_accuracy: 0.66163 | valid_auc: 0.71443 | valid_balanced_accuracy: 0.65569 | valid_accuracy: 0.65644 |  0:04:25s
epoch 16 | loss: 0.59967 | train_auc: 0.73034 | train_balanced_accuracy: 0.66841 | train_accuracy: 0.66875 | valid_auc: 0.71237 | valid_balanced_accuracy: 0.66142 | valid_accuracy: 0.66179 |  0:04:41s
epoch 17 | loss: 0.59764 | train_auc: 0.73369 | train_balanced_accuracy: 0.66789 | train_accuracy: 0.66856 | valid_auc: 0.71496 | valid_balanced_accuracy: 0.66204 | valid_accuracy: 0.66273 |  0:04:59s
epoch 18 | loss: 0.60254 | train_auc: 0.73762 | train_balanced_accuracy: 0.66733 | train_accuracy: 0.6682  | valid_auc: 0.71958 | valid_balanced_accuracy: 0.66149 | valid_accuracy: 0.66242 |  0:05:15s
epoch 19 | loss: 0.59248 | train_auc: 0.74066 | train_balanced_accuracy: 0.67316 | train_accuracy: 0.67391 | valid_auc: 0.72135 | valid_balanced_accuracy: 0.66557 | valid_accuracy: 0.66635 |  0:05:33s
epoch 20 | loss: 0.59397 | train_auc: 0.74346 | train_balanced_accuracy: 0.67981 | train_accuracy: 0.68024 | valid_auc: 0.72534 | valid_balanced_accuracy: 0.66868 | valid_accuracy: 0.66918 |  0:05:48s
epoch 21 | loss: 0.5934  | train_auc: 0.7495  | train_balanced_accuracy: 0.68715 | train_accuracy: 0.68748 | valid_auc: 0.7244  | valid_balanced_accuracy: 0.66787 | valid_accuracy: 0.66824 |  0:06:05s
epoch 22 | loss: 0.59759 | train_auc: 0.74912 | train_balanced_accuracy: 0.68513 | train_accuracy: 0.68551 | valid_auc: 0.72915 | valid_balanced_accuracy: 0.66512 | valid_accuracy: 0.66556 |  0:06:22s
epoch 23 | loss: 0.59493 | train_auc: 0.75125 | train_balanced_accuracy: 0.68784 | train_accuracy: 0.68811 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.6747  | valid_accuracy: 0.67501 |  0:06:38s
epoch 24 | loss: 0.59512 | train_auc: 0.75098 | train_balanced_accuracy: 0.68561 | train_accuracy: 0.68606 | valid_auc: 0.73023 | valid_balanced_accuracy: 0.6712  | valid_accuracy: 0.6717  |  0:06:56s
epoch 25 | loss: 0.5941  | train_auc: 0.75251 | train_balanced_accuracy: 0.68719 | train_accuracy: 0.68724 | valid_auc: 0.7312  | valid_balanced_accuracy: 0.67053 | valid_accuracy: 0.6706  |  0:07:14s
epoch 26 | loss: 0.58934 | train_auc: 0.75837 | train_balanced_accuracy: 0.69016 | train_accuracy: 0.69055 | valid_auc: 0.73973 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.6813  |  0:07:33s
epoch 27 | loss: 0.59368 | train_auc: 0.75803 | train_balanced_accuracy: 0.69022 | train_accuracy: 0.69039 | valid_auc: 0.73714 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.67894 |  0:07:49s
epoch 28 | loss: 0.58915 | train_auc: 0.75824 | train_balanced_accuracy: 0.69292 | train_accuracy: 0.69295 | valid_auc: 0.73614 | valid_balanced_accuracy: 0.67384 | valid_accuracy: 0.67391 |  0:08:04s
epoch 29 | loss: 0.58792 | train_auc: 0.75789 | train_balanced_accuracy: 0.69202 | train_accuracy: 0.69197 | valid_auc: 0.73716 | valid_balanced_accuracy: 0.67361 | valid_accuracy: 0.67359 |  0:08:21s
epoch 30 | loss: 0.58661 | train_auc: 0.75426 | train_balanced_accuracy: 0.68938 | train_accuracy: 0.68945 | valid_auc: 0.73435 | valid_balanced_accuracy: 0.6721  | valid_accuracy: 0.67218 |  0:08:36s
epoch 31 | loss: 0.58559 | train_auc: 0.7436  | train_balanced_accuracy: 0.68196 | train_accuracy: 0.68209 | valid_auc: 0.73175 | valid_balanced_accuracy: 0.67376 | valid_accuracy: 0.67391 |  0:08:53s
epoch 32 | loss: 0.582   | train_auc: 0.72413 | train_balanced_accuracy: 0.66376 | train_accuracy: 0.6636  | valid_auc: 0.71109 | valid_balanced_accuracy: 0.65014 | valid_accuracy: 0.64998 |  0:09:09s
epoch 33 | loss: 0.58515 | train_auc: 0.67319 | train_balanced_accuracy: 0.62893 | train_accuracy: 0.62921 | valid_auc: 0.66233 | valid_balanced_accuracy: 0.62069 | valid_accuracy: 0.62103 |  0:09:24s
epoch 34 | loss: 0.58313 | train_auc: 0.67901 | train_balanced_accuracy: 0.64036 | train_accuracy: 0.64023 | valid_auc: 0.6618  | valid_balanced_accuracy: 0.6216  | valid_accuracy: 0.6215  |  0:09:40s
epoch 35 | loss: 0.57836 | train_auc: 0.68851 | train_balanced_accuracy: 0.64177 | train_accuracy: 0.6418  | valid_auc: 0.68156 | valid_balanced_accuracy: 0.63514 | valid_accuracy: 0.63519 |  0:09:56s
epoch 36 | loss: 0.5825  | train_auc: 0.70896 | train_balanced_accuracy: 0.65948 | train_accuracy: 0.65943 | valid_auc: 0.69933 | valid_balanced_accuracy: 0.65107 | valid_accuracy: 0.65109 |  0:10:12s
epoch 37 | loss: 0.58244 | train_auc: 0.71756 | train_balanced_accuracy: 0.65997 | train_accuracy: 0.66029 | valid_auc: 0.70493 | valid_balanced_accuracy: 0.65243 | valid_accuracy: 0.65282 |  0:10:29s
epoch 38 | loss: 0.58321 | train_auc: 0.72129 | train_balanced_accuracy: 0.66373 | train_accuracy: 0.66383 | valid_auc: 0.70677 | valid_balanced_accuracy: 0.65456 | valid_accuracy: 0.65471 |  0:10:45s
epoch 39 | loss: 0.58045 | train_auc: 0.72473 | train_balanced_accuracy: 0.6589  | train_accuracy: 0.65915 | valid_auc: 0.71095 | valid_balanced_accuracy: 0.64718 | valid_accuracy: 0.64747 |  0:11:00s
epoch 40 | loss: 0.58046 | train_auc: 0.72796 | train_balanced_accuracy: 0.66501 | train_accuracy: 0.66513 | valid_auc: 0.71396 | valid_balanced_accuracy: 0.65943 | valid_accuracy: 0.65958 |  0:11:15s
epoch 41 | loss: 0.57874 | train_auc: 0.73249 | train_balanced_accuracy: 0.66285 | train_accuracy: 0.66352 | valid_auc: 0.72182 | valid_balanced_accuracy: 0.6564  | valid_accuracy: 0.65707 |  0:11:32s
epoch 42 | loss: 0.5762  | train_auc: 0.75142 | train_balanced_accuracy: 0.68332 | train_accuracy: 0.68378 | valid_auc: 0.73281 | valid_balanced_accuracy: 0.66901 | valid_accuracy: 0.6695  |  0:11:49s
epoch 43 | loss: 0.57989 | train_auc: 0.76677 | train_balanced_accuracy: 0.6975  | train_accuracy: 0.69767 | valid_auc: 0.74446 | valid_balanced_accuracy: 0.68585 | valid_accuracy: 0.68602 |  0:12:06s
epoch 44 | loss: 0.58337 | train_auc: 0.76346 | train_balanced_accuracy: 0.6966  | train_accuracy: 0.69681 | valid_auc: 0.73937 | valid_balanced_accuracy: 0.67765 | valid_accuracy: 0.67784 |  0:12:21s
epoch 45 | loss: 0.57251 | train_auc: 0.7304  | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67705 | valid_auc: 0.71459 | valid_balanced_accuracy: 0.66565 | valid_accuracy: 0.66604 |  0:12:37s
epoch 46 | loss: 0.57917 | train_auc: 0.71019 | train_balanced_accuracy: 0.66073 | train_accuracy: 0.66069 | valid_auc: 0.70415 | valid_balanced_accuracy: 0.65644 | valid_accuracy: 0.65644 |  0:12:52s
epoch 47 | loss: 0.57401 | train_auc: 0.6948  | train_balanced_accuracy: 0.64292 | train_accuracy: 0.64326 | valid_auc: 0.69063 | valid_balanced_accuracy: 0.64215 | valid_accuracy: 0.64243 |  0:13:09s
epoch 48 | loss: 0.57446 | train_auc: 0.77847 | train_balanced_accuracy: 0.70808 | train_accuracy: 0.70829 | valid_auc: 0.74876 | valid_balanced_accuracy: 0.68377 | valid_accuracy: 0.68398 |  0:13:27s
epoch 49 | loss: 0.57379 | train_auc: 0.77023 | train_balanced_accuracy: 0.69877 | train_accuracy: 0.69901 | valid_auc: 0.74724 | valid_balanced_accuracy: 0.68091 | valid_accuracy: 0.68115 |  0:13:44s
epoch 50 | loss: 0.57551 | train_auc: 0.77735 | train_balanced_accuracy: 0.70321 | train_accuracy: 0.7033  | valid_auc: 0.75038 | valid_balanced_accuracy: 0.68295 | valid_accuracy: 0.68303 |  0:14:00s
epoch 51 | loss: 0.56957 | train_auc: 0.77913 | train_balanced_accuracy: 0.70646 | train_accuracy: 0.70648 | valid_auc: 0.75179 | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.68744 |  0:14:16s
epoch 52 | loss: 0.56783 | train_auc: 0.72871 | train_balanced_accuracy: 0.65983 | train_accuracy: 0.66029 | valid_auc: 0.71632 | valid_balanced_accuracy: 0.65678 | valid_accuracy: 0.65722 |  0:14:32s
epoch 53 | loss: 0.57064 | train_auc: 0.72763 | train_balanced_accuracy: 0.65233 | train_accuracy: 0.65297 | valid_auc: 0.7153  | valid_balanced_accuracy: 0.64836 | valid_accuracy: 0.64904 |  0:14:46s
epoch 54 | loss: 0.5731  | train_auc: 0.73925 | train_balanced_accuracy: 0.66951 | train_accuracy: 0.6697  | valid_auc: 0.72404 | valid_balanced_accuracy: 0.65781 | valid_accuracy: 0.65801 |  0:15:04s
epoch 55 | loss: 0.56679 | train_auc: 0.76119 | train_balanced_accuracy: 0.68796 | train_accuracy: 0.68823 | valid_auc: 0.73728 | valid_balanced_accuracy: 0.67271 | valid_accuracy: 0.67296 |  0:15:22s
epoch 56 | loss: 0.57394 | train_auc: 0.77452 | train_balanced_accuracy: 0.70265 | train_accuracy: 0.70279 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.68543 | valid_accuracy: 0.68555 |  0:15:38s
epoch 57 | loss: 0.57459 | train_auc: 0.77534 | train_balanced_accuracy: 0.69963 | train_accuracy: 0.69952 | valid_auc: 0.74798 | valid_balanced_accuracy: 0.68108 | valid_accuracy: 0.68099 |  0:15:54s
epoch 58 | loss: 0.57593 | train_auc: 0.77208 | train_balanced_accuracy: 0.70019 | train_accuracy: 0.70046 | valid_auc: 0.74468 | valid_balanced_accuracy: 0.68068 | valid_accuracy: 0.68099 |  0:16:09s
epoch 59 | loss: 0.56821 | train_auc: 0.78102 | train_balanced_accuracy: 0.71053 | train_accuracy: 0.71069 | valid_auc: 0.74896 | valid_balanced_accuracy: 0.68666 | valid_accuracy: 0.68681 |  0:16:26s
epoch 60 | loss: 0.56905 | train_auc: 0.78231 | train_balanced_accuracy: 0.71112 | train_accuracy: 0.71132 | valid_auc: 0.75273 | valid_balanced_accuracy: 0.69399 | valid_accuracy: 0.69421 |  0:16:42s
epoch 61 | loss: 0.56944 | train_auc: 0.77945 | train_balanced_accuracy: 0.70909 | train_accuracy: 0.70928 | valid_auc: 0.75193 | valid_balanced_accuracy: 0.69053 | valid_accuracy: 0.69075 |  0:16:57s
epoch 62 | loss: 0.56997 | train_auc: 0.77963 | train_balanced_accuracy: 0.70648 | train_accuracy: 0.70641 | valid_auc: 0.75063 | valid_balanced_accuracy: 0.68565 | valid_accuracy: 0.68555 |  0:17:13s
epoch 63 | loss: 0.56589 | train_auc: 0.78065 | train_balanced_accuracy: 0.70934 | train_accuracy: 0.70936 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.68741 | valid_accuracy: 0.68744 |  0:17:30s
epoch 64 | loss: 0.56143 | train_auc: 0.78258 | train_balanced_accuracy: 0.70796 | train_accuracy: 0.70786 | valid_auc: 0.75109 | valid_balanced_accuracy: 0.68613 | valid_accuracy: 0.68602 |  0:17:45s
epoch 65 | loss: 0.56528 | train_auc: 0.77996 | train_balanced_accuracy: 0.7095  | train_accuracy: 0.70967 | valid_auc: 0.74947 | valid_balanced_accuracy: 0.68837 | valid_accuracy: 0.68854 |  0:18:02s
epoch 66 | loss: 0.56661 | train_auc: 0.77042 | train_balanced_accuracy: 0.70193 | train_accuracy: 0.70192 | valid_auc: 0.74596 | valid_balanced_accuracy: 0.68386 | valid_accuracy: 0.68382 |  0:18:18s
epoch 67 | loss: 0.56291 | train_auc: 0.76146 | train_balanced_accuracy: 0.69557 | train_accuracy: 0.69574 | valid_auc: 0.73924 | valid_balanced_accuracy: 0.67847 | valid_accuracy: 0.67863 |  0:18:35s
epoch 68 | loss: 0.56262 | train_auc: 0.78549 | train_balanced_accuracy: 0.71108 | train_accuracy: 0.71121 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.6895  | valid_accuracy: 0.68964 |  0:18:52s
epoch 69 | loss: 0.56609 | train_auc: 0.78387 | train_balanced_accuracy: 0.71007 | train_accuracy: 0.7103  | valid_auc: 0.75419 | valid_balanced_accuracy: 0.68862 | valid_accuracy: 0.68886 |  0:19:09s
epoch 70 | loss: 0.56684 | train_auc: 0.78612 | train_balanced_accuracy: 0.7125  | train_accuracy: 0.71254 | valid_auc: 0.75818 | valid_balanced_accuracy: 0.68724 | valid_accuracy: 0.68728 |  0:19:26s
epoch 71 | loss: 0.56609 | train_auc: 0.78803 | train_balanced_accuracy: 0.71122 | train_accuracy: 0.71121 | valid_auc: 0.7559  | valid_balanced_accuracy: 0.68809 | valid_accuracy: 0.68807 |  0:19:42s
epoch 72 | loss: 0.56649 | train_auc: 0.78826 | train_balanced_accuracy: 0.71611 | train_accuracy: 0.7164  | valid_auc: 0.7567  | valid_balanced_accuracy: 0.69028 | valid_accuracy: 0.69059 |  0:19:58s
epoch 73 | loss: 0.5658  | train_auc: 0.78738 | train_balanced_accuracy: 0.71305 | train_accuracy: 0.71333 | valid_auc: 0.75862 | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69279 |  0:20:15s
epoch 74 | loss: 0.56475 | train_auc: 0.78985 | train_balanced_accuracy: 0.71653 | train_accuracy: 0.71671 | valid_auc: 0.76006 | valid_balanced_accuracy: 0.69575 | valid_accuracy: 0.69594 |  0:20:31s
epoch 75 | loss: 0.56394 | train_auc: 0.78914 | train_balanced_accuracy: 0.71301 | train_accuracy: 0.7129  | valid_auc: 0.75867 | valid_balanced_accuracy: 0.69379 | valid_accuracy: 0.69374 |  0:20:48s
epoch 76 | loss: 0.56472 | train_auc: 0.79148 | train_balanced_accuracy: 0.71604 | train_accuracy: 0.71593 | valid_auc: 0.76098 | valid_balanced_accuracy: 0.69305 | valid_accuracy: 0.69295 |  0:21:04s
epoch 77 | loss: 0.56143 | train_auc: 0.79016 | train_balanced_accuracy: 0.71457 | train_accuracy: 0.71479 | valid_auc: 0.75786 | valid_balanced_accuracy: 0.6877  | valid_accuracy: 0.68791 |  0:21:19s
epoch 78 | loss: 0.55486 | train_auc: 0.79299 | train_balanced_accuracy: 0.7183  | train_accuracy: 0.71841 | valid_auc: 0.76004 | valid_balanced_accuracy: 0.69143 | valid_accuracy: 0.69153 |  0:21:37s
epoch 79 | loss: 0.55721 | train_auc: 0.78157 | train_balanced_accuracy: 0.7072  | train_accuracy: 0.70731 | valid_auc: 0.74867 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68477 |  0:21:55s
epoch 80 | loss: 0.56161 | train_auc: 0.79018 | train_balanced_accuracy: 0.71399 | train_accuracy: 0.71404 | valid_auc: 0.75772 | valid_balanced_accuracy: 0.68916 | valid_accuracy: 0.68917 |  0:22:11s
epoch 81 | loss: 0.56291 | train_auc: 0.78888 | train_balanced_accuracy: 0.71132 | train_accuracy: 0.71172 | valid_auc: 0.75777 | valid_balanced_accuracy: 0.68738 | valid_accuracy: 0.68776 |  0:22:26s
epoch 82 | loss: 0.56166 | train_auc: 0.7861  | train_balanced_accuracy: 0.71274 | train_accuracy: 0.71302 | valid_auc: 0.75736 | valid_balanced_accuracy: 0.68685 | valid_accuracy: 0.68713 |  0:22:40s
epoch 83 | loss: 0.55381 | train_auc: 0.7917  | train_balanced_accuracy: 0.71644 | train_accuracy: 0.7166  | valid_auc: 0.75685 | valid_balanced_accuracy: 0.68824 | valid_accuracy: 0.68839 |  0:22:57s
epoch 84 | loss: 0.55356 | train_auc: 0.79228 | train_balanced_accuracy: 0.71688 | train_accuracy: 0.71711 | valid_auc: 0.75525 | valid_balanced_accuracy: 0.68503 | valid_accuracy: 0.68524 |  0:23:14s
epoch 85 | loss: 0.55862 | train_auc: 0.79253 | train_balanced_accuracy: 0.71552 | train_accuracy: 0.71577 | valid_auc: 0.75476 | valid_balanced_accuracy: 0.68419 | valid_accuracy: 0.68445 |  0:23:29s
epoch 86 | loss: 0.55812 | train_auc: 0.79558 | train_balanced_accuracy: 0.72189 | train_accuracy: 0.72195 | valid_auc: 0.75622 | valid_balanced_accuracy: 0.68849 | valid_accuracy: 0.68854 |  0:23:44s
epoch 87 | loss: 0.55299 | train_auc: 0.79649 | train_balanced_accuracy: 0.71782 | train_accuracy: 0.7177  | valid_auc: 0.75648 | valid_balanced_accuracy: 0.6874  | valid_accuracy: 0.68728 |  0:24:01s
epoch 88 | loss: 0.55677 | train_auc: 0.79594 | train_balanced_accuracy: 0.72101 | train_accuracy: 0.72108 | valid_auc: 0.7559  | valid_balanced_accuracy: 0.68675 | valid_accuracy: 0.68681 |  0:24:17s
epoch 89 | loss: 0.55422 | train_auc: 0.79701 | train_balanced_accuracy: 0.71845 | train_accuracy: 0.71852 | valid_auc: 0.75823 | valid_balanced_accuracy: 0.68707 | valid_accuracy: 0.68713 |  0:24:33s
epoch 90 | loss: 0.55038 | train_auc: 0.79837 | train_balanced_accuracy: 0.72045 | train_accuracy: 0.72041 | valid_auc: 0.75799 | valid_balanced_accuracy: 0.6889  | valid_accuracy: 0.68886 |  0:24:51s
epoch 91 | loss: 0.55495 | train_auc: 0.79666 | train_balanced_accuracy: 0.72175 | train_accuracy: 0.72195 | valid_auc: 0.7573  | valid_balanced_accuracy: 0.68786 | valid_accuracy: 0.68807 |  0:25:07s
epoch 92 | loss: 0.55602 | train_auc: 0.79716 | train_balanced_accuracy: 0.72108 | train_accuracy: 0.72112 | valid_auc: 0.75714 | valid_balanced_accuracy: 0.68991 | valid_accuracy: 0.68996 |  0:25:24s
epoch 93 | loss: 0.55232 | train_auc: 0.79392 | train_balanced_accuracy: 0.71814 | train_accuracy: 0.71821 | valid_auc: 0.75501 | valid_balanced_accuracy: 0.68332 | valid_accuracy: 0.68335 |  0:25:39s
epoch 94 | loss: 0.5613  | train_auc: 0.79808 | train_balanced_accuracy: 0.72006 | train_accuracy: 0.72033 | valid_auc: 0.75658 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.68602 |  0:25:56s

Early stopping occurred at epoch 94 with best_epoch = 74 and best_valid_accuracy = 0.69594
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 47/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.694 total time=26.1min
[CV 5/5; 47/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71977 | train_auc: 0.58577 | train_balanced_accuracy: 0.51478 | train_accuracy: 0.51161 | valid_auc: 0.58322 | valid_balanced_accuracy: 0.51534 | valid_accuracy: 0.51212 |  0:00:16s
epoch 1  | loss: 0.65593 | train_auc: 0.62859 | train_balanced_accuracy: 0.59421 | train_accuracy: 0.59329 | valid_auc: 0.63014 | valid_balanced_accuracy: 0.59958 | valid_accuracy: 0.59868 |  0:00:31s
epoch 2  | loss: 0.64411 | train_auc: 0.64955 | train_balanced_accuracy: 0.60173 | train_accuracy: 0.60053 | valid_auc: 0.6477  | valid_balanced_accuracy: 0.59934 | valid_accuracy: 0.59805 |  0:00:48s
epoch 3  | loss: 0.62935 | train_auc: 0.66228 | train_balanced_accuracy: 0.60532 | train_accuracy: 0.60403 | valid_auc: 0.66    | valid_balanced_accuracy: 0.60662 | valid_accuracy: 0.60529 |  0:01:04s
epoch 4  | loss: 0.61567 | train_auc: 0.66099 | train_balanced_accuracy: 0.61085 | train_accuracy: 0.61001 | valid_auc: 0.66102 | valid_balanced_accuracy: 0.61021 | valid_accuracy: 0.60938 |  0:01:20s
epoch 5  | loss: 0.61526 | train_auc: 0.67064 | train_balanced_accuracy: 0.61633 | train_accuracy: 0.6156  | valid_auc: 0.67046 | valid_balanced_accuracy: 0.61497 | valid_accuracy: 0.61426 |  0:01:37s
epoch 6  | loss: 0.61643 | train_auc: 0.67204 | train_balanced_accuracy: 0.62167 | train_accuracy: 0.62126 | valid_auc: 0.67437 | valid_balanced_accuracy: 0.62379 | valid_accuracy: 0.62339 |  0:01:54s
epoch 7  | loss: 0.61272 | train_auc: 0.67419 | train_balanced_accuracy: 0.62609 | train_accuracy: 0.62555 | valid_auc: 0.67154 | valid_balanced_accuracy: 0.62265 | valid_accuracy: 0.62213 |  0:02:10s
epoch 8  | loss: 0.61131 | train_auc: 0.67737 | train_balanced_accuracy: 0.62577 | train_accuracy: 0.62528 | valid_auc: 0.67368 | valid_balanced_accuracy: 0.62088 | valid_accuracy: 0.6204  |  0:02:26s
epoch 9  | loss: 0.608   | train_auc: 0.68579 | train_balanced_accuracy: 0.62434 | train_accuracy: 0.62382 | valid_auc: 0.67989 | valid_balanced_accuracy: 0.62199 | valid_accuracy: 0.6215  |  0:02:42s
epoch 10 | loss: 0.60616 | train_auc: 0.69435 | train_balanced_accuracy: 0.62348 | train_accuracy: 0.62319 | valid_auc: 0.68655 | valid_balanced_accuracy: 0.62127 | valid_accuracy: 0.62103 |  0:02:59s
epoch 11 | loss: 0.60196 | train_auc: 0.69573 | train_balanced_accuracy: 0.62489 | train_accuracy: 0.62453 | valid_auc: 0.6876  | valid_balanced_accuracy: 0.61992 | valid_accuracy: 0.61961 |  0:03:13s
epoch 12 | loss: 0.60507 | train_auc: 0.70401 | train_balanced_accuracy: 0.63549 | train_accuracy: 0.63554 | valid_auc: 0.69896 | valid_balanced_accuracy: 0.63371 | valid_accuracy: 0.63377 |  0:03:30s
epoch 13 | loss: 0.60639 | train_auc: 0.70429 | train_balanced_accuracy: 0.63407 | train_accuracy: 0.63393 | valid_auc: 0.69885 | valid_balanced_accuracy: 0.63015 | valid_accuracy: 0.63    |  0:03:45s
epoch 14 | loss: 0.5969  | train_auc: 0.70747 | train_balanced_accuracy: 0.63503 | train_accuracy: 0.63484 | valid_auc: 0.70042 | valid_balanced_accuracy: 0.6338  | valid_accuracy: 0.63362 |  0:04:03s
epoch 15 | loss: 0.59878 | train_auc: 0.71595 | train_balanced_accuracy: 0.64767 | train_accuracy: 0.64751 | valid_auc: 0.70764 | valid_balanced_accuracy: 0.64546 | valid_accuracy: 0.64526 |  0:04:18s
epoch 16 | loss: 0.60104 | train_auc: 0.72177 | train_balanced_accuracy: 0.64962 | train_accuracy: 0.6492  | valid_auc: 0.71246 | valid_balanced_accuracy: 0.64302 | valid_accuracy: 0.64259 |  0:04:35s
epoch 17 | loss: 0.60168 | train_auc: 0.71862 | train_balanced_accuracy: 0.65013 | train_accuracy: 0.64983 | valid_auc: 0.71038 | valid_balanced_accuracy: 0.64542 | valid_accuracy: 0.64511 |  0:04:52s
epoch 18 | loss: 0.59602 | train_auc: 0.72863 | train_balanced_accuracy: 0.66398 | train_accuracy: 0.66419 | valid_auc: 0.71738 | valid_balanced_accuracy: 0.65941 | valid_accuracy: 0.65958 |  0:05:11s
epoch 19 | loss: 0.59602 | train_auc: 0.73261 | train_balanced_accuracy: 0.66788 | train_accuracy: 0.66808 | valid_auc: 0.72188 | valid_balanced_accuracy: 0.66602 | valid_accuracy: 0.66619 |  0:05:26s
epoch 20 | loss: 0.596   | train_auc: 0.73321 | train_balanced_accuracy: 0.66853 | train_accuracy: 0.66867 | valid_auc: 0.72385 | valid_balanced_accuracy: 0.66501 | valid_accuracy: 0.66509 |  0:05:42s
epoch 21 | loss: 0.59328 | train_auc: 0.73585 | train_balanced_accuracy: 0.67411 | train_accuracy: 0.67438 | valid_auc: 0.72496 | valid_balanced_accuracy: 0.66944 | valid_accuracy: 0.66966 |  0:05:59s
epoch 22 | loss: 0.58991 | train_auc: 0.73742 | train_balanced_accuracy: 0.67507 | train_accuracy: 0.67548 | valid_auc: 0.72654 | valid_balanced_accuracy: 0.6697  | valid_accuracy: 0.67013 |  0:06:15s
epoch 23 | loss: 0.58915 | train_auc: 0.74418 | train_balanced_accuracy: 0.67823 | train_accuracy: 0.67847 | valid_auc: 0.73118 | valid_balanced_accuracy: 0.66993 | valid_accuracy: 0.67013 |  0:06:29s
epoch 24 | loss: 0.59427 | train_auc: 0.74376 | train_balanced_accuracy: 0.68287 | train_accuracy: 0.68355 | valid_auc: 0.73011 | valid_balanced_accuracy: 0.67443 | valid_accuracy: 0.67517 |  0:06:46s
epoch 25 | loss: 0.5891  | train_auc: 0.74495 | train_balanced_accuracy: 0.67519 | train_accuracy: 0.67509 | valid_auc: 0.72914 | valid_balanced_accuracy: 0.66506 | valid_accuracy: 0.66494 |  0:07:03s
epoch 26 | loss: 0.59284 | train_auc: 0.75477 | train_balanced_accuracy: 0.69078 | train_accuracy: 0.69114 | valid_auc: 0.74189 | valid_balanced_accuracy: 0.68174 | valid_accuracy: 0.68209 |  0:07:18s
epoch 27 | loss: 0.58631 | train_auc: 0.74932 | train_balanced_accuracy: 0.68433 | train_accuracy: 0.68449 | valid_auc: 0.73761 | valid_balanced_accuracy: 0.67362 | valid_accuracy: 0.67375 |  0:07:35s
epoch 28 | loss: 0.58519 | train_auc: 0.75618 | train_balanced_accuracy: 0.69129 | train_accuracy: 0.69177 | valid_auc: 0.74223 | valid_balanced_accuracy: 0.68228 | valid_accuracy: 0.68272 |  0:07:52s
epoch 29 | loss: 0.58844 | train_auc: 0.74991 | train_balanced_accuracy: 0.68532 | train_accuracy: 0.68567 | valid_auc: 0.73851 | valid_balanced_accuracy: 0.67956 | valid_accuracy: 0.67989 |  0:08:08s
epoch 30 | loss: 0.58812 | train_auc: 0.7347  | train_balanced_accuracy: 0.67242 | train_accuracy: 0.67261 | valid_auc: 0.73068 | valid_balanced_accuracy: 0.66978 | valid_accuracy: 0.66997 |  0:08:24s
epoch 31 | loss: 0.58378 | train_auc: 0.735   | train_balanced_accuracy: 0.66963 | train_accuracy: 0.66981 | valid_auc: 0.72825 | valid_balanced_accuracy: 0.66776 | valid_accuracy: 0.66793 |  0:08:40s
epoch 32 | loss: 0.58577 | train_auc: 0.68512 | train_balanced_accuracy: 0.64269 | train_accuracy: 0.64239 | valid_auc: 0.68339 | valid_balanced_accuracy: 0.63972 | valid_accuracy: 0.63944 |  0:08:56s
epoch 33 | loss: 0.58726 | train_auc: 0.75853 | train_balanced_accuracy: 0.69438 | train_accuracy: 0.6948  | valid_auc: 0.73666 | valid_balanced_accuracy: 0.66941 | valid_accuracy: 0.66981 |  0:09:12s
epoch 34 | loss: 0.57633 | train_auc: 0.7553  | train_balanced_accuracy: 0.69018 | train_accuracy: 0.69051 | valid_auc: 0.73486 | valid_balanced_accuracy: 0.67298 | valid_accuracy: 0.67328 |  0:09:28s
epoch 35 | loss: 0.58464 | train_auc: 0.7406  | train_balanced_accuracy: 0.66871 | train_accuracy: 0.66852 | valid_auc: 0.7238  | valid_balanced_accuracy: 0.65399 | valid_accuracy: 0.65376 |  0:09:44s
epoch 36 | loss: 0.5756  | train_auc: 0.74238 | train_balanced_accuracy: 0.67985 | train_accuracy: 0.67973 | valid_auc: 0.72853 | valid_balanced_accuracy: 0.66832 | valid_accuracy: 0.66824 |  0:10:01s
epoch 37 | loss: 0.57768 | train_auc: 0.71417 | train_balanced_accuracy: 0.65993 | train_accuracy: 0.66006 | valid_auc: 0.7125  | valid_balanced_accuracy: 0.66022 | valid_accuracy: 0.66037 |  0:10:16s
epoch 38 | loss: 0.57925 | train_auc: 0.70454 | train_balanced_accuracy: 0.63355 | train_accuracy: 0.63279 | valid_auc: 0.70366 | valid_balanced_accuracy: 0.63935 | valid_accuracy: 0.63865 |  0:10:31s
epoch 39 | loss: 0.57933 | train_auc: 0.7014  | train_balanced_accuracy: 0.64661 | train_accuracy: 0.6466  | valid_auc: 0.70177 | valid_balanced_accuracy: 0.6479  | valid_accuracy: 0.64794 |  0:10:47s
epoch 40 | loss: 0.57413 | train_auc: 0.70084 | train_balanced_accuracy: 0.63797 | train_accuracy: 0.63759 | valid_auc: 0.69636 | valid_balanced_accuracy: 0.63496 | valid_accuracy: 0.63456 |  0:11:03s
epoch 41 | loss: 0.57771 | train_auc: 0.6941  | train_balanced_accuracy: 0.63383 | train_accuracy: 0.63397 | valid_auc: 0.69362 | valid_balanced_accuracy: 0.63317 | valid_accuracy: 0.6333  |  0:11:19s
epoch 42 | loss: 0.57841 | train_auc: 0.72819 | train_balanced_accuracy: 0.66584 | train_accuracy: 0.66635 | valid_auc: 0.7207  | valid_balanced_accuracy: 0.66047 | valid_accuracy: 0.661   |  0:11:35s
epoch 43 | loss: 0.57691 | train_auc: 0.72102 | train_balanced_accuracy: 0.66467 | train_accuracy: 0.66486 | valid_auc: 0.715   | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66179 |  0:11:50s
epoch 44 | loss: 0.57402 | train_auc: 0.76637 | train_balanced_accuracy: 0.69865 | train_accuracy: 0.69905 | valid_auc: 0.7472  | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.69012 |  0:12:07s
epoch 45 | loss: 0.57294 | train_auc: 0.70502 | train_balanced_accuracy: 0.65183 | train_accuracy: 0.65227 | valid_auc: 0.69973 | valid_balanced_accuracy: 0.65015 | valid_accuracy: 0.65061 |  0:12:23s
epoch 46 | loss: 0.57418 | train_auc: 0.70124 | train_balanced_accuracy: 0.65181 | train_accuracy: 0.65219 | valid_auc: 0.69707 | valid_balanced_accuracy: 0.64424 | valid_accuracy: 0.64463 |  0:12:40s
epoch 47 | loss: 0.57444 | train_auc: 0.71744 | train_balanced_accuracy: 0.66017 | train_accuracy: 0.66061 | valid_auc: 0.70193 | valid_balanced_accuracy: 0.64594 | valid_accuracy: 0.64636 |  0:12:54s
epoch 48 | loss: 0.57381 | train_auc: 0.73263 | train_balanced_accuracy: 0.67288 | train_accuracy: 0.67328 | valid_auc: 0.7169  | valid_balanced_accuracy: 0.66169 | valid_accuracy: 0.6621  |  0:13:09s
epoch 49 | loss: 0.57132 | train_auc: 0.7248  | train_balanced_accuracy: 0.66667 | train_accuracy: 0.6669  | valid_auc: 0.70888 | valid_balanced_accuracy: 0.65254 | valid_accuracy: 0.65282 |  0:13:26s
epoch 50 | loss: 0.56904 | train_auc: 0.76834 | train_balanced_accuracy: 0.69989 | train_accuracy: 0.70007 | valid_auc: 0.75006 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68854 |  0:13:44s
epoch 51 | loss: 0.57178 | train_auc: 0.7733  | train_balanced_accuracy: 0.70304 | train_accuracy: 0.70353 | valid_auc: 0.74516 | valid_balanced_accuracy: 0.68037 | valid_accuracy: 0.68083 |  0:14:00s
epoch 52 | loss: 0.56907 | train_auc: 0.75594 | train_balanced_accuracy: 0.69049 | train_accuracy: 0.69086 | valid_auc: 0.73112 | valid_balanced_accuracy: 0.66572 | valid_accuracy: 0.66604 |  0:14:18s
epoch 53 | loss: 0.57301 | train_auc: 0.7645  | train_balanced_accuracy: 0.69489 | train_accuracy: 0.69523 | valid_auc: 0.73954 | valid_balanced_accuracy: 0.67925 | valid_accuracy: 0.67957 |  0:14:35s
epoch 54 | loss: 0.57155 | train_auc: 0.75872 | train_balanced_accuracy: 0.69217 | train_accuracy: 0.69236 | valid_auc: 0.73896 | valid_balanced_accuracy: 0.67733 | valid_accuracy: 0.67753 |  0:14:52s
epoch 55 | loss: 0.57337 | train_auc: 0.75249 | train_balanced_accuracy: 0.6882  | train_accuracy: 0.68803 | valid_auc: 0.73562 | valid_balanced_accuracy: 0.67013 | valid_accuracy: 0.66997 |  0:15:09s
epoch 56 | loss: 0.5706  | train_auc: 0.77712 | train_balanced_accuracy: 0.7044  | train_accuracy: 0.70444 | valid_auc: 0.74834 | valid_balanced_accuracy: 0.68393 | valid_accuracy: 0.68398 |  0:15:24s
epoch 57 | loss: 0.56896 | train_auc: 0.77196 | train_balanced_accuracy: 0.70037 | train_accuracy: 0.70066 | valid_auc: 0.73965 | valid_balanced_accuracy: 0.67648 | valid_accuracy: 0.67674 |  0:15:40s
epoch 58 | loss: 0.56764 | train_auc: 0.73591 | train_balanced_accuracy: 0.6706  | train_accuracy: 0.67044 | valid_auc: 0.71709 | valid_balanced_accuracy: 0.66134 | valid_accuracy: 0.66116 |  0:15:55s
epoch 59 | loss: 0.57276 | train_auc: 0.71854 | train_balanced_accuracy: 0.66202 | train_accuracy: 0.6623  | valid_auc: 0.70681 | valid_balanced_accuracy: 0.65549 | valid_accuracy: 0.65581 |  0:16:11s
epoch 60 | loss: 0.5708  | train_auc: 0.73833 | train_balanced_accuracy: 0.6752  | train_accuracy: 0.67536 | valid_auc: 0.72503 | valid_balanced_accuracy: 0.66397 | valid_accuracy: 0.66415 |  0:16:28s
epoch 61 | loss: 0.57038 | train_auc: 0.76484 | train_balanced_accuracy: 0.69475 | train_accuracy: 0.69519 | valid_auc: 0.73574 | valid_balanced_accuracy: 0.67316 | valid_accuracy: 0.67359 |  0:16:43s
epoch 62 | loss: 0.55967 | train_auc: 0.75325 | train_balanced_accuracy: 0.68246 | train_accuracy: 0.68256 | valid_auc: 0.72879 | valid_balanced_accuracy: 0.66961 | valid_accuracy: 0.66966 |  0:16:59s
epoch 63 | loss: 0.56442 | train_auc: 0.71576 | train_balanced_accuracy: 0.66304 | train_accuracy: 0.66316 | valid_auc: 0.70913 | valid_balanced_accuracy: 0.65697 | valid_accuracy: 0.65707 |  0:17:15s
epoch 64 | loss: 0.56072 | train_auc: 0.72352 | train_balanced_accuracy: 0.66615 | train_accuracy: 0.66619 | valid_auc: 0.71559 | valid_balanced_accuracy: 0.66239 | valid_accuracy: 0.66242 |  0:17:32s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69012
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 47/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=17.7min
[CV 1/5; 48/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83059 | train_auc: 0.51074 | train_balanced_accuracy: 0.52081 | train_accuracy: 0.51847 | valid_auc: 0.49467 | valid_balanced_accuracy: 0.51136 | valid_accuracy: 0.50897 |  0:00:17s
epoch 1  | loss: 0.75907 | train_auc: 0.52393 | train_balanced_accuracy: 0.52005 | train_accuracy: 0.51761 | valid_auc: 0.51037 | valid_balanced_accuracy: 0.50959 | valid_accuracy: 0.50708 |  0:00:33s
epoch 2  | loss: 0.71429 | train_auc: 0.54223 | train_balanced_accuracy: 0.51904 | train_accuracy: 0.51635 | valid_auc: 0.53147 | valid_balanced_accuracy: 0.51647 | valid_accuracy: 0.51369 |  0:00:50s
epoch 3  | loss: 0.69127 | train_auc: 0.56204 | train_balanced_accuracy: 0.53357 | train_accuracy: 0.5311  | valid_auc: 0.55192 | valid_balanced_accuracy: 0.52756 | valid_accuracy: 0.52502 |  0:01:05s
epoch 4  | loss: 0.67558 | train_auc: 0.57437 | train_balanced_accuracy: 0.54252 | train_accuracy: 0.54019 | valid_auc: 0.5667  | valid_balanced_accuracy: 0.53311 | valid_accuracy: 0.53069 |  0:01:22s
epoch 5  | loss: 0.67382 | train_auc: 0.57978 | train_balanced_accuracy: 0.54959 | train_accuracy: 0.54731 | valid_auc: 0.57256 | valid_balanced_accuracy: 0.54076 | valid_accuracy: 0.5384  |  0:01:40s
epoch 6  | loss: 0.67298 | train_auc: 0.58476 | train_balanced_accuracy: 0.5558  | train_accuracy: 0.55365 | valid_auc: 0.57731 | valid_balanced_accuracy: 0.54927 | valid_accuracy: 0.54706 |  0:01:56s
epoch 7  | loss: 0.66629 | train_auc: 0.59582 | train_balanced_accuracy: 0.56065 | train_accuracy: 0.55857 | valid_auc: 0.58565 | valid_balanced_accuracy: 0.55248 | valid_accuracy: 0.55036 |  0:02:14s
epoch 8  | loss: 0.65692 | train_auc: 0.60881 | train_balanced_accuracy: 0.57096 | train_accuracy: 0.56927 | valid_auc: 0.59382 | valid_balanced_accuracy: 0.55807 | valid_accuracy: 0.55634 |  0:02:32s
epoch 9  | loss: 0.65924 | train_auc: 0.61998 | train_balanced_accuracy: 0.57334 | train_accuracy: 0.57167 | valid_auc: 0.60456 | valid_balanced_accuracy: 0.55724 | valid_accuracy: 0.55556 |  0:02:45s
epoch 10 | loss: 0.65381 | train_auc: 0.63171 | train_balanced_accuracy: 0.58017 | train_accuracy: 0.57871 | valid_auc: 0.61659 | valid_balanced_accuracy: 0.56192 | valid_accuracy: 0.56043 |  0:03:02s
epoch 11 | loss: 0.65097 | train_auc: 0.64008 | train_balanced_accuracy: 0.58643 | train_accuracy: 0.58521 | valid_auc: 0.6277  | valid_balanced_accuracy: 0.5732  | valid_accuracy: 0.57192 |  0:03:18s
epoch 12 | loss: 0.64605 | train_auc: 0.64574 | train_balanced_accuracy: 0.58655 | train_accuracy: 0.58528 | valid_auc: 0.63582 | valid_balanced_accuracy: 0.57542 | valid_accuracy: 0.57413 |  0:03:35s
epoch 13 | loss: 0.64845 | train_auc: 0.64864 | train_balanced_accuracy: 0.58977 | train_accuracy: 0.58859 | valid_auc: 0.64123 | valid_balanced_accuracy: 0.58071 | valid_accuracy: 0.57948 |  0:03:50s
epoch 14 | loss: 0.64382 | train_auc: 0.65904 | train_balanced_accuracy: 0.59667 | train_accuracy: 0.59575 | valid_auc: 0.65041 | valid_balanced_accuracy: 0.58563 | valid_accuracy: 0.58467 |  0:04:07s
epoch 15 | loss: 0.64265 | train_auc: 0.66687 | train_balanced_accuracy: 0.60686 | train_accuracy: 0.60618 | valid_auc: 0.65773 | valid_balanced_accuracy: 0.5939  | valid_accuracy: 0.59317 |  0:04:23s
epoch 16 | loss: 0.63722 | train_auc: 0.6712  | train_balanced_accuracy: 0.61268 | train_accuracy: 0.61224 | valid_auc: 0.66328 | valid_balanced_accuracy: 0.6042  | valid_accuracy: 0.60371 |  0:04:39s
epoch 17 | loss: 0.64169 | train_auc: 0.67099 | train_balanced_accuracy: 0.61169 | train_accuracy: 0.6111  | valid_auc: 0.66449 | valid_balanced_accuracy: 0.59998 | valid_accuracy: 0.59931 |  0:04:54s
epoch 18 | loss: 0.63334 | train_auc: 0.67482 | train_balanced_accuracy: 0.62296 | train_accuracy: 0.62282 | valid_auc: 0.66648 | valid_balanced_accuracy: 0.61443 | valid_accuracy: 0.61426 |  0:05:11s
epoch 19 | loss: 0.63277 | train_auc: 0.676   | train_balanced_accuracy: 0.62287 | train_accuracy: 0.62266 | valid_auc: 0.66619 | valid_balanced_accuracy: 0.61248 | valid_accuracy: 0.61221 |  0:05:26s
epoch 20 | loss: 0.63519 | train_auc: 0.67098 | train_balanced_accuracy: 0.61939 | train_accuracy: 0.61916 | valid_auc: 0.6641  | valid_balanced_accuracy: 0.61546 | valid_accuracy: 0.6152  |  0:05:41s
epoch 21 | loss: 0.6305  | train_auc: 0.6819  | train_balanced_accuracy: 0.63507 | train_accuracy: 0.63522 | valid_auc: 0.6752  | valid_balanced_accuracy: 0.63063 | valid_accuracy: 0.63078 |  0:05:56s
epoch 22 | loss: 0.63303 | train_auc: 0.6839  | train_balanced_accuracy: 0.63496 | train_accuracy: 0.63514 | valid_auc: 0.67876 | valid_balanced_accuracy: 0.63563 | valid_accuracy: 0.63582 |  0:06:12s
epoch 23 | loss: 0.63044 | train_auc: 0.68751 | train_balanced_accuracy: 0.6424  | train_accuracy: 0.64277 | valid_auc: 0.6807  | valid_balanced_accuracy: 0.64357 | valid_accuracy: 0.644   |  0:06:27s
epoch 24 | loss: 0.63461 | train_auc: 0.69208 | train_balanced_accuracy: 0.6459  | train_accuracy: 0.64623 | valid_auc: 0.68091 | valid_balanced_accuracy: 0.64029 | valid_accuracy: 0.6407  |  0:06:45s
epoch 25 | loss: 0.62994 | train_auc: 0.69118 | train_balanced_accuracy: 0.64224 | train_accuracy: 0.64249 | valid_auc: 0.67928 | valid_balanced_accuracy: 0.63758 | valid_accuracy: 0.63787 |  0:07:02s
epoch 26 | loss: 0.63017 | train_auc: 0.69769 | train_balanced_accuracy: 0.64917 | train_accuracy: 0.6495  | valid_auc: 0.686   | valid_balanced_accuracy: 0.64522 | valid_accuracy: 0.64558 |  0:07:20s
epoch 27 | loss: 0.62868 | train_auc: 0.70305 | train_balanced_accuracy: 0.65714 | train_accuracy: 0.65756 | valid_auc: 0.68962 | valid_balanced_accuracy: 0.65143 | valid_accuracy: 0.65187 |  0:07:35s
epoch 28 | loss: 0.6272  | train_auc: 0.70508 | train_balanced_accuracy: 0.65781 | train_accuracy: 0.65823 | valid_auc: 0.69207 | valid_balanced_accuracy: 0.64827 | valid_accuracy: 0.64873 |  0:07:52s
epoch 29 | loss: 0.62432 | train_auc: 0.70975 | train_balanced_accuracy: 0.65806 | train_accuracy: 0.65843 | valid_auc: 0.69558 | valid_balanced_accuracy: 0.64866 | valid_accuracy: 0.64904 |  0:08:09s
epoch 30 | loss: 0.62496 | train_auc: 0.70844 | train_balanced_accuracy: 0.65759 | train_accuracy: 0.658   | valid_auc: 0.69481 | valid_balanced_accuracy: 0.64403 | valid_accuracy: 0.64448 |  0:08:27s
epoch 31 | loss: 0.62197 | train_auc: 0.70988 | train_balanced_accuracy: 0.65818 | train_accuracy: 0.65863 | valid_auc: 0.69443 | valid_balanced_accuracy: 0.64791 | valid_accuracy: 0.64841 |  0:08:44s
epoch 32 | loss: 0.62636 | train_auc: 0.70661 | train_balanced_accuracy: 0.6549  | train_accuracy: 0.65524 | valid_auc: 0.69706 | valid_balanced_accuracy: 0.64721 | valid_accuracy: 0.64762 |  0:09:00s
epoch 33 | loss: 0.62307 | train_auc: 0.70773 | train_balanced_accuracy: 0.65666 | train_accuracy: 0.65693 | valid_auc: 0.69685 | valid_balanced_accuracy: 0.65044 | valid_accuracy: 0.65077 |  0:09:17s
epoch 34 | loss: 0.62048 | train_auc: 0.71235 | train_balanced_accuracy: 0.65783 | train_accuracy: 0.65808 | valid_auc: 0.69543 | valid_balanced_accuracy: 0.64341 | valid_accuracy: 0.64369 |  0:09:32s
epoch 35 | loss: 0.61856 | train_auc: 0.7084  | train_balanced_accuracy: 0.65763 | train_accuracy: 0.65812 | valid_auc: 0.69694 | valid_balanced_accuracy: 0.64348 | valid_accuracy: 0.644   |  0:09:49s
epoch 36 | loss: 0.62279 | train_auc: 0.69257 | train_balanced_accuracy: 0.6407  | train_accuracy: 0.64092 | valid_auc: 0.6737  | valid_balanced_accuracy: 0.62461 | valid_accuracy: 0.6248  |  0:10:06s
epoch 37 | loss: 0.61737 | train_auc: 0.6814  | train_balanced_accuracy: 0.63315 | train_accuracy: 0.63352 | valid_auc: 0.66547 | valid_balanced_accuracy: 0.62249 | valid_accuracy: 0.62276 |  0:10:22s
epoch 38 | loss: 0.61908 | train_auc: 0.68198 | train_balanced_accuracy: 0.63325 | train_accuracy: 0.63352 | valid_auc: 0.66741 | valid_balanced_accuracy: 0.62413 | valid_accuracy: 0.62433 |  0:10:39s
epoch 39 | loss: 0.61844 | train_auc: 0.66902 | train_balanced_accuracy: 0.62368 | train_accuracy: 0.62412 | valid_auc: 0.66134 | valid_balanced_accuracy: 0.62044 | valid_accuracy: 0.62087 |  0:10:54s
epoch 40 | loss: 0.61701 | train_auc: 0.65634 | train_balanced_accuracy: 0.61665 | train_accuracy: 0.61708 | valid_auc: 0.64805 | valid_balanced_accuracy: 0.61259 | valid_accuracy: 0.613   |  0:11:11s
epoch 41 | loss: 0.61717 | train_auc: 0.65439 | train_balanced_accuracy: 0.61331 | train_accuracy: 0.61373 | valid_auc: 0.64794 | valid_balanced_accuracy: 0.61367 | valid_accuracy: 0.6141  |  0:11:29s
epoch 42 | loss: 0.61311 | train_auc: 0.65073 | train_balanced_accuracy: 0.61136 | train_accuracy: 0.61196 | valid_auc: 0.63897 | valid_balanced_accuracy: 0.61025 | valid_accuracy: 0.6108  |  0:11:45s
epoch 43 | loss: 0.6168  | train_auc: 0.65513 | train_balanced_accuracy: 0.6132  | train_accuracy: 0.61361 | valid_auc: 0.64304 | valid_balanced_accuracy: 0.60979 | valid_accuracy: 0.61017 |  0:12:01s
epoch 44 | loss: 0.61382 | train_auc: 0.659   | train_balanced_accuracy: 0.61688 | train_accuracy: 0.61731 | valid_auc: 0.65173 | valid_balanced_accuracy: 0.61193 | valid_accuracy: 0.61237 |  0:12:17s
epoch 45 | loss: 0.61573 | train_auc: 0.69143 | train_balanced_accuracy: 0.63871 | train_accuracy: 0.63907 | valid_auc: 0.67785 | valid_balanced_accuracy: 0.6264  | valid_accuracy: 0.62669 |  0:12:35s
epoch 46 | loss: 0.6146  | train_auc: 0.70936 | train_balanced_accuracy: 0.65688 | train_accuracy: 0.65721 | valid_auc: 0.6962  | valid_balanced_accuracy: 0.64402 | valid_accuracy: 0.64432 |  0:12:52s
epoch 47 | loss: 0.61369 | train_auc: 0.69921 | train_balanced_accuracy: 0.64668 | train_accuracy: 0.64698 | valid_auc: 0.68685 | valid_balanced_accuracy: 0.63637 | valid_accuracy: 0.63661 |  0:13:08s

Early stopping occurred at epoch 47 with best_epoch = 27 and best_valid_accuracy = 0.65187
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 48/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.660 total time=13.3min
[CV 2/5; 48/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83005 | train_auc: 0.50483 | train_balanced_accuracy: 0.52323 | train_accuracy: 0.52087 | valid_auc: 0.49447 | valid_balanced_accuracy: 0.51687 | valid_accuracy: 0.51448 |  0:00:16s
epoch 1  | loss: 0.75262 | train_auc: 0.52561 | train_balanced_accuracy: 0.52094 | train_accuracy: 0.51847 | valid_auc: 0.51555 | valid_balanced_accuracy: 0.5159  | valid_accuracy: 0.51338 |  0:00:31s
epoch 2  | loss: 0.71586 | train_auc: 0.53822 | train_balanced_accuracy: 0.51918 | train_accuracy: 0.51651 | valid_auc: 0.53399 | valid_balanced_accuracy: 0.51282 | valid_accuracy: 0.51007 |  0:00:48s
epoch 3  | loss: 0.69519 | train_auc: 0.5456  | train_balanced_accuracy: 0.52268 | train_accuracy: 0.52013 | valid_auc: 0.54273 | valid_balanced_accuracy: 0.51587 | valid_accuracy: 0.51322 |  0:01:05s
epoch 4  | loss: 0.68497 | train_auc: 0.55376 | train_balanced_accuracy: 0.52316 | train_accuracy: 0.52052 | valid_auc: 0.55301 | valid_balanced_accuracy: 0.51519 | valid_accuracy: 0.51243 |  0:01:22s
epoch 5  | loss: 0.67946 | train_auc: 0.56428 | train_balanced_accuracy: 0.53154 | train_accuracy: 0.52894 | valid_auc: 0.56753 | valid_balanced_accuracy: 0.52412 | valid_accuracy: 0.5214  |  0:01:37s
epoch 6  | loss: 0.67535 | train_auc: 0.57025 | train_balanced_accuracy: 0.54488 | train_accuracy: 0.54263 | valid_auc: 0.57439 | valid_balanced_accuracy: 0.53869 | valid_accuracy: 0.53636 |  0:01:53s
epoch 7  | loss: 0.66797 | train_auc: 0.58406 | train_balanced_accuracy: 0.54951 | train_accuracy: 0.54731 | valid_auc: 0.58717 | valid_balanced_accuracy: 0.54714 | valid_accuracy: 0.54485 |  0:02:10s
epoch 8  | loss: 0.65963 | train_auc: 0.59633 | train_balanced_accuracy: 0.55395 | train_accuracy: 0.55176 | valid_auc: 0.59848 | valid_balanced_accuracy: 0.54933 | valid_accuracy: 0.54706 |  0:02:25s
epoch 9  | loss: 0.66295 | train_auc: 0.61181 | train_balanced_accuracy: 0.56154 | train_accuracy: 0.55947 | valid_auc: 0.61169 | valid_balanced_accuracy: 0.55232 | valid_accuracy: 0.5502  |  0:02:42s
epoch 10 | loss: 0.65502 | train_auc: 0.62525 | train_balanced_accuracy: 0.57012 | train_accuracy: 0.56825 | valid_auc: 0.62339 | valid_balanced_accuracy: 0.56627 | valid_accuracy: 0.56437 |  0:02:59s
epoch 11 | loss: 0.65254 | train_auc: 0.63603 | train_balanced_accuracy: 0.58374 | train_accuracy: 0.58222 | valid_auc: 0.63331 | valid_balanced_accuracy: 0.5795  | valid_accuracy: 0.5779  |  0:03:16s
epoch 12 | loss: 0.64959 | train_auc: 0.64445 | train_balanced_accuracy: 0.59427 | train_accuracy: 0.59304 | valid_auc: 0.64073 | valid_balanced_accuracy: 0.58924 | valid_accuracy: 0.58798 |  0:03:31s
epoch 13 | loss: 0.64906 | train_auc: 0.652   | train_balanced_accuracy: 0.60143 | train_accuracy: 0.60031 | valid_auc: 0.64736 | valid_balanced_accuracy: 0.59446 | valid_accuracy: 0.59333 |  0:03:47s
epoch 14 | loss: 0.64931 | train_auc: 0.66042 | train_balanced_accuracy: 0.60826 | train_accuracy: 0.60732 | valid_auc: 0.65533 | valid_balanced_accuracy: 0.60104 | valid_accuracy: 0.60009 |  0:04:04s
epoch 15 | loss: 0.6435  | train_auc: 0.6663  | train_balanced_accuracy: 0.61367 | train_accuracy: 0.61283 | valid_auc: 0.66254 | valid_balanced_accuracy: 0.6076  | valid_accuracy: 0.6067  |  0:04:22s
epoch 16 | loss: 0.64373 | train_auc: 0.67622 | train_balanced_accuracy: 0.62369 | train_accuracy: 0.62294 | valid_auc: 0.67089 | valid_balanced_accuracy: 0.62099 | valid_accuracy: 0.62024 |  0:04:39s
epoch 17 | loss: 0.64009 | train_auc: 0.68188 | train_balanced_accuracy: 0.63102 | train_accuracy: 0.63042 | valid_auc: 0.67528 | valid_balanced_accuracy: 0.62606 | valid_accuracy: 0.62543 |  0:04:54s
epoch 18 | loss: 0.6382  | train_auc: 0.68699 | train_balanced_accuracy: 0.63863 | train_accuracy: 0.63844 | valid_auc: 0.67983 | valid_balanced_accuracy: 0.63825 | valid_accuracy: 0.63802 |  0:05:13s
epoch 19 | loss: 0.63517 | train_auc: 0.69203 | train_balanced_accuracy: 0.64108 | train_accuracy: 0.64088 | valid_auc: 0.68301 | valid_balanced_accuracy: 0.6367  | valid_accuracy: 0.63645 |  0:05:30s
epoch 20 | loss: 0.63792 | train_auc: 0.6973  | train_balanced_accuracy: 0.64427 | train_accuracy: 0.64423 | valid_auc: 0.68926 | valid_balanced_accuracy: 0.63999 | valid_accuracy: 0.63991 |  0:05:48s
epoch 21 | loss: 0.6332  | train_auc: 0.69915 | train_balanced_accuracy: 0.64842 | train_accuracy: 0.64859 | valid_auc: 0.69241 | valid_balanced_accuracy: 0.64657 | valid_accuracy: 0.64668 |  0:06:07s
epoch 22 | loss: 0.63616 | train_auc: 0.69942 | train_balanced_accuracy: 0.64955 | train_accuracy: 0.64989 | valid_auc: 0.69436 | valid_balanced_accuracy: 0.64214 | valid_accuracy: 0.64243 |  0:06:24s
epoch 23 | loss: 0.63364 | train_auc: 0.7003  | train_balanced_accuracy: 0.64856 | train_accuracy: 0.64883 | valid_auc: 0.69557 | valid_balanced_accuracy: 0.643   | valid_accuracy: 0.64322 |  0:06:41s
epoch 24 | loss: 0.63085 | train_auc: 0.7033  | train_balanced_accuracy: 0.65003 | train_accuracy: 0.65036 | valid_auc: 0.69705 | valid_balanced_accuracy: 0.64627 | valid_accuracy: 0.64652 |  0:06:56s
epoch 25 | loss: 0.63173 | train_auc: 0.70412 | train_balanced_accuracy: 0.65014 | train_accuracy: 0.65056 | valid_auc: 0.69784 | valid_balanced_accuracy: 0.65027 | valid_accuracy: 0.65061 |  0:07:12s
epoch 26 | loss: 0.62825 | train_auc: 0.70633 | train_balanced_accuracy: 0.65146 | train_accuracy: 0.65186 | valid_auc: 0.69869 | valid_balanced_accuracy: 0.64759 | valid_accuracy: 0.64794 |  0:07:28s
epoch 27 | loss: 0.63067 | train_auc: 0.71023 | train_balanced_accuracy: 0.65603 | train_accuracy: 0.65646 | valid_auc: 0.70054 | valid_balanced_accuracy: 0.64991 | valid_accuracy: 0.6503  |  0:07:43s
epoch 28 | loss: 0.62725 | train_auc: 0.7114  | train_balanced_accuracy: 0.65778 | train_accuracy: 0.65823 | valid_auc: 0.70008 | valid_balanced_accuracy: 0.64911 | valid_accuracy: 0.64951 |  0:08:00s
epoch 29 | loss: 0.62762 | train_auc: 0.71268 | train_balanced_accuracy: 0.656   | train_accuracy: 0.65642 | valid_auc: 0.70148 | valid_balanced_accuracy: 0.64695 | valid_accuracy: 0.64731 |  0:08:16s
epoch 30 | loss: 0.62407 | train_auc: 0.71447 | train_balanced_accuracy: 0.65831 | train_accuracy: 0.65874 | valid_auc: 0.70468 | valid_balanced_accuracy: 0.6479  | valid_accuracy: 0.64825 |  0:08:31s
epoch 31 | loss: 0.62451 | train_auc: 0.71594 | train_balanced_accuracy: 0.65892 | train_accuracy: 0.6593  | valid_auc: 0.70704 | valid_balanced_accuracy: 0.64892 | valid_accuracy: 0.6492  |  0:08:48s
epoch 32 | loss: 0.62559 | train_auc: 0.7179  | train_balanced_accuracy: 0.65858 | train_accuracy: 0.65894 | valid_auc: 0.709   | valid_balanced_accuracy: 0.65207 | valid_accuracy: 0.65234 |  0:09:04s
epoch 33 | loss: 0.62438 | train_auc: 0.71784 | train_balanced_accuracy: 0.65989 | train_accuracy: 0.6602  | valid_auc: 0.7092  | valid_balanced_accuracy: 0.65367 | valid_accuracy: 0.65392 |  0:09:19s
epoch 34 | loss: 0.62371 | train_auc: 0.71745 | train_balanced_accuracy: 0.65869 | train_accuracy: 0.65898 | valid_auc: 0.70953 | valid_balanced_accuracy: 0.65572 | valid_accuracy: 0.65596 |  0:09:36s
epoch 35 | loss: 0.61891 | train_auc: 0.71845 | train_balanced_accuracy: 0.66075 | train_accuracy: 0.66122 | valid_auc: 0.71123 | valid_balanced_accuracy: 0.65471 | valid_accuracy: 0.65518 |  0:09:51s
epoch 36 | loss: 0.61952 | train_auc: 0.72055 | train_balanced_accuracy: 0.66015 | train_accuracy: 0.66044 | valid_auc: 0.71357 | valid_balanced_accuracy: 0.65446 | valid_accuracy: 0.65471 |  0:10:08s
epoch 37 | loss: 0.6209  | train_auc: 0.72137 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.66138 | valid_auc: 0.71417 | valid_balanced_accuracy: 0.65671 | valid_accuracy: 0.65707 |  0:10:25s
epoch 38 | loss: 0.62199 | train_auc: 0.72293 | train_balanced_accuracy: 0.66218 | train_accuracy: 0.66248 | valid_auc: 0.71621 | valid_balanced_accuracy: 0.65855 | valid_accuracy: 0.6588  |  0:10:42s
epoch 39 | loss: 0.61766 | train_auc: 0.72084 | train_balanced_accuracy: 0.65949 | train_accuracy: 0.65985 | valid_auc: 0.71565 | valid_balanced_accuracy: 0.65991 | valid_accuracy: 0.66021 |  0:10:59s
epoch 40 | loss: 0.62107 | train_auc: 0.72042 | train_balanced_accuracy: 0.65972 | train_accuracy: 0.66008 | valid_auc: 0.71596 | valid_balanced_accuracy: 0.65851 | valid_accuracy: 0.6588  |  0:11:14s
epoch 41 | loss: 0.62131 | train_auc: 0.72554 | train_balanced_accuracy: 0.66641 | train_accuracy: 0.66681 | valid_auc: 0.71841 | valid_balanced_accuracy: 0.66256 | valid_accuracy: 0.66289 |  0:11:31s
epoch 42 | loss: 0.61648 | train_auc: 0.72736 | train_balanced_accuracy: 0.66601 | train_accuracy: 0.66634 | valid_auc: 0.71983 | valid_balanced_accuracy: 0.66388 | valid_accuracy: 0.66415 |  0:11:47s
epoch 43 | loss: 0.62013 | train_auc: 0.72635 | train_balanced_accuracy: 0.66527 | train_accuracy: 0.66547 | valid_auc: 0.72036 | valid_balanced_accuracy: 0.66089 | valid_accuracy: 0.661   |  0:12:05s
epoch 44 | loss: 0.61297 | train_auc: 0.71458 | train_balanced_accuracy: 0.65484 | train_accuracy: 0.65516 | valid_auc: 0.71189 | valid_balanced_accuracy: 0.65174 | valid_accuracy: 0.65203 |  0:12:21s
epoch 45 | loss: 0.61488 | train_auc: 0.71481 | train_balanced_accuracy: 0.65502 | train_accuracy: 0.6552  | valid_auc: 0.71215 | valid_balanced_accuracy: 0.6546  | valid_accuracy: 0.65471 |  0:12:38s
epoch 46 | loss: 0.61383 | train_auc: 0.71991 | train_balanced_accuracy: 0.65771 | train_accuracy: 0.65788 | valid_auc: 0.71597 | valid_balanced_accuracy: 0.65602 | valid_accuracy: 0.65612 |  0:12:54s
epoch 47 | loss: 0.61659 | train_auc: 0.71658 | train_balanced_accuracy: 0.65586 | train_accuracy: 0.65595 | valid_auc: 0.71222 | valid_balanced_accuracy: 0.64952 | valid_accuracy: 0.64951 |  0:13:09s
epoch 48 | loss: 0.61074 | train_auc: 0.72195 | train_balanced_accuracy: 0.662   | train_accuracy: 0.66233 | valid_auc: 0.71648 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.6632  |  0:13:27s
epoch 49 | loss: 0.61404 | train_auc: 0.72507 | train_balanced_accuracy: 0.66442 | train_accuracy: 0.66465 | valid_auc: 0.7189  | valid_balanced_accuracy: 0.6616  | valid_accuracy: 0.66179 |  0:13:42s
epoch 50 | loss: 0.61142 | train_auc: 0.72329 | train_balanced_accuracy: 0.66244 | train_accuracy: 0.66264 | valid_auc: 0.71709 | valid_balanced_accuracy: 0.65788 | valid_accuracy: 0.65801 |  0:13:59s
epoch 51 | loss: 0.60949 | train_auc: 0.72649 | train_balanced_accuracy: 0.66539 | train_accuracy: 0.66571 | valid_auc: 0.72055 | valid_balanced_accuracy: 0.66372 | valid_accuracy: 0.66399 |  0:14:16s
epoch 52 | loss: 0.61051 | train_auc: 0.72935 | train_balanced_accuracy: 0.66806 | train_accuracy: 0.66831 | valid_auc: 0.72348 | valid_balanced_accuracy: 0.66537 | valid_accuracy: 0.66556 |  0:14:33s
epoch 53 | loss: 0.61237 | train_auc: 0.72506 | train_balanced_accuracy: 0.66391 | train_accuracy: 0.66421 | valid_auc: 0.71982 | valid_balanced_accuracy: 0.66279 | valid_accuracy: 0.66305 |  0:14:50s
epoch 54 | loss: 0.61305 | train_auc: 0.71724 | train_balanced_accuracy: 0.65588 | train_accuracy: 0.65607 | valid_auc: 0.71264 | valid_balanced_accuracy: 0.65193 | valid_accuracy: 0.65203 |  0:15:05s
epoch 55 | loss: 0.61501 | train_auc: 0.71944 | train_balanced_accuracy: 0.65968 | train_accuracy: 0.66    | valid_auc: 0.71421 | valid_balanced_accuracy: 0.65224 | valid_accuracy: 0.6525  |  0:15:23s
epoch 56 | loss: 0.61326 | train_auc: 0.7215  | train_balanced_accuracy: 0.66432 | train_accuracy: 0.66476 | valid_auc: 0.71676 | valid_balanced_accuracy: 0.66015 | valid_accuracy: 0.66053 |  0:15:39s
epoch 57 | loss: 0.61224 | train_auc: 0.71629 | train_balanced_accuracy: 0.65924 | train_accuracy: 0.65961 | valid_auc: 0.71007 | valid_balanced_accuracy: 0.65564 | valid_accuracy: 0.65596 |  0:15:57s
epoch 58 | loss: 0.61002 | train_auc: 0.70703 | train_balanced_accuracy: 0.64782 | train_accuracy: 0.648   | valid_auc: 0.70667 | valid_balanced_accuracy: 0.65379 | valid_accuracy: 0.65392 |  0:16:15s
epoch 59 | loss: 0.61177 | train_auc: 0.71276 | train_balanced_accuracy: 0.65038 | train_accuracy: 0.65072 | valid_auc: 0.71321 | valid_balanced_accuracy: 0.65177 | valid_accuracy: 0.65203 |  0:16:32s
epoch 60 | loss: 0.60922 | train_auc: 0.70752 | train_balanced_accuracy: 0.64503 | train_accuracy: 0.64529 | valid_auc: 0.70755 | valid_balanced_accuracy: 0.64663 | valid_accuracy: 0.64684 |  0:16:46s
epoch 61 | loss: 0.60852 | train_auc: 0.71857 | train_balanced_accuracy: 0.65633 | train_accuracy: 0.65642 | valid_auc: 0.71841 | valid_balanced_accuracy: 0.65658 | valid_accuracy: 0.65659 |  0:17:01s
epoch 62 | loss: 0.60472 | train_auc: 0.72994 | train_balanced_accuracy: 0.66606 | train_accuracy: 0.66634 | valid_auc: 0.7246  | valid_balanced_accuracy: 0.66326 | valid_accuracy: 0.66352 |  0:17:18s
epoch 63 | loss: 0.60796 | train_auc: 0.73887 | train_balanced_accuracy: 0.67562 | train_accuracy: 0.67582 | valid_auc: 0.72507 | valid_balanced_accuracy: 0.66776 | valid_accuracy: 0.66793 |  0:17:33s
epoch 64 | loss: 0.60922 | train_auc: 0.73528 | train_balanced_accuracy: 0.67187 | train_accuracy: 0.6722  | valid_auc: 0.72287 | valid_balanced_accuracy: 0.66528 | valid_accuracy: 0.66556 |  0:17:50s
epoch 65 | loss: 0.60829 | train_auc: 0.73746 | train_balanced_accuracy: 0.67519 | train_accuracy: 0.67547 | valid_auc: 0.72528 | valid_balanced_accuracy: 0.66817 | valid_accuracy: 0.6684  |  0:18:06s
epoch 66 | loss: 0.60974 | train_auc: 0.72948 | train_balanced_accuracy: 0.6677  | train_accuracy: 0.66799 | valid_auc: 0.72158 | valid_balanced_accuracy: 0.6603  | valid_accuracy: 0.66053 |  0:18:23s
epoch 67 | loss: 0.60507 | train_auc: 0.74197 | train_balanced_accuracy: 0.6776  | train_accuracy: 0.67799 | valid_auc: 0.72802 | valid_balanced_accuracy: 0.66443 | valid_accuracy: 0.66478 |  0:18:39s
epoch 68 | loss: 0.60561 | train_auc: 0.74143 | train_balanced_accuracy: 0.67739 | train_accuracy: 0.67771 | valid_auc: 0.72721 | valid_balanced_accuracy: 0.66404 | valid_accuracy: 0.66431 |  0:18:56s
epoch 69 | loss: 0.60936 | train_auc: 0.74257 | train_balanced_accuracy: 0.67899 | train_accuracy: 0.67928 | valid_auc: 0.7295  | valid_balanced_accuracy: 0.6702  | valid_accuracy: 0.67044 |  0:19:12s
epoch 70 | loss: 0.60838 | train_auc: 0.72971 | train_balanced_accuracy: 0.66817 | train_accuracy: 0.6685  | valid_auc: 0.72583 | valid_balanced_accuracy: 0.66405 | valid_accuracy: 0.66431 |  0:19:27s
epoch 71 | loss: 0.60756 | train_auc: 0.72593 | train_balanced_accuracy: 0.6683  | train_accuracy: 0.66858 | valid_auc: 0.71838 | valid_balanced_accuracy: 0.66092 | valid_accuracy: 0.66116 |  0:19:46s
epoch 72 | loss: 0.60453 | train_auc: 0.72259 | train_balanced_accuracy: 0.66802 | train_accuracy: 0.66835 | valid_auc: 0.71666 | valid_balanced_accuracy: 0.66107 | valid_accuracy: 0.66132 |  0:20:00s
epoch 73 | loss: 0.60747 | train_auc: 0.72808 | train_balanced_accuracy: 0.6721  | train_accuracy: 0.67244 | valid_auc: 0.71814 | valid_balanced_accuracy: 0.6615  | valid_accuracy: 0.66179 |  0:20:16s
epoch 74 | loss: 0.60494 | train_auc: 0.72571 | train_balanced_accuracy: 0.66942 | train_accuracy: 0.66976 | valid_auc: 0.71823 | valid_balanced_accuracy: 0.65898 | valid_accuracy: 0.65927 |  0:20:33s
epoch 75 | loss: 0.60611 | train_auc: 0.72435 | train_balanced_accuracy: 0.66845 | train_accuracy: 0.6687  | valid_auc: 0.71688 | valid_balanced_accuracy: 0.65986 | valid_accuracy: 0.66006 |  0:20:51s
epoch 76 | loss: 0.60919 | train_auc: 0.74342 | train_balanced_accuracy: 0.6789  | train_accuracy: 0.67905 | valid_auc: 0.73083 | valid_balanced_accuracy: 0.66989 | valid_accuracy: 0.66997 |  0:21:08s
epoch 77 | loss: 0.60667 | train_auc: 0.74275 | train_balanced_accuracy: 0.67969 | train_accuracy: 0.67983 | valid_auc: 0.73041 | valid_balanced_accuracy: 0.66799 | valid_accuracy: 0.66808 |  0:21:23s
epoch 78 | loss: 0.60135 | train_auc: 0.74594 | train_balanced_accuracy: 0.68134 | train_accuracy: 0.68161 | valid_auc: 0.72981 | valid_balanced_accuracy: 0.66911 | valid_accuracy: 0.66934 |  0:21:42s
epoch 79 | loss: 0.60174 | train_auc: 0.74564 | train_balanced_accuracy: 0.68168 | train_accuracy: 0.68184 | valid_auc: 0.72897 | valid_balanced_accuracy: 0.66859 | valid_accuracy: 0.66871 |  0:21:59s
epoch 80 | loss: 0.60567 | train_auc: 0.74431 | train_balanced_accuracy: 0.68013 | train_accuracy: 0.68039 | valid_auc: 0.72927 | valid_balanced_accuracy: 0.67133 | valid_accuracy: 0.67155 |  0:22:16s
epoch 81 | loss: 0.59964 | train_auc: 0.74243 | train_balanced_accuracy: 0.68039 | train_accuracy: 0.68058 | valid_auc: 0.72888 | valid_balanced_accuracy: 0.66811 | valid_accuracy: 0.66824 |  0:22:30s
epoch 82 | loss: 0.60678 | train_auc: 0.74655 | train_balanced_accuracy: 0.6816  | train_accuracy: 0.68184 | valid_auc: 0.72982 | valid_balanced_accuracy: 0.67086 | valid_accuracy: 0.67107 |  0:22:47s
epoch 83 | loss: 0.6037  | train_auc: 0.74687 | train_balanced_accuracy: 0.68255 | train_accuracy: 0.68286 | valid_auc: 0.73068 | valid_balanced_accuracy: 0.66684 | valid_accuracy: 0.66714 |  0:23:05s
epoch 84 | loss: 0.60308 | train_auc: 0.74782 | train_balanced_accuracy: 0.68257 | train_accuracy: 0.68275 | valid_auc: 0.7307  | valid_balanced_accuracy: 0.67093 | valid_accuracy: 0.67107 |  0:23:22s
epoch 85 | loss: 0.60317 | train_auc: 0.74583 | train_balanced_accuracy: 0.68002 | train_accuracy: 0.68035 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.67344 | valid_accuracy: 0.67375 |  0:23:38s
epoch 86 | loss: 0.60555 | train_auc: 0.74277 | train_balanced_accuracy: 0.6797  | train_accuracy: 0.68011 | valid_auc: 0.73101 | valid_balanced_accuracy: 0.67132 | valid_accuracy: 0.6717  |  0:23:55s
epoch 87 | loss: 0.6009  | train_auc: 0.7427  | train_balanced_accuracy: 0.67839 | train_accuracy: 0.67861 | valid_auc: 0.73005 | valid_balanced_accuracy: 0.67106 | valid_accuracy: 0.67123 |  0:24:10s
epoch 88 | loss: 0.60212 | train_auc: 0.74152 | train_balanced_accuracy: 0.67725 | train_accuracy: 0.67759 | valid_auc: 0.73014 | valid_balanced_accuracy: 0.67328 | valid_accuracy: 0.67359 |  0:24:27s
epoch 89 | loss: 0.60321 | train_auc: 0.72112 | train_balanced_accuracy: 0.66356 | train_accuracy: 0.66374 | valid_auc: 0.72279 | valid_balanced_accuracy: 0.66495 | valid_accuracy: 0.66509 |  0:24:42s
epoch 90 | loss: 0.60416 | train_auc: 0.71215 | train_balanced_accuracy: 0.65248 | train_accuracy: 0.65284 | valid_auc: 0.71423 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65691 |  0:24:59s
epoch 91 | loss: 0.60054 | train_auc: 0.70447 | train_balanced_accuracy: 0.64517 | train_accuracy: 0.6456  | valid_auc: 0.70501 | valid_balanced_accuracy: 0.64505 | valid_accuracy: 0.64542 |  0:25:14s
epoch 92 | loss: 0.59978 | train_auc: 0.70816 | train_balanced_accuracy: 0.64744 | train_accuracy: 0.64789 | valid_auc: 0.71004 | valid_balanced_accuracy: 0.65243 | valid_accuracy: 0.65282 |  0:25:31s
epoch 93 | loss: 0.59797 | train_auc: 0.7068  | train_balanced_accuracy: 0.64556 | train_accuracy: 0.6458  | valid_auc: 0.70262 | valid_balanced_accuracy: 0.63939 | valid_accuracy: 0.6396  |  0:25:48s
epoch 94 | loss: 0.60067 | train_auc: 0.67895 | train_balanced_accuracy: 0.62395 | train_accuracy: 0.62436 | valid_auc: 0.67714 | valid_balanced_accuracy: 0.62096 | valid_accuracy: 0.62134 |  0:26:05s
epoch 95 | loss: 0.60179 | train_auc: 0.65208 | train_balanced_accuracy: 0.60215 | train_accuracy: 0.60248 | valid_auc: 0.64771 | valid_balanced_accuracy: 0.59271 | valid_accuracy: 0.59301 |  0:26:21s
epoch 96 | loss: 0.59576 | train_auc: 0.6473  | train_balanced_accuracy: 0.59918 | train_accuracy: 0.59957 | valid_auc: 0.64013 | valid_balanced_accuracy: 0.59151 | valid_accuracy: 0.59191 |  0:26:36s
epoch 97 | loss: 0.59694 | train_auc: 0.64824 | train_balanced_accuracy: 0.59943 | train_accuracy: 0.59992 | valid_auc: 0.63938 | valid_balanced_accuracy: 0.59171 | valid_accuracy: 0.59223 |  0:26:51s
epoch 98 | loss: 0.59793 | train_auc: 0.63695 | train_balanced_accuracy: 0.58329 | train_accuracy: 0.58399 | valid_auc: 0.62487 | valid_balanced_accuracy: 0.5816  | valid_accuracy: 0.58231 |  0:27:07s
epoch 99 | loss: 0.59538 | train_auc: 0.63713 | train_balanced_accuracy: 0.58406 | train_accuracy: 0.58473 | valid_auc: 0.62751 | valid_balanced_accuracy: 0.57909 | valid_accuracy: 0.57979 |  0:27:26s
epoch 100| loss: 0.60353 | train_auc: 0.63722 | train_balanced_accuracy: 0.58319 | train_accuracy: 0.58414 | valid_auc: 0.62432 | valid_balanced_accuracy: 0.57817 | valid_accuracy: 0.57916 |  0:27:43s
epoch 101| loss: 0.59679 | train_auc: 0.64614 | train_balanced_accuracy: 0.59256 | train_accuracy: 0.59331 | valid_auc: 0.6365  | valid_balanced_accuracy: 0.58575 | valid_accuracy: 0.58656 |  0:27:59s
epoch 102| loss: 0.59512 | train_auc: 0.67607 | train_balanced_accuracy: 0.62422 | train_accuracy: 0.62451 | valid_auc: 0.67753 | valid_balanced_accuracy: 0.62293 | valid_accuracy: 0.62323 |  0:28:15s
epoch 103| loss: 0.59794 | train_auc: 0.68287 | train_balanced_accuracy: 0.6298  | train_accuracy: 0.63034 | valid_auc: 0.6808  | valid_balanced_accuracy: 0.62945 | valid_accuracy: 0.63    |  0:28:30s
epoch 104| loss: 0.59913 | train_auc: 0.68112 | train_balanced_accuracy: 0.62817 | train_accuracy: 0.62845 | valid_auc: 0.68112 | valid_balanced_accuracy: 0.62954 | valid_accuracy: 0.62984 |  0:28:47s
epoch 105| loss: 0.59564 | train_auc: 0.65136 | train_balanced_accuracy: 0.60181 | train_accuracy: 0.60209 | valid_auc: 0.64377 | valid_balanced_accuracy: 0.59289 | valid_accuracy: 0.59317 |  0:29:02s

Early stopping occurred at epoch 105 with best_epoch = 85 and best_valid_accuracy = 0.67375
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 48/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.664 total time=29.2min
[CV 3/5; 48/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82845 | train_auc: 0.50819 | train_balanced_accuracy: 0.52105 | train_accuracy: 0.51865 | valid_auc: 0.50829 | valid_balanced_accuracy: 0.51849 | valid_accuracy: 0.51605 |  0:00:14s
epoch 1  | loss: 0.74235 | train_auc: 0.52208 | train_balanced_accuracy: 0.51013 | train_accuracy: 0.5072  | valid_auc: 0.52066 | valid_balanced_accuracy: 0.51102 | valid_accuracy: 0.50803 |  0:00:32s
epoch 2  | loss: 0.70965 | train_auc: 0.53897 | train_balanced_accuracy: 0.5097  | train_accuracy: 0.50661 | valid_auc: 0.53664 | valid_balanced_accuracy: 0.50819 | valid_accuracy: 0.50504 |  0:00:47s
epoch 3  | loss: 0.69801 | train_auc: 0.55652 | train_balanced_accuracy: 0.51347 | train_accuracy: 0.51047 | valid_auc: 0.55562 | valid_balanced_accuracy: 0.51657 | valid_accuracy: 0.51353 |  0:01:04s
epoch 4  | loss: 0.68807 | train_auc: 0.56004 | train_balanced_accuracy: 0.52009 | train_accuracy: 0.51712 | valid_auc: 0.55688 | valid_balanced_accuracy: 0.52453 | valid_accuracy: 0.52156 |  0:01:21s
epoch 5  | loss: 0.6809  | train_auc: 0.56189 | train_balanced_accuracy: 0.52291 | train_accuracy: 0.51999 | valid_auc: 0.55628 | valid_balanced_accuracy: 0.5223  | valid_accuracy: 0.51936 |  0:01:39s
epoch 6  | loss: 0.67368 | train_auc: 0.56627 | train_balanced_accuracy: 0.53034 | train_accuracy: 0.52754 | valid_auc: 0.56188 | valid_balanced_accuracy: 0.52975 | valid_accuracy: 0.52691 |  0:01:56s
epoch 7  | loss: 0.67071 | train_auc: 0.57605 | train_balanced_accuracy: 0.53356 | train_accuracy: 0.53073 | valid_auc: 0.57409 | valid_balanced_accuracy: 0.53293 | valid_accuracy: 0.53006 |  0:02:14s
epoch 8  | loss: 0.66272 | train_auc: 0.5912  | train_balanced_accuracy: 0.53767 | train_accuracy: 0.5349  | valid_auc: 0.58973 | valid_balanced_accuracy: 0.53744 | valid_accuracy: 0.53462 |  0:02:31s
epoch 9  | loss: 0.66199 | train_auc: 0.60467 | train_balanced_accuracy: 0.54462 | train_accuracy: 0.54194 | valid_auc: 0.60248 | valid_balanced_accuracy: 0.54477 | valid_accuracy: 0.54202 |  0:02:48s
epoch 10 | loss: 0.6532  | train_auc: 0.62064 | train_balanced_accuracy: 0.55346 | train_accuracy: 0.55095 | valid_auc: 0.61657 | valid_balanced_accuracy: 0.55513 | valid_accuracy: 0.55257 |  0:03:05s
epoch 11 | loss: 0.6562  | train_auc: 0.63669 | train_balanced_accuracy: 0.56777 | train_accuracy: 0.56559 | valid_auc: 0.63351 | valid_balanced_accuracy: 0.56404 | valid_accuracy: 0.56185 |  0:03:21s
epoch 12 | loss: 0.65083 | train_auc: 0.64995 | train_balanced_accuracy: 0.57334 | train_accuracy: 0.57125 | valid_auc: 0.64811 | valid_balanced_accuracy: 0.56994 | valid_accuracy: 0.56783 |  0:03:37s
epoch 13 | loss: 0.64998 | train_auc: 0.65973 | train_balanced_accuracy: 0.58013 | train_accuracy: 0.57814 | valid_auc: 0.65727 | valid_balanced_accuracy: 0.57766 | valid_accuracy: 0.5757  |  0:03:52s
epoch 14 | loss: 0.6452  | train_auc: 0.66758 | train_balanced_accuracy: 0.58761 | train_accuracy: 0.58593 | valid_auc: 0.66519 | valid_balanced_accuracy: 0.58929 | valid_accuracy: 0.58766 |  0:04:11s
epoch 15 | loss: 0.64577 | train_auc: 0.67656 | train_balanced_accuracy: 0.59233 | train_accuracy: 0.59061 | valid_auc: 0.67349 | valid_balanced_accuracy: 0.59342 | valid_accuracy: 0.59175 |  0:04:27s
epoch 16 | loss: 0.64226 | train_auc: 0.68275 | train_balanced_accuracy: 0.60294 | train_accuracy: 0.60147 | valid_auc: 0.68041 | valid_balanced_accuracy: 0.60747 | valid_accuracy: 0.60607 |  0:04:44s
epoch 17 | loss: 0.63976 | train_auc: 0.68548 | train_balanced_accuracy: 0.60801 | train_accuracy: 0.60667 | valid_auc: 0.68314 | valid_balanced_accuracy: 0.61008 | valid_accuracy: 0.60875 |  0:05:03s
epoch 18 | loss: 0.63758 | train_auc: 0.69037 | train_balanced_accuracy: 0.62338 | train_accuracy: 0.62248 | valid_auc: 0.68685 | valid_balanced_accuracy: 0.6252  | valid_accuracy: 0.62433 |  0:05:18s
epoch 19 | loss: 0.63827 | train_auc: 0.6933  | train_balanced_accuracy: 0.62879 | train_accuracy: 0.62799 | valid_auc: 0.68709 | valid_balanced_accuracy: 0.62606 | valid_accuracy: 0.62528 |  0:05:33s
epoch 20 | loss: 0.63647 | train_auc: 0.69564 | train_balanced_accuracy: 0.6344  | train_accuracy: 0.63377 | valid_auc: 0.6905  | valid_balanced_accuracy: 0.63487 | valid_accuracy: 0.63425 |  0:05:50s
epoch 21 | loss: 0.63082 | train_auc: 0.69761 | train_balanced_accuracy: 0.64    | train_accuracy: 0.6396  | valid_auc: 0.69259 | valid_balanced_accuracy: 0.6419  | valid_accuracy: 0.64149 |  0:06:07s
epoch 22 | loss: 0.63582 | train_auc: 0.69842 | train_balanced_accuracy: 0.64473 | train_accuracy: 0.64483 | valid_auc: 0.69249 | valid_balanced_accuracy: 0.64427 | valid_accuracy: 0.64432 |  0:06:24s
epoch 23 | loss: 0.63449 | train_auc: 0.69962 | train_balanced_accuracy: 0.64524 | train_accuracy: 0.64526 | valid_auc: 0.69269 | valid_balanced_accuracy: 0.64322 | valid_accuracy: 0.64322 |  0:06:39s
epoch 24 | loss: 0.63255 | train_auc: 0.70157 | train_balanced_accuracy: 0.64604 | train_accuracy: 0.64625 | valid_auc: 0.69656 | valid_balanced_accuracy: 0.64918 | valid_accuracy: 0.64935 |  0:06:56s
epoch 25 | loss: 0.63023 | train_auc: 0.70239 | train_balanced_accuracy: 0.64653 | train_accuracy: 0.6468  | valid_auc: 0.69736 | valid_balanced_accuracy: 0.64534 | valid_accuracy: 0.64558 |  0:07:13s
epoch 26 | loss: 0.62829 | train_auc: 0.70338 | train_balanced_accuracy: 0.64687 | train_accuracy: 0.64727 | valid_auc: 0.69714 | valid_balanced_accuracy: 0.64803 | valid_accuracy: 0.64841 |  0:07:29s
epoch 27 | loss: 0.6283  | train_auc: 0.70552 | train_balanced_accuracy: 0.65042 | train_accuracy: 0.65081 | valid_auc: 0.69583 | valid_balanced_accuracy: 0.64475 | valid_accuracy: 0.64511 |  0:07:46s
epoch 28 | loss: 0.62529 | train_auc: 0.70965 | train_balanced_accuracy: 0.656   | train_accuracy: 0.65628 | valid_auc: 0.70073 | valid_balanced_accuracy: 0.65005 | valid_accuracy: 0.6503  |  0:08:03s
epoch 29 | loss: 0.62425 | train_auc: 0.71329 | train_balanced_accuracy: 0.6576  | train_accuracy: 0.65797 | valid_auc: 0.70152 | valid_balanced_accuracy: 0.64411 | valid_accuracy: 0.64448 |  0:08:19s
epoch 30 | loss: 0.62321 | train_auc: 0.71424 | train_balanced_accuracy: 0.65992 | train_accuracy: 0.66037 | valid_auc: 0.7013  | valid_balanced_accuracy: 0.64843 | valid_accuracy: 0.64888 |  0:08:36s
epoch 31 | loss: 0.62522 | train_auc: 0.71482 | train_balanced_accuracy: 0.65781 | train_accuracy: 0.65833 | valid_auc: 0.70315 | valid_balanced_accuracy: 0.65373 | valid_accuracy: 0.65423 |  0:08:51s
epoch 32 | loss: 0.61995 | train_auc: 0.71652 | train_balanced_accuracy: 0.66048 | train_accuracy: 0.661   | valid_auc: 0.70385 | valid_balanced_accuracy: 0.65294 | valid_accuracy: 0.65345 |  0:09:07s
epoch 33 | loss: 0.62532 | train_auc: 0.71674 | train_balanced_accuracy: 0.66081 | train_accuracy: 0.66128 | valid_auc: 0.70662 | valid_balanced_accuracy: 0.65485 | valid_accuracy: 0.65534 |  0:09:24s
epoch 34 | loss: 0.62272 | train_auc: 0.71636 | train_balanced_accuracy: 0.66087 | train_accuracy: 0.66132 | valid_auc: 0.7074  | valid_balanced_accuracy: 0.65757 | valid_accuracy: 0.65801 |  0:09:40s
epoch 35 | loss: 0.61822 | train_auc: 0.72115 | train_balanced_accuracy: 0.66468 | train_accuracy: 0.66525 | valid_auc: 0.70983 | valid_balanced_accuracy: 0.65802 | valid_accuracy: 0.65864 |  0:09:57s
epoch 36 | loss: 0.62076 | train_auc: 0.72469 | train_balanced_accuracy: 0.66566 | train_accuracy: 0.66619 | valid_auc: 0.70945 | valid_balanced_accuracy: 0.65447 | valid_accuracy: 0.65502 |  0:10:13s
epoch 37 | loss: 0.62043 | train_auc: 0.72354 | train_balanced_accuracy: 0.66357 | train_accuracy: 0.66403 | valid_auc: 0.70932 | valid_balanced_accuracy: 0.65516 | valid_accuracy: 0.65565 |  0:10:29s
epoch 38 | loss: 0.6187  | train_auc: 0.7244  | train_balanced_accuracy: 0.66494 | train_accuracy: 0.66517 | valid_auc: 0.71106 | valid_balanced_accuracy: 0.65966 | valid_accuracy: 0.6599  |  0:10:45s
epoch 39 | loss: 0.61328 | train_auc: 0.72756 | train_balanced_accuracy: 0.6665  | train_accuracy: 0.66675 | valid_auc: 0.71014 | valid_balanced_accuracy: 0.66278 | valid_accuracy: 0.66305 |  0:11:01s
epoch 40 | loss: 0.6175  | train_auc: 0.72375 | train_balanced_accuracy: 0.66457 | train_accuracy: 0.66482 | valid_auc: 0.70925 | valid_balanced_accuracy: 0.65948 | valid_accuracy: 0.65974 |  0:11:16s
epoch 41 | loss: 0.61751 | train_auc: 0.72895 | train_balanced_accuracy: 0.66945 | train_accuracy: 0.66989 | valid_auc: 0.7109  | valid_balanced_accuracy: 0.66025 | valid_accuracy: 0.66069 |  0:11:34s
epoch 42 | loss: 0.61385 | train_auc: 0.72984 | train_balanced_accuracy: 0.67049 | train_accuracy: 0.67084 | valid_auc: 0.71193 | valid_balanced_accuracy: 0.65989 | valid_accuracy: 0.66021 |  0:11:50s
epoch 43 | loss: 0.6174  | train_auc: 0.72626 | train_balanced_accuracy: 0.6668  | train_accuracy: 0.66702 | valid_auc: 0.71173 | valid_balanced_accuracy: 0.6562  | valid_accuracy: 0.65644 |  0:12:06s
epoch 44 | loss: 0.61797 | train_auc: 0.73165 | train_balanced_accuracy: 0.67203 | train_accuracy: 0.67229 | valid_auc: 0.71244 | valid_balanced_accuracy: 0.66214 | valid_accuracy: 0.66242 |  0:12:23s
epoch 45 | loss: 0.61428 | train_auc: 0.73175 | train_balanced_accuracy: 0.67118 | train_accuracy: 0.67158 | valid_auc: 0.71417 | valid_balanced_accuracy: 0.66118 | valid_accuracy: 0.66163 |  0:12:39s
epoch 46 | loss: 0.61808 | train_auc: 0.73337 | train_balanced_accuracy: 0.67235 | train_accuracy: 0.6728  | valid_auc: 0.71464 | valid_balanced_accuracy: 0.65862 | valid_accuracy: 0.65911 |  0:12:55s
epoch 47 | loss: 0.6128  | train_auc: 0.73116 | train_balanced_accuracy: 0.67002 | train_accuracy: 0.67029 | valid_auc: 0.71467 | valid_balanced_accuracy: 0.65915 | valid_accuracy: 0.65943 |  0:13:13s
epoch 48 | loss: 0.61353 | train_auc: 0.7243  | train_balanced_accuracy: 0.66389 | train_accuracy: 0.66423 | valid_auc: 0.71214 | valid_balanced_accuracy: 0.65454 | valid_accuracy: 0.65486 |  0:13:29s
epoch 49 | loss: 0.61178 | train_auc: 0.71939 | train_balanced_accuracy: 0.66148 | train_accuracy: 0.66159 | valid_auc: 0.71009 | valid_balanced_accuracy: 0.65334 | valid_accuracy: 0.65345 |  0:13:45s
epoch 50 | loss: 0.61459 | train_auc: 0.72658 | train_balanced_accuracy: 0.66737 | train_accuracy: 0.66749 | valid_auc: 0.71162 | valid_balanced_accuracy: 0.65742 | valid_accuracy: 0.65754 |  0:14:01s
epoch 51 | loss: 0.61056 | train_auc: 0.73005 | train_balanced_accuracy: 0.67111 | train_accuracy: 0.67135 | valid_auc: 0.7147  | valid_balanced_accuracy: 0.66076 | valid_accuracy: 0.661   |  0:14:20s
epoch 52 | loss: 0.60647 | train_auc: 0.73109 | train_balanced_accuracy: 0.67245 | train_accuracy: 0.67277 | valid_auc: 0.71402 | valid_balanced_accuracy: 0.65597 | valid_accuracy: 0.65628 |  0:14:36s
epoch 53 | loss: 0.60976 | train_auc: 0.73552 | train_balanced_accuracy: 0.67539 | train_accuracy: 0.67579 | valid_auc: 0.71699 | valid_balanced_accuracy: 0.65931 | valid_accuracy: 0.65974 |  0:14:52s
epoch 54 | loss: 0.60813 | train_auc: 0.73693 | train_balanced_accuracy: 0.67819 | train_accuracy: 0.67835 | valid_auc: 0.7192  | valid_balanced_accuracy: 0.66645 | valid_accuracy: 0.66667 |  0:15:07s
epoch 55 | loss: 0.60876 | train_auc: 0.73711 | train_balanced_accuracy: 0.67754 | train_accuracy: 0.67776 | valid_auc: 0.72032 | valid_balanced_accuracy: 0.668   | valid_accuracy: 0.66824 |  0:15:22s
epoch 56 | loss: 0.61022 | train_auc: 0.73896 | train_balanced_accuracy: 0.67692 | train_accuracy: 0.67745 | valid_auc: 0.72066 | valid_balanced_accuracy: 0.66536 | valid_accuracy: 0.66588 |  0:15:38s
epoch 57 | loss: 0.61417 | train_auc: 0.73666 | train_balanced_accuracy: 0.67713 | train_accuracy: 0.67737 | valid_auc: 0.71828 | valid_balanced_accuracy: 0.65885 | valid_accuracy: 0.65911 |  0:15:56s
epoch 58 | loss: 0.61382 | train_auc: 0.73304 | train_balanced_accuracy: 0.67297 | train_accuracy: 0.67304 | valid_auc: 0.71776 | valid_balanced_accuracy: 0.65901 | valid_accuracy: 0.65911 |  0:16:11s
epoch 59 | loss: 0.60963 | train_auc: 0.73261 | train_balanced_accuracy: 0.67411 | train_accuracy: 0.6743  | valid_auc: 0.7158  | valid_balanced_accuracy: 0.66004 | valid_accuracy: 0.66021 |  0:16:26s
epoch 60 | loss: 0.60948 | train_auc: 0.73112 | train_balanced_accuracy: 0.67318 | train_accuracy: 0.67336 | valid_auc: 0.71589 | valid_balanced_accuracy: 0.65815 | valid_accuracy: 0.65833 |  0:16:42s
epoch 61 | loss: 0.60985 | train_auc: 0.71333 | train_balanced_accuracy: 0.65569 | train_accuracy: 0.65565 | valid_auc: 0.70737 | valid_balanced_accuracy: 0.65412 | valid_accuracy: 0.65408 |  0:17:01s
epoch 62 | loss: 0.60557 | train_auc: 0.71609 | train_balanced_accuracy: 0.65974 | train_accuracy: 0.66014 | valid_auc: 0.70913 | valid_balanced_accuracy: 0.65619 | valid_accuracy: 0.65659 |  0:17:16s
epoch 63 | loss: 0.6068  | train_auc: 0.72251 | train_balanced_accuracy: 0.66378 | train_accuracy: 0.66403 | valid_auc: 0.71361 | valid_balanced_accuracy: 0.65654 | valid_accuracy: 0.65675 |  0:17:32s
epoch 64 | loss: 0.6049  | train_auc: 0.72655 | train_balanced_accuracy: 0.66769 | train_accuracy: 0.66793 | valid_auc: 0.71399 | valid_balanced_accuracy: 0.65954 | valid_accuracy: 0.65974 |  0:17:48s
epoch 65 | loss: 0.6039  | train_auc: 0.73858 | train_balanced_accuracy: 0.67952 | train_accuracy: 0.67977 | valid_auc: 0.72129 | valid_balanced_accuracy: 0.66625 | valid_accuracy: 0.66651 |  0:18:06s
epoch 66 | loss: 0.60832 | train_auc: 0.7435  | train_balanced_accuracy: 0.68155 | train_accuracy: 0.68181 | valid_auc: 0.72237 | valid_balanced_accuracy: 0.66891 | valid_accuracy: 0.66918 |  0:18:22s
epoch 67 | loss: 0.60468 | train_auc: 0.73937 | train_balanced_accuracy: 0.67665 | train_accuracy: 0.67709 | valid_auc: 0.72059 | valid_balanced_accuracy: 0.66151 | valid_accuracy: 0.66195 |  0:18:40s
epoch 68 | loss: 0.60632 | train_auc: 0.73267 | train_balanced_accuracy: 0.6726  | train_accuracy: 0.67277 | valid_auc: 0.71971 | valid_balanced_accuracy: 0.66496 | valid_accuracy: 0.66509 |  0:18:56s
epoch 69 | loss: 0.60647 | train_auc: 0.72548 | train_balanced_accuracy: 0.66721 | train_accuracy: 0.66765 | valid_auc: 0.71427 | valid_balanced_accuracy: 0.66168 | valid_accuracy: 0.6621  |  0:19:13s
epoch 70 | loss: 0.60319 | train_auc: 0.72734 | train_balanced_accuracy: 0.66871 | train_accuracy: 0.66911 | valid_auc: 0.7151  | valid_balanced_accuracy: 0.65984 | valid_accuracy: 0.66021 |  0:19:30s
epoch 71 | loss: 0.60764 | train_auc: 0.71877 | train_balanced_accuracy: 0.66171 | train_accuracy: 0.66206 | valid_auc: 0.7097  | valid_balanced_accuracy: 0.65674 | valid_accuracy: 0.65707 |  0:19:47s
epoch 72 | loss: 0.60681 | train_auc: 0.72279 | train_balanced_accuracy: 0.66537 | train_accuracy: 0.66541 | valid_auc: 0.71175 | valid_balanced_accuracy: 0.65738 | valid_accuracy: 0.65738 |  0:20:03s
epoch 73 | loss: 0.60067 | train_auc: 0.73583 | train_balanced_accuracy: 0.67451 | train_accuracy: 0.67501 | valid_auc: 0.72084 | valid_balanced_accuracy: 0.66038 | valid_accuracy: 0.66084 |  0:20:18s
epoch 74 | loss: 0.60469 | train_auc: 0.7246  | train_balanced_accuracy: 0.66828 | train_accuracy: 0.66848 | valid_auc: 0.71341 | valid_balanced_accuracy: 0.66352 | valid_accuracy: 0.66368 |  0:20:37s
epoch 75 | loss: 0.60723 | train_auc: 0.70703 | train_balanced_accuracy: 0.65296 | train_accuracy: 0.65313 | valid_auc: 0.70324 | valid_balanced_accuracy: 0.64964 | valid_accuracy: 0.64983 |  0:20:53s
epoch 76 | loss: 0.60548 | train_auc: 0.71422 | train_balanced_accuracy: 0.65869 | train_accuracy: 0.65903 | valid_auc: 0.70917 | valid_balanced_accuracy: 0.65469 | valid_accuracy: 0.65502 |  0:21:09s
epoch 77 | loss: 0.60189 | train_auc: 0.71166 | train_balanced_accuracy: 0.65429 | train_accuracy: 0.65455 | valid_auc: 0.70592 | valid_balanced_accuracy: 0.64782 | valid_accuracy: 0.6481  |  0:21:25s
epoch 78 | loss: 0.60119 | train_auc: 0.69953 | train_balanced_accuracy: 0.64585 | train_accuracy: 0.64625 | valid_auc: 0.70414 | valid_balanced_accuracy: 0.65088 | valid_accuracy: 0.65124 |  0:21:42s
epoch 79 | loss: 0.59776 | train_auc: 0.69863 | train_balanced_accuracy: 0.64393 | train_accuracy: 0.64428 | valid_auc: 0.70321 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65093 |  0:21:57s
epoch 80 | loss: 0.60526 | train_auc: 0.69732 | train_balanced_accuracy: 0.64427 | train_accuracy: 0.64467 | valid_auc: 0.69901 | valid_balanced_accuracy: 0.64532 | valid_accuracy: 0.64573 |  0:22:15s
epoch 81 | loss: 0.60668 | train_auc: 0.72131 | train_balanced_accuracy: 0.66551 | train_accuracy: 0.66572 | valid_auc: 0.71178 | valid_balanced_accuracy: 0.65764 | valid_accuracy: 0.65785 |  0:22:32s
epoch 82 | loss: 0.60337 | train_auc: 0.7198  | train_balanced_accuracy: 0.66144 | train_accuracy: 0.66159 | valid_auc: 0.71118 | valid_balanced_accuracy: 0.65928 | valid_accuracy: 0.65943 |  0:22:48s
epoch 83 | loss: 0.60307 | train_auc: 0.70376 | train_balanced_accuracy: 0.64964 | train_accuracy: 0.64998 | valid_auc: 0.70495 | valid_balanced_accuracy: 0.65408 | valid_accuracy: 0.65439 |  0:23:05s
epoch 84 | loss: 0.60455 | train_auc: 0.73037 | train_balanced_accuracy: 0.67084 | train_accuracy: 0.67096 | valid_auc: 0.71816 | valid_balanced_accuracy: 0.66298 | valid_accuracy: 0.66305 |  0:23:23s
epoch 85 | loss: 0.6046  | train_auc: 0.7468  | train_balanced_accuracy: 0.68234 | train_accuracy: 0.68248 | valid_auc: 0.72379 | valid_balanced_accuracy: 0.66759 | valid_accuracy: 0.66777 |  0:23:39s
epoch 86 | loss: 0.60091 | train_auc: 0.74148 | train_balanced_accuracy: 0.67764 | train_accuracy: 0.67823 | valid_auc: 0.72433 | valid_balanced_accuracy: 0.66544 | valid_accuracy: 0.66604 |  0:23:54s

Early stopping occurred at epoch 86 with best_epoch = 66 and best_valid_accuracy = 0.66918
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 48/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.675 total time=24.0min
[CV 4/5; 48/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82676 | train_auc: 0.49964 | train_balanced_accuracy: 0.52327 | train_accuracy: 0.52089 | valid_auc: 0.49582 | valid_balanced_accuracy: 0.51991 | valid_accuracy: 0.51747 |  0:00:13s
epoch 1  | loss: 0.74068 | train_auc: 0.51242 | train_balanced_accuracy: 0.51208 | train_accuracy: 0.50921 | valid_auc: 0.50637 | valid_balanced_accuracy: 0.50859 | valid_accuracy: 0.50567 |  0:00:31s
epoch 2  | loss: 0.69899 | train_auc: 0.53864 | train_balanced_accuracy: 0.5113  | train_accuracy: 0.50822 | valid_auc: 0.52947 | valid_balanced_accuracy: 0.50786 | valid_accuracy: 0.50472 |  0:00:47s
epoch 3  | loss: 0.69371 | train_auc: 0.5612  | train_balanced_accuracy: 0.51716 | train_accuracy: 0.51412 | valid_auc: 0.5559  | valid_balanced_accuracy: 0.51538 | valid_accuracy: 0.51228 |  0:01:04s
epoch 4  | loss: 0.68459 | train_auc: 0.56996 | train_balanced_accuracy: 0.51977 | train_accuracy: 0.5168  | valid_auc: 0.56512 | valid_balanced_accuracy: 0.51844 | valid_accuracy: 0.51542 |  0:01:21s
epoch 5  | loss: 0.67683 | train_auc: 0.58025 | train_balanced_accuracy: 0.52857 | train_accuracy: 0.52573 | valid_auc: 0.57389 | valid_balanced_accuracy: 0.52318 | valid_accuracy: 0.5203  |  0:01:39s
epoch 6  | loss: 0.67388 | train_auc: 0.59011 | train_balanced_accuracy: 0.54219 | train_accuracy: 0.53978 | valid_auc: 0.58366 | valid_balanced_accuracy: 0.53398 | valid_accuracy: 0.53148 |  0:01:53s
epoch 7  | loss: 0.67239 | train_auc: 0.59748 | train_balanced_accuracy: 0.54766 | train_accuracy: 0.54529 | valid_auc: 0.58586 | valid_balanced_accuracy: 0.53677 | valid_accuracy: 0.53431 |  0:02:10s
epoch 8  | loss: 0.66254 | train_auc: 0.60792 | train_balanced_accuracy: 0.55625 | train_accuracy: 0.55398 | valid_auc: 0.59405 | valid_balanced_accuracy: 0.54563 | valid_accuracy: 0.54328 |  0:02:28s
epoch 9  | loss: 0.65716 | train_auc: 0.61778 | train_balanced_accuracy: 0.56402 | train_accuracy: 0.56173 | valid_auc: 0.60462 | valid_balanced_accuracy: 0.55334 | valid_accuracy: 0.55099 |  0:02:43s
epoch 10 | loss: 0.65296 | train_auc: 0.63116 | train_balanced_accuracy: 0.57578 | train_accuracy: 0.57377 | valid_auc: 0.61961 | valid_balanced_accuracy: 0.56614 | valid_accuracy: 0.56405 |  0:03:02s
epoch 11 | loss: 0.654   | train_auc: 0.64446 | train_balanced_accuracy: 0.5893  | train_accuracy: 0.58758 | valid_auc: 0.63246 | valid_balanced_accuracy: 0.58135 | valid_accuracy: 0.57963 |  0:03:19s
epoch 12 | loss: 0.64543 | train_auc: 0.65714 | train_balanced_accuracy: 0.59594 | train_accuracy: 0.59435 | valid_auc: 0.64554 | valid_balanced_accuracy: 0.58673 | valid_accuracy: 0.58514 |  0:03:35s
epoch 13 | loss: 0.64688 | train_auc: 0.66593 | train_balanced_accuracy: 0.60012 | train_accuracy: 0.5986  | valid_auc: 0.65575 | valid_balanced_accuracy: 0.5926  | valid_accuracy: 0.59112 |  0:03:52s
epoch 14 | loss: 0.64246 | train_auc: 0.67255 | train_balanced_accuracy: 0.60885 | train_accuracy: 0.60769 | valid_auc: 0.65926 | valid_balanced_accuracy: 0.60153 | valid_accuracy: 0.60041 |  0:04:08s
epoch 15 | loss: 0.6436  | train_auc: 0.68079 | train_balanced_accuracy: 0.61552 | train_accuracy: 0.61449 | valid_auc: 0.6668  | valid_balanced_accuracy: 0.6074  | valid_accuracy: 0.60639 |  0:04:24s
epoch 16 | loss: 0.63749 | train_auc: 0.68572 | train_balanced_accuracy: 0.62765 | train_accuracy: 0.62693 | valid_auc: 0.67097 | valid_balanced_accuracy: 0.61102 | valid_accuracy: 0.61032 |  0:04:40s
epoch 17 | loss: 0.6327  | train_auc: 0.68966 | train_balanced_accuracy: 0.63469 | train_accuracy: 0.63429 | valid_auc: 0.676   | valid_balanced_accuracy: 0.62342 | valid_accuracy: 0.62307 |  0:04:58s
epoch 18 | loss: 0.63683 | train_auc: 0.69314 | train_balanced_accuracy: 0.64037 | train_accuracy: 0.64023 | valid_auc: 0.67939 | valid_balanced_accuracy: 0.63303 | valid_accuracy: 0.63299 |  0:05:16s
epoch 19 | loss: 0.63395 | train_auc: 0.69551 | train_balanced_accuracy: 0.64423 | train_accuracy: 0.64428 | valid_auc: 0.68068 | valid_balanced_accuracy: 0.64137 | valid_accuracy: 0.64149 |  0:05:31s
epoch 20 | loss: 0.63412 | train_auc: 0.69957 | train_balanced_accuracy: 0.6475  | train_accuracy: 0.64762 | valid_auc: 0.68619 | valid_balanced_accuracy: 0.64302 | valid_accuracy: 0.64322 |  0:05:46s
epoch 21 | loss: 0.63015 | train_auc: 0.70165 | train_balanced_accuracy: 0.64973 | train_accuracy: 0.64987 | valid_auc: 0.68844 | valid_balanced_accuracy: 0.64192 | valid_accuracy: 0.64212 |  0:06:03s
epoch 22 | loss: 0.63215 | train_auc: 0.70313 | train_balanced_accuracy: 0.65321 | train_accuracy: 0.65356 | valid_auc: 0.69101 | valid_balanced_accuracy: 0.64689 | valid_accuracy: 0.64731 |  0:06:19s
epoch 23 | loss: 0.62943 | train_auc: 0.70314 | train_balanced_accuracy: 0.65471 | train_accuracy: 0.65494 | valid_auc: 0.69088 | valid_balanced_accuracy: 0.64907 | valid_accuracy: 0.64935 |  0:06:35s
epoch 24 | loss: 0.63039 | train_auc: 0.70579 | train_balanced_accuracy: 0.65604 | train_accuracy: 0.6564  | valid_auc: 0.69214 | valid_balanced_accuracy: 0.6472  | valid_accuracy: 0.64762 |  0:06:51s
epoch 25 | loss: 0.62637 | train_auc: 0.70734 | train_balanced_accuracy: 0.65846 | train_accuracy: 0.65895 | valid_auc: 0.69376 | valid_balanced_accuracy: 0.64864 | valid_accuracy: 0.6492  |  0:07:07s
epoch 26 | loss: 0.62709 | train_auc: 0.71065 | train_balanced_accuracy: 0.6584  | train_accuracy: 0.65895 | valid_auc: 0.69735 | valid_balanced_accuracy: 0.64858 | valid_accuracy: 0.6492  |  0:07:23s
epoch 27 | loss: 0.62853 | train_auc: 0.71245 | train_balanced_accuracy: 0.66082 | train_accuracy: 0.66136 | valid_auc: 0.6967  | valid_balanced_accuracy: 0.64998 | valid_accuracy: 0.65061 |  0:07:37s
epoch 28 | loss: 0.62535 | train_auc: 0.71455 | train_balanced_accuracy: 0.65793 | train_accuracy: 0.65829 | valid_auc: 0.70232 | valid_balanced_accuracy: 0.65061 | valid_accuracy: 0.65109 |  0:07:53s
epoch 29 | loss: 0.62573 | train_auc: 0.71614 | train_balanced_accuracy: 0.65824 | train_accuracy: 0.6586  | valid_auc: 0.7023  | valid_balanced_accuracy: 0.65047 | valid_accuracy: 0.65093 |  0:08:09s
epoch 30 | loss: 0.62047 | train_auc: 0.71707 | train_balanced_accuracy: 0.65897 | train_accuracy: 0.65943 | valid_auc: 0.70513 | valid_balanced_accuracy: 0.64831 | valid_accuracy: 0.64888 |  0:08:25s
epoch 31 | loss: 0.62362 | train_auc: 0.71882 | train_balanced_accuracy: 0.65863 | train_accuracy: 0.65907 | valid_auc: 0.70281 | valid_balanced_accuracy: 0.64551 | valid_accuracy: 0.64605 |  0:08:42s
epoch 32 | loss: 0.61681 | train_auc: 0.72019 | train_balanced_accuracy: 0.66011 | train_accuracy: 0.66057 | valid_auc: 0.70551 | valid_balanced_accuracy: 0.64395 | valid_accuracy: 0.64448 |  0:08:57s
epoch 33 | loss: 0.62261 | train_auc: 0.72002 | train_balanced_accuracy: 0.65898 | train_accuracy: 0.65935 | valid_auc: 0.7028  | valid_balanced_accuracy: 0.64704 | valid_accuracy: 0.64747 |  0:09:15s
epoch 34 | loss: 0.62052 | train_auc: 0.71869 | train_balanced_accuracy: 0.65722 | train_accuracy: 0.65754 | valid_auc: 0.70116 | valid_balanced_accuracy: 0.64597 | valid_accuracy: 0.64636 |  0:09:33s
epoch 35 | loss: 0.61768 | train_auc: 0.7189  | train_balanced_accuracy: 0.65765 | train_accuracy: 0.65805 | valid_auc: 0.7016  | valid_balanced_accuracy: 0.64541 | valid_accuracy: 0.64589 |  0:09:49s
epoch 36 | loss: 0.61675 | train_auc: 0.72497 | train_balanced_accuracy: 0.66476 | train_accuracy: 0.66509 | valid_auc: 0.70511 | valid_balanced_accuracy: 0.64991 | valid_accuracy: 0.6503  |  0:10:05s
epoch 37 | loss: 0.61593 | train_auc: 0.72397 | train_balanced_accuracy: 0.6634  | train_accuracy: 0.66387 | valid_auc: 0.70285 | valid_balanced_accuracy: 0.64785 | valid_accuracy: 0.64841 |  0:10:20s
epoch 38 | loss: 0.61897 | train_auc: 0.72427 | train_balanced_accuracy: 0.66427 | train_accuracy: 0.66462 | valid_auc: 0.70276 | valid_balanced_accuracy: 0.64567 | valid_accuracy: 0.64605 |  0:10:36s
epoch 39 | loss: 0.61678 | train_auc: 0.72305 | train_balanced_accuracy: 0.66296 | train_accuracy: 0.66336 | valid_auc: 0.70349 | valid_balanced_accuracy: 0.6456  | valid_accuracy: 0.64605 |  0:10:51s
epoch 40 | loss: 0.617   | train_auc: 0.72438 | train_balanced_accuracy: 0.66229 | train_accuracy: 0.66269 | valid_auc: 0.70375 | valid_balanced_accuracy: 0.64655 | valid_accuracy: 0.64699 |  0:11:07s
epoch 41 | loss: 0.62044 | train_auc: 0.71114 | train_balanced_accuracy: 0.65551 | train_accuracy: 0.656   | valid_auc: 0.69214 | valid_balanced_accuracy: 0.64205 | valid_accuracy: 0.64259 |  0:11:24s
epoch 42 | loss: 0.61564 | train_auc: 0.70913 | train_balanced_accuracy: 0.65236 | train_accuracy: 0.65262 | valid_auc: 0.69645 | valid_balanced_accuracy: 0.64164 | valid_accuracy: 0.64196 |  0:11:40s
epoch 43 | loss: 0.61695 | train_auc: 0.70203 | train_balanced_accuracy: 0.64641 | train_accuracy: 0.64648 | valid_auc: 0.69121 | valid_balanced_accuracy: 0.64155 | valid_accuracy: 0.64164 |  0:11:55s
epoch 44 | loss: 0.61824 | train_auc: 0.69783 | train_balanced_accuracy: 0.6428  | train_accuracy: 0.64294 | valid_auc: 0.68832 | valid_balanced_accuracy: 0.6402  | valid_accuracy: 0.64038 |  0:12:12s
epoch 45 | loss: 0.61576 | train_auc: 0.69362 | train_balanced_accuracy: 0.64157 | train_accuracy: 0.64176 | valid_auc: 0.68392 | valid_balanced_accuracy: 0.63573 | valid_accuracy: 0.63598 |  0:12:29s
epoch 46 | loss: 0.6197  | train_auc: 0.70326 | train_balanced_accuracy: 0.65069 | train_accuracy: 0.65109 | valid_auc: 0.69186 | valid_balanced_accuracy: 0.63932 | valid_accuracy: 0.63975 |  0:12:48s
epoch 47 | loss: 0.6122  | train_auc: 0.65331 | train_balanced_accuracy: 0.62061 | train_accuracy: 0.62083 | valid_auc: 0.64798 | valid_balanced_accuracy: 0.6197  | valid_accuracy: 0.61992 |  0:13:05s
epoch 48 | loss: 0.61744 | train_auc: 0.64926 | train_balanced_accuracy: 0.61852 | train_accuracy: 0.61878 | valid_auc: 0.64839 | valid_balanced_accuracy: 0.62059 | valid_accuracy: 0.62087 |  0:13:22s

Early stopping occurred at epoch 48 with best_epoch = 28 and best_valid_accuracy = 0.65109
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 48/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.649 total time=13.5min
[CV 5/5; 48/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83079 | train_auc: 0.51346 | train_balanced_accuracy: 0.52271 | train_accuracy: 0.52034 | valid_auc: 0.51195 | valid_balanced_accuracy: 0.52467 | valid_accuracy: 0.52219 |  0:00:15s
epoch 1  | loss: 0.73845 | train_auc: 0.54157 | train_balanced_accuracy: 0.51783 | train_accuracy: 0.51523 | valid_auc: 0.546   | valid_balanced_accuracy: 0.52049 | valid_accuracy: 0.51778 |  0:00:32s
epoch 2  | loss: 0.7046  | train_auc: 0.55235 | train_balanced_accuracy: 0.51769 | train_accuracy: 0.51487 | valid_auc: 0.55767 | valid_balanced_accuracy: 0.51881 | valid_accuracy: 0.5159  |  0:00:49s
epoch 3  | loss: 0.69339 | train_auc: 0.56468 | train_balanced_accuracy: 0.52395 | train_accuracy: 0.52121 | valid_auc: 0.57069 | valid_balanced_accuracy: 0.52498 | valid_accuracy: 0.52219 |  0:01:04s
epoch 4  | loss: 0.68011 | train_auc: 0.57539 | train_balanced_accuracy: 0.53465 | train_accuracy: 0.53207 | valid_auc: 0.58104 | valid_balanced_accuracy: 0.53805 | valid_accuracy: 0.53541 |  0:01:20s
epoch 5  | loss: 0.67408 | train_auc: 0.588   | train_balanced_accuracy: 0.53554 | train_accuracy: 0.53281 | valid_auc: 0.59099 | valid_balanced_accuracy: 0.53865 | valid_accuracy: 0.53588 |  0:01:37s
epoch 6  | loss: 0.66915 | train_auc: 0.59928 | train_balanced_accuracy: 0.54532 | train_accuracy: 0.54281 | valid_auc: 0.60012 | valid_balanced_accuracy: 0.55197 | valid_accuracy: 0.54942 |  0:01:54s
epoch 7  | loss: 0.66256 | train_auc: 0.60518 | train_balanced_accuracy: 0.54098 | train_accuracy: 0.53824 | valid_auc: 0.60584 | valid_balanced_accuracy: 0.54542 | valid_accuracy: 0.54265 |  0:02:11s
epoch 8  | loss: 0.65872 | train_auc: 0.61941 | train_balanced_accuracy: 0.54874 | train_accuracy: 0.54623 | valid_auc: 0.61846 | valid_balanced_accuracy: 0.55134 | valid_accuracy: 0.54879 |  0:02:27s
epoch 9  | loss: 0.65533 | train_auc: 0.63103 | train_balanced_accuracy: 0.55473 | train_accuracy: 0.55229 | valid_auc: 0.63035 | valid_balanced_accuracy: 0.55678 | valid_accuracy: 0.5543  |  0:02:43s
epoch 10 | loss: 0.65299 | train_auc: 0.64146 | train_balanced_accuracy: 0.56469 | train_accuracy: 0.56248 | valid_auc: 0.64034 | valid_balanced_accuracy: 0.56225 | valid_accuracy: 0.55996 |  0:03:00s
epoch 11 | loss: 0.64983 | train_auc: 0.65307 | train_balanced_accuracy: 0.58171 | train_accuracy: 0.57979 | valid_auc: 0.6495  | valid_balanced_accuracy: 0.57861 | valid_accuracy: 0.57664 |  0:03:16s
epoch 12 | loss: 0.64991 | train_auc: 0.65996 | train_balanced_accuracy: 0.58871 | train_accuracy: 0.58695 | valid_auc: 0.65263 | valid_balanced_accuracy: 0.58365 | valid_accuracy: 0.58184 |  0:03:33s
epoch 13 | loss: 0.64916 | train_auc: 0.66663 | train_balanced_accuracy: 0.59498 | train_accuracy: 0.59329 | valid_auc: 0.65815 | valid_balanced_accuracy: 0.58956 | valid_accuracy: 0.58782 |  0:03:49s
epoch 14 | loss: 0.64214 | train_auc: 0.67299 | train_balanced_accuracy: 0.6072  | train_accuracy: 0.6058  | valid_auc: 0.66432 | valid_balanced_accuracy: 0.59978 | valid_accuracy: 0.59836 |  0:04:05s
epoch 15 | loss: 0.64005 | train_auc: 0.67808 | train_balanced_accuracy: 0.61019 | train_accuracy: 0.60883 | valid_auc: 0.66896 | valid_balanced_accuracy: 0.60606 | valid_accuracy: 0.60466 |  0:04:20s
epoch 16 | loss: 0.64154 | train_auc: 0.68534 | train_balanced_accuracy: 0.62301 | train_accuracy: 0.62197 | valid_auc: 0.67518 | valid_balanced_accuracy: 0.61784 | valid_accuracy: 0.61678 |  0:04:38s
epoch 17 | loss: 0.64098 | train_auc: 0.68687 | train_balanced_accuracy: 0.62431 | train_accuracy: 0.62343 | valid_auc: 0.67498 | valid_balanced_accuracy: 0.61674 | valid_accuracy: 0.61583 |  0:04:54s
epoch 18 | loss: 0.64049 | train_auc: 0.69016 | train_balanced_accuracy: 0.63546 | train_accuracy: 0.63503 | valid_auc: 0.6792  | valid_balanced_accuracy: 0.62921 | valid_accuracy: 0.62874 |  0:05:12s
epoch 19 | loss: 0.63644 | train_auc: 0.69326 | train_balanced_accuracy: 0.64458 | train_accuracy: 0.64428 | valid_auc: 0.68388 | valid_balanced_accuracy: 0.63633 | valid_accuracy: 0.63598 |  0:05:28s
epoch 20 | loss: 0.6338  | train_auc: 0.69689 | train_balanced_accuracy: 0.65102 | train_accuracy: 0.65101 | valid_auc: 0.68678 | valid_balanced_accuracy: 0.64436 | valid_accuracy: 0.64432 |  0:05:45s
epoch 21 | loss: 0.63383 | train_auc: 0.69946 | train_balanced_accuracy: 0.6513  | train_accuracy: 0.65124 | valid_auc: 0.68687 | valid_balanced_accuracy: 0.64265 | valid_accuracy: 0.64259 |  0:06:00s
epoch 22 | loss: 0.6312  | train_auc: 0.70186 | train_balanced_accuracy: 0.65487 | train_accuracy: 0.65502 | valid_auc: 0.68851 | valid_balanced_accuracy: 0.64386 | valid_accuracy: 0.644   |  0:06:17s
epoch 23 | loss: 0.62984 | train_auc: 0.7033  | train_balanced_accuracy: 0.65541 | train_accuracy: 0.65553 | valid_auc: 0.68895 | valid_balanced_accuracy: 0.64406 | valid_accuracy: 0.64416 |  0:06:33s
epoch 24 | loss: 0.63542 | train_auc: 0.70581 | train_balanced_accuracy: 0.65704 | train_accuracy: 0.65726 | valid_auc: 0.69361 | valid_balanced_accuracy: 0.64459 | valid_accuracy: 0.64479 |  0:06:51s
epoch 25 | loss: 0.62817 | train_auc: 0.70796 | train_balanced_accuracy: 0.65816 | train_accuracy: 0.65836 | valid_auc: 0.69685 | valid_balanced_accuracy: 0.64884 | valid_accuracy: 0.64904 |  0:07:09s
epoch 26 | loss: 0.62777 | train_auc: 0.70966 | train_balanced_accuracy: 0.65821 | train_accuracy: 0.65844 | valid_auc: 0.69809 | valid_balanced_accuracy: 0.65054 | valid_accuracy: 0.65077 |  0:07:25s
epoch 27 | loss: 0.62759 | train_auc: 0.71183 | train_balanced_accuracy: 0.65873 | train_accuracy: 0.65899 | valid_auc: 0.69893 | valid_balanced_accuracy: 0.65083 | valid_accuracy: 0.65109 |  0:07:41s
epoch 28 | loss: 0.62886 | train_auc: 0.71388 | train_balanced_accuracy: 0.66023 | train_accuracy: 0.66037 | valid_auc: 0.70073 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65077 |  0:07:59s
epoch 29 | loss: 0.62681 | train_auc: 0.71511 | train_balanced_accuracy: 0.65915 | train_accuracy: 0.65939 | valid_auc: 0.70261 | valid_balanced_accuracy: 0.64738 | valid_accuracy: 0.64762 |  0:08:16s
epoch 30 | loss: 0.62524 | train_auc: 0.71828 | train_balanced_accuracy: 0.66415 | train_accuracy: 0.66442 | valid_auc: 0.70498 | valid_balanced_accuracy: 0.65207 | valid_accuracy: 0.65234 |  0:08:31s
epoch 31 | loss: 0.6244  | train_auc: 0.71848 | train_balanced_accuracy: 0.66056 | train_accuracy: 0.66073 | valid_auc: 0.70519 | valid_balanced_accuracy: 0.65031 | valid_accuracy: 0.65046 |  0:08:46s
epoch 32 | loss: 0.62581 | train_auc: 0.71847 | train_balanced_accuracy: 0.66053 | train_accuracy: 0.66073 | valid_auc: 0.70461 | valid_balanced_accuracy: 0.64664 | valid_accuracy: 0.64684 |  0:09:02s
epoch 33 | loss: 0.62759 | train_auc: 0.71791 | train_balanced_accuracy: 0.65935 | train_accuracy: 0.65955 | valid_auc: 0.70198 | valid_balanced_accuracy: 0.64664 | valid_accuracy: 0.64684 |  0:09:19s
epoch 34 | loss: 0.61897 | train_auc: 0.71769 | train_balanced_accuracy: 0.66016 | train_accuracy: 0.66033 | valid_auc: 0.70194 | valid_balanced_accuracy: 0.64617 | valid_accuracy: 0.64636 |  0:09:35s
epoch 35 | loss: 0.62248 | train_auc: 0.71265 | train_balanced_accuracy: 0.65799 | train_accuracy: 0.65817 | valid_auc: 0.70445 | valid_balanced_accuracy: 0.64871 | valid_accuracy: 0.64888 |  0:09:52s
epoch 36 | loss: 0.61676 | train_auc: 0.71214 | train_balanced_accuracy: 0.65736 | train_accuracy: 0.6575  | valid_auc: 0.7042  | valid_balanced_accuracy: 0.64749 | valid_accuracy: 0.64762 |  0:10:07s
epoch 37 | loss: 0.62071 | train_auc: 0.7115  | train_balanced_accuracy: 0.65576 | train_accuracy: 0.65593 | valid_auc: 0.70566 | valid_balanced_accuracy: 0.64783 | valid_accuracy: 0.64794 |  0:10:23s
epoch 38 | loss: 0.61875 | train_auc: 0.70491 | train_balanced_accuracy: 0.65099 | train_accuracy: 0.65109 | valid_auc: 0.70327 | valid_balanced_accuracy: 0.65004 | valid_accuracy: 0.65014 |  0:10:40s
epoch 39 | loss: 0.62147 | train_auc: 0.70864 | train_balanced_accuracy: 0.65407 | train_accuracy: 0.65423 | valid_auc: 0.70435 | valid_balanced_accuracy: 0.64775 | valid_accuracy: 0.64794 |  0:10:57s
epoch 40 | loss: 0.61732 | train_auc: 0.71887 | train_balanced_accuracy: 0.66118 | train_accuracy: 0.66136 | valid_auc: 0.70686 | valid_balanced_accuracy: 0.64807 | valid_accuracy: 0.64825 |  0:11:15s
epoch 41 | loss: 0.61788 | train_auc: 0.71724 | train_balanced_accuracy: 0.65871 | train_accuracy: 0.65895 | valid_auc: 0.70647 | valid_balanced_accuracy: 0.64862 | valid_accuracy: 0.64888 |  0:11:32s
epoch 42 | loss: 0.61779 | train_auc: 0.71531 | train_balanced_accuracy: 0.6588  | train_accuracy: 0.65899 | valid_auc: 0.70743 | valid_balanced_accuracy: 0.65009 | valid_accuracy: 0.6503  |  0:11:48s
epoch 43 | loss: 0.61442 | train_auc: 0.72683 | train_balanced_accuracy: 0.66586 | train_accuracy: 0.66596 | valid_auc: 0.71029 | valid_balanced_accuracy: 0.6505  | valid_accuracy: 0.65061 |  0:12:05s
epoch 44 | loss: 0.61542 | train_auc: 0.72952 | train_balanced_accuracy: 0.67005 | train_accuracy: 0.67029 | valid_auc: 0.71424 | valid_balanced_accuracy: 0.65541 | valid_accuracy: 0.65565 |  0:12:24s
epoch 45 | loss: 0.61424 | train_auc: 0.70879 | train_balanced_accuracy: 0.65463 | train_accuracy: 0.65502 | valid_auc: 0.70179 | valid_balanced_accuracy: 0.64392 | valid_accuracy: 0.64432 |  0:12:40s
epoch 46 | loss: 0.61638 | train_auc: 0.70549 | train_balanced_accuracy: 0.64983 | train_accuracy: 0.65014 | valid_auc: 0.70034 | valid_balanced_accuracy: 0.64368 | valid_accuracy: 0.644   |  0:12:56s
epoch 47 | loss: 0.61745 | train_auc: 0.73182 | train_balanced_accuracy: 0.67267 | train_accuracy: 0.67288 | valid_auc: 0.71314 | valid_balanced_accuracy: 0.654   | valid_accuracy: 0.65423 |  0:13:14s
epoch 48 | loss: 0.61376 | train_auc: 0.73133 | train_balanced_accuracy: 0.66967 | train_accuracy: 0.67005 | valid_auc: 0.71368 | valid_balanced_accuracy: 0.65367 | valid_accuracy: 0.65408 |  0:13:31s
epoch 49 | loss: 0.61358 | train_auc: 0.73167 | train_balanced_accuracy: 0.6722  | train_accuracy: 0.67249 | valid_auc: 0.71639 | valid_balanced_accuracy: 0.6585  | valid_accuracy: 0.6588  |  0:13:46s
epoch 50 | loss: 0.61015 | train_auc: 0.72931 | train_balanced_accuracy: 0.66778 | train_accuracy: 0.66793 | valid_auc: 0.71346 | valid_balanced_accuracy: 0.65265 | valid_accuracy: 0.65282 |  0:14:03s
epoch 51 | loss: 0.61235 | train_auc: 0.72412 | train_balanced_accuracy: 0.66517 | train_accuracy: 0.66545 | valid_auc: 0.70745 | valid_balanced_accuracy: 0.64765 | valid_accuracy: 0.64794 |  0:14:20s
epoch 52 | loss: 0.61381 | train_auc: 0.72421 | train_balanced_accuracy: 0.66495 | train_accuracy: 0.66521 | valid_auc: 0.70996 | valid_balanced_accuracy: 0.65318 | valid_accuracy: 0.65345 |  0:14:35s
epoch 53 | loss: 0.61603 | train_auc: 0.72576 | train_balanced_accuracy: 0.66715 | train_accuracy: 0.66741 | valid_auc: 0.71127 | valid_balanced_accuracy: 0.65397 | valid_accuracy: 0.65423 |  0:14:53s
epoch 54 | loss: 0.61608 | train_auc: 0.713   | train_balanced_accuracy: 0.65673 | train_accuracy: 0.65691 | valid_auc: 0.70682 | valid_balanced_accuracy: 0.64557 | valid_accuracy: 0.64573 |  0:15:10s
epoch 55 | loss: 0.61457 | train_auc: 0.71946 | train_balanced_accuracy: 0.66189 | train_accuracy: 0.66218 | valid_auc: 0.70876 | valid_balanced_accuracy: 0.6489  | valid_accuracy: 0.6492  |  0:15:28s
epoch 56 | loss: 0.61482 | train_auc: 0.73353 | train_balanced_accuracy: 0.67217 | train_accuracy: 0.67249 | valid_auc: 0.71674 | valid_balanced_accuracy: 0.6577  | valid_accuracy: 0.65801 |  0:15:45s
epoch 57 | loss: 0.61109 | train_auc: 0.73137 | train_balanced_accuracy: 0.67161 | train_accuracy: 0.67186 | valid_auc: 0.71641 | valid_balanced_accuracy: 0.65697 | valid_accuracy: 0.65722 |  0:16:03s
epoch 58 | loss: 0.60944 | train_auc: 0.73525 | train_balanced_accuracy: 0.67374 | train_accuracy: 0.67402 | valid_auc: 0.7177  | valid_balanced_accuracy: 0.65488 | valid_accuracy: 0.65518 |  0:16:19s
epoch 59 | loss: 0.61542 | train_auc: 0.73541 | train_balanced_accuracy: 0.67426 | train_accuracy: 0.67458 | valid_auc: 0.7203  | valid_balanced_accuracy: 0.65846 | valid_accuracy: 0.6588  |  0:16:37s
epoch 60 | loss: 0.6159  | train_auc: 0.72664 | train_balanced_accuracy: 0.66872 | train_accuracy: 0.66918 | valid_auc: 0.71521 | valid_balanced_accuracy: 0.65704 | valid_accuracy: 0.65754 |  0:16:53s
epoch 61 | loss: 0.61683 | train_auc: 0.7299  | train_balanced_accuracy: 0.66922 | train_accuracy: 0.66954 | valid_auc: 0.71916 | valid_balanced_accuracy: 0.65641 | valid_accuracy: 0.65675 |  0:17:10s
epoch 62 | loss: 0.60767 | train_auc: 0.73356 | train_balanced_accuracy: 0.67132 | train_accuracy: 0.67174 | valid_auc: 0.71981 | valid_balanced_accuracy: 0.65582 | valid_accuracy: 0.65628 |  0:17:28s
epoch 63 | loss: 0.60912 | train_auc: 0.7377  | train_balanced_accuracy: 0.67693 | train_accuracy: 0.67733 | valid_auc: 0.72352 | valid_balanced_accuracy: 0.65964 | valid_accuracy: 0.66006 |  0:17:44s
epoch 64 | loss: 0.60787 | train_auc: 0.73774 | train_balanced_accuracy: 0.67735 | train_accuracy: 0.67768 | valid_auc: 0.72296 | valid_balanced_accuracy: 0.66111 | valid_accuracy: 0.66147 |  0:18:01s
epoch 65 | loss: 0.61521 | train_auc: 0.73069 | train_balanced_accuracy: 0.67034 | train_accuracy: 0.6706  | valid_auc: 0.71378 | valid_balanced_accuracy: 0.654   | valid_accuracy: 0.65423 |  0:18:18s
epoch 66 | loss: 0.6082  | train_auc: 0.73511 | train_balanced_accuracy: 0.67423 | train_accuracy: 0.67454 | valid_auc: 0.71775 | valid_balanced_accuracy: 0.65645 | valid_accuracy: 0.65675 |  0:18:36s
epoch 67 | loss: 0.61131 | train_auc: 0.72281 | train_balanced_accuracy: 0.66347 | train_accuracy: 0.66387 | valid_auc: 0.71069 | valid_balanced_accuracy: 0.65239 | valid_accuracy: 0.65282 |  0:18:52s
epoch 68 | loss: 0.60956 | train_auc: 0.70735 | train_balanced_accuracy: 0.64809 | train_accuracy: 0.64849 | valid_auc: 0.70485 | valid_balanced_accuracy: 0.64401 | valid_accuracy: 0.64448 |  0:19:09s
epoch 69 | loss: 0.61108 | train_auc: 0.70041 | train_balanced_accuracy: 0.64647 | train_accuracy: 0.64684 | valid_auc: 0.70228 | valid_balanced_accuracy: 0.64863 | valid_accuracy: 0.64904 |  0:19:24s
epoch 70 | loss: 0.60829 | train_auc: 0.72612 | train_balanced_accuracy: 0.6657  | train_accuracy: 0.66604 | valid_auc: 0.71107 | valid_balanced_accuracy: 0.65342 | valid_accuracy: 0.65376 |  0:19:40s
epoch 71 | loss: 0.60825 | train_auc: 0.73899 | train_balanced_accuracy: 0.67818 | train_accuracy: 0.67859 | valid_auc: 0.72174 | valid_balanced_accuracy: 0.65762 | valid_accuracy: 0.65801 |  0:19:55s
epoch 72 | loss: 0.60611 | train_auc: 0.73794 | train_balanced_accuracy: 0.67628 | train_accuracy: 0.67658 | valid_auc: 0.7215  | valid_balanced_accuracy: 0.65725 | valid_accuracy: 0.65754 |  0:20:10s
epoch 73 | loss: 0.60587 | train_auc: 0.70698 | train_balanced_accuracy: 0.65284 | train_accuracy: 0.65321 | valid_auc: 0.70679 | valid_balanced_accuracy: 0.65134 | valid_accuracy: 0.65172 |  0:20:28s
epoch 74 | loss: 0.60666 | train_auc: 0.70299 | train_balanced_accuracy: 0.65088 | train_accuracy: 0.65124 | valid_auc: 0.7041  | valid_balanced_accuracy: 0.65167 | valid_accuracy: 0.65203 |  0:20:42s
epoch 75 | loss: 0.60384 | train_auc: 0.70889 | train_balanced_accuracy: 0.65345 | train_accuracy: 0.65368 | valid_auc: 0.708   | valid_balanced_accuracy: 0.64928 | valid_accuracy: 0.64951 |  0:21:00s
epoch 76 | loss: 0.60655 | train_auc: 0.73548 | train_balanced_accuracy: 0.67307 | train_accuracy: 0.67347 | valid_auc: 0.71945 | valid_balanced_accuracy: 0.65479 | valid_accuracy: 0.65518 |  0:21:17s
epoch 77 | loss: 0.60558 | train_auc: 0.73547 | train_balanced_accuracy: 0.67184 | train_accuracy: 0.67221 | valid_auc: 0.72001 | valid_balanced_accuracy: 0.65591 | valid_accuracy: 0.65628 |  0:21:33s
epoch 78 | loss: 0.60295 | train_auc: 0.73948 | train_balanced_accuracy: 0.67643 | train_accuracy: 0.67686 | valid_auc: 0.7226  | valid_balanced_accuracy: 0.65664 | valid_accuracy: 0.65707 |  0:21:48s
epoch 79 | loss: 0.6066  | train_auc: 0.73804 | train_balanced_accuracy: 0.67308 | train_accuracy: 0.67339 | valid_auc: 0.72004 | valid_balanced_accuracy: 0.65222 | valid_accuracy: 0.6525  |  0:22:06s
epoch 80 | loss: 0.60809 | train_auc: 0.73814 | train_balanced_accuracy: 0.67355 | train_accuracy: 0.67402 | valid_auc: 0.72153 | valid_balanced_accuracy: 0.65427 | valid_accuracy: 0.65471 |  0:22:23s
epoch 81 | loss: 0.60229 | train_auc: 0.74348 | train_balanced_accuracy: 0.67899 | train_accuracy: 0.67926 | valid_auc: 0.72472 | valid_balanced_accuracy: 0.66155 | valid_accuracy: 0.66179 |  0:22:41s
epoch 82 | loss: 0.60362 | train_auc: 0.74042 | train_balanced_accuracy: 0.67804 | train_accuracy: 0.67827 | valid_auc: 0.72546 | valid_balanced_accuracy: 0.66233 | valid_accuracy: 0.66257 |  0:22:56s
epoch 83 | loss: 0.60283 | train_auc: 0.73057 | train_balanced_accuracy: 0.67015 | train_accuracy: 0.67044 | valid_auc: 0.72324 | valid_balanced_accuracy: 0.65931 | valid_accuracy: 0.65958 |  0:23:11s
epoch 84 | loss: 0.6036  | train_auc: 0.73053 | train_balanced_accuracy: 0.66905 | train_accuracy: 0.66942 | valid_auc: 0.7223  | valid_balanced_accuracy: 0.6584  | valid_accuracy: 0.6588  |  0:23:26s
epoch 85 | loss: 0.60622 | train_auc: 0.73845 | train_balanced_accuracy: 0.67406 | train_accuracy: 0.67442 | valid_auc: 0.72644 | valid_balanced_accuracy: 0.66536 | valid_accuracy: 0.66572 |  0:23:42s
epoch 86 | loss: 0.6031  | train_auc: 0.74405 | train_balanced_accuracy: 0.67877 | train_accuracy: 0.6793  | valid_auc: 0.72762 | valid_balanced_accuracy: 0.66474 | valid_accuracy: 0.66525 |  0:23:58s
epoch 87 | loss: 0.60286 | train_auc: 0.74069 | train_balanced_accuracy: 0.6781  | train_accuracy: 0.67847 | valid_auc: 0.72464 | valid_balanced_accuracy: 0.66332 | valid_accuracy: 0.66368 |  0:24:14s
epoch 88 | loss: 0.60527 | train_auc: 0.74349 | train_balanced_accuracy: 0.6804  | train_accuracy: 0.68071 | valid_auc: 0.72777 | valid_balanced_accuracy: 0.66463 | valid_accuracy: 0.66494 |  0:24:31s
epoch 89 | loss: 0.60223 | train_auc: 0.74245 | train_balanced_accuracy: 0.6777  | train_accuracy: 0.67804 | valid_auc: 0.7258  | valid_balanced_accuracy: 0.66019 | valid_accuracy: 0.66053 |  0:24:47s
epoch 90 | loss: 0.59907 | train_auc: 0.74252 | train_balanced_accuracy: 0.67958 | train_accuracy: 0.67981 | valid_auc: 0.72435 | valid_balanced_accuracy: 0.66175 | valid_accuracy: 0.66195 |  0:25:04s
epoch 91 | loss: 0.60304 | train_auc: 0.7286  | train_balanced_accuracy: 0.66691 | train_accuracy: 0.66714 | valid_auc: 0.71513 | valid_balanced_accuracy: 0.6532  | valid_accuracy: 0.65345 |  0:25:19s
epoch 92 | loss: 0.60097 | train_auc: 0.72833 | train_balanced_accuracy: 0.66867 | train_accuracy: 0.66887 | valid_auc: 0.71417 | valid_balanced_accuracy: 0.65323 | valid_accuracy: 0.65345 |  0:25:35s
epoch 93 | loss: 0.60208 | train_auc: 0.73529 | train_balanced_accuracy: 0.67274 | train_accuracy: 0.67296 | valid_auc: 0.71786 | valid_balanced_accuracy: 0.65199 | valid_accuracy: 0.65219 |  0:25:51s
epoch 94 | loss: 0.60567 | train_auc: 0.72468 | train_balanced_accuracy: 0.66299 | train_accuracy: 0.66332 | valid_auc: 0.71153 | valid_balanced_accuracy: 0.65197 | valid_accuracy: 0.65234 |  0:26:09s
epoch 95 | loss: 0.59654 | train_auc: 0.72187 | train_balanced_accuracy: 0.66017 | train_accuracy: 0.66041 | valid_auc: 0.71211 | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65518 |  0:26:25s
epoch 96 | loss: 0.59856 | train_auc: 0.74518 | train_balanced_accuracy: 0.68256 | train_accuracy: 0.6828  | valid_auc: 0.72509 | valid_balanced_accuracy: 0.65826 | valid_accuracy: 0.65848 |  0:26:41s
epoch 97 | loss: 0.60278 | train_auc: 0.73642 | train_balanced_accuracy: 0.67543 | train_accuracy: 0.67591 | valid_auc: 0.72494 | valid_balanced_accuracy: 0.66494 | valid_accuracy: 0.66541 |  0:26:57s
epoch 98 | loss: 0.60416 | train_auc: 0.73408 | train_balanced_accuracy: 0.67278 | train_accuracy: 0.67324 | valid_auc: 0.72566 | valid_balanced_accuracy: 0.66763 | valid_accuracy: 0.66808 |  0:27:14s
epoch 99 | loss: 0.60318 | train_auc: 0.73919 | train_balanced_accuracy: 0.67634 | train_accuracy: 0.67682 | valid_auc: 0.72729 | valid_balanced_accuracy: 0.66479 | valid_accuracy: 0.66525 |  0:27:32s
epoch 100| loss: 0.59833 | train_auc: 0.74054 | train_balanced_accuracy: 0.67725 | train_accuracy: 0.67764 | valid_auc: 0.72771 | valid_balanced_accuracy: 0.66235 | valid_accuracy: 0.66273 |  0:27:48s
epoch 101| loss: 0.60388 | train_auc: 0.74015 | train_balanced_accuracy: 0.67706 | train_accuracy: 0.67745 | valid_auc: 0.72777 | valid_balanced_accuracy: 0.66642 | valid_accuracy: 0.66682 |  0:28:03s
epoch 102| loss: 0.60207 | train_auc: 0.74572 | train_balanced_accuracy: 0.68151 | train_accuracy: 0.68189 | valid_auc: 0.72883 | valid_balanced_accuracy: 0.66267 | valid_accuracy: 0.66305 |  0:28:19s
epoch 103| loss: 0.59777 | train_auc: 0.7421  | train_balanced_accuracy: 0.6786  | train_accuracy: 0.67898 | valid_auc: 0.72214 | valid_balanced_accuracy: 0.65717 | valid_accuracy: 0.65754 |  0:28:37s
epoch 104| loss: 0.59966 | train_auc: 0.71399 | train_balanced_accuracy: 0.65196 | train_accuracy: 0.65227 | valid_auc: 0.7047  | valid_balanced_accuracy: 0.64244 | valid_accuracy: 0.64274 |  0:28:52s
epoch 105| loss: 0.60267 | train_auc: 0.74424 | train_balanced_accuracy: 0.6826  | train_accuracy: 0.68296 | valid_auc: 0.72412 | valid_balanced_accuracy: 0.65674 | valid_accuracy: 0.65707 |  0:29:09s
epoch 106| loss: 0.5967  | train_auc: 0.75082 | train_balanced_accuracy: 0.68656 | train_accuracy: 0.68689 | valid_auc: 0.73124 | valid_balanced_accuracy: 0.66747 | valid_accuracy: 0.66777 |  0:29:27s
epoch 107| loss: 0.60109 | train_auc: 0.75074 | train_balanced_accuracy: 0.68631 | train_accuracy: 0.68669 | valid_auc: 0.73094 | valid_balanced_accuracy: 0.66693 | valid_accuracy: 0.6673  |  0:29:43s
epoch 108| loss: 0.60279 | train_auc: 0.75108 | train_balanced_accuracy: 0.68602 | train_accuracy: 0.68622 | valid_auc: 0.72979 | valid_balanced_accuracy: 0.66728 | valid_accuracy: 0.66745 |  0:30:01s
epoch 109| loss: 0.59866 | train_auc: 0.75108 | train_balanced_accuracy: 0.68491 | train_accuracy: 0.68508 | valid_auc: 0.73119 | valid_balanced_accuracy: 0.66588 | valid_accuracy: 0.66604 |  0:30:18s
epoch 110| loss: 0.60104 | train_auc: 0.73583 | train_balanced_accuracy: 0.67253 | train_accuracy: 0.67273 | valid_auc: 0.71848 | valid_balanced_accuracy: 0.66178 | valid_accuracy: 0.66195 |  0:30:35s
epoch 111| loss: 0.59378 | train_auc: 0.74256 | train_balanced_accuracy: 0.67903 | train_accuracy: 0.67926 | valid_auc: 0.72277 | valid_balanced_accuracy: 0.66257 | valid_accuracy: 0.66273 |  0:30:49s
epoch 112| loss: 0.59642 | train_auc: 0.74581 | train_balanced_accuracy: 0.68205 | train_accuracy: 0.68225 | valid_auc: 0.72585 | valid_balanced_accuracy: 0.66164 | valid_accuracy: 0.66179 |  0:31:07s
epoch 113| loss: 0.60425 | train_auc: 0.75182 | train_balanced_accuracy: 0.68731 | train_accuracy: 0.68752 | valid_auc: 0.73154 | valid_balanced_accuracy: 0.6668  | valid_accuracy: 0.66698 |  0:31:22s
epoch 114| loss: 0.59773 | train_auc: 0.73941 | train_balanced_accuracy: 0.67845 | train_accuracy: 0.67875 | valid_auc: 0.72637 | valid_balanced_accuracy: 0.66227 | valid_accuracy: 0.66257 |  0:31:40s
epoch 115| loss: 0.59797 | train_auc: 0.73698 | train_balanced_accuracy: 0.67614 | train_accuracy: 0.67654 | valid_auc: 0.72754 | valid_balanced_accuracy: 0.66628 | valid_accuracy: 0.66667 |  0:31:56s
epoch 116| loss: 0.59874 | train_auc: 0.73901 | train_balanced_accuracy: 0.67638 | train_accuracy: 0.67682 | valid_auc: 0.72643 | valid_balanced_accuracy: 0.66639 | valid_accuracy: 0.66682 |  0:32:13s
epoch 117| loss: 0.5967  | train_auc: 0.73599 | train_balanced_accuracy: 0.67594 | train_accuracy: 0.67638 | valid_auc: 0.72631 | valid_balanced_accuracy: 0.66279 | valid_accuracy: 0.6632  |  0:32:29s
epoch 118| loss: 0.59832 | train_auc: 0.74107 | train_balanced_accuracy: 0.6811  | train_accuracy: 0.68142 | valid_auc: 0.72741 | valid_balanced_accuracy: 0.66648 | valid_accuracy: 0.66682 |  0:32:46s

Early stopping occurred at epoch 118 with best_epoch = 98 and best_valid_accuracy = 0.66808
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 48/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.664 total time=32.9min
[CV 1/5; 49/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70373 | train_auc: 0.60103 | train_balanced_accuracy: 0.57573 | train_accuracy: 0.57525 | valid_auc: 0.60786 | valid_balanced_accuracy: 0.58218 | valid_accuracy: 0.58168 |  0:00:18s
epoch 1  | loss: 0.6539  | train_auc: 0.62533 | train_balanced_accuracy: 0.58622 | train_accuracy: 0.58698 | valid_auc: 0.61104 | valid_balanced_accuracy: 0.57807 | valid_accuracy: 0.57885 |  0:00:34s
epoch 2  | loss: 0.63612 | train_auc: 0.62787 | train_balanced_accuracy: 0.57959 | train_accuracy: 0.58131 | valid_auc: 0.61456 | valid_balanced_accuracy: 0.57017 | valid_accuracy: 0.57192 |  0:00:51s
epoch 3  | loss: 0.62381 | train_auc: 0.64695 | train_balanced_accuracy: 0.60555 | train_accuracy: 0.60661 | valid_auc: 0.63568 | valid_balanced_accuracy: 0.60046 | valid_accuracy: 0.60151 |  0:01:08s
epoch 4  | loss: 0.61425 | train_auc: 0.67668 | train_balanced_accuracy: 0.59997 | train_accuracy: 0.60169 | valid_auc: 0.66612 | valid_balanced_accuracy: 0.59875 | valid_accuracy: 0.60057 |  0:01:26s
epoch 5  | loss: 0.61348 | train_auc: 0.69552 | train_balanced_accuracy: 0.63666 | train_accuracy: 0.63797 | valid_auc: 0.68944 | valid_balanced_accuracy: 0.63588 | valid_accuracy: 0.63724 |  0:01:43s
epoch 6  | loss: 0.61296 | train_auc: 0.70276 | train_balanced_accuracy: 0.64448 | train_accuracy: 0.64548 | valid_auc: 0.69255 | valid_balanced_accuracy: 0.6405  | valid_accuracy: 0.64149 |  0:02:00s
epoch 7  | loss: 0.60838 | train_auc: 0.70631 | train_balanced_accuracy: 0.64468 | train_accuracy: 0.64537 | valid_auc: 0.70186 | valid_balanced_accuracy: 0.64265 | valid_accuracy: 0.64337 |  0:02:18s
epoch 8  | loss: 0.59789 | train_auc: 0.70995 | train_balanced_accuracy: 0.65057 | train_accuracy: 0.65147 | valid_auc: 0.69953 | valid_balanced_accuracy: 0.64171 | valid_accuracy: 0.64259 |  0:02:33s
epoch 9  | loss: 0.60338 | train_auc: 0.71612 | train_balanced_accuracy: 0.65582 | train_accuracy: 0.65662 | valid_auc: 0.71103 | valid_balanced_accuracy: 0.65058 | valid_accuracy: 0.6514  |  0:02:50s
epoch 10 | loss: 0.59305 | train_auc: 0.71507 | train_balanced_accuracy: 0.65083 | train_accuracy: 0.65127 | valid_auc: 0.70919 | valid_balanced_accuracy: 0.6483  | valid_accuracy: 0.64873 |  0:03:05s
epoch 11 | loss: 0.59623 | train_auc: 0.7194  | train_balanced_accuracy: 0.65512 | train_accuracy: 0.65568 | valid_auc: 0.71026 | valid_balanced_accuracy: 0.64751 | valid_accuracy: 0.6481  |  0:03:22s
epoch 12 | loss: 0.5982  | train_auc: 0.72339 | train_balanced_accuracy: 0.66536 | train_accuracy: 0.66602 | valid_auc: 0.71146 | valid_balanced_accuracy: 0.65292 | valid_accuracy: 0.6536  |  0:03:38s
epoch 13 | loss: 0.5978  | train_auc: 0.72713 | train_balanced_accuracy: 0.66056 | train_accuracy: 0.66166 | valid_auc: 0.71756 | valid_balanced_accuracy: 0.65152 | valid_accuracy: 0.65266 |  0:03:55s
epoch 14 | loss: 0.59502 | train_auc: 0.72838 | train_balanced_accuracy: 0.66704 | train_accuracy: 0.66772 | valid_auc: 0.71732 | valid_balanced_accuracy: 0.65971 | valid_accuracy: 0.66037 |  0:04:12s
epoch 15 | loss: 0.59186 | train_auc: 0.73245 | train_balanced_accuracy: 0.66777 | train_accuracy: 0.66764 | valid_auc: 0.72134 | valid_balanced_accuracy: 0.65706 | valid_accuracy: 0.65691 |  0:04:27s
epoch 16 | loss: 0.58667 | train_auc: 0.72919 | train_balanced_accuracy: 0.66019 | train_accuracy: 0.6604  | valid_auc: 0.7178  | valid_balanced_accuracy: 0.65768 | valid_accuracy: 0.65785 |  0:04:44s
epoch 17 | loss: 0.58882 | train_auc: 0.73112 | train_balanced_accuracy: 0.66642 | train_accuracy: 0.6665  | valid_auc: 0.7195  | valid_balanced_accuracy: 0.65608 | valid_accuracy: 0.65612 |  0:05:00s
epoch 18 | loss: 0.58861 | train_auc: 0.73442 | train_balanced_accuracy: 0.67153 | train_accuracy: 0.6722  | valid_auc: 0.72118 | valid_balanced_accuracy: 0.657   | valid_accuracy: 0.6577  |  0:05:17s
epoch 19 | loss: 0.59101 | train_auc: 0.73735 | train_balanced_accuracy: 0.67313 | train_accuracy: 0.67358 | valid_auc: 0.72441 | valid_balanced_accuracy: 0.66011 | valid_accuracy: 0.66053 |  0:05:35s
epoch 20 | loss: 0.59071 | train_auc: 0.73884 | train_balanced_accuracy: 0.67495 | train_accuracy: 0.67574 | valid_auc: 0.72647 | valid_balanced_accuracy: 0.66208 | valid_accuracy: 0.66289 |  0:05:51s
epoch 21 | loss: 0.58697 | train_auc: 0.74426 | train_balanced_accuracy: 0.67571 | train_accuracy: 0.67653 | valid_auc: 0.72965 | valid_balanced_accuracy: 0.66033 | valid_accuracy: 0.66116 |  0:06:08s
epoch 22 | loss: 0.59035 | train_auc: 0.74126 | train_balanced_accuracy: 0.67838 | train_accuracy: 0.67865 | valid_auc: 0.72856 | valid_balanced_accuracy: 0.66688 | valid_accuracy: 0.66714 |  0:06:25s
epoch 23 | loss: 0.58358 | train_auc: 0.75366 | train_balanced_accuracy: 0.68483 | train_accuracy: 0.68534 | valid_auc: 0.73943 | valid_balanced_accuracy: 0.67232 | valid_accuracy: 0.6728  |  0:06:41s
epoch 24 | loss: 0.58974 | train_auc: 0.75232 | train_balanced_accuracy: 0.68181 | train_accuracy: 0.68243 | valid_auc: 0.73409 | valid_balanced_accuracy: 0.66513 | valid_accuracy: 0.66572 |  0:06:57s
epoch 25 | loss: 0.58095 | train_auc: 0.76561 | train_balanced_accuracy: 0.69867 | train_accuracy: 0.69868 | valid_auc: 0.74856 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68461 |  0:07:14s
epoch 26 | loss: 0.5836  | train_auc: 0.74886 | train_balanced_accuracy: 0.68152 | train_accuracy: 0.68212 | valid_auc: 0.73077 | valid_balanced_accuracy: 0.66687 | valid_accuracy: 0.66745 |  0:07:30s
epoch 27 | loss: 0.58195 | train_auc: 0.76116 | train_balanced_accuracy: 0.69183 | train_accuracy: 0.69231 | valid_auc: 0.74007 | valid_balanced_accuracy: 0.67231 | valid_accuracy: 0.6728  |  0:07:47s
epoch 28 | loss: 0.57962 | train_auc: 0.75913 | train_balanced_accuracy: 0.69192 | train_accuracy: 0.69231 | valid_auc: 0.73775 | valid_balanced_accuracy: 0.67039 | valid_accuracy: 0.67076 |  0:08:03s
epoch 29 | loss: 0.57559 | train_auc: 0.76522 | train_balanced_accuracy: 0.69572 | train_accuracy: 0.69597 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.68048 | valid_accuracy: 0.68067 |  0:08:18s
epoch 30 | loss: 0.58072 | train_auc: 0.76072 | train_balanced_accuracy: 0.68999 | train_accuracy: 0.69038 | valid_auc: 0.74083 | valid_balanced_accuracy: 0.67295 | valid_accuracy: 0.67328 |  0:08:37s
epoch 31 | loss: 0.57676 | train_auc: 0.77223 | train_balanced_accuracy: 0.70179 | train_accuracy: 0.70187 | valid_auc: 0.75379 | valid_balanced_accuracy: 0.6869  | valid_accuracy: 0.68697 |  0:08:52s
epoch 32 | loss: 0.57889 | train_auc: 0.77018 | train_balanced_accuracy: 0.69976 | train_accuracy: 0.70018 | valid_auc: 0.74852 | valid_balanced_accuracy: 0.6831  | valid_accuracy: 0.68351 |  0:09:09s
epoch 33 | loss: 0.5772  | train_auc: 0.77171 | train_balanced_accuracy: 0.69873 | train_accuracy: 0.69915 | valid_auc: 0.74883 | valid_balanced_accuracy: 0.68153 | valid_accuracy: 0.68193 |  0:09:26s
epoch 34 | loss: 0.57221 | train_auc: 0.77468 | train_balanced_accuracy: 0.7046  | train_accuracy: 0.70474 | valid_auc: 0.75176 | valid_balanced_accuracy: 0.68388 | valid_accuracy: 0.68398 |  0:09:41s
epoch 35 | loss: 0.57483 | train_auc: 0.76955 | train_balanced_accuracy: 0.69585 | train_accuracy: 0.69636 | valid_auc: 0.74944 | valid_balanced_accuracy: 0.68004 | valid_accuracy: 0.68052 |  0:09:58s
epoch 36 | loss: 0.57745 | train_auc: 0.77147 | train_balanced_accuracy: 0.70063 | train_accuracy: 0.70092 | valid_auc: 0.74514 | valid_balanced_accuracy: 0.67943 | valid_accuracy: 0.67973 |  0:10:14s
epoch 37 | loss: 0.57147 | train_auc: 0.77466 | train_balanced_accuracy: 0.70157 | train_accuracy: 0.70207 | valid_auc: 0.7535  | valid_balanced_accuracy: 0.68192 | valid_accuracy: 0.6824  |  0:10:31s
epoch 38 | loss: 0.56952 | train_auc: 0.7726  | train_balanced_accuracy: 0.69921 | train_accuracy: 0.69904 | valid_auc: 0.74758 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68351 |  0:10:47s
epoch 39 | loss: 0.57565 | train_auc: 0.76756 | train_balanced_accuracy: 0.69553 | train_accuracy: 0.69577 | valid_auc: 0.7449  | valid_balanced_accuracy: 0.67999 | valid_accuracy: 0.6802  |  0:11:04s
epoch 40 | loss: 0.57531 | train_auc: 0.77366 | train_balanced_accuracy: 0.702   | train_accuracy: 0.7023  | valid_auc: 0.75005 | valid_balanced_accuracy: 0.68682 | valid_accuracy: 0.68713 |  0:11:23s
epoch 41 | loss: 0.57478 | train_auc: 0.7553  | train_balanced_accuracy: 0.68738 | train_accuracy: 0.68704 | valid_auc: 0.73518 | valid_balanced_accuracy: 0.67157 | valid_accuracy: 0.67123 |  0:11:38s
epoch 42 | loss: 0.57169 | train_auc: 0.77554 | train_balanced_accuracy: 0.6998  | train_accuracy: 0.70022 | valid_auc: 0.75439 | valid_balanced_accuracy: 0.68734 | valid_accuracy: 0.68776 |  0:11:53s
epoch 43 | loss: 0.57492 | train_auc: 0.77716 | train_balanced_accuracy: 0.70397 | train_accuracy: 0.70415 | valid_auc: 0.75471 | valid_balanced_accuracy: 0.69157 | valid_accuracy: 0.69169 |  0:12:09s
epoch 44 | loss: 0.57173 | train_auc: 0.77991 | train_balanced_accuracy: 0.70513 | train_accuracy: 0.70541 | valid_auc: 0.75565 | valid_balanced_accuracy: 0.68687 | valid_accuracy: 0.68713 |  0:12:24s
epoch 45 | loss: 0.566   | train_auc: 0.78123 | train_balanced_accuracy: 0.70712 | train_accuracy: 0.70761 | valid_auc: 0.75899 | valid_balanced_accuracy: 0.69107 | valid_accuracy: 0.69153 |  0:12:42s
epoch 46 | loss: 0.56908 | train_auc: 0.7816  | train_balanced_accuracy: 0.70797 | train_accuracy: 0.70828 | valid_auc: 0.7547  | valid_balanced_accuracy: 0.68543 | valid_accuracy: 0.68571 |  0:12:59s
epoch 47 | loss: 0.56659 | train_auc: 0.78669 | train_balanced_accuracy: 0.7127  | train_accuracy: 0.71293 | valid_auc: 0.75892 | valid_balanced_accuracy: 0.69098 | valid_accuracy: 0.69122 |  0:13:14s
epoch 48 | loss: 0.56319 | train_auc: 0.78225 | train_balanced_accuracy: 0.70632 | train_accuracy: 0.70624 | valid_auc: 0.75628 | valid_balanced_accuracy: 0.68676 | valid_accuracy: 0.68665 |  0:13:32s
epoch 49 | loss: 0.5658  | train_auc: 0.77919 | train_balanced_accuracy: 0.70567 | train_accuracy: 0.70596 | valid_auc: 0.75514 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.69012 |  0:13:48s
epoch 50 | loss: 0.56111 | train_auc: 0.78435 | train_balanced_accuracy: 0.70532 | train_accuracy: 0.70537 | valid_auc: 0.75654 | valid_balanced_accuracy: 0.68333 | valid_accuracy: 0.68335 |  0:14:05s
epoch 51 | loss: 0.55917 | train_auc: 0.78273 | train_balanced_accuracy: 0.70502 | train_accuracy: 0.70486 | valid_auc: 0.757   | valid_balanced_accuracy: 0.68308 | valid_accuracy: 0.68288 |  0:14:21s
epoch 52 | loss: 0.56006 | train_auc: 0.78698 | train_balanced_accuracy: 0.70844 | train_accuracy: 0.7084  | valid_auc: 0.75968 | valid_balanced_accuracy: 0.6848  | valid_accuracy: 0.68477 |  0:14:39s
epoch 53 | loss: 0.56161 | train_auc: 0.78829 | train_balanced_accuracy: 0.71208 | train_accuracy: 0.71222 | valid_auc: 0.75871 | valid_balanced_accuracy: 0.69169 | valid_accuracy: 0.69185 |  0:14:55s
epoch 54 | loss: 0.56057 | train_auc: 0.78512 | train_balanced_accuracy: 0.70957 | train_accuracy: 0.70954 | valid_auc: 0.75814 | valid_balanced_accuracy: 0.68885 | valid_accuracy: 0.68886 |  0:15:12s
epoch 55 | loss: 0.56522 | train_auc: 0.78576 | train_balanced_accuracy: 0.71196 | train_accuracy: 0.71206 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.68986 | valid_accuracy: 0.68996 |  0:15:28s
epoch 56 | loss: 0.5605  | train_auc: 0.78756 | train_balanced_accuracy: 0.71194 | train_accuracy: 0.71206 | valid_auc: 0.76359 | valid_balanced_accuracy: 0.6949  | valid_accuracy: 0.695   |  0:15:46s
epoch 57 | loss: 0.56166 | train_auc: 0.78349 | train_balanced_accuracy: 0.7057  | train_accuracy: 0.70576 | valid_auc: 0.75337 | valid_balanced_accuracy: 0.68536 | valid_accuracy: 0.6854  |  0:16:01s
epoch 58 | loss: 0.55822 | train_auc: 0.78486 | train_balanced_accuracy: 0.70959 | train_accuracy: 0.70994 | valid_auc: 0.75275 | valid_balanced_accuracy: 0.67894 | valid_accuracy: 0.67926 |  0:16:18s
epoch 59 | loss: 0.55847 | train_auc: 0.7869  | train_balanced_accuracy: 0.70932 | train_accuracy: 0.70938 | valid_auc: 0.75759 | valid_balanced_accuracy: 0.69399 | valid_accuracy: 0.69405 |  0:16:34s
epoch 60 | loss: 0.55935 | train_auc: 0.79257 | train_balanced_accuracy: 0.71465 | train_accuracy: 0.71454 | valid_auc: 0.75955 | valid_balanced_accuracy: 0.68597 | valid_accuracy: 0.68587 |  0:16:51s
epoch 61 | loss: 0.55507 | train_auc: 0.79162 | train_balanced_accuracy: 0.71093 | train_accuracy: 0.71104 | valid_auc: 0.75989 | valid_balanced_accuracy: 0.68514 | valid_accuracy: 0.68524 |  0:17:07s
epoch 62 | loss: 0.55361 | train_auc: 0.78888 | train_balanced_accuracy: 0.71209 | train_accuracy: 0.71226 | valid_auc: 0.75919 | valid_balanced_accuracy: 0.68902 | valid_accuracy: 0.68917 |  0:17:24s
epoch 63 | loss: 0.5584  | train_auc: 0.78582 | train_balanced_accuracy: 0.71055 | train_accuracy: 0.71037 | valid_auc: 0.75483 | valid_balanced_accuracy: 0.68105 | valid_accuracy: 0.68083 |  0:17:41s
epoch 64 | loss: 0.55961 | train_auc: 0.79574 | train_balanced_accuracy: 0.71602 | train_accuracy: 0.7158  | valid_auc: 0.75796 | valid_balanced_accuracy: 0.68561 | valid_accuracy: 0.6854  |  0:17:57s
epoch 65 | loss: 0.5516  | train_auc: 0.78397 | train_balanced_accuracy: 0.70718 | train_accuracy: 0.70761 | valid_auc: 0.75219 | valid_balanced_accuracy: 0.68262 | valid_accuracy: 0.68303 |  0:18:14s
epoch 66 | loss: 0.55216 | train_auc: 0.79705 | train_balanced_accuracy: 0.71878 | train_accuracy: 0.71898 | valid_auc: 0.75794 | valid_balanced_accuracy: 0.68473 | valid_accuracy: 0.68492 |  0:18:31s
epoch 67 | loss: 0.55408 | train_auc: 0.7964  | train_balanced_accuracy: 0.71709 | train_accuracy: 0.71729 | valid_auc: 0.75699 | valid_balanced_accuracy: 0.683   | valid_accuracy: 0.68319 |  0:18:47s
epoch 68 | loss: 0.55551 | train_auc: 0.79804 | train_balanced_accuracy: 0.71846 | train_accuracy: 0.71891 | valid_auc: 0.76391 | valid_balanced_accuracy: 0.69138 | valid_accuracy: 0.69185 |  0:19:04s
epoch 69 | loss: 0.55158 | train_auc: 0.78941 | train_balanced_accuracy: 0.70612 | train_accuracy: 0.70675 | valid_auc: 0.74966 | valid_balanced_accuracy: 0.68128 | valid_accuracy: 0.68193 |  0:19:20s
epoch 70 | loss: 0.54995 | train_auc: 0.79133 | train_balanced_accuracy: 0.71513 | train_accuracy: 0.71513 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.69231 | valid_accuracy: 0.69232 |  0:19:35s
epoch 71 | loss: 0.5526  | train_auc: 0.796   | train_balanced_accuracy: 0.71679 | train_accuracy: 0.71694 | valid_auc: 0.75627 | valid_balanced_accuracy: 0.68245 | valid_accuracy: 0.68256 |  0:19:53s
epoch 72 | loss: 0.55199 | train_auc: 0.79497 | train_balanced_accuracy: 0.71449 | train_accuracy: 0.71501 | valid_auc: 0.75672 | valid_balanced_accuracy: 0.68738 | valid_accuracy: 0.68791 |  0:20:11s
epoch 73 | loss: 0.54724 | train_auc: 0.79842 | train_balanced_accuracy: 0.71653 | train_accuracy: 0.71658 | valid_auc: 0.76    | valid_balanced_accuracy: 0.68882 | valid_accuracy: 0.68886 |  0:20:29s
epoch 74 | loss: 0.54883 | train_auc: 0.79874 | train_balanced_accuracy: 0.71909 | train_accuracy: 0.71954 | valid_auc: 0.76063 | valid_balanced_accuracy: 0.68722 | valid_accuracy: 0.6876  |  0:20:45s
epoch 75 | loss: 0.55261 | train_auc: 0.79966 | train_balanced_accuracy: 0.7209  | train_accuracy: 0.72135 | valid_auc: 0.76172 | valid_balanced_accuracy: 0.69206 | valid_accuracy: 0.69248 |  0:21:03s
epoch 76 | loss: 0.55486 | train_auc: 0.80342 | train_balanced_accuracy: 0.7215  | train_accuracy: 0.72146 | valid_auc: 0.76269 | valid_balanced_accuracy: 0.69194 | valid_accuracy: 0.69185 |  0:21:18s

Early stopping occurred at epoch 76 with best_epoch = 56 and best_valid_accuracy = 0.695
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 49/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=21.4min
[CV 2/5; 49/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70019 | train_auc: 0.5604  | train_balanced_accuracy: 0.5365  | train_accuracy: 0.53685 | valid_auc: 0.55999 | valid_balanced_accuracy: 0.53837 | valid_accuracy: 0.53872 |  0:00:16s
epoch 1  | loss: 0.64397 | train_auc: 0.64011 | train_balanced_accuracy: 0.60112 | train_accuracy: 0.60102 | valid_auc: 0.63675 | valid_balanced_accuracy: 0.60133 | valid_accuracy: 0.6012  |  0:00:33s
epoch 2  | loss: 0.62352 | train_auc: 0.63554 | train_balanced_accuracy: 0.50147 | train_accuracy: 0.50502 | valid_auc: 0.63887 | valid_balanced_accuracy: 0.50048 | valid_accuracy: 0.50409 |  0:00:50s
epoch 3  | loss: 0.61951 | train_auc: 0.65369 | train_balanced_accuracy: 0.50282 | train_accuracy: 0.50628 | valid_auc: 0.64574 | valid_balanced_accuracy: 0.5031  | valid_accuracy: 0.50661 |  0:01:07s
epoch 4  | loss: 0.60661 | train_auc: 0.68193 | train_balanced_accuracy: 0.55278 | train_accuracy: 0.55573 | valid_auc: 0.67602 | valid_balanced_accuracy: 0.55289 | valid_accuracy: 0.55587 |  0:01:23s
epoch 5  | loss: 0.6073  | train_auc: 0.70363 | train_balanced_accuracy: 0.5819  | train_accuracy: 0.58434 | valid_auc: 0.69879 | valid_balanced_accuracy: 0.58631 | valid_accuracy: 0.58876 |  0:01:42s
epoch 6  | loss: 0.60454 | train_auc: 0.71284 | train_balanced_accuracy: 0.61269 | train_accuracy: 0.61468 | valid_auc: 0.71248 | valid_balanced_accuracy: 0.61445 | valid_accuracy: 0.61646 |  0:01:59s
epoch 7  | loss: 0.6015  | train_auc: 0.71314 | train_balanced_accuracy: 0.60832 | train_accuracy: 0.61043 | valid_auc: 0.70922 | valid_balanced_accuracy: 0.61246 | valid_accuracy: 0.61457 |  0:02:13s
epoch 8  | loss: 0.596   | train_auc: 0.71478 | train_balanced_accuracy: 0.6298  | train_accuracy: 0.63152 | valid_auc: 0.71115 | valid_balanced_accuracy: 0.63612 | valid_accuracy: 0.63787 |  0:02:30s
epoch 9  | loss: 0.6004  | train_auc: 0.71848 | train_balanced_accuracy: 0.65249 | train_accuracy: 0.65383 | valid_auc: 0.71498 | valid_balanced_accuracy: 0.65527 | valid_accuracy: 0.65659 |  0:02:47s
epoch 10 | loss: 0.59073 | train_auc: 0.72114 | train_balanced_accuracy: 0.66388 | train_accuracy: 0.66476 | valid_auc: 0.71643 | valid_balanced_accuracy: 0.66801 | valid_accuracy: 0.66887 |  0:03:03s
epoch 11 | loss: 0.59409 | train_auc: 0.72597 | train_balanced_accuracy: 0.6637  | train_accuracy: 0.66457 | valid_auc: 0.71907 | valid_balanced_accuracy: 0.66534 | valid_accuracy: 0.66619 |  0:03:20s
epoch 12 | loss: 0.59312 | train_auc: 0.7232  | train_balanced_accuracy: 0.65873 | train_accuracy: 0.65973 | valid_auc: 0.7149  | valid_balanced_accuracy: 0.66095 | valid_accuracy: 0.66195 |  0:03:37s
epoch 13 | loss: 0.58984 | train_auc: 0.72776 | train_balanced_accuracy: 0.66395 | train_accuracy: 0.6648  | valid_auc: 0.72246 | valid_balanced_accuracy: 0.66334 | valid_accuracy: 0.66415 |  0:03:54s
epoch 14 | loss: 0.59459 | train_auc: 0.73318 | train_balanced_accuracy: 0.66895 | train_accuracy: 0.66988 | valid_auc: 0.72777 | valid_balanced_accuracy: 0.66213 | valid_accuracy: 0.66305 |  0:04:10s
epoch 15 | loss: 0.59136 | train_auc: 0.73635 | train_balanced_accuracy: 0.6724  | train_accuracy: 0.67279 | valid_auc: 0.72849 | valid_balanced_accuracy: 0.66438 | valid_accuracy: 0.66478 |  0:04:26s
epoch 16 | loss: 0.58698 | train_auc: 0.74589 | train_balanced_accuracy: 0.67902 | train_accuracy: 0.67944 | valid_auc: 0.73455 | valid_balanced_accuracy: 0.66893 | valid_accuracy: 0.66934 |  0:04:41s
epoch 17 | loss: 0.58672 | train_auc: 0.73928 | train_balanced_accuracy: 0.67349 | train_accuracy: 0.67385 | valid_auc: 0.73068 | valid_balanced_accuracy: 0.66852 | valid_accuracy: 0.66887 |  0:05:01s
epoch 18 | loss: 0.586   | train_auc: 0.74427 | train_balanced_accuracy: 0.67761 | train_accuracy: 0.6781  | valid_auc: 0.73385 | valid_balanced_accuracy: 0.66914 | valid_accuracy: 0.66966 |  0:05:19s
epoch 19 | loss: 0.58328 | train_auc: 0.74935 | train_balanced_accuracy: 0.6831  | train_accuracy: 0.68349 | valid_auc: 0.73972 | valid_balanced_accuracy: 0.67589 | valid_accuracy: 0.67627 |  0:05:34s
epoch 20 | loss: 0.5844  | train_auc: 0.74659 | train_balanced_accuracy: 0.6816  | train_accuracy: 0.68227 | valid_auc: 0.73403 | valid_balanced_accuracy: 0.67638 | valid_accuracy: 0.67705 |  0:05:52s
epoch 21 | loss: 0.58367 | train_auc: 0.75131 | train_balanced_accuracy: 0.68678 | train_accuracy: 0.68747 | valid_auc: 0.73801 | valid_balanced_accuracy: 0.6765  | valid_accuracy: 0.67721 |  0:06:10s
epoch 22 | loss: 0.59152 | train_auc: 0.75635 | train_balanced_accuracy: 0.68832 | train_accuracy: 0.689   | valid_auc: 0.74497 | valid_balanced_accuracy: 0.68138 | valid_accuracy: 0.68209 |  0:06:27s
epoch 23 | loss: 0.58647 | train_auc: 0.75486 | train_balanced_accuracy: 0.68603 | train_accuracy: 0.68672 | valid_auc: 0.74255 | valid_balanced_accuracy: 0.67691 | valid_accuracy: 0.67753 |  0:06:44s
epoch 24 | loss: 0.58898 | train_auc: 0.76038 | train_balanced_accuracy: 0.69221 | train_accuracy: 0.6927  | valid_auc: 0.74658 | valid_balanced_accuracy: 0.68143 | valid_accuracy: 0.68193 |  0:07:00s
epoch 25 | loss: 0.57982 | train_auc: 0.76132 | train_balanced_accuracy: 0.69411 | train_accuracy: 0.694   | valid_auc: 0.74934 | valid_balanced_accuracy: 0.68599 | valid_accuracy: 0.68587 |  0:07:16s
epoch 26 | loss: 0.58252 | train_auc: 0.76402 | train_balanced_accuracy: 0.69829 | train_accuracy: 0.69872 | valid_auc: 0.74804 | valid_balanced_accuracy: 0.6859  | valid_accuracy: 0.68634 |  0:07:31s
epoch 27 | loss: 0.58234 | train_auc: 0.76434 | train_balanced_accuracy: 0.69666 | train_accuracy: 0.69707 | valid_auc: 0.75038 | valid_balanced_accuracy: 0.68341 | valid_accuracy: 0.68382 |  0:07:48s
epoch 28 | loss: 0.57931 | train_auc: 0.76176 | train_balanced_accuracy: 0.69263 | train_accuracy: 0.69306 | valid_auc: 0.7433  | valid_balanced_accuracy: 0.68183 | valid_accuracy: 0.68225 |  0:08:05s
epoch 29 | loss: 0.57995 | train_auc: 0.76638 | train_balanced_accuracy: 0.6975  | train_accuracy: 0.69754 | valid_auc: 0.75351 | valid_balanced_accuracy: 0.68396 | valid_accuracy: 0.68398 |  0:08:21s
epoch 30 | loss: 0.57827 | train_auc: 0.76681 | train_balanced_accuracy: 0.69821 | train_accuracy: 0.69837 | valid_auc: 0.75002 | valid_balanced_accuracy: 0.68227 | valid_accuracy: 0.6824  |  0:08:37s
epoch 31 | loss: 0.5811  | train_auc: 0.76561 | train_balanced_accuracy: 0.6988  | train_accuracy: 0.69911 | valid_auc: 0.74548 | valid_balanced_accuracy: 0.67989 | valid_accuracy: 0.6802  |  0:08:54s
epoch 32 | loss: 0.58595 | train_auc: 0.7623  | train_balanced_accuracy: 0.69371 | train_accuracy: 0.69376 | valid_auc: 0.74847 | valid_balanced_accuracy: 0.6835  | valid_accuracy: 0.68351 |  0:09:11s
epoch 33 | loss: 0.58431 | train_auc: 0.76519 | train_balanced_accuracy: 0.69752 | train_accuracy: 0.69821 | valid_auc: 0.74923 | valid_balanced_accuracy: 0.68546 | valid_accuracy: 0.68618 |  0:09:29s
epoch 34 | loss: 0.57884 | train_auc: 0.76407 | train_balanced_accuracy: 0.69583 | train_accuracy: 0.69624 | valid_auc: 0.75006 | valid_balanced_accuracy: 0.68593 | valid_accuracy: 0.68634 |  0:09:45s
epoch 35 | loss: 0.57885 | train_auc: 0.76879 | train_balanced_accuracy: 0.70131 | train_accuracy: 0.70187 | valid_auc: 0.74838 | valid_balanced_accuracy: 0.68657 | valid_accuracy: 0.68713 |  0:10:02s
epoch 36 | loss: 0.57712 | train_auc: 0.76969 | train_balanced_accuracy: 0.69893 | train_accuracy: 0.69923 | valid_auc: 0.75206 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68461 |  0:10:18s
epoch 37 | loss: 0.58    | train_auc: 0.76817 | train_balanced_accuracy: 0.69692 | train_accuracy: 0.69707 | valid_auc: 0.74732 | valid_balanced_accuracy: 0.681   | valid_accuracy: 0.68115 |  0:10:33s
epoch 38 | loss: 0.5742  | train_auc: 0.76598 | train_balanced_accuracy: 0.69535 | train_accuracy: 0.69518 | valid_auc: 0.75065 | valid_balanced_accuracy: 0.68118 | valid_accuracy: 0.68099 |  0:10:48s
epoch 39 | loss: 0.57547 | train_auc: 0.76945 | train_balanced_accuracy: 0.70399 | train_accuracy: 0.70435 | valid_auc: 0.75071 | valid_balanced_accuracy: 0.69059 | valid_accuracy: 0.6909  |  0:11:07s
epoch 40 | loss: 0.57768 | train_auc: 0.77348 | train_balanced_accuracy: 0.70616 | train_accuracy: 0.70663 | valid_auc: 0.75156 | valid_balanced_accuracy: 0.68841 | valid_accuracy: 0.68886 |  0:11:23s
epoch 41 | loss: 0.57409 | train_auc: 0.76397 | train_balanced_accuracy: 0.6941  | train_accuracy: 0.69396 | valid_auc: 0.74783 | valid_balanced_accuracy: 0.68284 | valid_accuracy: 0.68272 |  0:11:39s
epoch 42 | loss: 0.57029 | train_auc: 0.77377 | train_balanced_accuracy: 0.70433 | train_accuracy: 0.70482 | valid_auc: 0.75438 | valid_balanced_accuracy: 0.69215 | valid_accuracy: 0.69263 |  0:11:55s
epoch 43 | loss: 0.57649 | train_auc: 0.77438 | train_balanced_accuracy: 0.70413 | train_accuracy: 0.70419 | valid_auc: 0.75411 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68901 |  0:12:11s
epoch 44 | loss: 0.57062 | train_auc: 0.77388 | train_balanced_accuracy: 0.7062  | train_accuracy: 0.70663 | valid_auc: 0.75273 | valid_balanced_accuracy: 0.69362 | valid_accuracy: 0.69405 |  0:12:28s
epoch 45 | loss: 0.57014 | train_auc: 0.77106 | train_balanced_accuracy: 0.69986 | train_accuracy: 0.70049 | valid_auc: 0.74538 | valid_balanced_accuracy: 0.6851  | valid_accuracy: 0.68571 |  0:12:44s
epoch 46 | loss: 0.57275 | train_auc: 0.77161 | train_balanced_accuracy: 0.70257 | train_accuracy: 0.7027  | valid_auc: 0.7485  | valid_balanced_accuracy: 0.68745 | valid_accuracy: 0.6876  |  0:13:01s
epoch 47 | loss: 0.57172 | train_auc: 0.77496 | train_balanced_accuracy: 0.70455 | train_accuracy: 0.70502 | valid_auc: 0.75264 | valid_balanced_accuracy: 0.6881  | valid_accuracy: 0.68854 |  0:13:20s
epoch 48 | loss: 0.56871 | train_auc: 0.77524 | train_balanced_accuracy: 0.7068  | train_accuracy: 0.70694 | valid_auc: 0.74889 | valid_balanced_accuracy: 0.69035 | valid_accuracy: 0.69043 |  0:13:35s
epoch 49 | loss: 0.56943 | train_auc: 0.77696 | train_balanced_accuracy: 0.70653 | train_accuracy: 0.70698 | valid_auc: 0.75201 | valid_balanced_accuracy: 0.69123 | valid_accuracy: 0.69169 |  0:13:51s
epoch 50 | loss: 0.56988 | train_auc: 0.77909 | train_balanced_accuracy: 0.70728 | train_accuracy: 0.7075  | valid_auc: 0.7578  | valid_balanced_accuracy: 0.69321 | valid_accuracy: 0.69342 |  0:14:06s
epoch 51 | loss: 0.56824 | train_auc: 0.77801 | train_balanced_accuracy: 0.70773 | train_accuracy: 0.70801 | valid_auc: 0.75764 | valid_balanced_accuracy: 0.69802 | valid_accuracy: 0.6983  |  0:14:23s
epoch 52 | loss: 0.56696 | train_auc: 0.78145 | train_balanced_accuracy: 0.71057 | train_accuracy: 0.71068 | valid_auc: 0.75896 | valid_balanced_accuracy: 0.69083 | valid_accuracy: 0.6909  |  0:14:39s
epoch 53 | loss: 0.5643  | train_auc: 0.77989 | train_balanced_accuracy: 0.70762 | train_accuracy: 0.70789 | valid_auc: 0.7544  | valid_balanced_accuracy: 0.68968 | valid_accuracy: 0.68996 |  0:14:55s
epoch 54 | loss: 0.56965 | train_auc: 0.7794  | train_balanced_accuracy: 0.70751 | train_accuracy: 0.70765 | valid_auc: 0.75547 | valid_balanced_accuracy: 0.68999 | valid_accuracy: 0.69012 |  0:15:11s
epoch 55 | loss: 0.57229 | train_auc: 0.77944 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70911 | valid_auc: 0.75398 | valid_balanced_accuracy: 0.69025 | valid_accuracy: 0.69075 |  0:15:29s
epoch 56 | loss: 0.5686  | train_auc: 0.77526 | train_balanced_accuracy: 0.70468 | train_accuracy: 0.70486 | valid_auc: 0.75162 | valid_balanced_accuracy: 0.6942  | valid_accuracy: 0.69437 |  0:15:43s
epoch 57 | loss: 0.5685  | train_auc: 0.78469 | train_balanced_accuracy: 0.71154 | train_accuracy: 0.71163 | valid_auc: 0.75718 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69263 |  0:16:03s
epoch 58 | loss: 0.56326 | train_auc: 0.78287 | train_balanced_accuracy: 0.71159 | train_accuracy: 0.71175 | valid_auc: 0.75565 | valid_balanced_accuracy: 0.69456 | valid_accuracy: 0.69468 |  0:16:21s
epoch 59 | loss: 0.56346 | train_auc: 0.7819  | train_balanced_accuracy: 0.71136 | train_accuracy: 0.71175 | valid_auc: 0.75585 | valid_balanced_accuracy: 0.69208 | valid_accuracy: 0.69248 |  0:16:36s
epoch 60 | loss: 0.56607 | train_auc: 0.77923 | train_balanced_accuracy: 0.7079  | train_accuracy: 0.70824 | valid_auc: 0.75431 | valid_balanced_accuracy: 0.69121 | valid_accuracy: 0.69153 |  0:16:53s
epoch 61 | loss: 0.56572 | train_auc: 0.78302 | train_balanced_accuracy: 0.70986 | train_accuracy: 0.71017 | valid_auc: 0.7597  | valid_balanced_accuracy: 0.69437 | valid_accuracy: 0.69468 |  0:17:09s
epoch 62 | loss: 0.5644  | train_auc: 0.78153 | train_balanced_accuracy: 0.71114 | train_accuracy: 0.71127 | valid_auc: 0.75413 | valid_balanced_accuracy: 0.69144 | valid_accuracy: 0.69153 |  0:17:26s
epoch 63 | loss: 0.56734 | train_auc: 0.78102 | train_balanced_accuracy: 0.71078 | train_accuracy: 0.71092 | valid_auc: 0.75389 | valid_balanced_accuracy: 0.69174 | valid_accuracy: 0.69185 |  0:17:40s
epoch 64 | loss: 0.56514 | train_auc: 0.78383 | train_balanced_accuracy: 0.70886 | train_accuracy: 0.70895 | valid_auc: 0.75335 | valid_balanced_accuracy: 0.69127 | valid_accuracy: 0.69138 |  0:17:58s
epoch 65 | loss: 0.55873 | train_auc: 0.78478 | train_balanced_accuracy: 0.7141  | train_accuracy: 0.71434 | valid_auc: 0.75643 | valid_balanced_accuracy: 0.69367 | valid_accuracy: 0.69389 |  0:18:13s
epoch 66 | loss: 0.56147 | train_auc: 0.78623 | train_balanced_accuracy: 0.71461 | train_accuracy: 0.71474 | valid_auc: 0.75819 | valid_balanced_accuracy: 0.69473 | valid_accuracy: 0.69484 |  0:18:30s
epoch 67 | loss: 0.55798 | train_auc: 0.78162 | train_balanced_accuracy: 0.71046 | train_accuracy: 0.71096 | valid_auc: 0.75698 | valid_balanced_accuracy: 0.6901  | valid_accuracy: 0.69059 |  0:18:45s
epoch 68 | loss: 0.56427 | train_auc: 0.7862  | train_balanced_accuracy: 0.71433 | train_accuracy: 0.7147  | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69576 | valid_accuracy: 0.6961  |  0:19:00s
epoch 69 | loss: 0.56133 | train_auc: 0.78559 | train_balanced_accuracy: 0.71431 | train_accuracy: 0.71458 | valid_auc: 0.75829 | valid_balanced_accuracy: 0.69488 | valid_accuracy: 0.69515 |  0:19:17s
epoch 70 | loss: 0.56145 | train_auc: 0.78741 | train_balanced_accuracy: 0.71669 | train_accuracy: 0.71702 | valid_auc: 0.75833 | valid_balanced_accuracy: 0.69437 | valid_accuracy: 0.69468 |  0:19:33s
epoch 71 | loss: 0.56237 | train_auc: 0.78388 | train_balanced_accuracy: 0.7103  | train_accuracy: 0.71029 | valid_auc: 0.75603 | valid_balanced_accuracy: 0.69264 | valid_accuracy: 0.69263 |  0:19:49s

Early stopping occurred at epoch 71 with best_epoch = 51 and best_valid_accuracy = 0.6983
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 49/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.687 total time=19.9min
[CV 3/5; 49/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7069  | train_auc: 0.57894 | train_balanced_accuracy: 0.53915 | train_accuracy: 0.53777 | valid_auc: 0.58519 | valid_balanced_accuracy: 0.54117 | valid_accuracy: 0.53966 |  0:00:14s
epoch 1  | loss: 0.6612  | train_auc: 0.63895 | train_balanced_accuracy: 0.51383 | train_accuracy: 0.51719 | valid_auc: 0.64791 | valid_balanced_accuracy: 0.51423 | valid_accuracy: 0.51763 |  0:00:29s
epoch 2  | loss: 0.64547 | train_auc: 0.66687 | train_balanced_accuracy: 0.61123 | train_accuracy: 0.61296 | valid_auc: 0.66868 | valid_balanced_accuracy: 0.61648 | valid_accuracy: 0.61819 |  0:00:44s
epoch 3  | loss: 0.63474 | train_auc: 0.68215 | train_balanced_accuracy: 0.62246 | train_accuracy: 0.62354 | valid_auc: 0.68163 | valid_balanced_accuracy: 0.62547 | valid_accuracy: 0.62653 |  0:01:01s
epoch 4  | loss: 0.62549 | train_auc: 0.70022 | train_balanced_accuracy: 0.63518 | train_accuracy: 0.63661 | valid_auc: 0.70172 | valid_balanced_accuracy: 0.63785 | valid_accuracy: 0.63928 |  0:01:17s
epoch 5  | loss: 0.62079 | train_auc: 0.70625 | train_balanced_accuracy: 0.65248 | train_accuracy: 0.65356 | valid_auc: 0.70492 | valid_balanced_accuracy: 0.65425 | valid_accuracy: 0.65534 |  0:01:31s
epoch 6  | loss: 0.61804 | train_auc: 0.71331 | train_balanced_accuracy: 0.65757 | train_accuracy: 0.6584  | valid_auc: 0.71024 | valid_balanced_accuracy: 0.65894 | valid_accuracy: 0.65974 |  0:01:47s
epoch 7  | loss: 0.61781 | train_auc: 0.71096 | train_balanced_accuracy: 0.65927 | train_accuracy: 0.6601  | valid_auc: 0.70888 | valid_balanced_accuracy: 0.65756 | valid_accuracy: 0.65833 |  0:02:05s
epoch 8  | loss: 0.61364 | train_auc: 0.71977 | train_balanced_accuracy: 0.65905 | train_accuracy: 0.66029 | valid_auc: 0.71476 | valid_balanced_accuracy: 0.65759 | valid_accuracy: 0.6588  |  0:02:22s
epoch 9  | loss: 0.61242 | train_auc: 0.71944 | train_balanced_accuracy: 0.66294 | train_accuracy: 0.66376 | valid_auc: 0.7117  | valid_balanced_accuracy: 0.66365 | valid_accuracy: 0.66446 |  0:02:40s
epoch 10 | loss: 0.60392 | train_auc: 0.71763 | train_balanced_accuracy: 0.66303 | train_accuracy: 0.66387 | valid_auc: 0.71346 | valid_balanced_accuracy: 0.65777 | valid_accuracy: 0.65864 |  0:02:56s
epoch 11 | loss: 0.60758 | train_auc: 0.72239 | train_balanced_accuracy: 0.66457 | train_accuracy: 0.66525 | valid_auc: 0.71464 | valid_balanced_accuracy: 0.66361 | valid_accuracy: 0.66431 |  0:03:13s
epoch 12 | loss: 0.60537 | train_auc: 0.72409 | train_balanced_accuracy: 0.66583 | train_accuracy: 0.66659 | valid_auc: 0.71652 | valid_balanced_accuracy: 0.66544 | valid_accuracy: 0.66619 |  0:03:29s
epoch 13 | loss: 0.60684 | train_auc: 0.72205 | train_balanced_accuracy: 0.66519 | train_accuracy: 0.66592 | valid_auc: 0.71288 | valid_balanced_accuracy: 0.66248 | valid_accuracy: 0.6632  |  0:03:44s
epoch 14 | loss: 0.60429 | train_auc: 0.72411 | train_balanced_accuracy: 0.66899 | train_accuracy: 0.66966 | valid_auc: 0.72176 | valid_balanced_accuracy: 0.66947 | valid_accuracy: 0.67013 |  0:04:00s
epoch 15 | loss: 0.60469 | train_auc: 0.72559 | train_balanced_accuracy: 0.66894 | train_accuracy: 0.66946 | valid_auc: 0.72402 | valid_balanced_accuracy: 0.66662 | valid_accuracy: 0.66714 |  0:04:17s
epoch 16 | loss: 0.60188 | train_auc: 0.72717 | train_balanced_accuracy: 0.66559 | train_accuracy: 0.66584 | valid_auc: 0.72122 | valid_balanced_accuracy: 0.66223 | valid_accuracy: 0.66242 |  0:04:33s
epoch 17 | loss: 0.59625 | train_auc: 0.72762 | train_balanced_accuracy: 0.66478 | train_accuracy: 0.66517 | valid_auc: 0.72116 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.66336 |  0:04:50s
epoch 18 | loss: 0.60782 | train_auc: 0.72679 | train_balanced_accuracy: 0.66513 | train_accuracy: 0.66588 | valid_auc: 0.71862 | valid_balanced_accuracy: 0.65948 | valid_accuracy: 0.66021 |  0:05:08s
epoch 19 | loss: 0.6016  | train_auc: 0.73061 | train_balanced_accuracy: 0.66901 | train_accuracy: 0.66966 | valid_auc: 0.72329 | valid_balanced_accuracy: 0.66555 | valid_accuracy: 0.66619 |  0:05:26s
epoch 20 | loss: 0.5996  | train_auc: 0.73273 | train_balanced_accuracy: 0.67082 | train_accuracy: 0.67135 | valid_auc: 0.72302 | valid_balanced_accuracy: 0.66488 | valid_accuracy: 0.66541 |  0:05:44s
epoch 21 | loss: 0.59074 | train_auc: 0.73858 | train_balanced_accuracy: 0.67195 | train_accuracy: 0.67249 | valid_auc: 0.72896 | valid_balanced_accuracy: 0.66849 | valid_accuracy: 0.66903 |  0:05:59s
epoch 22 | loss: 0.59991 | train_auc: 0.73524 | train_balanced_accuracy: 0.67374 | train_accuracy: 0.67422 | valid_auc: 0.72757 | valid_balanced_accuracy: 0.66587 | valid_accuracy: 0.66635 |  0:06:15s
epoch 23 | loss: 0.59541 | train_auc: 0.74253 | train_balanced_accuracy: 0.68108 | train_accuracy: 0.68158 | valid_auc: 0.73776 | valid_balanced_accuracy: 0.67911 | valid_accuracy: 0.67957 |  0:06:32s
epoch 24 | loss: 0.5953  | train_auc: 0.74037 | train_balanced_accuracy: 0.67909 | train_accuracy: 0.67953 | valid_auc: 0.73375 | valid_balanced_accuracy: 0.67014 | valid_accuracy: 0.6706  |  0:06:48s
epoch 25 | loss: 0.59386 | train_auc: 0.7476  | train_balanced_accuracy: 0.68399 | train_accuracy: 0.68437 | valid_auc: 0.74066 | valid_balanced_accuracy: 0.67856 | valid_accuracy: 0.67894 |  0:07:06s
epoch 26 | loss: 0.59163 | train_auc: 0.75262 | train_balanced_accuracy: 0.68545 | train_accuracy: 0.68614 | valid_auc: 0.74534 | valid_balanced_accuracy: 0.68186 | valid_accuracy: 0.68256 |  0:07:23s
epoch 27 | loss: 0.59224 | train_auc: 0.7542  | train_balanced_accuracy: 0.68718 | train_accuracy: 0.6874  | valid_auc: 0.74563 | valid_balanced_accuracy: 0.68186 | valid_accuracy: 0.68209 |  0:07:40s
epoch 28 | loss: 0.5896  | train_auc: 0.75383 | train_balanced_accuracy: 0.68907 | train_accuracy: 0.68937 | valid_auc: 0.74413 | valid_balanced_accuracy: 0.68321 | valid_accuracy: 0.68351 |  0:07:57s
epoch 29 | loss: 0.58846 | train_auc: 0.75475 | train_balanced_accuracy: 0.68874 | train_accuracy: 0.6889  | valid_auc: 0.7445  | valid_balanced_accuracy: 0.6854  | valid_accuracy: 0.68555 |  0:08:13s
epoch 30 | loss: 0.58788 | train_auc: 0.75749 | train_balanced_accuracy: 0.69115 | train_accuracy: 0.69149 | valid_auc: 0.74574 | valid_balanced_accuracy: 0.68382 | valid_accuracy: 0.68414 |  0:08:30s
epoch 31 | loss: 0.5916  | train_auc: 0.75357 | train_balanced_accuracy: 0.68931 | train_accuracy: 0.68964 | valid_auc: 0.74684 | valid_balanced_accuracy: 0.68079 | valid_accuracy: 0.68115 |  0:08:47s
epoch 32 | loss: 0.58357 | train_auc: 0.75183 | train_balanced_accuracy: 0.68707 | train_accuracy: 0.68732 | valid_auc: 0.74739 | valid_balanced_accuracy: 0.67994 | valid_accuracy: 0.6802  |  0:09:03s
epoch 33 | loss: 0.58831 | train_auc: 0.75226 | train_balanced_accuracy: 0.68695 | train_accuracy: 0.68736 | valid_auc: 0.74862 | valid_balanced_accuracy: 0.68436 | valid_accuracy: 0.68477 |  0:09:23s
epoch 34 | loss: 0.58608 | train_auc: 0.75691 | train_balanced_accuracy: 0.68649 | train_accuracy: 0.68689 | valid_auc: 0.74946 | valid_balanced_accuracy: 0.68341 | valid_accuracy: 0.68382 |  0:09:40s
epoch 35 | loss: 0.58595 | train_auc: 0.75607 | train_balanced_accuracy: 0.68776 | train_accuracy: 0.68807 | valid_auc: 0.74667 | valid_balanced_accuracy: 0.68447 | valid_accuracy: 0.68477 |  0:09:56s
epoch 36 | loss: 0.58966 | train_auc: 0.75616 | train_balanced_accuracy: 0.68767 | train_accuracy: 0.68787 | valid_auc: 0.74647 | valid_balanced_accuracy: 0.67966 | valid_accuracy: 0.67989 |  0:10:12s
epoch 37 | loss: 0.58418 | train_auc: 0.75758 | train_balanced_accuracy: 0.68787 | train_accuracy: 0.68842 | valid_auc: 0.74848 | valid_balanced_accuracy: 0.68308 | valid_accuracy: 0.68366 |  0:10:29s
epoch 38 | loss: 0.58334 | train_auc: 0.75933 | train_balanced_accuracy: 0.68921 | train_accuracy: 0.68937 | valid_auc: 0.74723 | valid_balanced_accuracy: 0.67703 | valid_accuracy: 0.67721 |  0:10:46s
epoch 39 | loss: 0.57972 | train_auc: 0.72078 | train_balanced_accuracy: 0.66982 | train_accuracy: 0.66981 | valid_auc: 0.72038 | valid_balanced_accuracy: 0.66792 | valid_accuracy: 0.66793 |  0:11:02s
epoch 40 | loss: 0.58399 | train_auc: 0.72055 | train_balanced_accuracy: 0.66653 | train_accuracy: 0.66671 | valid_auc: 0.72148 | valid_balanced_accuracy: 0.66586 | valid_accuracy: 0.66604 |  0:11:18s
epoch 41 | loss: 0.58325 | train_auc: 0.74208 | train_balanced_accuracy: 0.68188 | train_accuracy: 0.68213 | valid_auc: 0.74009 | valid_balanced_accuracy: 0.67981 | valid_accuracy: 0.68004 |  0:11:36s
epoch 42 | loss: 0.57848 | train_auc: 0.74512 | train_balanced_accuracy: 0.68684 | train_accuracy: 0.68713 | valid_auc: 0.74196 | valid_balanced_accuracy: 0.68402 | valid_accuracy: 0.68429 |  0:11:52s
epoch 43 | loss: 0.58579 | train_auc: 0.75947 | train_balanced_accuracy: 0.69026 | train_accuracy: 0.69035 | valid_auc: 0.75402 | valid_balanced_accuracy: 0.69145 | valid_accuracy: 0.69153 |  0:12:08s
epoch 44 | loss: 0.5854  | train_auc: 0.76261 | train_balanced_accuracy: 0.69107 | train_accuracy: 0.69106 | valid_auc: 0.75412 | valid_balanced_accuracy: 0.68558 | valid_accuracy: 0.68555 |  0:12:25s
epoch 45 | loss: 0.58241 | train_auc: 0.76652 | train_balanced_accuracy: 0.69486 | train_accuracy: 0.69511 | valid_auc: 0.75358 | valid_balanced_accuracy: 0.68562 | valid_accuracy: 0.68587 |  0:12:40s
epoch 46 | loss: 0.5831  | train_auc: 0.76712 | train_balanced_accuracy: 0.69362 | train_accuracy: 0.69397 | valid_auc: 0.75218 | valid_balanced_accuracy: 0.68741 | valid_accuracy: 0.68776 |  0:12:56s
epoch 47 | loss: 0.58127 | train_auc: 0.76251 | train_balanced_accuracy: 0.69204 | train_accuracy: 0.6924  | valid_auc: 0.74941 | valid_balanced_accuracy: 0.6808  | valid_accuracy: 0.68115 |  0:13:13s
epoch 48 | loss: 0.58456 | train_auc: 0.76113 | train_balanced_accuracy: 0.68838 | train_accuracy: 0.68854 | valid_auc: 0.74494 | valid_balanced_accuracy: 0.67356 | valid_accuracy: 0.67375 |  0:13:30s
epoch 49 | loss: 0.58219 | train_auc: 0.75918 | train_balanced_accuracy: 0.68825 | train_accuracy: 0.68874 | valid_auc: 0.74086 | valid_balanced_accuracy: 0.67623 | valid_accuracy: 0.67674 |  0:13:46s
epoch 50 | loss: 0.58451 | train_auc: 0.76429 | train_balanced_accuracy: 0.69205 | train_accuracy: 0.69228 | valid_auc: 0.74861 | valid_balanced_accuracy: 0.6822  | valid_accuracy: 0.6824  |  0:14:01s
epoch 51 | loss: 0.57794 | train_auc: 0.76129 | train_balanced_accuracy: 0.69178 | train_accuracy: 0.69208 | valid_auc: 0.74314 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68492 |  0:14:18s
epoch 52 | loss: 0.57385 | train_auc: 0.77004 | train_balanced_accuracy: 0.69512 | train_accuracy: 0.69531 | valid_auc: 0.74963 | valid_balanced_accuracy: 0.68108 | valid_accuracy: 0.6813  |  0:14:35s
epoch 53 | loss: 0.57706 | train_auc: 0.7649  | train_balanced_accuracy: 0.69363 | train_accuracy: 0.6937  | valid_auc: 0.7486  | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69106 |  0:14:53s
epoch 54 | loss: 0.5772  | train_auc: 0.76976 | train_balanced_accuracy: 0.69786 | train_accuracy: 0.69822 | valid_auc: 0.75425 | valid_balanced_accuracy: 0.68629 | valid_accuracy: 0.68665 |  0:15:09s
epoch 55 | loss: 0.57713 | train_auc: 0.76777 | train_balanced_accuracy: 0.69561 | train_accuracy: 0.69578 | valid_auc: 0.74894 | valid_balanced_accuracy: 0.68599 | valid_accuracy: 0.68618 |  0:15:27s
epoch 56 | loss: 0.57403 | train_auc: 0.76523 | train_balanced_accuracy: 0.69124 | train_accuracy: 0.69126 | valid_auc: 0.74548 | valid_balanced_accuracy: 0.67595 | valid_accuracy: 0.67595 |  0:15:45s
epoch 57 | loss: 0.58363 | train_auc: 0.76863 | train_balanced_accuracy: 0.69642 | train_accuracy: 0.69641 | valid_auc: 0.75536 | valid_balanced_accuracy: 0.68663 | valid_accuracy: 0.68665 |  0:16:02s
epoch 58 | loss: 0.5802  | train_auc: 0.77253 | train_balanced_accuracy: 0.69865 | train_accuracy: 0.69893 | valid_auc: 0.7524  | valid_balanced_accuracy: 0.68602 | valid_accuracy: 0.68634 |  0:16:17s
epoch 59 | loss: 0.57057 | train_auc: 0.77312 | train_balanced_accuracy: 0.6988  | train_accuracy: 0.69909 | valid_auc: 0.75331 | valid_balanced_accuracy: 0.68513 | valid_accuracy: 0.6854  |  0:16:35s
epoch 60 | loss: 0.57363 | train_auc: 0.77285 | train_balanced_accuracy: 0.6959  | train_accuracy: 0.69629 | valid_auc: 0.7529  | valid_balanced_accuracy: 0.683   | valid_accuracy: 0.68335 |  0:16:52s
epoch 61 | loss: 0.57562 | train_auc: 0.77306 | train_balanced_accuracy: 0.69778 | train_accuracy: 0.69826 | valid_auc: 0.75359 | valid_balanced_accuracy: 0.68777 | valid_accuracy: 0.68823 |  0:17:09s
epoch 62 | loss: 0.572   | train_auc: 0.77003 | train_balanced_accuracy: 0.69442 | train_accuracy: 0.6948  | valid_auc: 0.75248 | valid_balanced_accuracy: 0.68534 | valid_accuracy: 0.68571 |  0:17:25s
epoch 63 | loss: 0.57309 | train_auc: 0.77695 | train_balanced_accuracy: 0.69842 | train_accuracy: 0.69897 | valid_auc: 0.75583 | valid_balanced_accuracy: 0.68676 | valid_accuracy: 0.68728 |  0:17:42s

Early stopping occurred at epoch 63 with best_epoch = 43 and best_valid_accuracy = 0.69153
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 49/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=17.8min
[CV 4/5; 49/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6899  | train_auc: 0.64027 | train_balanced_accuracy: 0.58773 | train_accuracy: 0.58636 | valid_auc: 0.63168 | valid_balanced_accuracy: 0.57643 | valid_accuracy: 0.57507 |  0:00:16s
epoch 1  | loss: 0.64866 | train_auc: 0.6581  | train_balanced_accuracy: 0.59557 | train_accuracy: 0.59388 | valid_auc: 0.65129 | valid_balanced_accuracy: 0.59217 | valid_accuracy: 0.59049 |  0:00:33s
epoch 2  | loss: 0.63531 | train_auc: 0.65976 | train_balanced_accuracy: 0.60031 | train_accuracy: 0.59931 | valid_auc: 0.65512 | valid_balanced_accuracy: 0.5926  | valid_accuracy: 0.5916  |  0:00:48s
epoch 3  | loss: 0.63559 | train_auc: 0.67104 | train_balanced_accuracy: 0.58746 | train_accuracy: 0.58542 | valid_auc: 0.66655 | valid_balanced_accuracy: 0.57967 | valid_accuracy: 0.57759 |  0:01:03s
epoch 4  | loss: 0.62564 | train_auc: 0.68453 | train_balanced_accuracy: 0.62658 | train_accuracy: 0.62559 | valid_auc: 0.68164 | valid_balanced_accuracy: 0.62141 | valid_accuracy: 0.6204  |  0:01:18s
epoch 5  | loss: 0.62472 | train_auc: 0.68746 | train_balanced_accuracy: 0.62666 | train_accuracy: 0.62575 | valid_auc: 0.68466 | valid_balanced_accuracy: 0.62334 | valid_accuracy: 0.62244 |  0:01:35s
epoch 6  | loss: 0.61868 | train_auc: 0.69863 | train_balanced_accuracy: 0.63157 | train_accuracy: 0.63031 | valid_auc: 0.69451 | valid_balanced_accuracy: 0.62149 | valid_accuracy: 0.62024 |  0:01:52s
epoch 7  | loss: 0.61683 | train_auc: 0.70838 | train_balanced_accuracy: 0.64598 | train_accuracy: 0.64503 | valid_auc: 0.7042  | valid_balanced_accuracy: 0.63646 | valid_accuracy: 0.63551 |  0:02:08s
epoch 8  | loss: 0.61919 | train_auc: 0.70782 | train_balanced_accuracy: 0.64501 | train_accuracy: 0.64483 | valid_auc: 0.70383 | valid_balanced_accuracy: 0.64212 | valid_accuracy: 0.64196 |  0:02:26s
epoch 9  | loss: 0.61257 | train_auc: 0.70488 | train_balanced_accuracy: 0.64157 | train_accuracy: 0.64145 | valid_auc: 0.70084 | valid_balanced_accuracy: 0.63641 | valid_accuracy: 0.63629 |  0:02:41s
epoch 10 | loss: 0.61007 | train_auc: 0.71435 | train_balanced_accuracy: 0.66138 | train_accuracy: 0.6612  | valid_auc: 0.70879 | valid_balanced_accuracy: 0.65894 | valid_accuracy: 0.6588  |  0:02:58s
epoch 11 | loss: 0.60816 | train_auc: 0.72342 | train_balanced_accuracy: 0.66442 | train_accuracy: 0.66431 | valid_auc: 0.71755 | valid_balanced_accuracy: 0.66359 | valid_accuracy: 0.66352 |  0:03:15s
epoch 12 | loss: 0.60208 | train_auc: 0.73135 | train_balanced_accuracy: 0.66964 | train_accuracy: 0.66934 | valid_auc: 0.72361 | valid_balanced_accuracy: 0.66688 | valid_accuracy: 0.66667 |  0:03:32s
epoch 13 | loss: 0.60219 | train_auc: 0.73034 | train_balanced_accuracy: 0.67059 | train_accuracy: 0.67072 | valid_auc: 0.72218 | valid_balanced_accuracy: 0.66253 | valid_accuracy: 0.66273 |  0:03:48s
epoch 14 | loss: 0.60263 | train_auc: 0.73101 | train_balanced_accuracy: 0.6685  | train_accuracy: 0.66836 | valid_auc: 0.72186 | valid_balanced_accuracy: 0.65637 | valid_accuracy: 0.65628 |  0:04:05s
epoch 15 | loss: 0.60241 | train_auc: 0.73447 | train_balanced_accuracy: 0.66893 | train_accuracy: 0.66871 | valid_auc: 0.7267  | valid_balanced_accuracy: 0.66431 | valid_accuracy: 0.66415 |  0:04:22s
epoch 16 | loss: 0.59562 | train_auc: 0.73607 | train_balanced_accuracy: 0.67388 | train_accuracy: 0.67379 | valid_auc: 0.73032 | valid_balanced_accuracy: 0.67455 | valid_accuracy: 0.67454 |  0:04:37s
epoch 17 | loss: 0.59809 | train_auc: 0.73568 | train_balanced_accuracy: 0.67211 | train_accuracy: 0.6721  | valid_auc: 0.7268  | valid_balanced_accuracy: 0.66317 | valid_accuracy: 0.6632  |  0:04:51s
epoch 18 | loss: 0.59814 | train_auc: 0.74093 | train_balanced_accuracy: 0.67295 | train_accuracy: 0.67332 | valid_auc: 0.72964 | valid_balanced_accuracy: 0.6672  | valid_accuracy: 0.66761 |  0:05:10s
epoch 19 | loss: 0.59384 | train_auc: 0.73868 | train_balanced_accuracy: 0.67356 | train_accuracy: 0.67398 | valid_auc: 0.72861 | valid_balanced_accuracy: 0.66746 | valid_accuracy: 0.66793 |  0:05:25s
epoch 20 | loss: 0.59861 | train_auc: 0.7357  | train_balanced_accuracy: 0.67393 | train_accuracy: 0.67458 | valid_auc: 0.72227 | valid_balanced_accuracy: 0.66688 | valid_accuracy: 0.66761 |  0:05:42s
epoch 21 | loss: 0.59655 | train_auc: 0.7427  | train_balanced_accuracy: 0.67435 | train_accuracy: 0.67505 | valid_auc: 0.72967 | valid_balanced_accuracy: 0.66404 | valid_accuracy: 0.66478 |  0:05:59s
epoch 22 | loss: 0.59794 | train_auc: 0.73971 | train_balanced_accuracy: 0.6743  | train_accuracy: 0.67461 | valid_auc: 0.73032 | valid_balanced_accuracy: 0.66914 | valid_accuracy: 0.6695  |  0:06:17s
epoch 23 | loss: 0.59929 | train_auc: 0.74653 | train_balanced_accuracy: 0.68609 | train_accuracy: 0.68622 | valid_auc: 0.73215 | valid_balanced_accuracy: 0.67754 | valid_accuracy: 0.67768 |  0:06:33s
epoch 24 | loss: 0.59672 | train_auc: 0.74586 | train_balanced_accuracy: 0.68065 | train_accuracy: 0.68095 | valid_auc: 0.73428 | valid_balanced_accuracy: 0.67245 | valid_accuracy: 0.6728  |  0:06:48s
epoch 25 | loss: 0.59144 | train_auc: 0.75275 | train_balanced_accuracy: 0.68693 | train_accuracy: 0.68717 | valid_auc: 0.74232 | valid_balanced_accuracy: 0.68165 | valid_accuracy: 0.68193 |  0:07:04s
epoch 26 | loss: 0.58879 | train_auc: 0.75627 | train_balanced_accuracy: 0.69156 | train_accuracy: 0.69189 | valid_auc: 0.74066 | valid_balanced_accuracy: 0.68489 | valid_accuracy: 0.68524 |  0:07:20s
epoch 27 | loss: 0.59203 | train_auc: 0.75789 | train_balanced_accuracy: 0.68995 | train_accuracy: 0.6902  | valid_auc: 0.74087 | valid_balanced_accuracy: 0.679   | valid_accuracy: 0.67926 |  0:07:37s
epoch 28 | loss: 0.58775 | train_auc: 0.75911 | train_balanced_accuracy: 0.69175 | train_accuracy: 0.69189 | valid_auc: 0.7429  | valid_balanced_accuracy: 0.68113 | valid_accuracy: 0.6813  |  0:07:52s
epoch 29 | loss: 0.5881  | train_auc: 0.76186 | train_balanced_accuracy: 0.69001 | train_accuracy: 0.68992 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.67866 | valid_accuracy: 0.67863 |  0:08:08s
epoch 30 | loss: 0.58049 | train_auc: 0.7622  | train_balanced_accuracy: 0.68922 | train_accuracy: 0.68909 | valid_auc: 0.74113 | valid_balanced_accuracy: 0.67858 | valid_accuracy: 0.67847 |  0:08:24s
epoch 31 | loss: 0.58256 | train_auc: 0.76035 | train_balanced_accuracy: 0.69321 | train_accuracy: 0.69354 | valid_auc: 0.74396 | valid_balanced_accuracy: 0.68046 | valid_accuracy: 0.68083 |  0:08:41s
epoch 32 | loss: 0.58213 | train_auc: 0.75869 | train_balanced_accuracy: 0.69139 | train_accuracy: 0.69145 | valid_auc: 0.74425 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.68115 |  0:08:57s
epoch 33 | loss: 0.5868  | train_auc: 0.76201 | train_balanced_accuracy: 0.69187 | train_accuracy: 0.69208 | valid_auc: 0.74653 | valid_balanced_accuracy: 0.67995 | valid_accuracy: 0.6802  |  0:09:15s
epoch 34 | loss: 0.58197 | train_auc: 0.76192 | train_balanced_accuracy: 0.69346 | train_accuracy: 0.69358 | valid_auc: 0.74598 | valid_balanced_accuracy: 0.68051 | valid_accuracy: 0.68067 |  0:09:33s
epoch 35 | loss: 0.57583 | train_auc: 0.76437 | train_balanced_accuracy: 0.69127 | train_accuracy: 0.69169 | valid_auc: 0.74135 | valid_balanced_accuracy: 0.67816 | valid_accuracy: 0.67863 |  0:09:50s
epoch 36 | loss: 0.57787 | train_auc: 0.76617 | train_balanced_accuracy: 0.69564 | train_accuracy: 0.69582 | valid_auc: 0.75155 | valid_balanced_accuracy: 0.68486 | valid_accuracy: 0.68508 |  0:10:06s
epoch 37 | loss: 0.5792  | train_auc: 0.76395 | train_balanced_accuracy: 0.69347 | train_accuracy: 0.69346 | valid_auc: 0.7431  | valid_balanced_accuracy: 0.67765 | valid_accuracy: 0.67768 |  0:10:23s
epoch 38 | loss: 0.57843 | train_auc: 0.76807 | train_balanced_accuracy: 0.69024 | train_accuracy: 0.69012 | valid_auc: 0.74336 | valid_balanced_accuracy: 0.67243 | valid_accuracy: 0.67233 |  0:10:39s
epoch 39 | loss: 0.57879 | train_auc: 0.76852 | train_balanced_accuracy: 0.69287 | train_accuracy: 0.69303 | valid_auc: 0.74409 | valid_balanced_accuracy: 0.6808  | valid_accuracy: 0.68099 |  0:10:55s
epoch 40 | loss: 0.57474 | train_auc: 0.76768 | train_balanced_accuracy: 0.6941  | train_accuracy: 0.69425 | valid_auc: 0.74502 | valid_balanced_accuracy: 0.68115 | valid_accuracy: 0.6813  |  0:11:12s
epoch 41 | loss: 0.57792 | train_auc: 0.76813 | train_balanced_accuracy: 0.69569 | train_accuracy: 0.69602 | valid_auc: 0.74633 | valid_balanced_accuracy: 0.67827 | valid_accuracy: 0.67863 |  0:11:28s
epoch 42 | loss: 0.57222 | train_auc: 0.77012 | train_balanced_accuracy: 0.69748 | train_accuracy: 0.69799 | valid_auc: 0.74593 | valid_balanced_accuracy: 0.68219 | valid_accuracy: 0.68272 |  0:11:46s
epoch 43 | loss: 0.5765  | train_auc: 0.76426 | train_balanced_accuracy: 0.69405 | train_accuracy: 0.69425 | valid_auc: 0.74806 | valid_balanced_accuracy: 0.68434 | valid_accuracy: 0.68461 |  0:12:03s
epoch 44 | loss: 0.57857 | train_auc: 0.76681 | train_balanced_accuracy: 0.6963  | train_accuracy: 0.69665 | valid_auc: 0.74886 | valid_balanced_accuracy: 0.68485 | valid_accuracy: 0.68524 |  0:12:20s
epoch 45 | loss: 0.57285 | train_auc: 0.766   | train_balanced_accuracy: 0.69146 | train_accuracy: 0.69228 | valid_auc: 0.74805 | valid_balanced_accuracy: 0.68261 | valid_accuracy: 0.68351 |  0:12:36s
epoch 46 | loss: 0.57846 | train_auc: 0.77508 | train_balanced_accuracy: 0.69824 | train_accuracy: 0.6983  | valid_auc: 0.74643 | valid_balanced_accuracy: 0.67695 | valid_accuracy: 0.67705 |  0:12:52s

Early stopping occurred at epoch 46 with best_epoch = 26 and best_valid_accuracy = 0.68524
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 49/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.681 total time=13.0min
[CV 5/5; 49/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70686 | train_auc: 0.52647 | train_balanced_accuracy: 0.52597 | train_accuracy: 0.52664 | valid_auc: 0.52208 | valid_balanced_accuracy: 0.52198 | valid_accuracy: 0.52266 |  0:00:16s
epoch 1  | loss: 0.65533 | train_auc: 0.6095  | train_balanced_accuracy: 0.57546 | train_accuracy: 0.57739 | valid_auc: 0.60076 | valid_balanced_accuracy: 0.57175 | valid_accuracy: 0.57365 |  0:00:33s
epoch 2  | loss: 0.64457 | train_auc: 0.63302 | train_balanced_accuracy: 0.57437 | train_accuracy: 0.57605 | valid_auc: 0.62763 | valid_balanced_accuracy: 0.57131 | valid_accuracy: 0.57302 |  0:00:49s
epoch 3  | loss: 0.63623 | train_auc: 0.64903 | train_balanced_accuracy: 0.59002 | train_accuracy: 0.59167 | valid_auc: 0.6397  | valid_balanced_accuracy: 0.58549 | valid_accuracy: 0.58719 |  0:01:06s
epoch 4  | loss: 0.62185 | train_auc: 0.68786 | train_balanced_accuracy: 0.64129 | train_accuracy: 0.64247 | valid_auc: 0.68375 | valid_balanced_accuracy: 0.64002 | valid_accuracy: 0.64117 |  0:01:23s
epoch 5  | loss: 0.61422 | train_auc: 0.70474 | train_balanced_accuracy: 0.65425 | train_accuracy: 0.65435 | valid_auc: 0.70123 | valid_balanced_accuracy: 0.65271 | valid_accuracy: 0.65282 |  0:01:41s
epoch 6  | loss: 0.61313 | train_auc: 0.70891 | train_balanced_accuracy: 0.64377 | train_accuracy: 0.64511 | valid_auc: 0.7034  | valid_balanced_accuracy: 0.64248 | valid_accuracy: 0.64385 |  0:02:00s
epoch 7  | loss: 0.61043 | train_auc: 0.70663 | train_balanced_accuracy: 0.64913 | train_accuracy: 0.65018 | valid_auc: 0.7031  | valid_balanced_accuracy: 0.64606 | valid_accuracy: 0.64715 |  0:02:19s
epoch 8  | loss: 0.61251 | train_auc: 0.71664 | train_balanced_accuracy: 0.65572 | train_accuracy: 0.65652 | valid_auc: 0.7114  | valid_balanced_accuracy: 0.65321 | valid_accuracy: 0.65408 |  0:02:37s
epoch 9  | loss: 0.60476 | train_auc: 0.72098 | train_balanced_accuracy: 0.66435 | train_accuracy: 0.66501 | valid_auc: 0.71464 | valid_balanced_accuracy: 0.65855 | valid_accuracy: 0.65927 |  0:02:51s
epoch 10 | loss: 0.60071 | train_auc: 0.71816 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.66175 | valid_auc: 0.71299 | valid_balanced_accuracy: 0.65992 | valid_accuracy: 0.66069 |  0:03:07s
epoch 11 | loss: 0.60028 | train_auc: 0.71835 | train_balanced_accuracy: 0.66221 | train_accuracy: 0.66285 | valid_auc: 0.71406 | valid_balanced_accuracy: 0.66036 | valid_accuracy: 0.661   |  0:03:21s
epoch 12 | loss: 0.59934 | train_auc: 0.72177 | train_balanced_accuracy: 0.66489 | train_accuracy: 0.66568 | valid_auc: 0.71982 | valid_balanced_accuracy: 0.66302 | valid_accuracy: 0.66383 |  0:03:38s
epoch 13 | loss: 0.60198 | train_auc: 0.72853 | train_balanced_accuracy: 0.67122 | train_accuracy: 0.67155 | valid_auc: 0.72632 | valid_balanced_accuracy: 0.66237 | valid_accuracy: 0.66273 |  0:03:54s
epoch 14 | loss: 0.59291 | train_auc: 0.72998 | train_balanced_accuracy: 0.67353 | train_accuracy: 0.67387 | valid_auc: 0.72864 | valid_balanced_accuracy: 0.67198 | valid_accuracy: 0.67233 |  0:04:10s
epoch 15 | loss: 0.59168 | train_auc: 0.72679 | train_balanced_accuracy: 0.66755 | train_accuracy: 0.6682  | valid_auc: 0.72703 | valid_balanced_accuracy: 0.66585 | valid_accuracy: 0.66651 |  0:04:26s
epoch 16 | loss: 0.59464 | train_auc: 0.73434 | train_balanced_accuracy: 0.67733 | train_accuracy: 0.67772 | valid_auc: 0.7335  | valid_balanced_accuracy: 0.67619 | valid_accuracy: 0.67658 |  0:04:43s
epoch 17 | loss: 0.59628 | train_auc: 0.73953 | train_balanced_accuracy: 0.67471 | train_accuracy: 0.67536 | valid_auc: 0.7339  | valid_balanced_accuracy: 0.66633 | valid_accuracy: 0.66698 |  0:05:01s
epoch 18 | loss: 0.59076 | train_auc: 0.73912 | train_balanced_accuracy: 0.67077 | train_accuracy: 0.67155 | valid_auc: 0.72943 | valid_balanced_accuracy: 0.66056 | valid_accuracy: 0.66132 |  0:05:17s
epoch 19 | loss: 0.5927  | train_auc: 0.73511 | train_balanced_accuracy: 0.6678  | train_accuracy: 0.66852 | valid_auc: 0.73199 | valid_balanced_accuracy: 0.66659 | valid_accuracy: 0.6673  |  0:05:31s
epoch 20 | loss: 0.5907  | train_auc: 0.74295 | train_balanced_accuracy: 0.67382 | train_accuracy: 0.67446 | valid_auc: 0.73328 | valid_balanced_accuracy: 0.66921 | valid_accuracy: 0.66981 |  0:05:46s
epoch 21 | loss: 0.58653 | train_auc: 0.73938 | train_balanced_accuracy: 0.67641 | train_accuracy: 0.67698 | valid_auc: 0.73602 | valid_balanced_accuracy: 0.67021 | valid_accuracy: 0.67076 |  0:06:02s
epoch 22 | loss: 0.58615 | train_auc: 0.74778 | train_balanced_accuracy: 0.68038 | train_accuracy: 0.68083 | valid_auc: 0.7384  | valid_balanced_accuracy: 0.67378 | valid_accuracy: 0.67422 |  0:06:17s
epoch 23 | loss: 0.58351 | train_auc: 0.74801 | train_balanced_accuracy: 0.67756 | train_accuracy: 0.67816 | valid_auc: 0.74281 | valid_balanced_accuracy: 0.67036 | valid_accuracy: 0.67092 |  0:06:34s
epoch 24 | loss: 0.58928 | train_auc: 0.75643 | train_balanced_accuracy: 0.6892  | train_accuracy: 0.68964 | valid_auc: 0.74493 | valid_balanced_accuracy: 0.67709 | valid_accuracy: 0.67753 |  0:06:48s
epoch 25 | loss: 0.58617 | train_auc: 0.75667 | train_balanced_accuracy: 0.68891 | train_accuracy: 0.68925 | valid_auc: 0.74786 | valid_balanced_accuracy: 0.67988 | valid_accuracy: 0.6802  |  0:07:04s
epoch 26 | loss: 0.58619 | train_auc: 0.75323 | train_balanced_accuracy: 0.68382 | train_accuracy: 0.68441 | valid_auc: 0.74293 | valid_balanced_accuracy: 0.67044 | valid_accuracy: 0.67107 |  0:07:18s
epoch 27 | loss: 0.58507 | train_auc: 0.75733 | train_balanced_accuracy: 0.6879  | train_accuracy: 0.68835 | valid_auc: 0.74937 | valid_balanced_accuracy: 0.68435 | valid_accuracy: 0.68477 |  0:07:34s
epoch 28 | loss: 0.58562 | train_auc: 0.76307 | train_balanced_accuracy: 0.69649 | train_accuracy: 0.69677 | valid_auc: 0.75136 | valid_balanced_accuracy: 0.69109 | valid_accuracy: 0.69138 |  0:07:51s
epoch 29 | loss: 0.58441 | train_auc: 0.7634  | train_balanced_accuracy: 0.69222 | train_accuracy: 0.69248 | valid_auc: 0.74935 | valid_balanced_accuracy: 0.68187 | valid_accuracy: 0.68209 |  0:08:08s
epoch 30 | loss: 0.58573 | train_auc: 0.76577 | train_balanced_accuracy: 0.69503 | train_accuracy: 0.69527 | valid_auc: 0.7513  | valid_balanced_accuracy: 0.69132 | valid_accuracy: 0.69153 |  0:08:24s
epoch 31 | loss: 0.58351 | train_auc: 0.76512 | train_balanced_accuracy: 0.69219 | train_accuracy: 0.69228 | valid_auc: 0.75466 | valid_balanced_accuracy: 0.68724 | valid_accuracy: 0.68728 |  0:08:41s
epoch 32 | loss: 0.5876  | train_auc: 0.74847 | train_balanced_accuracy: 0.68252 | train_accuracy: 0.68268 | valid_auc: 0.73572 | valid_balanced_accuracy: 0.6755  | valid_accuracy: 0.67564 |  0:08:58s
epoch 33 | loss: 0.58852 | train_auc: 0.76432 | train_balanced_accuracy: 0.69158 | train_accuracy: 0.69228 | valid_auc: 0.74757 | valid_balanced_accuracy: 0.67681 | valid_accuracy: 0.67753 |  0:09:15s
epoch 34 | loss: 0.57921 | train_auc: 0.76939 | train_balanced_accuracy: 0.69688 | train_accuracy: 0.69708 | valid_auc: 0.75733 | valid_balanced_accuracy: 0.68961 | valid_accuracy: 0.6898  |  0:09:31s
epoch 35 | loss: 0.57694 | train_auc: 0.76856 | train_balanced_accuracy: 0.69412 | train_accuracy: 0.69425 | valid_auc: 0.75202 | valid_balanced_accuracy: 0.68516 | valid_accuracy: 0.68524 |  0:09:45s
epoch 36 | loss: 0.5721  | train_auc: 0.76949 | train_balanced_accuracy: 0.69701 | train_accuracy: 0.69681 | valid_auc: 0.75748 | valid_balanced_accuracy: 0.68687 | valid_accuracy: 0.68665 |  0:10:00s
epoch 37 | loss: 0.57698 | train_auc: 0.76845 | train_balanced_accuracy: 0.6987  | train_accuracy: 0.69897 | valid_auc: 0.75495 | valid_balanced_accuracy: 0.68877 | valid_accuracy: 0.68901 |  0:10:16s
epoch 38 | loss: 0.57553 | train_auc: 0.7657  | train_balanced_accuracy: 0.69235 | train_accuracy: 0.69201 | valid_auc: 0.75044 | valid_balanced_accuracy: 0.68226 | valid_accuracy: 0.68193 |  0:10:31s
epoch 39 | loss: 0.57932 | train_auc: 0.77241 | train_balanced_accuracy: 0.69758 | train_accuracy: 0.69802 | valid_auc: 0.75833 | valid_balanced_accuracy: 0.69486 | valid_accuracy: 0.69531 |  0:10:47s
epoch 40 | loss: 0.57503 | train_auc: 0.77104 | train_balanced_accuracy: 0.69898 | train_accuracy: 0.69905 | valid_auc: 0.75413 | valid_balanced_accuracy: 0.6885  | valid_accuracy: 0.68854 |  0:11:04s
epoch 41 | loss: 0.57482 | train_auc: 0.7689  | train_balanced_accuracy: 0.6989  | train_accuracy: 0.69932 | valid_auc: 0.75493 | valid_balanced_accuracy: 0.68701 | valid_accuracy: 0.68744 |  0:11:19s
epoch 42 | loss: 0.57591 | train_auc: 0.77114 | train_balanced_accuracy: 0.69596 | train_accuracy: 0.69653 | valid_auc: 0.75613 | valid_balanced_accuracy: 0.68732 | valid_accuracy: 0.68791 |  0:11:36s
epoch 43 | loss: 0.57186 | train_auc: 0.77783 | train_balanced_accuracy: 0.70451 | train_accuracy: 0.70483 | valid_auc: 0.75838 | valid_balanced_accuracy: 0.69264 | valid_accuracy: 0.69295 |  0:11:52s
epoch 44 | loss: 0.57093 | train_auc: 0.77367 | train_balanced_accuracy: 0.70365 | train_accuracy: 0.70397 | valid_auc: 0.75307 | valid_balanced_accuracy: 0.68774 | valid_accuracy: 0.68807 |  0:12:09s
epoch 45 | loss: 0.57389 | train_auc: 0.76552 | train_balanced_accuracy: 0.69409 | train_accuracy: 0.69456 | valid_auc: 0.75188 | valid_balanced_accuracy: 0.68447 | valid_accuracy: 0.68492 |  0:12:26s
epoch 46 | loss: 0.57928 | train_auc: 0.64011 | train_balanced_accuracy: 0.59054 | train_accuracy: 0.58986 | valid_auc: 0.63987 | valid_balanced_accuracy: 0.58849 | valid_accuracy: 0.58782 |  0:12:43s
epoch 47 | loss: 0.57327 | train_auc: 0.66061 | train_balanced_accuracy: 0.61365 | train_accuracy: 0.61453 | valid_auc: 0.66208 | valid_balanced_accuracy: 0.61857 | valid_accuracy: 0.61945 |  0:12:59s
epoch 48 | loss: 0.5709  | train_auc: 0.73704 | train_balanced_accuracy: 0.67468 | train_accuracy: 0.67524 | valid_auc: 0.729   | valid_balanced_accuracy: 0.66676 | valid_accuracy: 0.6673  |  0:13:15s
epoch 49 | loss: 0.56672 | train_auc: 0.76355 | train_balanced_accuracy: 0.69129 | train_accuracy: 0.69189 | valid_auc: 0.74374 | valid_balanced_accuracy: 0.67208 | valid_accuracy: 0.67265 |  0:13:30s
epoch 50 | loss: 0.56913 | train_auc: 0.77544 | train_balanced_accuracy: 0.70218 | train_accuracy: 0.70243 | valid_auc: 0.75939 | valid_balanced_accuracy: 0.69068 | valid_accuracy: 0.6909  |  0:13:45s
epoch 51 | loss: 0.56813 | train_auc: 0.77433 | train_balanced_accuracy: 0.70424 | train_accuracy: 0.70463 | valid_auc: 0.75313 | valid_balanced_accuracy: 0.68656 | valid_accuracy: 0.68697 |  0:14:01s
epoch 52 | loss: 0.56797 | train_auc: 0.77686 | train_balanced_accuracy: 0.70441 | train_accuracy: 0.70452 | valid_auc: 0.75913 | valid_balanced_accuracy: 0.68511 | valid_accuracy: 0.68524 |  0:14:19s
epoch 53 | loss: 0.57678 | train_auc: 0.77897 | train_balanced_accuracy: 0.70303 | train_accuracy: 0.70342 | valid_auc: 0.76046 | valid_balanced_accuracy: 0.69098 | valid_accuracy: 0.69138 |  0:14:34s
epoch 54 | loss: 0.56986 | train_auc: 0.78308 | train_balanced_accuracy: 0.70608 | train_accuracy: 0.70656 | valid_auc: 0.76253 | valid_balanced_accuracy: 0.68947 | valid_accuracy: 0.68996 |  0:14:51s
epoch 55 | loss: 0.57096 | train_auc: 0.78004 | train_balanced_accuracy: 0.70539 | train_accuracy: 0.70542 | valid_auc: 0.7628  | valid_balanced_accuracy: 0.68944 | valid_accuracy: 0.68949 |  0:15:06s
epoch 56 | loss: 0.57262 | train_auc: 0.77647 | train_balanced_accuracy: 0.70543 | train_accuracy: 0.70538 | valid_auc: 0.75689 | valid_balanced_accuracy: 0.68311 | valid_accuracy: 0.68303 |  0:15:22s
epoch 57 | loss: 0.57163 | train_auc: 0.7594  | train_balanced_accuracy: 0.69269 | train_accuracy: 0.69287 | valid_auc: 0.74496 | valid_balanced_accuracy: 0.67577 | valid_accuracy: 0.67595 |  0:15:38s
epoch 58 | loss: 0.58089 | train_auc: 0.75704 | train_balanced_accuracy: 0.68223 | train_accuracy: 0.68197 | valid_auc: 0.74294 | valid_balanced_accuracy: 0.67636 | valid_accuracy: 0.67611 |  0:15:55s
epoch 59 | loss: 0.57753 | train_auc: 0.76073 | train_balanced_accuracy: 0.68888 | train_accuracy: 0.68941 | valid_auc: 0.74885 | valid_balanced_accuracy: 0.67759 | valid_accuracy: 0.67816 |  0:16:12s

Early stopping occurred at epoch 59 with best_epoch = 39 and best_valid_accuracy = 0.69531
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 49/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=16.3min
[CV 1/5; 50/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71515 | train_auc: 0.55354 | train_balanced_accuracy: 0.53218 | train_accuracy: 0.53036 | valid_auc: 0.55923 | valid_balanced_accuracy: 0.52712 | valid_accuracy: 0.52518 |  0:00:15s
epoch 1  | loss: 0.65681 | train_auc: 0.56039 | train_balanced_accuracy: 0.5284  | train_accuracy: 0.52615 | valid_auc: 0.56055 | valid_balanced_accuracy: 0.52688 | valid_accuracy: 0.52455 |  0:00:31s
epoch 2  | loss: 0.64269 | train_auc: 0.6399  | train_balanced_accuracy: 0.53366 | train_accuracy: 0.53114 | valid_auc: 0.6442  | valid_balanced_accuracy: 0.53724 | valid_accuracy: 0.53462 |  0:00:46s
epoch 3  | loss: 0.63264 | train_auc: 0.65206 | train_balanced_accuracy: 0.54094 | train_accuracy: 0.5383  | valid_auc: 0.65509 | valid_balanced_accuracy: 0.53984 | valid_accuracy: 0.53714 |  0:01:02s
epoch 4  | loss: 0.62125 | train_auc: 0.66831 | train_balanced_accuracy: 0.58819 | train_accuracy: 0.58658 | valid_auc: 0.67067 | valid_balanced_accuracy: 0.59007 | valid_accuracy: 0.58845 |  0:01:17s
epoch 5  | loss: 0.61887 | train_auc: 0.67153 | train_balanced_accuracy: 0.60045 | train_accuracy: 0.59917 | valid_auc: 0.67574 | valid_balanced_accuracy: 0.60309 | valid_accuracy: 0.60183 |  0:01:34s
epoch 6  | loss: 0.61729 | train_auc: 0.6796  | train_balanced_accuracy: 0.61378 | train_accuracy: 0.61283 | valid_auc: 0.68057 | valid_balanced_accuracy: 0.6185  | valid_accuracy: 0.61756 |  0:01:50s
epoch 7  | loss: 0.61434 | train_auc: 0.68807 | train_balanced_accuracy: 0.62195 | train_accuracy: 0.62129 | valid_auc: 0.68832 | valid_balanced_accuracy: 0.62295 | valid_accuracy: 0.62229 |  0:02:05s
epoch 8  | loss: 0.6073  | train_auc: 0.68973 | train_balanced_accuracy: 0.62894 | train_accuracy: 0.62876 | valid_auc: 0.69005 | valid_balanced_accuracy: 0.62938 | valid_accuracy: 0.62921 |  0:02:21s
epoch 9  | loss: 0.61271 | train_auc: 0.69311 | train_balanced_accuracy: 0.62156 | train_accuracy: 0.62058 | valid_auc: 0.69479 | valid_balanced_accuracy: 0.61655 | valid_accuracy: 0.61552 |  0:02:38s
epoch 10 | loss: 0.60388 | train_auc: 0.69507 | train_balanced_accuracy: 0.63167 | train_accuracy: 0.63156 | valid_auc: 0.69794 | valid_balanced_accuracy: 0.63326 | valid_accuracy: 0.63314 |  0:02:56s
epoch 11 | loss: 0.60453 | train_auc: 0.70918 | train_balanced_accuracy: 0.65638 | train_accuracy: 0.65701 | valid_auc: 0.70732 | valid_balanced_accuracy: 0.65024 | valid_accuracy: 0.65093 |  0:03:12s
epoch 12 | loss: 0.60336 | train_auc: 0.70878 | train_balanced_accuracy: 0.65202 | train_accuracy: 0.65257 | valid_auc: 0.70897 | valid_balanced_accuracy: 0.65257 | valid_accuracy: 0.65313 |  0:03:28s
epoch 13 | loss: 0.60441 | train_auc: 0.71129 | train_balanced_accuracy: 0.65079 | train_accuracy: 0.65127 | valid_auc: 0.71044 | valid_balanced_accuracy: 0.65167 | valid_accuracy: 0.65219 |  0:03:45s
epoch 14 | loss: 0.60154 | train_auc: 0.717   | train_balanced_accuracy: 0.65949 | train_accuracy: 0.6602  | valid_auc: 0.71021 | valid_balanced_accuracy: 0.65838 | valid_accuracy: 0.65911 |  0:04:01s
epoch 15 | loss: 0.60013 | train_auc: 0.72554 | train_balanced_accuracy: 0.66538 | train_accuracy: 0.66595 | valid_auc: 0.71558 | valid_balanced_accuracy: 0.65806 | valid_accuracy: 0.65864 |  0:04:16s
epoch 16 | loss: 0.59778 | train_auc: 0.72929 | train_balanced_accuracy: 0.66667 | train_accuracy: 0.66724 | valid_auc: 0.71855 | valid_balanced_accuracy: 0.66295 | valid_accuracy: 0.66352 |  0:04:31s
epoch 17 | loss: 0.59821 | train_auc: 0.72276 | train_balanced_accuracy: 0.66462 | train_accuracy: 0.66528 | valid_auc: 0.71485 | valid_balanced_accuracy: 0.66091 | valid_accuracy: 0.66163 |  0:04:49s
epoch 18 | loss: 0.59694 | train_auc: 0.72869 | train_balanced_accuracy: 0.67185 | train_accuracy: 0.6724  | valid_auc: 0.71822 | valid_balanced_accuracy: 0.6637  | valid_accuracy: 0.66431 |  0:05:08s
epoch 19 | loss: 0.59905 | train_auc: 0.73969 | train_balanced_accuracy: 0.67765 | train_accuracy: 0.67838 | valid_auc: 0.72724 | valid_balanced_accuracy: 0.67285 | valid_accuracy: 0.67359 |  0:05:24s
epoch 20 | loss: 0.59431 | train_auc: 0.7378  | train_balanced_accuracy: 0.67674 | train_accuracy: 0.6774  | valid_auc: 0.72779 | valid_balanced_accuracy: 0.66663 | valid_accuracy: 0.6673  |  0:05:39s
epoch 21 | loss: 0.5955  | train_auc: 0.7396  | train_balanced_accuracy: 0.67536 | train_accuracy: 0.67598 | valid_auc: 0.72787 | valid_balanced_accuracy: 0.66948 | valid_accuracy: 0.67013 |  0:05:55s
epoch 22 | loss: 0.59587 | train_auc: 0.74081 | train_balanced_accuracy: 0.67886 | train_accuracy: 0.6794  | valid_auc: 0.72572 | valid_balanced_accuracy: 0.66913 | valid_accuracy: 0.66966 |  0:06:10s
epoch 23 | loss: 0.59176 | train_auc: 0.74632 | train_balanced_accuracy: 0.68108 | train_accuracy: 0.68157 | valid_auc: 0.73222 | valid_balanced_accuracy: 0.67405 | valid_accuracy: 0.67454 |  0:06:28s
epoch 24 | loss: 0.59814 | train_auc: 0.74461 | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67716 | valid_auc: 0.73063 | valid_balanced_accuracy: 0.67014 | valid_accuracy: 0.6706  |  0:06:46s
epoch 25 | loss: 0.58782 | train_auc: 0.75423 | train_balanced_accuracy: 0.68756 | train_accuracy: 0.68782 | valid_auc: 0.73916 | valid_balanced_accuracy: 0.67741 | valid_accuracy: 0.67768 |  0:07:03s
epoch 26 | loss: 0.59047 | train_auc: 0.74692 | train_balanced_accuracy: 0.6832  | train_accuracy: 0.68361 | valid_auc: 0.73353 | valid_balanced_accuracy: 0.6708  | valid_accuracy: 0.67123 |  0:07:20s
epoch 27 | loss: 0.59331 | train_auc: 0.75402 | train_balanced_accuracy: 0.6887  | train_accuracy: 0.68892 | valid_auc: 0.73907 | valid_balanced_accuracy: 0.67226 | valid_accuracy: 0.67249 |  0:07:37s
epoch 28 | loss: 0.59213 | train_auc: 0.75547 | train_balanced_accuracy: 0.69047 | train_accuracy: 0.69085 | valid_auc: 0.74096 | valid_balanced_accuracy: 0.68015 | valid_accuracy: 0.68052 |  0:07:56s
epoch 29 | loss: 0.58497 | train_auc: 0.75875 | train_balanced_accuracy: 0.691   | train_accuracy: 0.69109 | valid_auc: 0.74339 | valid_balanced_accuracy: 0.67962 | valid_accuracy: 0.67973 |  0:08:12s
epoch 30 | loss: 0.58847 | train_auc: 0.75335 | train_balanced_accuracy: 0.68625 | train_accuracy: 0.68656 | valid_auc: 0.73981 | valid_balanced_accuracy: 0.67392 | valid_accuracy: 0.67422 |  0:08:29s
epoch 31 | loss: 0.58676 | train_auc: 0.75121 | train_balanced_accuracy: 0.68623 | train_accuracy: 0.68664 | valid_auc: 0.73768 | valid_balanced_accuracy: 0.6732  | valid_accuracy: 0.67359 |  0:08:47s
epoch 32 | loss: 0.59161 | train_auc: 0.75792 | train_balanced_accuracy: 0.69069 | train_accuracy: 0.69073 | valid_auc: 0.74275 | valid_balanced_accuracy: 0.67402 | valid_accuracy: 0.67406 |  0:09:02s
epoch 33 | loss: 0.59082 | train_auc: 0.75446 | train_balanced_accuracy: 0.68923 | train_accuracy: 0.68955 | valid_auc: 0.73799 | valid_balanced_accuracy: 0.67706 | valid_accuracy: 0.67737 |  0:09:18s
epoch 34 | loss: 0.58484 | train_auc: 0.75568 | train_balanced_accuracy: 0.68834 | train_accuracy: 0.68873 | valid_auc: 0.74148 | valid_balanced_accuracy: 0.68025 | valid_accuracy: 0.68067 |  0:09:35s
epoch 35 | loss: 0.58697 | train_auc: 0.75868 | train_balanced_accuracy: 0.69188 | train_accuracy: 0.69227 | valid_auc: 0.74345 | valid_balanced_accuracy: 0.68612 | valid_accuracy: 0.6865  |  0:09:52s
epoch 36 | loss: 0.58464 | train_auc: 0.76    | train_balanced_accuracy: 0.69058 | train_accuracy: 0.69042 | valid_auc: 0.74398 | valid_balanced_accuracy: 0.67943 | valid_accuracy: 0.67926 |  0:10:09s
epoch 37 | loss: 0.58431 | train_auc: 0.75023 | train_balanced_accuracy: 0.68758 | train_accuracy: 0.68798 | valid_auc: 0.74155 | valid_balanced_accuracy: 0.67903 | valid_accuracy: 0.67941 |  0:10:24s
epoch 38 | loss: 0.57827 | train_auc: 0.75888 | train_balanced_accuracy: 0.68923 | train_accuracy: 0.68904 | valid_auc: 0.7459  | valid_balanced_accuracy: 0.67866 | valid_accuracy: 0.67847 |  0:10:41s
epoch 39 | loss: 0.58178 | train_auc: 0.76299 | train_balanced_accuracy: 0.69242 | train_accuracy: 0.69243 | valid_auc: 0.74459 | valid_balanced_accuracy: 0.67798 | valid_accuracy: 0.678   |  0:10:57s
epoch 40 | loss: 0.58315 | train_auc: 0.76597 | train_balanced_accuracy: 0.69775 | train_accuracy: 0.69778 | valid_auc: 0.74786 | valid_balanced_accuracy: 0.68302 | valid_accuracy: 0.68303 |  0:11:14s
epoch 41 | loss: 0.58217 | train_auc: 0.76108 | train_balanced_accuracy: 0.69161 | train_accuracy: 0.69148 | valid_auc: 0.74444 | valid_balanced_accuracy: 0.67989 | valid_accuracy: 0.67973 |  0:11:29s
epoch 42 | loss: 0.58212 | train_auc: 0.75698 | train_balanced_accuracy: 0.69489 | train_accuracy: 0.69522 | valid_auc: 0.7429  | valid_balanced_accuracy: 0.68603 | valid_accuracy: 0.68634 |  0:11:46s
epoch 43 | loss: 0.58595 | train_auc: 0.75517 | train_balanced_accuracy: 0.68437 | train_accuracy: 0.6844  | valid_auc: 0.7439  | valid_balanced_accuracy: 0.67564 | valid_accuracy: 0.67564 |  0:12:04s
epoch 44 | loss: 0.57931 | train_auc: 0.75925 | train_balanced_accuracy: 0.69206 | train_accuracy: 0.69211 | valid_auc: 0.74585 | valid_balanced_accuracy: 0.67968 | valid_accuracy: 0.67973 |  0:12:20s
epoch 45 | loss: 0.57973 | train_auc: 0.7664  | train_balanced_accuracy: 0.69745 | train_accuracy: 0.69782 | valid_auc: 0.74593 | valid_balanced_accuracy: 0.68379 | valid_accuracy: 0.68414 |  0:12:34s
epoch 46 | loss: 0.57756 | train_auc: 0.76562 | train_balanced_accuracy: 0.69729 | train_accuracy: 0.69727 | valid_auc: 0.74589 | valid_balanced_accuracy: 0.68137 | valid_accuracy: 0.6813  |  0:12:52s
epoch 47 | loss: 0.57936 | train_auc: 0.76952 | train_balanced_accuracy: 0.69801 | train_accuracy: 0.69845 | valid_auc: 0.74593 | valid_balanced_accuracy: 0.67883 | valid_accuracy: 0.67926 |  0:13:10s
epoch 48 | loss: 0.57335 | train_auc: 0.76757 | train_balanced_accuracy: 0.69556 | train_accuracy: 0.69569 | valid_auc: 0.75218 | valid_balanced_accuracy: 0.68668 | valid_accuracy: 0.68681 |  0:13:26s
epoch 49 | loss: 0.57989 | train_auc: 0.77055 | train_balanced_accuracy: 0.69792 | train_accuracy: 0.69825 | valid_auc: 0.75295 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69075 |  0:13:43s
epoch 50 | loss: 0.57591 | train_auc: 0.76674 | train_balanced_accuracy: 0.69956 | train_accuracy: 0.69967 | valid_auc: 0.74894 | valid_balanced_accuracy: 0.68354 | valid_accuracy: 0.68366 |  0:14:00s
epoch 51 | loss: 0.57276 | train_auc: 0.76693 | train_balanced_accuracy: 0.69673 | train_accuracy: 0.69723 | valid_auc: 0.74738 | valid_balanced_accuracy: 0.68554 | valid_accuracy: 0.68602 |  0:14:16s
epoch 52 | loss: 0.57512 | train_auc: 0.76114 | train_balanced_accuracy: 0.69313 | train_accuracy: 0.69341 | valid_auc: 0.74303 | valid_balanced_accuracy: 0.68263 | valid_accuracy: 0.68288 |  0:14:33s
epoch 53 | loss: 0.5796  | train_auc: 0.76649 | train_balanced_accuracy: 0.69661 | train_accuracy: 0.69707 | valid_auc: 0.74849 | valid_balanced_accuracy: 0.68539 | valid_accuracy: 0.68587 |  0:14:50s
epoch 54 | loss: 0.57129 | train_auc: 0.76565 | train_balanced_accuracy: 0.69459 | train_accuracy: 0.69479 | valid_auc: 0.74929 | valid_balanced_accuracy: 0.6849  | valid_accuracy: 0.68508 |  0:15:06s
epoch 55 | loss: 0.5764  | train_auc: 0.77128 | train_balanced_accuracy: 0.70021 | train_accuracy: 0.7003  | valid_auc: 0.75119 | valid_balanced_accuracy: 0.68598 | valid_accuracy: 0.68602 |  0:15:22s
epoch 56 | loss: 0.5709  | train_auc: 0.77605 | train_balanced_accuracy: 0.70341 | train_accuracy: 0.7036  | valid_auc: 0.75263 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68571 |  0:15:39s
epoch 57 | loss: 0.57301 | train_auc: 0.77533 | train_balanced_accuracy: 0.70416 | train_accuracy: 0.70423 | valid_auc: 0.74859 | valid_balanced_accuracy: 0.67969 | valid_accuracy: 0.67973 |  0:15:54s
epoch 58 | loss: 0.5747  | train_auc: 0.77308 | train_balanced_accuracy: 0.70056 | train_accuracy: 0.70077 | valid_auc: 0.74718 | valid_balanced_accuracy: 0.67956 | valid_accuracy: 0.67973 |  0:16:11s
epoch 59 | loss: 0.57385 | train_auc: 0.77147 | train_balanced_accuracy: 0.69937 | train_accuracy: 0.69923 | valid_auc: 0.74996 | valid_balanced_accuracy: 0.68316 | valid_accuracy: 0.68303 |  0:16:28s
epoch 60 | loss: 0.5735  | train_auc: 0.77758 | train_balanced_accuracy: 0.70579 | train_accuracy: 0.70584 | valid_auc: 0.75356 | valid_balanced_accuracy: 0.68708 | valid_accuracy: 0.68713 |  0:16:43s
epoch 61 | loss: 0.57091 | train_auc: 0.77428 | train_balanced_accuracy: 0.70282 | train_accuracy: 0.70301 | valid_auc: 0.75119 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.6854  |  0:16:59s
epoch 62 | loss: 0.56677 | train_auc: 0.77557 | train_balanced_accuracy: 0.70337 | train_accuracy: 0.70329 | valid_auc: 0.75286 | valid_balanced_accuracy: 0.6834  | valid_accuracy: 0.68335 |  0:17:17s
epoch 63 | loss: 0.57129 | train_auc: 0.77954 | train_balanced_accuracy: 0.70736 | train_accuracy: 0.70742 | valid_auc: 0.75286 | valid_balanced_accuracy: 0.68598 | valid_accuracy: 0.68602 |  0:17:32s
epoch 64 | loss: 0.56887 | train_auc: 0.77902 | train_balanced_accuracy: 0.70481 | train_accuracy: 0.7047  | valid_auc: 0.75301 | valid_balanced_accuracy: 0.68704 | valid_accuracy: 0.68697 |  0:17:50s
epoch 65 | loss: 0.56721 | train_auc: 0.77895 | train_balanced_accuracy: 0.70883 | train_accuracy: 0.70899 | valid_auc: 0.75503 | valid_balanced_accuracy: 0.68619 | valid_accuracy: 0.68634 |  0:18:08s
epoch 66 | loss: 0.56928 | train_auc: 0.77841 | train_balanced_accuracy: 0.70724 | train_accuracy: 0.70734 | valid_auc: 0.7565  | valid_balanced_accuracy: 0.68737 | valid_accuracy: 0.68744 |  0:18:26s
epoch 67 | loss: 0.56793 | train_auc: 0.7819  | train_balanced_accuracy: 0.70981 | train_accuracy: 0.70997 | valid_auc: 0.757   | valid_balanced_accuracy: 0.69046 | valid_accuracy: 0.69059 |  0:18:43s
epoch 68 | loss: 0.56818 | train_auc: 0.77528 | train_balanced_accuracy: 0.704   | train_accuracy: 0.70435 | valid_auc: 0.74689 | valid_balanced_accuracy: 0.68081 | valid_accuracy: 0.68115 |  0:19:00s
epoch 69 | loss: 0.5687  | train_auc: 0.76822 | train_balanced_accuracy: 0.69788 | train_accuracy: 0.69837 | valid_auc: 0.74195 | valid_balanced_accuracy: 0.67454 | valid_accuracy: 0.67501 |  0:19:16s

Early stopping occurred at epoch 69 with best_epoch = 49 and best_valid_accuracy = 0.69075
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 50/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=19.4min
[CV 2/5; 50/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71088 | train_auc: 0.56908 | train_balanced_accuracy: 0.53435 | train_accuracy: 0.53228 | valid_auc: 0.57759 | valid_balanced_accuracy: 0.53819 | valid_accuracy: 0.53604 |  0:00:17s
epoch 1  | loss: 0.65897 | train_auc: 0.59469 | train_balanced_accuracy: 0.51833 | train_accuracy: 0.51521 | valid_auc: 0.60225 | valid_balanced_accuracy: 0.51748 | valid_accuracy: 0.51432 |  0:00:34s
epoch 2  | loss: 0.6411  | train_auc: 0.64137 | train_balanced_accuracy: 0.53151 | train_accuracy: 0.52851 | valid_auc: 0.64064 | valid_balanced_accuracy: 0.52838 | valid_accuracy: 0.52534 |  0:00:50s
epoch 3  | loss: 0.63353 | train_auc: 0.63931 | train_balanced_accuracy: 0.53714 | train_accuracy: 0.53425 | valid_auc: 0.64172 | valid_balanced_accuracy: 0.54131 | valid_accuracy: 0.5384  |  0:01:07s
epoch 4  | loss: 0.62579 | train_auc: 0.65643 | train_balanced_accuracy: 0.54654 | train_accuracy: 0.54369 | valid_auc: 0.66042 | valid_balanced_accuracy: 0.5449  | valid_accuracy: 0.54202 |  0:01:24s
epoch 5  | loss: 0.62251 | train_auc: 0.66829 | train_balanced_accuracy: 0.56454 | train_accuracy: 0.56219 | valid_auc: 0.67075 | valid_balanced_accuracy: 0.56029 | valid_accuracy: 0.55792 |  0:01:40s
epoch 6  | loss: 0.61844 | train_auc: 0.68177 | train_balanced_accuracy: 0.57859 | train_accuracy: 0.57667 | valid_auc: 0.68726 | valid_balanced_accuracy: 0.58144 | valid_accuracy: 0.57948 |  0:01:58s
epoch 7  | loss: 0.61479 | train_auc: 0.68535 | train_balanced_accuracy: 0.59641 | train_accuracy: 0.59473 | valid_auc: 0.68937 | valid_balanced_accuracy: 0.58913 | valid_accuracy: 0.58735 |  0:02:15s
epoch 8  | loss: 0.60412 | train_auc: 0.69218 | train_balanced_accuracy: 0.62516 | train_accuracy: 0.62428 | valid_auc: 0.69643 | valid_balanced_accuracy: 0.62557 | valid_accuracy: 0.62465 |  0:02:32s
epoch 9  | loss: 0.61013 | train_auc: 0.69482 | train_balanced_accuracy: 0.58693 | train_accuracy: 0.58489 | valid_auc: 0.69132 | valid_balanced_accuracy: 0.575   | valid_accuracy: 0.57287 |  0:02:49s
epoch 10 | loss: 0.6018  | train_auc: 0.70456 | train_balanced_accuracy: 0.62896 | train_accuracy: 0.62786 | valid_auc: 0.70111 | valid_balanced_accuracy: 0.62312 | valid_accuracy: 0.62197 |  0:03:04s
epoch 11 | loss: 0.60544 | train_auc: 0.71402 | train_balanced_accuracy: 0.64651 | train_accuracy: 0.6458  | valid_auc: 0.7117  | valid_balanced_accuracy: 0.64206 | valid_accuracy: 0.64133 |  0:03:21s
epoch 12 | loss: 0.60376 | train_auc: 0.71485 | train_balanced_accuracy: 0.65218 | train_accuracy: 0.65178 | valid_auc: 0.71158 | valid_balanced_accuracy: 0.64834 | valid_accuracy: 0.64794 |  0:03:37s
epoch 13 | loss: 0.59889 | train_auc: 0.72033 | train_balanced_accuracy: 0.66189 | train_accuracy: 0.66201 | valid_auc: 0.71527 | valid_balanced_accuracy: 0.65943 | valid_accuracy: 0.65958 |  0:03:55s
epoch 14 | loss: 0.59892 | train_auc: 0.72247 | train_balanced_accuracy: 0.66309 | train_accuracy: 0.66315 | valid_auc: 0.71767 | valid_balanced_accuracy: 0.66342 | valid_accuracy: 0.66352 |  0:04:11s
epoch 15 | loss: 0.59774 | train_auc: 0.72279 | train_balanced_accuracy: 0.6605  | train_accuracy: 0.66036 | valid_auc: 0.71924 | valid_balanced_accuracy: 0.66317 | valid_accuracy: 0.66305 |  0:04:28s
epoch 16 | loss: 0.596   | train_auc: 0.72102 | train_balanced_accuracy: 0.65953 | train_accuracy: 0.65969 | valid_auc: 0.71978 | valid_balanced_accuracy: 0.66414 | valid_accuracy: 0.66431 |  0:04:43s
epoch 17 | loss: 0.5959  | train_auc: 0.72327 | train_balanced_accuracy: 0.65696 | train_accuracy: 0.65678 | valid_auc: 0.71877 | valid_balanced_accuracy: 0.65176 | valid_accuracy: 0.65156 |  0:05:01s
epoch 18 | loss: 0.59622 | train_auc: 0.72884 | train_balanced_accuracy: 0.66736 | train_accuracy: 0.66776 | valid_auc: 0.72513 | valid_balanced_accuracy: 0.6631  | valid_accuracy: 0.66352 |  0:05:17s
epoch 19 | loss: 0.59507 | train_auc: 0.72445 | train_balanced_accuracy: 0.65769 | train_accuracy: 0.65772 | valid_auc: 0.72251 | valid_balanced_accuracy: 0.65595 | valid_accuracy: 0.65596 |  0:05:33s
epoch 20 | loss: 0.59314 | train_auc: 0.71808 | train_balanced_accuracy: 0.6529  | train_accuracy: 0.65284 | valid_auc: 0.71821 | valid_balanced_accuracy: 0.65087 | valid_accuracy: 0.65077 |  0:05:48s
epoch 21 | loss: 0.59473 | train_auc: 0.72681 | train_balanced_accuracy: 0.66325 | train_accuracy: 0.66358 | valid_auc: 0.72525 | valid_balanced_accuracy: 0.65973 | valid_accuracy: 0.66006 |  0:06:05s
epoch 22 | loss: 0.59706 | train_auc: 0.74122 | train_balanced_accuracy: 0.67903 | train_accuracy: 0.67924 | valid_auc: 0.73554 | valid_balanced_accuracy: 0.67478 | valid_accuracy: 0.67501 |  0:06:22s
epoch 23 | loss: 0.59007 | train_auc: 0.73076 | train_balanced_accuracy: 0.67092 | train_accuracy: 0.67141 | valid_auc: 0.72673 | valid_balanced_accuracy: 0.66854 | valid_accuracy: 0.66903 |  0:06:39s
epoch 24 | loss: 0.59458 | train_auc: 0.74229 | train_balanced_accuracy: 0.6756  | train_accuracy: 0.67594 | valid_auc: 0.73651 | valid_balanced_accuracy: 0.67281 | valid_accuracy: 0.67312 |  0:06:55s
epoch 25 | loss: 0.58569 | train_auc: 0.75777 | train_balanced_accuracy: 0.68879 | train_accuracy: 0.68869 | valid_auc: 0.74632 | valid_balanced_accuracy: 0.68035 | valid_accuracy: 0.6802  |  0:07:12s
epoch 26 | loss: 0.58702 | train_auc: 0.75607 | train_balanced_accuracy: 0.68857 | train_accuracy: 0.68888 | valid_auc: 0.74642 | valid_balanced_accuracy: 0.68791 | valid_accuracy: 0.68823 |  0:07:29s
epoch 27 | loss: 0.59153 | train_auc: 0.75686 | train_balanced_accuracy: 0.68662 | train_accuracy: 0.68684 | valid_auc: 0.74396 | valid_balanced_accuracy: 0.68489 | valid_accuracy: 0.68508 |  0:07:44s
epoch 28 | loss: 0.58584 | train_auc: 0.76041 | train_balanced_accuracy: 0.69001 | train_accuracy: 0.69066 | valid_auc: 0.74785 | valid_balanced_accuracy: 0.68698 | valid_accuracy: 0.6876  |  0:08:01s
epoch 29 | loss: 0.58724 | train_auc: 0.76117 | train_balanced_accuracy: 0.69175 | train_accuracy: 0.69184 | valid_auc: 0.74838 | valid_balanced_accuracy: 0.68517 | valid_accuracy: 0.68524 |  0:08:18s
epoch 30 | loss: 0.58327 | train_auc: 0.76031 | train_balanced_accuracy: 0.6931  | train_accuracy: 0.69341 | valid_auc: 0.74663 | valid_balanced_accuracy: 0.68151 | valid_accuracy: 0.68178 |  0:08:33s
epoch 31 | loss: 0.5896  | train_auc: 0.76054 | train_balanced_accuracy: 0.69122 | train_accuracy: 0.6914  | valid_auc: 0.74656 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68382 |  0:08:50s
epoch 32 | loss: 0.58634 | train_auc: 0.76199 | train_balanced_accuracy: 0.69403 | train_accuracy: 0.69431 | valid_auc: 0.74701 | valid_balanced_accuracy: 0.6875  | valid_accuracy: 0.68776 |  0:09:07s
epoch 33 | loss: 0.58466 | train_auc: 0.76036 | train_balanced_accuracy: 0.69349 | train_accuracy: 0.69368 | valid_auc: 0.74479 | valid_balanced_accuracy: 0.68574 | valid_accuracy: 0.68587 |  0:09:24s
epoch 34 | loss: 0.58066 | train_auc: 0.71769 | train_balanced_accuracy: 0.66702 | train_accuracy: 0.66764 | valid_auc: 0.71419 | valid_balanced_accuracy: 0.66371 | valid_accuracy: 0.66431 |  0:09:42s
epoch 35 | loss: 0.58133 | train_auc: 0.7407  | train_balanced_accuracy: 0.67804 | train_accuracy: 0.67858 | valid_auc: 0.73252 | valid_balanced_accuracy: 0.66897 | valid_accuracy: 0.6695  |  0:09:58s
epoch 36 | loss: 0.57954 | train_auc: 0.73361 | train_balanced_accuracy: 0.66589 | train_accuracy: 0.66571 | valid_auc: 0.72394 | valid_balanced_accuracy: 0.65313 | valid_accuracy: 0.65297 |  0:10:15s
epoch 37 | loss: 0.58302 | train_auc: 0.74097 | train_balanced_accuracy: 0.67439 | train_accuracy: 0.67437 | valid_auc: 0.73486 | valid_balanced_accuracy: 0.66719 | valid_accuracy: 0.66714 |  0:10:30s
epoch 38 | loss: 0.58052 | train_auc: 0.76356 | train_balanced_accuracy: 0.69764 | train_accuracy: 0.69774 | valid_auc: 0.74814 | valid_balanced_accuracy: 0.68299 | valid_accuracy: 0.68303 |  0:10:48s
epoch 39 | loss: 0.58141 | train_auc: 0.72202 | train_balanced_accuracy: 0.664   | train_accuracy: 0.6639  | valid_auc: 0.72096 | valid_balanced_accuracy: 0.65889 | valid_accuracy: 0.6588  |  0:11:04s
epoch 40 | loss: 0.58561 | train_auc: 0.72472 | train_balanced_accuracy: 0.66077 | train_accuracy: 0.66067 | valid_auc: 0.71953 | valid_balanced_accuracy: 0.65245 | valid_accuracy: 0.65234 |  0:11:21s
epoch 41 | loss: 0.58179 | train_auc: 0.73801 | train_balanced_accuracy: 0.66888 | train_accuracy: 0.66874 | valid_auc: 0.72414 | valid_balanced_accuracy: 0.6561  | valid_accuracy: 0.65596 |  0:11:38s
epoch 42 | loss: 0.57647 | train_auc: 0.76931 | train_balanced_accuracy: 0.70075 | train_accuracy: 0.70089 | valid_auc: 0.75165 | valid_balanced_accuracy: 0.68717 | valid_accuracy: 0.68728 |  0:11:56s
epoch 43 | loss: 0.58503 | train_auc: 0.76068 | train_balanced_accuracy: 0.69489 | train_accuracy: 0.69518 | valid_auc: 0.74886 | valid_balanced_accuracy: 0.68784 | valid_accuracy: 0.68807 |  0:12:13s
epoch 44 | loss: 0.57892 | train_auc: 0.73938 | train_balanced_accuracy: 0.68192 | train_accuracy: 0.68243 | valid_auc: 0.73049 | valid_balanced_accuracy: 0.68022 | valid_accuracy: 0.68067 |  0:12:29s
epoch 45 | loss: 0.57686 | train_auc: 0.75972 | train_balanced_accuracy: 0.69099 | train_accuracy: 0.69176 | valid_auc: 0.744   | valid_balanced_accuracy: 0.68356 | valid_accuracy: 0.68429 |  0:12:44s
epoch 46 | loss: 0.57447 | train_auc: 0.705   | train_balanced_accuracy: 0.66116 | train_accuracy: 0.66221 | valid_auc: 0.70544 | valid_balanced_accuracy: 0.67102 | valid_accuracy: 0.67202 |  0:13:01s

Early stopping occurred at epoch 46 with best_epoch = 26 and best_valid_accuracy = 0.68823
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 50/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.675 total time=13.1min
[CV 3/5; 50/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.72152 | train_auc: 0.54893 | train_balanced_accuracy: 0.53083 | train_accuracy: 0.53077 | valid_auc: 0.55009 | valid_balanced_accuracy: 0.5319  | valid_accuracy: 0.53179 |  0:00:16s
epoch 1  | loss: 0.66928 | train_auc: 0.54232 | train_balanced_accuracy: 0.51665 | train_accuracy: 0.51534 | valid_auc: 0.54638 | valid_balanced_accuracy: 0.51328 | valid_accuracy: 0.51196 |  0:00:31s
epoch 2  | loss: 0.64925 | train_auc: 0.62411 | train_balanced_accuracy: 0.54233 | train_accuracy: 0.53982 | valid_auc: 0.62224 | valid_balanced_accuracy: 0.54002 | valid_accuracy: 0.53746 |  0:00:50s
epoch 3  | loss: 0.63883 | train_auc: 0.63385 | train_balanced_accuracy: 0.54072 | train_accuracy: 0.53809 | valid_auc: 0.6375  | valid_balanced_accuracy: 0.54312 | valid_accuracy: 0.54045 |  0:01:06s
epoch 4  | loss: 0.62709 | train_auc: 0.65384 | train_balanced_accuracy: 0.56164 | train_accuracy: 0.55929 | valid_auc: 0.64987 | valid_balanced_accuracy: 0.55933 | valid_accuracy: 0.55697 |  0:01:21s
epoch 5  | loss: 0.62151 | train_auc: 0.67398 | train_balanced_accuracy: 0.59703 | train_accuracy: 0.59541 | valid_auc: 0.66289 | valid_balanced_accuracy: 0.59212 | valid_accuracy: 0.59049 |  0:01:38s
epoch 6  | loss: 0.62058 | train_auc: 0.68765 | train_balanced_accuracy: 0.62391 | train_accuracy: 0.62303 | valid_auc: 0.67884 | valid_balanced_accuracy: 0.6139  | valid_accuracy: 0.613   |  0:01:55s
epoch 7  | loss: 0.62021 | train_auc: 0.68788 | train_balanced_accuracy: 0.63348 | train_accuracy: 0.63299 | valid_auc: 0.68008 | valid_balanced_accuracy: 0.62905 | valid_accuracy: 0.62858 |  0:02:11s
epoch 8  | loss: 0.61296 | train_auc: 0.69555 | train_balanced_accuracy: 0.63571 | train_accuracy: 0.63594 | valid_auc: 0.69076 | valid_balanced_accuracy: 0.63736 | valid_accuracy: 0.63755 |  0:02:27s
epoch 9  | loss: 0.61319 | train_auc: 0.69411 | train_balanced_accuracy: 0.63531 | train_accuracy: 0.63535 | valid_auc: 0.69046 | valid_balanced_accuracy: 0.63563 | valid_accuracy: 0.63566 |  0:02:44s
epoch 10 | loss: 0.60517 | train_auc: 0.70065 | train_balanced_accuracy: 0.63792 | train_accuracy: 0.63771 | valid_auc: 0.69443 | valid_balanced_accuracy: 0.6334  | valid_accuracy: 0.63314 |  0:03:02s
epoch 11 | loss: 0.60709 | train_auc: 0.70812 | train_balanced_accuracy: 0.64827 | train_accuracy: 0.64833 | valid_auc: 0.7038  | valid_balanced_accuracy: 0.64177 | valid_accuracy: 0.6418  |  0:03:19s
epoch 12 | loss: 0.60511 | train_auc: 0.71404 | train_balanced_accuracy: 0.65257 | train_accuracy: 0.65297 | valid_auc: 0.70676 | valid_balanced_accuracy: 0.64757 | valid_accuracy: 0.64794 |  0:03:34s
epoch 13 | loss: 0.60159 | train_auc: 0.71301 | train_balanced_accuracy: 0.6497  | train_accuracy: 0.64987 | valid_auc: 0.70489 | valid_balanced_accuracy: 0.64667 | valid_accuracy: 0.64684 |  0:03:50s
epoch 14 | loss: 0.59913 | train_auc: 0.72492 | train_balanced_accuracy: 0.65962 | train_accuracy: 0.65974 | valid_auc: 0.71683 | valid_balanced_accuracy: 0.65398 | valid_accuracy: 0.65408 |  0:04:07s
epoch 15 | loss: 0.60062 | train_auc: 0.72356 | train_balanced_accuracy: 0.66115 | train_accuracy: 0.66143 | valid_auc: 0.71477 | valid_balanced_accuracy: 0.65744 | valid_accuracy: 0.6577  |  0:04:22s
epoch 16 | loss: 0.5963  | train_auc: 0.72833 | train_balanced_accuracy: 0.6651  | train_accuracy: 0.66505 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.66314 | valid_accuracy: 0.66305 |  0:04:38s
epoch 17 | loss: 0.59382 | train_auc: 0.73184 | train_balanced_accuracy: 0.66883 | train_accuracy: 0.66922 | valid_auc: 0.72383 | valid_balanced_accuracy: 0.6641  | valid_accuracy: 0.66446 |  0:04:53s
epoch 18 | loss: 0.60048 | train_auc: 0.73722 | train_balanced_accuracy: 0.67443 | train_accuracy: 0.67517 | valid_auc: 0.72813 | valid_balanced_accuracy: 0.6716  | valid_accuracy: 0.67233 |  0:05:12s
epoch 19 | loss: 0.59525 | train_auc: 0.73832 | train_balanced_accuracy: 0.67126 | train_accuracy: 0.67166 | valid_auc: 0.72802 | valid_balanced_accuracy: 0.67586 | valid_accuracy: 0.67627 |  0:05:29s
epoch 20 | loss: 0.59528 | train_auc: 0.7439  | train_balanced_accuracy: 0.68225 | train_accuracy: 0.68288 | valid_auc: 0.73188 | valid_balanced_accuracy: 0.67688 | valid_accuracy: 0.67753 |  0:05:46s
epoch 21 | loss: 0.5892  | train_auc: 0.74675 | train_balanced_accuracy: 0.68144 | train_accuracy: 0.68166 | valid_auc: 0.7346  | valid_balanced_accuracy: 0.67638 | valid_accuracy: 0.67658 |  0:06:02s
epoch 22 | loss: 0.59643 | train_auc: 0.75192 | train_balanced_accuracy: 0.68769 | train_accuracy: 0.68811 | valid_auc: 0.73925 | valid_balanced_accuracy: 0.67786 | valid_accuracy: 0.67831 |  0:06:19s
epoch 23 | loss: 0.59301 | train_auc: 0.75346 | train_balanced_accuracy: 0.68974 | train_accuracy: 0.68992 | valid_auc: 0.74333 | valid_balanced_accuracy: 0.68068 | valid_accuracy: 0.68083 |  0:06:36s
epoch 24 | loss: 0.59505 | train_auc: 0.74752 | train_balanced_accuracy: 0.6833  | train_accuracy: 0.6839  | valid_auc: 0.73662 | valid_balanced_accuracy: 0.67866 | valid_accuracy: 0.67926 |  0:06:53s
epoch 25 | loss: 0.58962 | train_auc: 0.75389 | train_balanced_accuracy: 0.6842  | train_accuracy: 0.6841  | valid_auc: 0.74044 | valid_balanced_accuracy: 0.67716 | valid_accuracy: 0.67705 |  0:07:09s
epoch 26 | loss: 0.5893  | train_auc: 0.75582 | train_balanced_accuracy: 0.69148 | train_accuracy: 0.69177 | valid_auc: 0.74415 | valid_balanced_accuracy: 0.6854  | valid_accuracy: 0.68571 |  0:07:26s
epoch 27 | loss: 0.58715 | train_auc: 0.75908 | train_balanced_accuracy: 0.69302 | train_accuracy: 0.69319 | valid_auc: 0.74583 | valid_balanced_accuracy: 0.68352 | valid_accuracy: 0.68366 |  0:07:41s
epoch 28 | loss: 0.58407 | train_auc: 0.75774 | train_balanced_accuracy: 0.69315 | train_accuracy: 0.6935  | valid_auc: 0.73966 | valid_balanced_accuracy: 0.67999 | valid_accuracy: 0.68036 |  0:07:59s
epoch 29 | loss: 0.58738 | train_auc: 0.75922 | train_balanced_accuracy: 0.6921  | train_accuracy: 0.69224 | valid_auc: 0.7422  | valid_balanced_accuracy: 0.68491 | valid_accuracy: 0.68508 |  0:08:15s
epoch 30 | loss: 0.58761 | train_auc: 0.759   | train_balanced_accuracy: 0.69605 | train_accuracy: 0.69633 | valid_auc: 0.74059 | valid_balanced_accuracy: 0.68903 | valid_accuracy: 0.68933 |  0:08:30s
epoch 31 | loss: 0.5884  | train_auc: 0.7593  | train_balanced_accuracy: 0.69394 | train_accuracy: 0.69389 | valid_auc: 0.74359 | valid_balanced_accuracy: 0.68578 | valid_accuracy: 0.68571 |  0:08:45s
epoch 32 | loss: 0.58325 | train_auc: 0.7605  | train_balanced_accuracy: 0.69238 | train_accuracy: 0.69263 | valid_auc: 0.74206 | valid_balanced_accuracy: 0.68093 | valid_accuracy: 0.68115 |  0:09:02s
epoch 33 | loss: 0.58491 | train_auc: 0.75421 | train_balanced_accuracy: 0.68892 | train_accuracy: 0.68921 | valid_auc: 0.73659 | valid_balanced_accuracy: 0.68245 | valid_accuracy: 0.68272 |  0:09:20s
epoch 34 | loss: 0.58627 | train_auc: 0.75364 | train_balanced_accuracy: 0.6883  | train_accuracy: 0.68858 | valid_auc: 0.73885 | valid_balanced_accuracy: 0.68786 | valid_accuracy: 0.68807 |  0:09:37s
epoch 35 | loss: 0.58157 | train_auc: 0.7512  | train_balanced_accuracy: 0.68698 | train_accuracy: 0.68705 | valid_auc: 0.74005 | valid_balanced_accuracy: 0.68141 | valid_accuracy: 0.68146 |  0:09:54s
epoch 36 | loss: 0.58718 | train_auc: 0.76242 | train_balanced_accuracy: 0.69676 | train_accuracy: 0.697   | valid_auc: 0.7466  | valid_balanced_accuracy: 0.68594 | valid_accuracy: 0.68618 |  0:10:10s
epoch 37 | loss: 0.58339 | train_auc: 0.75675 | train_balanced_accuracy: 0.68694 | train_accuracy: 0.68732 | valid_auc: 0.74229 | valid_balanced_accuracy: 0.68299 | valid_accuracy: 0.68335 |  0:10:25s
epoch 38 | loss: 0.58169 | train_auc: 0.71755 | train_balanced_accuracy: 0.65949 | train_accuracy: 0.65962 | valid_auc: 0.71919 | valid_balanced_accuracy: 0.66383 | valid_accuracy: 0.66399 |  0:10:42s
epoch 39 | loss: 0.57921 | train_auc: 0.71634 | train_balanced_accuracy: 0.65853 | train_accuracy: 0.65903 | valid_auc: 0.71294 | valid_balanced_accuracy: 0.6605  | valid_accuracy: 0.661   |  0:11:00s
epoch 40 | loss: 0.58254 | train_auc: 0.75995 | train_balanced_accuracy: 0.69488 | train_accuracy: 0.695   | valid_auc: 0.7449  | valid_balanced_accuracy: 0.68436 | valid_accuracy: 0.68445 |  0:11:15s
epoch 41 | loss: 0.58244 | train_auc: 0.74337 | train_balanced_accuracy: 0.68153 | train_accuracy: 0.68174 | valid_auc: 0.73543 | valid_balanced_accuracy: 0.67574 | valid_accuracy: 0.67595 |  0:11:31s
epoch 42 | loss: 0.57795 | train_auc: 0.73324 | train_balanced_accuracy: 0.67361 | train_accuracy: 0.67438 | valid_auc: 0.72483 | valid_balanced_accuracy: 0.67064 | valid_accuracy: 0.67139 |  0:11:48s
epoch 43 | loss: 0.58557 | train_auc: 0.74152 | train_balanced_accuracy: 0.68294 | train_accuracy: 0.68339 | valid_auc: 0.72799 | valid_balanced_accuracy: 0.67506 | valid_accuracy: 0.67548 |  0:12:06s
epoch 44 | loss: 0.58437 | train_auc: 0.7379  | train_balanced_accuracy: 0.68006 | train_accuracy: 0.6804  | valid_auc: 0.72735 | valid_balanced_accuracy: 0.67593 | valid_accuracy: 0.67627 |  0:12:24s
epoch 45 | loss: 0.58118 | train_auc: 0.74981 | train_balanced_accuracy: 0.68509 | train_accuracy: 0.68563 | valid_auc: 0.73653 | valid_balanced_accuracy: 0.67828 | valid_accuracy: 0.67879 |  0:12:40s
epoch 46 | loss: 0.58297 | train_auc: 0.74301 | train_balanced_accuracy: 0.67697 | train_accuracy: 0.67768 | valid_auc: 0.73212 | valid_balanced_accuracy: 0.67291 | valid_accuracy: 0.67359 |  0:12:57s
epoch 47 | loss: 0.58018 | train_auc: 0.76582 | train_balanced_accuracy: 0.69533 | train_accuracy: 0.69598 | valid_auc: 0.74835 | valid_balanced_accuracy: 0.68504 | valid_accuracy: 0.68571 |  0:13:12s
epoch 48 | loss: 0.58082 | train_auc: 0.76049 | train_balanced_accuracy: 0.69172 | train_accuracy: 0.69173 | valid_auc: 0.74418 | valid_balanced_accuracy: 0.68639 | valid_accuracy: 0.68634 |  0:13:29s
epoch 49 | loss: 0.57706 | train_auc: 0.76521 | train_balanced_accuracy: 0.69698 | train_accuracy: 0.69728 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.6919  | valid_accuracy: 0.69216 |  0:13:45s
epoch 50 | loss: 0.57811 | train_auc: 0.75497 | train_balanced_accuracy: 0.68466 | train_accuracy: 0.68453 | valid_auc: 0.74258 | valid_balanced_accuracy: 0.67643 | valid_accuracy: 0.67627 |  0:14:02s
epoch 51 | loss: 0.57491 | train_auc: 0.70893 | train_balanced_accuracy: 0.65427 | train_accuracy: 0.65431 | valid_auc: 0.70581 | valid_balanced_accuracy: 0.65593 | valid_accuracy: 0.65596 |  0:14:18s
epoch 52 | loss: 0.57371 | train_auc: 0.76925 | train_balanced_accuracy: 0.70175 | train_accuracy: 0.702   | valid_auc: 0.75045 | valid_balanced_accuracy: 0.68702 | valid_accuracy: 0.68728 |  0:14:35s
epoch 53 | loss: 0.57497 | train_auc: 0.7519  | train_balanced_accuracy: 0.68718 | train_accuracy: 0.68752 | valid_auc: 0.73757 | valid_balanced_accuracy: 0.67889 | valid_accuracy: 0.67926 |  0:14:50s
epoch 54 | loss: 0.57662 | train_auc: 0.72387 | train_balanced_accuracy: 0.67076 | train_accuracy: 0.67123 | valid_auc: 0.71788 | valid_balanced_accuracy: 0.6705  | valid_accuracy: 0.67092 |  0:15:07s
epoch 55 | loss: 0.57579 | train_auc: 0.71047 | train_balanced_accuracy: 0.6511  | train_accuracy: 0.65101 | valid_auc: 0.70919 | valid_balanced_accuracy: 0.65483 | valid_accuracy: 0.65471 |  0:15:24s
epoch 56 | loss: 0.57278 | train_auc: 0.71016 | train_balanced_accuracy: 0.64822 | train_accuracy: 0.64778 | valid_auc: 0.71162 | valid_balanced_accuracy: 0.64885 | valid_accuracy: 0.64841 |  0:15:40s
epoch 57 | loss: 0.58225 | train_auc: 0.72037 | train_balanced_accuracy: 0.65286 | train_accuracy: 0.65223 | valid_auc: 0.71761 | valid_balanced_accuracy: 0.65082 | valid_accuracy: 0.65014 |  0:15:58s
epoch 58 | loss: 0.58113 | train_auc: 0.7303  | train_balanced_accuracy: 0.66517 | train_accuracy: 0.66517 | valid_auc: 0.72734 | valid_balanced_accuracy: 0.66635 | valid_accuracy: 0.66635 |  0:16:15s
epoch 59 | loss: 0.57629 | train_auc: 0.73271 | train_balanced_accuracy: 0.67011 | train_accuracy: 0.67005 | valid_auc: 0.72584 | valid_balanced_accuracy: 0.66603 | valid_accuracy: 0.66588 |  0:16:32s
epoch 60 | loss: 0.58047 | train_auc: 0.74268 | train_balanced_accuracy: 0.67488 | train_accuracy: 0.67481 | valid_auc: 0.73235 | valid_balanced_accuracy: 0.66739 | valid_accuracy: 0.6673  |  0:16:47s
epoch 61 | loss: 0.57895 | train_auc: 0.74877 | train_balanced_accuracy: 0.68286 | train_accuracy: 0.68307 | valid_auc: 0.73557 | valid_balanced_accuracy: 0.67513 | valid_accuracy: 0.67532 |  0:17:03s
epoch 62 | loss: 0.57477 | train_auc: 0.75901 | train_balanced_accuracy: 0.69083 | train_accuracy: 0.69079 | valid_auc: 0.74559 | valid_balanced_accuracy: 0.6798  | valid_accuracy: 0.67973 |  0:17:20s
epoch 63 | loss: 0.57474 | train_auc: 0.75982 | train_balanced_accuracy: 0.69239 | train_accuracy: 0.69252 | valid_auc: 0.74294 | valid_balanced_accuracy: 0.68435 | valid_accuracy: 0.68445 |  0:17:36s
epoch 64 | loss: 0.57311 | train_auc: 0.76714 | train_balanced_accuracy: 0.69817 | train_accuracy: 0.6983  | valid_auc: 0.74855 | valid_balanced_accuracy: 0.68543 | valid_accuracy: 0.68555 |  0:17:52s
epoch 65 | loss: 0.56754 | train_auc: 0.77382 | train_balanced_accuracy: 0.70144 | train_accuracy: 0.70153 | valid_auc: 0.75622 | valid_balanced_accuracy: 0.69303 | valid_accuracy: 0.69311 |  0:18:06s
epoch 66 | loss: 0.57285 | train_auc: 0.77522 | train_balanced_accuracy: 0.70153 | train_accuracy: 0.70149 | valid_auc: 0.75375 | valid_balanced_accuracy: 0.68765 | valid_accuracy: 0.6876  |  0:18:24s
epoch 67 | loss: 0.56954 | train_auc: 0.77686 | train_balanced_accuracy: 0.70094 | train_accuracy: 0.70109 | valid_auc: 0.75205 | valid_balanced_accuracy: 0.68725 | valid_accuracy: 0.68744 |  0:18:42s
epoch 68 | loss: 0.57105 | train_auc: 0.77767 | train_balanced_accuracy: 0.70447 | train_accuracy: 0.70487 | valid_auc: 0.75397 | valid_balanced_accuracy: 0.6897  | valid_accuracy: 0.69012 |  0:18:59s
epoch 69 | loss: 0.57104 | train_auc: 0.77783 | train_balanced_accuracy: 0.70282 | train_accuracy: 0.70298 | valid_auc: 0.75292 | valid_balanced_accuracy: 0.69276 | valid_accuracy: 0.69295 |  0:19:16s
epoch 70 | loss: 0.56935 | train_auc: 0.78126 | train_balanced_accuracy: 0.70739 | train_accuracy: 0.70763 | valid_auc: 0.75594 | valid_balanced_accuracy: 0.69254 | valid_accuracy: 0.69279 |  0:19:34s
epoch 71 | loss: 0.57087 | train_auc: 0.78072 | train_balanced_accuracy: 0.70533 | train_accuracy: 0.7055  | valid_auc: 0.75428 | valid_balanced_accuracy: 0.69117 | valid_accuracy: 0.69138 |  0:19:53s
epoch 72 | loss: 0.57324 | train_auc: 0.77813 | train_balanced_accuracy: 0.70413 | train_accuracy: 0.70428 | valid_auc: 0.75331 | valid_balanced_accuracy: 0.69657 | valid_accuracy: 0.69673 |  0:20:08s
epoch 73 | loss: 0.56492 | train_auc: 0.78109 | train_balanced_accuracy: 0.70617 | train_accuracy: 0.70629 | valid_auc: 0.75742 | valid_balanced_accuracy: 0.69424 | valid_accuracy: 0.69437 |  0:20:25s
epoch 74 | loss: 0.56989 | train_auc: 0.78186 | train_balanced_accuracy: 0.70774 | train_accuracy: 0.7081  | valid_auc: 0.75697 | valid_balanced_accuracy: 0.69463 | valid_accuracy: 0.695   |  0:20:43s
epoch 75 | loss: 0.57016 | train_auc: 0.78322 | train_balanced_accuracy: 0.70779 | train_accuracy: 0.70786 | valid_auc: 0.75647 | valid_balanced_accuracy: 0.69255 | valid_accuracy: 0.69263 |  0:21:01s
epoch 76 | loss: 0.56793 | train_auc: 0.78414 | train_balanced_accuracy: 0.7051  | train_accuracy: 0.70507 | valid_auc: 0.7576  | valid_balanced_accuracy: 0.69276 | valid_accuracy: 0.69279 |  0:21:18s
epoch 77 | loss: 0.56331 | train_auc: 0.78282 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70869 | valid_auc: 0.75505 | valid_balanced_accuracy: 0.69333 | valid_accuracy: 0.69342 |  0:21:36s
epoch 78 | loss: 0.56081 | train_auc: 0.78004 | train_balanced_accuracy: 0.7081  | train_accuracy: 0.70845 | valid_auc: 0.75256 | valid_balanced_accuracy: 0.69227 | valid_accuracy: 0.69263 |  0:21:53s
epoch 79 | loss: 0.56262 | train_auc: 0.77922 | train_balanced_accuracy: 0.70701 | train_accuracy: 0.70719 | valid_auc: 0.75275 | valid_balanced_accuracy: 0.6935  | valid_accuracy: 0.69374 |  0:22:09s
epoch 80 | loss: 0.5691  | train_auc: 0.78299 | train_balanced_accuracy: 0.70888 | train_accuracy: 0.7092  | valid_auc: 0.75419 | valid_balanced_accuracy: 0.69403 | valid_accuracy: 0.69437 |  0:22:26s
epoch 81 | loss: 0.57111 | train_auc: 0.78143 | train_balanced_accuracy: 0.70669 | train_accuracy: 0.70703 | valid_auc: 0.75337 | valid_balanced_accuracy: 0.69133 | valid_accuracy: 0.69169 |  0:22:43s
epoch 82 | loss: 0.56635 | train_auc: 0.78087 | train_balanced_accuracy: 0.70634 | train_accuracy: 0.70664 | valid_auc: 0.7552  | valid_balanced_accuracy: 0.69362 | valid_accuracy: 0.69389 |  0:23:00s
epoch 83 | loss: 0.56882 | train_auc: 0.78436 | train_balanced_accuracy: 0.71067 | train_accuracy: 0.71081 | valid_auc: 0.75785 | valid_balanced_accuracy: 0.69107 | valid_accuracy: 0.69122 |  0:23:17s
epoch 84 | loss: 0.56607 | train_auc: 0.78607 | train_balanced_accuracy: 0.71143 | train_accuracy: 0.71176 | valid_auc: 0.75557 | valid_balanced_accuracy: 0.69103 | valid_accuracy: 0.69138 |  0:23:35s
epoch 85 | loss: 0.56749 | train_auc: 0.75761 | train_balanced_accuracy: 0.68953 | train_accuracy: 0.68945 | valid_auc: 0.74424 | valid_balanced_accuracy: 0.68393 | valid_accuracy: 0.68382 |  0:23:52s
epoch 86 | loss: 0.56655 | train_auc: 0.75713 | train_balanced_accuracy: 0.68528 | train_accuracy: 0.685   | valid_auc: 0.74326 | valid_balanced_accuracy: 0.67937 | valid_accuracy: 0.6791  |  0:24:08s
epoch 87 | loss: 0.56056 | train_auc: 0.76944 | train_balanced_accuracy: 0.69298 | train_accuracy: 0.69263 | valid_auc: 0.75035 | valid_balanced_accuracy: 0.68386 | valid_accuracy: 0.68351 |  0:24:23s
epoch 88 | loss: 0.5597  | train_auc: 0.77721 | train_balanced_accuracy: 0.70663 | train_accuracy: 0.70668 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.69432 | valid_accuracy: 0.69437 |  0:24:39s
epoch 89 | loss: 0.56378 | train_auc: 0.78039 | train_balanced_accuracy: 0.70621 | train_accuracy: 0.7066  | valid_auc: 0.75433 | valid_balanced_accuracy: 0.69415 | valid_accuracy: 0.69452 |  0:24:56s
epoch 90 | loss: 0.56573 | train_auc: 0.78815 | train_balanced_accuracy: 0.71087 | train_accuracy: 0.71073 | valid_auc: 0.75975 | valid_balanced_accuracy: 0.69452 | valid_accuracy: 0.69437 |  0:25:14s
epoch 91 | loss: 0.56111 | train_auc: 0.78966 | train_balanced_accuracy: 0.71306 | train_accuracy: 0.71317 | valid_auc: 0.75756 | valid_balanced_accuracy: 0.68857 | valid_accuracy: 0.6887  |  0:25:30s
epoch 92 | loss: 0.5603  | train_auc: 0.78899 | train_balanced_accuracy: 0.71448 | train_accuracy: 0.71463 | valid_auc: 0.75224 | valid_balanced_accuracy: 0.69181 | valid_accuracy: 0.69201 |  0:25:47s

Early stopping occurred at epoch 92 with best_epoch = 72 and best_valid_accuracy = 0.69673
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 50/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=25.9min
[CV 4/5; 50/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70962 | train_auc: 0.60086 | train_balanced_accuracy: 0.57131 | train_accuracy: 0.57066 | valid_auc: 0.59637 | valid_balanced_accuracy: 0.56651 | valid_accuracy: 0.56579 |  0:00:16s
epoch 1  | loss: 0.66147 | train_auc: 0.61952 | train_balanced_accuracy: 0.58441 | train_accuracy: 0.5831  | valid_auc: 0.61081 | valid_balanced_accuracy: 0.57672 | valid_accuracy: 0.57539 |  0:00:33s
epoch 2  | loss: 0.64046 | train_auc: 0.63797 | train_balanced_accuracy: 0.57373 | train_accuracy: 0.57145 | valid_auc: 0.63485 | valid_balanced_accuracy: 0.57063 | valid_accuracy: 0.5683  |  0:00:49s
epoch 3  | loss: 0.63426 | train_auc: 0.6492  | train_balanced_accuracy: 0.57858 | train_accuracy: 0.57637 | valid_auc: 0.64183 | valid_balanced_accuracy: 0.56159 | valid_accuracy: 0.55933 |  0:01:06s
epoch 4  | loss: 0.6272  | train_auc: 0.6572  | train_balanced_accuracy: 0.59488 | train_accuracy: 0.59301 | valid_auc: 0.64877 | valid_balanced_accuracy: 0.58575 | valid_accuracy: 0.58388 |  0:01:21s
epoch 5  | loss: 0.62754 | train_auc: 0.66602 | train_balanced_accuracy: 0.60919 | train_accuracy: 0.60804 | valid_auc: 0.65883 | valid_balanced_accuracy: 0.6045  | valid_accuracy: 0.6034  |  0:01:37s
epoch 6  | loss: 0.61963 | train_auc: 0.67317 | train_balanced_accuracy: 0.61143 | train_accuracy: 0.61017 | valid_auc: 0.66532 | valid_balanced_accuracy: 0.60384 | valid_accuracy: 0.60261 |  0:01:52s
epoch 7  | loss: 0.61806 | train_auc: 0.68481 | train_balanced_accuracy: 0.62889 | train_accuracy: 0.62815 | valid_auc: 0.67516 | valid_balanced_accuracy: 0.61748 | valid_accuracy: 0.61678 |  0:02:09s
epoch 8  | loss: 0.61647 | train_auc: 0.69657 | train_balanced_accuracy: 0.6447  | train_accuracy: 0.64487 | valid_auc: 0.68433 | valid_balanced_accuracy: 0.63638 | valid_accuracy: 0.63661 |  0:02:25s
epoch 9  | loss: 0.61296 | train_auc: 0.69904 | train_balanced_accuracy: 0.64042 | train_accuracy: 0.63983 | valid_auc: 0.68346 | valid_balanced_accuracy: 0.62725 | valid_accuracy: 0.62669 |  0:02:41s
epoch 10 | loss: 0.60666 | train_auc: 0.70857 | train_balanced_accuracy: 0.65403 | train_accuracy: 0.65427 | valid_auc: 0.6975  | valid_balanced_accuracy: 0.64876 | valid_accuracy: 0.64904 |  0:02:58s
epoch 11 | loss: 0.60532 | train_auc: 0.7099  | train_balanced_accuracy: 0.65739 | train_accuracy: 0.6577  | valid_auc: 0.69575 | valid_balanced_accuracy: 0.65421 | valid_accuracy: 0.65455 |  0:03:16s
epoch 12 | loss: 0.60247 | train_auc: 0.71502 | train_balanced_accuracy: 0.65824 | train_accuracy: 0.65892 | valid_auc: 0.70104 | valid_balanced_accuracy: 0.6543  | valid_accuracy: 0.65502 |  0:03:33s
epoch 13 | loss: 0.60328 | train_auc: 0.71862 | train_balanced_accuracy: 0.66188 | train_accuracy: 0.66214 | valid_auc: 0.70377 | valid_balanced_accuracy: 0.65414 | valid_accuracy: 0.65439 |  0:03:48s
epoch 14 | loss: 0.6073  | train_auc: 0.72366 | train_balanced_accuracy: 0.66332 | train_accuracy: 0.6636  | valid_auc: 0.70956 | valid_balanced_accuracy: 0.65553 | valid_accuracy: 0.65581 |  0:04:04s
epoch 15 | loss: 0.60599 | train_auc: 0.72832 | train_balanced_accuracy: 0.66142 | train_accuracy: 0.66218 | valid_auc: 0.71416 | valid_balanced_accuracy: 0.65659 | valid_accuracy: 0.65738 |  0:04:20s
epoch 16 | loss: 0.59967 | train_auc: 0.73015 | train_balanced_accuracy: 0.66807 | train_accuracy: 0.66844 | valid_auc: 0.71197 | valid_balanced_accuracy: 0.66188 | valid_accuracy: 0.66226 |  0:04:38s
epoch 17 | loss: 0.59764 | train_auc: 0.73394 | train_balanced_accuracy: 0.6688  | train_accuracy: 0.66946 | valid_auc: 0.71468 | valid_balanced_accuracy: 0.66001 | valid_accuracy: 0.66069 |  0:04:55s
epoch 18 | loss: 0.60254 | train_auc: 0.73817 | train_balanced_accuracy: 0.66808 | train_accuracy: 0.66887 | valid_auc: 0.72039 | valid_balanced_accuracy: 0.66252 | valid_accuracy: 0.66336 |  0:05:14s
epoch 19 | loss: 0.59248 | train_auc: 0.74111 | train_balanced_accuracy: 0.67327 | train_accuracy: 0.67398 | valid_auc: 0.72229 | valid_balanced_accuracy: 0.66481 | valid_accuracy: 0.66556 |  0:05:30s
epoch 20 | loss: 0.59397 | train_auc: 0.74352 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67941 | valid_auc: 0.72545 | valid_balanced_accuracy: 0.66676 | valid_accuracy: 0.6673  |  0:05:47s
epoch 21 | loss: 0.5934  | train_auc: 0.74918 | train_balanced_accuracy: 0.68571 | train_accuracy: 0.68606 | valid_auc: 0.72412 | valid_balanced_accuracy: 0.66738 | valid_accuracy: 0.66777 |  0:06:03s
epoch 22 | loss: 0.59759 | train_auc: 0.74954 | train_balanced_accuracy: 0.68543 | train_accuracy: 0.68583 | valid_auc: 0.72968 | valid_balanced_accuracy: 0.66684 | valid_accuracy: 0.6673  |  0:06:20s
epoch 23 | loss: 0.59493 | train_auc: 0.7513  | train_balanced_accuracy: 0.68796 | train_accuracy: 0.68823 | valid_auc: 0.73013 | valid_balanced_accuracy: 0.67311 | valid_accuracy: 0.67343 |  0:06:37s
epoch 24 | loss: 0.59512 | train_auc: 0.75123 | train_balanced_accuracy: 0.68537 | train_accuracy: 0.68583 | valid_auc: 0.73043 | valid_balanced_accuracy: 0.67071 | valid_accuracy: 0.67123 |  0:06:54s
epoch 25 | loss: 0.5941  | train_auc: 0.75303 | train_balanced_accuracy: 0.68761 | train_accuracy: 0.68768 | valid_auc: 0.73145 | valid_balanced_accuracy: 0.671   | valid_accuracy: 0.67107 |  0:07:09s
epoch 26 | loss: 0.58934 | train_auc: 0.75824 | train_balanced_accuracy: 0.69011 | train_accuracy: 0.69051 | valid_auc: 0.74035 | valid_balanced_accuracy: 0.6823  | valid_accuracy: 0.68272 |  0:07:26s
epoch 27 | loss: 0.59368 | train_auc: 0.75821 | train_balanced_accuracy: 0.69028 | train_accuracy: 0.69043 | valid_auc: 0.73725 | valid_balanced_accuracy: 0.67813 | valid_accuracy: 0.67831 |  0:07:42s
epoch 28 | loss: 0.58915 | train_auc: 0.75925 | train_balanced_accuracy: 0.6945  | train_accuracy: 0.69452 | valid_auc: 0.73726 | valid_balanced_accuracy: 0.67716 | valid_accuracy: 0.67721 |  0:08:00s
epoch 29 | loss: 0.58792 | train_auc: 0.75825 | train_balanced_accuracy: 0.69196 | train_accuracy: 0.69185 | valid_auc: 0.73781 | valid_balanced_accuracy: 0.67132 | valid_accuracy: 0.67123 |  0:08:17s
epoch 30 | loss: 0.58661 | train_auc: 0.75443 | train_balanced_accuracy: 0.68812 | train_accuracy: 0.68819 | valid_auc: 0.73481 | valid_balanced_accuracy: 0.67083 | valid_accuracy: 0.67092 |  0:08:33s
epoch 31 | loss: 0.58559 | train_auc: 0.74469 | train_balanced_accuracy: 0.68407 | train_accuracy: 0.68421 | valid_auc: 0.73276 | valid_balanced_accuracy: 0.67548 | valid_accuracy: 0.67564 |  0:08:51s
epoch 32 | loss: 0.582   | train_auc: 0.7246  | train_balanced_accuracy: 0.66317 | train_accuracy: 0.66313 | valid_auc: 0.71045 | valid_balanced_accuracy: 0.65144 | valid_accuracy: 0.6514  |  0:09:06s
epoch 33 | loss: 0.58515 | train_auc: 0.67922 | train_balanced_accuracy: 0.63731 | train_accuracy: 0.63779 | valid_auc: 0.6681  | valid_balanced_accuracy: 0.62884 | valid_accuracy: 0.62937 |  0:09:23s
epoch 34 | loss: 0.58313 | train_auc: 0.67872 | train_balanced_accuracy: 0.64064 | train_accuracy: 0.64054 | valid_auc: 0.6614  | valid_balanced_accuracy: 0.62064 | valid_accuracy: 0.62055 |  0:09:39s
epoch 35 | loss: 0.57836 | train_auc: 0.69039 | train_balanced_accuracy: 0.6446  | train_accuracy: 0.64459 | valid_auc: 0.6839  | valid_balanced_accuracy: 0.63689 | valid_accuracy: 0.63692 |  0:09:56s
epoch 36 | loss: 0.5825  | train_auc: 0.70848 | train_balanced_accuracy: 0.65709 | train_accuracy: 0.65699 | valid_auc: 0.69994 | valid_balanced_accuracy: 0.65035 | valid_accuracy: 0.6503  |  0:10:12s
epoch 37 | loss: 0.58244 | train_auc: 0.71597 | train_balanced_accuracy: 0.66044 | train_accuracy: 0.66073 | valid_auc: 0.70355 | valid_balanced_accuracy: 0.65326 | valid_accuracy: 0.6536  |  0:10:28s
epoch 38 | loss: 0.58321 | train_auc: 0.71975 | train_balanced_accuracy: 0.66307 | train_accuracy: 0.66316 | valid_auc: 0.70616 | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65502 |  0:10:45s
epoch 39 | loss: 0.58045 | train_auc: 0.72485 | train_balanced_accuracy: 0.65923 | train_accuracy: 0.65951 | valid_auc: 0.71177 | valid_balanced_accuracy: 0.64858 | valid_accuracy: 0.64888 |  0:11:01s
epoch 40 | loss: 0.58046 | train_auc: 0.72885 | train_balanced_accuracy: 0.66743 | train_accuracy: 0.66753 | valid_auc: 0.71497 | valid_balanced_accuracy: 0.66133 | valid_accuracy: 0.66147 |  0:11:17s
epoch 41 | loss: 0.57874 | train_auc: 0.73326 | train_balanced_accuracy: 0.66364 | train_accuracy: 0.66435 | valid_auc: 0.72226 | valid_balanced_accuracy: 0.65319 | valid_accuracy: 0.65392 |  0:11:34s
epoch 42 | loss: 0.5762  | train_auc: 0.7516  | train_balanced_accuracy: 0.68327 | train_accuracy: 0.68374 | valid_auc: 0.73192 | valid_balanced_accuracy: 0.66961 | valid_accuracy: 0.67013 |  0:11:50s
epoch 43 | loss: 0.57989 | train_auc: 0.7676  | train_balanced_accuracy: 0.70001 | train_accuracy: 0.70023 | valid_auc: 0.74457 | valid_balanced_accuracy: 0.6872  | valid_accuracy: 0.68744 |  0:12:07s
epoch 44 | loss: 0.58337 | train_auc: 0.76337 | train_balanced_accuracy: 0.69625 | train_accuracy: 0.69645 | valid_auc: 0.73974 | valid_balanced_accuracy: 0.67876 | valid_accuracy: 0.67894 |  0:12:22s
epoch 45 | loss: 0.57251 | train_auc: 0.73142 | train_balanced_accuracy: 0.67681 | train_accuracy: 0.67717 | valid_auc: 0.71542 | valid_balanced_accuracy: 0.66471 | valid_accuracy: 0.66509 |  0:12:38s
epoch 46 | loss: 0.57917 | train_auc: 0.71089 | train_balanced_accuracy: 0.66046 | train_accuracy: 0.66045 | valid_auc: 0.70575 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65659 |  0:12:56s
epoch 47 | loss: 0.57401 | train_auc: 0.69477 | train_balanced_accuracy: 0.64307 | train_accuracy: 0.64341 | valid_auc: 0.69132 | valid_balanced_accuracy: 0.64228 | valid_accuracy: 0.64259 |  0:13:13s
epoch 48 | loss: 0.57446 | train_auc: 0.77851 | train_balanced_accuracy: 0.70874 | train_accuracy: 0.70896 | valid_auc: 0.74918 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.68602 |  0:13:30s
epoch 49 | loss: 0.57379 | train_auc: 0.7709  | train_balanced_accuracy: 0.6997  | train_accuracy: 0.69995 | valid_auc: 0.74736 | valid_balanced_accuracy: 0.68165 | valid_accuracy: 0.68193 |  0:13:48s
epoch 50 | loss: 0.57551 | train_auc: 0.77748 | train_balanced_accuracy: 0.7039  | train_accuracy: 0.70397 | valid_auc: 0.75015 | valid_balanced_accuracy: 0.68327 | valid_accuracy: 0.68335 |  0:14:03s
epoch 51 | loss: 0.56957 | train_auc: 0.77918 | train_balanced_accuracy: 0.70721 | train_accuracy: 0.70723 | valid_auc: 0.75149 | valid_balanced_accuracy: 0.68743 | valid_accuracy: 0.68744 |  0:14:19s
epoch 52 | loss: 0.56783 | train_auc: 0.72903 | train_balanced_accuracy: 0.66073 | train_accuracy: 0.6612  | valid_auc: 0.71694 | valid_balanced_accuracy: 0.65565 | valid_accuracy: 0.65612 |  0:14:36s
epoch 53 | loss: 0.57064 | train_auc: 0.72842 | train_balanced_accuracy: 0.65154 | train_accuracy: 0.65223 | valid_auc: 0.71521 | valid_balanced_accuracy: 0.64706 | valid_accuracy: 0.64778 |  0:14:53s
epoch 54 | loss: 0.5731  | train_auc: 0.74079 | train_balanced_accuracy: 0.67214 | train_accuracy: 0.67237 | valid_auc: 0.72528 | valid_balanced_accuracy: 0.65792 | valid_accuracy: 0.65817 |  0:15:09s
epoch 55 | loss: 0.56679 | train_auc: 0.76174 | train_balanced_accuracy: 0.68931 | train_accuracy: 0.68957 | valid_auc: 0.73776 | valid_balanced_accuracy: 0.67351 | valid_accuracy: 0.67375 |  0:15:26s
epoch 56 | loss: 0.57394 | train_auc: 0.77443 | train_balanced_accuracy: 0.70194 | train_accuracy: 0.70208 | valid_auc: 0.75059 | valid_balanced_accuracy: 0.68462 | valid_accuracy: 0.68477 |  0:15:42s
epoch 57 | loss: 0.57459 | train_auc: 0.77559 | train_balanced_accuracy: 0.70096 | train_accuracy: 0.70086 | valid_auc: 0.74787 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68256 |  0:15:57s
epoch 58 | loss: 0.57593 | train_auc: 0.7721  | train_balanced_accuracy: 0.70035 | train_accuracy: 0.70062 | valid_auc: 0.74495 | valid_balanced_accuracy: 0.68149 | valid_accuracy: 0.68178 |  0:16:15s
epoch 59 | loss: 0.56821 | train_auc: 0.78133 | train_balanced_accuracy: 0.71152 | train_accuracy: 0.71164 | valid_auc: 0.74911 | valid_balanced_accuracy: 0.68465 | valid_accuracy: 0.68477 |  0:16:33s
epoch 60 | loss: 0.56905 | train_auc: 0.78249 | train_balanced_accuracy: 0.71049 | train_accuracy: 0.71065 | valid_auc: 0.753   | valid_balanced_accuracy: 0.69183 | valid_accuracy: 0.69201 |  0:16:50s
epoch 61 | loss: 0.56944 | train_auc: 0.77939 | train_balanced_accuracy: 0.70886 | train_accuracy: 0.70908 | valid_auc: 0.75172 | valid_balanced_accuracy: 0.6916  | valid_accuracy: 0.69185 |  0:17:08s
epoch 62 | loss: 0.56997 | train_auc: 0.77962 | train_balanced_accuracy: 0.70639 | train_accuracy: 0.70633 | valid_auc: 0.75062 | valid_balanced_accuracy: 0.68437 | valid_accuracy: 0.68429 |  0:17:24s
epoch 63 | loss: 0.56589 | train_auc: 0.78039 | train_balanced_accuracy: 0.70952 | train_accuracy: 0.70951 | valid_auc: 0.75473 | valid_balanced_accuracy: 0.68728 | valid_accuracy: 0.68728 |  0:17:39s
epoch 64 | loss: 0.56143 | train_auc: 0.78277 | train_balanced_accuracy: 0.7084  | train_accuracy: 0.70837 | valid_auc: 0.75145 | valid_balanced_accuracy: 0.68983 | valid_accuracy: 0.6898  |  0:17:56s
epoch 65 | loss: 0.56528 | train_auc: 0.77988 | train_balanced_accuracy: 0.70907 | train_accuracy: 0.70928 | valid_auc: 0.74948 | valid_balanced_accuracy: 0.68864 | valid_accuracy: 0.68886 |  0:18:11s
epoch 66 | loss: 0.56661 | train_auc: 0.77054 | train_balanced_accuracy: 0.70203 | train_accuracy: 0.70204 | valid_auc: 0.74626 | valid_balanced_accuracy: 0.684   | valid_accuracy: 0.68398 |  0:18:28s
epoch 67 | loss: 0.56291 | train_auc: 0.76177 | train_balanced_accuracy: 0.69502 | train_accuracy: 0.69515 | valid_auc: 0.73915 | valid_balanced_accuracy: 0.68119 | valid_accuracy: 0.6813  |  0:18:42s
epoch 68 | loss: 0.56262 | train_auc: 0.78579 | train_balanced_accuracy: 0.71075 | train_accuracy: 0.71089 | valid_auc: 0.75504 | valid_balanced_accuracy: 0.69011 | valid_accuracy: 0.69027 |  0:18:59s
epoch 69 | loss: 0.56609 | train_auc: 0.78495 | train_balanced_accuracy: 0.71088 | train_accuracy: 0.71109 | valid_auc: 0.75391 | valid_balanced_accuracy: 0.68738 | valid_accuracy: 0.6876  |  0:19:14s
epoch 70 | loss: 0.56684 | train_auc: 0.78611 | train_balanced_accuracy: 0.71293 | train_accuracy: 0.71298 | valid_auc: 0.75831 | valid_balanced_accuracy: 0.68789 | valid_accuracy: 0.68791 |  0:19:30s
epoch 71 | loss: 0.56609 | train_auc: 0.78802 | train_balanced_accuracy: 0.71185 | train_accuracy: 0.71184 | valid_auc: 0.75604 | valid_balanced_accuracy: 0.68887 | valid_accuracy: 0.68886 |  0:19:48s
epoch 72 | loss: 0.56649 | train_auc: 0.78846 | train_balanced_accuracy: 0.71616 | train_accuracy: 0.71648 | valid_auc: 0.75678 | valid_balanced_accuracy: 0.68946 | valid_accuracy: 0.6898  |  0:20:04s
epoch 73 | loss: 0.5658  | train_auc: 0.78763 | train_balanced_accuracy: 0.71277 | train_accuracy: 0.71305 | valid_auc: 0.7587  | valid_balanced_accuracy: 0.69092 | valid_accuracy: 0.69122 |  0:20:20s
epoch 74 | loss: 0.56475 | train_auc: 0.78962 | train_balanced_accuracy: 0.71608 | train_accuracy: 0.71632 | valid_auc: 0.75997 | valid_balanced_accuracy: 0.69522 | valid_accuracy: 0.69547 |  0:20:36s
epoch 75 | loss: 0.56394 | train_auc: 0.78999 | train_balanced_accuracy: 0.71465 | train_accuracy: 0.71459 | valid_auc: 0.75889 | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69248 |  0:20:52s
epoch 76 | loss: 0.56472 | train_auc: 0.79168 | train_balanced_accuracy: 0.71649 | train_accuracy: 0.7164  | valid_auc: 0.76082 | valid_balanced_accuracy: 0.69255 | valid_accuracy: 0.69248 |  0:21:10s
epoch 77 | loss: 0.56143 | train_auc: 0.7906  | train_balanced_accuracy: 0.71444 | train_accuracy: 0.71463 | valid_auc: 0.75788 | valid_balanced_accuracy: 0.68944 | valid_accuracy: 0.68964 |  0:21:28s
epoch 78 | loss: 0.55486 | train_auc: 0.7934  | train_balanced_accuracy: 0.71864 | train_accuracy: 0.71872 | valid_auc: 0.75984 | valid_balanced_accuracy: 0.69115 | valid_accuracy: 0.69122 |  0:21:44s
epoch 79 | loss: 0.55721 | train_auc: 0.78166 | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70707 | valid_auc: 0.74962 | valid_balanced_accuracy: 0.68414 | valid_accuracy: 0.68429 |  0:22:00s
epoch 80 | loss: 0.56161 | train_auc: 0.79036 | train_balanced_accuracy: 0.71443 | train_accuracy: 0.71447 | valid_auc: 0.75761 | valid_balanced_accuracy: 0.68726 | valid_accuracy: 0.68728 |  0:22:17s
epoch 81 | loss: 0.56291 | train_auc: 0.78915 | train_balanced_accuracy: 0.71213 | train_accuracy: 0.7125  | valid_auc: 0.75771 | valid_balanced_accuracy: 0.68771 | valid_accuracy: 0.68807 |  0:22:33s
epoch 82 | loss: 0.56166 | train_auc: 0.78634 | train_balanced_accuracy: 0.71256 | train_accuracy: 0.71282 | valid_auc: 0.75659 | valid_balanced_accuracy: 0.68562 | valid_accuracy: 0.68587 |  0:22:48s
epoch 83 | loss: 0.55381 | train_auc: 0.79212 | train_balanced_accuracy: 0.71732 | train_accuracy: 0.7175  | valid_auc: 0.75693 | valid_balanced_accuracy: 0.68774 | valid_accuracy: 0.68791 |  0:23:05s
epoch 84 | loss: 0.55356 | train_auc: 0.79205 | train_balanced_accuracy: 0.71602 | train_accuracy: 0.71624 | valid_auc: 0.75512 | valid_balanced_accuracy: 0.68505 | valid_accuracy: 0.68524 |  0:23:20s
epoch 85 | loss: 0.55862 | train_auc: 0.79248 | train_balanced_accuracy: 0.71527 | train_accuracy: 0.71553 | valid_auc: 0.75441 | valid_balanced_accuracy: 0.68387 | valid_accuracy: 0.68414 |  0:23:37s
epoch 86 | loss: 0.55812 | train_auc: 0.79622 | train_balanced_accuracy: 0.7229  | train_accuracy: 0.72293 | valid_auc: 0.75672 | valid_balanced_accuracy: 0.6893  | valid_accuracy: 0.68933 |  0:23:54s
epoch 87 | loss: 0.55299 | train_auc: 0.79637 | train_balanced_accuracy: 0.71741 | train_accuracy: 0.71726 | valid_auc: 0.75635 | valid_balanced_accuracy: 0.68696 | valid_accuracy: 0.68681 |  0:24:12s
epoch 88 | loss: 0.55677 | train_auc: 0.79616 | train_balanced_accuracy: 0.72153 | train_accuracy: 0.72159 | valid_auc: 0.75609 | valid_balanced_accuracy: 0.68677 | valid_accuracy: 0.68681 |  0:24:29s
epoch 89 | loss: 0.55422 | train_auc: 0.79722 | train_balanced_accuracy: 0.71894 | train_accuracy: 0.71904 | valid_auc: 0.75846 | valid_balanced_accuracy: 0.69146 | valid_accuracy: 0.69153 |  0:24:47s
epoch 90 | loss: 0.55038 | train_auc: 0.79837 | train_balanced_accuracy: 0.71999 | train_accuracy: 0.71994 | valid_auc: 0.75844 | valid_balanced_accuracy: 0.68827 | valid_accuracy: 0.68823 |  0:25:02s
epoch 91 | loss: 0.55495 | train_auc: 0.79661 | train_balanced_accuracy: 0.72168 | train_accuracy: 0.72187 | valid_auc: 0.75751 | valid_balanced_accuracy: 0.69009 | valid_accuracy: 0.69027 |  0:25:19s
epoch 92 | loss: 0.55602 | train_auc: 0.79718 | train_balanced_accuracy: 0.72171 | train_accuracy: 0.72175 | valid_auc: 0.75694 | valid_balanced_accuracy: 0.68882 | valid_accuracy: 0.68886 |  0:25:36s
epoch 93 | loss: 0.55232 | train_auc: 0.7947  | train_balanced_accuracy: 0.71908 | train_accuracy: 0.71915 | valid_auc: 0.75527 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.68524 |  0:25:54s
epoch 94 | loss: 0.5613  | train_auc: 0.79927 | train_balanced_accuracy: 0.72167 | train_accuracy: 0.72195 | valid_auc: 0.7573  | valid_balanced_accuracy: 0.68642 | valid_accuracy: 0.68665 |  0:26:10s

Early stopping occurred at epoch 94 with best_epoch = 74 and best_valid_accuracy = 0.69547
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 50/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=26.3min
[CV 5/5; 50/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71977 | train_auc: 0.59567 | train_balanced_accuracy: 0.51017 | train_accuracy: 0.50689 | valid_auc: 0.59251 | valid_balanced_accuracy: 0.51263 | valid_accuracy: 0.50929 |  0:00:18s
epoch 1  | loss: 0.65593 | train_auc: 0.62666 | train_balanced_accuracy: 0.58938 | train_accuracy: 0.58849 | valid_auc: 0.63175 | valid_balanced_accuracy: 0.59403 | valid_accuracy: 0.59317 |  0:00:35s
epoch 2  | loss: 0.64411 | train_auc: 0.65112 | train_balanced_accuracy: 0.5951  | train_accuracy: 0.59376 | valid_auc: 0.64988 | valid_balanced_accuracy: 0.59442 | valid_accuracy: 0.59301 |  0:00:52s
epoch 3  | loss: 0.62935 | train_auc: 0.66077 | train_balanced_accuracy: 0.60813 | train_accuracy: 0.6069  | valid_auc: 0.65727 | valid_balanced_accuracy: 0.60561 | valid_accuracy: 0.60434 |  0:01:08s
epoch 4  | loss: 0.61567 | train_auc: 0.65853 | train_balanced_accuracy: 0.60828 | train_accuracy: 0.60753 | valid_auc: 0.65795 | valid_balanced_accuracy: 0.60744 | valid_accuracy: 0.6067  |  0:01:24s
epoch 5  | loss: 0.61526 | train_auc: 0.67114 | train_balanced_accuracy: 0.6159  | train_accuracy: 0.61524 | valid_auc: 0.67132 | valid_balanced_accuracy: 0.61786 | valid_accuracy: 0.61725 |  0:01:40s
epoch 6  | loss: 0.61643 | train_auc: 0.67392 | train_balanced_accuracy: 0.62369 | train_accuracy: 0.62339 | valid_auc: 0.67625 | valid_balanced_accuracy: 0.62621 | valid_accuracy: 0.6259  |  0:01:56s
epoch 7  | loss: 0.61272 | train_auc: 0.67395 | train_balanced_accuracy: 0.62457 | train_accuracy: 0.62402 | valid_auc: 0.67135 | valid_balanced_accuracy: 0.62109 | valid_accuracy: 0.62055 |  0:02:12s
epoch 8  | loss: 0.61131 | train_auc: 0.67861 | train_balanced_accuracy: 0.62446 | train_accuracy: 0.62398 | valid_auc: 0.67409 | valid_balanced_accuracy: 0.61993 | valid_accuracy: 0.61945 |  0:02:28s
epoch 9  | loss: 0.608   | train_auc: 0.68609 | train_balanced_accuracy: 0.62524 | train_accuracy: 0.62472 | valid_auc: 0.67945 | valid_balanced_accuracy: 0.62168 | valid_accuracy: 0.62118 |  0:02:45s
epoch 10 | loss: 0.60616 | train_auc: 0.69442 | train_balanced_accuracy: 0.62384 | train_accuracy: 0.62358 | valid_auc: 0.68638 | valid_balanced_accuracy: 0.61996 | valid_accuracy: 0.61977 |  0:03:03s
epoch 11 | loss: 0.60196 | train_auc: 0.69569 | train_balanced_accuracy: 0.62617 | train_accuracy: 0.62579 | valid_auc: 0.68752 | valid_balanced_accuracy: 0.62073 | valid_accuracy: 0.6204  |  0:03:20s
epoch 12 | loss: 0.60507 | train_auc: 0.70365 | train_balanced_accuracy: 0.63481 | train_accuracy: 0.6348  | valid_auc: 0.69845 | valid_balanced_accuracy: 0.63284 | valid_accuracy: 0.63283 |  0:03:37s
epoch 13 | loss: 0.60639 | train_auc: 0.70364 | train_balanced_accuracy: 0.63104 | train_accuracy: 0.63082 | valid_auc: 0.69854 | valid_balanced_accuracy: 0.62881 | valid_accuracy: 0.62858 |  0:03:54s
epoch 14 | loss: 0.5969  | train_auc: 0.70688 | train_balanced_accuracy: 0.63263 | train_accuracy: 0.63236 | valid_auc: 0.69953 | valid_balanced_accuracy: 0.63042 | valid_accuracy: 0.63015 |  0:04:10s
epoch 15 | loss: 0.59878 | train_auc: 0.71598 | train_balanced_accuracy: 0.64695 | train_accuracy: 0.64676 | valid_auc: 0.70706 | valid_balanced_accuracy: 0.64376 | valid_accuracy: 0.64353 |  0:04:26s
epoch 16 | loss: 0.60104 | train_auc: 0.72141 | train_balanced_accuracy: 0.64858 | train_accuracy: 0.64814 | valid_auc: 0.71243 | valid_balanced_accuracy: 0.64132 | valid_accuracy: 0.64086 |  0:04:42s
epoch 17 | loss: 0.60168 | train_auc: 0.7179  | train_balanced_accuracy: 0.6493  | train_accuracy: 0.649   | valid_auc: 0.70983 | valid_balanced_accuracy: 0.64432 | valid_accuracy: 0.644   |  0:05:01s
epoch 18 | loss: 0.59602 | train_auc: 0.7286  | train_balanced_accuracy: 0.66444 | train_accuracy: 0.66466 | valid_auc: 0.71733 | valid_balanced_accuracy: 0.6594  | valid_accuracy: 0.65958 |  0:05:17s
epoch 19 | loss: 0.59602 | train_auc: 0.73306 | train_balanced_accuracy: 0.66788 | train_accuracy: 0.66808 | valid_auc: 0.72225 | valid_balanced_accuracy: 0.66524 | valid_accuracy: 0.66541 |  0:05:34s
epoch 20 | loss: 0.596   | train_auc: 0.73327 | train_balanced_accuracy: 0.66965 | train_accuracy: 0.66977 | valid_auc: 0.72368 | valid_balanced_accuracy: 0.66346 | valid_accuracy: 0.66352 |  0:05:51s
epoch 21 | loss: 0.59328 | train_auc: 0.73646 | train_balanced_accuracy: 0.67472 | train_accuracy: 0.67497 | valid_auc: 0.72505 | valid_balanced_accuracy: 0.66914 | valid_accuracy: 0.66934 |  0:06:06s
epoch 22 | loss: 0.58991 | train_auc: 0.73739 | train_balanced_accuracy: 0.67533 | train_accuracy: 0.67576 | valid_auc: 0.72699 | valid_balanced_accuracy: 0.67141 | valid_accuracy: 0.67186 |  0:06:24s
epoch 23 | loss: 0.58915 | train_auc: 0.74486 | train_balanced_accuracy: 0.67976 | train_accuracy: 0.68004 | valid_auc: 0.73161 | valid_balanced_accuracy: 0.67082 | valid_accuracy: 0.67107 |  0:06:42s
epoch 24 | loss: 0.59427 | train_auc: 0.74396 | train_balanced_accuracy: 0.68398 | train_accuracy: 0.68461 | valid_auc: 0.7299  | valid_balanced_accuracy: 0.6783  | valid_accuracy: 0.67894 |  0:06:59s
epoch 25 | loss: 0.5891  | train_auc: 0.74587 | train_balanced_accuracy: 0.67743 | train_accuracy: 0.67729 | valid_auc: 0.73005 | valid_balanced_accuracy: 0.66525 | valid_accuracy: 0.66509 |  0:07:14s
epoch 26 | loss: 0.59284 | train_auc: 0.75476 | train_balanced_accuracy: 0.6914  | train_accuracy: 0.69181 | valid_auc: 0.74241 | valid_balanced_accuracy: 0.67949 | valid_accuracy: 0.67989 |  0:07:32s
epoch 27 | loss: 0.58631 | train_auc: 0.7492  | train_balanced_accuracy: 0.68409 | train_accuracy: 0.68425 | valid_auc: 0.73777 | valid_balanced_accuracy: 0.6744  | valid_accuracy: 0.67454 |  0:07:48s
epoch 28 | loss: 0.58519 | train_auc: 0.75613 | train_balanced_accuracy: 0.69128 | train_accuracy: 0.69173 | valid_auc: 0.7421  | valid_balanced_accuracy: 0.68309 | valid_accuracy: 0.68351 |  0:08:05s
epoch 29 | loss: 0.58844 | train_auc: 0.75067 | train_balanced_accuracy: 0.68504 | train_accuracy: 0.6854  | valid_auc: 0.73929 | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.67831 |  0:08:21s
epoch 30 | loss: 0.58812 | train_auc: 0.73558 | train_balanced_accuracy: 0.67384 | train_accuracy: 0.67398 | valid_auc: 0.73138 | valid_balanced_accuracy: 0.66747 | valid_accuracy: 0.66761 |  0:08:37s
epoch 31 | loss: 0.58378 | train_auc: 0.73539 | train_balanced_accuracy: 0.66931 | train_accuracy: 0.66946 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.66936 | valid_accuracy: 0.6695  |  0:08:53s
epoch 32 | loss: 0.58577 | train_auc: 0.69077 | train_balanced_accuracy: 0.64524 | train_accuracy: 0.64499 | valid_auc: 0.68807 | valid_balanced_accuracy: 0.64314 | valid_accuracy: 0.6429  |  0:09:09s
epoch 33 | loss: 0.58726 | train_auc: 0.75814 | train_balanced_accuracy: 0.69334 | train_accuracy: 0.69378 | valid_auc: 0.73622 | valid_balanced_accuracy: 0.67066 | valid_accuracy: 0.67107 |  0:09:28s
epoch 34 | loss: 0.57633 | train_auc: 0.756   | train_balanced_accuracy: 0.69042 | train_accuracy: 0.69075 | valid_auc: 0.73571 | valid_balanced_accuracy: 0.67454 | valid_accuracy: 0.67485 |  0:09:44s
epoch 35 | loss: 0.58464 | train_auc: 0.74042 | train_balanced_accuracy: 0.66739 | train_accuracy: 0.66714 | valid_auc: 0.72369 | valid_balanced_accuracy: 0.65593 | valid_accuracy: 0.65565 |  0:10:01s
epoch 36 | loss: 0.5756  | train_auc: 0.74205 | train_balanced_accuracy: 0.68013 | train_accuracy: 0.67993 | valid_auc: 0.72921 | valid_balanced_accuracy: 0.66795 | valid_accuracy: 0.66777 |  0:10:19s
epoch 37 | loss: 0.57768 | train_auc: 0.71412 | train_balanced_accuracy: 0.65968 | train_accuracy: 0.65974 | valid_auc: 0.71272 | valid_balanced_accuracy: 0.66169 | valid_accuracy: 0.66179 |  0:10:37s
epoch 38 | loss: 0.57925 | train_auc: 0.70465 | train_balanced_accuracy: 0.63119 | train_accuracy: 0.63035 | valid_auc: 0.70382 | valid_balanced_accuracy: 0.63283 | valid_accuracy: 0.63204 |  0:10:53s
epoch 39 | loss: 0.57933 | train_auc: 0.70184 | train_balanced_accuracy: 0.64932 | train_accuracy: 0.64939 | valid_auc: 0.70184 | valid_balanced_accuracy: 0.64861 | valid_accuracy: 0.64873 |  0:11:12s
epoch 40 | loss: 0.57413 | train_auc: 0.69833 | train_balanced_accuracy: 0.63695 | train_accuracy: 0.63669 | valid_auc: 0.69402 | valid_balanced_accuracy: 0.63591 | valid_accuracy: 0.63566 |  0:11:28s
epoch 41 | loss: 0.57771 | train_auc: 0.69289 | train_balanced_accuracy: 0.63352 | train_accuracy: 0.63366 | valid_auc: 0.69267 | valid_balanced_accuracy: 0.63397 | valid_accuracy: 0.63409 |  0:11:43s
epoch 42 | loss: 0.57841 | train_auc: 0.72688 | train_balanced_accuracy: 0.66378 | train_accuracy: 0.66427 | valid_auc: 0.72051 | valid_balanced_accuracy: 0.66017 | valid_accuracy: 0.66069 |  0:12:00s
epoch 43 | loss: 0.57691 | train_auc: 0.721   | train_balanced_accuracy: 0.66378 | train_accuracy: 0.66391 | valid_auc: 0.71516 | valid_balanced_accuracy: 0.66116 | valid_accuracy: 0.66132 |  0:12:16s
epoch 44 | loss: 0.57402 | train_auc: 0.76689 | train_balanced_accuracy: 0.69924 | train_accuracy: 0.69964 | valid_auc: 0.74738 | valid_balanced_accuracy: 0.6885  | valid_accuracy: 0.68886 |  0:12:33s
epoch 45 | loss: 0.57294 | train_auc: 0.70659 | train_balanced_accuracy: 0.6525  | train_accuracy: 0.65297 | valid_auc: 0.70107 | valid_balanced_accuracy: 0.65074 | valid_accuracy: 0.65124 |  0:12:50s
epoch 46 | loss: 0.57418 | train_auc: 0.70219 | train_balanced_accuracy: 0.65292 | train_accuracy: 0.65329 | valid_auc: 0.69727 | valid_balanced_accuracy: 0.64424 | valid_accuracy: 0.64463 |  0:13:08s
epoch 47 | loss: 0.57444 | train_auc: 0.71739 | train_balanced_accuracy: 0.65848 | train_accuracy: 0.65895 | valid_auc: 0.7017  | valid_balanced_accuracy: 0.64465 | valid_accuracy: 0.64511 |  0:13:26s
epoch 48 | loss: 0.57381 | train_auc: 0.73296 | train_balanced_accuracy: 0.67476 | train_accuracy: 0.67513 | valid_auc: 0.71792 | valid_balanced_accuracy: 0.66234 | valid_accuracy: 0.66273 |  0:13:44s
epoch 49 | loss: 0.57132 | train_auc: 0.72486 | train_balanced_accuracy: 0.66459 | train_accuracy: 0.66478 | valid_auc: 0.70975 | valid_balanced_accuracy: 0.6496  | valid_accuracy: 0.64983 |  0:14:01s
epoch 50 | loss: 0.56904 | train_auc: 0.76816 | train_balanced_accuracy: 0.69941 | train_accuracy: 0.69956 | valid_auc: 0.75034 | valid_balanced_accuracy: 0.68839 | valid_accuracy: 0.68854 |  0:14:15s
epoch 51 | loss: 0.57178 | train_auc: 0.77366 | train_balanced_accuracy: 0.70305 | train_accuracy: 0.70353 | valid_auc: 0.74568 | valid_balanced_accuracy: 0.68163 | valid_accuracy: 0.68209 |  0:14:32s
epoch 52 | loss: 0.56907 | train_auc: 0.75523 | train_balanced_accuracy: 0.68875 | train_accuracy: 0.68909 | valid_auc: 0.73095 | valid_balanced_accuracy: 0.66891 | valid_accuracy: 0.66918 |  0:14:51s
epoch 53 | loss: 0.57301 | train_auc: 0.76479 | train_balanced_accuracy: 0.69433 | train_accuracy: 0.69464 | valid_auc: 0.73968 | valid_balanced_accuracy: 0.67897 | valid_accuracy: 0.67926 |  0:15:08s
epoch 54 | loss: 0.57155 | train_auc: 0.75847 | train_balanced_accuracy: 0.69195 | train_accuracy: 0.69212 | valid_auc: 0.74012 | valid_balanced_accuracy: 0.67563 | valid_accuracy: 0.67579 |  0:15:26s
epoch 55 | loss: 0.57337 | train_auc: 0.75131 | train_balanced_accuracy: 0.68678 | train_accuracy: 0.68658 | valid_auc: 0.7349  | valid_balanced_accuracy: 0.6689  | valid_accuracy: 0.66871 |  0:15:44s
epoch 56 | loss: 0.5706  | train_auc: 0.77761 | train_balanced_accuracy: 0.705   | train_accuracy: 0.70507 | valid_auc: 0.74871 | valid_balanced_accuracy: 0.68264 | valid_accuracy: 0.68272 |  0:16:00s
epoch 57 | loss: 0.56896 | train_auc: 0.77125 | train_balanced_accuracy: 0.69875 | train_accuracy: 0.69905 | valid_auc: 0.73924 | valid_balanced_accuracy: 0.67617 | valid_accuracy: 0.67642 |  0:16:18s
epoch 58 | loss: 0.56764 | train_auc: 0.73698 | train_balanced_accuracy: 0.67179 | train_accuracy: 0.67166 | valid_auc: 0.71813 | valid_balanced_accuracy: 0.65989 | valid_accuracy: 0.65974 |  0:16:34s
epoch 59 | loss: 0.57276 | train_auc: 0.7181  | train_balanced_accuracy: 0.66141 | train_accuracy: 0.66167 | valid_auc: 0.70691 | valid_balanced_accuracy: 0.65584 | valid_accuracy: 0.65612 |  0:16:52s
epoch 60 | loss: 0.5708  | train_auc: 0.73792 | train_balanced_accuracy: 0.67498 | train_accuracy: 0.67509 | valid_auc: 0.72475 | valid_balanced_accuracy: 0.66213 | valid_accuracy: 0.66226 |  0:17:09s
epoch 61 | loss: 0.57038 | train_auc: 0.76506 | train_balanced_accuracy: 0.69557 | train_accuracy: 0.69602 | valid_auc: 0.73581 | valid_balanced_accuracy: 0.67409 | valid_accuracy: 0.67454 |  0:17:25s
epoch 62 | loss: 0.55967 | train_auc: 0.75363 | train_balanced_accuracy: 0.6838  | train_accuracy: 0.68394 | valid_auc: 0.7295  | valid_balanced_accuracy: 0.66878 | valid_accuracy: 0.66887 |  0:17:42s
epoch 63 | loss: 0.56442 | train_auc: 0.71596 | train_balanced_accuracy: 0.66273 | train_accuracy: 0.66289 | valid_auc: 0.70952 | valid_balanced_accuracy: 0.65629 | valid_accuracy: 0.65644 |  0:18:00s
epoch 64 | loss: 0.56072 | train_auc: 0.72288 | train_balanced_accuracy: 0.66562 | train_accuracy: 0.66564 | valid_auc: 0.71457 | valid_balanced_accuracy: 0.66243 | valid_accuracy: 0.66242 |  0:18:15s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.68886
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 50/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=18.4min
[CV 1/5; 51/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83059 | train_auc: 0.52868 | train_balanced_accuracy: 0.52048 | train_accuracy: 0.51883 | valid_auc: 0.52005 | valid_balanced_accuracy: 0.51777 | valid_accuracy: 0.51605 |  0:00:15s
epoch 1  | loss: 0.75907 | train_auc: 0.53334 | train_balanced_accuracy: 0.52173 | train_accuracy: 0.5195  | valid_auc: 0.5239  | valid_balanced_accuracy: 0.51689 | valid_accuracy: 0.51464 |  0:00:31s
epoch 2  | loss: 0.71429 | train_auc: 0.54858 | train_balanced_accuracy: 0.5254  | train_accuracy: 0.52288 | valid_auc: 0.53855 | valid_balanced_accuracy: 0.52275 | valid_accuracy: 0.52014 |  0:00:48s
epoch 3  | loss: 0.69127 | train_auc: 0.56394 | train_balanced_accuracy: 0.53449 | train_accuracy: 0.53209 | valid_auc: 0.55475 | valid_balanced_accuracy: 0.52938 | valid_accuracy: 0.52691 |  0:01:05s
epoch 4  | loss: 0.67558 | train_auc: 0.57486 | train_balanced_accuracy: 0.54353 | train_accuracy: 0.54126 | valid_auc: 0.56709 | valid_balanced_accuracy: 0.53542 | valid_accuracy: 0.53305 |  0:01:21s
epoch 5  | loss: 0.67382 | train_auc: 0.57913 | train_balanced_accuracy: 0.55064 | train_accuracy: 0.54838 | valid_auc: 0.57185 | valid_balanced_accuracy: 0.53998 | valid_accuracy: 0.53761 |  0:01:37s
epoch 6  | loss: 0.67298 | train_auc: 0.58385 | train_balanced_accuracy: 0.55694 | train_accuracy: 0.55483 | valid_auc: 0.57652 | valid_balanced_accuracy: 0.54939 | valid_accuracy: 0.54721 |  0:01:53s
epoch 7  | loss: 0.66629 | train_auc: 0.59601 | train_balanced_accuracy: 0.56147 | train_accuracy: 0.55939 | valid_auc: 0.5857  | valid_balanced_accuracy: 0.55151 | valid_accuracy: 0.54942 |  0:02:10s
epoch 8  | loss: 0.65692 | train_auc: 0.60922 | train_balanced_accuracy: 0.57196 | train_accuracy: 0.57033 | valid_auc: 0.59513 | valid_balanced_accuracy: 0.55865 | valid_accuracy: 0.55697 |  0:02:28s
epoch 9  | loss: 0.65924 | train_auc: 0.62008 | train_balanced_accuracy: 0.57482 | train_accuracy: 0.57317 | valid_auc: 0.60478 | valid_balanced_accuracy: 0.55863 | valid_accuracy: 0.55697 |  0:02:46s
epoch 10 | loss: 0.65381 | train_auc: 0.63139 | train_balanced_accuracy: 0.58003 | train_accuracy: 0.5786  | valid_auc: 0.61652 | valid_balanced_accuracy: 0.56191 | valid_accuracy: 0.56043 |  0:03:04s
epoch 11 | loss: 0.65097 | train_auc: 0.63997 | train_balanced_accuracy: 0.58602 | train_accuracy: 0.58477 | valid_auc: 0.62787 | valid_balanced_accuracy: 0.57303 | valid_accuracy: 0.57177 |  0:03:21s
epoch 12 | loss: 0.64605 | train_auc: 0.64574 | train_balanced_accuracy: 0.58607 | train_accuracy: 0.58477 | valid_auc: 0.63649 | valid_balanced_accuracy: 0.57827 | valid_accuracy: 0.57696 |  0:03:37s
epoch 13 | loss: 0.64845 | train_auc: 0.64829 | train_balanced_accuracy: 0.58861 | train_accuracy: 0.58741 | valid_auc: 0.64112 | valid_balanced_accuracy: 0.58072 | valid_accuracy: 0.57948 |  0:03:54s
epoch 14 | loss: 0.64382 | train_auc: 0.65915 | train_balanced_accuracy: 0.59642 | train_accuracy: 0.59548 | valid_auc: 0.65091 | valid_balanced_accuracy: 0.58645 | valid_accuracy: 0.58546 |  0:04:10s
epoch 15 | loss: 0.64265 | train_auc: 0.66737 | train_balanced_accuracy: 0.60567 | train_accuracy: 0.60496 | valid_auc: 0.65849 | valid_balanced_accuracy: 0.59426 | valid_accuracy: 0.59348 |  0:04:28s
epoch 16 | loss: 0.63722 | train_auc: 0.67128 | train_balanced_accuracy: 0.61312 | train_accuracy: 0.61267 | valid_auc: 0.6637  | valid_balanced_accuracy: 0.6039  | valid_accuracy: 0.6034  |  0:04:44s
epoch 17 | loss: 0.64169 | train_auc: 0.67134 | train_balanced_accuracy: 0.61197 | train_accuracy: 0.61137 | valid_auc: 0.66463 | valid_balanced_accuracy: 0.59951 | valid_accuracy: 0.59884 |  0:05:02s
epoch 18 | loss: 0.63334 | train_auc: 0.67505 | train_balanced_accuracy: 0.62313 | train_accuracy: 0.62302 | valid_auc: 0.66601 | valid_balanced_accuracy: 0.61191 | valid_accuracy: 0.61174 |  0:05:17s
epoch 19 | loss: 0.63277 | train_auc: 0.67569 | train_balanced_accuracy: 0.62191 | train_accuracy: 0.62172 | valid_auc: 0.66647 | valid_balanced_accuracy: 0.61464 | valid_accuracy: 0.61442 |  0:05:34s
epoch 20 | loss: 0.63519 | train_auc: 0.67154 | train_balanced_accuracy: 0.62043 | train_accuracy: 0.62018 | valid_auc: 0.66391 | valid_balanced_accuracy: 0.61375 | valid_accuracy: 0.61347 |  0:05:50s
epoch 21 | loss: 0.6305  | train_auc: 0.682   | train_balanced_accuracy: 0.63524 | train_accuracy: 0.63541 | valid_auc: 0.67489 | valid_balanced_accuracy: 0.63061 | valid_accuracy: 0.63078 |  0:06:10s
epoch 22 | loss: 0.63303 | train_auc: 0.68402 | train_balanced_accuracy: 0.636   | train_accuracy: 0.6362  | valid_auc: 0.67911 | valid_balanced_accuracy: 0.63672 | valid_accuracy: 0.63692 |  0:06:27s
epoch 23 | loss: 0.63044 | train_auc: 0.68751 | train_balanced_accuracy: 0.642   | train_accuracy: 0.64238 | valid_auc: 0.68117 | valid_balanced_accuracy: 0.64545 | valid_accuracy: 0.64589 |  0:06:44s
epoch 24 | loss: 0.63461 | train_auc: 0.69195 | train_balanced_accuracy: 0.64451 | train_accuracy: 0.64486 | valid_auc: 0.68093 | valid_balanced_accuracy: 0.63855 | valid_accuracy: 0.63897 |  0:07:01s
epoch 25 | loss: 0.62994 | train_auc: 0.69076 | train_balanced_accuracy: 0.64212 | train_accuracy: 0.64238 | valid_auc: 0.67889 | valid_balanced_accuracy: 0.63979 | valid_accuracy: 0.64007 |  0:07:17s
epoch 26 | loss: 0.63017 | train_auc: 0.69753 | train_balanced_accuracy: 0.64981 | train_accuracy: 0.65013 | valid_auc: 0.68636 | valid_balanced_accuracy: 0.64444 | valid_accuracy: 0.64479 |  0:07:35s
epoch 27 | loss: 0.62868 | train_auc: 0.70315 | train_balanced_accuracy: 0.65651 | train_accuracy: 0.6569  | valid_auc: 0.68984 | valid_balanced_accuracy: 0.64989 | valid_accuracy: 0.6503  |  0:07:51s
epoch 28 | loss: 0.6272  | train_auc: 0.70481 | train_balanced_accuracy: 0.65774 | train_accuracy: 0.65815 | valid_auc: 0.69232 | valid_balanced_accuracy: 0.64781 | valid_accuracy: 0.64825 |  0:08:09s
epoch 29 | loss: 0.62432 | train_auc: 0.70968 | train_balanced_accuracy: 0.65811 | train_accuracy: 0.65847 | valid_auc: 0.69592 | valid_balanced_accuracy: 0.64835 | valid_accuracy: 0.64873 |  0:08:25s
epoch 30 | loss: 0.62496 | train_auc: 0.70834 | train_balanced_accuracy: 0.65689 | train_accuracy: 0.65729 | valid_auc: 0.69476 | valid_balanced_accuracy: 0.6442  | valid_accuracy: 0.64463 |  0:08:40s
epoch 31 | loss: 0.62197 | train_auc: 0.70995 | train_balanced_accuracy: 0.65924 | train_accuracy: 0.65969 | valid_auc: 0.69478 | valid_balanced_accuracy: 0.64712 | valid_accuracy: 0.64762 |  0:08:58s
epoch 32 | loss: 0.62636 | train_auc: 0.70686 | train_balanced_accuracy: 0.65529 | train_accuracy: 0.65564 | valid_auc: 0.69705 | valid_balanced_accuracy: 0.64562 | valid_accuracy: 0.64605 |  0:09:15s
epoch 33 | loss: 0.62307 | train_auc: 0.70769 | train_balanced_accuracy: 0.65556 | train_accuracy: 0.65583 | valid_auc: 0.69703 | valid_balanced_accuracy: 0.64966 | valid_accuracy: 0.64998 |  0:09:31s
epoch 34 | loss: 0.62048 | train_auc: 0.71239 | train_balanced_accuracy: 0.65756 | train_accuracy: 0.6578  | valid_auc: 0.69528 | valid_balanced_accuracy: 0.64483 | valid_accuracy: 0.64511 |  0:09:48s
epoch 35 | loss: 0.61856 | train_auc: 0.70818 | train_balanced_accuracy: 0.65677 | train_accuracy: 0.65725 | valid_auc: 0.69681 | valid_balanced_accuracy: 0.64458 | valid_accuracy: 0.64511 |  0:10:06s
epoch 36 | loss: 0.62279 | train_auc: 0.69287 | train_balanced_accuracy: 0.64051 | train_accuracy: 0.64072 | valid_auc: 0.67409 | valid_balanced_accuracy: 0.62681 | valid_accuracy: 0.62701 |  0:10:21s
epoch 37 | loss: 0.61737 | train_auc: 0.68137 | train_balanced_accuracy: 0.6328  | train_accuracy: 0.63317 | valid_auc: 0.66525 | valid_balanced_accuracy: 0.62296 | valid_accuracy: 0.62323 |  0:10:38s
epoch 38 | loss: 0.61908 | train_auc: 0.68186 | train_balanced_accuracy: 0.63212 | train_accuracy: 0.63238 | valid_auc: 0.66692 | valid_balanced_accuracy: 0.62212 | valid_accuracy: 0.62229 |  0:10:54s
epoch 39 | loss: 0.61844 | train_auc: 0.66915 | train_balanced_accuracy: 0.6235  | train_accuracy: 0.62392 | valid_auc: 0.66062 | valid_balanced_accuracy: 0.61967 | valid_accuracy: 0.62008 |  0:11:10s
epoch 40 | loss: 0.61701 | train_auc: 0.65586 | train_balanced_accuracy: 0.61675 | train_accuracy: 0.61716 | valid_auc: 0.64831 | valid_balanced_accuracy: 0.61244 | valid_accuracy: 0.61284 |  0:11:27s
epoch 41 | loss: 0.61717 | train_auc: 0.65461 | train_balanced_accuracy: 0.61366 | train_accuracy: 0.61405 | valid_auc: 0.64825 | valid_balanced_accuracy: 0.6121  | valid_accuracy: 0.61253 |  0:11:44s
epoch 42 | loss: 0.61311 | train_auc: 0.651   | train_balanced_accuracy: 0.61026 | train_accuracy: 0.61086 | valid_auc: 0.6391  | valid_balanced_accuracy: 0.61041 | valid_accuracy: 0.61095 |  0:12:01s
epoch 43 | loss: 0.6168  | train_auc: 0.6548  | train_balanced_accuracy: 0.61274 | train_accuracy: 0.61314 | valid_auc: 0.64331 | valid_balanced_accuracy: 0.61154 | valid_accuracy: 0.6119  |  0:12:17s
epoch 44 | loss: 0.61382 | train_auc: 0.6578  | train_balanced_accuracy: 0.61648 | train_accuracy: 0.61692 | valid_auc: 0.65007 | valid_balanced_accuracy: 0.61191 | valid_accuracy: 0.61237 |  0:12:33s
epoch 45 | loss: 0.61573 | train_auc: 0.6913  | train_balanced_accuracy: 0.6385  | train_accuracy: 0.63887 | valid_auc: 0.67931 | valid_balanced_accuracy: 0.62766 | valid_accuracy: 0.62795 |  0:12:48s
epoch 46 | loss: 0.6146  | train_auc: 0.7092  | train_balanced_accuracy: 0.65744 | train_accuracy: 0.65776 | valid_auc: 0.69566 | valid_balanced_accuracy: 0.64293 | valid_accuracy: 0.64322 |  0:13:06s
epoch 47 | loss: 0.61369 | train_auc: 0.69894 | train_balanced_accuracy: 0.64659 | train_accuracy: 0.64686 | valid_auc: 0.68617 | valid_balanced_accuracy: 0.63546 | valid_accuracy: 0.63566 |  0:13:21s

Early stopping occurred at epoch 47 with best_epoch = 27 and best_valid_accuracy = 0.6503
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 51/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.660 total time=13.5min
[CV 2/5; 51/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83005 | train_auc: 0.52053 | train_balanced_accuracy: 0.51991 | train_accuracy: 0.51757 | valid_auc: 0.51328 | valid_balanced_accuracy: 0.51262 | valid_accuracy: 0.51023 |  0:00:15s
epoch 1  | loss: 0.75262 | train_auc: 0.53047 | train_balanced_accuracy: 0.52129 | train_accuracy: 0.51879 | valid_auc: 0.51971 | valid_balanced_accuracy: 0.51186 | valid_accuracy: 0.50929 |  0:00:30s
epoch 2  | loss: 0.71586 | train_auc: 0.54148 | train_balanced_accuracy: 0.51973 | train_accuracy: 0.51706 | valid_auc: 0.53822 | valid_balanced_accuracy: 0.51332 | valid_accuracy: 0.51054 |  0:00:47s
epoch 3  | loss: 0.69519 | train_auc: 0.54479 | train_balanced_accuracy: 0.52218 | train_accuracy: 0.51961 | valid_auc: 0.54206 | valid_balanced_accuracy: 0.51713 | valid_accuracy: 0.51448 |  0:01:03s
epoch 4  | loss: 0.68497 | train_auc: 0.55182 | train_balanced_accuracy: 0.52333 | train_accuracy: 0.52068 | valid_auc: 0.55181 | valid_balanced_accuracy: 0.51395 | valid_accuracy: 0.51117 |  0:01:19s
epoch 5  | loss: 0.67946 | train_auc: 0.56279 | train_balanced_accuracy: 0.53076 | train_accuracy: 0.52815 | valid_auc: 0.56697 | valid_balanced_accuracy: 0.52538 | valid_accuracy: 0.52266 |  0:01:36s
epoch 6  | loss: 0.67535 | train_auc: 0.57017 | train_balanced_accuracy: 0.54537 | train_accuracy: 0.54314 | valid_auc: 0.57508 | valid_balanced_accuracy: 0.54102 | valid_accuracy: 0.53872 |  0:01:52s
epoch 7  | loss: 0.66797 | train_auc: 0.58435 | train_balanced_accuracy: 0.54808 | train_accuracy: 0.54586 | valid_auc: 0.58832 | valid_balanced_accuracy: 0.54526 | valid_accuracy: 0.54297 |  0:02:07s
epoch 8  | loss: 0.65963 | train_auc: 0.59628 | train_balanced_accuracy: 0.55244 | train_accuracy: 0.55023 | valid_auc: 0.59924 | valid_balanced_accuracy: 0.54732 | valid_accuracy: 0.54501 |  0:02:24s
epoch 9  | loss: 0.66295 | train_auc: 0.6129  | train_balanced_accuracy: 0.56264 | train_accuracy: 0.56061 | valid_auc: 0.61267 | valid_balanced_accuracy: 0.55403 | valid_accuracy: 0.55194 |  0:02:41s
epoch 10 | loss: 0.65502 | train_auc: 0.62512 | train_balanced_accuracy: 0.57024 | train_accuracy: 0.5684  | valid_auc: 0.62368 | valid_balanced_accuracy: 0.57047 | valid_accuracy: 0.56862 |  0:02:59s
epoch 11 | loss: 0.65254 | train_auc: 0.63582 | train_balanced_accuracy: 0.58349 | train_accuracy: 0.58202 | valid_auc: 0.63378 | valid_balanced_accuracy: 0.5799  | valid_accuracy: 0.57838 |  0:03:15s
epoch 12 | loss: 0.64959 | train_auc: 0.64374 | train_balanced_accuracy: 0.59467 | train_accuracy: 0.59347 | valid_auc: 0.6402  | valid_balanced_accuracy: 0.58953 | valid_accuracy: 0.58829 |  0:03:32s
epoch 13 | loss: 0.64906 | train_auc: 0.65186 | train_balanced_accuracy: 0.60112 | train_accuracy: 0.60004 | valid_auc: 0.64734 | valid_balanced_accuracy: 0.5949  | valid_accuracy: 0.5938  |  0:03:50s
epoch 14 | loss: 0.64931 | train_auc: 0.66086 | train_balanced_accuracy: 0.60859 | train_accuracy: 0.60767 | valid_auc: 0.65554 | valid_balanced_accuracy: 0.60182 | valid_accuracy: 0.60088 |  0:04:08s
epoch 15 | loss: 0.6435  | train_auc: 0.66671 | train_balanced_accuracy: 0.6144  | train_accuracy: 0.61357 | valid_auc: 0.66277 | valid_balanced_accuracy: 0.60787 | valid_accuracy: 0.60702 |  0:04:25s
epoch 16 | loss: 0.64373 | train_auc: 0.67674 | train_balanced_accuracy: 0.62375 | train_accuracy: 0.62302 | valid_auc: 0.67114 | valid_balanced_accuracy: 0.62115 | valid_accuracy: 0.6204  |  0:04:42s
epoch 17 | loss: 0.64009 | train_auc: 0.68242 | train_balanced_accuracy: 0.63208 | train_accuracy: 0.63148 | valid_auc: 0.67624 | valid_balanced_accuracy: 0.62542 | valid_accuracy: 0.6248  |  0:05:00s
epoch 18 | loss: 0.6382  | train_auc: 0.68739 | train_balanced_accuracy: 0.63886 | train_accuracy: 0.63868 | valid_auc: 0.68018 | valid_balanced_accuracy: 0.63698 | valid_accuracy: 0.63676 |  0:05:17s
epoch 19 | loss: 0.63517 | train_auc: 0.69231 | train_balanced_accuracy: 0.64265 | train_accuracy: 0.64246 | valid_auc: 0.68359 | valid_balanced_accuracy: 0.63605 | valid_accuracy: 0.63582 |  0:05:35s
epoch 20 | loss: 0.63792 | train_auc: 0.69736 | train_balanced_accuracy: 0.6448  | train_accuracy: 0.64478 | valid_auc: 0.68979 | valid_balanced_accuracy: 0.63887 | valid_accuracy: 0.63881 |  0:05:49s
epoch 21 | loss: 0.6332  | train_auc: 0.69915 | train_balanced_accuracy: 0.64889 | train_accuracy: 0.64907 | valid_auc: 0.69237 | valid_balanced_accuracy: 0.64578 | valid_accuracy: 0.64589 |  0:06:07s
epoch 22 | loss: 0.63616 | train_auc: 0.69958 | train_balanced_accuracy: 0.64943 | train_accuracy: 0.64977 | valid_auc: 0.69391 | valid_balanced_accuracy: 0.6437  | valid_accuracy: 0.644   |  0:06:24s
epoch 23 | loss: 0.63364 | train_auc: 0.70012 | train_balanced_accuracy: 0.64857 | train_accuracy: 0.64883 | valid_auc: 0.69518 | valid_balanced_accuracy: 0.64396 | valid_accuracy: 0.64416 |  0:06:42s
epoch 24 | loss: 0.63085 | train_auc: 0.70333 | train_balanced_accuracy: 0.64964 | train_accuracy: 0.64997 | valid_auc: 0.69706 | valid_balanced_accuracy: 0.64799 | valid_accuracy: 0.64825 |  0:06:59s
epoch 25 | loss: 0.63173 | train_auc: 0.70425 | train_balanced_accuracy: 0.64925 | train_accuracy: 0.64966 | valid_auc: 0.69806 | valid_balanced_accuracy: 0.64792 | valid_accuracy: 0.64825 |  0:07:15s
epoch 26 | loss: 0.62825 | train_auc: 0.7065  | train_balanced_accuracy: 0.65231 | train_accuracy: 0.65272 | valid_auc: 0.69879 | valid_balanced_accuracy: 0.64868 | valid_accuracy: 0.64904 |  0:07:33s
epoch 27 | loss: 0.63067 | train_auc: 0.7103  | train_balanced_accuracy: 0.65684 | train_accuracy: 0.65729 | valid_auc: 0.70102 | valid_balanced_accuracy: 0.64847 | valid_accuracy: 0.64888 |  0:07:50s
epoch 28 | loss: 0.62725 | train_auc: 0.71134 | train_balanced_accuracy: 0.65719 | train_accuracy: 0.65764 | valid_auc: 0.69977 | valid_balanced_accuracy: 0.64927 | valid_accuracy: 0.64967 |  0:08:07s
epoch 29 | loss: 0.62762 | train_auc: 0.71248 | train_balanced_accuracy: 0.65706 | train_accuracy: 0.65749 | valid_auc: 0.70131 | valid_balanced_accuracy: 0.64773 | valid_accuracy: 0.6481  |  0:08:21s
epoch 30 | loss: 0.62407 | train_auc: 0.71441 | train_balanced_accuracy: 0.65867 | train_accuracy: 0.6591  | valid_auc: 0.7049  | valid_balanced_accuracy: 0.64712 | valid_accuracy: 0.64747 |  0:08:37s
epoch 31 | loss: 0.62451 | train_auc: 0.7158  | train_balanced_accuracy: 0.65849 | train_accuracy: 0.65886 | valid_auc: 0.70707 | valid_balanced_accuracy: 0.64877 | valid_accuracy: 0.64904 |  0:08:53s
epoch 32 | loss: 0.62559 | train_auc: 0.71804 | train_balanced_accuracy: 0.65924 | train_accuracy: 0.65961 | valid_auc: 0.70944 | valid_balanced_accuracy: 0.6519  | valid_accuracy: 0.65219 |  0:09:10s
epoch 33 | loss: 0.62438 | train_auc: 0.71767 | train_balanced_accuracy: 0.65977 | train_accuracy: 0.66008 | valid_auc: 0.70923 | valid_balanced_accuracy: 0.65163 | valid_accuracy: 0.65187 |  0:09:29s
epoch 34 | loss: 0.62371 | train_auc: 0.71774 | train_balanced_accuracy: 0.6599  | train_accuracy: 0.6602  | valid_auc: 0.70996 | valid_balanced_accuracy: 0.65696 | valid_accuracy: 0.65722 |  0:09:45s
epoch 35 | loss: 0.61891 | train_auc: 0.71855 | train_balanced_accuracy: 0.66026 | train_accuracy: 0.66075 | valid_auc: 0.71142 | valid_balanced_accuracy: 0.65643 | valid_accuracy: 0.65691 |  0:10:01s
epoch 36 | loss: 0.61952 | train_auc: 0.72052 | train_balanced_accuracy: 0.6602  | train_accuracy: 0.66048 | valid_auc: 0.71361 | valid_balanced_accuracy: 0.65495 | valid_accuracy: 0.65518 |  0:10:16s
epoch 37 | loss: 0.6209  | train_auc: 0.7215  | train_balanced_accuracy: 0.66106 | train_accuracy: 0.66146 | valid_auc: 0.71385 | valid_balanced_accuracy: 0.65639 | valid_accuracy: 0.65675 |  0:10:34s
epoch 38 | loss: 0.62199 | train_auc: 0.72288 | train_balanced_accuracy: 0.66109 | train_accuracy: 0.66138 | valid_auc: 0.71576 | valid_balanced_accuracy: 0.65857 | valid_accuracy: 0.6588  |  0:10:50s
epoch 39 | loss: 0.61766 | train_auc: 0.72085 | train_balanced_accuracy: 0.65992 | train_accuracy: 0.66028 | valid_auc: 0.71548 | valid_balanced_accuracy: 0.65818 | valid_accuracy: 0.65848 |  0:11:07s
epoch 40 | loss: 0.62107 | train_auc: 0.72031 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.66134 | valid_auc: 0.71584 | valid_balanced_accuracy: 0.66133 | valid_accuracy: 0.66163 |  0:11:24s
epoch 41 | loss: 0.62131 | train_auc: 0.72561 | train_balanced_accuracy: 0.66635 | train_accuracy: 0.66673 | valid_auc: 0.71815 | valid_balanced_accuracy: 0.66148 | valid_accuracy: 0.66179 |  0:11:42s
epoch 42 | loss: 0.61648 | train_auc: 0.7276  | train_balanced_accuracy: 0.66725 | train_accuracy: 0.66756 | valid_auc: 0.72018 | valid_balanced_accuracy: 0.6642  | valid_accuracy: 0.66446 |  0:12:00s
epoch 43 | loss: 0.62013 | train_auc: 0.72611 | train_balanced_accuracy: 0.66539 | train_accuracy: 0.66559 | valid_auc: 0.72031 | valid_balanced_accuracy: 0.66185 | valid_accuracy: 0.66195 |  0:12:15s
epoch 44 | loss: 0.61297 | train_auc: 0.71448 | train_balanced_accuracy: 0.65415 | train_accuracy: 0.65446 | valid_auc: 0.71235 | valid_balanced_accuracy: 0.65364 | valid_accuracy: 0.65392 |  0:12:30s
epoch 45 | loss: 0.61488 | train_auc: 0.71463 | train_balanced_accuracy: 0.65354 | train_accuracy: 0.65371 | valid_auc: 0.7123  | valid_balanced_accuracy: 0.65319 | valid_accuracy: 0.65329 |  0:12:47s
epoch 46 | loss: 0.61383 | train_auc: 0.71995 | train_balanced_accuracy: 0.65873 | train_accuracy: 0.6589  | valid_auc: 0.71534 | valid_balanced_accuracy: 0.65538 | valid_accuracy: 0.65549 |  0:13:03s
epoch 47 | loss: 0.61659 | train_auc: 0.7169  | train_balanced_accuracy: 0.65627 | train_accuracy: 0.65634 | valid_auc: 0.71244 | valid_balanced_accuracy: 0.65096 | valid_accuracy: 0.65093 |  0:13:18s
epoch 48 | loss: 0.61074 | train_auc: 0.72237 | train_balanced_accuracy: 0.66222 | train_accuracy: 0.66256 | valid_auc: 0.7165  | valid_balanced_accuracy: 0.66011 | valid_accuracy: 0.66037 |  0:13:36s
epoch 49 | loss: 0.61404 | train_auc: 0.72516 | train_balanced_accuracy: 0.6643  | train_accuracy: 0.66453 | valid_auc: 0.71904 | valid_balanced_accuracy: 0.65923 | valid_accuracy: 0.65943 |  0:13:54s
epoch 50 | loss: 0.61142 | train_auc: 0.7234  | train_balanced_accuracy: 0.66164 | train_accuracy: 0.66181 | valid_auc: 0.71683 | valid_balanced_accuracy: 0.65695 | valid_accuracy: 0.65707 |  0:14:12s
epoch 51 | loss: 0.60949 | train_auc: 0.72631 | train_balanced_accuracy: 0.66524 | train_accuracy: 0.66555 | valid_auc: 0.72028 | valid_balanced_accuracy: 0.66372 | valid_accuracy: 0.66399 |  0:14:28s
epoch 52 | loss: 0.61051 | train_auc: 0.72913 | train_balanced_accuracy: 0.66668 | train_accuracy: 0.66693 | valid_auc: 0.72357 | valid_balanced_accuracy: 0.6663  | valid_accuracy: 0.66651 |  0:14:45s
epoch 53 | loss: 0.61237 | train_auc: 0.72515 | train_balanced_accuracy: 0.66412 | train_accuracy: 0.66441 | valid_auc: 0.72012 | valid_balanced_accuracy: 0.66233 | valid_accuracy: 0.66257 |  0:15:01s
epoch 54 | loss: 0.61305 | train_auc: 0.71729 | train_balanced_accuracy: 0.65613 | train_accuracy: 0.65631 | valid_auc: 0.71296 | valid_balanced_accuracy: 0.65193 | valid_accuracy: 0.65203 |  0:15:17s
epoch 55 | loss: 0.61501 | train_auc: 0.71934 | train_balanced_accuracy: 0.65933 | train_accuracy: 0.65965 | valid_auc: 0.71439 | valid_balanced_accuracy: 0.65318 | valid_accuracy: 0.65345 |  0:15:34s
epoch 56 | loss: 0.61326 | train_auc: 0.72161 | train_balanced_accuracy: 0.66498 | train_accuracy: 0.66543 | valid_auc: 0.71637 | valid_balanced_accuracy: 0.65762 | valid_accuracy: 0.65801 |  0:15:53s
epoch 57 | loss: 0.61224 | train_auc: 0.7165  | train_balanced_accuracy: 0.65873 | train_accuracy: 0.6591  | valid_auc: 0.71012 | valid_balanced_accuracy: 0.65517 | valid_accuracy: 0.65549 |  0:16:10s
epoch 58 | loss: 0.61002 | train_auc: 0.70701 | train_balanced_accuracy: 0.64852 | train_accuracy: 0.64871 | valid_auc: 0.7068  | valid_balanced_accuracy: 0.6541  | valid_accuracy: 0.65423 |  0:16:28s
epoch 59 | loss: 0.61177 | train_auc: 0.71282 | train_balanced_accuracy: 0.65003 | train_accuracy: 0.65036 | valid_auc: 0.7135  | valid_balanced_accuracy: 0.65333 | valid_accuracy: 0.6536  |  0:16:44s
epoch 60 | loss: 0.60922 | train_auc: 0.70742 | train_balanced_accuracy: 0.64594 | train_accuracy: 0.64619 | valid_auc: 0.70792 | valid_balanced_accuracy: 0.64648 | valid_accuracy: 0.64668 |  0:16:59s
epoch 61 | loss: 0.60852 | train_auc: 0.71854 | train_balanced_accuracy: 0.65538 | train_accuracy: 0.65548 | valid_auc: 0.71834 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65659 |  0:17:14s
epoch 62 | loss: 0.60472 | train_auc: 0.7295  | train_balanced_accuracy: 0.66527 | train_accuracy: 0.66555 | valid_auc: 0.72437 | valid_balanced_accuracy: 0.66168 | valid_accuracy: 0.66195 |  0:17:32s
epoch 63 | loss: 0.60796 | train_auc: 0.73881 | train_balanced_accuracy: 0.67535 | train_accuracy: 0.67555 | valid_auc: 0.7253  | valid_balanced_accuracy: 0.66792 | valid_accuracy: 0.66808 |  0:17:48s
epoch 64 | loss: 0.60922 | train_auc: 0.73521 | train_balanced_accuracy: 0.67187 | train_accuracy: 0.6722  | valid_auc: 0.723   | valid_balanced_accuracy: 0.66465 | valid_accuracy: 0.66494 |  0:18:04s
epoch 65 | loss: 0.60829 | train_auc: 0.73754 | train_balanced_accuracy: 0.67574 | train_accuracy: 0.67602 | valid_auc: 0.72555 | valid_balanced_accuracy: 0.66911 | valid_accuracy: 0.66934 |  0:18:22s
epoch 66 | loss: 0.60974 | train_auc: 0.72939 | train_balanced_accuracy: 0.66742 | train_accuracy: 0.66772 | valid_auc: 0.72147 | valid_balanced_accuracy: 0.65888 | valid_accuracy: 0.65911 |  0:18:39s
epoch 67 | loss: 0.60507 | train_auc: 0.74209 | train_balanced_accuracy: 0.67811 | train_accuracy: 0.6785  | valid_auc: 0.72782 | valid_balanced_accuracy: 0.66537 | valid_accuracy: 0.66572 |  0:18:58s
epoch 68 | loss: 0.60561 | train_auc: 0.74166 | train_balanced_accuracy: 0.67853 | train_accuracy: 0.67885 | valid_auc: 0.7271  | valid_balanced_accuracy: 0.6642  | valid_accuracy: 0.66446 |  0:19:15s
epoch 69 | loss: 0.60936 | train_auc: 0.74252 | train_balanced_accuracy: 0.67935 | train_accuracy: 0.67964 | valid_auc: 0.72943 | valid_balanced_accuracy: 0.67021 | valid_accuracy: 0.67044 |  0:19:34s
epoch 70 | loss: 0.60838 | train_auc: 0.73008 | train_balanced_accuracy: 0.669   | train_accuracy: 0.66933 | valid_auc: 0.72575 | valid_balanced_accuracy: 0.66421 | valid_accuracy: 0.66446 |  0:19:51s
epoch 71 | loss: 0.60756 | train_auc: 0.72578 | train_balanced_accuracy: 0.66782 | train_accuracy: 0.66811 | valid_auc: 0.71848 | valid_balanced_accuracy: 0.6622  | valid_accuracy: 0.66242 |  0:20:08s
epoch 72 | loss: 0.60453 | train_auc: 0.72249 | train_balanced_accuracy: 0.66768 | train_accuracy: 0.66799 | valid_auc: 0.71645 | valid_balanced_accuracy: 0.65966 | valid_accuracy: 0.6599  |  0:20:26s
epoch 73 | loss: 0.60747 | train_auc: 0.72798 | train_balanced_accuracy: 0.67175 | train_accuracy: 0.67208 | valid_auc: 0.71796 | valid_balanced_accuracy: 0.6623  | valid_accuracy: 0.66257 |  0:20:43s
epoch 74 | loss: 0.60494 | train_auc: 0.72577 | train_balanced_accuracy: 0.66984 | train_accuracy: 0.67019 | valid_auc: 0.7184  | valid_balanced_accuracy: 0.66007 | valid_accuracy: 0.66037 |  0:20:59s
epoch 75 | loss: 0.60611 | train_auc: 0.7244  | train_balanced_accuracy: 0.66853 | train_accuracy: 0.66878 | valid_auc: 0.71673 | valid_balanced_accuracy: 0.65954 | valid_accuracy: 0.65974 |  0:21:15s
epoch 76 | loss: 0.60919 | train_auc: 0.74339 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67909 | valid_auc: 0.73091 | valid_balanced_accuracy: 0.66989 | valid_accuracy: 0.66997 |  0:21:32s
epoch 77 | loss: 0.60667 | train_auc: 0.74278 | train_balanced_accuracy: 0.68008 | train_accuracy: 0.68023 | valid_auc: 0.73025 | valid_balanced_accuracy: 0.66641 | valid_accuracy: 0.66651 |  0:21:49s
epoch 78 | loss: 0.60135 | train_auc: 0.74604 | train_balanced_accuracy: 0.68208 | train_accuracy: 0.68235 | valid_auc: 0.72983 | valid_balanced_accuracy: 0.66925 | valid_accuracy: 0.6695  |  0:22:07s
epoch 79 | loss: 0.60174 | train_auc: 0.74571 | train_balanced_accuracy: 0.6823  | train_accuracy: 0.68247 | valid_auc: 0.72869 | valid_balanced_accuracy: 0.66812 | valid_accuracy: 0.66824 |  0:22:25s
epoch 80 | loss: 0.60567 | train_auc: 0.74421 | train_balanced_accuracy: 0.67954 | train_accuracy: 0.6798  | valid_auc: 0.72936 | valid_balanced_accuracy: 0.66959 | valid_accuracy: 0.66981 |  0:22:41s
epoch 81 | loss: 0.59964 | train_auc: 0.74243 | train_balanced_accuracy: 0.67988 | train_accuracy: 0.68007 | valid_auc: 0.72886 | valid_balanced_accuracy: 0.66781 | valid_accuracy: 0.66793 |  0:22:58s
epoch 82 | loss: 0.60678 | train_auc: 0.74668 | train_balanced_accuracy: 0.68194 | train_accuracy: 0.6822  | valid_auc: 0.72958 | valid_balanced_accuracy: 0.67304 | valid_accuracy: 0.67328 |  0:23:16s
epoch 83 | loss: 0.6037  | train_auc: 0.7469  | train_balanced_accuracy: 0.68278 | train_accuracy: 0.6831  | valid_auc: 0.73039 | valid_balanced_accuracy: 0.66652 | valid_accuracy: 0.66682 |  0:23:34s
epoch 84 | loss: 0.60308 | train_auc: 0.74789 | train_balanced_accuracy: 0.68262 | train_accuracy: 0.68279 | valid_auc: 0.73084 | valid_balanced_accuracy: 0.66984 | valid_accuracy: 0.66997 |  0:23:51s
epoch 85 | loss: 0.60317 | train_auc: 0.74585 | train_balanced_accuracy: 0.67943 | train_accuracy: 0.67976 | valid_auc: 0.73039 | valid_balanced_accuracy: 0.67265 | valid_accuracy: 0.67296 |  0:24:07s
epoch 86 | loss: 0.60555 | train_auc: 0.74294 | train_balanced_accuracy: 0.68013 | train_accuracy: 0.68054 | valid_auc: 0.73105 | valid_balanced_accuracy: 0.671   | valid_accuracy: 0.67139 |  0:24:25s
epoch 87 | loss: 0.6009  | train_auc: 0.74271 | train_balanced_accuracy: 0.67878 | train_accuracy: 0.67901 | valid_auc: 0.73002 | valid_balanced_accuracy: 0.67091 | valid_accuracy: 0.67107 |  0:24:41s
epoch 88 | loss: 0.60212 | train_auc: 0.74149 | train_balanced_accuracy: 0.67794 | train_accuracy: 0.67826 | valid_auc: 0.73044 | valid_balanced_accuracy: 0.67348 | valid_accuracy: 0.67375 |  0:24:57s
epoch 89 | loss: 0.60321 | train_auc: 0.72137 | train_balanced_accuracy: 0.66406 | train_accuracy: 0.66421 | valid_auc: 0.72273 | valid_balanced_accuracy: 0.66435 | valid_accuracy: 0.66446 |  0:25:13s
epoch 90 | loss: 0.60416 | train_auc: 0.71222 | train_balanced_accuracy: 0.65168 | train_accuracy: 0.65206 | valid_auc: 0.71461 | valid_balanced_accuracy: 0.65907 | valid_accuracy: 0.65943 |  0:25:30s
epoch 91 | loss: 0.60054 | train_auc: 0.70464 | train_balanced_accuracy: 0.6451  | train_accuracy: 0.64552 | valid_auc: 0.70565 | valid_balanced_accuracy: 0.64426 | valid_accuracy: 0.64463 |  0:25:45s
epoch 92 | loss: 0.59978 | train_auc: 0.70811 | train_balanced_accuracy: 0.64784 | train_accuracy: 0.64828 | valid_auc: 0.70996 | valid_balanced_accuracy: 0.65243 | valid_accuracy: 0.65282 |  0:26:03s
epoch 93 | loss: 0.59797 | train_auc: 0.70664 | train_balanced_accuracy: 0.64474 | train_accuracy: 0.64497 | valid_auc: 0.70323 | valid_balanced_accuracy: 0.64145 | valid_accuracy: 0.64164 |  0:26:19s
epoch 94 | loss: 0.60067 | train_auc: 0.67917 | train_balanced_accuracy: 0.62389 | train_accuracy: 0.62432 | valid_auc: 0.67636 | valid_balanced_accuracy: 0.61999 | valid_accuracy: 0.6204  |  0:26:36s
epoch 95 | loss: 0.60179 | train_auc: 0.65216 | train_balanced_accuracy: 0.60279 | train_accuracy: 0.60311 | valid_auc: 0.64714 | valid_balanced_accuracy: 0.59099 | valid_accuracy: 0.59128 |  0:26:53s
epoch 96 | loss: 0.59576 | train_auc: 0.64782 | train_balanced_accuracy: 0.60006 | train_accuracy: 0.60043 | valid_auc: 0.64088 | valid_balanced_accuracy: 0.59215 | valid_accuracy: 0.59254 |  0:27:09s
epoch 97 | loss: 0.59694 | train_auc: 0.6487  | train_balanced_accuracy: 0.59977 | train_accuracy: 0.60028 | valid_auc: 0.63847 | valid_balanced_accuracy: 0.59139 | valid_accuracy: 0.59191 |  0:27:24s
epoch 98 | loss: 0.59793 | train_auc: 0.63761 | train_balanced_accuracy: 0.58427 | train_accuracy: 0.58497 | valid_auc: 0.62524 | valid_balanced_accuracy: 0.58083 | valid_accuracy: 0.58152 |  0:27:41s
epoch 99 | loss: 0.59538 | train_auc: 0.63674 | train_balanced_accuracy: 0.58389 | train_accuracy: 0.58458 | valid_auc: 0.62674 | valid_balanced_accuracy: 0.57844 | valid_accuracy: 0.57916 |  0:27:58s
epoch 100| loss: 0.60353 | train_auc: 0.6369  | train_balanced_accuracy: 0.58276 | train_accuracy: 0.58371 | valid_auc: 0.62402 | valid_balanced_accuracy: 0.57644 | valid_accuracy: 0.57743 |  0:28:16s
epoch 101| loss: 0.59679 | train_auc: 0.64681 | train_balanced_accuracy: 0.59348 | train_accuracy: 0.59422 | valid_auc: 0.63736 | valid_balanced_accuracy: 0.58608 | valid_accuracy: 0.58687 |  0:28:33s
epoch 102| loss: 0.59512 | train_auc: 0.67603 | train_balanced_accuracy: 0.62513 | train_accuracy: 0.62542 | valid_auc: 0.67782 | valid_balanced_accuracy: 0.62293 | valid_accuracy: 0.62323 |  0:28:49s
epoch 103| loss: 0.59794 | train_auc: 0.68274 | train_balanced_accuracy: 0.6294  | train_accuracy: 0.62994 | valid_auc: 0.68072 | valid_balanced_accuracy: 0.63024 | valid_accuracy: 0.63078 |  0:29:06s
epoch 104| loss: 0.59913 | train_auc: 0.68134 | train_balanced_accuracy: 0.62817 | train_accuracy: 0.62845 | valid_auc: 0.68163 | valid_balanced_accuracy: 0.62874 | valid_accuracy: 0.62905 |  0:29:22s
epoch 105| loss: 0.59564 | train_auc: 0.65149 | train_balanced_accuracy: 0.60253 | train_accuracy: 0.60279 | valid_auc: 0.6441  | valid_balanced_accuracy: 0.59164 | valid_accuracy: 0.59191 |  0:29:39s
epoch 106| loss: 0.59783 | train_auc: 0.66186 | train_balanced_accuracy: 0.61102 | train_accuracy: 0.61121 | valid_auc: 0.65982 | valid_balanced_accuracy: 0.61125 | valid_accuracy: 0.61143 |  0:29:57s
epoch 107| loss: 0.59709 | train_auc: 0.67533 | train_balanced_accuracy: 0.62323 | train_accuracy: 0.62337 | valid_auc: 0.67173 | valid_balanced_accuracy: 0.62134 | valid_accuracy: 0.6215  |  0:30:14s
epoch 108| loss: 0.59314 | train_auc: 0.68559 | train_balanced_accuracy: 0.63377 | train_accuracy: 0.63388 | valid_auc: 0.68324 | valid_balanced_accuracy: 0.62851 | valid_accuracy: 0.62858 |  0:30:33s

Early stopping occurred at epoch 108 with best_epoch = 88 and best_valid_accuracy = 0.67375
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 51/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.667 total time=30.7min
[CV 3/5; 51/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82845 | train_auc: 0.51818 | train_balanced_accuracy: 0.51962 | train_accuracy: 0.51723 | valid_auc: 0.51858 | valid_balanced_accuracy: 0.51567 | valid_accuracy: 0.51322 |  0:00:16s
epoch 1  | loss: 0.74235 | train_auc: 0.52823 | train_balanced_accuracy: 0.51068 | train_accuracy: 0.50767 | valid_auc: 0.52891 | valid_balanced_accuracy: 0.51123 | valid_accuracy: 0.50818 |  0:00:33s
epoch 2  | loss: 0.70965 | train_auc: 0.54057 | train_balanced_accuracy: 0.51192 | train_accuracy: 0.50881 | valid_auc: 0.53723 | valid_balanced_accuracy: 0.50805 | valid_accuracy: 0.50488 |  0:00:51s
epoch 3  | loss: 0.69801 | train_auc: 0.5578  | train_balanced_accuracy: 0.5143  | train_accuracy: 0.51129 | valid_auc: 0.55756 | valid_balanced_accuracy: 0.51736 | valid_accuracy: 0.51432 |  0:01:06s
epoch 4  | loss: 0.68807 | train_auc: 0.55951 | train_balanced_accuracy: 0.52009 | train_accuracy: 0.51712 | valid_auc: 0.55563 | valid_balanced_accuracy: 0.52391 | valid_accuracy: 0.52093 |  0:01:22s
epoch 5  | loss: 0.6809  | train_auc: 0.56314 | train_balanced_accuracy: 0.52277 | train_accuracy: 0.51983 | valid_auc: 0.55827 | valid_balanced_accuracy: 0.52263 | valid_accuracy: 0.51967 |  0:01:40s
epoch 6  | loss: 0.67368 | train_auc: 0.5684  | train_balanced_accuracy: 0.53113 | train_accuracy: 0.52833 | valid_auc: 0.56338 | valid_balanced_accuracy: 0.52959 | valid_accuracy: 0.52675 |  0:01:57s
epoch 7  | loss: 0.67071 | train_auc: 0.57694 | train_balanced_accuracy: 0.53224 | train_accuracy: 0.52939 | valid_auc: 0.57405 | valid_balanced_accuracy: 0.53389 | valid_accuracy: 0.531   |  0:02:12s
epoch 8  | loss: 0.66272 | train_auc: 0.59436 | train_balanced_accuracy: 0.53754 | train_accuracy: 0.53474 | valid_auc: 0.59263 | valid_balanced_accuracy: 0.53841 | valid_accuracy: 0.53557 |  0:02:29s
epoch 9  | loss: 0.66199 | train_auc: 0.6066  | train_balanced_accuracy: 0.54467 | train_accuracy: 0.54198 | valid_auc: 0.60399 | valid_balanced_accuracy: 0.54525 | valid_accuracy: 0.54249 |  0:02:46s
epoch 10 | loss: 0.6532  | train_auc: 0.62243 | train_balanced_accuracy: 0.55278 | train_accuracy: 0.55024 | valid_auc: 0.61865 | valid_balanced_accuracy: 0.55499 | valid_accuracy: 0.55241 |  0:03:04s
epoch 11 | loss: 0.6562  | train_auc: 0.63792 | train_balanced_accuracy: 0.56843 | train_accuracy: 0.56626 | valid_auc: 0.63507 | valid_balanced_accuracy: 0.5634  | valid_accuracy: 0.56122 |  0:03:20s
epoch 12 | loss: 0.65083 | train_auc: 0.65075 | train_balanced_accuracy: 0.57338 | train_accuracy: 0.57129 | valid_auc: 0.64889 | valid_balanced_accuracy: 0.57119 | valid_accuracy: 0.56909 |  0:03:37s
epoch 13 | loss: 0.64998 | train_auc: 0.66061 | train_balanced_accuracy: 0.58045 | train_accuracy: 0.57845 | valid_auc: 0.65785 | valid_balanced_accuracy: 0.57907 | valid_accuracy: 0.57712 |  0:03:52s
epoch 14 | loss: 0.6452  | train_auc: 0.66765 | train_balanced_accuracy: 0.58703 | train_accuracy: 0.58534 | valid_auc: 0.66534 | valid_balanced_accuracy: 0.58913 | valid_accuracy: 0.5875  |  0:04:10s
epoch 15 | loss: 0.64577 | train_auc: 0.67721 | train_balanced_accuracy: 0.59277 | train_accuracy: 0.59105 | valid_auc: 0.67409 | valid_balanced_accuracy: 0.59436 | valid_accuracy: 0.5927  |  0:04:28s
epoch 16 | loss: 0.64226 | train_auc: 0.68328 | train_balanced_accuracy: 0.60263 | train_accuracy: 0.60116 | valid_auc: 0.68092 | valid_balanced_accuracy: 0.60953 | valid_accuracy: 0.60812 |  0:04:44s
epoch 17 | loss: 0.63976 | train_auc: 0.6858  | train_balanced_accuracy: 0.60937 | train_accuracy: 0.60804 | valid_auc: 0.68348 | valid_balanced_accuracy: 0.61082 | valid_accuracy: 0.60954 |  0:05:02s
epoch 18 | loss: 0.63758 | train_auc: 0.69033 | train_balanced_accuracy: 0.6232  | train_accuracy: 0.62229 | valid_auc: 0.68672 | valid_balanced_accuracy: 0.62567 | valid_accuracy: 0.6248  |  0:05:19s
epoch 19 | loss: 0.63827 | train_auc: 0.69361 | train_balanced_accuracy: 0.62869 | train_accuracy: 0.62791 | valid_auc: 0.68675 | valid_balanced_accuracy: 0.62605 | valid_accuracy: 0.62528 |  0:05:36s
epoch 20 | loss: 0.63647 | train_auc: 0.69568 | train_balanced_accuracy: 0.63463 | train_accuracy: 0.63401 | valid_auc: 0.69063 | valid_balanced_accuracy: 0.63596 | valid_accuracy: 0.63535 |  0:05:53s
epoch 21 | loss: 0.63082 | train_auc: 0.69733 | train_balanced_accuracy: 0.63844 | train_accuracy: 0.63802 | valid_auc: 0.6929  | valid_balanced_accuracy: 0.64066 | valid_accuracy: 0.64023 |  0:06:12s
epoch 22 | loss: 0.63582 | train_auc: 0.69807 | train_balanced_accuracy: 0.64466 | train_accuracy: 0.64475 | valid_auc: 0.69225 | valid_balanced_accuracy: 0.64397 | valid_accuracy: 0.644   |  0:06:29s
epoch 23 | loss: 0.63449 | train_auc: 0.69961 | train_balanced_accuracy: 0.64436 | train_accuracy: 0.64436 | valid_auc: 0.69262 | valid_balanced_accuracy: 0.64151 | valid_accuracy: 0.64149 |  0:06:46s
epoch 24 | loss: 0.63255 | train_auc: 0.70181 | train_balanced_accuracy: 0.64605 | train_accuracy: 0.64625 | valid_auc: 0.697   | valid_balanced_accuracy: 0.64965 | valid_accuracy: 0.64983 |  0:07:04s
epoch 25 | loss: 0.63023 | train_auc: 0.7027  | train_balanced_accuracy: 0.64678 | train_accuracy: 0.64707 | valid_auc: 0.69747 | valid_balanced_accuracy: 0.6439  | valid_accuracy: 0.64416 |  0:07:18s
epoch 26 | loss: 0.62829 | train_auc: 0.7034  | train_balanced_accuracy: 0.6474  | train_accuracy: 0.64782 | valid_auc: 0.69694 | valid_balanced_accuracy: 0.6488  | valid_accuracy: 0.6492  |  0:07:35s
epoch 27 | loss: 0.6283  | train_auc: 0.70599 | train_balanced_accuracy: 0.65096 | train_accuracy: 0.65136 | valid_auc: 0.6961  | valid_balanced_accuracy: 0.64645 | valid_accuracy: 0.64684 |  0:07:54s
epoch 28 | loss: 0.62529 | train_auc: 0.70959 | train_balanced_accuracy: 0.65569 | train_accuracy: 0.65596 | valid_auc: 0.7006  | valid_balanced_accuracy: 0.65054 | valid_accuracy: 0.65077 |  0:08:11s
epoch 29 | loss: 0.62425 | train_auc: 0.71323 | train_balanced_accuracy: 0.65819 | train_accuracy: 0.65856 | valid_auc: 0.70182 | valid_balanced_accuracy: 0.64599 | valid_accuracy: 0.64636 |  0:08:29s
epoch 30 | loss: 0.62321 | train_auc: 0.7141  | train_balanced_accuracy: 0.66047 | train_accuracy: 0.66092 | valid_auc: 0.70096 | valid_balanced_accuracy: 0.64701 | valid_accuracy: 0.64747 |  0:08:45s
epoch 31 | loss: 0.62522 | train_auc: 0.71492 | train_balanced_accuracy: 0.65852 | train_accuracy: 0.65903 | valid_auc: 0.70362 | valid_balanced_accuracy: 0.65389 | valid_accuracy: 0.65439 |  0:09:00s
epoch 32 | loss: 0.61995 | train_auc: 0.71648 | train_balanced_accuracy: 0.66068 | train_accuracy: 0.6612  | valid_auc: 0.70371 | valid_balanced_accuracy: 0.65387 | valid_accuracy: 0.65439 |  0:09:18s
epoch 33 | loss: 0.62532 | train_auc: 0.71684 | train_balanced_accuracy: 0.661   | train_accuracy: 0.66147 | valid_auc: 0.70697 | valid_balanced_accuracy: 0.65407 | valid_accuracy: 0.65455 |  0:09:36s
epoch 34 | loss: 0.62272 | train_auc: 0.71661 | train_balanced_accuracy: 0.66043 | train_accuracy: 0.66088 | valid_auc: 0.70774 | valid_balanced_accuracy: 0.65661 | valid_accuracy: 0.65707 |  0:09:55s
epoch 35 | loss: 0.61822 | train_auc: 0.72127 | train_balanced_accuracy: 0.66435 | train_accuracy: 0.66494 | valid_auc: 0.70987 | valid_balanced_accuracy: 0.65895 | valid_accuracy: 0.65958 |  0:10:14s
epoch 36 | loss: 0.62076 | train_auc: 0.72467 | train_balanced_accuracy: 0.66641 | train_accuracy: 0.66694 | valid_auc: 0.70957 | valid_balanced_accuracy: 0.65462 | valid_accuracy: 0.65518 |  0:10:30s
epoch 37 | loss: 0.62043 | train_auc: 0.72355 | train_balanced_accuracy: 0.66362 | train_accuracy: 0.66407 | valid_auc: 0.70939 | valid_balanced_accuracy: 0.65613 | valid_accuracy: 0.65659 |  0:10:48s
epoch 38 | loss: 0.6187  | train_auc: 0.72437 | train_balanced_accuracy: 0.66459 | train_accuracy: 0.66482 | valid_auc: 0.71116 | valid_balanced_accuracy: 0.66013 | valid_accuracy: 0.66037 |  0:11:05s
epoch 39 | loss: 0.61328 | train_auc: 0.72751 | train_balanced_accuracy: 0.66656 | train_accuracy: 0.66682 | valid_auc: 0.71011 | valid_balanced_accuracy: 0.6615  | valid_accuracy: 0.66179 |  0:11:24s
epoch 40 | loss: 0.6175  | train_auc: 0.7235  | train_balanced_accuracy: 0.66454 | train_accuracy: 0.66482 | valid_auc: 0.70904 | valid_balanced_accuracy: 0.65961 | valid_accuracy: 0.6599  |  0:11:41s
epoch 41 | loss: 0.61751 | train_auc: 0.72877 | train_balanced_accuracy: 0.66852 | train_accuracy: 0.66899 | valid_auc: 0.71113 | valid_balanced_accuracy: 0.66006 | valid_accuracy: 0.66053 |  0:11:57s
epoch 42 | loss: 0.61385 | train_auc: 0.7298  | train_balanced_accuracy: 0.6705  | train_accuracy: 0.67084 | valid_auc: 0.71132 | valid_balanced_accuracy: 0.65753 | valid_accuracy: 0.65785 |  0:12:15s
epoch 43 | loss: 0.6174  | train_auc: 0.72649 | train_balanced_accuracy: 0.66647 | train_accuracy: 0.66671 | valid_auc: 0.71175 | valid_balanced_accuracy: 0.65605 | valid_accuracy: 0.65628 |  0:12:31s
epoch 44 | loss: 0.61797 | train_auc: 0.73174 | train_balanced_accuracy: 0.67207 | train_accuracy: 0.67233 | valid_auc: 0.71243 | valid_balanced_accuracy: 0.6612  | valid_accuracy: 0.66147 |  0:12:50s
epoch 45 | loss: 0.61428 | train_auc: 0.73172 | train_balanced_accuracy: 0.67021 | train_accuracy: 0.67064 | valid_auc: 0.7145  | valid_balanced_accuracy: 0.66099 | valid_accuracy: 0.66147 |  0:13:06s
epoch 46 | loss: 0.61808 | train_auc: 0.73337 | train_balanced_accuracy: 0.67198 | train_accuracy: 0.67245 | valid_auc: 0.71453 | valid_balanced_accuracy: 0.66097 | valid_accuracy: 0.66147 |  0:13:21s
epoch 47 | loss: 0.6128  | train_auc: 0.73123 | train_balanced_accuracy: 0.67015 | train_accuracy: 0.6704  | valid_auc: 0.71487 | valid_balanced_accuracy: 0.65978 | valid_accuracy: 0.66006 |  0:13:37s
epoch 48 | loss: 0.61353 | train_auc: 0.72425 | train_balanced_accuracy: 0.66485 | train_accuracy: 0.66521 | valid_auc: 0.71204 | valid_balanced_accuracy: 0.65405 | valid_accuracy: 0.65439 |  0:13:53s
epoch 49 | loss: 0.61178 | train_auc: 0.71939 | train_balanced_accuracy: 0.66233 | train_accuracy: 0.66246 | valid_auc: 0.71018 | valid_balanced_accuracy: 0.65553 | valid_accuracy: 0.65565 |  0:14:09s
epoch 50 | loss: 0.61459 | train_auc: 0.72662 | train_balanced_accuracy: 0.66717 | train_accuracy: 0.6673  | valid_auc: 0.71135 | valid_balanced_accuracy: 0.65805 | valid_accuracy: 0.65817 |  0:14:25s
epoch 51 | loss: 0.61056 | train_auc: 0.73004 | train_balanced_accuracy: 0.6708  | train_accuracy: 0.67103 | valid_auc: 0.71452 | valid_balanced_accuracy: 0.6617  | valid_accuracy: 0.66195 |  0:14:42s
epoch 52 | loss: 0.60647 | train_auc: 0.73106 | train_balanced_accuracy: 0.67244 | train_accuracy: 0.67277 | valid_auc: 0.71413 | valid_balanced_accuracy: 0.65566 | valid_accuracy: 0.65596 |  0:15:01s
epoch 53 | loss: 0.60976 | train_auc: 0.73552 | train_balanced_accuracy: 0.67528 | train_accuracy: 0.67568 | valid_auc: 0.71727 | valid_balanced_accuracy: 0.65994 | valid_accuracy: 0.66037 |  0:15:18s
epoch 54 | loss: 0.60813 | train_auc: 0.73693 | train_balanced_accuracy: 0.67811 | train_accuracy: 0.67827 | valid_auc: 0.71967 | valid_balanced_accuracy: 0.66645 | valid_accuracy: 0.66667 |  0:15:37s
epoch 55 | loss: 0.60876 | train_auc: 0.73709 | train_balanced_accuracy: 0.67721 | train_accuracy: 0.67745 | valid_auc: 0.72041 | valid_balanced_accuracy: 0.66689 | valid_accuracy: 0.66714 |  0:15:54s
epoch 56 | loss: 0.61022 | train_auc: 0.73913 | train_balanced_accuracy: 0.67762 | train_accuracy: 0.67816 | valid_auc: 0.72086 | valid_balanced_accuracy: 0.66535 | valid_accuracy: 0.66588 |  0:16:11s
epoch 57 | loss: 0.61417 | train_auc: 0.73681 | train_balanced_accuracy: 0.67742 | train_accuracy: 0.67768 | valid_auc: 0.71853 | valid_balanced_accuracy: 0.65993 | valid_accuracy: 0.66021 |  0:16:26s
epoch 58 | loss: 0.61382 | train_auc: 0.73311 | train_balanced_accuracy: 0.6728  | train_accuracy: 0.67288 | valid_auc: 0.71782 | valid_balanced_accuracy: 0.65853 | valid_accuracy: 0.65864 |  0:16:42s
epoch 59 | loss: 0.60963 | train_auc: 0.73244 | train_balanced_accuracy: 0.67344 | train_accuracy: 0.67363 | valid_auc: 0.71571 | valid_balanced_accuracy: 0.66004 | valid_accuracy: 0.66021 |  0:16:59s
epoch 60 | loss: 0.60948 | train_auc: 0.73109 | train_balanced_accuracy: 0.67282 | train_accuracy: 0.673   | valid_auc: 0.71604 | valid_balanced_accuracy: 0.65987 | valid_accuracy: 0.66006 |  0:17:16s
epoch 61 | loss: 0.60985 | train_auc: 0.71322 | train_balanced_accuracy: 0.65726 | train_accuracy: 0.65726 | valid_auc: 0.70729 | valid_balanced_accuracy: 0.65533 | valid_accuracy: 0.65534 |  0:17:33s
epoch 62 | loss: 0.60557 | train_auc: 0.71644 | train_balanced_accuracy: 0.6597  | train_accuracy: 0.6601  | valid_auc: 0.70957 | valid_balanced_accuracy: 0.65556 | valid_accuracy: 0.65596 |  0:17:49s
epoch 63 | loss: 0.6068  | train_auc: 0.72275 | train_balanced_accuracy: 0.66343 | train_accuracy: 0.66368 | valid_auc: 0.71352 | valid_balanced_accuracy: 0.65577 | valid_accuracy: 0.65596 |  0:18:05s
epoch 64 | loss: 0.6049  | train_auc: 0.72671 | train_balanced_accuracy: 0.66804 | train_accuracy: 0.66828 | valid_auc: 0.71416 | valid_balanced_accuracy: 0.65969 | valid_accuracy: 0.6599  |  0:18:23s
epoch 65 | loss: 0.6039  | train_auc: 0.7388  | train_balanced_accuracy: 0.67919 | train_accuracy: 0.67945 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.66639 | valid_accuracy: 0.66667 |  0:18:40s
epoch 66 | loss: 0.60832 | train_auc: 0.7435  | train_balanced_accuracy: 0.68131 | train_accuracy: 0.68158 | valid_auc: 0.7227  | valid_balanced_accuracy: 0.66874 | valid_accuracy: 0.66903 |  0:18:58s
epoch 67 | loss: 0.60468 | train_auc: 0.73934 | train_balanced_accuracy: 0.67691 | train_accuracy: 0.67737 | valid_auc: 0.72044 | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.66352 |  0:19:16s
epoch 68 | loss: 0.60632 | train_auc: 0.73228 | train_balanced_accuracy: 0.67323 | train_accuracy: 0.67339 | valid_auc: 0.71992 | valid_balanced_accuracy: 0.66746 | valid_accuracy: 0.66761 |  0:19:32s
epoch 69 | loss: 0.60647 | train_auc: 0.72516 | train_balanced_accuracy: 0.66576 | train_accuracy: 0.66619 | valid_auc: 0.71432 | valid_balanced_accuracy: 0.66091 | valid_accuracy: 0.66132 |  0:19:48s
epoch 70 | loss: 0.60319 | train_auc: 0.72732 | train_balanced_accuracy: 0.66808 | train_accuracy: 0.66848 | valid_auc: 0.71494 | valid_balanced_accuracy: 0.65843 | valid_accuracy: 0.6588  |  0:20:06s
epoch 71 | loss: 0.60764 | train_auc: 0.71861 | train_balanced_accuracy: 0.66208 | train_accuracy: 0.66242 | valid_auc: 0.70937 | valid_balanced_accuracy: 0.65754 | valid_accuracy: 0.65785 |  0:20:22s
epoch 72 | loss: 0.60681 | train_auc: 0.72303 | train_balanced_accuracy: 0.66517 | train_accuracy: 0.66521 | valid_auc: 0.71207 | valid_balanced_accuracy: 0.65722 | valid_accuracy: 0.65722 |  0:20:39s
epoch 73 | loss: 0.60067 | train_auc: 0.73578 | train_balanced_accuracy: 0.6753  | train_accuracy: 0.67579 | valid_auc: 0.7207  | valid_balanced_accuracy: 0.65976 | valid_accuracy: 0.66021 |  0:20:56s
epoch 74 | loss: 0.60469 | train_auc: 0.72486 | train_balanced_accuracy: 0.66853 | train_accuracy: 0.66871 | valid_auc: 0.71333 | valid_balanced_accuracy: 0.66416 | valid_accuracy: 0.66431 |  0:21:14s
epoch 75 | loss: 0.60723 | train_auc: 0.70697 | train_balanced_accuracy: 0.65312 | train_accuracy: 0.65329 | valid_auc: 0.70304 | valid_balanced_accuracy: 0.6487  | valid_accuracy: 0.64888 |  0:21:32s
epoch 76 | loss: 0.60548 | train_auc: 0.71459 | train_balanced_accuracy: 0.65901 | train_accuracy: 0.65935 | valid_auc: 0.70962 | valid_balanced_accuracy: 0.65548 | valid_accuracy: 0.65581 |  0:21:49s
epoch 77 | loss: 0.60189 | train_auc: 0.71187 | train_balanced_accuracy: 0.65525 | train_accuracy: 0.65549 | valid_auc: 0.70612 | valid_balanced_accuracy: 0.64752 | valid_accuracy: 0.64778 |  0:22:05s
epoch 78 | loss: 0.60119 | train_auc: 0.69983 | train_balanced_accuracy: 0.64645 | train_accuracy: 0.64684 | valid_auc: 0.70404 | valid_balanced_accuracy: 0.65121 | valid_accuracy: 0.65156 |  0:22:23s
epoch 79 | loss: 0.59776 | train_auc: 0.69871 | train_balanced_accuracy: 0.64463 | train_accuracy: 0.64499 | valid_auc: 0.70316 | valid_balanced_accuracy: 0.65107 | valid_accuracy: 0.6514  |  0:22:39s
epoch 80 | loss: 0.60526 | train_auc: 0.69744 | train_balanced_accuracy: 0.64508 | train_accuracy: 0.64546 | valid_auc: 0.69914 | valid_balanced_accuracy: 0.64629 | valid_accuracy: 0.64668 |  0:22:55s
epoch 81 | loss: 0.60668 | train_auc: 0.72139 | train_balanced_accuracy: 0.66549 | train_accuracy: 0.66568 | valid_auc: 0.71163 | valid_balanced_accuracy: 0.65798 | valid_accuracy: 0.65817 |  0:23:11s
epoch 82 | loss: 0.60337 | train_auc: 0.7199  | train_balanced_accuracy: 0.66114 | train_accuracy: 0.66128 | valid_auc: 0.71133 | valid_balanced_accuracy: 0.65944 | valid_accuracy: 0.65958 |  0:23:30s
epoch 83 | loss: 0.60307 | train_auc: 0.70384 | train_balanced_accuracy: 0.65013 | train_accuracy: 0.6505  | valid_auc: 0.70533 | valid_balanced_accuracy: 0.65374 | valid_accuracy: 0.65408 |  0:23:47s
epoch 84 | loss: 0.60455 | train_auc: 0.73016 | train_balanced_accuracy: 0.67092 | train_accuracy: 0.67103 | valid_auc: 0.71805 | valid_balanced_accuracy: 0.66313 | valid_accuracy: 0.6632  |  0:24:04s
epoch 85 | loss: 0.6046  | train_auc: 0.74668 | train_balanced_accuracy: 0.68183 | train_accuracy: 0.68201 | valid_auc: 0.72361 | valid_balanced_accuracy: 0.66645 | valid_accuracy: 0.66667 |  0:24:19s
epoch 86 | loss: 0.60091 | train_auc: 0.74143 | train_balanced_accuracy: 0.67787 | train_accuracy: 0.67847 | valid_auc: 0.72474 | valid_balanced_accuracy: 0.66418 | valid_accuracy: 0.66478 |  0:24:34s

Early stopping occurred at epoch 86 with best_epoch = 66 and best_valid_accuracy = 0.66903
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 51/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.674 total time=24.7min
[CV 4/5; 51/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82676 | train_auc: 0.50959 | train_balanced_accuracy: 0.51548 | train_accuracy: 0.51306 | valid_auc: 0.50749 | valid_balanced_accuracy: 0.51162 | valid_accuracy: 0.50913 |  0:00:15s
epoch 1  | loss: 0.74068 | train_auc: 0.51244 | train_balanced_accuracy: 0.50544 | train_accuracy: 0.50244 | valid_auc: 0.50939 | valid_balanced_accuracy: 0.50621 | valid_accuracy: 0.50315 |  0:00:33s
epoch 2  | loss: 0.69899 | train_auc: 0.54208 | train_balanced_accuracy: 0.51355 | train_accuracy: 0.51051 | valid_auc: 0.53546 | valid_balanced_accuracy: 0.51317 | valid_accuracy: 0.51007 |  0:00:49s
epoch 3  | loss: 0.69371 | train_auc: 0.56105 | train_balanced_accuracy: 0.51603 | train_accuracy: 0.51298 | valid_auc: 0.55584 | valid_balanced_accuracy: 0.51273 | valid_accuracy: 0.5096  |  0:01:06s
epoch 4  | loss: 0.68459 | train_auc: 0.56809 | train_balanced_accuracy: 0.51971 | train_accuracy: 0.51676 | valid_auc: 0.56395 | valid_balanced_accuracy: 0.52013 | valid_accuracy: 0.51715 |  0:01:21s
epoch 5  | loss: 0.67683 | train_auc: 0.5798  | train_balanced_accuracy: 0.5303  | train_accuracy: 0.5275  | valid_auc: 0.57366 | valid_balanced_accuracy: 0.52441 | valid_accuracy: 0.52156 |  0:01:40s
epoch 6  | loss: 0.67388 | train_auc: 0.59085 | train_balanced_accuracy: 0.54647 | train_accuracy: 0.54418 | valid_auc: 0.58468 | valid_balanced_accuracy: 0.53777 | valid_accuracy: 0.53541 |  0:01:57s
epoch 7  | loss: 0.67239 | train_auc: 0.59701 | train_balanced_accuracy: 0.54906 | train_accuracy: 0.5467  | valid_auc: 0.58564 | valid_balanced_accuracy: 0.53911 | valid_accuracy: 0.53667 |  0:02:14s
epoch 8  | loss: 0.66254 | train_auc: 0.60962 | train_balanced_accuracy: 0.55682 | train_accuracy: 0.55449 | valid_auc: 0.59496 | valid_balanced_accuracy: 0.54837 | valid_accuracy: 0.54596 |  0:02:31s
epoch 9  | loss: 0.65716 | train_auc: 0.61858 | train_balanced_accuracy: 0.56442 | train_accuracy: 0.56209 | valid_auc: 0.60496 | valid_balanced_accuracy: 0.55482 | valid_accuracy: 0.55241 |  0:02:48s
epoch 10 | loss: 0.65296 | train_auc: 0.63171 | train_balanced_accuracy: 0.57624 | train_accuracy: 0.57424 | valid_auc: 0.62012 | valid_balanced_accuracy: 0.56645 | valid_accuracy: 0.56437 |  0:03:06s
epoch 11 | loss: 0.654   | train_auc: 0.64545 | train_balanced_accuracy: 0.58907 | train_accuracy: 0.58735 | valid_auc: 0.63347 | valid_balanced_accuracy: 0.58136 | valid_accuracy: 0.57963 |  0:03:25s
epoch 12 | loss: 0.64543 | train_auc: 0.65873 | train_balanced_accuracy: 0.59563 | train_accuracy: 0.59404 | valid_auc: 0.6476  | valid_balanced_accuracy: 0.58594 | valid_accuracy: 0.58436 |  0:03:41s
epoch 13 | loss: 0.64688 | train_auc: 0.66711 | train_balanced_accuracy: 0.60051 | train_accuracy: 0.59899 | valid_auc: 0.65714 | valid_balanced_accuracy: 0.59339 | valid_accuracy: 0.59191 |  0:03:58s
epoch 14 | loss: 0.64246 | train_auc: 0.67319 | train_balanced_accuracy: 0.6091  | train_accuracy: 0.60796 | valid_auc: 0.66003 | valid_balanced_accuracy: 0.60168 | valid_accuracy: 0.60057 |  0:04:14s
epoch 15 | loss: 0.6436  | train_auc: 0.68143 | train_balanced_accuracy: 0.61614 | train_accuracy: 0.61512 | valid_auc: 0.66706 | valid_balanced_accuracy: 0.60895 | valid_accuracy: 0.60796 |  0:04:30s
epoch 16 | loss: 0.63749 | train_auc: 0.68647 | train_balanced_accuracy: 0.62668 | train_accuracy: 0.62594 | valid_auc: 0.67207 | valid_balanced_accuracy: 0.61214 | valid_accuracy: 0.61143 |  0:04:46s
epoch 17 | loss: 0.6327  | train_auc: 0.69021 | train_balanced_accuracy: 0.63603 | train_accuracy: 0.63566 | valid_auc: 0.6767  | valid_balanced_accuracy: 0.62669 | valid_accuracy: 0.62638 |  0:05:05s
epoch 18 | loss: 0.63683 | train_auc: 0.69388 | train_balanced_accuracy: 0.64183 | train_accuracy: 0.64168 | valid_auc: 0.68038 | valid_balanced_accuracy: 0.63368 | valid_accuracy: 0.63362 |  0:05:21s
epoch 19 | loss: 0.63395 | train_auc: 0.69606 | train_balanced_accuracy: 0.64527 | train_accuracy: 0.64534 | valid_auc: 0.68221 | valid_balanced_accuracy: 0.64387 | valid_accuracy: 0.644   |  0:05:37s
epoch 20 | loss: 0.63412 | train_auc: 0.69982 | train_balanced_accuracy: 0.64838 | train_accuracy: 0.64853 | valid_auc: 0.68635 | valid_balanced_accuracy: 0.64267 | valid_accuracy: 0.6429  |  0:05:53s
epoch 21 | loss: 0.63015 | train_auc: 0.70158 | train_balanced_accuracy: 0.64952 | train_accuracy: 0.64967 | valid_auc: 0.68862 | valid_balanced_accuracy: 0.6438  | valid_accuracy: 0.644   |  0:06:09s
epoch 22 | loss: 0.63215 | train_auc: 0.70324 | train_balanced_accuracy: 0.653   | train_accuracy: 0.65337 | valid_auc: 0.69136 | valid_balanced_accuracy: 0.6489  | valid_accuracy: 0.64935 |  0:06:27s
epoch 23 | loss: 0.62943 | train_auc: 0.70331 | train_balanced_accuracy: 0.65428 | train_accuracy: 0.65451 | valid_auc: 0.69103 | valid_balanced_accuracy: 0.64797 | valid_accuracy: 0.64825 |  0:06:44s
epoch 24 | loss: 0.63039 | train_auc: 0.7057  | train_balanced_accuracy: 0.65521 | train_accuracy: 0.65557 | valid_auc: 0.69186 | valid_balanced_accuracy: 0.6475  | valid_accuracy: 0.64794 |  0:07:00s
epoch 25 | loss: 0.62637 | train_auc: 0.70759 | train_balanced_accuracy: 0.65771 | train_accuracy: 0.65821 | valid_auc: 0.69397 | valid_balanced_accuracy: 0.64927 | valid_accuracy: 0.64983 |  0:07:16s
epoch 26 | loss: 0.62709 | train_auc: 0.71052 | train_balanced_accuracy: 0.65854 | train_accuracy: 0.65911 | valid_auc: 0.69702 | valid_balanced_accuracy: 0.64794 | valid_accuracy: 0.64857 |  0:07:34s
epoch 27 | loss: 0.62853 | train_auc: 0.71246 | train_balanced_accuracy: 0.65995 | train_accuracy: 0.66049 | valid_auc: 0.69669 | valid_balanced_accuracy: 0.65061 | valid_accuracy: 0.65124 |  0:07:49s
epoch 28 | loss: 0.62535 | train_auc: 0.71444 | train_balanced_accuracy: 0.6582  | train_accuracy: 0.65856 | valid_auc: 0.70193 | valid_balanced_accuracy: 0.65077 | valid_accuracy: 0.65124 |  0:08:06s
epoch 29 | loss: 0.62573 | train_auc: 0.7162  | train_balanced_accuracy: 0.65744 | train_accuracy: 0.65781 | valid_auc: 0.70183 | valid_balanced_accuracy: 0.64919 | valid_accuracy: 0.64967 |  0:08:22s
epoch 30 | loss: 0.62047 | train_auc: 0.71697 | train_balanced_accuracy: 0.659   | train_accuracy: 0.65947 | valid_auc: 0.70505 | valid_balanced_accuracy: 0.64674 | valid_accuracy: 0.64731 |  0:08:39s
epoch 31 | loss: 0.62362 | train_auc: 0.71856 | train_balanced_accuracy: 0.65906 | train_accuracy: 0.65951 | valid_auc: 0.7024  | valid_balanced_accuracy: 0.64347 | valid_accuracy: 0.644   |  0:08:56s
epoch 32 | loss: 0.61681 | train_auc: 0.72003 | train_balanced_accuracy: 0.65959 | train_accuracy: 0.66006 | valid_auc: 0.70543 | valid_balanced_accuracy: 0.64568 | valid_accuracy: 0.64621 |  0:09:11s
epoch 33 | loss: 0.62261 | train_auc: 0.7199  | train_balanced_accuracy: 0.65828 | train_accuracy: 0.65864 | valid_auc: 0.70296 | valid_balanced_accuracy: 0.6472  | valid_accuracy: 0.64762 |  0:09:28s
epoch 34 | loss: 0.62052 | train_auc: 0.71867 | train_balanced_accuracy: 0.65843 | train_accuracy: 0.65876 | valid_auc: 0.70103 | valid_balanced_accuracy: 0.64549 | valid_accuracy: 0.64589 |  0:09:45s
epoch 35 | loss: 0.61768 | train_auc: 0.71879 | train_balanced_accuracy: 0.65768 | train_accuracy: 0.65809 | valid_auc: 0.70123 | valid_balanced_accuracy: 0.64604 | valid_accuracy: 0.64652 |  0:10:01s
epoch 36 | loss: 0.61675 | train_auc: 0.72483 | train_balanced_accuracy: 0.66457 | train_accuracy: 0.6649  | valid_auc: 0.70478 | valid_balanced_accuracy: 0.64787 | valid_accuracy: 0.64825 |  0:10:18s
epoch 37 | loss: 0.61593 | train_auc: 0.72363 | train_balanced_accuracy: 0.6632  | train_accuracy: 0.66368 | valid_auc: 0.70258 | valid_balanced_accuracy: 0.64865 | valid_accuracy: 0.6492  |  0:10:34s
epoch 38 | loss: 0.61897 | train_auc: 0.7243  | train_balanced_accuracy: 0.66415 | train_accuracy: 0.6645  | valid_auc: 0.7029  | valid_balanced_accuracy: 0.646   | valid_accuracy: 0.64636 |  0:10:51s
epoch 39 | loss: 0.61678 | train_auc: 0.72302 | train_balanced_accuracy: 0.66291 | train_accuracy: 0.66332 | valid_auc: 0.70332 | valid_balanced_accuracy: 0.64527 | valid_accuracy: 0.64573 |  0:11:08s
epoch 40 | loss: 0.617   | train_auc: 0.7245  | train_balanced_accuracy: 0.66244 | train_accuracy: 0.66285 | valid_auc: 0.70376 | valid_balanced_accuracy: 0.6478  | valid_accuracy: 0.64825 |  0:11:27s
epoch 41 | loss: 0.62044 | train_auc: 0.71094 | train_balanced_accuracy: 0.65539 | train_accuracy: 0.65589 | valid_auc: 0.69222 | valid_balanced_accuracy: 0.64235 | valid_accuracy: 0.6429  |  0:11:43s
epoch 42 | loss: 0.61564 | train_auc: 0.70886 | train_balanced_accuracy: 0.65282 | train_accuracy: 0.65309 | valid_auc: 0.69612 | valid_balanced_accuracy: 0.64164 | valid_accuracy: 0.64196 |  0:11:59s
epoch 43 | loss: 0.61695 | train_auc: 0.70214 | train_balanced_accuracy: 0.64605 | train_accuracy: 0.64613 | valid_auc: 0.69136 | valid_balanced_accuracy: 0.64218 | valid_accuracy: 0.64227 |  0:12:16s
epoch 44 | loss: 0.61824 | train_auc: 0.69827 | train_balanced_accuracy: 0.64267 | train_accuracy: 0.64282 | valid_auc: 0.68879 | valid_balanced_accuracy: 0.63894 | valid_accuracy: 0.63912 |  0:12:33s
epoch 45 | loss: 0.61576 | train_auc: 0.69371 | train_balanced_accuracy: 0.64182 | train_accuracy: 0.642   | valid_auc: 0.68381 | valid_balanced_accuracy: 0.63511 | valid_accuracy: 0.63535 |  0:12:50s
epoch 46 | loss: 0.6197  | train_auc: 0.7033  | train_balanced_accuracy: 0.65115 | train_accuracy: 0.65156 | valid_auc: 0.69184 | valid_balanced_accuracy: 0.64041 | valid_accuracy: 0.64086 |  0:13:07s
epoch 47 | loss: 0.6122  | train_auc: 0.65362 | train_balanced_accuracy: 0.62151 | train_accuracy: 0.62173 | valid_auc: 0.64813 | valid_balanced_accuracy: 0.62126 | valid_accuracy: 0.6215  |  0:13:24s

Early stopping occurred at epoch 47 with best_epoch = 27 and best_valid_accuracy = 0.65124
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 51/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.648 total time=13.5min
[CV 5/5; 51/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83079 | train_auc: 0.53332 | train_balanced_accuracy: 0.52428 | train_accuracy: 0.52195 | valid_auc: 0.52905 | valid_balanced_accuracy: 0.52493 | valid_accuracy: 0.52251 |  0:00:16s
epoch 1  | loss: 0.73845 | train_auc: 0.54259 | train_balanced_accuracy: 0.51023 | train_accuracy: 0.50748 | valid_auc: 0.54519 | valid_balanced_accuracy: 0.51622 | valid_accuracy: 0.51338 |  0:00:32s
epoch 2  | loss: 0.7046  | train_auc: 0.55653 | train_balanced_accuracy: 0.51507 | train_accuracy: 0.51216 | valid_auc: 0.56314 | valid_balanced_accuracy: 0.5178  | valid_accuracy: 0.51479 |  0:00:49s
epoch 3  | loss: 0.69339 | train_auc: 0.56659 | train_balanced_accuracy: 0.52766 | train_accuracy: 0.52498 | valid_auc: 0.57278 | valid_balanced_accuracy: 0.52916 | valid_accuracy: 0.52644 |  0:01:05s
epoch 4  | loss: 0.68011 | train_auc: 0.57568 | train_balanced_accuracy: 0.53289 | train_accuracy: 0.53026 | valid_auc: 0.58127 | valid_balanced_accuracy: 0.53544 | valid_accuracy: 0.53274 |  0:01:24s
epoch 5  | loss: 0.67408 | train_auc: 0.58823 | train_balanced_accuracy: 0.53297 | train_accuracy: 0.53018 | valid_auc: 0.59109 | valid_balanced_accuracy: 0.53684 | valid_accuracy: 0.53399 |  0:01:39s
epoch 6  | loss: 0.66915 | train_auc: 0.5979  | train_balanced_accuracy: 0.54433 | train_accuracy: 0.54178 | valid_auc: 0.59905 | valid_balanced_accuracy: 0.55308 | valid_accuracy: 0.55052 |  0:01:55s
epoch 7  | loss: 0.66256 | train_auc: 0.60428 | train_balanced_accuracy: 0.54038 | train_accuracy: 0.53761 | valid_auc: 0.60569 | valid_balanced_accuracy: 0.54544 | valid_accuracy: 0.54265 |  0:02:11s
epoch 8  | loss: 0.65872 | train_auc: 0.62003 | train_balanced_accuracy: 0.54964 | train_accuracy: 0.54714 | valid_auc: 0.61865 | valid_balanced_accuracy: 0.55306 | valid_accuracy: 0.55052 |  0:02:26s
epoch 9  | loss: 0.65533 | train_auc: 0.63205 | train_balanced_accuracy: 0.55526 | train_accuracy: 0.55284 | valid_auc: 0.63052 | valid_balanced_accuracy: 0.55993 | valid_accuracy: 0.55744 |  0:02:42s
epoch 10 | loss: 0.65299 | train_auc: 0.64255 | train_balanced_accuracy: 0.56636 | train_accuracy: 0.56417 | valid_auc: 0.64127 | valid_balanced_accuracy: 0.56254 | valid_accuracy: 0.56028 |  0:03:01s
epoch 11 | loss: 0.64983 | train_auc: 0.65336 | train_balanced_accuracy: 0.58179 | train_accuracy: 0.57987 | valid_auc: 0.64985 | valid_balanced_accuracy: 0.57892 | valid_accuracy: 0.57696 |  0:03:18s
epoch 12 | loss: 0.64991 | train_auc: 0.65984 | train_balanced_accuracy: 0.58868 | train_accuracy: 0.58691 | valid_auc: 0.65222 | valid_balanced_accuracy: 0.58444 | valid_accuracy: 0.58263 |  0:03:35s
epoch 13 | loss: 0.64916 | train_auc: 0.6666  | train_balanced_accuracy: 0.5967  | train_accuracy: 0.59502 | valid_auc: 0.65835 | valid_balanced_accuracy: 0.59206 | valid_accuracy: 0.59034 |  0:03:52s
epoch 14 | loss: 0.64214 | train_auc: 0.67227 | train_balanced_accuracy: 0.60672 | train_accuracy: 0.60533 | valid_auc: 0.66449 | valid_balanced_accuracy: 0.59852 | valid_accuracy: 0.5971  |  0:04:07s
epoch 15 | loss: 0.64005 | train_auc: 0.67801 | train_balanced_accuracy: 0.61022 | train_accuracy: 0.60883 | valid_auc: 0.66895 | valid_balanced_accuracy: 0.60356 | valid_accuracy: 0.60214 |  0:04:26s
epoch 16 | loss: 0.64154 | train_auc: 0.68534 | train_balanced_accuracy: 0.62415 | train_accuracy: 0.62311 | valid_auc: 0.67554 | valid_balanced_accuracy: 0.61706 | valid_accuracy: 0.61599 |  0:04:43s
epoch 17 | loss: 0.64098 | train_auc: 0.68618 | train_balanced_accuracy: 0.62538 | train_accuracy: 0.62453 | valid_auc: 0.6749  | valid_balanced_accuracy: 0.61593 | valid_accuracy: 0.61505 |  0:05:01s
epoch 18 | loss: 0.64049 | train_auc: 0.68973 | train_balanced_accuracy: 0.63589 | train_accuracy: 0.63547 | valid_auc: 0.67872 | valid_balanced_accuracy: 0.62967 | valid_accuracy: 0.62921 |  0:05:19s
epoch 19 | loss: 0.63644 | train_auc: 0.69316 | train_balanced_accuracy: 0.64523 | train_accuracy: 0.64495 | valid_auc: 0.68349 | valid_balanced_accuracy: 0.63458 | valid_accuracy: 0.63425 |  0:05:35s
epoch 20 | loss: 0.6338  | train_auc: 0.69666 | train_balanced_accuracy: 0.65025 | train_accuracy: 0.65026 | valid_auc: 0.68679 | valid_balanced_accuracy: 0.6437  | valid_accuracy: 0.64369 |  0:05:50s
epoch 21 | loss: 0.63383 | train_auc: 0.699   | train_balanced_accuracy: 0.65114 | train_accuracy: 0.65109 | valid_auc: 0.68685 | valid_balanced_accuracy: 0.64219 | valid_accuracy: 0.64212 |  0:06:06s
epoch 22 | loss: 0.6312  | train_auc: 0.70155 | train_balanced_accuracy: 0.65489 | train_accuracy: 0.65506 | valid_auc: 0.68819 | valid_balanced_accuracy: 0.64291 | valid_accuracy: 0.64306 |  0:06:24s
epoch 23 | loss: 0.62984 | train_auc: 0.70323 | train_balanced_accuracy: 0.65533 | train_accuracy: 0.65545 | valid_auc: 0.68867 | valid_balanced_accuracy: 0.64422 | valid_accuracy: 0.64432 |  0:06:40s
epoch 24 | loss: 0.63542 | train_auc: 0.70583 | train_balanced_accuracy: 0.65709 | train_accuracy: 0.6573  | valid_auc: 0.69375 | valid_balanced_accuracy: 0.64397 | valid_accuracy: 0.64416 |  0:06:56s
epoch 25 | loss: 0.62817 | train_auc: 0.70804 | train_balanced_accuracy: 0.65886 | train_accuracy: 0.65907 | valid_auc: 0.69638 | valid_balanced_accuracy: 0.65057 | valid_accuracy: 0.65077 |  0:07:12s
epoch 26 | loss: 0.62777 | train_auc: 0.70958 | train_balanced_accuracy: 0.65809 | train_accuracy: 0.65833 | valid_auc: 0.69798 | valid_balanced_accuracy: 0.65117 | valid_accuracy: 0.6514  |  0:07:30s
epoch 27 | loss: 0.62759 | train_auc: 0.71185 | train_balanced_accuracy: 0.65958 | train_accuracy: 0.65986 | valid_auc: 0.69869 | valid_balanced_accuracy: 0.6505  | valid_accuracy: 0.65077 |  0:07:46s
epoch 28 | loss: 0.62886 | train_auc: 0.71399 | train_balanced_accuracy: 0.65925 | train_accuracy: 0.65939 | valid_auc: 0.70053 | valid_balanced_accuracy: 0.6497  | valid_accuracy: 0.64983 |  0:08:04s
epoch 29 | loss: 0.62681 | train_auc: 0.71529 | train_balanced_accuracy: 0.65966 | train_accuracy: 0.6599  | valid_auc: 0.70279 | valid_balanced_accuracy: 0.64816 | valid_accuracy: 0.64841 |  0:08:20s
epoch 30 | loss: 0.62524 | train_auc: 0.71841 | train_balanced_accuracy: 0.66427 | train_accuracy: 0.66454 | valid_auc: 0.70518 | valid_balanced_accuracy: 0.65112 | valid_accuracy: 0.6514  |  0:08:37s
epoch 31 | loss: 0.6244  | train_auc: 0.71824 | train_balanced_accuracy: 0.66005 | train_accuracy: 0.66021 | valid_auc: 0.70535 | valid_balanced_accuracy: 0.65173 | valid_accuracy: 0.65187 |  0:08:52s
epoch 32 | loss: 0.62581 | train_auc: 0.7185  | train_balanced_accuracy: 0.66033 | train_accuracy: 0.66053 | valid_auc: 0.70477 | valid_balanced_accuracy: 0.64838 | valid_accuracy: 0.64857 |  0:09:09s
epoch 33 | loss: 0.62759 | train_auc: 0.71793 | train_balanced_accuracy: 0.6595  | train_accuracy: 0.6597  | valid_auc: 0.70204 | valid_balanced_accuracy: 0.64728 | valid_accuracy: 0.64747 |  0:09:27s
epoch 34 | loss: 0.61897 | train_auc: 0.71781 | train_balanced_accuracy: 0.66049 | train_accuracy: 0.66069 | valid_auc: 0.70204 | valid_balanced_accuracy: 0.64679 | valid_accuracy: 0.64699 |  0:09:43s
epoch 35 | loss: 0.62248 | train_auc: 0.713   | train_balanced_accuracy: 0.65888 | train_accuracy: 0.65907 | valid_auc: 0.70473 | valid_balanced_accuracy: 0.64664 | valid_accuracy: 0.64684 |  0:09:59s
epoch 36 | loss: 0.61676 | train_auc: 0.71224 | train_balanced_accuracy: 0.65746 | train_accuracy: 0.65762 | valid_auc: 0.70442 | valid_balanced_accuracy: 0.64655 | valid_accuracy: 0.64668 |  0:10:16s
epoch 37 | loss: 0.62071 | train_auc: 0.71145 | train_balanced_accuracy: 0.65516 | train_accuracy: 0.6553  | valid_auc: 0.70564 | valid_balanced_accuracy: 0.64802 | valid_accuracy: 0.6481  |  0:10:32s
epoch 38 | loss: 0.61875 | train_auc: 0.70478 | train_balanced_accuracy: 0.6513  | train_accuracy: 0.6514  | valid_auc: 0.70232 | valid_balanced_accuracy: 0.65208 | valid_accuracy: 0.65219 |  0:10:49s
epoch 39 | loss: 0.62147 | train_auc: 0.70844 | train_balanced_accuracy: 0.65406 | train_accuracy: 0.65423 | valid_auc: 0.70392 | valid_balanced_accuracy: 0.64681 | valid_accuracy: 0.64699 |  0:11:06s
epoch 40 | loss: 0.61732 | train_auc: 0.71871 | train_balanced_accuracy: 0.66062 | train_accuracy: 0.6608  | valid_auc: 0.70707 | valid_balanced_accuracy: 0.6465  | valid_accuracy: 0.64668 |  0:11:22s
epoch 41 | loss: 0.61788 | train_auc: 0.71724 | train_balanced_accuracy: 0.65875 | train_accuracy: 0.65899 | valid_auc: 0.70685 | valid_balanced_accuracy: 0.6483  | valid_accuracy: 0.64857 |  0:11:39s
epoch 42 | loss: 0.61779 | train_auc: 0.71548 | train_balanced_accuracy: 0.65944 | train_accuracy: 0.65962 | valid_auc: 0.70725 | valid_balanced_accuracy: 0.65056 | valid_accuracy: 0.65077 |  0:11:57s
epoch 43 | loss: 0.61442 | train_auc: 0.72697 | train_balanced_accuracy: 0.6661  | train_accuracy: 0.66619 | valid_auc: 0.71031 | valid_balanced_accuracy: 0.65035 | valid_accuracy: 0.65046 |  0:12:13s
epoch 44 | loss: 0.61542 | train_auc: 0.72938 | train_balanced_accuracy: 0.67006 | train_accuracy: 0.67029 | valid_auc: 0.71415 | valid_balanced_accuracy: 0.65558 | valid_accuracy: 0.65581 |  0:12:29s
epoch 45 | loss: 0.61424 | train_auc: 0.7093  | train_balanced_accuracy: 0.6547  | train_accuracy: 0.6551  | valid_auc: 0.70144 | valid_balanced_accuracy: 0.64203 | valid_accuracy: 0.64243 |  0:12:46s
epoch 46 | loss: 0.61638 | train_auc: 0.70587 | train_balanced_accuracy: 0.65042 | train_accuracy: 0.65073 | valid_auc: 0.70086 | valid_balanced_accuracy: 0.64651 | valid_accuracy: 0.64684 |  0:13:02s
epoch 47 | loss: 0.61745 | train_auc: 0.73192 | train_balanced_accuracy: 0.67204 | train_accuracy: 0.67225 | valid_auc: 0.71348 | valid_balanced_accuracy: 0.65668 | valid_accuracy: 0.65691 |  0:13:20s
epoch 48 | loss: 0.61376 | train_auc: 0.73142 | train_balanced_accuracy: 0.66954 | train_accuracy: 0.66993 | valid_auc: 0.71363 | valid_balanced_accuracy: 0.65366 | valid_accuracy: 0.65408 |  0:13:37s
epoch 49 | loss: 0.61358 | train_auc: 0.73144 | train_balanced_accuracy: 0.67121 | train_accuracy: 0.67151 | valid_auc: 0.71663 | valid_balanced_accuracy: 0.65803 | valid_accuracy: 0.65833 |  0:13:55s
epoch 50 | loss: 0.61015 | train_auc: 0.72943 | train_balanced_accuracy: 0.66787 | train_accuracy: 0.668   | valid_auc: 0.71363 | valid_balanced_accuracy: 0.65108 | valid_accuracy: 0.65124 |  0:14:13s
epoch 51 | loss: 0.61235 | train_auc: 0.72419 | train_balanced_accuracy: 0.66533 | train_accuracy: 0.6656  | valid_auc: 0.70793 | valid_balanced_accuracy: 0.64796 | valid_accuracy: 0.64825 |  0:14:30s
epoch 52 | loss: 0.61381 | train_auc: 0.72417 | train_balanced_accuracy: 0.66576 | train_accuracy: 0.66604 | valid_auc: 0.71007 | valid_balanced_accuracy: 0.65222 | valid_accuracy: 0.6525  |  0:14:49s
epoch 53 | loss: 0.61603 | train_auc: 0.72587 | train_balanced_accuracy: 0.66593 | train_accuracy: 0.66619 | valid_auc: 0.71131 | valid_balanced_accuracy: 0.65398 | valid_accuracy: 0.65423 |  0:15:06s
epoch 54 | loss: 0.61608 | train_auc: 0.71339 | train_balanced_accuracy: 0.65691 | train_accuracy: 0.65711 | valid_auc: 0.707   | valid_balanced_accuracy: 0.64588 | valid_accuracy: 0.64605 |  0:15:23s
epoch 55 | loss: 0.61457 | train_auc: 0.71959 | train_balanced_accuracy: 0.66191 | train_accuracy: 0.66222 | valid_auc: 0.70863 | valid_balanced_accuracy: 0.64808 | valid_accuracy: 0.64841 |  0:15:40s
epoch 56 | loss: 0.61482 | train_auc: 0.73356 | train_balanced_accuracy: 0.67267 | train_accuracy: 0.673   | valid_auc: 0.71682 | valid_balanced_accuracy: 0.6558  | valid_accuracy: 0.65612 |  0:15:57s
epoch 57 | loss: 0.61109 | train_auc: 0.73143 | train_balanced_accuracy: 0.67181 | train_accuracy: 0.67206 | valid_auc: 0.71655 | valid_balanced_accuracy: 0.65634 | valid_accuracy: 0.65659 |  0:16:14s
epoch 58 | loss: 0.60944 | train_auc: 0.73519 | train_balanced_accuracy: 0.67378 | train_accuracy: 0.67406 | valid_auc: 0.71772 | valid_balanced_accuracy: 0.65643 | valid_accuracy: 0.65675 |  0:16:29s
epoch 59 | loss: 0.61542 | train_auc: 0.73526 | train_balanced_accuracy: 0.67414 | train_accuracy: 0.67446 | valid_auc: 0.72018 | valid_balanced_accuracy: 0.65832 | valid_accuracy: 0.65864 |  0:16:45s
epoch 60 | loss: 0.6159  | train_auc: 0.72671 | train_balanced_accuracy: 0.66947 | train_accuracy: 0.66993 | valid_auc: 0.71523 | valid_balanced_accuracy: 0.65735 | valid_accuracy: 0.65785 |  0:17:01s
epoch 61 | loss: 0.61683 | train_auc: 0.7299  | train_balanced_accuracy: 0.6695  | train_accuracy: 0.66981 | valid_auc: 0.71906 | valid_balanced_accuracy: 0.65752 | valid_accuracy: 0.65785 |  0:17:18s
epoch 62 | loss: 0.60767 | train_auc: 0.73342 | train_balanced_accuracy: 0.67163 | train_accuracy: 0.67206 | valid_auc: 0.7197  | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65534 |  0:17:34s
epoch 63 | loss: 0.60912 | train_auc: 0.73776 | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67709 | valid_auc: 0.7234  | valid_balanced_accuracy: 0.66011 | valid_accuracy: 0.66053 |  0:17:50s
epoch 64 | loss: 0.60787 | train_auc: 0.73771 | train_balanced_accuracy: 0.67773 | train_accuracy: 0.67808 | valid_auc: 0.72283 | valid_balanced_accuracy: 0.65939 | valid_accuracy: 0.65974 |  0:18:06s
epoch 65 | loss: 0.61521 | train_auc: 0.73065 | train_balanced_accuracy: 0.67075 | train_accuracy: 0.67099 | valid_auc: 0.71355 | valid_balanced_accuracy: 0.65242 | valid_accuracy: 0.65266 |  0:18:23s
epoch 66 | loss: 0.6082  | train_auc: 0.73504 | train_balanced_accuracy: 0.67403 | train_accuracy: 0.67434 | valid_auc: 0.71754 | valid_balanced_accuracy: 0.65627 | valid_accuracy: 0.65659 |  0:18:40s
epoch 67 | loss: 0.61131 | train_auc: 0.72305 | train_balanced_accuracy: 0.6635  | train_accuracy: 0.66391 | valid_auc: 0.71111 | valid_balanced_accuracy: 0.65316 | valid_accuracy: 0.6536  |  0:18:56s
epoch 68 | loss: 0.60956 | train_auc: 0.70708 | train_balanced_accuracy: 0.6477  | train_accuracy: 0.6481  | valid_auc: 0.70426 | valid_balanced_accuracy: 0.64466 | valid_accuracy: 0.64511 |  0:19:13s
epoch 69 | loss: 0.61108 | train_auc: 0.70039 | train_balanced_accuracy: 0.64693 | train_accuracy: 0.64731 | valid_auc: 0.70178 | valid_balanced_accuracy: 0.64909 | valid_accuracy: 0.64951 |  0:19:30s
epoch 70 | loss: 0.60829 | train_auc: 0.72615 | train_balanced_accuracy: 0.66609 | train_accuracy: 0.66643 | valid_auc: 0.71124 | valid_balanced_accuracy: 0.65217 | valid_accuracy: 0.6525  |  0:19:48s
epoch 71 | loss: 0.60825 | train_auc: 0.73897 | train_balanced_accuracy: 0.67779 | train_accuracy: 0.67819 | valid_auc: 0.7217  | valid_balanced_accuracy: 0.65557 | valid_accuracy: 0.65596 |  0:20:06s
epoch 72 | loss: 0.60611 | train_auc: 0.73787 | train_balanced_accuracy: 0.67585 | train_accuracy: 0.67615 | valid_auc: 0.72125 | valid_balanced_accuracy: 0.65599 | valid_accuracy: 0.65628 |  0:20:22s
epoch 73 | loss: 0.60587 | train_auc: 0.70682 | train_balanced_accuracy: 0.65229 | train_accuracy: 0.65266 | valid_auc: 0.70681 | valid_balanced_accuracy: 0.65182 | valid_accuracy: 0.65219 |  0:20:40s
epoch 74 | loss: 0.60666 | train_auc: 0.70288 | train_balanced_accuracy: 0.65045 | train_accuracy: 0.65081 | valid_auc: 0.7041  | valid_balanced_accuracy: 0.65057 | valid_accuracy: 0.65093 |  0:20:57s
epoch 75 | loss: 0.60384 | train_auc: 0.70895 | train_balanced_accuracy: 0.65387 | train_accuracy: 0.65412 | valid_auc: 0.70831 | valid_balanced_accuracy: 0.65067 | valid_accuracy: 0.65093 |  0:21:14s
epoch 76 | loss: 0.60655 | train_auc: 0.73544 | train_balanced_accuracy: 0.67294 | train_accuracy: 0.67336 | valid_auc: 0.71979 | valid_balanced_accuracy: 0.6551  | valid_accuracy: 0.65549 |  0:21:30s
epoch 77 | loss: 0.60558 | train_auc: 0.73527 | train_balanced_accuracy: 0.672   | train_accuracy: 0.67237 | valid_auc: 0.72013 | valid_balanced_accuracy: 0.65715 | valid_accuracy: 0.65754 |  0:21:46s
epoch 78 | loss: 0.60295 | train_auc: 0.73934 | train_balanced_accuracy: 0.67671 | train_accuracy: 0.67713 | valid_auc: 0.7224  | valid_balanced_accuracy: 0.6568  | valid_accuracy: 0.65722 |  0:22:03s
epoch 79 | loss: 0.6066  | train_auc: 0.73791 | train_balanced_accuracy: 0.67304 | train_accuracy: 0.67336 | valid_auc: 0.71979 | valid_balanced_accuracy: 0.65283 | valid_accuracy: 0.65313 |  0:22:20s
epoch 80 | loss: 0.60809 | train_auc: 0.73802 | train_balanced_accuracy: 0.67334 | train_accuracy: 0.67383 | valid_auc: 0.72145 | valid_balanced_accuracy: 0.65473 | valid_accuracy: 0.65518 |  0:22:37s
epoch 81 | loss: 0.60229 | train_auc: 0.74347 | train_balanced_accuracy: 0.67962 | train_accuracy: 0.67989 | valid_auc: 0.72478 | valid_balanced_accuracy: 0.66093 | valid_accuracy: 0.66116 |  0:22:53s
epoch 82 | loss: 0.60362 | train_auc: 0.74042 | train_balanced_accuracy: 0.67785 | train_accuracy: 0.67808 | valid_auc: 0.7254  | valid_balanced_accuracy: 0.66233 | valid_accuracy: 0.66257 |  0:23:08s
epoch 83 | loss: 0.60283 | train_auc: 0.7306  | train_balanced_accuracy: 0.6698  | train_accuracy: 0.67009 | valid_auc: 0.72268 | valid_balanced_accuracy: 0.66103 | valid_accuracy: 0.66132 |  0:23:23s
epoch 84 | loss: 0.6036  | train_auc: 0.73049 | train_balanced_accuracy: 0.6691  | train_accuracy: 0.66946 | valid_auc: 0.72258 | valid_balanced_accuracy: 0.65857 | valid_accuracy: 0.65895 |  0:23:41s
epoch 85 | loss: 0.60622 | train_auc: 0.73849 | train_balanced_accuracy: 0.67422 | train_accuracy: 0.67458 | valid_auc: 0.72617 | valid_balanced_accuracy: 0.66456 | valid_accuracy: 0.66494 |  0:23:57s
epoch 86 | loss: 0.6031  | train_auc: 0.74406 | train_balanced_accuracy: 0.67829 | train_accuracy: 0.67882 | valid_auc: 0.72747 | valid_balanced_accuracy: 0.66567 | valid_accuracy: 0.66619 |  0:24:14s
epoch 87 | loss: 0.60286 | train_auc: 0.74077 | train_balanced_accuracy: 0.67825 | train_accuracy: 0.67863 | valid_auc: 0.72485 | valid_balanced_accuracy: 0.6622  | valid_accuracy: 0.66257 |  0:24:29s
epoch 88 | loss: 0.60527 | train_auc: 0.74349 | train_balanced_accuracy: 0.67981 | train_accuracy: 0.68012 | valid_auc: 0.72758 | valid_balanced_accuracy: 0.66479 | valid_accuracy: 0.66509 |  0:24:45s
epoch 89 | loss: 0.60223 | train_auc: 0.74247 | train_balanced_accuracy: 0.67817 | train_accuracy: 0.67851 | valid_auc: 0.72577 | valid_balanced_accuracy: 0.66035 | valid_accuracy: 0.66069 |  0:25:02s
epoch 90 | loss: 0.59907 | train_auc: 0.74246 | train_balanced_accuracy: 0.67986 | train_accuracy: 0.68012 | valid_auc: 0.7245  | valid_balanced_accuracy: 0.66141 | valid_accuracy: 0.66163 |  0:25:18s
epoch 91 | loss: 0.60304 | train_auc: 0.72884 | train_balanced_accuracy: 0.66679 | train_accuracy: 0.66702 | valid_auc: 0.71516 | valid_balanced_accuracy: 0.65321 | valid_accuracy: 0.65345 |  0:25:35s
epoch 92 | loss: 0.60097 | train_auc: 0.72839 | train_balanced_accuracy: 0.66832 | train_accuracy: 0.66852 | valid_auc: 0.71402 | valid_balanced_accuracy: 0.65307 | valid_accuracy: 0.65329 |  0:25:52s
epoch 93 | loss: 0.60208 | train_auc: 0.73521 | train_balanced_accuracy: 0.67187 | train_accuracy: 0.6721  | valid_auc: 0.71819 | valid_balanced_accuracy: 0.65403 | valid_accuracy: 0.65423 |  0:26:09s
epoch 94 | loss: 0.60567 | train_auc: 0.72464 | train_balanced_accuracy: 0.66386 | train_accuracy: 0.66419 | valid_auc: 0.71163 | valid_balanced_accuracy: 0.65244 | valid_accuracy: 0.65282 |  0:26:25s
epoch 95 | loss: 0.59654 | train_auc: 0.72188 | train_balanced_accuracy: 0.66    | train_accuracy: 0.66025 | valid_auc: 0.7124  | valid_balanced_accuracy: 0.65614 | valid_accuracy: 0.65644 |  0:26:41s
epoch 96 | loss: 0.59856 | train_auc: 0.74523 | train_balanced_accuracy: 0.68223 | train_accuracy: 0.68248 | valid_auc: 0.72516 | valid_balanced_accuracy: 0.65937 | valid_accuracy: 0.65958 |  0:26:59s
epoch 97 | loss: 0.60278 | train_auc: 0.73653 | train_balanced_accuracy: 0.67561 | train_accuracy: 0.67611 | valid_auc: 0.72476 | valid_balanced_accuracy: 0.66682 | valid_accuracy: 0.6673  |  0:27:14s
epoch 98 | loss: 0.60416 | train_auc: 0.73433 | train_balanced_accuracy: 0.67377 | train_accuracy: 0.67422 | valid_auc: 0.72565 | valid_balanced_accuracy: 0.6659  | valid_accuracy: 0.66635 |  0:27:31s
epoch 99 | loss: 0.60318 | train_auc: 0.73918 | train_balanced_accuracy: 0.67655 | train_accuracy: 0.67701 | valid_auc: 0.72713 | valid_balanced_accuracy: 0.66496 | valid_accuracy: 0.66541 |  0:27:47s
epoch 100| loss: 0.59833 | train_auc: 0.74051 | train_balanced_accuracy: 0.67756 | train_accuracy: 0.67796 | valid_auc: 0.72742 | valid_balanced_accuracy: 0.66234 | valid_accuracy: 0.66273 |  0:28:04s
epoch 101| loss: 0.60388 | train_auc: 0.74008 | train_balanced_accuracy: 0.67611 | train_accuracy: 0.6765  | valid_auc: 0.72765 | valid_balanced_accuracy: 0.66517 | valid_accuracy: 0.66556 |  0:28:21s
epoch 102| loss: 0.60207 | train_auc: 0.7457  | train_balanced_accuracy: 0.6817  | train_accuracy: 0.68209 | valid_auc: 0.72871 | valid_balanced_accuracy: 0.66251 | valid_accuracy: 0.66289 |  0:28:39s
epoch 103| loss: 0.59777 | train_auc: 0.74209 | train_balanced_accuracy: 0.67854 | train_accuracy: 0.67894 | valid_auc: 0.72242 | valid_balanced_accuracy: 0.65794 | valid_accuracy: 0.65833 |  0:28:53s
epoch 104| loss: 0.59966 | train_auc: 0.71394 | train_balanced_accuracy: 0.65213 | train_accuracy: 0.65242 | valid_auc: 0.70475 | valid_balanced_accuracy: 0.64181 | valid_accuracy: 0.64212 |  0:29:10s
epoch 105| loss: 0.60267 | train_auc: 0.74425 | train_balanced_accuracy: 0.68256 | train_accuracy: 0.68292 | valid_auc: 0.72411 | valid_balanced_accuracy: 0.65721 | valid_accuracy: 0.65754 |  0:29:28s
epoch 106| loss: 0.5967  | train_auc: 0.75088 | train_balanced_accuracy: 0.68672 | train_accuracy: 0.68705 | valid_auc: 0.73134 | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66934 |  0:29:46s
epoch 107| loss: 0.60109 | train_auc: 0.75064 | train_balanced_accuracy: 0.68591 | train_accuracy: 0.6863  | valid_auc: 0.73094 | valid_balanced_accuracy: 0.66708 | valid_accuracy: 0.66745 |  0:30:03s
epoch 108| loss: 0.60279 | train_auc: 0.75114 | train_balanced_accuracy: 0.68608 | train_accuracy: 0.6863  | valid_auc: 0.72958 | valid_balanced_accuracy: 0.66522 | valid_accuracy: 0.66541 |  0:30:19s
epoch 109| loss: 0.59866 | train_auc: 0.75101 | train_balanced_accuracy: 0.68456 | train_accuracy: 0.68473 | valid_auc: 0.73114 | valid_balanced_accuracy: 0.66652 | valid_accuracy: 0.66667 |  0:30:36s
epoch 110| loss: 0.60104 | train_auc: 0.73605 | train_balanced_accuracy: 0.67327 | train_accuracy: 0.67347 | valid_auc: 0.71871 | valid_balanced_accuracy: 0.66098 | valid_accuracy: 0.66116 |  0:30:54s
epoch 111| loss: 0.59378 | train_auc: 0.74248 | train_balanced_accuracy: 0.67852 | train_accuracy: 0.67875 | valid_auc: 0.72281 | valid_balanced_accuracy: 0.66272 | valid_accuracy: 0.66289 |  0:31:09s
epoch 112| loss: 0.59642 | train_auc: 0.74575 | train_balanced_accuracy: 0.68186 | train_accuracy: 0.68205 | valid_auc: 0.7262  | valid_balanced_accuracy: 0.66163 | valid_accuracy: 0.66179 |  0:31:24s
epoch 113| loss: 0.60425 | train_auc: 0.75171 | train_balanced_accuracy: 0.68653 | train_accuracy: 0.68673 | valid_auc: 0.73168 | valid_balanced_accuracy: 0.66649 | valid_accuracy: 0.66667 |  0:31:40s
epoch 114| loss: 0.59773 | train_auc: 0.73931 | train_balanced_accuracy: 0.67862 | train_accuracy: 0.6789  | valid_auc: 0.72628 | valid_balanced_accuracy: 0.66229 | valid_accuracy: 0.66257 |  0:31:57s
epoch 115| loss: 0.59797 | train_auc: 0.73713 | train_balanced_accuracy: 0.67546 | train_accuracy: 0.67587 | valid_auc: 0.72768 | valid_balanced_accuracy: 0.6666  | valid_accuracy: 0.66698 |  0:32:13s
epoch 116| loss: 0.59874 | train_auc: 0.73893 | train_balanced_accuracy: 0.67617 | train_accuracy: 0.67662 | valid_auc: 0.72646 | valid_balanced_accuracy: 0.66654 | valid_accuracy: 0.66698 |  0:32:31s
epoch 117| loss: 0.5967  | train_auc: 0.73595 | train_balanced_accuracy: 0.67671 | train_accuracy: 0.67713 | valid_auc: 0.72684 | valid_balanced_accuracy: 0.66579 | valid_accuracy: 0.66619 |  0:32:48s
epoch 118| loss: 0.59832 | train_auc: 0.74101 | train_balanced_accuracy: 0.68125 | train_accuracy: 0.68158 | valid_auc: 0.7272  | valid_balanced_accuracy: 0.66631 | valid_accuracy: 0.66667 |  0:33:04s
epoch 119| loss: 0.60106 | train_auc: 0.74487 | train_balanced_accuracy: 0.68259 | train_accuracy: 0.68296 | valid_auc: 0.72882 | valid_balanced_accuracy: 0.67025 | valid_accuracy: 0.6706  |  0:33:21s
epoch 120| loss: 0.59458 | train_auc: 0.7521  | train_balanced_accuracy: 0.68724 | train_accuracy: 0.68756 | valid_auc: 0.73074 | valid_balanced_accuracy: 0.66493 | valid_accuracy: 0.66525 |  0:33:39s
epoch 121| loss: 0.59967 | train_auc: 0.75191 | train_balanced_accuracy: 0.68842 | train_accuracy: 0.68878 | valid_auc: 0.73193 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.67312 |  0:33:56s
epoch 122| loss: 0.59038 | train_auc: 0.74917 | train_balanced_accuracy: 0.68583 | train_accuracy: 0.68614 | valid_auc: 0.73014 | valid_balanced_accuracy: 0.66655 | valid_accuracy: 0.66682 |  0:34:12s
epoch 123| loss: 0.59734 | train_auc: 0.74106 | train_balanced_accuracy: 0.67839 | train_accuracy: 0.67859 | valid_auc: 0.72237 | valid_balanced_accuracy: 0.66605 | valid_accuracy: 0.66619 |  0:34:29s
epoch 124| loss: 0.59339 | train_auc: 0.7331  | train_balanced_accuracy: 0.67171 | train_accuracy: 0.6721  | valid_auc: 0.71894 | valid_balanced_accuracy: 0.66161 | valid_accuracy: 0.66195 |  0:34:45s
epoch 125| loss: 0.59938 | train_auc: 0.71802 | train_balanced_accuracy: 0.65728 | train_accuracy: 0.65758 | valid_auc: 0.70932 | valid_balanced_accuracy: 0.65159 | valid_accuracy: 0.65187 |  0:35:03s
epoch 126| loss: 0.59846 | train_auc: 0.72629 | train_balanced_accuracy: 0.66268 | train_accuracy: 0.66285 | valid_auc: 0.71392 | valid_balanced_accuracy: 0.65735 | valid_accuracy: 0.65754 |  0:35:20s
epoch 127| loss: 0.59596 | train_auc: 0.74913 | train_balanced_accuracy: 0.68611 | train_accuracy: 0.6863  | valid_auc: 0.72777 | valid_balanced_accuracy: 0.66603 | valid_accuracy: 0.66619 |  0:35:37s
epoch 128| loss: 0.59234 | train_auc: 0.74583 | train_balanced_accuracy: 0.68331 | train_accuracy: 0.68335 | valid_auc: 0.72358 | valid_balanced_accuracy: 0.66348 | valid_accuracy: 0.66352 |  0:35:52s
epoch 129| loss: 0.59772 | train_auc: 0.73511 | train_balanced_accuracy: 0.67336 | train_accuracy: 0.67343 | valid_auc: 0.71833 | valid_balanced_accuracy: 0.6598  | valid_accuracy: 0.6599  |  0:36:10s
epoch 130| loss: 0.5978  | train_auc: 0.74302 | train_balanced_accuracy: 0.68042 | train_accuracy: 0.68071 | valid_auc: 0.72233 | valid_balanced_accuracy: 0.66323 | valid_accuracy: 0.66352 |  0:36:28s
epoch 131| loss: 0.59734 | train_auc: 0.75539 | train_balanced_accuracy: 0.68719 | train_accuracy: 0.68728 | valid_auc: 0.73466 | valid_balanced_accuracy: 0.67116 | valid_accuracy: 0.67123 |  0:36:44s
epoch 132| loss: 0.5936  | train_auc: 0.74184 | train_balanced_accuracy: 0.67954 | train_accuracy: 0.67993 | valid_auc: 0.72863 | valid_balanced_accuracy: 0.6726  | valid_accuracy: 0.67296 |  0:37:01s
epoch 133| loss: 0.59493 | train_auc: 0.75321 | train_balanced_accuracy: 0.68713 | train_accuracy: 0.68736 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.66548 | valid_accuracy: 0.66572 |  0:37:17s
epoch 134| loss: 0.59181 | train_auc: 0.75421 | train_balanced_accuracy: 0.68687 | train_accuracy: 0.68701 | valid_auc: 0.73314 | valid_balanced_accuracy: 0.67551 | valid_accuracy: 0.67564 |  0:37:34s
epoch 135| loss: 0.59861 | train_auc: 0.74927 | train_balanced_accuracy: 0.68378 | train_accuracy: 0.68398 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.66712 | valid_accuracy: 0.6673  |  0:37:50s
epoch 136| loss: 0.59292 | train_auc: 0.7471  | train_balanced_accuracy: 0.68322 | train_accuracy: 0.68331 | valid_auc: 0.72807 | valid_balanced_accuracy: 0.66898 | valid_accuracy: 0.66903 |  0:38:06s
epoch 137| loss: 0.59406 | train_auc: 0.7573  | train_balanced_accuracy: 0.69126 | train_accuracy: 0.69145 | valid_auc: 0.73654 | valid_balanced_accuracy: 0.67119 | valid_accuracy: 0.67139 |  0:38:23s
epoch 138| loss: 0.59285 | train_auc: 0.75742 | train_balanced_accuracy: 0.6903  | train_accuracy: 0.69051 | valid_auc: 0.73694 | valid_balanced_accuracy: 0.6726  | valid_accuracy: 0.6728  |  0:38:40s
epoch 139| loss: 0.59138 | train_auc: 0.75624 | train_balanced_accuracy: 0.68941 | train_accuracy: 0.68957 | valid_auc: 0.73563 | valid_balanced_accuracy: 0.67471 | valid_accuracy: 0.67485 |  0:38:57s
epoch 140| loss: 0.59395 | train_auc: 0.75289 | train_balanced_accuracy: 0.68713 | train_accuracy: 0.68736 | valid_auc: 0.73286 | valid_balanced_accuracy: 0.6707  | valid_accuracy: 0.67092 |  0:39:15s
epoch 141| loss: 0.59542 | train_auc: 0.75247 | train_balanced_accuracy: 0.68612 | train_accuracy: 0.68638 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.6664  | valid_accuracy: 0.66667 |  0:39:32s
epoch 142| loss: 0.59164 | train_auc: 0.73648 | train_balanced_accuracy: 0.67747 | train_accuracy: 0.6778  | valid_auc: 0.72691 | valid_balanced_accuracy: 0.66777 | valid_accuracy: 0.66808 |  0:39:50s
epoch 143| loss: 0.58641 | train_auc: 0.74222 | train_balanced_accuracy: 0.67817 | train_accuracy: 0.67867 | valid_auc: 0.72968 | valid_balanced_accuracy: 0.66964 | valid_accuracy: 0.67013 |  0:40:06s
epoch 144| loss: 0.59127 | train_auc: 0.75094 | train_balanced_accuracy: 0.68664 | train_accuracy: 0.68697 | valid_auc: 0.73137 | valid_balanced_accuracy: 0.6709  | valid_accuracy: 0.67123 |  0:40:23s
epoch 145| loss: 0.59032 | train_auc: 0.75077 | train_balanced_accuracy: 0.68687 | train_accuracy: 0.68713 | valid_auc: 0.73222 | valid_balanced_accuracy: 0.67175 | valid_accuracy: 0.67202 |  0:40:40s
epoch 146| loss: 0.59757 | train_auc: 0.75481 | train_balanced_accuracy: 0.6892  | train_accuracy: 0.68953 | valid_auc: 0.73499 | valid_balanced_accuracy: 0.6742  | valid_accuracy: 0.67454 |  0:40:57s
epoch 147| loss: 0.59336 | train_auc: 0.75905 | train_balanced_accuracy: 0.69307 | train_accuracy: 0.69326 | valid_auc: 0.73887 | valid_balanced_accuracy: 0.67212 | valid_accuracy: 0.67233 |  0:41:13s
epoch 148| loss: 0.59652 | train_auc: 0.76002 | train_balanced_accuracy: 0.69363 | train_accuracy: 0.69385 | valid_auc: 0.73889 | valid_balanced_accuracy: 0.67464 | valid_accuracy: 0.67485 |  0:41:29s
epoch 149| loss: 0.58994 | train_auc: 0.7561  | train_balanced_accuracy: 0.6906  | train_accuracy: 0.69082 | valid_auc: 0.73371 | valid_balanced_accuracy: 0.67666 | valid_accuracy: 0.6769  |  0:41:47s
epoch 150| loss: 0.59308 | train_auc: 0.75028 | train_balanced_accuracy: 0.68705 | train_accuracy: 0.68732 | valid_auc: 0.72773 | valid_balanced_accuracy: 0.67063 | valid_accuracy: 0.67092 |  0:42:02s
epoch 151| loss: 0.59048 | train_auc: 0.74851 | train_balanced_accuracy: 0.68588 | train_accuracy: 0.68606 | valid_auc: 0.72658 | valid_balanced_accuracy: 0.66962 | valid_accuracy: 0.66981 |  0:42:19s
epoch 152| loss: 0.59055 | train_auc: 0.75291 | train_balanced_accuracy: 0.6883  | train_accuracy: 0.6885  | valid_auc: 0.73036 | valid_balanced_accuracy: 0.67184 | valid_accuracy: 0.67202 |  0:42:37s
epoch 153| loss: 0.58995 | train_auc: 0.76075 | train_balanced_accuracy: 0.69466 | train_accuracy: 0.69484 | valid_auc: 0.73885 | valid_balanced_accuracy: 0.67278 | valid_accuracy: 0.67296 |  0:42:54s
epoch 154| loss: 0.59414 | train_auc: 0.76025 | train_balanced_accuracy: 0.69421 | train_accuracy: 0.69437 | valid_auc: 0.73721 | valid_balanced_accuracy: 0.6714  | valid_accuracy: 0.67155 |  0:43:09s
epoch 155| loss: 0.59295 | train_auc: 0.75707 | train_balanced_accuracy: 0.6898  | train_accuracy: 0.69004 | valid_auc: 0.73476 | valid_balanced_accuracy: 0.67714 | valid_accuracy: 0.67737 |  0:43:24s
epoch 156| loss: 0.59414 | train_auc: 0.75218 | train_balanced_accuracy: 0.68633 | train_accuracy: 0.68658 | valid_auc: 0.73109 | valid_balanced_accuracy: 0.6743  | valid_accuracy: 0.67454 |  0:43:40s
epoch 157| loss: 0.59662 | train_auc: 0.75403 | train_balanced_accuracy: 0.68882 | train_accuracy: 0.68909 | valid_auc: 0.73164 | valid_balanced_accuracy: 0.67525 | valid_accuracy: 0.67548 |  0:43:57s
epoch 158| loss: 0.59657 | train_auc: 0.75913 | train_balanced_accuracy: 0.69306 | train_accuracy: 0.69322 | valid_auc: 0.73616 | valid_balanced_accuracy: 0.67725 | valid_accuracy: 0.67737 |  0:44:13s
epoch 159| loss: 0.58865 | train_auc: 0.76009 | train_balanced_accuracy: 0.69414 | train_accuracy: 0.69433 | valid_auc: 0.73616 | valid_balanced_accuracy: 0.67451 | valid_accuracy: 0.67469 |  0:44:31s
epoch 160| loss: 0.59218 | train_auc: 0.76168 | train_balanced_accuracy: 0.69517 | train_accuracy: 0.69523 | valid_auc: 0.73675 | valid_balanced_accuracy: 0.67843 | valid_accuracy: 0.67847 |  0:44:49s
epoch 161| loss: 0.5888  | train_auc: 0.75781 | train_balanced_accuracy: 0.6927  | train_accuracy: 0.69291 | valid_auc: 0.73291 | valid_balanced_accuracy: 0.67452 | valid_accuracy: 0.67469 |  0:45:07s
epoch 162| loss: 0.58888 | train_auc: 0.75751 | train_balanced_accuracy: 0.69203 | train_accuracy: 0.6922  | valid_auc: 0.73232 | valid_balanced_accuracy: 0.67314 | valid_accuracy: 0.67328 |  0:45:24s
epoch 163| loss: 0.59292 | train_auc: 0.76155 | train_balanced_accuracy: 0.69518 | train_accuracy: 0.69539 | valid_auc: 0.73485 | valid_balanced_accuracy: 0.67307 | valid_accuracy: 0.67328 |  0:45:41s
epoch 164| loss: 0.58812 | train_auc: 0.75921 | train_balanced_accuracy: 0.6932  | train_accuracy: 0.6935  | valid_auc: 0.7359  | valid_balanced_accuracy: 0.67613 | valid_accuracy: 0.67642 |  0:45:58s
epoch 165| loss: 0.59048 | train_auc: 0.75574 | train_balanced_accuracy: 0.68928 | train_accuracy: 0.68968 | valid_auc: 0.73525 | valid_balanced_accuracy: 0.67352 | valid_accuracy: 0.67391 |  0:46:14s
epoch 166| loss: 0.59028 | train_auc: 0.75799 | train_balanced_accuracy: 0.6924  | train_accuracy: 0.69267 | valid_auc: 0.73488 | valid_balanced_accuracy: 0.67129 | valid_accuracy: 0.67155 |  0:46:30s
epoch 167| loss: 0.58912 | train_auc: 0.75687 | train_balanced_accuracy: 0.69051 | train_accuracy: 0.69075 | valid_auc: 0.73236 | valid_balanced_accuracy: 0.67074 | valid_accuracy: 0.67092 |  0:46:45s
epoch 168| loss: 0.59351 | train_auc: 0.74562 | train_balanced_accuracy: 0.68133 | train_accuracy: 0.68185 | valid_auc: 0.72664 | valid_balanced_accuracy: 0.66994 | valid_accuracy: 0.67044 |  0:47:02s
epoch 169| loss: 0.59082 | train_auc: 0.76249 | train_balanced_accuracy: 0.69472 | train_accuracy: 0.69507 | valid_auc: 0.73712 | valid_balanced_accuracy: 0.67721 | valid_accuracy: 0.67753 |  0:47:17s
epoch 170| loss: 0.58793 | train_auc: 0.76291 | train_balanced_accuracy: 0.69472 | train_accuracy: 0.69496 | valid_auc: 0.73756 | valid_balanced_accuracy: 0.68029 | valid_accuracy: 0.68052 |  0:47:33s
epoch 171| loss: 0.58951 | train_auc: 0.76144 | train_balanced_accuracy: 0.69385 | train_accuracy: 0.69401 | valid_auc: 0.73445 | valid_balanced_accuracy: 0.67721 | valid_accuracy: 0.67737 |  0:47:48s
epoch 172| loss: 0.59063 | train_auc: 0.7594  | train_balanced_accuracy: 0.69081 | train_accuracy: 0.69102 | valid_auc: 0.73466 | valid_balanced_accuracy: 0.67592 | valid_accuracy: 0.67611 |  0:48:04s
epoch 173| loss: 0.59131 | train_auc: 0.76013 | train_balanced_accuracy: 0.69294 | train_accuracy: 0.69322 | valid_auc: 0.73445 | valid_balanced_accuracy: 0.67472 | valid_accuracy: 0.67501 |  0:48:20s
epoch 174| loss: 0.58922 | train_auc: 0.76128 | train_balanced_accuracy: 0.6931  | train_accuracy: 0.69334 | valid_auc: 0.73508 | valid_balanced_accuracy: 0.67383 | valid_accuracy: 0.67406 |  0:48:37s
epoch 175| loss: 0.58891 | train_auc: 0.76237 | train_balanced_accuracy: 0.69615 | train_accuracy: 0.69633 | valid_auc: 0.73696 | valid_balanced_accuracy: 0.6767  | valid_accuracy: 0.6769  |  0:48:54s
epoch 176| loss: 0.58913 | train_auc: 0.76521 | train_balanced_accuracy: 0.69722 | train_accuracy: 0.69747 | valid_auc: 0.73956 | valid_balanced_accuracy: 0.6828  | valid_accuracy: 0.68303 |  0:49:12s
epoch 177| loss: 0.59241 | train_auc: 0.75962 | train_balanced_accuracy: 0.69452 | train_accuracy: 0.69472 | valid_auc: 0.73567 | valid_balanced_accuracy: 0.67843 | valid_accuracy: 0.67863 |  0:49:30s
epoch 178| loss: 0.58413 | train_auc: 0.76288 | train_balanced_accuracy: 0.69551 | train_accuracy: 0.6957  | valid_auc: 0.73837 | valid_balanced_accuracy: 0.6805  | valid_accuracy: 0.68067 |  0:49:47s
epoch 179| loss: 0.59219 | train_auc: 0.7627  | train_balanced_accuracy: 0.69557 | train_accuracy: 0.69578 | valid_auc: 0.73635 | valid_balanced_accuracy: 0.67512 | valid_accuracy: 0.67532 |  0:50:04s
epoch 180| loss: 0.58897 | train_auc: 0.73372 | train_balanced_accuracy: 0.66895 | train_accuracy: 0.66926 | valid_auc: 0.71964 | valid_balanced_accuracy: 0.66222 | valid_accuracy: 0.66257 |  0:50:20s
epoch 181| loss: 0.58712 | train_auc: 0.74485 | train_balanced_accuracy: 0.681   | train_accuracy: 0.68115 | valid_auc: 0.72604 | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66918 |  0:50:37s
epoch 182| loss: 0.58373 | train_auc: 0.76319 | train_balanced_accuracy: 0.69438 | train_accuracy: 0.69456 | valid_auc: 0.73804 | valid_balanced_accuracy: 0.67625 | valid_accuracy: 0.67642 |  0:50:56s
epoch 183| loss: 0.58875 | train_auc: 0.75659 | train_balanced_accuracy: 0.69159 | train_accuracy: 0.69181 | valid_auc: 0.73193 | valid_balanced_accuracy: 0.67134 | valid_accuracy: 0.67155 |  0:51:13s
epoch 184| loss: 0.58578 | train_auc: 0.7518  | train_balanced_accuracy: 0.68912 | train_accuracy: 0.68925 | valid_auc: 0.73013 | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66918 |  0:51:30s
epoch 185| loss: 0.5851  | train_auc: 0.76354 | train_balanced_accuracy: 0.69444 | train_accuracy: 0.69476 | valid_auc: 0.73591 | valid_balanced_accuracy: 0.67928 | valid_accuracy: 0.67957 |  0:51:48s
epoch 186| loss: 0.58972 | train_auc: 0.76516 | train_balanced_accuracy: 0.69613 | train_accuracy: 0.69637 | valid_auc: 0.73866 | valid_balanced_accuracy: 0.6773  | valid_accuracy: 0.67753 |  0:52:05s
epoch 187| loss: 0.5896  | train_auc: 0.76433 | train_balanced_accuracy: 0.69675 | train_accuracy: 0.697   | valid_auc: 0.73611 | valid_balanced_accuracy: 0.67522 | valid_accuracy: 0.67548 |  0:52:22s
epoch 188| loss: 0.58745 | train_auc: 0.76303 | train_balanced_accuracy: 0.69556 | train_accuracy: 0.69582 | valid_auc: 0.7357  | valid_balanced_accuracy: 0.67648 | valid_accuracy: 0.67674 |  0:52:39s
epoch 189| loss: 0.58678 | train_auc: 0.76509 | train_balanced_accuracy: 0.69527 | train_accuracy: 0.69559 | valid_auc: 0.73775 | valid_balanced_accuracy: 0.67863 | valid_accuracy: 0.67894 |  0:52:55s
epoch 190| loss: 0.58601 | train_auc: 0.76459 | train_balanced_accuracy: 0.69604 | train_accuracy: 0.69633 | valid_auc: 0.73856 | valid_balanced_accuracy: 0.67679 | valid_accuracy: 0.67705 |  0:53:12s
epoch 191| loss: 0.58236 | train_auc: 0.76585 | train_balanced_accuracy: 0.6959  | train_accuracy: 0.69618 | valid_auc: 0.73926 | valid_balanced_accuracy: 0.67791 | valid_accuracy: 0.67816 |  0:53:27s
epoch 192| loss: 0.58778 | train_auc: 0.76331 | train_balanced_accuracy: 0.69783 | train_accuracy: 0.69806 | valid_auc: 0.73625 | valid_balanced_accuracy: 0.67522 | valid_accuracy: 0.67548 |  0:53:44s
epoch 193| loss: 0.58823 | train_auc: 0.7625  | train_balanced_accuracy: 0.69675 | train_accuracy: 0.69696 | valid_auc: 0.73619 | valid_balanced_accuracy: 0.67652 | valid_accuracy: 0.67674 |  0:54:00s
epoch 194| loss: 0.58617 | train_auc: 0.76299 | train_balanced_accuracy: 0.69613 | train_accuracy: 0.69637 | valid_auc: 0.73701 | valid_balanced_accuracy: 0.67682 | valid_accuracy: 0.67705 |  0:54:17s
epoch 195| loss: 0.58504 | train_auc: 0.76401 | train_balanced_accuracy: 0.69761 | train_accuracy: 0.69787 | valid_auc: 0.73725 | valid_balanced_accuracy: 0.67602 | valid_accuracy: 0.67627 |  0:54:33s
epoch 196| loss: 0.58805 | train_auc: 0.76245 | train_balanced_accuracy: 0.69666 | train_accuracy: 0.69692 | valid_auc: 0.73628 | valid_balanced_accuracy: 0.67457 | valid_accuracy: 0.67485 |  0:54:48s

Early stopping occurred at epoch 196 with best_epoch = 176 and best_valid_accuracy = 0.68303
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 51/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.675 total time=54.9min
[CV 1/5; 52/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70373 | train_auc: 0.6068  | train_balanced_accuracy: 0.5782  | train_accuracy: 0.57797 | valid_auc: 0.6104  | valid_balanced_accuracy: 0.58302 | valid_accuracy: 0.58278 |  0:00:17s
epoch 1  | loss: 0.6539  | train_auc: 0.62581 | train_balanced_accuracy: 0.59244 | train_accuracy: 0.59307 | valid_auc: 0.6137  | valid_balanced_accuracy: 0.58497 | valid_accuracy: 0.58562 |  0:00:34s
epoch 2  | loss: 0.63612 | train_auc: 0.6201  | train_balanced_accuracy: 0.57595 | train_accuracy: 0.57765 | valid_auc: 0.60752 | valid_balanced_accuracy: 0.56452 | valid_accuracy: 0.56626 |  0:00:49s
epoch 3  | loss: 0.62381 | train_auc: 0.64757 | train_balanced_accuracy: 0.60757 | train_accuracy: 0.60858 | valid_auc: 0.63676 | valid_balanced_accuracy: 0.60304 | valid_accuracy: 0.60403 |  0:01:04s
epoch 4  | loss: 0.61425 | train_auc: 0.6751  | train_balanced_accuracy: 0.59646 | train_accuracy: 0.59827 | valid_auc: 0.66484 | valid_balanced_accuracy: 0.59267 | valid_accuracy: 0.59459 |  0:01:20s
epoch 5  | loss: 0.61348 | train_auc: 0.69708 | train_balanced_accuracy: 0.63786 | train_accuracy: 0.63919 | valid_auc: 0.69098 | valid_balanced_accuracy: 0.63491 | valid_accuracy: 0.63629 |  0:01:37s
epoch 6  | loss: 0.61296 | train_auc: 0.70261 | train_balanced_accuracy: 0.644   | train_accuracy: 0.64493 | valid_auc: 0.69241 | valid_balanced_accuracy: 0.6423  | valid_accuracy: 0.64322 |  0:01:55s
epoch 7  | loss: 0.60838 | train_auc: 0.7059  | train_balanced_accuracy: 0.64392 | train_accuracy: 0.6445  | valid_auc: 0.70248 | valid_balanced_accuracy: 0.64527 | valid_accuracy: 0.64589 |  0:02:13s
epoch 8  | loss: 0.59789 | train_auc: 0.71006 | train_balanced_accuracy: 0.64962 | train_accuracy: 0.65056 | valid_auc: 0.70007 | valid_balanced_accuracy: 0.64339 | valid_accuracy: 0.64432 |  0:02:31s
epoch 9  | loss: 0.60338 | train_auc: 0.71547 | train_balanced_accuracy: 0.65419 | train_accuracy: 0.65497 | valid_auc: 0.71036 | valid_balanced_accuracy: 0.64998 | valid_accuracy: 0.65077 |  0:02:48s
epoch 10 | loss: 0.59305 | train_auc: 0.71447 | train_balanced_accuracy: 0.64981 | train_accuracy: 0.65025 | valid_auc: 0.70922 | valid_balanced_accuracy: 0.64672 | valid_accuracy: 0.64715 |  0:03:05s
epoch 11 | loss: 0.59623 | train_auc: 0.71945 | train_balanced_accuracy: 0.65522 | train_accuracy: 0.65575 | valid_auc: 0.71016 | valid_balanced_accuracy: 0.64847 | valid_accuracy: 0.64904 |  0:03:22s
epoch 12 | loss: 0.5982  | train_auc: 0.72354 | train_balanced_accuracy: 0.66542 | train_accuracy: 0.6661  | valid_auc: 0.71127 | valid_balanced_accuracy: 0.6529  | valid_accuracy: 0.6536  |  0:03:40s
epoch 13 | loss: 0.5978  | train_auc: 0.72766 | train_balanced_accuracy: 0.66163 | train_accuracy: 0.66268 | valid_auc: 0.71769 | valid_balanced_accuracy: 0.65126 | valid_accuracy: 0.65234 |  0:03:58s
epoch 14 | loss: 0.59502 | train_auc: 0.72872 | train_balanced_accuracy: 0.6658  | train_accuracy: 0.66646 | valid_auc: 0.71786 | valid_balanced_accuracy: 0.65847 | valid_accuracy: 0.65911 |  0:04:14s
epoch 15 | loss: 0.59186 | train_auc: 0.73239 | train_balanced_accuracy: 0.66658 | train_accuracy: 0.66646 | valid_auc: 0.72105 | valid_balanced_accuracy: 0.65689 | valid_accuracy: 0.65675 |  0:04:30s
epoch 16 | loss: 0.58667 | train_auc: 0.72908 | train_balanced_accuracy: 0.66109 | train_accuracy: 0.6613  | valid_auc: 0.71856 | valid_balanced_accuracy: 0.65957 | valid_accuracy: 0.65974 |  0:04:46s
epoch 17 | loss: 0.58882 | train_auc: 0.73173 | train_balanced_accuracy: 0.66663 | train_accuracy: 0.66677 | valid_auc: 0.71913 | valid_balanced_accuracy: 0.65697 | valid_accuracy: 0.65707 |  0:05:06s
epoch 18 | loss: 0.58861 | train_auc: 0.73424 | train_balanced_accuracy: 0.67146 | train_accuracy: 0.67216 | valid_auc: 0.72092 | valid_balanced_accuracy: 0.65743 | valid_accuracy: 0.65817 |  0:05:23s
epoch 19 | loss: 0.59101 | train_auc: 0.73793 | train_balanced_accuracy: 0.67277 | train_accuracy: 0.67319 | valid_auc: 0.72479 | valid_balanced_accuracy: 0.66093 | valid_accuracy: 0.66132 |  0:05:38s
epoch 20 | loss: 0.59071 | train_auc: 0.73981 | train_balanced_accuracy: 0.67699 | train_accuracy: 0.67775 | valid_auc: 0.72723 | valid_balanced_accuracy: 0.66371 | valid_accuracy: 0.66446 |  0:05:54s
epoch 21 | loss: 0.58697 | train_auc: 0.744   | train_balanced_accuracy: 0.67554 | train_accuracy: 0.67633 | valid_auc: 0.7293  | valid_balanced_accuracy: 0.6602  | valid_accuracy: 0.661   |  0:06:10s
epoch 22 | loss: 0.59035 | train_auc: 0.74167 | train_balanced_accuracy: 0.6787  | train_accuracy: 0.67893 | valid_auc: 0.72793 | valid_balanced_accuracy: 0.66644 | valid_accuracy: 0.66667 |  0:06:28s
epoch 23 | loss: 0.58358 | train_auc: 0.75459 | train_balanced_accuracy: 0.68533 | train_accuracy: 0.68589 | valid_auc: 0.74009 | valid_balanced_accuracy: 0.67307 | valid_accuracy: 0.67359 |  0:06:46s
epoch 24 | loss: 0.58974 | train_auc: 0.75365 | train_balanced_accuracy: 0.68348 | train_accuracy: 0.68408 | valid_auc: 0.73514 | valid_balanced_accuracy: 0.66498 | valid_accuracy: 0.66556 |  0:07:03s
epoch 25 | loss: 0.58095 | train_auc: 0.76434 | train_balanced_accuracy: 0.69731 | train_accuracy: 0.69742 | valid_auc: 0.74673 | valid_balanced_accuracy: 0.68375 | valid_accuracy: 0.68382 |  0:07:20s
epoch 26 | loss: 0.5836  | train_auc: 0.75245 | train_balanced_accuracy: 0.68317 | train_accuracy: 0.68377 | valid_auc: 0.73456 | valid_balanced_accuracy: 0.67001 | valid_accuracy: 0.6706  |  0:07:36s
epoch 27 | loss: 0.58195 | train_auc: 0.76257 | train_balanced_accuracy: 0.69339 | train_accuracy: 0.6938  | valid_auc: 0.74129 | valid_balanced_accuracy: 0.67457 | valid_accuracy: 0.67501 |  0:07:53s
epoch 28 | loss: 0.57962 | train_auc: 0.75975 | train_balanced_accuracy: 0.69343 | train_accuracy: 0.6938  | valid_auc: 0.73877 | valid_balanced_accuracy: 0.67166 | valid_accuracy: 0.67202 |  0:08:09s
epoch 29 | loss: 0.57559 | train_auc: 0.76544 | train_balanced_accuracy: 0.69611 | train_accuracy: 0.69632 | valid_auc: 0.74813 | valid_balanced_accuracy: 0.68224 | valid_accuracy: 0.6824  |  0:08:26s
epoch 30 | loss: 0.58072 | train_auc: 0.76185 | train_balanced_accuracy: 0.69029 | train_accuracy: 0.69066 | valid_auc: 0.74216 | valid_balanced_accuracy: 0.67375 | valid_accuracy: 0.67406 |  0:08:43s
epoch 31 | loss: 0.57676 | train_auc: 0.7718  | train_balanced_accuracy: 0.70147 | train_accuracy: 0.70163 | valid_auc: 0.75303 | valid_balanced_accuracy: 0.68621 | valid_accuracy: 0.68634 |  0:09:01s
epoch 32 | loss: 0.57889 | train_auc: 0.7705  | train_balanced_accuracy: 0.7015  | train_accuracy: 0.70187 | valid_auc: 0.7496  | valid_balanced_accuracy: 0.68427 | valid_accuracy: 0.68461 |  0:09:18s
epoch 33 | loss: 0.5772  | train_auc: 0.77175 | train_balanced_accuracy: 0.69855 | train_accuracy: 0.699   | valid_auc: 0.74933 | valid_balanced_accuracy: 0.68103 | valid_accuracy: 0.68146 |  0:09:35s
epoch 34 | loss: 0.57221 | train_auc: 0.77515 | train_balanced_accuracy: 0.70529 | train_accuracy: 0.70545 | valid_auc: 0.75179 | valid_balanced_accuracy: 0.68606 | valid_accuracy: 0.68618 |  0:09:51s
epoch 35 | loss: 0.57483 | train_auc: 0.77003 | train_balanced_accuracy: 0.69713 | train_accuracy: 0.69762 | valid_auc: 0.74998 | valid_balanced_accuracy: 0.68273 | valid_accuracy: 0.68319 |  0:10:09s
epoch 36 | loss: 0.57745 | train_auc: 0.77242 | train_balanced_accuracy: 0.7016  | train_accuracy: 0.70187 | valid_auc: 0.7461  | valid_balanced_accuracy: 0.67977 | valid_accuracy: 0.68004 |  0:10:27s
epoch 37 | loss: 0.57147 | train_auc: 0.77651 | train_balanced_accuracy: 0.70294 | train_accuracy: 0.70336 | valid_auc: 0.75503 | valid_balanced_accuracy: 0.68482 | valid_accuracy: 0.68524 |  0:10:42s
epoch 38 | loss: 0.56952 | train_auc: 0.77462 | train_balanced_accuracy: 0.70229 | train_accuracy: 0.70226 | valid_auc: 0.74872 | valid_balanced_accuracy: 0.68373 | valid_accuracy: 0.68366 |  0:10:59s
epoch 39 | loss: 0.57565 | train_auc: 0.76827 | train_balanced_accuracy: 0.6968  | train_accuracy: 0.69707 | valid_auc: 0.74556 | valid_balanced_accuracy: 0.68185 | valid_accuracy: 0.68209 |  0:11:16s
epoch 40 | loss: 0.57531 | train_auc: 0.77353 | train_balanced_accuracy: 0.70227 | train_accuracy: 0.70254 | valid_auc: 0.74962 | valid_balanced_accuracy: 0.68874 | valid_accuracy: 0.68901 |  0:11:33s
epoch 41 | loss: 0.57478 | train_auc: 0.76037 | train_balanced_accuracy: 0.69056 | train_accuracy: 0.6903  | valid_auc: 0.73922 | valid_balanced_accuracy: 0.67261 | valid_accuracy: 0.67233 |  0:11:50s
epoch 42 | loss: 0.57169 | train_auc: 0.7753  | train_balanced_accuracy: 0.69998 | train_accuracy: 0.70045 | valid_auc: 0.75436 | valid_balanced_accuracy: 0.68808 | valid_accuracy: 0.68854 |  0:12:06s
epoch 43 | loss: 0.57492 | train_auc: 0.77906 | train_balanced_accuracy: 0.70553 | train_accuracy: 0.70565 | valid_auc: 0.75657 | valid_balanced_accuracy: 0.69257 | valid_accuracy: 0.69263 |  0:12:23s
epoch 44 | loss: 0.57173 | train_auc: 0.78087 | train_balanced_accuracy: 0.7054  | train_accuracy: 0.70569 | valid_auc: 0.75675 | valid_balanced_accuracy: 0.68735 | valid_accuracy: 0.6876  |  0:12:38s
epoch 45 | loss: 0.566   | train_auc: 0.78121 | train_balanced_accuracy: 0.70761 | train_accuracy: 0.70809 | valid_auc: 0.75914 | valid_balanced_accuracy: 0.69124 | valid_accuracy: 0.69169 |  0:12:54s
epoch 46 | loss: 0.56908 | train_auc: 0.78216 | train_balanced_accuracy: 0.70832 | train_accuracy: 0.70868 | valid_auc: 0.75501 | valid_balanced_accuracy: 0.68805 | valid_accuracy: 0.68839 |  0:13:09s
epoch 47 | loss: 0.56659 | train_auc: 0.78513 | train_balanced_accuracy: 0.71119 | train_accuracy: 0.71147 | valid_auc: 0.75715 | valid_balanced_accuracy: 0.69061 | valid_accuracy: 0.6909  |  0:13:25s
epoch 48 | loss: 0.56319 | train_auc: 0.78284 | train_balanced_accuracy: 0.70681 | train_accuracy: 0.70671 | valid_auc: 0.75675 | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68571 |  0:13:42s
epoch 49 | loss: 0.5658  | train_auc: 0.78231 | train_balanced_accuracy: 0.70786 | train_accuracy: 0.7082  | valid_auc: 0.75742 | valid_balanced_accuracy: 0.68853 | valid_accuracy: 0.68886 |  0:14:00s
epoch 50 | loss: 0.56111 | train_auc: 0.78455 | train_balanced_accuracy: 0.70632 | train_accuracy: 0.70643 | valid_auc: 0.75694 | valid_balanced_accuracy: 0.68152 | valid_accuracy: 0.68162 |  0:14:18s
epoch 51 | loss: 0.55917 | train_auc: 0.78466 | train_balanced_accuracy: 0.70766 | train_accuracy: 0.7075  | valid_auc: 0.75878 | valid_balanced_accuracy: 0.68622 | valid_accuracy: 0.68602 |  0:14:35s
epoch 52 | loss: 0.56006 | train_auc: 0.78724 | train_balanced_accuracy: 0.70804 | train_accuracy: 0.70801 | valid_auc: 0.76034 | valid_balanced_accuracy: 0.68543 | valid_accuracy: 0.6854  |  0:14:52s
epoch 53 | loss: 0.56161 | train_auc: 0.78716 | train_balanced_accuracy: 0.71209 | train_accuracy: 0.71218 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69049 | valid_accuracy: 0.69059 |  0:15:09s
epoch 54 | loss: 0.56057 | train_auc: 0.78813 | train_balanced_accuracy: 0.71289 | train_accuracy: 0.713   | valid_auc: 0.76013 | valid_balanced_accuracy: 0.68809 | valid_accuracy: 0.68823 |  0:15:25s
epoch 55 | loss: 0.56522 | train_auc: 0.78658 | train_balanced_accuracy: 0.71201 | train_accuracy: 0.71214 | valid_auc: 0.75872 | valid_balanced_accuracy: 0.69203 | valid_accuracy: 0.69216 |  0:15:42s
epoch 56 | loss: 0.5605  | train_auc: 0.78742 | train_balanced_accuracy: 0.71179 | train_accuracy: 0.71202 | valid_auc: 0.76272 | valid_balanced_accuracy: 0.69606 | valid_accuracy: 0.69625 |  0:15:59s
epoch 57 | loss: 0.56166 | train_auc: 0.78416 | train_balanced_accuracy: 0.70664 | train_accuracy: 0.70671 | valid_auc: 0.75414 | valid_balanced_accuracy: 0.68425 | valid_accuracy: 0.68429 |  0:16:15s
epoch 58 | loss: 0.55822 | train_auc: 0.78711 | train_balanced_accuracy: 0.71204 | train_accuracy: 0.71237 | valid_auc: 0.75554 | valid_balanced_accuracy: 0.68352 | valid_accuracy: 0.68382 |  0:16:34s
epoch 59 | loss: 0.55847 | train_auc: 0.78839 | train_balanced_accuracy: 0.71012 | train_accuracy: 0.71029 | valid_auc: 0.75875 | valid_balanced_accuracy: 0.69374 | valid_accuracy: 0.69389 |  0:16:50s
epoch 60 | loss: 0.55935 | train_auc: 0.79301 | train_balanced_accuracy: 0.71516 | train_accuracy: 0.71505 | valid_auc: 0.75935 | valid_balanced_accuracy: 0.68406 | valid_accuracy: 0.68398 |  0:17:07s
epoch 61 | loss: 0.55507 | train_auc: 0.79314 | train_balanced_accuracy: 0.71214 | train_accuracy: 0.71226 | valid_auc: 0.76129 | valid_balanced_accuracy: 0.68434 | valid_accuracy: 0.68445 |  0:17:23s
epoch 62 | loss: 0.55361 | train_auc: 0.78919 | train_balanced_accuracy: 0.71258 | train_accuracy: 0.71273 | valid_auc: 0.7589  | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68665 |  0:17:42s
epoch 63 | loss: 0.5584  | train_auc: 0.78765 | train_balanced_accuracy: 0.7126  | train_accuracy: 0.71241 | valid_auc: 0.75595 | valid_balanced_accuracy: 0.68217 | valid_accuracy: 0.68193 |  0:17:59s
epoch 64 | loss: 0.55961 | train_auc: 0.7955  | train_balanced_accuracy: 0.71607 | train_accuracy: 0.71596 | valid_auc: 0.75698 | valid_balanced_accuracy: 0.68408 | valid_accuracy: 0.68398 |  0:18:17s
epoch 65 | loss: 0.5516  | train_auc: 0.78582 | train_balanced_accuracy: 0.70844 | train_accuracy: 0.70887 | valid_auc: 0.753   | valid_balanced_accuracy: 0.68452 | valid_accuracy: 0.68492 |  0:18:34s
epoch 66 | loss: 0.55216 | train_auc: 0.79677 | train_balanced_accuracy: 0.71641 | train_accuracy: 0.71647 | valid_auc: 0.75839 | valid_balanced_accuracy: 0.68865 | valid_accuracy: 0.6887  |  0:18:51s
epoch 67 | loss: 0.55408 | train_auc: 0.79621 | train_balanced_accuracy: 0.71614 | train_accuracy: 0.71639 | valid_auc: 0.75706 | valid_balanced_accuracy: 0.68312 | valid_accuracy: 0.68335 |  0:19:07s
epoch 68 | loss: 0.55551 | train_auc: 0.79816 | train_balanced_accuracy: 0.71803 | train_accuracy: 0.71843 | valid_auc: 0.76458 | valid_balanced_accuracy: 0.69223 | valid_accuracy: 0.69263 |  0:19:25s
epoch 69 | loss: 0.55158 | train_auc: 0.7908  | train_balanced_accuracy: 0.70792 | train_accuracy: 0.70852 | valid_auc: 0.7511  | valid_balanced_accuracy: 0.68083 | valid_accuracy: 0.68146 |  0:19:42s
epoch 70 | loss: 0.54995 | train_auc: 0.7969  | train_balanced_accuracy: 0.71928 | train_accuracy: 0.71942 | valid_auc: 0.76177 | valid_balanced_accuracy: 0.69613 | valid_accuracy: 0.69625 |  0:20:00s
epoch 71 | loss: 0.5526  | train_auc: 0.79645 | train_balanced_accuracy: 0.71683 | train_accuracy: 0.71694 | valid_auc: 0.75687 | valid_balanced_accuracy: 0.68063 | valid_accuracy: 0.68067 |  0:20:17s
epoch 72 | loss: 0.55199 | train_auc: 0.79627 | train_balanced_accuracy: 0.71614 | train_accuracy: 0.71662 | valid_auc: 0.75782 | valid_balanced_accuracy: 0.68678 | valid_accuracy: 0.68728 |  0:20:33s
epoch 73 | loss: 0.54724 | train_auc: 0.79964 | train_balanced_accuracy: 0.71849 | train_accuracy: 0.71851 | valid_auc: 0.7611  | valid_balanced_accuracy: 0.69026 | valid_accuracy: 0.69027 |  0:20:50s
epoch 74 | loss: 0.54883 | train_auc: 0.79835 | train_balanced_accuracy: 0.71938 | train_accuracy: 0.71985 | valid_auc: 0.75973 | valid_balanced_accuracy: 0.68673 | valid_accuracy: 0.68713 |  0:21:07s
epoch 75 | loss: 0.55261 | train_auc: 0.80136 | train_balanced_accuracy: 0.72227 | train_accuracy: 0.72268 | valid_auc: 0.76319 | valid_balanced_accuracy: 0.6902  | valid_accuracy: 0.69059 |  0:21:23s
epoch 76 | loss: 0.55486 | train_auc: 0.8035  | train_balanced_accuracy: 0.72145 | train_accuracy: 0.72139 | valid_auc: 0.76263 | valid_balanced_accuracy: 0.6896  | valid_accuracy: 0.68949 |  0:21:38s

Early stopping occurred at epoch 76 with best_epoch = 56 and best_valid_accuracy = 0.69625
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 52/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=21.8min
[CV 2/5; 52/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70019 | train_auc: 0.56551 | train_balanced_accuracy: 0.53562 | train_accuracy: 0.53583 | valid_auc: 0.56798 | valid_balanced_accuracy: 0.54165 | valid_accuracy: 0.54186 |  0:00:16s
epoch 1  | loss: 0.64397 | train_auc: 0.64252 | train_balanced_accuracy: 0.6015  | train_accuracy: 0.60126 | valid_auc: 0.63995 | valid_balanced_accuracy: 0.60067 | valid_accuracy: 0.60041 |  0:00:34s
epoch 2  | loss: 0.62352 | train_auc: 0.64262 | train_balanced_accuracy: 0.50167 | train_accuracy: 0.50521 | valid_auc: 0.6468  | valid_balanced_accuracy: 0.50064 | valid_accuracy: 0.50425 |  0:00:51s
epoch 3  | loss: 0.61951 | train_auc: 0.65611 | train_balanced_accuracy: 0.50272 | train_accuracy: 0.50616 | valid_auc: 0.64856 | valid_balanced_accuracy: 0.5028  | valid_accuracy: 0.5063  |  0:01:07s
epoch 4  | loss: 0.60661 | train_auc: 0.68111 | train_balanced_accuracy: 0.54694 | train_accuracy: 0.54995 | valid_auc: 0.6756  | valid_balanced_accuracy: 0.54938 | valid_accuracy: 0.55241 |  0:01:24s
epoch 5  | loss: 0.6073  | train_auc: 0.70336 | train_balanced_accuracy: 0.58061 | train_accuracy: 0.58308 | valid_auc: 0.69908 | valid_balanced_accuracy: 0.58456 | valid_accuracy: 0.58703 |  0:01:39s
epoch 6  | loss: 0.60454 | train_auc: 0.71207 | train_balanced_accuracy: 0.615   | train_accuracy: 0.61696 | valid_auc: 0.71182 | valid_balanced_accuracy: 0.61651 | valid_accuracy: 0.61851 |  0:01:56s
epoch 7  | loss: 0.6015  | train_auc: 0.71438 | train_balanced_accuracy: 0.60644 | train_accuracy: 0.60862 | valid_auc: 0.71042 | valid_balanced_accuracy: 0.61098 | valid_accuracy: 0.61316 |  0:02:14s
epoch 8  | loss: 0.596   | train_auc: 0.71431 | train_balanced_accuracy: 0.63491 | train_accuracy: 0.63659 | valid_auc: 0.71067 | valid_balanced_accuracy: 0.63961 | valid_accuracy: 0.64133 |  0:02:29s
epoch 9  | loss: 0.6004  | train_auc: 0.71892 | train_balanced_accuracy: 0.65364 | train_accuracy: 0.65493 | valid_auc: 0.71526 | valid_balanced_accuracy: 0.65593 | valid_accuracy: 0.65722 |  0:02:47s
epoch 10 | loss: 0.59073 | train_auc: 0.72136 | train_balanced_accuracy: 0.66353 | train_accuracy: 0.66445 | valid_auc: 0.71656 | valid_balanced_accuracy: 0.66718 | valid_accuracy: 0.66808 |  0:03:02s
epoch 11 | loss: 0.59409 | train_auc: 0.72575 | train_balanced_accuracy: 0.66298 | train_accuracy: 0.66386 | valid_auc: 0.71905 | valid_balanced_accuracy: 0.66297 | valid_accuracy: 0.66383 |  0:03:20s
epoch 12 | loss: 0.59312 | train_auc: 0.72385 | train_balanced_accuracy: 0.65892 | train_accuracy: 0.65993 | valid_auc: 0.71584 | valid_balanced_accuracy: 0.66237 | valid_accuracy: 0.66336 |  0:03:36s
epoch 13 | loss: 0.58984 | train_auc: 0.72814 | train_balanced_accuracy: 0.66421 | train_accuracy: 0.66516 | valid_auc: 0.72244 | valid_balanced_accuracy: 0.66496 | valid_accuracy: 0.66588 |  0:03:54s
epoch 14 | loss: 0.59459 | train_auc: 0.73303 | train_balanced_accuracy: 0.66911 | train_accuracy: 0.67    | valid_auc: 0.72828 | valid_balanced_accuracy: 0.66185 | valid_accuracy: 0.66273 |  0:04:11s
epoch 15 | loss: 0.59136 | train_auc: 0.73634 | train_balanced_accuracy: 0.67149 | train_accuracy: 0.67189 | valid_auc: 0.72829 | valid_balanced_accuracy: 0.66326 | valid_accuracy: 0.66368 |  0:04:28s
epoch 16 | loss: 0.58698 | train_auc: 0.74573 | train_balanced_accuracy: 0.67822 | train_accuracy: 0.67865 | valid_auc: 0.73444 | valid_balanced_accuracy: 0.66846 | valid_accuracy: 0.66887 |  0:04:42s
epoch 17 | loss: 0.58672 | train_auc: 0.73891 | train_balanced_accuracy: 0.67198 | train_accuracy: 0.67232 | valid_auc: 0.73094 | valid_balanced_accuracy: 0.66619 | valid_accuracy: 0.66651 |  0:04:58s
epoch 18 | loss: 0.586   | train_auc: 0.74428 | train_balanced_accuracy: 0.67779 | train_accuracy: 0.6783  | valid_auc: 0.73354 | valid_balanced_accuracy: 0.66882 | valid_accuracy: 0.66934 |  0:05:17s
epoch 19 | loss: 0.58328 | train_auc: 0.75023 | train_balanced_accuracy: 0.68336 | train_accuracy: 0.68377 | valid_auc: 0.73947 | valid_balanced_accuracy: 0.67807 | valid_accuracy: 0.67847 |  0:05:32s
epoch 20 | loss: 0.5844  | train_auc: 0.74679 | train_balanced_accuracy: 0.68274 | train_accuracy: 0.68342 | valid_auc: 0.73365 | valid_balanced_accuracy: 0.67607 | valid_accuracy: 0.67674 |  0:05:48s
epoch 21 | loss: 0.58367 | train_auc: 0.75188 | train_balanced_accuracy: 0.68719 | train_accuracy: 0.6879  | valid_auc: 0.73838 | valid_balanced_accuracy: 0.67508 | valid_accuracy: 0.67579 |  0:06:04s
epoch 22 | loss: 0.59152 | train_auc: 0.75738 | train_balanced_accuracy: 0.68838 | train_accuracy: 0.68908 | valid_auc: 0.74601 | valid_balanced_accuracy: 0.6823  | valid_accuracy: 0.68303 |  0:06:21s
epoch 23 | loss: 0.58647 | train_auc: 0.75424 | train_balanced_accuracy: 0.68616 | train_accuracy: 0.68684 | valid_auc: 0.74172 | valid_balanced_accuracy: 0.67612 | valid_accuracy: 0.67674 |  0:06:38s
epoch 24 | loss: 0.58898 | train_auc: 0.7591  | train_balanced_accuracy: 0.69094 | train_accuracy: 0.69144 | valid_auc: 0.74539 | valid_balanced_accuracy: 0.67937 | valid_accuracy: 0.67989 |  0:06:56s
epoch 25 | loss: 0.57982 | train_auc: 0.76089 | train_balanced_accuracy: 0.69329 | train_accuracy: 0.69325 | valid_auc: 0.7495  | valid_balanced_accuracy: 0.68563 | valid_accuracy: 0.68555 |  0:07:12s
epoch 26 | loss: 0.58252 | train_auc: 0.76346 | train_balanced_accuracy: 0.69704 | train_accuracy: 0.6975  | valid_auc: 0.74844 | valid_balanced_accuracy: 0.68525 | valid_accuracy: 0.68571 |  0:07:29s
epoch 27 | loss: 0.58234 | train_auc: 0.76501 | train_balanced_accuracy: 0.69828 | train_accuracy: 0.6986  | valid_auc: 0.75081 | valid_balanced_accuracy: 0.68679 | valid_accuracy: 0.68713 |  0:07:46s
epoch 28 | loss: 0.57931 | train_auc: 0.76358 | train_balanced_accuracy: 0.69474 | train_accuracy: 0.6951  | valid_auc: 0.74461 | valid_balanced_accuracy: 0.68174 | valid_accuracy: 0.68209 |  0:08:03s
epoch 29 | loss: 0.57995 | train_auc: 0.76716 | train_balanced_accuracy: 0.69721 | train_accuracy: 0.69727 | valid_auc: 0.75329 | valid_balanced_accuracy: 0.68298 | valid_accuracy: 0.68303 |  0:08:20s
epoch 30 | loss: 0.57827 | train_auc: 0.7666  | train_balanced_accuracy: 0.69854 | train_accuracy: 0.69872 | valid_auc: 0.74948 | valid_balanced_accuracy: 0.6824  | valid_accuracy: 0.68256 |  0:08:35s
epoch 31 | loss: 0.5811  | train_auc: 0.76577 | train_balanced_accuracy: 0.69932 | train_accuracy: 0.69963 | valid_auc: 0.74571 | valid_balanced_accuracy: 0.68021 | valid_accuracy: 0.68052 |  0:08:50s
epoch 32 | loss: 0.58595 | train_auc: 0.76273 | train_balanced_accuracy: 0.69433 | train_accuracy: 0.69439 | valid_auc: 0.74981 | valid_balanced_accuracy: 0.68487 | valid_accuracy: 0.68492 |  0:09:06s
epoch 33 | loss: 0.58431 | train_auc: 0.7663  | train_balanced_accuracy: 0.69651 | train_accuracy: 0.69727 | valid_auc: 0.7498  | valid_balanced_accuracy: 0.68257 | valid_accuracy: 0.68335 |  0:09:22s
epoch 34 | loss: 0.57884 | train_auc: 0.76685 | train_balanced_accuracy: 0.69878 | train_accuracy: 0.69927 | valid_auc: 0.75145 | valid_balanced_accuracy: 0.68619 | valid_accuracy: 0.68665 |  0:09:38s
epoch 35 | loss: 0.57885 | train_auc: 0.76844 | train_balanced_accuracy: 0.6997  | train_accuracy: 0.70026 | valid_auc: 0.74753 | valid_balanced_accuracy: 0.68515 | valid_accuracy: 0.68571 |  0:09:54s
epoch 36 | loss: 0.57712 | train_auc: 0.7694  | train_balanced_accuracy: 0.69857 | train_accuracy: 0.69888 | valid_auc: 0.75241 | valid_balanced_accuracy: 0.68525 | valid_accuracy: 0.68555 |  0:10:11s
epoch 37 | loss: 0.58    | train_auc: 0.76932 | train_balanced_accuracy: 0.6991  | train_accuracy: 0.69935 | valid_auc: 0.74883 | valid_balanced_accuracy: 0.68234 | valid_accuracy: 0.68256 |  0:10:28s
epoch 38 | loss: 0.5742  | train_auc: 0.76892 | train_balanced_accuracy: 0.69854 | train_accuracy: 0.69845 | valid_auc: 0.75336 | valid_balanced_accuracy: 0.68595 | valid_accuracy: 0.68587 |  0:10:46s
epoch 39 | loss: 0.57547 | train_auc: 0.77092 | train_balanced_accuracy: 0.70541 | train_accuracy: 0.70572 | valid_auc: 0.75195 | valid_balanced_accuracy: 0.69109 | valid_accuracy: 0.69138 |  0:11:05s
epoch 40 | loss: 0.57768 | train_auc: 0.7743  | train_balanced_accuracy: 0.70671 | train_accuracy: 0.70714 | valid_auc: 0.75177 | valid_balanced_accuracy: 0.69061 | valid_accuracy: 0.69106 |  0:11:21s
epoch 41 | loss: 0.57409 | train_auc: 0.7663  | train_balanced_accuracy: 0.69573 | train_accuracy: 0.69565 | valid_auc: 0.74974 | valid_balanced_accuracy: 0.68294 | valid_accuracy: 0.68288 |  0:11:37s
epoch 42 | loss: 0.57029 | train_auc: 0.77354 | train_balanced_accuracy: 0.70387 | train_accuracy: 0.70439 | valid_auc: 0.7543  | valid_balanced_accuracy: 0.68977 | valid_accuracy: 0.69027 |  0:11:53s
epoch 43 | loss: 0.57649 | train_auc: 0.77567 | train_balanced_accuracy: 0.70476 | train_accuracy: 0.70482 | valid_auc: 0.7546  | valid_balanced_accuracy: 0.68676 | valid_accuracy: 0.68681 |  0:12:11s
epoch 44 | loss: 0.57062 | train_auc: 0.77528 | train_balanced_accuracy: 0.70712 | train_accuracy: 0.70757 | valid_auc: 0.75411 | valid_balanced_accuracy: 0.69629 | valid_accuracy: 0.69673 |  0:12:28s
epoch 45 | loss: 0.57014 | train_auc: 0.77108 | train_balanced_accuracy: 0.70074 | train_accuracy: 0.7014  | valid_auc: 0.74495 | valid_balanced_accuracy: 0.68588 | valid_accuracy: 0.6865  |  0:12:44s
epoch 46 | loss: 0.57275 | train_auc: 0.77296 | train_balanced_accuracy: 0.70417 | train_accuracy: 0.70431 | valid_auc: 0.7493  | valid_balanced_accuracy: 0.68903 | valid_accuracy: 0.68917 |  0:13:01s
epoch 47 | loss: 0.57172 | train_auc: 0.77501 | train_balanced_accuracy: 0.70425 | train_accuracy: 0.70474 | valid_auc: 0.75252 | valid_balanced_accuracy: 0.68838 | valid_accuracy: 0.68886 |  0:13:18s
epoch 48 | loss: 0.56871 | train_auc: 0.77567 | train_balanced_accuracy: 0.70659 | train_accuracy: 0.70671 | valid_auc: 0.74913 | valid_balanced_accuracy: 0.68976 | valid_accuracy: 0.6898  |  0:13:35s
epoch 49 | loss: 0.56943 | train_auc: 0.77718 | train_balanced_accuracy: 0.70767 | train_accuracy: 0.70813 | valid_auc: 0.75264 | valid_balanced_accuracy: 0.68948 | valid_accuracy: 0.68996 |  0:13:52s
epoch 50 | loss: 0.56988 | train_auc: 0.77934 | train_balanced_accuracy: 0.70774 | train_accuracy: 0.70801 | valid_auc: 0.75841 | valid_balanced_accuracy: 0.69252 | valid_accuracy: 0.69279 |  0:14:07s
epoch 51 | loss: 0.56824 | train_auc: 0.77813 | train_balanced_accuracy: 0.7077  | train_accuracy: 0.70797 | valid_auc: 0.75812 | valid_balanced_accuracy: 0.69708 | valid_accuracy: 0.69736 |  0:14:26s
epoch 52 | loss: 0.56696 | train_auc: 0.78193 | train_balanced_accuracy: 0.71238 | train_accuracy: 0.71249 | valid_auc: 0.7591  | valid_balanced_accuracy: 0.69035 | valid_accuracy: 0.69043 |  0:14:45s
epoch 53 | loss: 0.5643  | train_auc: 0.7803  | train_balanced_accuracy: 0.70796 | train_accuracy: 0.70824 | valid_auc: 0.75496 | valid_balanced_accuracy: 0.69313 | valid_accuracy: 0.69342 |  0:15:03s
epoch 54 | loss: 0.56965 | train_auc: 0.78033 | train_balanced_accuracy: 0.70872 | train_accuracy: 0.70891 | valid_auc: 0.75648 | valid_balanced_accuracy: 0.69057 | valid_accuracy: 0.69075 |  0:15:20s
epoch 55 | loss: 0.57229 | train_auc: 0.78028 | train_balanced_accuracy: 0.70844 | train_accuracy: 0.70895 | valid_auc: 0.75385 | valid_balanced_accuracy: 0.69165 | valid_accuracy: 0.69216 |  0:15:38s
epoch 56 | loss: 0.5686  | train_auc: 0.7759  | train_balanced_accuracy: 0.70412 | train_accuracy: 0.70431 | valid_auc: 0.75197 | valid_balanced_accuracy: 0.69419 | valid_accuracy: 0.69437 |  0:15:54s
epoch 57 | loss: 0.5685  | train_auc: 0.78475 | train_balanced_accuracy: 0.71112 | train_accuracy: 0.71119 | valid_auc: 0.75733 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69263 |  0:16:13s
epoch 58 | loss: 0.56326 | train_auc: 0.78283 | train_balanced_accuracy: 0.71158 | train_accuracy: 0.71175 | valid_auc: 0.75537 | valid_balanced_accuracy: 0.6961  | valid_accuracy: 0.69625 |  0:16:31s
epoch 59 | loss: 0.56346 | train_auc: 0.78274 | train_balanced_accuracy: 0.71238 | train_accuracy: 0.71281 | valid_auc: 0.75624 | valid_balanced_accuracy: 0.69285 | valid_accuracy: 0.69326 |  0:16:47s
epoch 60 | loss: 0.56607 | train_auc: 0.78017 | train_balanced_accuracy: 0.70794 | train_accuracy: 0.70824 | valid_auc: 0.7557  | valid_balanced_accuracy: 0.69234 | valid_accuracy: 0.69263 |  0:17:04s
epoch 61 | loss: 0.56572 | train_auc: 0.78312 | train_balanced_accuracy: 0.70884 | train_accuracy: 0.70915 | valid_auc: 0.75998 | valid_balanced_accuracy: 0.69546 | valid_accuracy: 0.69578 |  0:17:21s
epoch 62 | loss: 0.5644  | train_auc: 0.78188 | train_balanced_accuracy: 0.71085 | train_accuracy: 0.71096 | valid_auc: 0.75345 | valid_balanced_accuracy: 0.69082 | valid_accuracy: 0.6909  |  0:17:38s
epoch 63 | loss: 0.56734 | train_auc: 0.78073 | train_balanced_accuracy: 0.71041 | train_accuracy: 0.71053 | valid_auc: 0.75371 | valid_balanced_accuracy: 0.69004 | valid_accuracy: 0.69012 |  0:17:53s
epoch 64 | loss: 0.56514 | train_auc: 0.78444 | train_balanced_accuracy: 0.7098  | train_accuracy: 0.7099  | valid_auc: 0.75374 | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68917 |  0:18:11s
epoch 65 | loss: 0.55873 | train_auc: 0.78494 | train_balanced_accuracy: 0.71475 | train_accuracy: 0.71501 | valid_auc: 0.75653 | valid_balanced_accuracy: 0.69335 | valid_accuracy: 0.69358 |  0:18:28s
epoch 66 | loss: 0.56147 | train_auc: 0.78609 | train_balanced_accuracy: 0.71416 | train_accuracy: 0.7143  | valid_auc: 0.75798 | valid_balanced_accuracy: 0.69582 | valid_accuracy: 0.69594 |  0:18:46s
epoch 67 | loss: 0.55798 | train_auc: 0.78244 | train_balanced_accuracy: 0.71162 | train_accuracy: 0.7121  | valid_auc: 0.75788 | valid_balanced_accuracy: 0.69262 | valid_accuracy: 0.69311 |  0:19:04s
epoch 68 | loss: 0.56427 | train_auc: 0.78661 | train_balanced_accuracy: 0.71528 | train_accuracy: 0.7156  | valid_auc: 0.75781 | valid_balanced_accuracy: 0.69531 | valid_accuracy: 0.69562 |  0:19:20s
epoch 69 | loss: 0.56133 | train_auc: 0.78612 | train_balanced_accuracy: 0.71521 | train_accuracy: 0.71548 | valid_auc: 0.75815 | valid_balanced_accuracy: 0.69409 | valid_accuracy: 0.69437 |  0:19:39s
epoch 70 | loss: 0.56145 | train_auc: 0.78749 | train_balanced_accuracy: 0.71643 | train_accuracy: 0.71674 | valid_auc: 0.75831 | valid_balanced_accuracy: 0.69579 | valid_accuracy: 0.6961  |  0:19:58s
epoch 71 | loss: 0.56237 | train_auc: 0.78459 | train_balanced_accuracy: 0.71146 | train_accuracy: 0.71147 | valid_auc: 0.75658 | valid_balanced_accuracy: 0.69325 | valid_accuracy: 0.69326 |  0:20:14s

Early stopping occurred at epoch 71 with best_epoch = 51 and best_valid_accuracy = 0.69736
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 52/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=20.4min
[CV 3/5; 52/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7069  | train_auc: 0.58446 | train_balanced_accuracy: 0.52575 | train_accuracy: 0.52333 | valid_auc: 0.58826 | valid_balanced_accuracy: 0.52796 | valid_accuracy: 0.5255  |  0:00:15s
epoch 1  | loss: 0.6612  | train_auc: 0.64187 | train_balanced_accuracy: 0.54652 | train_accuracy: 0.54946 | valid_auc: 0.64838 | valid_balanced_accuracy: 0.55056 | valid_accuracy: 0.55351 |  0:00:31s
epoch 2  | loss: 0.64547 | train_auc: 0.66249 | train_balanced_accuracy: 0.62369 | train_accuracy: 0.625   | valid_auc: 0.66546 | valid_balanced_accuracy: 0.62414 | valid_accuracy: 0.62543 |  0:00:47s
epoch 3  | loss: 0.63474 | train_auc: 0.68319 | train_balanced_accuracy: 0.62354 | train_accuracy: 0.62453 | valid_auc: 0.68288 | valid_balanced_accuracy: 0.62432 | valid_accuracy: 0.62528 |  0:01:03s
epoch 4  | loss: 0.62549 | train_auc: 0.7015  | train_balanced_accuracy: 0.63745 | train_accuracy: 0.63881 | valid_auc: 0.70286 | valid_balanced_accuracy: 0.64121 | valid_accuracy: 0.64259 |  0:01:19s
epoch 5  | loss: 0.62079 | train_auc: 0.70448 | train_balanced_accuracy: 0.65233 | train_accuracy: 0.65341 | valid_auc: 0.70339 | valid_balanced_accuracy: 0.65537 | valid_accuracy: 0.65644 |  0:01:35s
epoch 6  | loss: 0.61804 | train_auc: 0.71341 | train_balanced_accuracy: 0.65703 | train_accuracy: 0.65805 | valid_auc: 0.71035 | valid_balanced_accuracy: 0.65638 | valid_accuracy: 0.65738 |  0:01:51s
epoch 7  | loss: 0.61781 | train_auc: 0.7102  | train_balanced_accuracy: 0.65921 | train_accuracy: 0.66006 | valid_auc: 0.70648 | valid_balanced_accuracy: 0.65879 | valid_accuracy: 0.65958 |  0:02:07s
epoch 8  | loss: 0.61364 | train_auc: 0.71969 | train_balanced_accuracy: 0.65992 | train_accuracy: 0.66116 | valid_auc: 0.71542 | valid_balanced_accuracy: 0.65822 | valid_accuracy: 0.65943 |  0:02:25s
epoch 9  | loss: 0.61242 | train_auc: 0.71934 | train_balanced_accuracy: 0.66251 | train_accuracy: 0.66332 | valid_auc: 0.71127 | valid_balanced_accuracy: 0.66098 | valid_accuracy: 0.66179 |  0:02:42s
epoch 10 | loss: 0.60392 | train_auc: 0.7179  | train_balanced_accuracy: 0.66332 | train_accuracy: 0.66415 | valid_auc: 0.71329 | valid_balanced_accuracy: 0.65984 | valid_accuracy: 0.66069 |  0:02:58s
epoch 11 | loss: 0.60758 | train_auc: 0.72236 | train_balanced_accuracy: 0.66426 | train_accuracy: 0.66501 | valid_auc: 0.71509 | valid_balanced_accuracy: 0.66245 | valid_accuracy: 0.6632  |  0:03:16s
epoch 12 | loss: 0.60537 | train_auc: 0.72406 | train_balanced_accuracy: 0.66642 | train_accuracy: 0.66718 | valid_auc: 0.71631 | valid_balanced_accuracy: 0.66797 | valid_accuracy: 0.66871 |  0:03:32s
epoch 13 | loss: 0.60684 | train_auc: 0.72306 | train_balanced_accuracy: 0.66553 | train_accuracy: 0.66623 | valid_auc: 0.71483 | valid_balanced_accuracy: 0.66423 | valid_accuracy: 0.66494 |  0:03:50s
epoch 14 | loss: 0.60429 | train_auc: 0.72387 | train_balanced_accuracy: 0.66959 | train_accuracy: 0.67025 | valid_auc: 0.72147 | valid_balanced_accuracy: 0.66742 | valid_accuracy: 0.66808 |  0:04:08s
epoch 15 | loss: 0.60469 | train_auc: 0.72637 | train_balanced_accuracy: 0.66884 | train_accuracy: 0.66938 | valid_auc: 0.7246  | valid_balanced_accuracy: 0.66628 | valid_accuracy: 0.66682 |  0:04:24s
epoch 16 | loss: 0.60188 | train_auc: 0.72732 | train_balanced_accuracy: 0.66713 | train_accuracy: 0.66753 | valid_auc: 0.7215  | valid_balanced_accuracy: 0.66412 | valid_accuracy: 0.66446 |  0:04:40s
epoch 17 | loss: 0.59625 | train_auc: 0.72818 | train_balanced_accuracy: 0.66471 | train_accuracy: 0.66509 | valid_auc: 0.72153 | valid_balanced_accuracy: 0.66201 | valid_accuracy: 0.66242 |  0:04:58s
epoch 18 | loss: 0.60782 | train_auc: 0.72729 | train_balanced_accuracy: 0.66462 | train_accuracy: 0.66541 | valid_auc: 0.71886 | valid_balanced_accuracy: 0.65834 | valid_accuracy: 0.65911 |  0:05:16s
epoch 19 | loss: 0.6016  | train_auc: 0.73077 | train_balanced_accuracy: 0.66959 | train_accuracy: 0.67025 | valid_auc: 0.72381 | valid_balanced_accuracy: 0.66664 | valid_accuracy: 0.6673  |  0:05:32s
epoch 20 | loss: 0.5996  | train_auc: 0.73395 | train_balanced_accuracy: 0.67205 | train_accuracy: 0.67257 | valid_auc: 0.7242  | valid_balanced_accuracy: 0.6663  | valid_accuracy: 0.66682 |  0:05:49s
epoch 21 | loss: 0.59074 | train_auc: 0.73852 | train_balanced_accuracy: 0.67185 | train_accuracy: 0.67241 | valid_auc: 0.72914 | valid_balanced_accuracy: 0.66769 | valid_accuracy: 0.66824 |  0:06:05s
epoch 22 | loss: 0.59991 | train_auc: 0.73559 | train_balanced_accuracy: 0.67299 | train_accuracy: 0.67343 | valid_auc: 0.72786 | valid_balanced_accuracy: 0.66402 | valid_accuracy: 0.66446 |  0:06:23s
epoch 23 | loss: 0.59541 | train_auc: 0.74318 | train_balanced_accuracy: 0.68173 | train_accuracy: 0.68221 | valid_auc: 0.7377  | valid_balanced_accuracy: 0.67944 | valid_accuracy: 0.67989 |  0:06:39s
epoch 24 | loss: 0.5953  | train_auc: 0.74094 | train_balanced_accuracy: 0.67962 | train_accuracy: 0.68008 | valid_auc: 0.73358 | valid_balanced_accuracy: 0.6695  | valid_accuracy: 0.66997 |  0:06:56s
epoch 25 | loss: 0.59386 | train_auc: 0.74787 | train_balanced_accuracy: 0.68389 | train_accuracy: 0.68429 | valid_auc: 0.74089 | valid_balanced_accuracy: 0.67932 | valid_accuracy: 0.67973 |  0:07:10s
epoch 26 | loss: 0.59163 | train_auc: 0.75307 | train_balanced_accuracy: 0.68579 | train_accuracy: 0.68646 | valid_auc: 0.74548 | valid_balanced_accuracy: 0.6833  | valid_accuracy: 0.68398 |  0:07:27s
epoch 27 | loss: 0.59224 | train_auc: 0.75426 | train_balanced_accuracy: 0.68807 | train_accuracy: 0.68831 | valid_auc: 0.74612 | valid_balanced_accuracy: 0.68264 | valid_accuracy: 0.68288 |  0:07:44s
epoch 28 | loss: 0.5896  | train_auc: 0.75396 | train_balanced_accuracy: 0.68909 | train_accuracy: 0.68941 | valid_auc: 0.74394 | valid_balanced_accuracy: 0.68192 | valid_accuracy: 0.68225 |  0:08:01s
epoch 29 | loss: 0.58846 | train_auc: 0.75544 | train_balanced_accuracy: 0.6889  | train_accuracy: 0.68905 | valid_auc: 0.74529 | valid_balanced_accuracy: 0.68635 | valid_accuracy: 0.6865  |  0:08:18s
epoch 30 | loss: 0.58788 | train_auc: 0.75734 | train_balanced_accuracy: 0.69082 | train_accuracy: 0.69118 | valid_auc: 0.74557 | valid_balanced_accuracy: 0.68224 | valid_accuracy: 0.68256 |  0:08:34s
epoch 31 | loss: 0.5916  | train_auc: 0.7544  | train_balanced_accuracy: 0.68999 | train_accuracy: 0.69035 | valid_auc: 0.74713 | valid_balanced_accuracy: 0.68297 | valid_accuracy: 0.68335 |  0:08:51s
epoch 32 | loss: 0.58357 | train_auc: 0.75199 | train_balanced_accuracy: 0.68668 | train_accuracy: 0.68697 | valid_auc: 0.74745 | valid_balanced_accuracy: 0.67879 | valid_accuracy: 0.6791  |  0:09:07s
epoch 33 | loss: 0.58831 | train_auc: 0.75289 | train_balanced_accuracy: 0.68743 | train_accuracy: 0.68783 | valid_auc: 0.74898 | valid_balanced_accuracy: 0.68436 | valid_accuracy: 0.68477 |  0:09:23s
epoch 34 | loss: 0.58608 | train_auc: 0.75729 | train_balanced_accuracy: 0.68622 | train_accuracy: 0.68665 | valid_auc: 0.74919 | valid_balanced_accuracy: 0.68338 | valid_accuracy: 0.68382 |  0:09:38s
epoch 35 | loss: 0.58595 | train_auc: 0.75584 | train_balanced_accuracy: 0.68781 | train_accuracy: 0.68811 | valid_auc: 0.74683 | valid_balanced_accuracy: 0.68621 | valid_accuracy: 0.6865  |  0:09:55s
epoch 36 | loss: 0.58966 | train_auc: 0.75665 | train_balanced_accuracy: 0.68744 | train_accuracy: 0.68768 | valid_auc: 0.74684 | valid_balanced_accuracy: 0.68009 | valid_accuracy: 0.68036 |  0:10:12s
epoch 37 | loss: 0.58418 | train_auc: 0.7578  | train_balanced_accuracy: 0.68757 | train_accuracy: 0.68815 | valid_auc: 0.74835 | valid_balanced_accuracy: 0.68149 | valid_accuracy: 0.68209 |  0:10:28s
epoch 38 | loss: 0.58334 | train_auc: 0.75918 | train_balanced_accuracy: 0.68776 | train_accuracy: 0.68787 | valid_auc: 0.74708 | valid_balanced_accuracy: 0.67659 | valid_accuracy: 0.67674 |  0:10:45s
epoch 39 | loss: 0.57972 | train_auc: 0.72252 | train_balanced_accuracy: 0.67112 | train_accuracy: 0.67115 | valid_auc: 0.72223 | valid_balanced_accuracy: 0.66851 | valid_accuracy: 0.66856 |  0:11:00s
epoch 40 | loss: 0.58399 | train_auc: 0.72058 | train_balanced_accuracy: 0.66723 | train_accuracy: 0.66741 | valid_auc: 0.72185 | valid_balanced_accuracy: 0.66727 | valid_accuracy: 0.66745 |  0:11:18s
epoch 41 | loss: 0.58325 | train_auc: 0.74119 | train_balanced_accuracy: 0.68109 | train_accuracy: 0.6813  | valid_auc: 0.73917 | valid_balanced_accuracy: 0.67921 | valid_accuracy: 0.67941 |  0:11:34s
epoch 42 | loss: 0.57848 | train_auc: 0.74521 | train_balanced_accuracy: 0.68549 | train_accuracy: 0.68579 | valid_auc: 0.74222 | valid_balanced_accuracy: 0.68478 | valid_accuracy: 0.68508 |  0:11:51s
epoch 43 | loss: 0.58579 | train_auc: 0.75971 | train_balanced_accuracy: 0.68973 | train_accuracy: 0.68984 | valid_auc: 0.75401 | valid_balanced_accuracy: 0.69003 | valid_accuracy: 0.69012 |  0:12:07s
epoch 44 | loss: 0.5854  | train_auc: 0.76283 | train_balanced_accuracy: 0.69143 | train_accuracy: 0.69145 | valid_auc: 0.75395 | valid_balanced_accuracy: 0.68603 | valid_accuracy: 0.68602 |  0:12:23s
epoch 45 | loss: 0.58241 | train_auc: 0.76714 | train_balanced_accuracy: 0.6942  | train_accuracy: 0.69448 | valid_auc: 0.75362 | valid_balanced_accuracy: 0.68593 | valid_accuracy: 0.68618 |  0:12:37s
epoch 46 | loss: 0.5831  | train_auc: 0.76714 | train_balanced_accuracy: 0.69325 | train_accuracy: 0.69358 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.68665 | valid_accuracy: 0.68697 |  0:12:54s
epoch 47 | loss: 0.58127 | train_auc: 0.76212 | train_balanced_accuracy: 0.6922  | train_accuracy: 0.69256 | valid_auc: 0.74894 | valid_balanced_accuracy: 0.68189 | valid_accuracy: 0.68225 |  0:13:11s
epoch 48 | loss: 0.58456 | train_auc: 0.76161 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.68862 | valid_auc: 0.74507 | valid_balanced_accuracy: 0.67542 | valid_accuracy: 0.67564 |  0:13:30s
epoch 49 | loss: 0.58219 | train_auc: 0.75918 | train_balanced_accuracy: 0.68814 | train_accuracy: 0.68862 | valid_auc: 0.74089 | valid_balanced_accuracy: 0.67751 | valid_accuracy: 0.678   |  0:13:48s
epoch 50 | loss: 0.58451 | train_auc: 0.76436 | train_balanced_accuracy: 0.6917  | train_accuracy: 0.69193 | valid_auc: 0.74851 | valid_balanced_accuracy: 0.68174 | valid_accuracy: 0.68193 |  0:14:03s
epoch 51 | loss: 0.57794 | train_auc: 0.76197 | train_balanced_accuracy: 0.69165 | train_accuracy: 0.69193 | valid_auc: 0.74391 | valid_balanced_accuracy: 0.68276 | valid_accuracy: 0.68303 |  0:14:19s
epoch 52 | loss: 0.57385 | train_auc: 0.76972 | train_balanced_accuracy: 0.69487 | train_accuracy: 0.695   | valid_auc: 0.74955 | valid_balanced_accuracy: 0.68068 | valid_accuracy: 0.68083 |  0:14:35s
epoch 53 | loss: 0.57706 | train_auc: 0.76566 | train_balanced_accuracy: 0.69429 | train_accuracy: 0.69433 | valid_auc: 0.74904 | valid_balanced_accuracy: 0.69068 | valid_accuracy: 0.69075 |  0:14:51s
epoch 54 | loss: 0.5772  | train_auc: 0.76992 | train_balanced_accuracy: 0.69723 | train_accuracy: 0.69759 | valid_auc: 0.75421 | valid_balanced_accuracy: 0.6866  | valid_accuracy: 0.68697 |  0:15:08s
epoch 55 | loss: 0.57713 | train_auc: 0.7685  | train_balanced_accuracy: 0.69664 | train_accuracy: 0.69677 | valid_auc: 0.7493  | valid_balanced_accuracy: 0.68352 | valid_accuracy: 0.68366 |  0:15:25s
epoch 56 | loss: 0.57403 | train_auc: 0.76518 | train_balanced_accuracy: 0.69179 | train_accuracy: 0.69189 | valid_auc: 0.74595 | valid_balanced_accuracy: 0.67934 | valid_accuracy: 0.67941 |  0:15:41s
epoch 57 | loss: 0.58363 | train_auc: 0.7693  | train_balanced_accuracy: 0.69623 | train_accuracy: 0.69625 | valid_auc: 0.7554  | valid_balanced_accuracy: 0.68469 | valid_accuracy: 0.68477 |  0:15:59s
epoch 58 | loss: 0.5802  | train_auc: 0.77253 | train_balanced_accuracy: 0.69867 | train_accuracy: 0.69897 | valid_auc: 0.75277 | valid_balanced_accuracy: 0.68585 | valid_accuracy: 0.68618 |  0:16:16s
epoch 59 | loss: 0.57057 | train_auc: 0.77338 | train_balanced_accuracy: 0.70019 | train_accuracy: 0.70046 | valid_auc: 0.75339 | valid_balanced_accuracy: 0.68356 | valid_accuracy: 0.68382 |  0:16:33s
epoch 60 | loss: 0.57363 | train_auc: 0.77324 | train_balanced_accuracy: 0.69607 | train_accuracy: 0.69645 | valid_auc: 0.7531  | valid_balanced_accuracy: 0.68191 | valid_accuracy: 0.68225 |  0:16:51s
epoch 61 | loss: 0.57562 | train_auc: 0.7731  | train_balanced_accuracy: 0.69795 | train_accuracy: 0.69846 | valid_auc: 0.75368 | valid_balanced_accuracy: 0.68711 | valid_accuracy: 0.6876  |  0:17:09s
epoch 62 | loss: 0.572   | train_auc: 0.77019 | train_balanced_accuracy: 0.69398 | train_accuracy: 0.69433 | valid_auc: 0.7526  | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68351 |  0:17:25s
epoch 63 | loss: 0.57309 | train_auc: 0.77688 | train_balanced_accuracy: 0.69926 | train_accuracy: 0.6998  | valid_auc: 0.75562 | valid_balanced_accuracy: 0.68819 | valid_accuracy: 0.6887  |  0:17:43s
epoch 64 | loss: 0.57065 | train_auc: 0.77583 | train_balanced_accuracy: 0.69751 | train_accuracy: 0.69791 | valid_auc: 0.75335 | valid_balanced_accuracy: 0.68357 | valid_accuracy: 0.68398 |  0:18:00s
epoch 65 | loss: 0.56699 | train_auc: 0.77053 | train_balanced_accuracy: 0.69548 | train_accuracy: 0.69602 | valid_auc: 0.74512 | valid_balanced_accuracy: 0.67807 | valid_accuracy: 0.67863 |  0:18:16s
epoch 66 | loss: 0.57823 | train_auc: 0.75932 | train_balanced_accuracy: 0.6907  | train_accuracy: 0.69102 | valid_auc: 0.74353 | valid_balanced_accuracy: 0.68023 | valid_accuracy: 0.68052 |  0:18:32s
epoch 67 | loss: 0.56887 | train_auc: 0.7439  | train_balanced_accuracy: 0.67976 | train_accuracy: 0.6802  | valid_auc: 0.72749 | valid_balanced_accuracy: 0.67158 | valid_accuracy: 0.67202 |  0:18:49s
epoch 68 | loss: 0.57082 | train_auc: 0.76367 | train_balanced_accuracy: 0.69114 | train_accuracy: 0.69165 | valid_auc: 0.7489  | valid_balanced_accuracy: 0.68881 | valid_accuracy: 0.68933 |  0:19:08s
epoch 69 | loss: 0.57242 | train_auc: 0.77616 | train_balanced_accuracy: 0.69787 | train_accuracy: 0.69822 | valid_auc: 0.75128 | valid_balanced_accuracy: 0.6863  | valid_accuracy: 0.68665 |  0:19:25s
epoch 70 | loss: 0.56725 | train_auc: 0.76858 | train_balanced_accuracy: 0.69017 | train_accuracy: 0.69023 | valid_auc: 0.75042 | valid_balanced_accuracy: 0.68031 | valid_accuracy: 0.68036 |  0:19:40s
epoch 71 | loss: 0.57492 | train_auc: 0.77845 | train_balanced_accuracy: 0.70218 | train_accuracy: 0.70239 | valid_auc: 0.75671 | valid_balanced_accuracy: 0.68517 | valid_accuracy: 0.6854  |  0:19:56s
epoch 72 | loss: 0.56733 | train_auc: 0.77286 | train_balanced_accuracy: 0.69751 | train_accuracy: 0.69775 | valid_auc: 0.74949 | valid_balanced_accuracy: 0.67934 | valid_accuracy: 0.67957 |  0:20:14s
epoch 73 | loss: 0.56608 | train_auc: 0.74679 | train_balanced_accuracy: 0.68316 | train_accuracy: 0.68351 | valid_auc: 0.73593 | valid_balanced_accuracy: 0.68145 | valid_accuracy: 0.68178 |  0:20:31s

Early stopping occurred at epoch 73 with best_epoch = 53 and best_valid_accuracy = 0.69075
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 52/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=20.7min
[CV 4/5; 52/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6899  | train_auc: 0.63983 | train_balanced_accuracy: 0.58153 | train_accuracy: 0.57999 | valid_auc: 0.63059 | valid_balanced_accuracy: 0.5717  | valid_accuracy: 0.57019 |  0:00:15s
epoch 1  | loss: 0.64866 | train_auc: 0.65714 | train_balanced_accuracy: 0.59402 | train_accuracy: 0.59223 | valid_auc: 0.64975 | valid_balanced_accuracy: 0.58663 | valid_accuracy: 0.58483 |  0:00:30s
epoch 2  | loss: 0.63531 | train_auc: 0.66095 | train_balanced_accuracy: 0.60324 | train_accuracy: 0.60226 | valid_auc: 0.65637 | valid_balanced_accuracy: 0.59655 | valid_accuracy: 0.59553 |  0:00:43s
epoch 3  | loss: 0.63559 | train_auc: 0.67187 | train_balanced_accuracy: 0.59398 | train_accuracy: 0.59211 | valid_auc: 0.66771 | valid_balanced_accuracy: 0.58502 | valid_accuracy: 0.5831  |  0:01:00s
epoch 4  | loss: 0.62564 | train_auc: 0.68439 | train_balanced_accuracy: 0.62573 | train_accuracy: 0.62484 | valid_auc: 0.68149 | valid_balanced_accuracy: 0.62129 | valid_accuracy: 0.6204  |  0:01:16s
epoch 5  | loss: 0.62472 | train_auc: 0.68743 | train_balanced_accuracy: 0.62908 | train_accuracy: 0.62823 | valid_auc: 0.68475 | valid_balanced_accuracy: 0.6244  | valid_accuracy: 0.62354 |  0:01:33s
epoch 6  | loss: 0.61868 | train_auc: 0.69947 | train_balanced_accuracy: 0.62983 | train_accuracy: 0.62854 | valid_auc: 0.69553 | valid_balanced_accuracy: 0.61869 | valid_accuracy: 0.61741 |  0:01:48s
epoch 7  | loss: 0.61683 | train_auc: 0.70756 | train_balanced_accuracy: 0.64626 | train_accuracy: 0.64538 | valid_auc: 0.7037  | valid_balanced_accuracy: 0.63575 | valid_accuracy: 0.63488 |  0:02:04s
epoch 8  | loss: 0.61919 | train_auc: 0.70724 | train_balanced_accuracy: 0.64443 | train_accuracy: 0.64428 | valid_auc: 0.70363 | valid_balanced_accuracy: 0.64162 | valid_accuracy: 0.64149 |  0:02:20s
epoch 9  | loss: 0.61257 | train_auc: 0.70434 | train_balanced_accuracy: 0.64058 | train_accuracy: 0.64046 | valid_auc: 0.70022 | valid_balanced_accuracy: 0.63577 | valid_accuracy: 0.63566 |  0:02:36s
epoch 10 | loss: 0.61007 | train_auc: 0.7132  | train_balanced_accuracy: 0.66033 | train_accuracy: 0.66014 | valid_auc: 0.70816 | valid_balanced_accuracy: 0.65911 | valid_accuracy: 0.65895 |  0:02:52s
epoch 11 | loss: 0.60816 | train_auc: 0.72301 | train_balanced_accuracy: 0.66259 | train_accuracy: 0.66242 | valid_auc: 0.71764 | valid_balanced_accuracy: 0.66223 | valid_accuracy: 0.6621  |  0:03:09s
epoch 12 | loss: 0.60208 | train_auc: 0.73125 | train_balanced_accuracy: 0.67073 | train_accuracy: 0.67048 | valid_auc: 0.7237  | valid_balanced_accuracy: 0.66574 | valid_accuracy: 0.66556 |  0:03:26s
epoch 13 | loss: 0.60219 | train_auc: 0.73052 | train_balanced_accuracy: 0.66949 | train_accuracy: 0.66962 | valid_auc: 0.72211 | valid_balanced_accuracy: 0.66176 | valid_accuracy: 0.66195 |  0:03:44s
epoch 14 | loss: 0.60263 | train_auc: 0.73134 | train_balanced_accuracy: 0.66787 | train_accuracy: 0.66769 | valid_auc: 0.72196 | valid_balanced_accuracy: 0.65924 | valid_accuracy: 0.65911 |  0:04:02s
epoch 15 | loss: 0.60241 | train_auc: 0.73442 | train_balanced_accuracy: 0.6682  | train_accuracy: 0.66797 | valid_auc: 0.72697 | valid_balanced_accuracy: 0.66483 | valid_accuracy: 0.66462 |  0:04:19s
epoch 16 | loss: 0.59562 | train_auc: 0.73587 | train_balanced_accuracy: 0.67347 | train_accuracy: 0.67339 | valid_auc: 0.73006 | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67312 |  0:04:36s
epoch 17 | loss: 0.59809 | train_auc: 0.73595 | train_balanced_accuracy: 0.67214 | train_accuracy: 0.6721  | valid_auc: 0.72707 | valid_balanced_accuracy: 0.66462 | valid_accuracy: 0.66462 |  0:04:53s
epoch 18 | loss: 0.59814 | train_auc: 0.74163 | train_balanced_accuracy: 0.67495 | train_accuracy: 0.67536 | valid_auc: 0.73089 | valid_balanced_accuracy: 0.66747 | valid_accuracy: 0.66793 |  0:05:10s
epoch 19 | loss: 0.59384 | train_auc: 0.73855 | train_balanced_accuracy: 0.67325 | train_accuracy: 0.67371 | valid_auc: 0.72898 | valid_balanced_accuracy: 0.66932 | valid_accuracy: 0.66981 |  0:05:25s
epoch 20 | loss: 0.59861 | train_auc: 0.73539 | train_balanced_accuracy: 0.67278 | train_accuracy: 0.67336 | valid_auc: 0.72247 | valid_balanced_accuracy: 0.66823 | valid_accuracy: 0.66887 |  0:05:40s
epoch 21 | loss: 0.59655 | train_auc: 0.74225 | train_balanced_accuracy: 0.67408 | train_accuracy: 0.67473 | valid_auc: 0.72939 | valid_balanced_accuracy: 0.66425 | valid_accuracy: 0.66494 |  0:05:57s
epoch 22 | loss: 0.59794 | train_auc: 0.73992 | train_balanced_accuracy: 0.67369 | train_accuracy: 0.67406 | valid_auc: 0.73073 | valid_balanced_accuracy: 0.67004 | valid_accuracy: 0.67044 |  0:06:15s
epoch 23 | loss: 0.59929 | train_auc: 0.74676 | train_balanced_accuracy: 0.68561 | train_accuracy: 0.68583 | valid_auc: 0.73266 | valid_balanced_accuracy: 0.67523 | valid_accuracy: 0.67548 |  0:06:32s
epoch 24 | loss: 0.59672 | train_auc: 0.74553 | train_balanced_accuracy: 0.68005 | train_accuracy: 0.68036 | valid_auc: 0.73481 | valid_balanced_accuracy: 0.67213 | valid_accuracy: 0.67249 |  0:06:47s
epoch 25 | loss: 0.59144 | train_auc: 0.75348 | train_balanced_accuracy: 0.68778 | train_accuracy: 0.68799 | valid_auc: 0.74238 | valid_balanced_accuracy: 0.68183 | valid_accuracy: 0.68209 |  0:07:02s
epoch 26 | loss: 0.58879 | train_auc: 0.75565 | train_balanced_accuracy: 0.69056 | train_accuracy: 0.69094 | valid_auc: 0.74046 | valid_balanced_accuracy: 0.6828  | valid_accuracy: 0.68319 |  0:07:19s
epoch 27 | loss: 0.59203 | train_auc: 0.75836 | train_balanced_accuracy: 0.68999 | train_accuracy: 0.69027 | valid_auc: 0.74098 | valid_balanced_accuracy: 0.67517 | valid_accuracy: 0.67548 |  0:07:36s
epoch 28 | loss: 0.58775 | train_auc: 0.75836 | train_balanced_accuracy: 0.69032 | train_accuracy: 0.69043 | valid_auc: 0.74288 | valid_balanced_accuracy: 0.68102 | valid_accuracy: 0.68115 |  0:07:53s
epoch 29 | loss: 0.5881  | train_auc: 0.76238 | train_balanced_accuracy: 0.69087 | train_accuracy: 0.69079 | valid_auc: 0.74372 | valid_balanced_accuracy: 0.67961 | valid_accuracy: 0.67957 |  0:08:08s
epoch 30 | loss: 0.58049 | train_auc: 0.76235 | train_balanced_accuracy: 0.68824 | train_accuracy: 0.68807 | valid_auc: 0.74111 | valid_balanced_accuracy: 0.67784 | valid_accuracy: 0.67768 |  0:08:26s
epoch 31 | loss: 0.58256 | train_auc: 0.76076 | train_balanced_accuracy: 0.69537 | train_accuracy: 0.69566 | valid_auc: 0.74463 | valid_balanced_accuracy: 0.68142 | valid_accuracy: 0.68178 |  0:08:45s
epoch 32 | loss: 0.58213 | train_auc: 0.75929 | train_balanced_accuracy: 0.69164 | train_accuracy: 0.69165 | valid_auc: 0.74408 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.67879 |  0:09:02s
epoch 33 | loss: 0.5868  | train_auc: 0.76377 | train_balanced_accuracy: 0.69431 | train_accuracy: 0.69452 | valid_auc: 0.7483  | valid_balanced_accuracy: 0.68012 | valid_accuracy: 0.68036 |  0:09:20s
epoch 34 | loss: 0.58197 | train_auc: 0.76201 | train_balanced_accuracy: 0.69332 | train_accuracy: 0.69346 | valid_auc: 0.74642 | valid_balanced_accuracy: 0.68159 | valid_accuracy: 0.68178 |  0:09:38s
epoch 35 | loss: 0.57583 | train_auc: 0.76411 | train_balanced_accuracy: 0.69139 | train_accuracy: 0.69181 | valid_auc: 0.74097 | valid_balanced_accuracy: 0.67627 | valid_accuracy: 0.67674 |  0:09:54s
epoch 36 | loss: 0.57787 | train_auc: 0.76625 | train_balanced_accuracy: 0.69577 | train_accuracy: 0.69602 | valid_auc: 0.75169 | valid_balanced_accuracy: 0.68417 | valid_accuracy: 0.68445 |  0:10:10s
epoch 37 | loss: 0.5792  | train_auc: 0.76681 | train_balanced_accuracy: 0.69541 | train_accuracy: 0.69547 | valid_auc: 0.74573 | valid_balanced_accuracy: 0.68184 | valid_accuracy: 0.68193 |  0:10:26s
epoch 38 | loss: 0.57843 | train_auc: 0.76885 | train_balanced_accuracy: 0.69169 | train_accuracy: 0.69161 | valid_auc: 0.74364 | valid_balanced_accuracy: 0.67395 | valid_accuracy: 0.67391 |  0:10:42s
epoch 39 | loss: 0.57879 | train_auc: 0.76933 | train_balanced_accuracy: 0.69475 | train_accuracy: 0.69496 | valid_auc: 0.74555 | valid_balanced_accuracy: 0.68155 | valid_accuracy: 0.68178 |  0:11:00s
epoch 40 | loss: 0.57474 | train_auc: 0.76807 | train_balanced_accuracy: 0.69524 | train_accuracy: 0.69539 | valid_auc: 0.74569 | valid_balanced_accuracy: 0.68177 | valid_accuracy: 0.68193 |  0:11:16s
epoch 41 | loss: 0.57792 | train_auc: 0.771   | train_balanced_accuracy: 0.69727 | train_accuracy: 0.69755 | valid_auc: 0.74815 | valid_balanced_accuracy: 0.67754 | valid_accuracy: 0.67784 |  0:11:32s
epoch 42 | loss: 0.57222 | train_auc: 0.77194 | train_balanced_accuracy: 0.69916 | train_accuracy: 0.69964 | valid_auc: 0.74671 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.68587 |  0:11:49s
epoch 43 | loss: 0.5765  | train_auc: 0.76543 | train_balanced_accuracy: 0.69522 | train_accuracy: 0.69539 | valid_auc: 0.74883 | valid_balanced_accuracy: 0.68517 | valid_accuracy: 0.6854  |  0:12:05s
epoch 44 | loss: 0.57857 | train_auc: 0.76714 | train_balanced_accuracy: 0.69595 | train_accuracy: 0.69633 | valid_auc: 0.74907 | valid_balanced_accuracy: 0.68497 | valid_accuracy: 0.6854  |  0:12:22s
epoch 45 | loss: 0.57285 | train_auc: 0.76679 | train_balanced_accuracy: 0.6938  | train_accuracy: 0.69456 | valid_auc: 0.74791 | valid_balanced_accuracy: 0.68283 | valid_accuracy: 0.68366 |  0:12:39s
epoch 46 | loss: 0.57846 | train_auc: 0.77484 | train_balanced_accuracy: 0.6996  | train_accuracy: 0.69968 | valid_auc: 0.74668 | valid_balanced_accuracy: 0.68086 | valid_accuracy: 0.68099 |  0:12:57s
epoch 47 | loss: 0.57294 | train_auc: 0.77801 | train_balanced_accuracy: 0.70294 | train_accuracy: 0.7033  | valid_auc: 0.75156 | valid_balanced_accuracy: 0.68689 | valid_accuracy: 0.68728 |  0:13:12s
epoch 48 | loss: 0.56861 | train_auc: 0.77811 | train_balanced_accuracy: 0.70382 | train_accuracy: 0.70408 | valid_auc: 0.75058 | valid_balanced_accuracy: 0.68465 | valid_accuracy: 0.68492 |  0:13:28s
epoch 49 | loss: 0.56762 | train_auc: 0.77544 | train_balanced_accuracy: 0.6993  | train_accuracy: 0.69968 | valid_auc: 0.74422 | valid_balanced_accuracy: 0.67726 | valid_accuracy: 0.67768 |  0:13:45s
epoch 50 | loss: 0.56942 | train_auc: 0.78035 | train_balanced_accuracy: 0.70242 | train_accuracy: 0.70259 | valid_auc: 0.7494  | valid_balanced_accuracy: 0.68441 | valid_accuracy: 0.68461 |  0:14:03s
epoch 51 | loss: 0.56608 | train_auc: 0.77776 | train_balanced_accuracy: 0.6985  | train_accuracy: 0.69858 | valid_auc: 0.74818 | valid_balanced_accuracy: 0.67868 | valid_accuracy: 0.67879 |  0:14:18s
epoch 52 | loss: 0.56623 | train_auc: 0.78001 | train_balanced_accuracy: 0.70118 | train_accuracy: 0.70149 | valid_auc: 0.7498  | valid_balanced_accuracy: 0.68113 | valid_accuracy: 0.68146 |  0:14:35s
epoch 53 | loss: 0.56964 | train_auc: 0.77982 | train_balanced_accuracy: 0.7068  | train_accuracy: 0.70711 | valid_auc: 0.7527  | valid_balanced_accuracy: 0.6882  | valid_accuracy: 0.68854 |  0:14:52s
epoch 54 | loss: 0.57012 | train_auc: 0.7813  | train_balanced_accuracy: 0.7056  | train_accuracy: 0.70582 | valid_auc: 0.74822 | valid_balanced_accuracy: 0.67837 | valid_accuracy: 0.67863 |  0:15:07s
epoch 55 | loss: 0.56564 | train_auc: 0.77844 | train_balanced_accuracy: 0.70415 | train_accuracy: 0.70416 | valid_auc: 0.74777 | valid_balanced_accuracy: 0.67876 | valid_accuracy: 0.67879 |  0:15:23s
epoch 56 | loss: 0.56651 | train_auc: 0.78474 | train_balanced_accuracy: 0.70654 | train_accuracy: 0.70672 | valid_auc: 0.75062 | valid_balanced_accuracy: 0.68326 | valid_accuracy: 0.68351 |  0:15:39s
epoch 57 | loss: 0.56726 | train_auc: 0.78183 | train_balanced_accuracy: 0.70675 | train_accuracy: 0.70707 | valid_auc: 0.74635 | valid_balanced_accuracy: 0.686   | valid_accuracy: 0.68634 |  0:15:56s
epoch 58 | loss: 0.5703  | train_auc: 0.78182 | train_balanced_accuracy: 0.70425 | train_accuracy: 0.70428 | valid_auc: 0.74753 | valid_balanced_accuracy: 0.68119 | valid_accuracy: 0.6813  |  0:16:10s
epoch 59 | loss: 0.56519 | train_auc: 0.78366 | train_balanced_accuracy: 0.70716 | train_accuracy: 0.70743 | valid_auc: 0.75161 | valid_balanced_accuracy: 0.68683 | valid_accuracy: 0.68713 |  0:16:27s
epoch 60 | loss: 0.5627  | train_auc: 0.78628 | train_balanced_accuracy: 0.70774 | train_accuracy: 0.70822 | valid_auc: 0.75469 | valid_balanced_accuracy: 0.68581 | valid_accuracy: 0.68634 |  0:16:40s
epoch 61 | loss: 0.56118 | train_auc: 0.78576 | train_balanced_accuracy: 0.70714 | train_accuracy: 0.70747 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68886 |  0:16:57s
epoch 62 | loss: 0.56375 | train_auc: 0.78641 | train_balanced_accuracy: 0.70897 | train_accuracy: 0.70908 | valid_auc: 0.75332 | valid_balanced_accuracy: 0.6895  | valid_accuracy: 0.68964 |  0:17:13s
epoch 63 | loss: 0.56197 | train_auc: 0.78744 | train_balanced_accuracy: 0.70899 | train_accuracy: 0.7092  | valid_auc: 0.75191 | valid_balanced_accuracy: 0.68686 | valid_accuracy: 0.68713 |  0:17:32s
epoch 64 | loss: 0.55855 | train_auc: 0.7884  | train_balanced_accuracy: 0.71081 | train_accuracy: 0.71089 | valid_auc: 0.74914 | valid_balanced_accuracy: 0.68402 | valid_accuracy: 0.68414 |  0:17:49s
epoch 65 | loss: 0.55885 | train_auc: 0.78319 | train_balanced_accuracy: 0.70724 | train_accuracy: 0.70759 | valid_auc: 0.74687 | valid_balanced_accuracy: 0.68278 | valid_accuracy: 0.68319 |  0:18:03s
epoch 66 | loss: 0.565   | train_auc: 0.78267 | train_balanced_accuracy: 0.70428 | train_accuracy: 0.70424 | valid_auc: 0.7453  | valid_balanced_accuracy: 0.67501 | valid_accuracy: 0.67501 |  0:18:19s
epoch 67 | loss: 0.55989 | train_auc: 0.78169 | train_balanced_accuracy: 0.70562 | train_accuracy: 0.70601 | valid_auc: 0.75086 | valid_balanced_accuracy: 0.68733 | valid_accuracy: 0.68776 |  0:18:36s
epoch 68 | loss: 0.56381 | train_auc: 0.78372 | train_balanced_accuracy: 0.7043  | train_accuracy: 0.70483 | valid_auc: 0.75067 | valid_balanced_accuracy: 0.68279 | valid_accuracy: 0.68335 |  0:18:53s
epoch 69 | loss: 0.56447 | train_auc: 0.78645 | train_balanced_accuracy: 0.7075  | train_accuracy: 0.70778 | valid_auc: 0.75543 | valid_balanced_accuracy: 0.69199 | valid_accuracy: 0.69232 |  0:19:10s
epoch 70 | loss: 0.55904 | train_auc: 0.7873  | train_balanced_accuracy: 0.70777 | train_accuracy: 0.70806 | valid_auc: 0.75329 | valid_balanced_accuracy: 0.6846  | valid_accuracy: 0.68492 |  0:19:26s
epoch 71 | loss: 0.55948 | train_auc: 0.78929 | train_balanced_accuracy: 0.71011 | train_accuracy: 0.71046 | valid_auc: 0.75593 | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69138 |  0:19:43s
epoch 72 | loss: 0.55621 | train_auc: 0.79098 | train_balanced_accuracy: 0.71128 | train_accuracy: 0.7116  | valid_auc: 0.75508 | valid_balanced_accuracy: 0.69059 | valid_accuracy: 0.6909  |  0:20:00s
epoch 73 | loss: 0.55805 | train_auc: 0.79105 | train_balanced_accuracy: 0.71195 | train_accuracy: 0.71207 | valid_auc: 0.75487 | valid_balanced_accuracy: 0.69184 | valid_accuracy: 0.69201 |  0:20:16s
epoch 74 | loss: 0.55938 | train_auc: 0.79188 | train_balanced_accuracy: 0.7091  | train_accuracy: 0.70967 | valid_auc: 0.75    | valid_balanced_accuracy: 0.68371 | valid_accuracy: 0.68429 |  0:20:32s
epoch 75 | loss: 0.55983 | train_auc: 0.78761 | train_balanced_accuracy: 0.70794 | train_accuracy: 0.7081  | valid_auc: 0.75063 | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68602 |  0:20:50s
epoch 76 | loss: 0.55969 | train_auc: 0.79196 | train_balanced_accuracy: 0.71072 | train_accuracy: 0.71065 | valid_auc: 0.75325 | valid_balanced_accuracy: 0.68374 | valid_accuracy: 0.68366 |  0:21:07s
epoch 77 | loss: 0.55716 | train_auc: 0.7937  | train_balanced_accuracy: 0.71337 | train_accuracy: 0.71368 | valid_auc: 0.75251 | valid_balanced_accuracy: 0.6882  | valid_accuracy: 0.68854 |  0:21:24s
epoch 78 | loss: 0.54592 | train_auc: 0.79718 | train_balanced_accuracy: 0.71504 | train_accuracy: 0.71526 | valid_auc: 0.75784 | valid_balanced_accuracy: 0.6927  | valid_accuracy: 0.69295 |  0:21:42s
epoch 79 | loss: 0.54794 | train_auc: 0.79423 | train_balanced_accuracy: 0.70949 | train_accuracy: 0.70944 | valid_auc: 0.75856 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68429 |  0:21:59s
epoch 80 | loss: 0.55553 | train_auc: 0.79814 | train_balanced_accuracy: 0.717   | train_accuracy: 0.71711 | valid_auc: 0.75659 | valid_balanced_accuracy: 0.68855 | valid_accuracy: 0.6887  |  0:22:17s
epoch 81 | loss: 0.55152 | train_auc: 0.79781 | train_balanced_accuracy: 0.71488 | train_accuracy: 0.7149  | valid_auc: 0.75327 | valid_balanced_accuracy: 0.67891 | valid_accuracy: 0.67894 |  0:22:33s
epoch 82 | loss: 0.55002 | train_auc: 0.79693 | train_balanced_accuracy: 0.71558 | train_accuracy: 0.71597 | valid_auc: 0.75597 | valid_balanced_accuracy: 0.6897  | valid_accuracy: 0.69012 |  0:22:49s
epoch 83 | loss: 0.55084 | train_auc: 0.7967  | train_balanced_accuracy: 0.71257 | train_accuracy: 0.71246 | valid_auc: 0.7534  | valid_balanced_accuracy: 0.68249 | valid_accuracy: 0.6824  |  0:23:05s
epoch 84 | loss: 0.54972 | train_auc: 0.78993 | train_balanced_accuracy: 0.70922 | train_accuracy: 0.70967 | valid_auc: 0.75354 | valid_balanced_accuracy: 0.68716 | valid_accuracy: 0.6876  |  0:23:23s
epoch 85 | loss: 0.5516  | train_auc: 0.79339 | train_balanced_accuracy: 0.71227 | train_accuracy: 0.71258 | valid_auc: 0.75214 | valid_balanced_accuracy: 0.68819 | valid_accuracy: 0.68854 |  0:23:41s
epoch 86 | loss: 0.55637 | train_auc: 0.7947  | train_balanced_accuracy: 0.71102 | train_accuracy: 0.71121 | valid_auc: 0.75261 | valid_balanced_accuracy: 0.68535 | valid_accuracy: 0.68555 |  0:23:58s
epoch 87 | loss: 0.54922 | train_auc: 0.79928 | train_balanced_accuracy: 0.7141  | train_accuracy: 0.71388 | valid_auc: 0.75491 | valid_balanced_accuracy: 0.68433 | valid_accuracy: 0.68414 |  0:24:16s
epoch 88 | loss: 0.54855 | train_auc: 0.80058 | train_balanced_accuracy: 0.71883 | train_accuracy: 0.71919 | valid_auc: 0.75769 | valid_balanced_accuracy: 0.68958 | valid_accuracy: 0.68996 |  0:24:32s
epoch 89 | loss: 0.54597 | train_auc: 0.80244 | train_balanced_accuracy: 0.71755 | train_accuracy: 0.71754 | valid_auc: 0.75903 | valid_balanced_accuracy: 0.69008 | valid_accuracy: 0.69012 |  0:24:48s
epoch 90 | loss: 0.54515 | train_auc: 0.80245 | train_balanced_accuracy: 0.71888 | train_accuracy: 0.71888 | valid_auc: 0.75508 | valid_balanced_accuracy: 0.68505 | valid_accuracy: 0.68508 |  0:25:04s
epoch 91 | loss: 0.54457 | train_auc: 0.80259 | train_balanced_accuracy: 0.72032 | train_accuracy: 0.72041 | valid_auc: 0.75415 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.68587 |  0:25:21s
epoch 92 | loss: 0.54505 | train_auc: 0.79976 | train_balanced_accuracy: 0.71723 | train_accuracy: 0.7173  | valid_auc: 0.75483 | valid_balanced_accuracy: 0.6897  | valid_accuracy: 0.6898  |  0:25:38s
epoch 93 | loss: 0.54359 | train_auc: 0.80346 | train_balanced_accuracy: 0.72034 | train_accuracy: 0.72045 | valid_auc: 0.75446 | valid_balanced_accuracy: 0.6848  | valid_accuracy: 0.68492 |  0:25:56s
epoch 94 | loss: 0.54731 | train_auc: 0.8007  | train_balanced_accuracy: 0.71725 | train_accuracy: 0.7173  | valid_auc: 0.75135 | valid_balanced_accuracy: 0.67886 | valid_accuracy: 0.67894 |  0:26:13s
epoch 95 | loss: 0.54388 | train_auc: 0.79523 | train_balanced_accuracy: 0.71475 | train_accuracy: 0.71514 | valid_auc: 0.75222 | valid_balanced_accuracy: 0.68105 | valid_accuracy: 0.68146 |  0:26:31s
epoch 96 | loss: 0.55004 | train_auc: 0.8032  | train_balanced_accuracy: 0.72034 | train_accuracy: 0.72045 | valid_auc: 0.75854 | valid_balanced_accuracy: 0.68405 | valid_accuracy: 0.68414 |  0:26:49s
epoch 97 | loss: 0.54104 | train_auc: 0.80619 | train_balanced_accuracy: 0.7221  | train_accuracy: 0.72238 | valid_auc: 0.75847 | valid_balanced_accuracy: 0.68889 | valid_accuracy: 0.68917 |  0:27:05s
epoch 98 | loss: 0.54143 | train_auc: 0.80697 | train_balanced_accuracy: 0.72306 | train_accuracy: 0.72328 | valid_auc: 0.75847 | valid_balanced_accuracy: 0.68423 | valid_accuracy: 0.68445 |  0:27:23s

Early stopping occurred at epoch 98 with best_epoch = 78 and best_valid_accuracy = 0.69295
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 52/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=27.5min
[CV 5/5; 52/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70686 | train_auc: 0.52307 | train_balanced_accuracy: 0.51289 | train_accuracy: 0.51373 | valid_auc: 0.52852 | valid_balanced_accuracy: 0.51289 | valid_accuracy: 0.51369 |  0:00:17s
epoch 1  | loss: 0.65533 | train_auc: 0.60915 | train_balanced_accuracy: 0.57968 | train_accuracy: 0.58121 | valid_auc: 0.60439 | valid_balanced_accuracy: 0.57856 | valid_accuracy: 0.58011 |  0:00:34s
epoch 2  | loss: 0.64457 | train_auc: 0.63983 | train_balanced_accuracy: 0.59199 | train_accuracy: 0.59325 | valid_auc: 0.63441 | valid_balanced_accuracy: 0.587   | valid_accuracy: 0.58829 |  0:00:50s
epoch 3  | loss: 0.63623 | train_auc: 0.64112 | train_balanced_accuracy: 0.5772  | train_accuracy: 0.57893 | valid_auc: 0.63036 | valid_balanced_accuracy: 0.57155 | valid_accuracy: 0.57334 |  0:01:07s
epoch 4  | loss: 0.62185 | train_auc: 0.68813 | train_balanced_accuracy: 0.63725 | train_accuracy: 0.63857 | valid_auc: 0.68336 | valid_balanced_accuracy: 0.63673 | valid_accuracy: 0.63802 |  0:01:23s
epoch 5  | loss: 0.61422 | train_auc: 0.70523 | train_balanced_accuracy: 0.65453 | train_accuracy: 0.65506 | valid_auc: 0.70182 | valid_balanced_accuracy: 0.65212 | valid_accuracy: 0.65266 |  0:01:38s
epoch 6  | loss: 0.61313 | train_auc: 0.70774 | train_balanced_accuracy: 0.64117 | train_accuracy: 0.64255 | valid_auc: 0.70317 | valid_balanced_accuracy: 0.64116 | valid_accuracy: 0.64259 |  0:01:56s
epoch 7  | loss: 0.61043 | train_auc: 0.70522 | train_balanced_accuracy: 0.64716 | train_accuracy: 0.64829 | valid_auc: 0.70188 | valid_balanced_accuracy: 0.64443 | valid_accuracy: 0.64558 |  0:02:14s
epoch 8  | loss: 0.61251 | train_auc: 0.71685 | train_balanced_accuracy: 0.65479 | train_accuracy: 0.65585 | valid_auc: 0.71135 | valid_balanced_accuracy: 0.6517  | valid_accuracy: 0.65282 |  0:02:30s
epoch 9  | loss: 0.60476 | train_auc: 0.7204  | train_balanced_accuracy: 0.66218 | train_accuracy: 0.66289 | valid_auc: 0.71334 | valid_balanced_accuracy: 0.6577  | valid_accuracy: 0.65848 |  0:02:46s
epoch 10 | loss: 0.60071 | train_auc: 0.71809 | train_balanced_accuracy: 0.66104 | train_accuracy: 0.66183 | valid_auc: 0.71276 | valid_balanced_accuracy: 0.65975 | valid_accuracy: 0.66053 |  0:03:03s
epoch 11 | loss: 0.60028 | train_auc: 0.71852 | train_balanced_accuracy: 0.66158 | train_accuracy: 0.66222 | valid_auc: 0.71448 | valid_balanced_accuracy: 0.65957 | valid_accuracy: 0.66021 |  0:03:19s
epoch 12 | loss: 0.59934 | train_auc: 0.72175 | train_balanced_accuracy: 0.66585 | train_accuracy: 0.66663 | valid_auc: 0.71928 | valid_balanced_accuracy: 0.66209 | valid_accuracy: 0.66289 |  0:03:35s
epoch 13 | loss: 0.60198 | train_auc: 0.72758 | train_balanced_accuracy: 0.66987 | train_accuracy: 0.67025 | valid_auc: 0.72603 | valid_balanced_accuracy: 0.66187 | valid_accuracy: 0.66226 |  0:03:51s
epoch 14 | loss: 0.59291 | train_auc: 0.73039 | train_balanced_accuracy: 0.67287 | train_accuracy: 0.6732  | valid_auc: 0.72862 | valid_balanced_accuracy: 0.67058 | valid_accuracy: 0.67092 |  0:04:09s
epoch 15 | loss: 0.59168 | train_auc: 0.72681 | train_balanced_accuracy: 0.66819 | train_accuracy: 0.66887 | valid_auc: 0.7272  | valid_balanced_accuracy: 0.66598 | valid_accuracy: 0.66667 |  0:04:25s
epoch 16 | loss: 0.59464 | train_auc: 0.73466 | train_balanced_accuracy: 0.67714 | train_accuracy: 0.67757 | valid_auc: 0.73386 | valid_balanced_accuracy: 0.67617 | valid_accuracy: 0.67658 |  0:04:43s
epoch 17 | loss: 0.59628 | train_auc: 0.73981 | train_balanced_accuracy: 0.67527 | train_accuracy: 0.67587 | valid_auc: 0.73424 | valid_balanced_accuracy: 0.66607 | valid_accuracy: 0.66667 |  0:05:03s
epoch 18 | loss: 0.59076 | train_auc: 0.73987 | train_balanced_accuracy: 0.67087 | train_accuracy: 0.67162 | valid_auc: 0.73049 | valid_balanced_accuracy: 0.6604  | valid_accuracy: 0.66116 |  0:05:20s
epoch 19 | loss: 0.5927  | train_auc: 0.73585 | train_balanced_accuracy: 0.66811 | train_accuracy: 0.66883 | valid_auc: 0.73185 | valid_balanced_accuracy: 0.66564 | valid_accuracy: 0.66635 |  0:05:37s
epoch 20 | loss: 0.5907  | train_auc: 0.74351 | train_balanced_accuracy: 0.67443 | train_accuracy: 0.67505 | valid_auc: 0.73412 | valid_balanced_accuracy: 0.66986 | valid_accuracy: 0.67044 |  0:05:54s
epoch 21 | loss: 0.58653 | train_auc: 0.73975 | train_balanced_accuracy: 0.67696 | train_accuracy: 0.67749 | valid_auc: 0.73602 | valid_balanced_accuracy: 0.66883 | valid_accuracy: 0.66934 |  0:06:11s
epoch 22 | loss: 0.58615 | train_auc: 0.74718 | train_balanced_accuracy: 0.67979 | train_accuracy: 0.68028 | valid_auc: 0.73803 | valid_balanced_accuracy: 0.6714  | valid_accuracy: 0.67186 |  0:06:28s
epoch 23 | loss: 0.58351 | train_auc: 0.74828 | train_balanced_accuracy: 0.6768  | train_accuracy: 0.67741 | valid_auc: 0.74249 | valid_balanced_accuracy: 0.67034 | valid_accuracy: 0.67092 |  0:06:45s
epoch 24 | loss: 0.58928 | train_auc: 0.7572  | train_balanced_accuracy: 0.68966 | train_accuracy: 0.69004 | valid_auc: 0.74553 | valid_balanced_accuracy: 0.67811 | valid_accuracy: 0.67847 |  0:07:02s
epoch 25 | loss: 0.58617 | train_auc: 0.75674 | train_balanced_accuracy: 0.68946 | train_accuracy: 0.68984 | valid_auc: 0.74837 | valid_balanced_accuracy: 0.68175 | valid_accuracy: 0.68209 |  0:07:19s
epoch 26 | loss: 0.58619 | train_auc: 0.75285 | train_balanced_accuracy: 0.68239 | train_accuracy: 0.68303 | valid_auc: 0.7428  | valid_balanced_accuracy: 0.6696  | valid_accuracy: 0.67029 |  0:07:36s
epoch 27 | loss: 0.58507 | train_auc: 0.75742 | train_balanced_accuracy: 0.6881  | train_accuracy: 0.68854 | valid_auc: 0.74879 | valid_balanced_accuracy: 0.68405 | valid_accuracy: 0.68445 |  0:07:53s
epoch 28 | loss: 0.58562 | train_auc: 0.76372 | train_balanced_accuracy: 0.69645 | train_accuracy: 0.69673 | valid_auc: 0.75167 | valid_balanced_accuracy: 0.69047 | valid_accuracy: 0.69075 |  0:08:09s
epoch 29 | loss: 0.58441 | train_auc: 0.76365 | train_balanced_accuracy: 0.69214 | train_accuracy: 0.69232 | valid_auc: 0.75012 | valid_balanced_accuracy: 0.6838  | valid_accuracy: 0.68398 |  0:08:26s
epoch 30 | loss: 0.58573 | train_auc: 0.7669  | train_balanced_accuracy: 0.69578 | train_accuracy: 0.69602 | valid_auc: 0.75213 | valid_balanced_accuracy: 0.69006 | valid_accuracy: 0.69027 |  0:08:45s
epoch 31 | loss: 0.58351 | train_auc: 0.7654  | train_balanced_accuracy: 0.6932  | train_accuracy: 0.6933  | valid_auc: 0.7548  | valid_balanced_accuracy: 0.68738 | valid_accuracy: 0.68744 |  0:09:02s
epoch 32 | loss: 0.5876  | train_auc: 0.74995 | train_balanced_accuracy: 0.68401 | train_accuracy: 0.68421 | valid_auc: 0.73673 | valid_balanced_accuracy: 0.67764 | valid_accuracy: 0.67784 |  0:09:16s
epoch 33 | loss: 0.58852 | train_auc: 0.76397 | train_balanced_accuracy: 0.69125 | train_accuracy: 0.69197 | valid_auc: 0.74717 | valid_balanced_accuracy: 0.67552 | valid_accuracy: 0.67627 |  0:09:31s
epoch 34 | loss: 0.57921 | train_auc: 0.76992 | train_balanced_accuracy: 0.69822 | train_accuracy: 0.69846 | valid_auc: 0.7577  | valid_balanced_accuracy: 0.69209 | valid_accuracy: 0.69232 |  0:09:47s
epoch 35 | loss: 0.57694 | train_auc: 0.76901 | train_balanced_accuracy: 0.69473 | train_accuracy: 0.69484 | valid_auc: 0.752   | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68272 |  0:10:05s
epoch 36 | loss: 0.5721  | train_auc: 0.76997 | train_balanced_accuracy: 0.69669 | train_accuracy: 0.69653 | valid_auc: 0.75748 | valid_balanced_accuracy: 0.68591 | valid_accuracy: 0.68571 |  0:10:21s
epoch 37 | loss: 0.57698 | train_auc: 0.76911 | train_balanced_accuracy: 0.6981  | train_accuracy: 0.69838 | valid_auc: 0.75567 | valid_balanced_accuracy: 0.68891 | valid_accuracy: 0.68917 |  0:10:37s
epoch 38 | loss: 0.57553 | train_auc: 0.76554 | train_balanced_accuracy: 0.69229 | train_accuracy: 0.69193 | valid_auc: 0.75049 | valid_balanced_accuracy: 0.68291 | valid_accuracy: 0.68256 |  0:10:53s
epoch 39 | loss: 0.57932 | train_auc: 0.77311 | train_balanced_accuracy: 0.69807 | train_accuracy: 0.69858 | valid_auc: 0.75931 | valid_balanced_accuracy: 0.69435 | valid_accuracy: 0.69484 |  0:11:09s
epoch 40 | loss: 0.57503 | train_auc: 0.77137 | train_balanced_accuracy: 0.69994 | train_accuracy: 0.70007 | valid_auc: 0.75481 | valid_balanced_accuracy: 0.69015 | valid_accuracy: 0.69027 |  0:11:25s
epoch 41 | loss: 0.57482 | train_auc: 0.76904 | train_balanced_accuracy: 0.69938 | train_accuracy: 0.69976 | valid_auc: 0.75486 | valid_balanced_accuracy: 0.6902  | valid_accuracy: 0.69059 |  0:11:42s
epoch 42 | loss: 0.57591 | train_auc: 0.77109 | train_balanced_accuracy: 0.69685 | train_accuracy: 0.6974  | valid_auc: 0.75574 | valid_balanced_accuracy: 0.68877 | valid_accuracy: 0.68933 |  0:11:58s
epoch 43 | loss: 0.57186 | train_auc: 0.77805 | train_balanced_accuracy: 0.7047  | train_accuracy: 0.70503 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.69106 | valid_accuracy: 0.69138 |  0:12:13s
epoch 44 | loss: 0.57093 | train_auc: 0.7741  | train_balanced_accuracy: 0.70307 | train_accuracy: 0.70342 | valid_auc: 0.75307 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.68571 |  0:12:29s
epoch 45 | loss: 0.57389 | train_auc: 0.76594 | train_balanced_accuracy: 0.69423 | train_accuracy: 0.69472 | valid_auc: 0.75239 | valid_balanced_accuracy: 0.68318 | valid_accuracy: 0.68366 |  0:12:44s
epoch 46 | loss: 0.57928 | train_auc: 0.63691 | train_balanced_accuracy: 0.58911 | train_accuracy: 0.58853 | valid_auc: 0.63794 | valid_balanced_accuracy: 0.5911  | valid_accuracy: 0.59049 |  0:13:02s
epoch 47 | loss: 0.57327 | train_auc: 0.66324 | train_balanced_accuracy: 0.61721 | train_accuracy: 0.61808 | valid_auc: 0.66456 | valid_balanced_accuracy: 0.62097 | valid_accuracy: 0.62181 |  0:13:17s
epoch 48 | loss: 0.5709  | train_auc: 0.7372  | train_balanced_accuracy: 0.67465 | train_accuracy: 0.67524 | valid_auc: 0.72896 | valid_balanced_accuracy: 0.66941 | valid_accuracy: 0.66997 |  0:13:35s
epoch 49 | loss: 0.56672 | train_auc: 0.76402 | train_balanced_accuracy: 0.69179 | train_accuracy: 0.6924  | valid_auc: 0.74383 | valid_balanced_accuracy: 0.67362 | valid_accuracy: 0.67422 |  0:13:54s
epoch 50 | loss: 0.56913 | train_auc: 0.77527 | train_balanced_accuracy: 0.70203 | train_accuracy: 0.70223 | valid_auc: 0.75916 | valid_balanced_accuracy: 0.68914 | valid_accuracy: 0.68933 |  0:14:11s
epoch 51 | loss: 0.56813 | train_auc: 0.7745  | train_balanced_accuracy: 0.70349 | train_accuracy: 0.70389 | valid_auc: 0.75365 | valid_balanced_accuracy: 0.68578 | valid_accuracy: 0.68618 |  0:14:27s
epoch 52 | loss: 0.56797 | train_auc: 0.77718 | train_balanced_accuracy: 0.70518 | train_accuracy: 0.70534 | valid_auc: 0.75969 | valid_balanced_accuracy: 0.68648 | valid_accuracy: 0.68665 |  0:14:46s
epoch 53 | loss: 0.57678 | train_auc: 0.77924 | train_balanced_accuracy: 0.70327 | train_accuracy: 0.70365 | valid_auc: 0.76102 | valid_balanced_accuracy: 0.6902  | valid_accuracy: 0.69059 |  0:15:02s
epoch 54 | loss: 0.56986 | train_auc: 0.78317 | train_balanced_accuracy: 0.70687 | train_accuracy: 0.70731 | valid_auc: 0.7621  | valid_balanced_accuracy: 0.68874 | valid_accuracy: 0.68917 |  0:15:20s
epoch 55 | loss: 0.57096 | train_auc: 0.78013 | train_balanced_accuracy: 0.70503 | train_accuracy: 0.70511 | valid_auc: 0.76274 | valid_balanced_accuracy: 0.69081 | valid_accuracy: 0.6909  |  0:15:37s
epoch 56 | loss: 0.57262 | train_auc: 0.7773  | train_balanced_accuracy: 0.70565 | train_accuracy: 0.70562 | valid_auc: 0.75732 | valid_balanced_accuracy: 0.68434 | valid_accuracy: 0.68429 |  0:15:53s
epoch 57 | loss: 0.57163 | train_auc: 0.76136 | train_balanced_accuracy: 0.69268 | train_accuracy: 0.69291 | valid_auc: 0.74682 | valid_balanced_accuracy: 0.67776 | valid_accuracy: 0.678   |  0:16:10s
epoch 58 | loss: 0.58089 | train_auc: 0.76108 | train_balanced_accuracy: 0.68835 | train_accuracy: 0.68819 | valid_auc: 0.74657 | valid_balanced_accuracy: 0.68019 | valid_accuracy: 0.68004 |  0:16:25s
epoch 59 | loss: 0.57753 | train_auc: 0.76211 | train_balanced_accuracy: 0.68996 | train_accuracy: 0.69047 | valid_auc: 0.74981 | valid_balanced_accuracy: 0.67824 | valid_accuracy: 0.67879 |  0:16:43s

Early stopping occurred at epoch 59 with best_epoch = 39 and best_valid_accuracy = 0.69484
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 52/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=16.8min
[CV 1/5; 53/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71515 | train_auc: 0.53839 | train_balanced_accuracy: 0.52211 | train_accuracy: 0.51977 | valid_auc: 0.54536 | valid_balanced_accuracy: 0.52229 | valid_accuracy: 0.51983 |  0:00:16s
epoch 1  | loss: 0.65681 | train_auc: 0.55876 | train_balanced_accuracy: 0.52349 | train_accuracy: 0.52107 | valid_auc: 0.5609  | valid_balanced_accuracy: 0.52926 | valid_accuracy: 0.52675 |  0:00:32s
epoch 2  | loss: 0.64269 | train_auc: 0.64336 | train_balanced_accuracy: 0.53239 | train_accuracy: 0.52973 | valid_auc: 0.64691 | valid_balanced_accuracy: 0.53312 | valid_accuracy: 0.53037 |  0:00:49s
epoch 3  | loss: 0.63264 | train_auc: 0.65316 | train_balanced_accuracy: 0.53915 | train_accuracy: 0.53642 | valid_auc: 0.6556  | valid_balanced_accuracy: 0.54008 | valid_accuracy: 0.5373  |  0:01:05s
epoch 4  | loss: 0.62125 | train_auc: 0.66818 | train_balanced_accuracy: 0.59001 | train_accuracy: 0.58843 | valid_auc: 0.67082 | valid_balanced_accuracy: 0.59112 | valid_accuracy: 0.58955 |  0:01:23s
epoch 5  | loss: 0.61887 | train_auc: 0.67193 | train_balanced_accuracy: 0.59954 | train_accuracy: 0.59823 | valid_auc: 0.67472 | valid_balanced_accuracy: 0.60263 | valid_accuracy: 0.60135 |  0:01:40s
epoch 6  | loss: 0.61729 | train_auc: 0.68004 | train_balanced_accuracy: 0.61273 | train_accuracy: 0.61173 | valid_auc: 0.68076 | valid_balanced_accuracy: 0.61763 | valid_accuracy: 0.61662 |  0:01:58s
epoch 7  | loss: 0.61434 | train_auc: 0.68908 | train_balanced_accuracy: 0.62103 | train_accuracy: 0.62034 | valid_auc: 0.68969 | valid_balanced_accuracy: 0.6203  | valid_accuracy: 0.61961 |  0:02:14s
epoch 8  | loss: 0.6073  | train_auc: 0.69036 | train_balanced_accuracy: 0.62889 | train_accuracy: 0.62876 | valid_auc: 0.6904  | valid_balanced_accuracy: 0.63201 | valid_accuracy: 0.63189 |  0:02:31s
epoch 9  | loss: 0.61271 | train_auc: 0.6932  | train_balanced_accuracy: 0.62087 | train_accuracy: 0.61991 | valid_auc: 0.69596 | valid_balanced_accuracy: 0.61904 | valid_accuracy: 0.61804 |  0:02:48s
epoch 10 | loss: 0.60388 | train_auc: 0.69506 | train_balanced_accuracy: 0.63179 | train_accuracy: 0.63179 | valid_auc: 0.6976  | valid_balanced_accuracy: 0.63566 | valid_accuracy: 0.63566 |  0:03:04s
epoch 11 | loss: 0.60453 | train_auc: 0.70921 | train_balanced_accuracy: 0.65528 | train_accuracy: 0.65595 | valid_auc: 0.70749 | valid_balanced_accuracy: 0.65129 | valid_accuracy: 0.65203 |  0:03:20s
epoch 12 | loss: 0.60336 | train_auc: 0.70878 | train_balanced_accuracy: 0.6516  | train_accuracy: 0.65206 | valid_auc: 0.70958 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65109 |  0:03:36s
epoch 13 | loss: 0.60441 | train_auc: 0.71116 | train_balanced_accuracy: 0.65093 | train_accuracy: 0.65147 | valid_auc: 0.70953 | valid_balanced_accuracy: 0.65051 | valid_accuracy: 0.65109 |  0:03:54s
epoch 14 | loss: 0.60154 | train_auc: 0.71746 | train_balanced_accuracy: 0.66102 | train_accuracy: 0.66174 | valid_auc: 0.7112  | valid_balanced_accuracy: 0.65885 | valid_accuracy: 0.65958 |  0:04:10s
epoch 15 | loss: 0.60013 | train_auc: 0.72435 | train_balanced_accuracy: 0.66425 | train_accuracy: 0.66484 | valid_auc: 0.7154  | valid_balanced_accuracy: 0.65708 | valid_accuracy: 0.6577  |  0:04:27s
epoch 16 | loss: 0.59778 | train_auc: 0.72953 | train_balanced_accuracy: 0.66712 | train_accuracy: 0.66772 | valid_auc: 0.71783 | valid_balanced_accuracy: 0.66308 | valid_accuracy: 0.66368 |  0:04:43s
epoch 17 | loss: 0.59821 | train_auc: 0.72337 | train_balanced_accuracy: 0.6655  | train_accuracy: 0.66614 | valid_auc: 0.71555 | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66226 |  0:05:03s
epoch 18 | loss: 0.59694 | train_auc: 0.72928 | train_balanced_accuracy: 0.67152 | train_accuracy: 0.67204 | valid_auc: 0.71893 | valid_balanced_accuracy: 0.66485 | valid_accuracy: 0.66541 |  0:05:20s
epoch 19 | loss: 0.59905 | train_auc: 0.73942 | train_balanced_accuracy: 0.67761 | train_accuracy: 0.67834 | valid_auc: 0.72701 | valid_balanced_accuracy: 0.67189 | valid_accuracy: 0.67265 |  0:05:38s
epoch 20 | loss: 0.59431 | train_auc: 0.7373  | train_balanced_accuracy: 0.67673 | train_accuracy: 0.6774  | valid_auc: 0.72647 | valid_balanced_accuracy: 0.66774 | valid_accuracy: 0.6684  |  0:05:55s
epoch 21 | loss: 0.5955  | train_auc: 0.73953 | train_balanced_accuracy: 0.67483 | train_accuracy: 0.67547 | valid_auc: 0.72751 | valid_balanced_accuracy: 0.66932 | valid_accuracy: 0.66997 |  0:06:12s
epoch 22 | loss: 0.59587 | train_auc: 0.74163 | train_balanced_accuracy: 0.68044 | train_accuracy: 0.6809  | valid_auc: 0.72672 | valid_balanced_accuracy: 0.66986 | valid_accuracy: 0.67029 |  0:06:27s
epoch 23 | loss: 0.59176 | train_auc: 0.74648 | train_balanced_accuracy: 0.68175 | train_accuracy: 0.68223 | valid_auc: 0.73248 | valid_balanced_accuracy: 0.67452 | valid_accuracy: 0.67501 |  0:06:45s
epoch 24 | loss: 0.59814 | train_auc: 0.74497 | train_balanced_accuracy: 0.67634 | train_accuracy: 0.67681 | valid_auc: 0.7305  | valid_balanced_accuracy: 0.66984 | valid_accuracy: 0.67029 |  0:07:03s
epoch 25 | loss: 0.58782 | train_auc: 0.75425 | train_balanced_accuracy: 0.68747 | train_accuracy: 0.68778 | valid_auc: 0.73914 | valid_balanced_accuracy: 0.67815 | valid_accuracy: 0.67847 |  0:07:18s
epoch 26 | loss: 0.59047 | train_auc: 0.74718 | train_balanced_accuracy: 0.68318 | train_accuracy: 0.68361 | valid_auc: 0.73394 | valid_balanced_accuracy: 0.67171 | valid_accuracy: 0.67218 |  0:07:34s
epoch 27 | loss: 0.59331 | train_auc: 0.75444 | train_balanced_accuracy: 0.68818 | train_accuracy: 0.68833 | valid_auc: 0.73924 | valid_balanced_accuracy: 0.66919 | valid_accuracy: 0.66934 |  0:07:51s
epoch 28 | loss: 0.59213 | train_auc: 0.75527 | train_balanced_accuracy: 0.68944 | train_accuracy: 0.68983 | valid_auc: 0.74069 | valid_balanced_accuracy: 0.67889 | valid_accuracy: 0.67926 |  0:08:07s
epoch 29 | loss: 0.58497 | train_auc: 0.75894 | train_balanced_accuracy: 0.69198 | train_accuracy: 0.69207 | valid_auc: 0.74347 | valid_balanced_accuracy: 0.68103 | valid_accuracy: 0.68115 |  0:08:23s
epoch 30 | loss: 0.58847 | train_auc: 0.75397 | train_balanced_accuracy: 0.68615 | train_accuracy: 0.68648 | valid_auc: 0.7402  | valid_balanced_accuracy: 0.67516 | valid_accuracy: 0.67548 |  0:08:39s
epoch 31 | loss: 0.58676 | train_auc: 0.75201 | train_balanced_accuracy: 0.68783 | train_accuracy: 0.68822 | valid_auc: 0.73903 | valid_balanced_accuracy: 0.67449 | valid_accuracy: 0.67485 |  0:08:56s
epoch 32 | loss: 0.59161 | train_auc: 0.75769 | train_balanced_accuracy: 0.68888 | train_accuracy: 0.68892 | valid_auc: 0.74264 | valid_balanced_accuracy: 0.6737  | valid_accuracy: 0.67375 |  0:09:13s
epoch 33 | loss: 0.59082 | train_auc: 0.75301 | train_balanced_accuracy: 0.68827 | train_accuracy: 0.68865 | valid_auc: 0.73711 | valid_balanced_accuracy: 0.67636 | valid_accuracy: 0.67674 |  0:09:30s
epoch 34 | loss: 0.58484 | train_auc: 0.75614 | train_balanced_accuracy: 0.68877 | train_accuracy: 0.68916 | valid_auc: 0.74124 | valid_balanced_accuracy: 0.68134 | valid_accuracy: 0.68178 |  0:09:49s
epoch 35 | loss: 0.58697 | train_auc: 0.75854 | train_balanced_accuracy: 0.69151 | train_accuracy: 0.69187 | valid_auc: 0.74343 | valid_balanced_accuracy: 0.68504 | valid_accuracy: 0.6854  |  0:10:07s
epoch 36 | loss: 0.58464 | train_auc: 0.76023 | train_balanced_accuracy: 0.69018 | train_accuracy: 0.68999 | valid_auc: 0.74417 | valid_balanced_accuracy: 0.68009 | valid_accuracy: 0.67989 |  0:10:23s
epoch 37 | loss: 0.58431 | train_auc: 0.75091 | train_balanced_accuracy: 0.68785 | train_accuracy: 0.68825 | valid_auc: 0.7418  | valid_balanced_accuracy: 0.67904 | valid_accuracy: 0.67941 |  0:10:39s
epoch 38 | loss: 0.57827 | train_auc: 0.75886 | train_balanced_accuracy: 0.68961 | train_accuracy: 0.68944 | valid_auc: 0.74583 | valid_balanced_accuracy: 0.67975 | valid_accuracy: 0.67957 |  0:10:55s
epoch 39 | loss: 0.58178 | train_auc: 0.7633  | train_balanced_accuracy: 0.69229 | train_accuracy: 0.69231 | valid_auc: 0.74457 | valid_balanced_accuracy: 0.67734 | valid_accuracy: 0.67737 |  0:11:12s
epoch 40 | loss: 0.58315 | train_auc: 0.76617 | train_balanced_accuracy: 0.69802 | train_accuracy: 0.69805 | valid_auc: 0.74788 | valid_balanced_accuracy: 0.68396 | valid_accuracy: 0.68398 |  0:11:26s
epoch 41 | loss: 0.58217 | train_auc: 0.76059 | train_balanced_accuracy: 0.69132 | train_accuracy: 0.69117 | valid_auc: 0.74395 | valid_balanced_accuracy: 0.68054 | valid_accuracy: 0.68036 |  0:11:42s
epoch 42 | loss: 0.58212 | train_auc: 0.75678 | train_balanced_accuracy: 0.69443 | train_accuracy: 0.69479 | valid_auc: 0.74305 | valid_balanced_accuracy: 0.68632 | valid_accuracy: 0.68665 |  0:11:57s
epoch 43 | loss: 0.58595 | train_auc: 0.75537 | train_balanced_accuracy: 0.68489 | train_accuracy: 0.68491 | valid_auc: 0.74397 | valid_balanced_accuracy: 0.67439 | valid_accuracy: 0.67438 |  0:12:13s
epoch 44 | loss: 0.57931 | train_auc: 0.75928 | train_balanced_accuracy: 0.6931  | train_accuracy: 0.69313 | valid_auc: 0.74589 | valid_balanced_accuracy: 0.68    | valid_accuracy: 0.68004 |  0:12:31s
epoch 45 | loss: 0.57973 | train_auc: 0.76617 | train_balanced_accuracy: 0.69693 | train_accuracy: 0.6973  | valid_auc: 0.74564 | valid_balanced_accuracy: 0.6833  | valid_accuracy: 0.68366 |  0:12:47s
epoch 46 | loss: 0.57756 | train_auc: 0.76528 | train_balanced_accuracy: 0.69701 | train_accuracy: 0.69699 | valid_auc: 0.74488 | valid_balanced_accuracy: 0.68058 | valid_accuracy: 0.68052 |  0:13:05s
epoch 47 | loss: 0.57936 | train_auc: 0.76925 | train_balanced_accuracy: 0.69668 | train_accuracy: 0.69715 | valid_auc: 0.74529 | valid_balanced_accuracy: 0.67942 | valid_accuracy: 0.67989 |  0:13:21s
epoch 48 | loss: 0.57335 | train_auc: 0.768   | train_balanced_accuracy: 0.69614 | train_accuracy: 0.69628 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.68869 | valid_accuracy: 0.68886 |  0:13:38s
epoch 49 | loss: 0.57989 | train_auc: 0.77063 | train_balanced_accuracy: 0.69818 | train_accuracy: 0.69852 | valid_auc: 0.7531  | valid_balanced_accuracy: 0.68944 | valid_accuracy: 0.6898  |  0:13:55s
epoch 50 | loss: 0.57591 | train_auc: 0.76725 | train_balanced_accuracy: 0.69945 | train_accuracy: 0.69951 | valid_auc: 0.74924 | valid_balanced_accuracy: 0.68312 | valid_accuracy: 0.68319 |  0:14:11s
epoch 51 | loss: 0.57276 | train_auc: 0.76715 | train_balanced_accuracy: 0.69638 | train_accuracy: 0.69687 | valid_auc: 0.74734 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.68571 |  0:14:27s
epoch 52 | loss: 0.57512 | train_auc: 0.76104 | train_balanced_accuracy: 0.69309 | train_accuracy: 0.69337 | valid_auc: 0.74272 | valid_balanced_accuracy: 0.68279 | valid_accuracy: 0.68303 |  0:14:45s
epoch 53 | loss: 0.5796  | train_auc: 0.76685 | train_balanced_accuracy: 0.69692 | train_accuracy: 0.69734 | valid_auc: 0.74864 | valid_balanced_accuracy: 0.68734 | valid_accuracy: 0.68776 |  0:15:00s
epoch 54 | loss: 0.57129 | train_auc: 0.7659  | train_balanced_accuracy: 0.69513 | train_accuracy: 0.69534 | valid_auc: 0.74968 | valid_balanced_accuracy: 0.68364 | valid_accuracy: 0.68382 |  0:15:17s
epoch 55 | loss: 0.5764  | train_auc: 0.77102 | train_balanced_accuracy: 0.6996  | train_accuracy: 0.6997  | valid_auc: 0.75026 | valid_balanced_accuracy: 0.68441 | valid_accuracy: 0.68445 |  0:15:33s
epoch 56 | loss: 0.5709  | train_auc: 0.77584 | train_balanced_accuracy: 0.70309 | train_accuracy: 0.70329 | valid_auc: 0.75269 | valid_balanced_accuracy: 0.68505 | valid_accuracy: 0.68524 |  0:15:48s
epoch 57 | loss: 0.57301 | train_auc: 0.77515 | train_balanced_accuracy: 0.70341 | train_accuracy: 0.70348 | valid_auc: 0.74849 | valid_balanced_accuracy: 0.67905 | valid_accuracy: 0.6791  |  0:16:02s
epoch 58 | loss: 0.5747  | train_auc: 0.77269 | train_balanced_accuracy: 0.70034 | train_accuracy: 0.70057 | valid_auc: 0.7474  | valid_balanced_accuracy: 0.67986 | valid_accuracy: 0.68004 |  0:16:19s
epoch 59 | loss: 0.57385 | train_auc: 0.77285 | train_balanced_accuracy: 0.70158 | train_accuracy: 0.70148 | valid_auc: 0.75135 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68256 |  0:16:35s
epoch 60 | loss: 0.5735  | train_auc: 0.77754 | train_balanced_accuracy: 0.70612 | train_accuracy: 0.7062  | valid_auc: 0.75314 | valid_balanced_accuracy: 0.68736 | valid_accuracy: 0.68744 |  0:16:52s
epoch 61 | loss: 0.57091 | train_auc: 0.77385 | train_balanced_accuracy: 0.70133 | train_accuracy: 0.70151 | valid_auc: 0.75132 | valid_balanced_accuracy: 0.68648 | valid_accuracy: 0.68665 |  0:17:09s
epoch 62 | loss: 0.56677 | train_auc: 0.77573 | train_balanced_accuracy: 0.70307 | train_accuracy: 0.70301 | valid_auc: 0.7528  | valid_balanced_accuracy: 0.68478 | valid_accuracy: 0.68477 |  0:17:26s
epoch 63 | loss: 0.57129 | train_auc: 0.77899 | train_balanced_accuracy: 0.70589 | train_accuracy: 0.70592 | valid_auc: 0.75255 | valid_balanced_accuracy: 0.68679 | valid_accuracy: 0.68681 |  0:17:44s
epoch 64 | loss: 0.56887 | train_auc: 0.78028 | train_balanced_accuracy: 0.70638 | train_accuracy: 0.70632 | valid_auc: 0.75437 | valid_balanced_accuracy: 0.68795 | valid_accuracy: 0.68791 |  0:17:59s
epoch 65 | loss: 0.56721 | train_auc: 0.77889 | train_balanced_accuracy: 0.7082  | train_accuracy: 0.70836 | valid_auc: 0.75461 | valid_balanced_accuracy: 0.68793 | valid_accuracy: 0.68807 |  0:18:14s
epoch 66 | loss: 0.56928 | train_auc: 0.77831 | train_balanced_accuracy: 0.70757 | train_accuracy: 0.70765 | valid_auc: 0.75609 | valid_balanced_accuracy: 0.68598 | valid_accuracy: 0.68602 |  0:18:33s
epoch 67 | loss: 0.56793 | train_auc: 0.78176 | train_balanced_accuracy: 0.70996 | train_accuracy: 0.71013 | valid_auc: 0.7572  | valid_balanced_accuracy: 0.68998 | valid_accuracy: 0.69012 |  0:18:50s
epoch 68 | loss: 0.56818 | train_auc: 0.77602 | train_balanced_accuracy: 0.70454 | train_accuracy: 0.7049  | valid_auc: 0.74706 | valid_balanced_accuracy: 0.67953 | valid_accuracy: 0.67989 |  0:19:06s
epoch 69 | loss: 0.5687  | train_auc: 0.76823 | train_balanced_accuracy: 0.69788 | train_accuracy: 0.69837 | valid_auc: 0.7416  | valid_balanced_accuracy: 0.67469 | valid_accuracy: 0.67517 |  0:19:21s
epoch 70 | loss: 0.56361 | train_auc: 0.7744  | train_balanced_accuracy: 0.70358 | train_accuracy: 0.70392 | valid_auc: 0.74521 | valid_balanced_accuracy: 0.68096 | valid_accuracy: 0.6813  |  0:19:38s
epoch 71 | loss: 0.56949 | train_auc: 0.78308 | train_balanced_accuracy: 0.70858 | train_accuracy: 0.70875 | valid_auc: 0.75366 | valid_balanced_accuracy: 0.69039 | valid_accuracy: 0.69059 |  0:19:54s
epoch 72 | loss: 0.56206 | train_auc: 0.78426 | train_balanced_accuracy: 0.70973 | train_accuracy: 0.70986 | valid_auc: 0.75355 | valid_balanced_accuracy: 0.69139 | valid_accuracy: 0.69153 |  0:20:11s
epoch 73 | loss: 0.56138 | train_auc: 0.78248 | train_balanced_accuracy: 0.70786 | train_accuracy: 0.70793 | valid_auc: 0.75113 | valid_balanced_accuracy: 0.68074 | valid_accuracy: 0.68083 |  0:20:28s
epoch 74 | loss: 0.56402 | train_auc: 0.78549 | train_balanced_accuracy: 0.70931 | train_accuracy: 0.7097  | valid_auc: 0.7564  | valid_balanced_accuracy: 0.68958 | valid_accuracy: 0.68996 |  0:20:45s
epoch 75 | loss: 0.56888 | train_auc: 0.78677 | train_balanced_accuracy: 0.71322 | train_accuracy: 0.71332 | valid_auc: 0.75822 | valid_balanced_accuracy: 0.69015 | valid_accuracy: 0.69027 |  0:21:02s
epoch 76 | loss: 0.56807 | train_auc: 0.78563 | train_balanced_accuracy: 0.7091  | train_accuracy: 0.70899 | valid_auc: 0.75311 | valid_balanced_accuracy: 0.68472 | valid_accuracy: 0.68461 |  0:21:19s
epoch 77 | loss: 0.56549 | train_auc: 0.78669 | train_balanced_accuracy: 0.70989 | train_accuracy: 0.70962 | valid_auc: 0.75579 | valid_balanced_accuracy: 0.68723 | valid_accuracy: 0.68697 |  0:21:37s
epoch 78 | loss: 0.55762 | train_auc: 0.78311 | train_balanced_accuracy: 0.70834 | train_accuracy: 0.7084  | valid_auc: 0.75051 | valid_balanced_accuracy: 0.68631 | valid_accuracy: 0.68634 |  0:21:54s
epoch 79 | loss: 0.56488 | train_auc: 0.75092 | train_balanced_accuracy: 0.67869 | train_accuracy: 0.67861 | valid_auc: 0.73438 | valid_balanced_accuracy: 0.66182 | valid_accuracy: 0.66179 |  0:22:10s
epoch 80 | loss: 0.56786 | train_auc: 0.76451 | train_balanced_accuracy: 0.68953 | train_accuracy: 0.6894  | valid_auc: 0.74482 | valid_balanced_accuracy: 0.67814 | valid_accuracy: 0.678   |  0:22:28s
epoch 81 | loss: 0.55719 | train_auc: 0.75802 | train_balanced_accuracy: 0.68498 | train_accuracy: 0.68495 | valid_auc: 0.73947 | valid_balanced_accuracy: 0.67002 | valid_accuracy: 0.66997 |  0:22:45s
epoch 82 | loss: 0.56473 | train_auc: 0.76925 | train_balanced_accuracy: 0.69701 | train_accuracy: 0.69715 | valid_auc: 0.74597 | valid_balanced_accuracy: 0.67475 | valid_accuracy: 0.67485 |  0:23:03s
epoch 83 | loss: 0.56105 | train_auc: 0.7553  | train_balanced_accuracy: 0.68248 | train_accuracy: 0.68255 | valid_auc: 0.74181 | valid_balanced_accuracy: 0.6789  | valid_accuracy: 0.67894 |  0:23:21s
epoch 84 | loss: 0.56297 | train_auc: 0.76123 | train_balanced_accuracy: 0.6864  | train_accuracy: 0.68637 | valid_auc: 0.74077 | valid_balanced_accuracy: 0.67895 | valid_accuracy: 0.67894 |  0:23:37s
epoch 85 | loss: 0.56261 | train_auc: 0.78814 | train_balanced_accuracy: 0.71118 | train_accuracy: 0.71143 | valid_auc: 0.75656 | valid_balanced_accuracy: 0.68768 | valid_accuracy: 0.68791 |  0:23:54s
epoch 86 | loss: 0.56333 | train_auc: 0.77742 | train_balanced_accuracy: 0.70349 | train_accuracy: 0.7036  | valid_auc: 0.74428 | valid_balanced_accuracy: 0.68388 | valid_accuracy: 0.68398 |  0:24:08s
epoch 87 | loss: 0.55702 | train_auc: 0.78492 | train_balanced_accuracy: 0.70998 | train_accuracy: 0.71001 | valid_auc: 0.74937 | valid_balanced_accuracy: 0.68395 | valid_accuracy: 0.68398 |  0:24:24s
epoch 88 | loss: 0.56044 | train_auc: 0.75883 | train_balanced_accuracy: 0.68455 | train_accuracy: 0.68408 | valid_auc: 0.73404 | valid_balanced_accuracy: 0.66572 | valid_accuracy: 0.66525 |  0:24:39s
epoch 89 | loss: 0.56129 | train_auc: 0.77954 | train_balanced_accuracy: 0.70363 | train_accuracy: 0.70392 | valid_auc: 0.74362 | valid_balanced_accuracy: 0.67787 | valid_accuracy: 0.67816 |  0:24:58s
epoch 90 | loss: 0.56139 | train_auc: 0.74585 | train_balanced_accuracy: 0.67207 | train_accuracy: 0.67204 | valid_auc: 0.73226 | valid_balanced_accuracy: 0.66453 | valid_accuracy: 0.66446 |  0:25:15s
epoch 91 | loss: 0.55334 | train_auc: 0.74563 | train_balanced_accuracy: 0.67454 | train_accuracy: 0.67437 | valid_auc: 0.73085 | valid_balanced_accuracy: 0.66564 | valid_accuracy: 0.66541 |  0:25:32s
epoch 92 | loss: 0.55764 | train_auc: 0.7723  | train_balanced_accuracy: 0.69765 | train_accuracy: 0.69793 | valid_auc: 0.75018 | valid_balanced_accuracy: 0.68355 | valid_accuracy: 0.68382 |  0:25:50s

Early stopping occurred at epoch 92 with best_epoch = 72 and best_valid_accuracy = 0.69153
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 53/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.699 total time=26.0min
[CV 2/5; 53/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71088 | train_auc: 0.56616 | train_balanced_accuracy: 0.53386 | train_accuracy: 0.53165 | valid_auc: 0.57034 | valid_balanced_accuracy: 0.53233 | valid_accuracy: 0.53006 |  0:00:16s
epoch 1  | loss: 0.65897 | train_auc: 0.59095 | train_balanced_accuracy: 0.52386 | train_accuracy: 0.52083 | valid_auc: 0.6016  | valid_balanced_accuracy: 0.52337 | valid_accuracy: 0.5203  |  0:00:33s
epoch 2  | loss: 0.6411  | train_auc: 0.63936 | train_balanced_accuracy: 0.53079 | train_accuracy: 0.52776 | valid_auc: 0.64096 | valid_balanced_accuracy: 0.52903 | valid_accuracy: 0.52597 |  0:00:48s
epoch 3  | loss: 0.63353 | train_auc: 0.63812 | train_balanced_accuracy: 0.53735 | train_accuracy: 0.53449 | valid_auc: 0.64034 | valid_balanced_accuracy: 0.54175 | valid_accuracy: 0.53887 |  0:01:05s
epoch 4  | loss: 0.62579 | train_auc: 0.6549  | train_balanced_accuracy: 0.54595 | train_accuracy: 0.5431  | valid_auc: 0.66016 | valid_balanced_accuracy: 0.54349 | valid_accuracy: 0.5406  |  0:01:22s
epoch 5  | loss: 0.62251 | train_auc: 0.67114 | train_balanced_accuracy: 0.56492 | train_accuracy: 0.56258 | valid_auc: 0.67235 | valid_balanced_accuracy: 0.55995 | valid_accuracy: 0.5576  |  0:01:42s
epoch 6  | loss: 0.61844 | train_auc: 0.6825  | train_balanced_accuracy: 0.5746  | train_accuracy: 0.57258 | valid_auc: 0.68833 | valid_balanced_accuracy: 0.57606 | valid_accuracy: 0.57397 |  0:01:59s
epoch 7  | loss: 0.61479 | train_auc: 0.68538 | train_balanced_accuracy: 0.59416 | train_accuracy: 0.59241 | valid_auc: 0.68936 | valid_balanced_accuracy: 0.58904 | valid_accuracy: 0.58719 |  0:02:15s
epoch 8  | loss: 0.60412 | train_auc: 0.69299 | train_balanced_accuracy: 0.62848 | train_accuracy: 0.62766 | valid_auc: 0.69701 | valid_balanced_accuracy: 0.62537 | valid_accuracy: 0.62449 |  0:02:32s
epoch 9  | loss: 0.61013 | train_auc: 0.69495 | train_balanced_accuracy: 0.58756 | train_accuracy: 0.58552 | valid_auc: 0.69124 | valid_balanced_accuracy: 0.57469 | valid_accuracy: 0.57255 |  0:02:48s
epoch 10 | loss: 0.6018  | train_auc: 0.7054  | train_balanced_accuracy: 0.63195 | train_accuracy: 0.63093 | valid_auc: 0.70187 | valid_balanced_accuracy: 0.62586 | valid_accuracy: 0.6248  |  0:03:04s
epoch 11 | loss: 0.60544 | train_auc: 0.71442 | train_balanced_accuracy: 0.6466  | train_accuracy: 0.64592 | valid_auc: 0.71238 | valid_balanced_accuracy: 0.6444  | valid_accuracy: 0.64369 |  0:03:20s
epoch 12 | loss: 0.60376 | train_auc: 0.7149  | train_balanced_accuracy: 0.65425 | train_accuracy: 0.65398 | valid_auc: 0.7114  | valid_balanced_accuracy: 0.65546 | valid_accuracy: 0.65518 |  0:03:37s
epoch 13 | loss: 0.59889 | train_auc: 0.72065 | train_balanced_accuracy: 0.66252 | train_accuracy: 0.66268 | valid_auc: 0.71604 | valid_balanced_accuracy: 0.66143 | valid_accuracy: 0.66163 |  0:03:52s
epoch 14 | loss: 0.59892 | train_auc: 0.72185 | train_balanced_accuracy: 0.66258 | train_accuracy: 0.6626  | valid_auc: 0.71707 | valid_balanced_accuracy: 0.66142 | valid_accuracy: 0.66147 |  0:04:08s
epoch 15 | loss: 0.59774 | train_auc: 0.72311 | train_balanced_accuracy: 0.66004 | train_accuracy: 0.65989 | valid_auc: 0.71952 | valid_balanced_accuracy: 0.65799 | valid_accuracy: 0.65785 |  0:04:26s
epoch 16 | loss: 0.596   | train_auc: 0.72157 | train_balanced_accuracy: 0.65832 | train_accuracy: 0.65843 | valid_auc: 0.72012 | valid_balanced_accuracy: 0.66013 | valid_accuracy: 0.66021 |  0:04:43s
epoch 17 | loss: 0.5959  | train_auc: 0.72356 | train_balanced_accuracy: 0.65727 | train_accuracy: 0.65709 | valid_auc: 0.71902 | valid_balanced_accuracy: 0.6524  | valid_accuracy: 0.65219 |  0:05:01s
epoch 18 | loss: 0.59622 | train_auc: 0.73041 | train_balanced_accuracy: 0.66825 | train_accuracy: 0.66866 | valid_auc: 0.72694 | valid_balanced_accuracy: 0.66261 | valid_accuracy: 0.66305 |  0:05:17s
epoch 19 | loss: 0.59507 | train_auc: 0.72461 | train_balanced_accuracy: 0.65795 | train_accuracy: 0.658   | valid_auc: 0.72225 | valid_balanced_accuracy: 0.65655 | valid_accuracy: 0.65659 |  0:05:36s
epoch 20 | loss: 0.59314 | train_auc: 0.71757 | train_balanced_accuracy: 0.65271 | train_accuracy: 0.65269 | valid_auc: 0.71781 | valid_balanced_accuracy: 0.6532  | valid_accuracy: 0.65313 |  0:05:52s
epoch 21 | loss: 0.59473 | train_auc: 0.72738 | train_balanced_accuracy: 0.66317 | train_accuracy: 0.66347 | valid_auc: 0.72634 | valid_balanced_accuracy: 0.65946 | valid_accuracy: 0.65974 |  0:06:07s
epoch 22 | loss: 0.59706 | train_auc: 0.74015 | train_balanced_accuracy: 0.67831 | train_accuracy: 0.6785  | valid_auc: 0.73436 | valid_balanced_accuracy: 0.67498 | valid_accuracy: 0.67517 |  0:06:25s
epoch 23 | loss: 0.59007 | train_auc: 0.73162 | train_balanced_accuracy: 0.67089 | train_accuracy: 0.67141 | valid_auc: 0.72716 | valid_balanced_accuracy: 0.66931 | valid_accuracy: 0.66981 |  0:06:40s
epoch 24 | loss: 0.59458 | train_auc: 0.74232 | train_balanced_accuracy: 0.67586 | train_accuracy: 0.67614 | valid_auc: 0.73668 | valid_balanced_accuracy: 0.67492 | valid_accuracy: 0.67517 |  0:06:58s
epoch 25 | loss: 0.58569 | train_auc: 0.75844 | train_balanced_accuracy: 0.68944 | train_accuracy: 0.68936 | valid_auc: 0.74661 | valid_balanced_accuracy: 0.68081 | valid_accuracy: 0.68067 |  0:07:14s
epoch 26 | loss: 0.58702 | train_auc: 0.75591 | train_balanced_accuracy: 0.68752 | train_accuracy: 0.68786 | valid_auc: 0.7462  | valid_balanced_accuracy: 0.68725 | valid_accuracy: 0.6876  |  0:07:29s
epoch 27 | loss: 0.59153 | train_auc: 0.75506 | train_balanced_accuracy: 0.6866  | train_accuracy: 0.6868  | valid_auc: 0.743   | valid_balanced_accuracy: 0.68572 | valid_accuracy: 0.68587 |  0:07:44s
epoch 28 | loss: 0.58584 | train_auc: 0.7612  | train_balanced_accuracy: 0.69149 | train_accuracy: 0.69207 | valid_auc: 0.74808 | valid_balanced_accuracy: 0.68816 | valid_accuracy: 0.6887  |  0:08:00s
epoch 29 | loss: 0.58724 | train_auc: 0.76143 | train_balanced_accuracy: 0.69206 | train_accuracy: 0.69215 | valid_auc: 0.7487  | valid_balanced_accuracy: 0.68579 | valid_accuracy: 0.68587 |  0:08:17s
epoch 30 | loss: 0.58327 | train_auc: 0.76029 | train_balanced_accuracy: 0.69223 | train_accuracy: 0.69254 | valid_auc: 0.74639 | valid_balanced_accuracy: 0.6804  | valid_accuracy: 0.68067 |  0:08:34s
epoch 31 | loss: 0.5896  | train_auc: 0.76139 | train_balanced_accuracy: 0.69222 | train_accuracy: 0.69243 | valid_auc: 0.74688 | valid_balanced_accuracy: 0.68287 | valid_accuracy: 0.68303 |  0:08:49s
epoch 32 | loss: 0.58634 | train_auc: 0.76275 | train_balanced_accuracy: 0.69444 | train_accuracy: 0.69475 | valid_auc: 0.7473  | valid_balanced_accuracy: 0.6878  | valid_accuracy: 0.68807 |  0:09:04s
epoch 33 | loss: 0.58466 | train_auc: 0.761   | train_balanced_accuracy: 0.69441 | train_accuracy: 0.69463 | valid_auc: 0.74544 | valid_balanced_accuracy: 0.68715 | valid_accuracy: 0.68728 |  0:09:20s
epoch 34 | loss: 0.58066 | train_auc: 0.71738 | train_balanced_accuracy: 0.66612 | train_accuracy: 0.66677 | valid_auc: 0.71453 | valid_balanced_accuracy: 0.66447 | valid_accuracy: 0.66509 |  0:09:36s
epoch 35 | loss: 0.58133 | train_auc: 0.74028 | train_balanced_accuracy: 0.6782  | train_accuracy: 0.67873 | valid_auc: 0.73284 | valid_balanced_accuracy: 0.66977 | valid_accuracy: 0.67029 |  0:09:55s
epoch 36 | loss: 0.57954 | train_auc: 0.73406 | train_balanced_accuracy: 0.66662 | train_accuracy: 0.66642 | valid_auc: 0.72429 | valid_balanced_accuracy: 0.65426 | valid_accuracy: 0.65408 |  0:10:14s
epoch 37 | loss: 0.58302 | train_auc: 0.74127 | train_balanced_accuracy: 0.67491 | train_accuracy: 0.67492 | valid_auc: 0.73512 | valid_balanced_accuracy: 0.66652 | valid_accuracy: 0.66651 |  0:10:30s
epoch 38 | loss: 0.58052 | train_auc: 0.76396 | train_balanced_accuracy: 0.69816 | train_accuracy: 0.69829 | valid_auc: 0.74899 | valid_balanced_accuracy: 0.68437 | valid_accuracy: 0.68445 |  0:10:47s
epoch 39 | loss: 0.58141 | train_auc: 0.72196 | train_balanced_accuracy: 0.66499 | train_accuracy: 0.66484 | valid_auc: 0.72011 | valid_balanced_accuracy: 0.6583  | valid_accuracy: 0.65817 |  0:11:04s
epoch 40 | loss: 0.58561 | train_auc: 0.72503 | train_balanced_accuracy: 0.66049 | train_accuracy: 0.66036 | valid_auc: 0.71957 | valid_balanced_accuracy: 0.65359 | valid_accuracy: 0.65345 |  0:11:21s
epoch 41 | loss: 0.58179 | train_auc: 0.73719 | train_balanced_accuracy: 0.66895 | train_accuracy: 0.66882 | valid_auc: 0.72339 | valid_balanced_accuracy: 0.65341 | valid_accuracy: 0.65329 |  0:11:39s
epoch 42 | loss: 0.57647 | train_auc: 0.76943 | train_balanced_accuracy: 0.70155 | train_accuracy: 0.70171 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.68746 | valid_accuracy: 0.6876  |  0:11:54s
epoch 43 | loss: 0.58503 | train_auc: 0.76117 | train_balanced_accuracy: 0.69535 | train_accuracy: 0.69565 | valid_auc: 0.74892 | valid_balanced_accuracy: 0.68846 | valid_accuracy: 0.6887  |  0:12:11s
epoch 44 | loss: 0.57892 | train_auc: 0.73947 | train_balanced_accuracy: 0.68185 | train_accuracy: 0.68239 | valid_auc: 0.73089 | valid_balanced_accuracy: 0.67956 | valid_accuracy: 0.68004 |  0:12:28s
epoch 45 | loss: 0.57686 | train_auc: 0.75962 | train_balanced_accuracy: 0.69077 | train_accuracy: 0.69156 | valid_auc: 0.74444 | valid_balanced_accuracy: 0.68401 | valid_accuracy: 0.68477 |  0:12:44s
epoch 46 | loss: 0.57447 | train_auc: 0.7031  | train_balanced_accuracy: 0.65972 | train_accuracy: 0.66075 | valid_auc: 0.70457 | valid_balanced_accuracy: 0.67056 | valid_accuracy: 0.67155 |  0:13:00s
epoch 47 | loss: 0.57836 | train_auc: 0.72624 | train_balanced_accuracy: 0.66555 | train_accuracy: 0.66563 | valid_auc: 0.7211  | valid_balanced_accuracy: 0.66217 | valid_accuracy: 0.66226 |  0:13:16s
epoch 48 | loss: 0.57449 | train_auc: 0.71894 | train_balanced_accuracy: 0.65721 | train_accuracy: 0.65693 | valid_auc: 0.71534 | valid_balanced_accuracy: 0.65262 | valid_accuracy: 0.65234 |  0:13:35s

Early stopping occurred at epoch 48 with best_epoch = 28 and best_valid_accuracy = 0.6887
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 53/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.678 total time=13.7min
[CV 3/5; 53/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.72152 | train_auc: 0.55289 | train_balanced_accuracy: 0.52924 | train_accuracy: 0.53006 | valid_auc: 0.55214 | valid_balanced_accuracy: 0.52874 | valid_accuracy: 0.52959 |  0:00:16s
epoch 1  | loss: 0.66928 | train_auc: 0.54101 | train_balanced_accuracy: 0.52432 | train_accuracy: 0.52251 | valid_auc: 0.54702 | valid_balanced_accuracy: 0.52672 | valid_accuracy: 0.52487 |  0:00:33s
epoch 2  | loss: 0.64925 | train_auc: 0.62748 | train_balanced_accuracy: 0.54016 | train_accuracy: 0.53757 | valid_auc: 0.62598 | valid_balanced_accuracy: 0.54009 | valid_accuracy: 0.53746 |  0:00:49s
epoch 3  | loss: 0.63883 | train_auc: 0.63307 | train_balanced_accuracy: 0.53756 | train_accuracy: 0.53494 | valid_auc: 0.63753 | valid_balanced_accuracy: 0.54137 | valid_accuracy: 0.53872 |  0:01:07s
epoch 4  | loss: 0.62709 | train_auc: 0.65233 | train_balanced_accuracy: 0.56406 | train_accuracy: 0.56173 | valid_auc: 0.64794 | valid_balanced_accuracy: 0.55931 | valid_accuracy: 0.55697 |  0:01:24s
epoch 5  | loss: 0.62151 | train_auc: 0.67378 | train_balanced_accuracy: 0.59587 | train_accuracy: 0.59423 | valid_auc: 0.66292 | valid_balanced_accuracy: 0.59089 | valid_accuracy: 0.58924 |  0:01:41s
epoch 6  | loss: 0.62058 | train_auc: 0.68898 | train_balanced_accuracy: 0.62565 | train_accuracy: 0.62476 | valid_auc: 0.68102 | valid_balanced_accuracy: 0.61736 | valid_accuracy: 0.61646 |  0:01:58s
epoch 7  | loss: 0.62021 | train_auc: 0.68867 | train_balanced_accuracy: 0.63359 | train_accuracy: 0.63311 | valid_auc: 0.68098 | valid_balanced_accuracy: 0.62859 | valid_accuracy: 0.62811 |  0:02:17s
epoch 8  | loss: 0.61296 | train_auc: 0.69633 | train_balanced_accuracy: 0.6351  | train_accuracy: 0.63539 | valid_auc: 0.69164 | valid_balanced_accuracy: 0.63683 | valid_accuracy: 0.63708 |  0:02:32s
epoch 9  | loss: 0.61319 | train_auc: 0.69369 | train_balanced_accuracy: 0.6352  | train_accuracy: 0.63519 | valid_auc: 0.69047 | valid_balanced_accuracy: 0.63506 | valid_accuracy: 0.63503 |  0:02:50s
epoch 10 | loss: 0.60517 | train_auc: 0.70058 | train_balanced_accuracy: 0.63856 | train_accuracy: 0.63838 | valid_auc: 0.69439 | valid_balanced_accuracy: 0.63447 | valid_accuracy: 0.63425 |  0:03:07s
epoch 11 | loss: 0.60709 | train_auc: 0.70869 | train_balanced_accuracy: 0.64852 | train_accuracy: 0.64861 | valid_auc: 0.70366 | valid_balanced_accuracy: 0.64285 | valid_accuracy: 0.6429  |  0:03:22s
epoch 12 | loss: 0.60511 | train_auc: 0.7142  | train_balanced_accuracy: 0.65277 | train_accuracy: 0.65317 | valid_auc: 0.70702 | valid_balanced_accuracy: 0.64819 | valid_accuracy: 0.64857 |  0:03:39s
epoch 13 | loss: 0.60159 | train_auc: 0.71302 | train_balanced_accuracy: 0.6498  | train_accuracy: 0.64994 | valid_auc: 0.70435 | valid_balanced_accuracy: 0.64606 | valid_accuracy: 0.64621 |  0:03:55s
epoch 14 | loss: 0.59913 | train_auc: 0.72604 | train_balanced_accuracy: 0.66058 | train_accuracy: 0.66073 | valid_auc: 0.71857 | valid_balanced_accuracy: 0.65444 | valid_accuracy: 0.65455 |  0:04:12s
epoch 15 | loss: 0.60062 | train_auc: 0.724   | train_balanced_accuracy: 0.66168 | train_accuracy: 0.66195 | valid_auc: 0.71541 | valid_balanced_accuracy: 0.65747 | valid_accuracy: 0.6577  |  0:04:28s
epoch 16 | loss: 0.5963  | train_auc: 0.72823 | train_balanced_accuracy: 0.66519 | train_accuracy: 0.66513 | valid_auc: 0.72102 | valid_balanced_accuracy: 0.6625  | valid_accuracy: 0.66242 |  0:04:45s
epoch 17 | loss: 0.59382 | train_auc: 0.73176 | train_balanced_accuracy: 0.66759 | train_accuracy: 0.668   | valid_auc: 0.72371 | valid_balanced_accuracy: 0.66455 | valid_accuracy: 0.66494 |  0:05:04s
epoch 18 | loss: 0.60048 | train_auc: 0.73693 | train_balanced_accuracy: 0.67397 | train_accuracy: 0.67469 | valid_auc: 0.72771 | valid_balanced_accuracy: 0.67144 | valid_accuracy: 0.67218 |  0:05:20s
epoch 19 | loss: 0.59525 | train_auc: 0.738   | train_balanced_accuracy: 0.67104 | train_accuracy: 0.67147 | valid_auc: 0.72842 | valid_balanced_accuracy: 0.67457 | valid_accuracy: 0.67501 |  0:05:38s
epoch 20 | loss: 0.59528 | train_auc: 0.7439  | train_balanced_accuracy: 0.68246 | train_accuracy: 0.68307 | valid_auc: 0.73156 | valid_balanced_accuracy: 0.67628 | valid_accuracy: 0.6769  |  0:05:55s
epoch 21 | loss: 0.5892  | train_auc: 0.74718 | train_balanced_accuracy: 0.68195 | train_accuracy: 0.68217 | valid_auc: 0.73473 | valid_balanced_accuracy: 0.67496 | valid_accuracy: 0.67517 |  0:06:12s
epoch 22 | loss: 0.59643 | train_auc: 0.75165 | train_balanced_accuracy: 0.68693 | train_accuracy: 0.68736 | valid_auc: 0.73873 | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.67847 |  0:06:27s
epoch 23 | loss: 0.59301 | train_auc: 0.75332 | train_balanced_accuracy: 0.68936 | train_accuracy: 0.68957 | valid_auc: 0.74333 | valid_balanced_accuracy: 0.67894 | valid_accuracy: 0.6791  |  0:06:46s
epoch 24 | loss: 0.59505 | train_auc: 0.74783 | train_balanced_accuracy: 0.68398 | train_accuracy: 0.68457 | valid_auc: 0.73714 | valid_balanced_accuracy: 0.67852 | valid_accuracy: 0.6791  |  0:07:02s
epoch 25 | loss: 0.58962 | train_auc: 0.75415 | train_balanced_accuracy: 0.684   | train_accuracy: 0.6839  | valid_auc: 0.74048 | valid_balanced_accuracy: 0.67733 | valid_accuracy: 0.67721 |  0:07:19s
epoch 26 | loss: 0.5893  | train_auc: 0.75589 | train_balanced_accuracy: 0.69181 | train_accuracy: 0.69212 | valid_auc: 0.74415 | valid_balanced_accuracy: 0.68396 | valid_accuracy: 0.68429 |  0:07:37s
epoch 27 | loss: 0.58715 | train_auc: 0.75856 | train_balanced_accuracy: 0.69285 | train_accuracy: 0.69303 | valid_auc: 0.74558 | valid_balanced_accuracy: 0.68114 | valid_accuracy: 0.6813  |  0:07:53s
epoch 28 | loss: 0.58407 | train_auc: 0.75808 | train_balanced_accuracy: 0.69419 | train_accuracy: 0.69452 | valid_auc: 0.74061 | valid_balanced_accuracy: 0.68047 | valid_accuracy: 0.68083 |  0:08:10s
epoch 29 | loss: 0.58738 | train_auc: 0.7591  | train_balanced_accuracy: 0.69206 | train_accuracy: 0.6922  | valid_auc: 0.74221 | valid_balanced_accuracy: 0.68429 | valid_accuracy: 0.68445 |  0:08:26s
epoch 30 | loss: 0.58761 | train_auc: 0.75936 | train_balanced_accuracy: 0.69589 | train_accuracy: 0.69618 | valid_auc: 0.74135 | valid_balanced_accuracy: 0.68824 | valid_accuracy: 0.68854 |  0:08:45s
epoch 31 | loss: 0.5884  | train_auc: 0.75916 | train_balanced_accuracy: 0.69435 | train_accuracy: 0.69437 | valid_auc: 0.74342 | valid_balanced_accuracy: 0.6862  | valid_accuracy: 0.68618 |  0:09:01s
epoch 32 | loss: 0.58325 | train_auc: 0.76095 | train_balanced_accuracy: 0.69295 | train_accuracy: 0.69322 | valid_auc: 0.74222 | valid_balanced_accuracy: 0.68121 | valid_accuracy: 0.68146 |  0:09:17s
epoch 33 | loss: 0.58491 | train_auc: 0.75441 | train_balanced_accuracy: 0.68933 | train_accuracy: 0.68964 | valid_auc: 0.73686 | valid_balanced_accuracy: 0.6815  | valid_accuracy: 0.68178 |  0:09:35s
epoch 34 | loss: 0.58627 | train_auc: 0.7541  | train_balanced_accuracy: 0.68879 | train_accuracy: 0.68905 | valid_auc: 0.73999 | valid_balanced_accuracy: 0.68724 | valid_accuracy: 0.68744 |  0:09:53s
epoch 35 | loss: 0.58157 | train_auc: 0.75179 | train_balanced_accuracy: 0.68735 | train_accuracy: 0.68744 | valid_auc: 0.7401  | valid_balanced_accuracy: 0.68218 | valid_accuracy: 0.68225 |  0:10:11s
epoch 36 | loss: 0.58718 | train_auc: 0.76261 | train_balanced_accuracy: 0.69638 | train_accuracy: 0.69661 | valid_auc: 0.74663 | valid_balanced_accuracy: 0.68973 | valid_accuracy: 0.68996 |  0:10:28s
epoch 37 | loss: 0.58339 | train_auc: 0.75632 | train_balanced_accuracy: 0.68753 | train_accuracy: 0.68791 | valid_auc: 0.74232 | valid_balanced_accuracy: 0.68377 | valid_accuracy: 0.68414 |  0:10:43s
epoch 38 | loss: 0.58169 | train_auc: 0.71688 | train_balanced_accuracy: 0.65911 | train_accuracy: 0.65919 | valid_auc: 0.71793 | valid_balanced_accuracy: 0.66308 | valid_accuracy: 0.6632  |  0:10:59s
epoch 39 | loss: 0.57921 | train_auc: 0.71523 | train_balanced_accuracy: 0.65801 | train_accuracy: 0.65852 | valid_auc: 0.71252 | valid_balanced_accuracy: 0.66018 | valid_accuracy: 0.66069 |  0:11:15s
epoch 40 | loss: 0.58254 | train_auc: 0.76015 | train_balanced_accuracy: 0.6944  | train_accuracy: 0.69452 | valid_auc: 0.74438 | valid_balanced_accuracy: 0.68293 | valid_accuracy: 0.68303 |  0:11:31s
epoch 41 | loss: 0.58244 | train_auc: 0.74379 | train_balanced_accuracy: 0.68157 | train_accuracy: 0.68178 | valid_auc: 0.73554 | valid_balanced_accuracy: 0.67763 | valid_accuracy: 0.67784 |  0:11:49s
epoch 42 | loss: 0.57795 | train_auc: 0.73454 | train_balanced_accuracy: 0.67488 | train_accuracy: 0.67564 | valid_auc: 0.72548 | valid_balanced_accuracy: 0.67379 | valid_accuracy: 0.67454 |  0:12:07s
epoch 43 | loss: 0.58557 | train_auc: 0.74172 | train_balanced_accuracy: 0.68228 | train_accuracy: 0.68272 | valid_auc: 0.72816 | valid_balanced_accuracy: 0.67616 | valid_accuracy: 0.67658 |  0:12:26s
epoch 44 | loss: 0.58437 | train_auc: 0.73777 | train_balanced_accuracy: 0.68022 | train_accuracy: 0.68056 | valid_auc: 0.72744 | valid_balanced_accuracy: 0.6761  | valid_accuracy: 0.67642 |  0:12:43s
epoch 45 | loss: 0.58118 | train_auc: 0.74993 | train_balanced_accuracy: 0.6845  | train_accuracy: 0.68504 | valid_auc: 0.73638 | valid_balanced_accuracy: 0.68018 | valid_accuracy: 0.68067 |  0:13:00s
epoch 46 | loss: 0.58297 | train_auc: 0.74283 | train_balanced_accuracy: 0.67679 | train_accuracy: 0.67753 | valid_auc: 0.7317  | valid_balanced_accuracy: 0.6707  | valid_accuracy: 0.67139 |  0:13:17s
epoch 47 | loss: 0.58018 | train_auc: 0.76574 | train_balanced_accuracy: 0.69565 | train_accuracy: 0.69629 | valid_auc: 0.74773 | valid_balanced_accuracy: 0.68505 | valid_accuracy: 0.68571 |  0:13:33s
epoch 48 | loss: 0.58082 | train_auc: 0.76117 | train_balanced_accuracy: 0.69218 | train_accuracy: 0.6922  | valid_auc: 0.74456 | valid_balanced_accuracy: 0.6862  | valid_accuracy: 0.68618 |  0:13:49s
epoch 49 | loss: 0.57706 | train_auc: 0.76471 | train_balanced_accuracy: 0.69575 | train_accuracy: 0.69606 | valid_auc: 0.74743 | valid_balanced_accuracy: 0.69143 | valid_accuracy: 0.69169 |  0:14:06s
epoch 50 | loss: 0.57811 | train_auc: 0.75503 | train_balanced_accuracy: 0.68404 | train_accuracy: 0.6839  | valid_auc: 0.74242 | valid_balanced_accuracy: 0.67565 | valid_accuracy: 0.67548 |  0:14:20s
epoch 51 | loss: 0.57491 | train_auc: 0.70934 | train_balanced_accuracy: 0.65501 | train_accuracy: 0.6551  | valid_auc: 0.70582 | valid_balanced_accuracy: 0.65464 | valid_accuracy: 0.65471 |  0:14:38s
epoch 52 | loss: 0.57371 | train_auc: 0.76946 | train_balanced_accuracy: 0.70253 | train_accuracy: 0.70275 | valid_auc: 0.75013 | valid_balanced_accuracy: 0.68704 | valid_accuracy: 0.68728 |  0:14:54s
epoch 53 | loss: 0.57497 | train_auc: 0.75258 | train_balanced_accuracy: 0.68815 | train_accuracy: 0.68846 | valid_auc: 0.73746 | valid_balanced_accuracy: 0.67955 | valid_accuracy: 0.67989 |  0:15:10s
epoch 54 | loss: 0.57662 | train_auc: 0.72435 | train_balanced_accuracy: 0.67119 | train_accuracy: 0.67166 | valid_auc: 0.71854 | valid_balanced_accuracy: 0.67159 | valid_accuracy: 0.67202 |  0:15:26s
epoch 55 | loss: 0.57579 | train_auc: 0.71017 | train_balanced_accuracy: 0.65234 | train_accuracy: 0.65231 | valid_auc: 0.70947 | valid_balanced_accuracy: 0.65573 | valid_accuracy: 0.65565 |  0:15:44s
epoch 56 | loss: 0.57278 | train_auc: 0.71012 | train_balanced_accuracy: 0.64863 | train_accuracy: 0.64821 | valid_auc: 0.71191 | valid_balanced_accuracy: 0.65025 | valid_accuracy: 0.64983 |  0:16:00s
epoch 57 | loss: 0.58225 | train_auc: 0.72062 | train_balanced_accuracy: 0.6528  | train_accuracy: 0.65219 | valid_auc: 0.71785 | valid_balanced_accuracy: 0.65222 | valid_accuracy: 0.65156 |  0:16:16s
epoch 58 | loss: 0.58113 | train_auc: 0.73007 | train_balanced_accuracy: 0.66536 | train_accuracy: 0.66537 | valid_auc: 0.72695 | valid_balanced_accuracy: 0.66762 | valid_accuracy: 0.66761 |  0:16:34s
epoch 59 | loss: 0.57629 | train_auc: 0.73273 | train_balanced_accuracy: 0.67121 | train_accuracy: 0.67119 | valid_auc: 0.72565 | valid_balanced_accuracy: 0.66738 | valid_accuracy: 0.6673  |  0:16:50s
epoch 60 | loss: 0.58047 | train_auc: 0.74328 | train_balanced_accuracy: 0.67588 | train_accuracy: 0.67576 | valid_auc: 0.73283 | valid_balanced_accuracy: 0.66635 | valid_accuracy: 0.66619 |  0:17:08s
epoch 61 | loss: 0.57895 | train_auc: 0.74928 | train_balanced_accuracy: 0.68366 | train_accuracy: 0.68386 | valid_auc: 0.73622 | valid_balanced_accuracy: 0.67419 | valid_accuracy: 0.67438 |  0:17:25s
epoch 62 | loss: 0.57477 | train_auc: 0.75859 | train_balanced_accuracy: 0.69116 | train_accuracy: 0.69114 | valid_auc: 0.74549 | valid_balanced_accuracy: 0.68009 | valid_accuracy: 0.68004 |  0:17:42s
epoch 63 | loss: 0.57474 | train_auc: 0.76043 | train_balanced_accuracy: 0.69293 | train_accuracy: 0.69303 | valid_auc: 0.7435  | valid_balanced_accuracy: 0.68596 | valid_accuracy: 0.68602 |  0:17:59s
epoch 64 | loss: 0.57311 | train_auc: 0.76705 | train_balanced_accuracy: 0.69799 | train_accuracy: 0.6981  | valid_auc: 0.74868 | valid_balanced_accuracy: 0.68371 | valid_accuracy: 0.68382 |  0:18:16s
epoch 65 | loss: 0.56754 | train_auc: 0.774   | train_balanced_accuracy: 0.70219 | train_accuracy: 0.70227 | valid_auc: 0.75637 | valid_balanced_accuracy: 0.69319 | valid_accuracy: 0.69326 |  0:18:31s
epoch 66 | loss: 0.57285 | train_auc: 0.77597 | train_balanced_accuracy: 0.70181 | train_accuracy: 0.70176 | valid_auc: 0.75412 | valid_balanced_accuracy: 0.68733 | valid_accuracy: 0.68728 |  0:18:48s
epoch 67 | loss: 0.56954 | train_auc: 0.77742 | train_balanced_accuracy: 0.70135 | train_accuracy: 0.70149 | valid_auc: 0.75214 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68854 |  0:19:05s
epoch 68 | loss: 0.57105 | train_auc: 0.77761 | train_balanced_accuracy: 0.70504 | train_accuracy: 0.70542 | valid_auc: 0.75392 | valid_balanced_accuracy: 0.69113 | valid_accuracy: 0.69153 |  0:19:20s
epoch 69 | loss: 0.57104 | train_auc: 0.77774 | train_balanced_accuracy: 0.70314 | train_accuracy: 0.7033  | valid_auc: 0.75311 | valid_balanced_accuracy: 0.69213 | valid_accuracy: 0.69232 |  0:19:34s
epoch 70 | loss: 0.56935 | train_auc: 0.78106 | train_balanced_accuracy: 0.70657 | train_accuracy: 0.7068  | valid_auc: 0.75599 | valid_balanced_accuracy: 0.69145 | valid_accuracy: 0.69169 |  0:19:52s
epoch 71 | loss: 0.57087 | train_auc: 0.7808  | train_balanced_accuracy: 0.7048  | train_accuracy: 0.70495 | valid_auc: 0.75414 | valid_balanced_accuracy: 0.69183 | valid_accuracy: 0.69201 |  0:20:09s
epoch 72 | loss: 0.57324 | train_auc: 0.77825 | train_balanced_accuracy: 0.70413 | train_accuracy: 0.70428 | valid_auc: 0.75357 | valid_balanced_accuracy: 0.69593 | valid_accuracy: 0.6961  |  0:20:27s
epoch 73 | loss: 0.56492 | train_auc: 0.78132 | train_balanced_accuracy: 0.70675 | train_accuracy: 0.70684 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69488 | valid_accuracy: 0.695   |  0:20:42s
epoch 74 | loss: 0.56989 | train_auc: 0.78163 | train_balanced_accuracy: 0.70793 | train_accuracy: 0.70829 | valid_auc: 0.75695 | valid_balanced_accuracy: 0.69524 | valid_accuracy: 0.69562 |  0:20:58s
epoch 75 | loss: 0.57016 | train_auc: 0.78347 | train_balanced_accuracy: 0.70826 | train_accuracy: 0.70833 | valid_auc: 0.75654 | valid_balanced_accuracy: 0.69223 | valid_accuracy: 0.69232 |  0:21:15s
epoch 76 | loss: 0.56793 | train_auc: 0.78402 | train_balanced_accuracy: 0.70491 | train_accuracy: 0.70487 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.69245 | valid_accuracy: 0.69248 |  0:21:33s
epoch 77 | loss: 0.56331 | train_auc: 0.78295 | train_balanced_accuracy: 0.70989 | train_accuracy: 0.71003 | valid_auc: 0.75525 | valid_balanced_accuracy: 0.69517 | valid_accuracy: 0.69531 |  0:21:50s
epoch 78 | loss: 0.56081 | train_auc: 0.78034 | train_balanced_accuracy: 0.70801 | train_accuracy: 0.70837 | valid_auc: 0.75267 | valid_balanced_accuracy: 0.69368 | valid_accuracy: 0.69405 |  0:22:06s
epoch 79 | loss: 0.56262 | train_auc: 0.77954 | train_balanced_accuracy: 0.70777 | train_accuracy: 0.70794 | valid_auc: 0.75317 | valid_balanced_accuracy: 0.69274 | valid_accuracy: 0.69295 |  0:22:23s
epoch 80 | loss: 0.5691  | train_auc: 0.78316 | train_balanced_accuracy: 0.70909 | train_accuracy: 0.7094  | valid_auc: 0.75399 | valid_balanced_accuracy: 0.69404 | valid_accuracy: 0.69437 |  0:22:40s
epoch 81 | loss: 0.57111 | train_auc: 0.78197 | train_balanced_accuracy: 0.70756 | train_accuracy: 0.70786 | valid_auc: 0.75379 | valid_balanced_accuracy: 0.69137 | valid_accuracy: 0.69169 |  0:22:55s
epoch 82 | loss: 0.56635 | train_auc: 0.78149 | train_balanced_accuracy: 0.70626 | train_accuracy: 0.70656 | valid_auc: 0.75613 | valid_balanced_accuracy: 0.69534 | valid_accuracy: 0.69562 |  0:23:13s
epoch 83 | loss: 0.56882 | train_auc: 0.78457 | train_balanced_accuracy: 0.7106  | train_accuracy: 0.71073 | valid_auc: 0.7581  | valid_balanced_accuracy: 0.69046 | valid_accuracy: 0.69059 |  0:23:28s
epoch 84 | loss: 0.56607 | train_auc: 0.78586 | train_balanced_accuracy: 0.71104 | train_accuracy: 0.71132 | valid_auc: 0.7552  | valid_balanced_accuracy: 0.69169 | valid_accuracy: 0.69201 |  0:23:45s
epoch 85 | loss: 0.56749 | train_auc: 0.75783 | train_balanced_accuracy: 0.68901 | train_accuracy: 0.68894 | valid_auc: 0.74448 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68256 |  0:24:00s
epoch 86 | loss: 0.56655 | train_auc: 0.75712 | train_balanced_accuracy: 0.68473 | train_accuracy: 0.68445 | valid_auc: 0.7429  | valid_balanced_accuracy: 0.67889 | valid_accuracy: 0.67863 |  0:24:17s
epoch 87 | loss: 0.56056 | train_auc: 0.76913 | train_balanced_accuracy: 0.69241 | train_accuracy: 0.69204 | valid_auc: 0.75016 | valid_balanced_accuracy: 0.68232 | valid_accuracy: 0.68193 |  0:24:33s
epoch 88 | loss: 0.5597  | train_auc: 0.77707 | train_balanced_accuracy: 0.70609 | train_accuracy: 0.70617 | valid_auc: 0.75517 | valid_balanced_accuracy: 0.69556 | valid_accuracy: 0.69562 |  0:24:50s
epoch 89 | loss: 0.56378 | train_auc: 0.78021 | train_balanced_accuracy: 0.70582 | train_accuracy: 0.70621 | valid_auc: 0.75335 | valid_balanced_accuracy: 0.69163 | valid_accuracy: 0.69201 |  0:25:06s
epoch 90 | loss: 0.56573 | train_auc: 0.78824 | train_balanced_accuracy: 0.71118 | train_accuracy: 0.71105 | valid_auc: 0.75962 | valid_balanced_accuracy: 0.69402 | valid_accuracy: 0.69389 |  0:25:23s
epoch 91 | loss: 0.56111 | train_auc: 0.78966 | train_balanced_accuracy: 0.71352 | train_accuracy: 0.71364 | valid_auc: 0.75753 | valid_balanced_accuracy: 0.68996 | valid_accuracy: 0.69012 |  0:25:42s
epoch 92 | loss: 0.5603  | train_auc: 0.7895  | train_balanced_accuracy: 0.71422 | train_accuracy: 0.71439 | valid_auc: 0.75236 | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69122 |  0:25:59s

Early stopping occurred at epoch 92 with best_epoch = 72 and best_valid_accuracy = 0.6961
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 53/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=26.1min
[CV 4/5; 53/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70962 | train_auc: 0.58763 | train_balanced_accuracy: 0.56372 | train_accuracy: 0.56287 | valid_auc: 0.58427 | valid_balanced_accuracy: 0.56886 | valid_accuracy: 0.56799 |  0:00:18s
epoch 1  | loss: 0.66147 | train_auc: 0.62072 | train_balanced_accuracy: 0.58453 | train_accuracy: 0.58329 | valid_auc: 0.61206 | valid_balanced_accuracy: 0.58197 | valid_accuracy: 0.58074 |  0:00:35s
epoch 2  | loss: 0.64046 | train_auc: 0.6402  | train_balanced_accuracy: 0.57983 | train_accuracy: 0.57771 | valid_auc: 0.63859 | valid_balanced_accuracy: 0.57911 | valid_accuracy: 0.57696 |  0:00:53s
epoch 3  | loss: 0.63426 | train_auc: 0.65062 | train_balanced_accuracy: 0.57984 | train_accuracy: 0.57767 | valid_auc: 0.64353 | valid_balanced_accuracy: 0.5639  | valid_accuracy: 0.56169 |  0:01:10s
epoch 4  | loss: 0.6272  | train_auc: 0.65829 | train_balanced_accuracy: 0.59748 | train_accuracy: 0.59569 | valid_auc: 0.64957 | valid_balanced_accuracy: 0.58977 | valid_accuracy: 0.58798 |  0:01:28s
epoch 5  | loss: 0.62754 | train_auc: 0.66594 | train_balanced_accuracy: 0.61249 | train_accuracy: 0.61143 | valid_auc: 0.65826 | valid_balanced_accuracy: 0.6063  | valid_accuracy: 0.60529 |  0:01:44s
epoch 6  | loss: 0.61963 | train_auc: 0.67211 | train_balanced_accuracy: 0.61329 | train_accuracy: 0.61209 | valid_auc: 0.66299 | valid_balanced_accuracy: 0.60472 | valid_accuracy: 0.60356 |  0:02:01s
epoch 7  | loss: 0.61806 | train_auc: 0.68523 | train_balanced_accuracy: 0.63225 | train_accuracy: 0.63161 | valid_auc: 0.67514 | valid_balanced_accuracy: 0.61801 | valid_accuracy: 0.61741 |  0:02:18s
epoch 8  | loss: 0.61647 | train_auc: 0.69752 | train_balanced_accuracy: 0.64604 | train_accuracy: 0.64629 | valid_auc: 0.68482 | valid_balanced_accuracy: 0.63791 | valid_accuracy: 0.63818 |  0:02:35s
epoch 9  | loss: 0.61296 | train_auc: 0.69841 | train_balanced_accuracy: 0.64184 | train_accuracy: 0.64133 | valid_auc: 0.68281 | valid_balanced_accuracy: 0.62889 | valid_accuracy: 0.62842 |  0:02:51s
epoch 10 | loss: 0.60666 | train_auc: 0.7085  | train_balanced_accuracy: 0.65447 | train_accuracy: 0.65475 | valid_auc: 0.69721 | valid_balanced_accuracy: 0.64983 | valid_accuracy: 0.65014 |  0:03:08s
epoch 11 | loss: 0.60532 | train_auc: 0.70957 | train_balanced_accuracy: 0.65662 | train_accuracy: 0.65695 | valid_auc: 0.69572 | valid_balanced_accuracy: 0.65342 | valid_accuracy: 0.65376 |  0:03:24s
epoch 12 | loss: 0.60247 | train_auc: 0.7149  | train_balanced_accuracy: 0.65876 | train_accuracy: 0.65951 | valid_auc: 0.70113 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.6514  |  0:03:41s
epoch 13 | loss: 0.60328 | train_auc: 0.71825 | train_balanced_accuracy: 0.66255 | train_accuracy: 0.66281 | valid_auc: 0.70362 | valid_balanced_accuracy: 0.65349 | valid_accuracy: 0.65376 |  0:03:57s
epoch 14 | loss: 0.6073  | train_auc: 0.72403 | train_balanced_accuracy: 0.66381 | train_accuracy: 0.66411 | valid_auc: 0.7099  | valid_balanced_accuracy: 0.65614 | valid_accuracy: 0.65644 |  0:04:12s
epoch 15 | loss: 0.60599 | train_auc: 0.72844 | train_balanced_accuracy: 0.66141 | train_accuracy: 0.66218 | valid_auc: 0.71395 | valid_balanced_accuracy: 0.65675 | valid_accuracy: 0.65754 |  0:04:28s
epoch 16 | loss: 0.59967 | train_auc: 0.72964 | train_balanced_accuracy: 0.66721 | train_accuracy: 0.66757 | valid_auc: 0.71136 | valid_balanced_accuracy: 0.65938 | valid_accuracy: 0.65974 |  0:04:46s
epoch 17 | loss: 0.59764 | train_auc: 0.73406 | train_balanced_accuracy: 0.66965 | train_accuracy: 0.67029 | valid_auc: 0.71466 | valid_balanced_accuracy: 0.65926 | valid_accuracy: 0.6599  |  0:05:05s
epoch 18 | loss: 0.60254 | train_auc: 0.73839 | train_balanced_accuracy: 0.66963 | train_accuracy: 0.67033 | valid_auc: 0.7208  | valid_balanced_accuracy: 0.66325 | valid_accuracy: 0.66399 |  0:05:22s
epoch 19 | loss: 0.59248 | train_auc: 0.74143 | train_balanced_accuracy: 0.67334 | train_accuracy: 0.67406 | valid_auc: 0.72285 | valid_balanced_accuracy: 0.6648  | valid_accuracy: 0.66556 |  0:05:39s
epoch 20 | loss: 0.59397 | train_auc: 0.74345 | train_balanced_accuracy: 0.67852 | train_accuracy: 0.67902 | valid_auc: 0.72538 | valid_balanced_accuracy: 0.66642 | valid_accuracy: 0.66698 |  0:05:55s
epoch 21 | loss: 0.5934  | train_auc: 0.74915 | train_balanced_accuracy: 0.68618 | train_accuracy: 0.68654 | valid_auc: 0.72394 | valid_balanced_accuracy: 0.66644 | valid_accuracy: 0.66682 |  0:06:11s
epoch 22 | loss: 0.59759 | train_auc: 0.74989 | train_balanced_accuracy: 0.6853  | train_accuracy: 0.68571 | valid_auc: 0.73001 | valid_balanced_accuracy: 0.66588 | valid_accuracy: 0.66635 |  0:06:30s
epoch 23 | loss: 0.59493 | train_auc: 0.75135 | train_balanced_accuracy: 0.68742 | train_accuracy: 0.68768 | valid_auc: 0.73058 | valid_balanced_accuracy: 0.67234 | valid_accuracy: 0.67265 |  0:06:47s
epoch 24 | loss: 0.59512 | train_auc: 0.75107 | train_balanced_accuracy: 0.68459 | train_accuracy: 0.68504 | valid_auc: 0.73025 | valid_balanced_accuracy: 0.67247 | valid_accuracy: 0.67296 |  0:07:03s
epoch 25 | loss: 0.5941  | train_auc: 0.75331 | train_balanced_accuracy: 0.68804 | train_accuracy: 0.68811 | valid_auc: 0.73173 | valid_balanced_accuracy: 0.67131 | valid_accuracy: 0.67139 |  0:07:21s
epoch 26 | loss: 0.58934 | train_auc: 0.75818 | train_balanced_accuracy: 0.69017 | train_accuracy: 0.69059 | valid_auc: 0.7401  | valid_balanced_accuracy: 0.68338 | valid_accuracy: 0.68382 |  0:07:37s
epoch 27 | loss: 0.59368 | train_auc: 0.7583  | train_balanced_accuracy: 0.69167 | train_accuracy: 0.69181 | valid_auc: 0.73795 | valid_balanced_accuracy: 0.68005 | valid_accuracy: 0.6802  |  0:07:53s
epoch 28 | loss: 0.58915 | train_auc: 0.7601  | train_balanced_accuracy: 0.69525 | train_accuracy: 0.69527 | valid_auc: 0.73783 | valid_balanced_accuracy: 0.67669 | valid_accuracy: 0.67674 |  0:08:10s
epoch 29 | loss: 0.58792 | train_auc: 0.75816 | train_balanced_accuracy: 0.69076 | train_accuracy: 0.69063 | valid_auc: 0.73789 | valid_balanced_accuracy: 0.66929 | valid_accuracy: 0.66918 |  0:08:28s
epoch 30 | loss: 0.58661 | train_auc: 0.75458 | train_balanced_accuracy: 0.68882 | train_accuracy: 0.6889  | valid_auc: 0.7349  | valid_balanced_accuracy: 0.67162 | valid_accuracy: 0.6717  |  0:08:43s
epoch 31 | loss: 0.58559 | train_auc: 0.74509 | train_balanced_accuracy: 0.68499 | train_accuracy: 0.68516 | valid_auc: 0.73288 | valid_balanced_accuracy: 0.67673 | valid_accuracy: 0.6769  |  0:09:00s
epoch 32 | loss: 0.582   | train_auc: 0.72428 | train_balanced_accuracy: 0.66252 | train_accuracy: 0.66257 | valid_auc: 0.71007 | valid_balanced_accuracy: 0.65056 | valid_accuracy: 0.65061 |  0:09:17s
epoch 33 | loss: 0.58515 | train_auc: 0.68029 | train_balanced_accuracy: 0.63786 | train_accuracy: 0.63834 | valid_auc: 0.66828 | valid_balanced_accuracy: 0.62945 | valid_accuracy: 0.63    |  0:09:33s
epoch 34 | loss: 0.58313 | train_auc: 0.67802 | train_balanced_accuracy: 0.6387  | train_accuracy: 0.63861 | valid_auc: 0.66081 | valid_balanced_accuracy: 0.61748 | valid_accuracy: 0.61741 |  0:09:49s
epoch 35 | loss: 0.57836 | train_auc: 0.69217 | train_balanced_accuracy: 0.64506 | train_accuracy: 0.64503 | valid_auc: 0.68514 | valid_balanced_accuracy: 0.63899 | valid_accuracy: 0.63897 |  0:10:05s
epoch 36 | loss: 0.5825  | train_auc: 0.70665 | train_balanced_accuracy: 0.65646 | train_accuracy: 0.65632 | valid_auc: 0.69944 | valid_balanced_accuracy: 0.65116 | valid_accuracy: 0.65109 |  0:10:21s
epoch 37 | loss: 0.58244 | train_auc: 0.71468 | train_balanced_accuracy: 0.6604  | train_accuracy: 0.66069 | valid_auc: 0.70217 | valid_balanced_accuracy: 0.65594 | valid_accuracy: 0.65628 |  0:10:37s
epoch 38 | loss: 0.58321 | train_auc: 0.71921 | train_balanced_accuracy: 0.66253 | train_accuracy: 0.66261 | valid_auc: 0.70638 | valid_balanced_accuracy: 0.65459 | valid_accuracy: 0.65471 |  0:10:54s
epoch 39 | loss: 0.58045 | train_auc: 0.7252  | train_balanced_accuracy: 0.65957 | train_accuracy: 0.65986 | valid_auc: 0.71251 | valid_balanced_accuracy: 0.64951 | valid_accuracy: 0.64983 |  0:11:12s
epoch 40 | loss: 0.58046 | train_auc: 0.72963 | train_balanced_accuracy: 0.66702 | train_accuracy: 0.6671  | valid_auc: 0.71564 | valid_balanced_accuracy: 0.66246 | valid_accuracy: 0.66257 |  0:11:27s
epoch 41 | loss: 0.57874 | train_auc: 0.73371 | train_balanced_accuracy: 0.66267 | train_accuracy: 0.6634  | valid_auc: 0.72289 | valid_balanced_accuracy: 0.65255 | valid_accuracy: 0.65329 |  0:11:43s
epoch 42 | loss: 0.5762  | train_auc: 0.75088 | train_balanced_accuracy: 0.68271 | train_accuracy: 0.68319 | valid_auc: 0.7308  | valid_balanced_accuracy: 0.66741 | valid_accuracy: 0.66793 |  0:11:59s
epoch 43 | loss: 0.57989 | train_auc: 0.76817 | train_balanced_accuracy: 0.70107 | train_accuracy: 0.70133 | valid_auc: 0.74481 | valid_balanced_accuracy: 0.68591 | valid_accuracy: 0.68618 |  0:12:17s
epoch 44 | loss: 0.58337 | train_auc: 0.76344 | train_balanced_accuracy: 0.69655 | train_accuracy: 0.69673 | valid_auc: 0.74016 | valid_balanced_accuracy: 0.67799 | valid_accuracy: 0.67816 |  0:12:34s
epoch 45 | loss: 0.57251 | train_auc: 0.73212 | train_balanced_accuracy: 0.67625 | train_accuracy: 0.67662 | valid_auc: 0.71536 | valid_balanced_accuracy: 0.66439 | valid_accuracy: 0.66478 |  0:12:50s
epoch 46 | loss: 0.57917 | train_auc: 0.71129 | train_balanced_accuracy: 0.65966 | train_accuracy: 0.65966 | valid_auc: 0.70619 | valid_balanced_accuracy: 0.65701 | valid_accuracy: 0.65707 |  0:13:06s
epoch 47 | loss: 0.57401 | train_auc: 0.69455 | train_balanced_accuracy: 0.642   | train_accuracy: 0.64235 | valid_auc: 0.69151 | valid_balanced_accuracy: 0.64227 | valid_accuracy: 0.64259 |  0:13:25s
epoch 48 | loss: 0.57446 | train_auc: 0.77845 | train_balanced_accuracy: 0.70849 | train_accuracy: 0.70873 | valid_auc: 0.74963 | valid_balanced_accuracy: 0.68455 | valid_accuracy: 0.68477 |  0:13:41s
epoch 49 | loss: 0.57379 | train_auc: 0.77142 | train_balanced_accuracy: 0.70077 | train_accuracy: 0.70102 | valid_auc: 0.74729 | valid_balanced_accuracy: 0.68197 | valid_accuracy: 0.68225 |  0:13:57s
epoch 50 | loss: 0.57551 | train_auc: 0.77749 | train_balanced_accuracy: 0.70609 | train_accuracy: 0.70613 | valid_auc: 0.75033 | valid_balanced_accuracy: 0.68439 | valid_accuracy: 0.68445 |  0:14:14s
epoch 51 | loss: 0.56957 | train_auc: 0.77895 | train_balanced_accuracy: 0.70651 | train_accuracy: 0.70652 | valid_auc: 0.75129 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.68854 |  0:14:30s
epoch 52 | loss: 0.56783 | train_auc: 0.72903 | train_balanced_accuracy: 0.66086 | train_accuracy: 0.66132 | valid_auc: 0.71682 | valid_balanced_accuracy: 0.65471 | valid_accuracy: 0.65518 |  0:14:48s
epoch 53 | loss: 0.57064 | train_auc: 0.72935 | train_balanced_accuracy: 0.65336 | train_accuracy: 0.65404 | valid_auc: 0.71589 | valid_balanced_accuracy: 0.65181 | valid_accuracy: 0.6525  |  0:15:04s
epoch 54 | loss: 0.5731  | train_auc: 0.74173 | train_balanced_accuracy: 0.67385 | train_accuracy: 0.6741  | valid_auc: 0.72622 | valid_balanced_accuracy: 0.65947 | valid_accuracy: 0.65974 |  0:15:20s
epoch 55 | loss: 0.56679 | train_auc: 0.76142 | train_balanced_accuracy: 0.68836 | train_accuracy: 0.68858 | valid_auc: 0.7375  | valid_balanced_accuracy: 0.67432 | valid_accuracy: 0.67454 |  0:15:36s
epoch 56 | loss: 0.57394 | train_auc: 0.77433 | train_balanced_accuracy: 0.70219 | train_accuracy: 0.70235 | valid_auc: 0.75002 | valid_balanced_accuracy: 0.68333 | valid_accuracy: 0.68351 |  0:15:52s
epoch 57 | loss: 0.57459 | train_auc: 0.77574 | train_balanced_accuracy: 0.70072 | train_accuracy: 0.70062 | valid_auc: 0.74823 | valid_balanced_accuracy: 0.68327 | valid_accuracy: 0.68319 |  0:16:09s
epoch 58 | loss: 0.57593 | train_auc: 0.7724  | train_balanced_accuracy: 0.70101 | train_accuracy: 0.70129 | valid_auc: 0.74543 | valid_balanced_accuracy: 0.68086 | valid_accuracy: 0.68115 |  0:16:26s
epoch 59 | loss: 0.56821 | train_auc: 0.78152 | train_balanced_accuracy: 0.71052 | train_accuracy: 0.71062 | valid_auc: 0.74949 | valid_balanced_accuracy: 0.68499 | valid_accuracy: 0.68508 |  0:16:43s
epoch 60 | loss: 0.56905 | train_auc: 0.78272 | train_balanced_accuracy: 0.7113  | train_accuracy: 0.71144 | valid_auc: 0.75323 | valid_balanced_accuracy: 0.69043 | valid_accuracy: 0.69059 |  0:16:59s
epoch 61 | loss: 0.56944 | train_auc: 0.77936 | train_balanced_accuracy: 0.70927 | train_accuracy: 0.70951 | valid_auc: 0.75143 | valid_balanced_accuracy: 0.69236 | valid_accuracy: 0.69263 |  0:17:15s
epoch 62 | loss: 0.56997 | train_auc: 0.77984 | train_balanced_accuracy: 0.70671 | train_accuracy: 0.70664 | valid_auc: 0.75076 | valid_balanced_accuracy: 0.68454 | valid_accuracy: 0.68445 |  0:17:32s
epoch 63 | loss: 0.56589 | train_auc: 0.78001 | train_balanced_accuracy: 0.7084  | train_accuracy: 0.70837 | valid_auc: 0.75428 | valid_balanced_accuracy: 0.6845  | valid_accuracy: 0.68445 |  0:17:47s
epoch 64 | loss: 0.56143 | train_auc: 0.78268 | train_balanced_accuracy: 0.70849 | train_accuracy: 0.70853 | valid_auc: 0.75179 | valid_balanced_accuracy: 0.68929 | valid_accuracy: 0.68933 |  0:18:05s
epoch 65 | loss: 0.56528 | train_auc: 0.77977 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70881 | valid_auc: 0.74961 | valid_balanced_accuracy: 0.6885  | valid_accuracy: 0.6887  |  0:18:24s
epoch 66 | loss: 0.56661 | train_auc: 0.77015 | train_balanced_accuracy: 0.70203 | train_accuracy: 0.70204 | valid_auc: 0.74631 | valid_balanced_accuracy: 0.6815  | valid_accuracy: 0.68146 |  0:18:41s
epoch 67 | loss: 0.56291 | train_auc: 0.76187 | train_balanced_accuracy: 0.69499 | train_accuracy: 0.69507 | valid_auc: 0.7388  | valid_balanced_accuracy: 0.67855 | valid_accuracy: 0.67863 |  0:18:58s
epoch 68 | loss: 0.56262 | train_auc: 0.78579 | train_balanced_accuracy: 0.71045 | train_accuracy: 0.71062 | valid_auc: 0.75464 | valid_balanced_accuracy: 0.68977 | valid_accuracy: 0.68996 |  0:19:14s
epoch 69 | loss: 0.56609 | train_auc: 0.78538 | train_balanced_accuracy: 0.71232 | train_accuracy: 0.7125  | valid_auc: 0.7535  | valid_balanced_accuracy: 0.68726 | valid_accuracy: 0.68744 |  0:19:30s
epoch 70 | loss: 0.56684 | train_auc: 0.78602 | train_balanced_accuracy: 0.71188 | train_accuracy: 0.71191 | valid_auc: 0.75839 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.68854 |  0:19:46s
epoch 71 | loss: 0.56609 | train_auc: 0.78803 | train_balanced_accuracy: 0.71259 | train_accuracy: 0.71258 | valid_auc: 0.75621 | valid_balanced_accuracy: 0.68807 | valid_accuracy: 0.68807 |  0:20:01s
epoch 72 | loss: 0.56649 | train_auc: 0.78845 | train_balanced_accuracy: 0.7163  | train_accuracy: 0.71664 | valid_auc: 0.75668 | valid_balanced_accuracy: 0.6907  | valid_accuracy: 0.69106 |  0:20:17s
epoch 73 | loss: 0.5658  | train_auc: 0.78779 | train_balanced_accuracy: 0.71222 | train_accuracy: 0.7125  | valid_auc: 0.75873 | valid_balanced_accuracy: 0.6906  | valid_accuracy: 0.6909  |  0:20:35s
epoch 74 | loss: 0.56475 | train_auc: 0.78968 | train_balanced_accuracy: 0.71509 | train_accuracy: 0.71538 | valid_auc: 0.76018 | valid_balanced_accuracy: 0.69345 | valid_accuracy: 0.69374 |  0:20:49s
epoch 75 | loss: 0.56394 | train_auc: 0.7905  | train_balanced_accuracy: 0.71445 | train_accuracy: 0.71439 | valid_auc: 0.75881 | valid_balanced_accuracy: 0.6917  | valid_accuracy: 0.69169 |  0:21:06s
epoch 76 | loss: 0.56472 | train_auc: 0.79158 | train_balanced_accuracy: 0.71625 | train_accuracy: 0.71616 | valid_auc: 0.76042 | valid_balanced_accuracy: 0.69255 | valid_accuracy: 0.69248 |  0:21:24s
epoch 77 | loss: 0.56143 | train_auc: 0.79085 | train_balanced_accuracy: 0.71437 | train_accuracy: 0.71455 | valid_auc: 0.75809 | valid_balanced_accuracy: 0.69086 | valid_accuracy: 0.69106 |  0:21:41s
epoch 78 | loss: 0.55486 | train_auc: 0.79339 | train_balanced_accuracy: 0.71994 | train_accuracy: 0.72002 | valid_auc: 0.75948 | valid_balanced_accuracy: 0.69165 | valid_accuracy: 0.69169 |  0:21:59s
epoch 79 | loss: 0.55721 | train_auc: 0.78174 | train_balanced_accuracy: 0.70623 | train_accuracy: 0.70637 | valid_auc: 0.75063 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.6854  |  0:22:17s
epoch 80 | loss: 0.56161 | train_auc: 0.79084 | train_balanced_accuracy: 0.71436 | train_accuracy: 0.71439 | valid_auc: 0.75817 | valid_balanced_accuracy: 0.68804 | valid_accuracy: 0.68807 |  0:22:34s
epoch 81 | loss: 0.56291 | train_auc: 0.78922 | train_balanced_accuracy: 0.71234 | train_accuracy: 0.7127  | valid_auc: 0.75742 | valid_balanced_accuracy: 0.68774 | valid_accuracy: 0.68807 |  0:22:51s
epoch 82 | loss: 0.56166 | train_auc: 0.78633 | train_balanced_accuracy: 0.71193 | train_accuracy: 0.71219 | valid_auc: 0.75631 | valid_balanced_accuracy: 0.68799 | valid_accuracy: 0.68823 |  0:23:08s
epoch 83 | loss: 0.55381 | train_auc: 0.79231 | train_balanced_accuracy: 0.71715 | train_accuracy: 0.71734 | valid_auc: 0.75694 | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.6876  |  0:23:24s
epoch 84 | loss: 0.55356 | train_auc: 0.79179 | train_balanced_accuracy: 0.71601 | train_accuracy: 0.71624 | valid_auc: 0.75542 | valid_balanced_accuracy: 0.68551 | valid_accuracy: 0.68571 |  0:23:40s
epoch 85 | loss: 0.55862 | train_auc: 0.79247 | train_balanced_accuracy: 0.71432 | train_accuracy: 0.71459 | valid_auc: 0.75403 | valid_balanced_accuracy: 0.68213 | valid_accuracy: 0.6824  |  0:23:59s
epoch 86 | loss: 0.55812 | train_auc: 0.79649 | train_balanced_accuracy: 0.72257 | train_accuracy: 0.72258 | valid_auc: 0.75711 | valid_balanced_accuracy: 0.68934 | valid_accuracy: 0.68933 |  0:24:14s
epoch 87 | loss: 0.55299 | train_auc: 0.79618 | train_balanced_accuracy: 0.71723 | train_accuracy: 0.71707 | valid_auc: 0.75621 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.68524 |  0:24:30s
epoch 88 | loss: 0.55677 | train_auc: 0.79583 | train_balanced_accuracy: 0.72105 | train_accuracy: 0.72112 | valid_auc: 0.75601 | valid_balanced_accuracy: 0.6866  | valid_accuracy: 0.68665 |  0:24:46s
epoch 89 | loss: 0.55422 | train_auc: 0.79721 | train_balanced_accuracy: 0.71971 | train_accuracy: 0.71982 | valid_auc: 0.75838 | valid_balanced_accuracy: 0.69113 | valid_accuracy: 0.69122 |  0:25:03s
epoch 90 | loss: 0.55038 | train_auc: 0.79803 | train_balanced_accuracy: 0.71978 | train_accuracy: 0.7197  | valid_auc: 0.75837 | valid_balanced_accuracy: 0.68956 | valid_accuracy: 0.68949 |  0:25:20s
epoch 91 | loss: 0.55495 | train_auc: 0.79639 | train_balanced_accuracy: 0.72157 | train_accuracy: 0.72175 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.69214 | valid_accuracy: 0.69232 |  0:25:37s
epoch 92 | loss: 0.55602 | train_auc: 0.79713 | train_balanced_accuracy: 0.72079 | train_accuracy: 0.72085 | valid_auc: 0.75665 | valid_balanced_accuracy: 0.68614 | valid_accuracy: 0.68618 |  0:25:54s
epoch 93 | loss: 0.55232 | train_auc: 0.79551 | train_balanced_accuracy: 0.72074 | train_accuracy: 0.72081 | valid_auc: 0.75556 | valid_balanced_accuracy: 0.68456 | valid_accuracy: 0.68461 |  0:26:10s
epoch 94 | loss: 0.5613  | train_auc: 0.79972 | train_balanced_accuracy: 0.7225  | train_accuracy: 0.72277 | valid_auc: 0.75791 | valid_balanced_accuracy: 0.68753 | valid_accuracy: 0.68776 |  0:26:27s

Early stopping occurred at epoch 94 with best_epoch = 74 and best_valid_accuracy = 0.69374
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 53/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=26.6min
[CV 5/5; 53/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71977 | train_auc: 0.59287 | train_balanced_accuracy: 0.51799 | train_accuracy: 0.51515 | valid_auc: 0.59419 | valid_balanced_accuracy: 0.52381 | valid_accuracy: 0.52093 |  0:00:15s
epoch 1  | loss: 0.65593 | train_auc: 0.62909 | train_balanced_accuracy: 0.59328 | train_accuracy: 0.59262 | valid_auc: 0.63176 | valid_balanced_accuracy: 0.5984  | valid_accuracy: 0.59773 |  0:00:33s
epoch 2  | loss: 0.64411 | train_auc: 0.64947 | train_balanced_accuracy: 0.58674 | train_accuracy: 0.58522 | valid_auc: 0.64798 | valid_balanced_accuracy: 0.59162 | valid_accuracy: 0.59002 |  0:00:50s
epoch 3  | loss: 0.62935 | train_auc: 0.65969 | train_balanced_accuracy: 0.60962 | train_accuracy: 0.60844 | valid_auc: 0.65675 | valid_balanced_accuracy: 0.60573 | valid_accuracy: 0.6045  |  0:01:05s
epoch 4  | loss: 0.61567 | train_auc: 0.65856 | train_balanced_accuracy: 0.6085  | train_accuracy: 0.60777 | valid_auc: 0.65799 | valid_balanced_accuracy: 0.6068  | valid_accuracy: 0.60607 |  0:01:22s
epoch 5  | loss: 0.61526 | train_auc: 0.67125 | train_balanced_accuracy: 0.61712 | train_accuracy: 0.6165  | valid_auc: 0.67179 | valid_balanced_accuracy: 0.62002 | valid_accuracy: 0.61945 |  0:01:39s
epoch 6  | loss: 0.61643 | train_auc: 0.67539 | train_balanced_accuracy: 0.62468 | train_accuracy: 0.62441 | valid_auc: 0.67718 | valid_balanced_accuracy: 0.62525 | valid_accuracy: 0.62496 |  0:01:56s
epoch 7  | loss: 0.61272 | train_auc: 0.6737  | train_balanced_accuracy: 0.62415 | train_accuracy: 0.62358 | valid_auc: 0.67089 | valid_balanced_accuracy: 0.6197  | valid_accuracy: 0.61914 |  0:02:12s
epoch 8  | loss: 0.61131 | train_auc: 0.67928 | train_balanced_accuracy: 0.62372 | train_accuracy: 0.62327 | valid_auc: 0.67481 | valid_balanced_accuracy: 0.62021 | valid_accuracy: 0.61977 |  0:02:28s
epoch 9  | loss: 0.608   | train_auc: 0.68608 | train_balanced_accuracy: 0.62545 | train_accuracy: 0.62492 | valid_auc: 0.67885 | valid_balanced_accuracy: 0.62217 | valid_accuracy: 0.62166 |  0:02:45s
epoch 10 | loss: 0.60616 | train_auc: 0.69435 | train_balanced_accuracy: 0.62301 | train_accuracy: 0.6228  | valid_auc: 0.68621 | valid_balanced_accuracy: 0.62023 | valid_accuracy: 0.62008 |  0:03:01s
epoch 11 | loss: 0.60196 | train_auc: 0.69568 | train_balanced_accuracy: 0.62549 | train_accuracy: 0.62508 | valid_auc: 0.68773 | valid_balanced_accuracy: 0.62234 | valid_accuracy: 0.62197 |  0:03:18s
epoch 12 | loss: 0.60507 | train_auc: 0.70338 | train_balanced_accuracy: 0.63297 | train_accuracy: 0.63291 | valid_auc: 0.69787 | valid_balanced_accuracy: 0.63226 | valid_accuracy: 0.6322  |  0:03:34s
epoch 13 | loss: 0.60639 | train_auc: 0.70354 | train_balanced_accuracy: 0.63052 | train_accuracy: 0.63027 | valid_auc: 0.6987  | valid_balanced_accuracy: 0.62852 | valid_accuracy: 0.62827 |  0:03:50s
epoch 14 | loss: 0.5969  | train_auc: 0.70641 | train_balanced_accuracy: 0.62996 | train_accuracy: 0.62964 | valid_auc: 0.69895 | valid_balanced_accuracy: 0.6289  | valid_accuracy: 0.62858 |  0:04:07s
epoch 15 | loss: 0.59878 | train_auc: 0.71594 | train_balanced_accuracy: 0.64788 | train_accuracy: 0.6477  | valid_auc: 0.70698 | valid_balanced_accuracy: 0.64344 | valid_accuracy: 0.64322 |  0:04:22s
epoch 16 | loss: 0.60104 | train_auc: 0.72139 | train_balanced_accuracy: 0.64867 | train_accuracy: 0.64821 | valid_auc: 0.71264 | valid_balanced_accuracy: 0.64119 | valid_accuracy: 0.6407  |  0:04:38s
epoch 17 | loss: 0.60168 | train_auc: 0.71728 | train_balanced_accuracy: 0.64936 | train_accuracy: 0.64904 | valid_auc: 0.70889 | valid_balanced_accuracy: 0.64543 | valid_accuracy: 0.64511 |  0:04:53s
epoch 18 | loss: 0.59602 | train_auc: 0.72877 | train_balanced_accuracy: 0.66485 | train_accuracy: 0.66509 | valid_auc: 0.71747 | valid_balanced_accuracy: 0.66033 | valid_accuracy: 0.66053 |  0:05:11s
epoch 19 | loss: 0.59602 | train_auc: 0.7336  | train_balanced_accuracy: 0.66924 | train_accuracy: 0.66942 | valid_auc: 0.72297 | valid_balanced_accuracy: 0.66667 | valid_accuracy: 0.66682 |  0:05:27s
epoch 20 | loss: 0.596   | train_auc: 0.73286 | train_balanced_accuracy: 0.66866 | train_accuracy: 0.66875 | valid_auc: 0.72326 | valid_balanced_accuracy: 0.66238 | valid_accuracy: 0.66242 |  0:05:42s
epoch 21 | loss: 0.59328 | train_auc: 0.73686 | train_balanced_accuracy: 0.67504 | train_accuracy: 0.67528 | valid_auc: 0.72519 | valid_balanced_accuracy: 0.66821 | valid_accuracy: 0.6684  |  0:05:59s
epoch 22 | loss: 0.58991 | train_auc: 0.7374  | train_balanced_accuracy: 0.67574 | train_accuracy: 0.67619 | valid_auc: 0.72739 | valid_balanced_accuracy: 0.67218 | valid_accuracy: 0.67265 |  0:06:15s
epoch 23 | loss: 0.58915 | train_auc: 0.74562 | train_balanced_accuracy: 0.68227 | train_accuracy: 0.6826  | valid_auc: 0.73215 | valid_balanced_accuracy: 0.67282 | valid_accuracy: 0.67312 |  0:06:31s
epoch 24 | loss: 0.59427 | train_auc: 0.74353 | train_balanced_accuracy: 0.68372 | train_accuracy: 0.68429 | valid_auc: 0.72892 | valid_balanced_accuracy: 0.67899 | valid_accuracy: 0.67957 |  0:06:47s
epoch 25 | loss: 0.5891  | train_auc: 0.7475  | train_balanced_accuracy: 0.67896 | train_accuracy: 0.67882 | valid_auc: 0.73173 | valid_balanced_accuracy: 0.66666 | valid_accuracy: 0.66651 |  0:07:05s
epoch 26 | loss: 0.59284 | train_auc: 0.75437 | train_balanced_accuracy: 0.69126 | train_accuracy: 0.69169 | valid_auc: 0.74212 | valid_balanced_accuracy: 0.67868 | valid_accuracy: 0.6791  |  0:07:21s
epoch 27 | loss: 0.58631 | train_auc: 0.74815 | train_balanced_accuracy: 0.68314 | train_accuracy: 0.68327 | valid_auc: 0.7369  | valid_balanced_accuracy: 0.6746  | valid_accuracy: 0.67469 |  0:07:40s
epoch 28 | loss: 0.58519 | train_auc: 0.75597 | train_balanced_accuracy: 0.69109 | train_accuracy: 0.69149 | valid_auc: 0.74173 | valid_balanced_accuracy: 0.68139 | valid_accuracy: 0.68178 |  0:07:56s
epoch 29 | loss: 0.58844 | train_auc: 0.75082 | train_balanced_accuracy: 0.68573 | train_accuracy: 0.6861  | valid_auc: 0.73975 | valid_balanced_accuracy: 0.67906 | valid_accuracy: 0.67941 |  0:08:13s
epoch 30 | loss: 0.58812 | train_auc: 0.73605 | train_balanced_accuracy: 0.67352 | train_accuracy: 0.67363 | valid_auc: 0.73207 | valid_balanced_accuracy: 0.6675  | valid_accuracy: 0.66761 |  0:08:29s
epoch 31 | loss: 0.58378 | train_auc: 0.73563 | train_balanced_accuracy: 0.6689  | train_accuracy: 0.66903 | valid_auc: 0.72998 | valid_balanced_accuracy: 0.67127 | valid_accuracy: 0.67139 |  0:08:46s
epoch 32 | loss: 0.58577 | train_auc: 0.6978  | train_balanced_accuracy: 0.64847 | train_accuracy: 0.64825 | valid_auc: 0.69516 | valid_balanced_accuracy: 0.64624 | valid_accuracy: 0.64605 |  0:09:03s
epoch 33 | loss: 0.58726 | train_auc: 0.758   | train_balanced_accuracy: 0.6935  | train_accuracy: 0.69397 | valid_auc: 0.7359  | valid_balanced_accuracy: 0.66984 | valid_accuracy: 0.67029 |  0:09:19s
epoch 34 | loss: 0.57633 | train_auc: 0.75616 | train_balanced_accuracy: 0.69095 | train_accuracy: 0.69126 | valid_auc: 0.73594 | valid_balanced_accuracy: 0.67518 | valid_accuracy: 0.67548 |  0:09:34s
epoch 35 | loss: 0.58464 | train_auc: 0.74035 | train_balanced_accuracy: 0.66617 | train_accuracy: 0.66588 | valid_auc: 0.72345 | valid_balanced_accuracy: 0.65299 | valid_accuracy: 0.65266 |  0:09:52s
epoch 36 | loss: 0.5756  | train_auc: 0.74208 | train_balanced_accuracy: 0.67942 | train_accuracy: 0.67918 | valid_auc: 0.72958 | valid_balanced_accuracy: 0.66765 | valid_accuracy: 0.66745 |  0:10:09s
epoch 37 | loss: 0.57768 | train_auc: 0.71403 | train_balanced_accuracy: 0.6604  | train_accuracy: 0.66041 | valid_auc: 0.71327 | valid_balanced_accuracy: 0.66144 | valid_accuracy: 0.66147 |  0:10:25s
epoch 38 | loss: 0.57925 | train_auc: 0.705   | train_balanced_accuracy: 0.62982 | train_accuracy: 0.62897 | valid_auc: 0.70414 | valid_balanced_accuracy: 0.63457 | valid_accuracy: 0.63377 |  0:10:41s
epoch 39 | loss: 0.57933 | train_auc: 0.70156 | train_balanced_accuracy: 0.65121 | train_accuracy: 0.65136 | valid_auc: 0.70245 | valid_balanced_accuracy: 0.6523  | valid_accuracy: 0.6525  |  0:10:58s
epoch 40 | loss: 0.57413 | train_auc: 0.69654 | train_balanced_accuracy: 0.63697 | train_accuracy: 0.63676 | valid_auc: 0.69241 | valid_balanced_accuracy: 0.63648 | valid_accuracy: 0.63629 |  0:11:14s
epoch 41 | loss: 0.57771 | train_auc: 0.69323 | train_balanced_accuracy: 0.63379 | train_accuracy: 0.63389 | valid_auc: 0.69258 | valid_balanced_accuracy: 0.63164 | valid_accuracy: 0.63173 |  0:11:30s
epoch 42 | loss: 0.57841 | train_auc: 0.72666 | train_balanced_accuracy: 0.66362 | train_accuracy: 0.66407 | valid_auc: 0.72027 | valid_balanced_accuracy: 0.66096 | valid_accuracy: 0.66147 |  0:11:46s
epoch 43 | loss: 0.57691 | train_auc: 0.72094 | train_balanced_accuracy: 0.66258 | train_accuracy: 0.66269 | valid_auc: 0.71553 | valid_balanced_accuracy: 0.66007 | valid_accuracy: 0.66021 |  0:12:03s
epoch 44 | loss: 0.57402 | train_auc: 0.76742 | train_balanced_accuracy: 0.70076 | train_accuracy: 0.70117 | valid_auc: 0.74752 | valid_balanced_accuracy: 0.6877  | valid_accuracy: 0.68807 |  0:12:18s
epoch 45 | loss: 0.57294 | train_auc: 0.70774 | train_balanced_accuracy: 0.65305 | train_accuracy: 0.6536  | valid_auc: 0.70184 | valid_balanced_accuracy: 0.64719 | valid_accuracy: 0.64778 |  0:12:36s
epoch 46 | loss: 0.57418 | train_auc: 0.70287 | train_balanced_accuracy: 0.65423 | train_accuracy: 0.65463 | valid_auc: 0.69812 | valid_balanced_accuracy: 0.64657 | valid_accuracy: 0.64699 |  0:12:53s
epoch 47 | loss: 0.57444 | train_auc: 0.71687 | train_balanced_accuracy: 0.65767 | train_accuracy: 0.65817 | valid_auc: 0.70098 | valid_balanced_accuracy: 0.64399 | valid_accuracy: 0.64448 |  0:13:09s
epoch 48 | loss: 0.57381 | train_auc: 0.73345 | train_balanced_accuracy: 0.67502 | train_accuracy: 0.67536 | valid_auc: 0.71898 | valid_balanced_accuracy: 0.66299 | valid_accuracy: 0.66336 |  0:13:26s
epoch 49 | loss: 0.57132 | train_auc: 0.72419 | train_balanced_accuracy: 0.66133 | train_accuracy: 0.66147 | valid_auc: 0.70997 | valid_balanced_accuracy: 0.65137 | valid_accuracy: 0.65156 |  0:13:44s
epoch 50 | loss: 0.56904 | train_auc: 0.76862 | train_balanced_accuracy: 0.70001 | train_accuracy: 0.70019 | valid_auc: 0.75064 | valid_balanced_accuracy: 0.68883 | valid_accuracy: 0.68901 |  0:14:01s
epoch 51 | loss: 0.57178 | train_auc: 0.77364 | train_balanced_accuracy: 0.70346 | train_accuracy: 0.70393 | valid_auc: 0.74586 | valid_balanced_accuracy: 0.68308 | valid_accuracy: 0.68351 |  0:14:17s
epoch 52 | loss: 0.56907 | train_auc: 0.75475 | train_balanced_accuracy: 0.68827 | train_accuracy: 0.68858 | valid_auc: 0.73073 | valid_balanced_accuracy: 0.66989 | valid_accuracy: 0.67013 |  0:14:34s
epoch 53 | loss: 0.57301 | train_auc: 0.76571 | train_balanced_accuracy: 0.69633 | train_accuracy: 0.69665 | valid_auc: 0.74013 | valid_balanced_accuracy: 0.67975 | valid_accuracy: 0.68004 |  0:14:53s
epoch 54 | loss: 0.57155 | train_auc: 0.75833 | train_balanced_accuracy: 0.6913  | train_accuracy: 0.69145 | valid_auc: 0.74141 | valid_balanced_accuracy: 0.67692 | valid_accuracy: 0.67705 |  0:15:08s
epoch 55 | loss: 0.57337 | train_auc: 0.75012 | train_balanced_accuracy: 0.686   | train_accuracy: 0.68579 | valid_auc: 0.73415 | valid_balanced_accuracy: 0.66765 | valid_accuracy: 0.66745 |  0:15:25s
epoch 56 | loss: 0.5706  | train_auc: 0.77785 | train_balanced_accuracy: 0.70582 | train_accuracy: 0.70589 | valid_auc: 0.74855 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68272 |  0:15:40s
epoch 57 | loss: 0.56896 | train_auc: 0.76962 | train_balanced_accuracy: 0.69829 | train_accuracy: 0.69858 | valid_auc: 0.73804 | valid_balanced_accuracy: 0.67382 | valid_accuracy: 0.67406 |  0:15:57s
epoch 58 | loss: 0.56764 | train_auc: 0.73724 | train_balanced_accuracy: 0.67116 | train_accuracy: 0.67103 | valid_auc: 0.71856 | valid_balanced_accuracy: 0.65816 | valid_accuracy: 0.65801 |  0:16:12s
epoch 59 | loss: 0.57276 | train_auc: 0.71821 | train_balanced_accuracy: 0.66167 | train_accuracy: 0.66191 | valid_auc: 0.70757 | valid_balanced_accuracy: 0.65665 | valid_accuracy: 0.65691 |  0:16:28s
epoch 60 | loss: 0.5708  | train_auc: 0.73725 | train_balanced_accuracy: 0.67412 | train_accuracy: 0.67418 | valid_auc: 0.72462 | valid_balanced_accuracy: 0.6614  | valid_accuracy: 0.66147 |  0:16:44s
epoch 61 | loss: 0.57038 | train_auc: 0.76553 | train_balanced_accuracy: 0.69489 | train_accuracy: 0.69535 | valid_auc: 0.7361  | valid_balanced_accuracy: 0.67329 | valid_accuracy: 0.67375 |  0:17:00s
epoch 62 | loss: 0.55967 | train_auc: 0.75394 | train_balanced_accuracy: 0.68452 | train_accuracy: 0.68469 | valid_auc: 0.73001 | valid_balanced_accuracy: 0.66906 | valid_accuracy: 0.66918 |  0:17:15s
epoch 63 | loss: 0.56442 | train_auc: 0.71584 | train_balanced_accuracy: 0.66302 | train_accuracy: 0.66324 | valid_auc: 0.70861 | valid_balanced_accuracy: 0.65516 | valid_accuracy: 0.65534 |  0:17:32s
epoch 64 | loss: 0.56072 | train_auc: 0.72195 | train_balanced_accuracy: 0.66501 | train_accuracy: 0.66501 | valid_auc: 0.71336 | valid_balanced_accuracy: 0.65964 | valid_accuracy: 0.65958 |  0:17:49s
epoch 65 | loss: 0.56971 | train_auc: 0.72206 | train_balanced_accuracy: 0.66574 | train_accuracy: 0.66568 | valid_auc: 0.70516 | valid_balanced_accuracy: 0.65427 | valid_accuracy: 0.65423 |  0:18:06s
epoch 66 | loss: 0.56264 | train_auc: 0.74117 | train_balanced_accuracy: 0.67701 | train_accuracy: 0.67705 | valid_auc: 0.72343 | valid_balanced_accuracy: 0.66553 | valid_accuracy: 0.66556 |  0:18:23s
epoch 67 | loss: 0.56628 | train_auc: 0.7354  | train_balanced_accuracy: 0.67252 | train_accuracy: 0.67269 | valid_auc: 0.71628 | valid_balanced_accuracy: 0.66222 | valid_accuracy: 0.66242 |  0:18:40s
epoch 68 | loss: 0.55868 | train_auc: 0.76698 | train_balanced_accuracy: 0.69397 | train_accuracy: 0.69444 | valid_auc: 0.73254 | valid_balanced_accuracy: 0.66904 | valid_accuracy: 0.6695  |  0:18:57s
epoch 69 | loss: 0.56584 | train_auc: 0.7831  | train_balanced_accuracy: 0.7099  | train_accuracy: 0.71026 | valid_auc: 0.74625 | valid_balanced_accuracy: 0.68065 | valid_accuracy: 0.68099 |  0:19:13s
epoch 70 | loss: 0.56008 | train_auc: 0.78951 | train_balanced_accuracy: 0.71557 | train_accuracy: 0.71589 | valid_auc: 0.75322 | valid_balanced_accuracy: 0.68948 | valid_accuracy: 0.6898  |  0:19:30s
epoch 71 | loss: 0.56256 | train_auc: 0.77277 | train_balanced_accuracy: 0.70483 | train_accuracy: 0.70519 | valid_auc: 0.74584 | valid_balanced_accuracy: 0.68237 | valid_accuracy: 0.68272 |  0:19:49s
epoch 72 | loss: 0.55409 | train_auc: 0.77554 | train_balanced_accuracy: 0.70971 | train_accuracy: 0.7101  | valid_auc: 0.74989 | valid_balanced_accuracy: 0.68501 | valid_accuracy: 0.6854  |  0:20:05s
epoch 73 | loss: 0.55577 | train_auc: 0.76251 | train_balanced_accuracy: 0.69392 | train_accuracy: 0.69413 | valid_auc: 0.73878 | valid_balanced_accuracy: 0.67954 | valid_accuracy: 0.67973 |  0:20:23s
epoch 74 | loss: 0.56    | train_auc: 0.77499 | train_balanced_accuracy: 0.70837 | train_accuracy: 0.70873 | valid_auc: 0.7472  | valid_balanced_accuracy: 0.6869  | valid_accuracy: 0.68728 |  0:20:39s
epoch 75 | loss: 0.55424 | train_auc: 0.7815  | train_balanced_accuracy: 0.70844 | train_accuracy: 0.70881 | valid_auc: 0.75325 | valid_balanced_accuracy: 0.68895 | valid_accuracy: 0.68933 |  0:20:55s
epoch 76 | loss: 0.55646 | train_auc: 0.76569 | train_balanced_accuracy: 0.69793 | train_accuracy: 0.69795 | valid_auc: 0.74406 | valid_balanced_accuracy: 0.68506 | valid_accuracy: 0.68508 |  0:21:11s
epoch 77 | loss: 0.55416 | train_auc: 0.72156 | train_balanced_accuracy: 0.66497 | train_accuracy: 0.66482 | valid_auc: 0.71359 | valid_balanced_accuracy: 0.66243 | valid_accuracy: 0.66226 |  0:21:29s
epoch 78 | loss: 0.55478 | train_auc: 0.71941 | train_balanced_accuracy: 0.65328 | train_accuracy: 0.65286 | valid_auc: 0.7123  | valid_balanced_accuracy: 0.64903 | valid_accuracy: 0.64857 |  0:21:44s
epoch 79 | loss: 0.55758 | train_auc: 0.76772 | train_balanced_accuracy: 0.69953 | train_accuracy: 0.69968 | valid_auc: 0.7442  | valid_balanced_accuracy: 0.68714 | valid_accuracy: 0.68728 |  0:22:00s
epoch 80 | loss: 0.56225 | train_auc: 0.76065 | train_balanced_accuracy: 0.69525 | train_accuracy: 0.69547 | valid_auc: 0.74016 | valid_balanced_accuracy: 0.67714 | valid_accuracy: 0.67737 |  0:22:17s
epoch 81 | loss: 0.55153 | train_auc: 0.78658 | train_balanced_accuracy: 0.71263 | train_accuracy: 0.71305 | valid_auc: 0.75284 | valid_balanced_accuracy: 0.6881  | valid_accuracy: 0.68854 |  0:22:33s
epoch 82 | loss: 0.55328 | train_auc: 0.79099 | train_balanced_accuracy: 0.71703 | train_accuracy: 0.71723 | valid_auc: 0.75495 | valid_balanced_accuracy: 0.68615 | valid_accuracy: 0.68634 |  0:22:49s
epoch 83 | loss: 0.55157 | train_auc: 0.766   | train_balanced_accuracy: 0.6985  | train_accuracy: 0.69862 | valid_auc: 0.73644 | valid_balanced_accuracy: 0.68072 | valid_accuracy: 0.68083 |  0:23:05s
epoch 84 | loss: 0.55199 | train_auc: 0.74437 | train_balanced_accuracy: 0.68123 | train_accuracy: 0.68162 | valid_auc: 0.72363 | valid_balanced_accuracy: 0.66442 | valid_accuracy: 0.66478 |  0:23:22s
epoch 85 | loss: 0.55793 | train_auc: 0.79734 | train_balanced_accuracy: 0.72225 | train_accuracy: 0.72258 | valid_auc: 0.75633 | valid_balanced_accuracy: 0.68813 | valid_accuracy: 0.68839 |  0:23:38s
epoch 86 | loss: 0.55363 | train_auc: 0.78831 | train_balanced_accuracy: 0.71508 | train_accuracy: 0.71545 | valid_auc: 0.7485  | valid_balanced_accuracy: 0.67778 | valid_accuracy: 0.67816 |  0:23:56s
epoch 87 | loss: 0.54852 | train_auc: 0.78746 | train_balanced_accuracy: 0.71231 | train_accuracy: 0.71223 | valid_auc: 0.75559 | valid_balanced_accuracy: 0.68581 | valid_accuracy: 0.68571 |  0:24:14s
epoch 88 | loss: 0.55554 | train_auc: 0.76084 | train_balanced_accuracy: 0.69403 | train_accuracy: 0.69389 | valid_auc: 0.74047 | valid_balanced_accuracy: 0.68208 | valid_accuracy: 0.68193 |  0:24:33s
epoch 89 | loss: 0.55007 | train_auc: 0.75443 | train_balanced_accuracy: 0.68916 | train_accuracy: 0.68901 | valid_auc: 0.73455 | valid_balanced_accuracy: 0.67848 | valid_accuracy: 0.67831 |  0:24:50s
epoch 90 | loss: 0.55021 | train_auc: 0.71585 | train_balanced_accuracy: 0.65931 | train_accuracy: 0.65868 | valid_auc: 0.70912 | valid_balanced_accuracy: 0.6536  | valid_accuracy: 0.65297 |  0:25:07s

Early stopping occurred at epoch 90 with best_epoch = 70 and best_valid_accuracy = 0.6898
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 53/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=25.3min
[CV 1/5; 54/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83059 | train_auc: 0.53626 | train_balanced_accuracy: 0.52852 | train_accuracy: 0.52792 | valid_auc: 0.52875 | valid_balanced_accuracy: 0.52114 | valid_accuracy: 0.52046 |  0:00:17s
epoch 1  | loss: 0.75907 | train_auc: 0.53221 | train_balanced_accuracy: 0.51996 | train_accuracy: 0.51769 | valid_auc: 0.52199 | valid_balanced_accuracy: 0.51455 | valid_accuracy: 0.51228 |  0:00:34s
epoch 2  | loss: 0.71429 | train_auc: 0.55035 | train_balanced_accuracy: 0.52446 | train_accuracy: 0.52186 | valid_auc: 0.5408  | valid_balanced_accuracy: 0.52253 | valid_accuracy: 0.51983 |  0:00:52s
epoch 3  | loss: 0.69127 | train_auc: 0.56469 | train_balanced_accuracy: 0.53589 | train_accuracy: 0.53354 | valid_auc: 0.55528 | valid_balanced_accuracy: 0.53105 | valid_accuracy: 0.52864 |  0:01:08s
epoch 4  | loss: 0.67558 | train_auc: 0.5752  | train_balanced_accuracy: 0.54424 | train_accuracy: 0.542   | valid_auc: 0.5673  | valid_balanced_accuracy: 0.53523 | valid_accuracy: 0.53289 |  0:01:23s
epoch 5  | loss: 0.67382 | train_auc: 0.57883 | train_balanced_accuracy: 0.55003 | train_accuracy: 0.54779 | valid_auc: 0.57152 | valid_balanced_accuracy: 0.54014 | valid_accuracy: 0.53777 |  0:01:39s
epoch 6  | loss: 0.67298 | train_auc: 0.58269 | train_balanced_accuracy: 0.55618 | train_accuracy: 0.55408 | valid_auc: 0.57546 | valid_balanced_accuracy: 0.54922 | valid_accuracy: 0.54706 |  0:01:54s
epoch 7  | loss: 0.66629 | train_auc: 0.59619 | train_balanced_accuracy: 0.56141 | train_accuracy: 0.55935 | valid_auc: 0.58586 | valid_balanced_accuracy: 0.55276 | valid_accuracy: 0.55068 |  0:02:10s
epoch 8  | loss: 0.65692 | train_auc: 0.6088  | train_balanced_accuracy: 0.5714  | train_accuracy: 0.56982 | valid_auc: 0.59478 | valid_balanced_accuracy: 0.55829 | valid_accuracy: 0.55666 |  0:02:26s
epoch 9  | loss: 0.65924 | train_auc: 0.61949 | train_balanced_accuracy: 0.57514 | train_accuracy: 0.57348 | valid_auc: 0.60427 | valid_balanced_accuracy: 0.55768 | valid_accuracy: 0.55603 |  0:02:41s
epoch 10 | loss: 0.65381 | train_auc: 0.63074 | train_balanced_accuracy: 0.57972 | train_accuracy: 0.57828 | valid_auc: 0.61655 | valid_balanced_accuracy: 0.56365 | valid_accuracy: 0.56217 |  0:02:58s
epoch 11 | loss: 0.65097 | train_auc: 0.64038 | train_balanced_accuracy: 0.58619 | train_accuracy: 0.58493 | valid_auc: 0.62815 | valid_balanced_accuracy: 0.57418 | valid_accuracy: 0.57287 |  0:03:15s
epoch 12 | loss: 0.64605 | train_auc: 0.64564 | train_balanced_accuracy: 0.58639 | train_accuracy: 0.58509 | valid_auc: 0.63716 | valid_balanced_accuracy: 0.57796 | valid_accuracy: 0.57664 |  0:03:32s
epoch 13 | loss: 0.64845 | train_auc: 0.64815 | train_balanced_accuracy: 0.58862 | train_accuracy: 0.58741 | valid_auc: 0.64074 | valid_balanced_accuracy: 0.58089 | valid_accuracy: 0.57963 |  0:03:49s
epoch 14 | loss: 0.64382 | train_auc: 0.65945 | train_balanced_accuracy: 0.596   | train_accuracy: 0.59504 | valid_auc: 0.65127 | valid_balanced_accuracy: 0.58617 | valid_accuracy: 0.58514 |  0:04:06s
epoch 15 | loss: 0.64265 | train_auc: 0.66784 | train_balanced_accuracy: 0.60687 | train_accuracy: 0.60614 | valid_auc: 0.65921 | valid_balanced_accuracy: 0.59522 | valid_accuracy: 0.59443 |  0:04:22s
epoch 16 | loss: 0.63722 | train_auc: 0.67099 | train_balanced_accuracy: 0.61307 | train_accuracy: 0.61263 | valid_auc: 0.6636  | valid_balanced_accuracy: 0.60264 | valid_accuracy: 0.60214 |  0:04:37s
epoch 17 | loss: 0.64169 | train_auc: 0.67145 | train_balanced_accuracy: 0.6119  | train_accuracy: 0.61129 | valid_auc: 0.66451 | valid_balanced_accuracy: 0.60045 | valid_accuracy: 0.59978 |  0:04:55s
epoch 18 | loss: 0.63334 | train_auc: 0.67512 | train_balanced_accuracy: 0.62357 | train_accuracy: 0.62345 | valid_auc: 0.66602 | valid_balanced_accuracy: 0.61222 | valid_accuracy: 0.61206 |  0:05:13s
epoch 19 | loss: 0.63277 | train_auc: 0.67546 | train_balanced_accuracy: 0.62165 | train_accuracy: 0.62148 | valid_auc: 0.66659 | valid_balanced_accuracy: 0.61524 | valid_accuracy: 0.61505 |  0:05:29s
epoch 20 | loss: 0.63519 | train_auc: 0.67192 | train_balanced_accuracy: 0.62083 | train_accuracy: 0.62054 | valid_auc: 0.66413 | valid_balanced_accuracy: 0.61189 | valid_accuracy: 0.61158 |  0:05:47s
epoch 21 | loss: 0.6305  | train_auc: 0.68197 | train_balanced_accuracy: 0.63572 | train_accuracy: 0.63592 | valid_auc: 0.67422 | valid_balanced_accuracy: 0.63059 | valid_accuracy: 0.63078 |  0:06:02s
epoch 22 | loss: 0.63303 | train_auc: 0.6841  | train_balanced_accuracy: 0.63682 | train_accuracy: 0.63703 | valid_auc: 0.67955 | valid_balanced_accuracy: 0.63972 | valid_accuracy: 0.63991 |  0:06:18s
epoch 23 | loss: 0.63044 | train_auc: 0.68768 | train_balanced_accuracy: 0.64175 | train_accuracy: 0.64214 | valid_auc: 0.6812  | valid_balanced_accuracy: 0.64734 | valid_accuracy: 0.64778 |  0:06:36s
epoch 24 | loss: 0.63461 | train_auc: 0.69156 | train_balanced_accuracy: 0.64327 | train_accuracy: 0.64364 | valid_auc: 0.68056 | valid_balanced_accuracy: 0.63949 | valid_accuracy: 0.63991 |  0:06:53s
epoch 25 | loss: 0.62994 | train_auc: 0.69055 | train_balanced_accuracy: 0.64188 | train_accuracy: 0.64214 | valid_auc: 0.67888 | valid_balanced_accuracy: 0.63932 | valid_accuracy: 0.6396  |  0:07:11s
epoch 26 | loss: 0.63017 | train_auc: 0.6973  | train_balanced_accuracy: 0.65103 | train_accuracy: 0.65135 | valid_auc: 0.68659 | valid_balanced_accuracy: 0.64197 | valid_accuracy: 0.64227 |  0:07:27s
epoch 27 | loss: 0.62868 | train_auc: 0.70328 | train_balanced_accuracy: 0.6566  | train_accuracy: 0.65697 | valid_auc: 0.68988 | valid_balanced_accuracy: 0.64866 | valid_accuracy: 0.64904 |  0:07:46s
epoch 28 | loss: 0.6272  | train_auc: 0.70483 | train_balanced_accuracy: 0.65775 | train_accuracy: 0.65815 | valid_auc: 0.69251 | valid_balanced_accuracy: 0.6486  | valid_accuracy: 0.64904 |  0:08:02s
epoch 29 | loss: 0.62432 | train_auc: 0.70949 | train_balanced_accuracy: 0.65839 | train_accuracy: 0.65874 | valid_auc: 0.69598 | valid_balanced_accuracy: 0.64726 | valid_accuracy: 0.64762 |  0:08:18s
epoch 30 | loss: 0.62496 | train_auc: 0.70839 | train_balanced_accuracy: 0.65572 | train_accuracy: 0.65611 | valid_auc: 0.69497 | valid_balanced_accuracy: 0.64546 | valid_accuracy: 0.64589 |  0:08:33s
epoch 31 | loss: 0.62197 | train_auc: 0.70959 | train_balanced_accuracy: 0.65935 | train_accuracy: 0.65981 | valid_auc: 0.69557 | valid_balanced_accuracy: 0.64696 | valid_accuracy: 0.64747 |  0:08:50s
epoch 32 | loss: 0.62636 | train_auc: 0.7071  | train_balanced_accuracy: 0.65532 | train_accuracy: 0.65568 | valid_auc: 0.69657 | valid_balanced_accuracy: 0.64751 | valid_accuracy: 0.64794 |  0:09:08s
epoch 33 | loss: 0.62307 | train_auc: 0.70746 | train_balanced_accuracy: 0.65498 | train_accuracy: 0.65524 | valid_auc: 0.69698 | valid_balanced_accuracy: 0.64919 | valid_accuracy: 0.64951 |  0:09:24s
epoch 34 | loss: 0.62048 | train_auc: 0.71244 | train_balanced_accuracy: 0.65745 | train_accuracy: 0.65768 | valid_auc: 0.69517 | valid_balanced_accuracy: 0.64341 | valid_accuracy: 0.64369 |  0:09:42s
epoch 35 | loss: 0.61856 | train_auc: 0.70812 | train_balanced_accuracy: 0.65696 | train_accuracy: 0.65745 | valid_auc: 0.69637 | valid_balanced_accuracy: 0.64316 | valid_accuracy: 0.64369 |  0:09:59s
epoch 36 | loss: 0.62279 | train_auc: 0.69331 | train_balanced_accuracy: 0.64137 | train_accuracy: 0.64159 | valid_auc: 0.67451 | valid_balanced_accuracy: 0.62538 | valid_accuracy: 0.62559 |  0:10:16s
epoch 37 | loss: 0.61737 | train_auc: 0.68117 | train_balanced_accuracy: 0.63126 | train_accuracy: 0.63163 | valid_auc: 0.6648  | valid_balanced_accuracy: 0.62296 | valid_accuracy: 0.62323 |  0:10:32s
epoch 38 | loss: 0.61908 | train_auc: 0.68149 | train_balanced_accuracy: 0.63205 | train_accuracy: 0.6323  | valid_auc: 0.66628 | valid_balanced_accuracy: 0.61991 | valid_accuracy: 0.62008 |  0:10:49s
epoch 39 | loss: 0.61844 | train_auc: 0.66907 | train_balanced_accuracy: 0.62348 | train_accuracy: 0.62388 | valid_auc: 0.66009 | valid_balanced_accuracy: 0.62032 | valid_accuracy: 0.62071 |  0:11:08s
epoch 40 | loss: 0.61701 | train_auc: 0.65569 | train_balanced_accuracy: 0.61738 | train_accuracy: 0.61778 | valid_auc: 0.64915 | valid_balanced_accuracy: 0.61609 | valid_accuracy: 0.61646 |  0:11:26s
epoch 41 | loss: 0.61717 | train_auc: 0.65477 | train_balanced_accuracy: 0.61389 | train_accuracy: 0.6142  | valid_auc: 0.64799 | valid_balanced_accuracy: 0.61188 | valid_accuracy: 0.61221 |  0:11:42s
epoch 42 | loss: 0.61311 | train_auc: 0.65148 | train_balanced_accuracy: 0.61057 | train_accuracy: 0.61117 | valid_auc: 0.63931 | valid_balanced_accuracy: 0.60961 | valid_accuracy: 0.61017 |  0:11:58s
epoch 43 | loss: 0.6168  | train_auc: 0.65391 | train_balanced_accuracy: 0.61244 | train_accuracy: 0.61283 | valid_auc: 0.6434  | valid_balanced_accuracy: 0.61063 | valid_accuracy: 0.61095 |  0:12:15s
epoch 44 | loss: 0.61382 | train_auc: 0.65813 | train_balanced_accuracy: 0.61462 | train_accuracy: 0.61507 | valid_auc: 0.65017 | valid_balanced_accuracy: 0.61459 | valid_accuracy: 0.61505 |  0:12:31s
epoch 45 | loss: 0.61573 | train_auc: 0.69115 | train_balanced_accuracy: 0.63919 | train_accuracy: 0.63954 | valid_auc: 0.68013 | valid_balanced_accuracy: 0.62876 | valid_accuracy: 0.62905 |  0:12:49s
epoch 46 | loss: 0.6146  | train_auc: 0.709   | train_balanced_accuracy: 0.65693 | train_accuracy: 0.65725 | valid_auc: 0.69566 | valid_balanced_accuracy: 0.64121 | valid_accuracy: 0.64149 |  0:13:05s
epoch 47 | loss: 0.61369 | train_auc: 0.69838 | train_balanced_accuracy: 0.64569 | train_accuracy: 0.64596 | valid_auc: 0.68563 | valid_balanced_accuracy: 0.63782 | valid_accuracy: 0.63802 |  0:13:21s
epoch 48 | loss: 0.60827 | train_auc: 0.68736 | train_balanced_accuracy: 0.63505 | train_accuracy: 0.63549 | valid_auc: 0.68075 | valid_balanced_accuracy: 0.63242 | valid_accuracy: 0.63283 |  0:13:38s
epoch 49 | loss: 0.61121 | train_auc: 0.68536 | train_balanced_accuracy: 0.63611 | train_accuracy: 0.63644 | valid_auc: 0.6798  | valid_balanced_accuracy: 0.63365 | valid_accuracy: 0.63393 |  0:13:53s
epoch 50 | loss: 0.61083 | train_auc: 0.70096 | train_balanced_accuracy: 0.65011 | train_accuracy: 0.65052 | valid_auc: 0.68552 | valid_balanced_accuracy: 0.63516 | valid_accuracy: 0.63551 |  0:14:10s
epoch 51 | loss: 0.60833 | train_auc: 0.71453 | train_balanced_accuracy: 0.66331 | train_accuracy: 0.66374 | valid_auc: 0.7017  | valid_balanced_accuracy: 0.65332 | valid_accuracy: 0.65376 |  0:14:27s
epoch 52 | loss: 0.60754 | train_auc: 0.73669 | train_balanced_accuracy: 0.67514 | train_accuracy: 0.67555 | valid_auc: 0.71661 | valid_balanced_accuracy: 0.6623  | valid_accuracy: 0.66273 |  0:14:42s
epoch 53 | loss: 0.60857 | train_auc: 0.73468 | train_balanced_accuracy: 0.67438 | train_accuracy: 0.6748  | valid_auc: 0.71338 | valid_balanced_accuracy: 0.65472 | valid_accuracy: 0.65518 |  0:15:00s
epoch 54 | loss: 0.60902 | train_auc: 0.7174  | train_balanced_accuracy: 0.66193 | train_accuracy: 0.66236 | valid_auc: 0.70793 | valid_balanced_accuracy: 0.65473 | valid_accuracy: 0.65518 |  0:15:19s
epoch 55 | loss: 0.61208 | train_auc: 0.72672 | train_balanced_accuracy: 0.66705 | train_accuracy: 0.66752 | valid_auc: 0.71283 | valid_balanced_accuracy: 0.65593 | valid_accuracy: 0.65644 |  0:15:35s
epoch 56 | loss: 0.60778 | train_auc: 0.71311 | train_balanced_accuracy: 0.65782 | train_accuracy: 0.65819 | valid_auc: 0.70816 | valid_balanced_accuracy: 0.65648 | valid_accuracy: 0.65691 |  0:15:52s
epoch 57 | loss: 0.60402 | train_auc: 0.71037 | train_balanced_accuracy: 0.65989 | train_accuracy: 0.66016 | valid_auc: 0.70171 | valid_balanced_accuracy: 0.65538 | valid_accuracy: 0.65565 |  0:16:08s
epoch 58 | loss: 0.6078  | train_auc: 0.71888 | train_balanced_accuracy: 0.66238 | train_accuracy: 0.66272 | valid_auc: 0.71042 | valid_balanced_accuracy: 0.65954 | valid_accuracy: 0.6599  |  0:16:24s
epoch 59 | loss: 0.60501 | train_auc: 0.71703 | train_balanced_accuracy: 0.65985 | train_accuracy: 0.66028 | valid_auc: 0.70791 | valid_balanced_accuracy: 0.65723 | valid_accuracy: 0.6577  |  0:16:40s
epoch 60 | loss: 0.60749 | train_auc: 0.69758 | train_balanced_accuracy: 0.64829 | train_accuracy: 0.64824 | valid_auc: 0.69867 | valid_balanced_accuracy: 0.64767 | valid_accuracy: 0.64762 |  0:16:55s
epoch 61 | loss: 0.60835 | train_auc: 0.70312 | train_balanced_accuracy: 0.65102 | train_accuracy: 0.65088 | valid_auc: 0.6994  | valid_balanced_accuracy: 0.64854 | valid_accuracy: 0.64841 |  0:17:12s
epoch 62 | loss: 0.60287 | train_auc: 0.70566 | train_balanced_accuracy: 0.65314 | train_accuracy: 0.6532  | valid_auc: 0.70109 | valid_balanced_accuracy: 0.64443 | valid_accuracy: 0.64448 |  0:17:27s
epoch 63 | loss: 0.60748 | train_auc: 0.7101  | train_balanced_accuracy: 0.65577 | train_accuracy: 0.65591 | valid_auc: 0.70524 | valid_balanced_accuracy: 0.65082 | valid_accuracy: 0.65093 |  0:17:42s
epoch 64 | loss: 0.60553 | train_auc: 0.72118 | train_balanced_accuracy: 0.66672 | train_accuracy: 0.66713 | valid_auc: 0.7137  | valid_balanced_accuracy: 0.66324 | valid_accuracy: 0.66368 |  0:18:00s
epoch 65 | loss: 0.60532 | train_auc: 0.72032 | train_balanced_accuracy: 0.66312 | train_accuracy: 0.66351 | valid_auc: 0.70966 | valid_balanced_accuracy: 0.66056 | valid_accuracy: 0.661   |  0:18:17s
epoch 66 | loss: 0.60308 | train_auc: 0.72442 | train_balanced_accuracy: 0.66684 | train_accuracy: 0.66717 | valid_auc: 0.71186 | valid_balanced_accuracy: 0.65861 | valid_accuracy: 0.65895 |  0:18:34s
epoch 67 | loss: 0.60333 | train_auc: 0.72578 | train_balanced_accuracy: 0.66665 | train_accuracy: 0.66728 | valid_auc: 0.71239 | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66226 |  0:18:51s
epoch 68 | loss: 0.60597 | train_auc: 0.7409  | train_balanced_accuracy: 0.67734 | train_accuracy: 0.67775 | valid_auc: 0.72228 | valid_balanced_accuracy: 0.66575 | valid_accuracy: 0.66619 |  0:19:06s
epoch 69 | loss: 0.60376 | train_auc: 0.7275  | train_balanced_accuracy: 0.66921 | train_accuracy: 0.66957 | valid_auc: 0.7137  | valid_balanced_accuracy: 0.65477 | valid_accuracy: 0.65518 |  0:19:23s
epoch 70 | loss: 0.60376 | train_auc: 0.72897 | train_balanced_accuracy: 0.67178 | train_accuracy: 0.67208 | valid_auc: 0.71634 | valid_balanced_accuracy: 0.65863 | valid_accuracy: 0.65895 |  0:19:38s
epoch 71 | loss: 0.60453 | train_auc: 0.73979 | train_balanced_accuracy: 0.67604 | train_accuracy: 0.67629 | valid_auc: 0.72202 | valid_balanced_accuracy: 0.6648  | valid_accuracy: 0.66509 |  0:19:54s
epoch 72 | loss: 0.60121 | train_auc: 0.74539 | train_balanced_accuracy: 0.68073 | train_accuracy: 0.68102 | valid_auc: 0.72461 | valid_balanced_accuracy: 0.6687  | valid_accuracy: 0.66903 |  0:20:11s
epoch 73 | loss: 0.60189 | train_auc: 0.74391 | train_balanced_accuracy: 0.68072 | train_accuracy: 0.68105 | valid_auc: 0.72264 | valid_balanced_accuracy: 0.6685  | valid_accuracy: 0.66887 |  0:20:28s
epoch 74 | loss: 0.60263 | train_auc: 0.74236 | train_balanced_accuracy: 0.68125 | train_accuracy: 0.68153 | valid_auc: 0.72025 | valid_balanced_accuracy: 0.66366 | valid_accuracy: 0.66399 |  0:20:42s
epoch 75 | loss: 0.60467 | train_auc: 0.73087 | train_balanced_accuracy: 0.67063 | train_accuracy: 0.67086 | valid_auc: 0.71061 | valid_balanced_accuracy: 0.65666 | valid_accuracy: 0.65691 |  0:20:59s
epoch 76 | loss: 0.60382 | train_auc: 0.71323 | train_balanced_accuracy: 0.6575  | train_accuracy: 0.6578  | valid_auc: 0.69164 | valid_balanced_accuracy: 0.6412  | valid_accuracy: 0.64149 |  0:21:17s
epoch 77 | loss: 0.60422 | train_auc: 0.71967 | train_balanced_accuracy: 0.66349 | train_accuracy: 0.66378 | valid_auc: 0.69875 | valid_balanced_accuracy: 0.64575 | valid_accuracy: 0.64605 |  0:21:33s
epoch 78 | loss: 0.59986 | train_auc: 0.72114 | train_balanced_accuracy: 0.66489 | train_accuracy: 0.66524 | valid_auc: 0.69819 | valid_balanced_accuracy: 0.64431 | valid_accuracy: 0.64463 |  0:21:49s
epoch 79 | loss: 0.60197 | train_auc: 0.71398 | train_balanced_accuracy: 0.65898 | train_accuracy: 0.65926 | valid_auc: 0.69294 | valid_balanced_accuracy: 0.64202 | valid_accuracy: 0.64227 |  0:22:06s
epoch 80 | loss: 0.60415 | train_auc: 0.74613 | train_balanced_accuracy: 0.68259 | train_accuracy: 0.6829  | valid_auc: 0.72312 | valid_balanced_accuracy: 0.66933 | valid_accuracy: 0.66966 |  0:22:22s
epoch 81 | loss: 0.5956  | train_auc: 0.74574 | train_balanced_accuracy: 0.68179 | train_accuracy: 0.68208 | valid_auc: 0.72213 | valid_balanced_accuracy: 0.66619 | valid_accuracy: 0.66651 |  0:22:39s
epoch 82 | loss: 0.60139 | train_auc: 0.74672 | train_balanced_accuracy: 0.6838  | train_accuracy: 0.68404 | valid_auc: 0.72276 | valid_balanced_accuracy: 0.66448 | valid_accuracy: 0.66478 |  0:22:56s
epoch 83 | loss: 0.5998  | train_auc: 0.71228 | train_balanced_accuracy: 0.65811 | train_accuracy: 0.65843 | valid_auc: 0.69239 | valid_balanced_accuracy: 0.64581 | valid_accuracy: 0.64605 |  0:23:13s
epoch 84 | loss: 0.60018 | train_auc: 0.69892 | train_balanced_accuracy: 0.64816 | train_accuracy: 0.64848 | valid_auc: 0.67799 | valid_balanced_accuracy: 0.63731 | valid_accuracy: 0.63755 |  0:23:30s
epoch 85 | loss: 0.60423 | train_auc: 0.70141 | train_balanced_accuracy: 0.64801 | train_accuracy: 0.64832 | valid_auc: 0.68294 | valid_balanced_accuracy: 0.63633 | valid_accuracy: 0.63661 |  0:23:47s
epoch 86 | loss: 0.60208 | train_auc: 0.72257 | train_balanced_accuracy: 0.66443 | train_accuracy: 0.6648  | valid_auc: 0.70024 | valid_balanced_accuracy: 0.64665 | valid_accuracy: 0.64699 |  0:24:04s
epoch 87 | loss: 0.59542 | train_auc: 0.72837 | train_balanced_accuracy: 0.6709  | train_accuracy: 0.67114 | valid_auc: 0.70411 | valid_balanced_accuracy: 0.65431 | valid_accuracy: 0.65455 |  0:24:20s
epoch 88 | loss: 0.59939 | train_auc: 0.735   | train_balanced_accuracy: 0.67656 | train_accuracy: 0.67677 | valid_auc: 0.71205 | valid_balanced_accuracy: 0.65717 | valid_accuracy: 0.65738 |  0:24:35s
epoch 89 | loss: 0.60044 | train_auc: 0.73737 | train_balanced_accuracy: 0.67574 | train_accuracy: 0.67578 | valid_auc: 0.71324 | valid_balanced_accuracy: 0.6559  | valid_accuracy: 0.65596 |  0:24:51s
epoch 90 | loss: 0.60055 | train_auc: 0.74142 | train_balanced_accuracy: 0.68093 | train_accuracy: 0.68113 | valid_auc: 0.71726 | valid_balanced_accuracy: 0.6595  | valid_accuracy: 0.65974 |  0:25:08s
epoch 91 | loss: 0.59677 | train_auc: 0.75045 | train_balanced_accuracy: 0.68608 | train_accuracy: 0.68633 | valid_auc: 0.72638 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.67312 |  0:25:25s
epoch 92 | loss: 0.6003  | train_auc: 0.74028 | train_balanced_accuracy: 0.67912 | train_accuracy: 0.67936 | valid_auc: 0.71509 | valid_balanced_accuracy: 0.65915 | valid_accuracy: 0.65943 |  0:25:41s
epoch 93 | loss: 0.59605 | train_auc: 0.74611 | train_balanced_accuracy: 0.68444 | train_accuracy: 0.68475 | valid_auc: 0.72077 | valid_balanced_accuracy: 0.66453 | valid_accuracy: 0.66494 |  0:25:58s
epoch 94 | loss: 0.59513 | train_auc: 0.75137 | train_balanced_accuracy: 0.68822 | train_accuracy: 0.68857 | valid_auc: 0.7288  | valid_balanced_accuracy: 0.67333 | valid_accuracy: 0.67375 |  0:26:14s
epoch 95 | loss: 0.59611 | train_auc: 0.74771 | train_balanced_accuracy: 0.68572 | train_accuracy: 0.68597 | valid_auc: 0.72294 | valid_balanced_accuracy: 0.6665  | valid_accuracy: 0.66682 |  0:26:31s
epoch 96 | loss: 0.59791 | train_auc: 0.74112 | train_balanced_accuracy: 0.68042 | train_accuracy: 0.68074 | valid_auc: 0.71745 | valid_balanced_accuracy: 0.6646  | valid_accuracy: 0.66494 |  0:26:47s
epoch 97 | loss: 0.5965  | train_auc: 0.73339 | train_balanced_accuracy: 0.675   | train_accuracy: 0.67539 | valid_auc: 0.71111 | valid_balanced_accuracy: 0.65838 | valid_accuracy: 0.6588  |  0:27:05s
epoch 98 | loss: 0.59514 | train_auc: 0.73492 | train_balanced_accuracy: 0.67556 | train_accuracy: 0.67578 | valid_auc: 0.71222 | valid_balanced_accuracy: 0.65902 | valid_accuracy: 0.65927 |  0:27:21s
epoch 99 | loss: 0.59586 | train_auc: 0.73947 | train_balanced_accuracy: 0.67844 | train_accuracy: 0.67873 | valid_auc: 0.71498 | valid_balanced_accuracy: 0.65735 | valid_accuracy: 0.6577  |  0:27:39s
epoch 100| loss: 0.60098 | train_auc: 0.74506 | train_balanced_accuracy: 0.68232 | train_accuracy: 0.68263 | valid_auc: 0.71999 | valid_balanced_accuracy: 0.66329 | valid_accuracy: 0.66368 |  0:27:56s
epoch 101| loss: 0.59645 | train_auc: 0.75287 | train_balanced_accuracy: 0.68863 | train_accuracy: 0.68904 | valid_auc: 0.72502 | valid_balanced_accuracy: 0.66478 | valid_accuracy: 0.66525 |  0:28:14s
epoch 102| loss: 0.59447 | train_auc: 0.74798 | train_balanced_accuracy: 0.6847  | train_accuracy: 0.68503 | valid_auc: 0.72307 | valid_balanced_accuracy: 0.66329 | valid_accuracy: 0.66368 |  0:28:31s
epoch 103| loss: 0.59757 | train_auc: 0.74753 | train_balanced_accuracy: 0.68474 | train_accuracy: 0.68523 | valid_auc: 0.72154 | valid_balanced_accuracy: 0.66141 | valid_accuracy: 0.66195 |  0:28:48s
epoch 104| loss: 0.60174 | train_auc: 0.75156 | train_balanced_accuracy: 0.68718 | train_accuracy: 0.68735 | valid_auc: 0.72309 | valid_balanced_accuracy: 0.66394 | valid_accuracy: 0.66415 |  0:29:06s
epoch 105| loss: 0.59429 | train_auc: 0.75362 | train_balanced_accuracy: 0.68874 | train_accuracy: 0.68904 | valid_auc: 0.72665 | valid_balanced_accuracy: 0.66776 | valid_accuracy: 0.66808 |  0:29:22s
epoch 106| loss: 0.59731 | train_auc: 0.75232 | train_balanced_accuracy: 0.68692 | train_accuracy: 0.68715 | valid_auc: 0.72407 | valid_balanced_accuracy: 0.66215 | valid_accuracy: 0.66242 |  0:29:39s
epoch 107| loss: 0.59255 | train_auc: 0.74596 | train_balanced_accuracy: 0.68363 | train_accuracy: 0.68381 | valid_auc: 0.72516 | valid_balanced_accuracy: 0.66818 | valid_accuracy: 0.6684  |  0:29:57s
epoch 108| loss: 0.59064 | train_auc: 0.75428 | train_balanced_accuracy: 0.6886  | train_accuracy: 0.68877 | valid_auc: 0.72647 | valid_balanced_accuracy: 0.67403 | valid_accuracy: 0.67422 |  0:30:13s
epoch 109| loss: 0.59155 | train_auc: 0.75284 | train_balanced_accuracy: 0.68865 | train_accuracy: 0.68881 | valid_auc: 0.72606 | valid_balanced_accuracy: 0.66867 | valid_accuracy: 0.66887 |  0:30:30s
epoch 110| loss: 0.5941  | train_auc: 0.75442 | train_balanced_accuracy: 0.68942 | train_accuracy: 0.68963 | valid_auc: 0.72698 | valid_balanced_accuracy: 0.67239 | valid_accuracy: 0.67265 |  0:30:47s
epoch 111| loss: 0.59265 | train_auc: 0.75295 | train_balanced_accuracy: 0.68792 | train_accuracy: 0.6881  | valid_auc: 0.72832 | valid_balanced_accuracy: 0.66945 | valid_accuracy: 0.66966 |  0:31:05s
epoch 112| loss: 0.59509 | train_auc: 0.75532 | train_balanced_accuracy: 0.69023 | train_accuracy: 0.69046 | valid_auc: 0.72765 | valid_balanced_accuracy: 0.67127 | valid_accuracy: 0.67155 |  0:31:23s
epoch 113| loss: 0.59552 | train_auc: 0.73698 | train_balanced_accuracy: 0.67582 | train_accuracy: 0.67594 | valid_auc: 0.71377 | valid_balanced_accuracy: 0.6577  | valid_accuracy: 0.65785 |  0:31:39s
epoch 114| loss: 0.59932 | train_auc: 0.74106 | train_balanced_accuracy: 0.67863 | train_accuracy: 0.67877 | valid_auc: 0.71502 | valid_balanced_accuracy: 0.65486 | valid_accuracy: 0.65502 |  0:31:55s
epoch 115| loss: 0.59051 | train_auc: 0.73999 | train_balanced_accuracy: 0.67939 | train_accuracy: 0.6796  | valid_auc: 0.71517 | valid_balanced_accuracy: 0.6576  | valid_accuracy: 0.65785 |  0:32:12s
epoch 116| loss: 0.59194 | train_auc: 0.7291  | train_balanced_accuracy: 0.67194 | train_accuracy: 0.67236 | valid_auc: 0.71168 | valid_balanced_accuracy: 0.65803 | valid_accuracy: 0.65848 |  0:32:27s
epoch 117| loss: 0.58987 | train_auc: 0.73174 | train_balanced_accuracy: 0.67199 | train_accuracy: 0.67252 | valid_auc: 0.71783 | valid_balanced_accuracy: 0.66564 | valid_accuracy: 0.66619 |  0:32:44s
epoch 118| loss: 0.59328 | train_auc: 0.75043 | train_balanced_accuracy: 0.68473 | train_accuracy: 0.68499 | valid_auc: 0.72981 | valid_balanced_accuracy: 0.66617 | valid_accuracy: 0.66651 |  0:33:03s
epoch 119| loss: 0.59459 | train_auc: 0.75773 | train_balanced_accuracy: 0.69105 | train_accuracy: 0.6914  | valid_auc: 0.73073 | valid_balanced_accuracy: 0.67554 | valid_accuracy: 0.67595 |  0:33:19s
epoch 120| loss: 0.5889  | train_auc: 0.74451 | train_balanced_accuracy: 0.68258 | train_accuracy: 0.68275 | valid_auc: 0.7195  | valid_balanced_accuracy: 0.66454 | valid_accuracy: 0.66478 |  0:33:36s
epoch 121| loss: 0.59229 | train_auc: 0.75241 | train_balanced_accuracy: 0.68876 | train_accuracy: 0.689   | valid_auc: 0.72667 | valid_balanced_accuracy: 0.67172 | valid_accuracy: 0.67202 |  0:33:53s
epoch 122| loss: 0.59124 | train_auc: 0.75941 | train_balanced_accuracy: 0.69396 | train_accuracy: 0.69424 | valid_auc: 0.73072 | valid_balanced_accuracy: 0.6775  | valid_accuracy: 0.67784 |  0:34:09s
epoch 123| loss: 0.59024 | train_auc: 0.75932 | train_balanced_accuracy: 0.69293 | train_accuracy: 0.69309 | valid_auc: 0.73036 | valid_balanced_accuracy: 0.6751  | valid_accuracy: 0.67532 |  0:34:26s
epoch 124| loss: 0.59177 | train_auc: 0.75945 | train_balanced_accuracy: 0.69382 | train_accuracy: 0.69408 | valid_auc: 0.73218 | valid_balanced_accuracy: 0.67578 | valid_accuracy: 0.67611 |  0:34:44s
epoch 125| loss: 0.59261 | train_auc: 0.75758 | train_balanced_accuracy: 0.69028 | train_accuracy: 0.69058 | valid_auc: 0.73238 | valid_balanced_accuracy: 0.6792  | valid_accuracy: 0.67957 |  0:35:01s
epoch 126| loss: 0.58936 | train_auc: 0.75205 | train_balanced_accuracy: 0.68691 | train_accuracy: 0.68719 | valid_auc: 0.72945 | valid_balanced_accuracy: 0.67041 | valid_accuracy: 0.67076 |  0:35:17s
epoch 127| loss: 0.59326 | train_auc: 0.74611 | train_balanced_accuracy: 0.68254 | train_accuracy: 0.68283 | valid_auc: 0.72637 | valid_balanced_accuracy: 0.66554 | valid_accuracy: 0.66588 |  0:35:35s
epoch 128| loss: 0.59362 | train_auc: 0.75801 | train_balanced_accuracy: 0.69113 | train_accuracy: 0.69132 | valid_auc: 0.73203 | valid_balanced_accuracy: 0.6765  | valid_accuracy: 0.67674 |  0:35:52s
epoch 129| loss: 0.59235 | train_auc: 0.75139 | train_balanced_accuracy: 0.6869  | train_accuracy: 0.68719 | valid_auc: 0.72921 | valid_balanced_accuracy: 0.66914 | valid_accuracy: 0.6695  |  0:36:11s
epoch 130| loss: 0.58955 | train_auc: 0.74709 | train_balanced_accuracy: 0.68405 | train_accuracy: 0.68436 | valid_auc: 0.72683 | valid_balanced_accuracy: 0.6652  | valid_accuracy: 0.66556 |  0:36:26s
epoch 131| loss: 0.59652 | train_auc: 0.74757 | train_balanced_accuracy: 0.68427 | train_accuracy: 0.68456 | valid_auc: 0.72845 | valid_balanced_accuracy: 0.66761 | valid_accuracy: 0.66793 |  0:36:44s
epoch 132| loss: 0.59177 | train_auc: 0.75278 | train_balanced_accuracy: 0.6874  | train_accuracy: 0.68778 | valid_auc: 0.73144 | valid_balanced_accuracy: 0.67252 | valid_accuracy: 0.67296 |  0:36:59s
epoch 133| loss: 0.59533 | train_auc: 0.75438 | train_balanced_accuracy: 0.68915 | train_accuracy: 0.68955 | valid_auc: 0.72723 | valid_balanced_accuracy: 0.67265 | valid_accuracy: 0.67312 |  0:37:16s
epoch 134| loss: 0.59188 | train_auc: 0.74774 | train_balanced_accuracy: 0.68416 | train_accuracy: 0.68436 | valid_auc: 0.72083 | valid_balanced_accuracy: 0.66402 | valid_accuracy: 0.66431 |  0:37:35s
epoch 135| loss: 0.59057 | train_auc: 0.74434 | train_balanced_accuracy: 0.68087 | train_accuracy: 0.68121 | valid_auc: 0.7171  | valid_balanced_accuracy: 0.66357 | valid_accuracy: 0.66399 |  0:37:50s
epoch 136| loss: 0.59478 | train_auc: 0.75946 | train_balanced_accuracy: 0.69177 | train_accuracy: 0.69199 | valid_auc: 0.72931 | valid_balanced_accuracy: 0.6722  | valid_accuracy: 0.67249 |  0:38:06s
epoch 137| loss: 0.59165 | train_auc: 0.76106 | train_balanced_accuracy: 0.69354 | train_accuracy: 0.69396 | valid_auc: 0.73209 | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67359 |  0:38:23s
epoch 138| loss: 0.59054 | train_auc: 0.76174 | train_balanced_accuracy: 0.69311 | train_accuracy: 0.69333 | valid_auc: 0.73115 | valid_balanced_accuracy: 0.67267 | valid_accuracy: 0.67296 |  0:38:40s
epoch 139| loss: 0.59281 | train_auc: 0.76287 | train_balanced_accuracy: 0.69459 | train_accuracy: 0.69479 | valid_auc: 0.73209 | valid_balanced_accuracy: 0.67458 | valid_accuracy: 0.67485 |  0:38:57s
epoch 140| loss: 0.59179 | train_auc: 0.76076 | train_balanced_accuracy: 0.69288 | train_accuracy: 0.69309 | valid_auc: 0.73236 | valid_balanced_accuracy: 0.67724 | valid_accuracy: 0.67753 |  0:39:13s
epoch 141| loss: 0.59301 | train_auc: 0.75075 | train_balanced_accuracy: 0.68551 | train_accuracy: 0.68574 | valid_auc: 0.72966 | valid_balanced_accuracy: 0.66622 | valid_accuracy: 0.66651 |  0:39:30s
epoch 142| loss: 0.59231 | train_auc: 0.75685 | train_balanced_accuracy: 0.69157 | train_accuracy: 0.69184 | valid_auc: 0.73126 | valid_balanced_accuracy: 0.67324 | valid_accuracy: 0.67359 |  0:39:46s
epoch 143| loss: 0.58865 | train_auc: 0.75713 | train_balanced_accuracy: 0.69268 | train_accuracy: 0.69306 | valid_auc: 0.73138 | valid_balanced_accuracy: 0.6733  | valid_accuracy: 0.67375 |  0:40:03s
epoch 144| loss: 0.59049 | train_auc: 0.7607  | train_balanced_accuracy: 0.69359 | train_accuracy: 0.69388 | valid_auc: 0.73204 | valid_balanced_accuracy: 0.67842 | valid_accuracy: 0.67879 |  0:40:21s
epoch 145| loss: 0.58947 | train_auc: 0.76331 | train_balanced_accuracy: 0.69524 | train_accuracy: 0.69542 | valid_auc: 0.7325  | valid_balanced_accuracy: 0.67618 | valid_accuracy: 0.67642 |  0:40:38s

Early stopping occurred at epoch 145 with best_epoch = 125 and best_valid_accuracy = 0.67957
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 54/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=40.8min
[CV 2/5; 54/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83005 | train_auc: 0.51917 | train_balanced_accuracy: 0.51182 | train_accuracy: 0.50966 | valid_auc: 0.51276 | valid_balanced_accuracy: 0.50602 | valid_accuracy: 0.50378 |  0:00:18s
epoch 1  | loss: 0.75262 | train_auc: 0.5301  | train_balanced_accuracy: 0.51991 | train_accuracy: 0.51737 | valid_auc: 0.51995 | valid_balanced_accuracy: 0.51064 | valid_accuracy: 0.50803 |  0:00:35s
epoch 2  | loss: 0.71586 | train_auc: 0.54219 | train_balanced_accuracy: 0.51985 | train_accuracy: 0.51714 | valid_auc: 0.53941 | valid_balanced_accuracy: 0.51193 | valid_accuracy: 0.50913 |  0:00:53s
epoch 3  | loss: 0.69519 | train_auc: 0.54352 | train_balanced_accuracy: 0.5212  | train_accuracy: 0.51863 | valid_auc: 0.54018 | valid_balanced_accuracy: 0.51589 | valid_accuracy: 0.51322 |  0:01:11s
epoch 4  | loss: 0.68497 | train_auc: 0.55091 | train_balanced_accuracy: 0.52343 | train_accuracy: 0.52076 | valid_auc: 0.55139 | valid_balanced_accuracy: 0.51476 | valid_accuracy: 0.51196 |  0:01:27s
epoch 5  | loss: 0.67946 | train_auc: 0.56181 | train_balanced_accuracy: 0.53116 | train_accuracy: 0.52855 | valid_auc: 0.56663 | valid_balanced_accuracy: 0.5249  | valid_accuracy: 0.52219 |  0:01:44s
epoch 6  | loss: 0.67535 | train_auc: 0.56997 | train_balanced_accuracy: 0.54663 | train_accuracy: 0.54444 | valid_auc: 0.57456 | valid_balanced_accuracy: 0.54318 | valid_accuracy: 0.54092 |  0:02:00s
epoch 7  | loss: 0.66797 | train_auc: 0.58459 | train_balanced_accuracy: 0.54814 | train_accuracy: 0.5459  | valid_auc: 0.58898 | valid_balanced_accuracy: 0.54387 | valid_accuracy: 0.54155 |  0:02:18s
epoch 8  | loss: 0.65963 | train_auc: 0.59641 | train_balanced_accuracy: 0.55132 | train_accuracy: 0.54909 | valid_auc: 0.59955 | valid_balanced_accuracy: 0.54687 | valid_accuracy: 0.54454 |  0:02:35s
epoch 9  | loss: 0.66295 | train_auc: 0.61334 | train_balanced_accuracy: 0.56367 | train_accuracy: 0.56168 | valid_auc: 0.61317 | valid_balanced_accuracy: 0.55619 | valid_accuracy: 0.55414 |  0:02:51s
epoch 10 | loss: 0.65502 | train_auc: 0.62507 | train_balanced_accuracy: 0.57122 | train_accuracy: 0.56943 | valid_auc: 0.62377 | valid_balanced_accuracy: 0.57186 | valid_accuracy: 0.57003 |  0:03:07s
epoch 11 | loss: 0.65254 | train_auc: 0.63557 | train_balanced_accuracy: 0.58444 | train_accuracy: 0.583   | valid_auc: 0.63399 | valid_balanced_accuracy: 0.58002 | valid_accuracy: 0.57853 |  0:03:26s
epoch 12 | loss: 0.64959 | train_auc: 0.64316 | train_balanced_accuracy: 0.5947  | train_accuracy: 0.59351 | valid_auc: 0.63962 | valid_balanced_accuracy: 0.59064 | valid_accuracy: 0.58939 |  0:03:44s
epoch 13 | loss: 0.64906 | train_auc: 0.65156 | train_balanced_accuracy: 0.60029 | train_accuracy: 0.59921 | valid_auc: 0.6468  | valid_balanced_accuracy: 0.59331 | valid_accuracy: 0.59223 |  0:04:00s
epoch 14 | loss: 0.64931 | train_auc: 0.66137 | train_balanced_accuracy: 0.60812 | train_accuracy: 0.6072  | valid_auc: 0.65594 | valid_balanced_accuracy: 0.60245 | valid_accuracy: 0.60151 |  0:04:17s
epoch 15 | loss: 0.6435  | train_auc: 0.66705 | train_balanced_accuracy: 0.61486 | train_accuracy: 0.61405 | valid_auc: 0.66303 | valid_balanced_accuracy: 0.60565 | valid_accuracy: 0.60482 |  0:04:35s
epoch 16 | loss: 0.64373 | train_auc: 0.6769  | train_balanced_accuracy: 0.62485 | train_accuracy: 0.62412 | valid_auc: 0.67124 | valid_balanced_accuracy: 0.6205  | valid_accuracy: 0.61977 |  0:04:52s
epoch 17 | loss: 0.64009 | train_auc: 0.68282 | train_balanced_accuracy: 0.63269 | train_accuracy: 0.63211 | valid_auc: 0.67664 | valid_balanced_accuracy: 0.62745 | valid_accuracy: 0.62685 |  0:05:10s
epoch 18 | loss: 0.6382  | train_auc: 0.68756 | train_balanced_accuracy: 0.63982 | train_accuracy: 0.63962 | valid_auc: 0.6804  | valid_balanced_accuracy: 0.63856 | valid_accuracy: 0.63834 |  0:05:28s
epoch 19 | loss: 0.63517 | train_auc: 0.69216 | train_balanced_accuracy: 0.64226 | train_accuracy: 0.64206 | valid_auc: 0.6839  | valid_balanced_accuracy: 0.6381  | valid_accuracy: 0.63787 |  0:05:46s
epoch 20 | loss: 0.63792 | train_auc: 0.69716 | train_balanced_accuracy: 0.64549 | train_accuracy: 0.64548 | valid_auc: 0.68997 | valid_balanced_accuracy: 0.63869 | valid_accuracy: 0.63865 |  0:06:01s
epoch 21 | loss: 0.6332  | train_auc: 0.69914 | train_balanced_accuracy: 0.64906 | train_accuracy: 0.64922 | valid_auc: 0.69259 | valid_balanced_accuracy: 0.64547 | valid_accuracy: 0.64558 |  0:06:19s
epoch 22 | loss: 0.63616 | train_auc: 0.69962 | train_balanced_accuracy: 0.64963 | train_accuracy: 0.64997 | valid_auc: 0.6933  | valid_balanced_accuracy: 0.64449 | valid_accuracy: 0.64479 |  0:06:35s
epoch 23 | loss: 0.63364 | train_auc: 0.69993 | train_balanced_accuracy: 0.64916 | train_accuracy: 0.64942 | valid_auc: 0.69509 | valid_balanced_accuracy: 0.64365 | valid_accuracy: 0.64385 |  0:06:51s
epoch 24 | loss: 0.63085 | train_auc: 0.70308 | train_balanced_accuracy: 0.6492  | train_accuracy: 0.64954 | valid_auc: 0.69739 | valid_balanced_accuracy: 0.64814 | valid_accuracy: 0.64841 |  0:07:09s
epoch 25 | loss: 0.63173 | train_auc: 0.70449 | train_balanced_accuracy: 0.65007 | train_accuracy: 0.65048 | valid_auc: 0.69774 | valid_balanced_accuracy: 0.64666 | valid_accuracy: 0.64699 |  0:07:26s
epoch 26 | loss: 0.62825 | train_auc: 0.70654 | train_balanced_accuracy: 0.65152 | train_accuracy: 0.65194 | valid_auc: 0.69921 | valid_balanced_accuracy: 0.64929 | valid_accuracy: 0.64967 |  0:07:44s
epoch 27 | loss: 0.63067 | train_auc: 0.71036 | train_balanced_accuracy: 0.65667 | train_accuracy: 0.65713 | valid_auc: 0.70122 | valid_balanced_accuracy: 0.65002 | valid_accuracy: 0.65046 |  0:08:02s
epoch 28 | loss: 0.62725 | train_auc: 0.71094 | train_balanced_accuracy: 0.65665 | train_accuracy: 0.65709 | valid_auc: 0.69946 | valid_balanced_accuracy: 0.6474  | valid_accuracy: 0.64778 |  0:08:17s
epoch 29 | loss: 0.62762 | train_auc: 0.71235 | train_balanced_accuracy: 0.65655 | train_accuracy: 0.65697 | valid_auc: 0.70104 | valid_balanced_accuracy: 0.64868 | valid_accuracy: 0.64904 |  0:08:34s
epoch 30 | loss: 0.62407 | train_auc: 0.71429 | train_balanced_accuracy: 0.65805 | train_accuracy: 0.65847 | valid_auc: 0.70509 | valid_balanced_accuracy: 0.64918 | valid_accuracy: 0.64951 |  0:08:50s
epoch 31 | loss: 0.62451 | train_auc: 0.7155  | train_balanced_accuracy: 0.65767 | train_accuracy: 0.65804 | valid_auc: 0.70685 | valid_balanced_accuracy: 0.64783 | valid_accuracy: 0.6481  |  0:09:06s
epoch 32 | loss: 0.62559 | train_auc: 0.71812 | train_balanced_accuracy: 0.66006 | train_accuracy: 0.66044 | valid_auc: 0.70975 | valid_balanced_accuracy: 0.65206 | valid_accuracy: 0.65234 |  0:09:24s
epoch 33 | loss: 0.62438 | train_auc: 0.71742 | train_balanced_accuracy: 0.65954 | train_accuracy: 0.65985 | valid_auc: 0.70896 | valid_balanced_accuracy: 0.65307 | valid_accuracy: 0.65329 |  0:09:41s
epoch 34 | loss: 0.62371 | train_auc: 0.71814 | train_balanced_accuracy: 0.6611  | train_accuracy: 0.66142 | valid_auc: 0.71037 | valid_balanced_accuracy: 0.65789 | valid_accuracy: 0.65817 |  0:09:58s
epoch 35 | loss: 0.61891 | train_auc: 0.71865 | train_balanced_accuracy: 0.66147 | train_accuracy: 0.66197 | valid_auc: 0.71161 | valid_balanced_accuracy: 0.65595 | valid_accuracy: 0.65644 |  0:10:16s
epoch 36 | loss: 0.61952 | train_auc: 0.72033 | train_balanced_accuracy: 0.6603  | train_accuracy: 0.66055 | valid_auc: 0.71316 | valid_balanced_accuracy: 0.65545 | valid_accuracy: 0.65565 |  0:10:33s
epoch 37 | loss: 0.6209  | train_auc: 0.72152 | train_balanced_accuracy: 0.66117 | train_accuracy: 0.66158 | valid_auc: 0.71371 | valid_balanced_accuracy: 0.65686 | valid_accuracy: 0.65722 |  0:10:49s
epoch 38 | loss: 0.62199 | train_auc: 0.7227  | train_balanced_accuracy: 0.66095 | train_accuracy: 0.66122 | valid_auc: 0.71559 | valid_balanced_accuracy: 0.65748 | valid_accuracy: 0.6577  |  0:11:05s
epoch 39 | loss: 0.61766 | train_auc: 0.72086 | train_balanced_accuracy: 0.65958 | train_accuracy: 0.65993 | valid_auc: 0.71542 | valid_balanced_accuracy: 0.65881 | valid_accuracy: 0.65911 |  0:11:22s
epoch 40 | loss: 0.62107 | train_auc: 0.72016 | train_balanced_accuracy: 0.66048 | train_accuracy: 0.66087 | valid_auc: 0.71536 | valid_balanced_accuracy: 0.66036 | valid_accuracy: 0.66069 |  0:11:38s
epoch 41 | loss: 0.62131 | train_auc: 0.72565 | train_balanced_accuracy: 0.66589 | train_accuracy: 0.66626 | valid_auc: 0.718   | valid_balanced_accuracy: 0.66245 | valid_accuracy: 0.66273 |  0:11:57s
epoch 42 | loss: 0.61648 | train_auc: 0.72763 | train_balanced_accuracy: 0.66693 | train_accuracy: 0.66724 | valid_auc: 0.72029 | valid_balanced_accuracy: 0.66328 | valid_accuracy: 0.66352 |  0:12:15s
epoch 43 | loss: 0.62013 | train_auc: 0.72585 | train_balanced_accuracy: 0.66563 | train_accuracy: 0.66583 | valid_auc: 0.71999 | valid_balanced_accuracy: 0.66278 | valid_accuracy: 0.66289 |  0:12:31s
epoch 44 | loss: 0.61297 | train_auc: 0.71442 | train_balanced_accuracy: 0.65494 | train_accuracy: 0.65524 | valid_auc: 0.71219 | valid_balanced_accuracy: 0.65349 | valid_accuracy: 0.65376 |  0:12:48s
epoch 45 | loss: 0.61488 | train_auc: 0.71456 | train_balanced_accuracy: 0.65448 | train_accuracy: 0.65465 | valid_auc: 0.71238 | valid_balanced_accuracy: 0.65287 | valid_accuracy: 0.65297 |  0:13:06s
epoch 46 | loss: 0.61383 | train_auc: 0.71979 | train_balanced_accuracy: 0.65757 | train_accuracy: 0.65772 | valid_auc: 0.71506 | valid_balanced_accuracy: 0.65461 | valid_accuracy: 0.65471 |  0:13:23s
epoch 47 | loss: 0.61659 | train_auc: 0.71709 | train_balanced_accuracy: 0.65623 | train_accuracy: 0.65631 | valid_auc: 0.71227 | valid_balanced_accuracy: 0.65017 | valid_accuracy: 0.65014 |  0:13:39s
epoch 48 | loss: 0.61074 | train_auc: 0.72247 | train_balanced_accuracy: 0.66126 | train_accuracy: 0.66162 | valid_auc: 0.71652 | valid_balanced_accuracy: 0.66056 | valid_accuracy: 0.66084 |  0:13:57s
epoch 49 | loss: 0.61404 | train_auc: 0.72514 | train_balanced_accuracy: 0.66449 | train_accuracy: 0.66473 | valid_auc: 0.71902 | valid_balanced_accuracy: 0.66002 | valid_accuracy: 0.66021 |  0:14:15s
epoch 50 | loss: 0.61142 | train_auc: 0.72345 | train_balanced_accuracy: 0.66219 | train_accuracy: 0.66236 | valid_auc: 0.71665 | valid_balanced_accuracy: 0.65867 | valid_accuracy: 0.6588  |  0:14:32s
epoch 51 | loss: 0.60949 | train_auc: 0.72599 | train_balanced_accuracy: 0.66529 | train_accuracy: 0.66559 | valid_auc: 0.72023 | valid_balanced_accuracy: 0.66422 | valid_accuracy: 0.66446 |  0:14:50s
epoch 52 | loss: 0.61051 | train_auc: 0.72907 | train_balanced_accuracy: 0.66645 | train_accuracy: 0.66669 | valid_auc: 0.72353 | valid_balanced_accuracy: 0.66726 | valid_accuracy: 0.66745 |  0:15:05s
epoch 53 | loss: 0.61237 | train_auc: 0.72513 | train_balanced_accuracy: 0.66444 | train_accuracy: 0.66473 | valid_auc: 0.72034 | valid_balanced_accuracy: 0.66171 | valid_accuracy: 0.66195 |  0:15:23s
epoch 54 | loss: 0.61305 | train_auc: 0.71714 | train_balanced_accuracy: 0.65604 | train_accuracy: 0.65623 | valid_auc: 0.71297 | valid_balanced_accuracy: 0.65256 | valid_accuracy: 0.65266 |  0:15:41s
epoch 55 | loss: 0.61501 | train_auc: 0.71943 | train_balanced_accuracy: 0.65867 | train_accuracy: 0.65902 | valid_auc: 0.71487 | valid_balanced_accuracy: 0.65253 | valid_accuracy: 0.65282 |  0:15:58s
epoch 56 | loss: 0.61326 | train_auc: 0.72187 | train_balanced_accuracy: 0.66431 | train_accuracy: 0.66476 | valid_auc: 0.71599 | valid_balanced_accuracy: 0.65872 | valid_accuracy: 0.65911 |  0:16:13s
epoch 57 | loss: 0.61224 | train_auc: 0.71671 | train_balanced_accuracy: 0.65864 | train_accuracy: 0.65902 | valid_auc: 0.71063 | valid_balanced_accuracy: 0.65408 | valid_accuracy: 0.65439 |  0:16:33s
epoch 58 | loss: 0.61002 | train_auc: 0.70686 | train_balanced_accuracy: 0.64947 | train_accuracy: 0.64966 | valid_auc: 0.70675 | valid_balanced_accuracy: 0.65364 | valid_accuracy: 0.65376 |  0:16:51s
epoch 59 | loss: 0.61177 | train_auc: 0.71268 | train_balanced_accuracy: 0.65071 | train_accuracy: 0.65103 | valid_auc: 0.71369 | valid_balanced_accuracy: 0.65506 | valid_accuracy: 0.65534 |  0:17:08s
epoch 60 | loss: 0.60922 | train_auc: 0.70716 | train_balanced_accuracy: 0.64587 | train_accuracy: 0.64611 | valid_auc: 0.70825 | valid_balanced_accuracy: 0.64681 | valid_accuracy: 0.64699 |  0:17:23s
epoch 61 | loss: 0.60852 | train_auc: 0.71862 | train_balanced_accuracy: 0.65593 | train_accuracy: 0.65603 | valid_auc: 0.71815 | valid_balanced_accuracy: 0.65671 | valid_accuracy: 0.65675 |  0:17:39s
epoch 62 | loss: 0.60472 | train_auc: 0.72891 | train_balanced_accuracy: 0.66526 | train_accuracy: 0.66555 | valid_auc: 0.72421 | valid_balanced_accuracy: 0.66325 | valid_accuracy: 0.66352 |  0:17:55s
epoch 63 | loss: 0.60796 | train_auc: 0.7388  | train_balanced_accuracy: 0.6752  | train_accuracy: 0.67539 | valid_auc: 0.72567 | valid_balanced_accuracy: 0.66935 | valid_accuracy: 0.6695  |  0:18:22s
epoch 64 | loss: 0.60922 | train_auc: 0.7351  | train_balanced_accuracy: 0.67084 | train_accuracy: 0.67118 | valid_auc: 0.72331 | valid_balanced_accuracy: 0.66497 | valid_accuracy: 0.66525 |  0:18:57s
epoch 65 | loss: 0.60829 | train_auc: 0.73763 | train_balanced_accuracy: 0.67627 | train_accuracy: 0.67657 | valid_auc: 0.72598 | valid_balanced_accuracy: 0.66925 | valid_accuracy: 0.6695  |  0:19:15s
epoch 66 | loss: 0.60974 | train_auc: 0.72925 | train_balanced_accuracy: 0.66815 | train_accuracy: 0.66842 | valid_auc: 0.72135 | valid_balanced_accuracy: 0.65875 | valid_accuracy: 0.65895 |  0:19:30s
epoch 67 | loss: 0.60507 | train_auc: 0.74234 | train_balanced_accuracy: 0.67877 | train_accuracy: 0.67917 | valid_auc: 0.72745 | valid_balanced_accuracy: 0.66568 | valid_accuracy: 0.66604 |  0:19:48s
epoch 68 | loss: 0.60561 | train_auc: 0.74172 | train_balanced_accuracy: 0.67862 | train_accuracy: 0.67893 | valid_auc: 0.7267  | valid_balanced_accuracy: 0.665   | valid_accuracy: 0.66525 |  0:20:05s
epoch 69 | loss: 0.60936 | train_auc: 0.74241 | train_balanced_accuracy: 0.67906 | train_accuracy: 0.67936 | valid_auc: 0.72944 | valid_balanced_accuracy: 0.6702  | valid_accuracy: 0.67044 |  0:20:20s
epoch 70 | loss: 0.60838 | train_auc: 0.73013 | train_balanced_accuracy: 0.66849 | train_accuracy: 0.66882 | valid_auc: 0.72574 | valid_balanced_accuracy: 0.66484 | valid_accuracy: 0.66509 |  0:20:38s
epoch 71 | loss: 0.60756 | train_auc: 0.7255  | train_balanced_accuracy: 0.66693 | train_accuracy: 0.6672  | valid_auc: 0.71882 | valid_balanced_accuracy: 0.66285 | valid_accuracy: 0.66305 |  0:20:56s
epoch 72 | loss: 0.60453 | train_auc: 0.72221 | train_balanced_accuracy: 0.6671  | train_accuracy: 0.6674  | valid_auc: 0.71606 | valid_balanced_accuracy: 0.65825 | valid_accuracy: 0.65848 |  0:21:12s
epoch 73 | loss: 0.60747 | train_auc: 0.72764 | train_balanced_accuracy: 0.671   | train_accuracy: 0.67134 | valid_auc: 0.71751 | valid_balanced_accuracy: 0.66072 | valid_accuracy: 0.661   |  0:21:30s
epoch 74 | loss: 0.60494 | train_auc: 0.72573 | train_balanced_accuracy: 0.67023 | train_accuracy: 0.67059 | valid_auc: 0.71868 | valid_balanced_accuracy: 0.66069 | valid_accuracy: 0.661   |  0:21:47s
epoch 75 | loss: 0.60611 | train_auc: 0.72447 | train_balanced_accuracy: 0.66853 | train_accuracy: 0.66878 | valid_auc: 0.71668 | valid_balanced_accuracy: 0.65908 | valid_accuracy: 0.65927 |  0:22:03s
epoch 76 | loss: 0.60919 | train_auc: 0.74333 | train_balanced_accuracy: 0.6786  | train_accuracy: 0.67873 | valid_auc: 0.7309  | valid_balanced_accuracy: 0.67131 | valid_accuracy: 0.67139 |  0:22:20s
epoch 77 | loss: 0.60667 | train_auc: 0.74282 | train_balanced_accuracy: 0.68003 | train_accuracy: 0.68019 | valid_auc: 0.73021 | valid_balanced_accuracy: 0.66689 | valid_accuracy: 0.66698 |  0:22:35s
epoch 78 | loss: 0.60135 | train_auc: 0.74604 | train_balanced_accuracy: 0.68196 | train_accuracy: 0.68223 | valid_auc: 0.72977 | valid_balanced_accuracy: 0.66909 | valid_accuracy: 0.66934 |  0:22:52s
epoch 79 | loss: 0.60174 | train_auc: 0.74576 | train_balanced_accuracy: 0.68265 | train_accuracy: 0.68283 | valid_auc: 0.72859 | valid_balanced_accuracy: 0.6678  | valid_accuracy: 0.66793 |  0:23:07s
epoch 80 | loss: 0.60567 | train_auc: 0.74385 | train_balanced_accuracy: 0.67981 | train_accuracy: 0.68007 | valid_auc: 0.72952 | valid_balanced_accuracy: 0.66881 | valid_accuracy: 0.66903 |  0:23:23s
epoch 81 | loss: 0.59964 | train_auc: 0.74239 | train_balanced_accuracy: 0.67949 | train_accuracy: 0.67968 | valid_auc: 0.72876 | valid_balanced_accuracy: 0.66624 | valid_accuracy: 0.66635 |  0:23:41s
epoch 82 | loss: 0.60678 | train_auc: 0.74667 | train_balanced_accuracy: 0.68193 | train_accuracy: 0.6822  | valid_auc: 0.72937 | valid_balanced_accuracy: 0.67177 | valid_accuracy: 0.67202 |  0:23:59s
epoch 83 | loss: 0.6037  | train_auc: 0.74698 | train_balanced_accuracy: 0.68294 | train_accuracy: 0.68326 | valid_auc: 0.73003 | valid_balanced_accuracy: 0.6659  | valid_accuracy: 0.66619 |  0:24:14s
epoch 84 | loss: 0.60308 | train_auc: 0.74803 | train_balanced_accuracy: 0.68248 | train_accuracy: 0.68263 | valid_auc: 0.73089 | valid_balanced_accuracy: 0.67001 | valid_accuracy: 0.67013 |  0:24:29s
epoch 85 | loss: 0.60317 | train_auc: 0.7459  | train_balanced_accuracy: 0.68077 | train_accuracy: 0.68109 | valid_auc: 0.7302  | valid_balanced_accuracy: 0.67059 | valid_accuracy: 0.67092 |  0:24:46s
epoch 86 | loss: 0.60555 | train_auc: 0.74301 | train_balanced_accuracy: 0.6802  | train_accuracy: 0.68062 | valid_auc: 0.73112 | valid_balanced_accuracy: 0.6699  | valid_accuracy: 0.67029 |  0:25:04s
epoch 87 | loss: 0.6009  | train_auc: 0.74255 | train_balanced_accuracy: 0.67804 | train_accuracy: 0.67826 | valid_auc: 0.73016 | valid_balanced_accuracy: 0.66887 | valid_accuracy: 0.66903 |  0:25:21s
epoch 88 | loss: 0.60212 | train_auc: 0.74148 | train_balanced_accuracy: 0.67831 | train_accuracy: 0.67861 | valid_auc: 0.73071 | valid_balanced_accuracy: 0.67334 | valid_accuracy: 0.67359 |  0:25:38s
epoch 89 | loss: 0.60321 | train_auc: 0.72154 | train_balanced_accuracy: 0.66392 | train_accuracy: 0.66406 | valid_auc: 0.72267 | valid_balanced_accuracy: 0.665   | valid_accuracy: 0.66509 |  0:25:53s
epoch 90 | loss: 0.60416 | train_auc: 0.7122  | train_balanced_accuracy: 0.65226 | train_accuracy: 0.65265 | valid_auc: 0.71482 | valid_balanced_accuracy: 0.65733 | valid_accuracy: 0.6577  |  0:26:11s
epoch 91 | loss: 0.60054 | train_auc: 0.70449 | train_balanced_accuracy: 0.64561 | train_accuracy: 0.64604 | valid_auc: 0.70584 | valid_balanced_accuracy: 0.64536 | valid_accuracy: 0.64573 |  0:26:26s
epoch 92 | loss: 0.59978 | train_auc: 0.70827 | train_balanced_accuracy: 0.64772 | train_accuracy: 0.64816 | valid_auc: 0.70988 | valid_balanced_accuracy: 0.65181 | valid_accuracy: 0.65219 |  0:26:41s
epoch 93 | loss: 0.59797 | train_auc: 0.70655 | train_balanced_accuracy: 0.64503 | train_accuracy: 0.64525 | valid_auc: 0.70341 | valid_balanced_accuracy: 0.64035 | valid_accuracy: 0.64054 |  0:26:57s
epoch 94 | loss: 0.60067 | train_auc: 0.67896 | train_balanced_accuracy: 0.62406 | train_accuracy: 0.62451 | valid_auc: 0.67546 | valid_balanced_accuracy: 0.61666 | valid_accuracy: 0.61709 |  0:27:14s
epoch 95 | loss: 0.60179 | train_auc: 0.65244 | train_balanced_accuracy: 0.60293 | train_accuracy: 0.60323 | valid_auc: 0.6482  | valid_balanced_accuracy: 0.59322 | valid_accuracy: 0.59348 |  0:27:31s
epoch 96 | loss: 0.59576 | train_auc: 0.64739 | train_balanced_accuracy: 0.60004 | train_accuracy: 0.60039 | valid_auc: 0.64059 | valid_balanced_accuracy: 0.59184 | valid_accuracy: 0.59223 |  0:27:48s
epoch 97 | loss: 0.59694 | train_auc: 0.64883 | train_balanced_accuracy: 0.60023 | train_accuracy: 0.60075 | valid_auc: 0.63888 | valid_balanced_accuracy: 0.59295 | valid_accuracy: 0.59348 |  0:28:06s
epoch 98 | loss: 0.59793 | train_auc: 0.63755 | train_balanced_accuracy: 0.5868  | train_accuracy: 0.58749 | valid_auc: 0.62572 | valid_balanced_accuracy: 0.58161 | valid_accuracy: 0.58231 |  0:28:22s
epoch 99 | loss: 0.59538 | train_auc: 0.63676 | train_balanced_accuracy: 0.58435 | train_accuracy: 0.58501 | valid_auc: 0.62707 | valid_balanced_accuracy: 0.57832 | valid_accuracy: 0.57901 |  0:28:39s
epoch 100| loss: 0.60353 | train_auc: 0.6362  | train_balanced_accuracy: 0.58196 | train_accuracy: 0.58292 | valid_auc: 0.62353 | valid_balanced_accuracy: 0.57612 | valid_accuracy: 0.57712 |  0:28:55s
epoch 101| loss: 0.59679 | train_auc: 0.64754 | train_balanced_accuracy: 0.5946  | train_accuracy: 0.59532 | valid_auc: 0.63815 | valid_balanced_accuracy: 0.588   | valid_accuracy: 0.58876 |  0:29:13s
epoch 102| loss: 0.59512 | train_auc: 0.676   | train_balanced_accuracy: 0.62485 | train_accuracy: 0.62514 | valid_auc: 0.67827 | valid_balanced_accuracy: 0.62309 | valid_accuracy: 0.62339 |  0:29:30s
epoch 103| loss: 0.59794 | train_auc: 0.6826  | train_balanced_accuracy: 0.62929 | train_accuracy: 0.62982 | valid_auc: 0.6808  | valid_balanced_accuracy: 0.62962 | valid_accuracy: 0.63015 |  0:29:47s
epoch 104| loss: 0.59913 | train_auc: 0.68149 | train_balanced_accuracy: 0.62908 | train_accuracy: 0.62935 | valid_auc: 0.68213 | valid_balanced_accuracy: 0.62843 | valid_accuracy: 0.62874 |  0:30:03s
epoch 105| loss: 0.59564 | train_auc: 0.65197 | train_balanced_accuracy: 0.60199 | train_accuracy: 0.60224 | valid_auc: 0.64333 | valid_balanced_accuracy: 0.59181 | valid_accuracy: 0.59207 |  0:30:19s
epoch 106| loss: 0.59783 | train_auc: 0.66163 | train_balanced_accuracy: 0.61135 | train_accuracy: 0.61153 | valid_auc: 0.65968 | valid_balanced_accuracy: 0.613   | valid_accuracy: 0.61316 |  0:30:35s
epoch 107| loss: 0.59709 | train_auc: 0.67552 | train_balanced_accuracy: 0.62347 | train_accuracy: 0.62361 | valid_auc: 0.67206 | valid_balanced_accuracy: 0.6212  | valid_accuracy: 0.62134 |  0:30:50s
epoch 108| loss: 0.59314 | train_auc: 0.68527 | train_balanced_accuracy: 0.63259 | train_accuracy: 0.6327  | valid_auc: 0.68348 | valid_balanced_accuracy: 0.6285  | valid_accuracy: 0.62858 |  0:31:06s

Early stopping occurred at epoch 108 with best_epoch = 88 and best_valid_accuracy = 0.67359
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 54/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=31.2min
[CV 3/5; 54/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82845 | train_auc: 0.51464 | train_balanced_accuracy: 0.50556 | train_accuracy: 0.5037  | valid_auc: 0.52193 | valid_balanced_accuracy: 0.51339 | valid_accuracy: 0.51149 |  0:00:16s
epoch 1  | loss: 0.74235 | train_auc: 0.52967 | train_balanced_accuracy: 0.51242 | train_accuracy: 0.50936 | valid_auc: 0.53107 | valid_balanced_accuracy: 0.51111 | valid_accuracy: 0.50803 |  0:00:33s
epoch 2  | loss: 0.70965 | train_auc: 0.54128 | train_balanced_accuracy: 0.50876 | train_accuracy: 0.50559 | valid_auc: 0.53808 | valid_balanced_accuracy: 0.50607 | valid_accuracy: 0.50283 |  0:00:48s
epoch 3  | loss: 0.69801 | train_auc: 0.55744 | train_balanced_accuracy: 0.51256 | train_accuracy: 0.50952 | valid_auc: 0.55794 | valid_balanced_accuracy: 0.51644 | valid_accuracy: 0.51338 |  0:01:06s
epoch 4  | loss: 0.68807 | train_auc: 0.55897 | train_balanced_accuracy: 0.52036 | train_accuracy: 0.51739 | valid_auc: 0.55482 | valid_balanced_accuracy: 0.5239  | valid_accuracy: 0.52093 |  0:01:22s
epoch 5  | loss: 0.6809  | train_auc: 0.56496 | train_balanced_accuracy: 0.52332 | train_accuracy: 0.52038 | valid_auc: 0.55976 | valid_balanced_accuracy: 0.52217 | valid_accuracy: 0.5192  |  0:01:37s
epoch 6  | loss: 0.67368 | train_auc: 0.57008 | train_balanced_accuracy: 0.53135 | train_accuracy: 0.52856 | valid_auc: 0.56518 | valid_balanced_accuracy: 0.53257 | valid_accuracy: 0.52975 |  0:01:55s
epoch 7  | loss: 0.67071 | train_auc: 0.57684 | train_balanced_accuracy: 0.53241 | train_accuracy: 0.52955 | valid_auc: 0.57347 | valid_balanced_accuracy: 0.53217 | valid_accuracy: 0.52927 |  0:02:10s
epoch 8  | loss: 0.66272 | train_auc: 0.59688 | train_balanced_accuracy: 0.5367  | train_accuracy: 0.53388 | valid_auc: 0.59488 | valid_balanced_accuracy: 0.53842 | valid_accuracy: 0.53557 |  0:02:27s
epoch 9  | loss: 0.66199 | train_auc: 0.60761 | train_balanced_accuracy: 0.5448  | train_accuracy: 0.5421  | valid_auc: 0.60421 | valid_balanced_accuracy: 0.54463 | valid_accuracy: 0.54186 |  0:02:44s
epoch 10 | loss: 0.6532  | train_auc: 0.6236  | train_balanced_accuracy: 0.55361 | train_accuracy: 0.55107 | valid_auc: 0.62011 | valid_balanced_accuracy: 0.55453 | valid_accuracy: 0.55194 |  0:03:00s
epoch 11 | loss: 0.6562  | train_auc: 0.63864 | train_balanced_accuracy: 0.56865 | train_accuracy: 0.56649 | valid_auc: 0.63585 | valid_balanced_accuracy: 0.56498 | valid_accuracy: 0.5628  |  0:03:16s
epoch 12 | loss: 0.65083 | train_auc: 0.6514  | train_balanced_accuracy: 0.57478 | train_accuracy: 0.57271 | valid_auc: 0.64923 | valid_balanced_accuracy: 0.57149 | valid_accuracy: 0.56941 |  0:03:34s
epoch 13 | loss: 0.64998 | train_auc: 0.66146 | train_balanced_accuracy: 0.58083 | train_accuracy: 0.57885 | valid_auc: 0.6583  | valid_balanced_accuracy: 0.58032 | valid_accuracy: 0.57838 |  0:03:50s
epoch 14 | loss: 0.6452  | train_auc: 0.66796 | train_balanced_accuracy: 0.58654 | train_accuracy: 0.58483 | valid_auc: 0.6656  | valid_balanced_accuracy: 0.58821 | valid_accuracy: 0.58656 |  0:04:05s
epoch 15 | loss: 0.64577 | train_auc: 0.67751 | train_balanced_accuracy: 0.59257 | train_accuracy: 0.59085 | valid_auc: 0.67439 | valid_balanced_accuracy: 0.59374 | valid_accuracy: 0.59207 |  0:04:22s
epoch 16 | loss: 0.64226 | train_auc: 0.68349 | train_balanced_accuracy: 0.60212 | train_accuracy: 0.60065 | valid_auc: 0.68105 | valid_balanced_accuracy: 0.60954 | valid_accuracy: 0.60812 |  0:04:38s
epoch 17 | loss: 0.63976 | train_auc: 0.68602 | train_balanced_accuracy: 0.60995 | train_accuracy: 0.60863 | valid_auc: 0.68365 | valid_balanced_accuracy: 0.61237 | valid_accuracy: 0.61111 |  0:04:54s
epoch 18 | loss: 0.63758 | train_auc: 0.69001 | train_balanced_accuracy: 0.62243 | train_accuracy: 0.6215  | valid_auc: 0.68657 | valid_balanced_accuracy: 0.62586 | valid_accuracy: 0.62496 |  0:05:14s
epoch 19 | loss: 0.63827 | train_auc: 0.69361 | train_balanced_accuracy: 0.62961 | train_accuracy: 0.62886 | valid_auc: 0.68664 | valid_balanced_accuracy: 0.62587 | valid_accuracy: 0.62512 |  0:05:31s
epoch 20 | loss: 0.63647 | train_auc: 0.69556 | train_balanced_accuracy: 0.63485 | train_accuracy: 0.63425 | valid_auc: 0.69041 | valid_balanced_accuracy: 0.63518 | valid_accuracy: 0.63456 |  0:05:48s
epoch 21 | loss: 0.63082 | train_auc: 0.69685 | train_balanced_accuracy: 0.63781 | train_accuracy: 0.63739 | valid_auc: 0.69276 | valid_balanced_accuracy: 0.64162 | valid_accuracy: 0.64117 |  0:06:06s
epoch 22 | loss: 0.63582 | train_auc: 0.69787 | train_balanced_accuracy: 0.6451  | train_accuracy: 0.64518 | valid_auc: 0.692   | valid_balanced_accuracy: 0.64194 | valid_accuracy: 0.64196 |  0:06:21s
epoch 23 | loss: 0.63449 | train_auc: 0.6997  | train_balanced_accuracy: 0.64355 | train_accuracy: 0.64353 | valid_auc: 0.69247 | valid_balanced_accuracy: 0.64262 | valid_accuracy: 0.64259 |  0:06:37s
epoch 24 | loss: 0.63255 | train_auc: 0.70196 | train_balanced_accuracy: 0.64707 | train_accuracy: 0.64727 | valid_auc: 0.69751 | valid_balanced_accuracy: 0.64947 | valid_accuracy: 0.64967 |  0:06:54s
epoch 25 | loss: 0.63023 | train_auc: 0.7028  | train_balanced_accuracy: 0.64574 | train_accuracy: 0.64605 | valid_auc: 0.69708 | valid_balanced_accuracy: 0.64372 | valid_accuracy: 0.644   |  0:07:11s
epoch 26 | loss: 0.62829 | train_auc: 0.70341 | train_balanced_accuracy: 0.64705 | train_accuracy: 0.64747 | valid_auc: 0.69682 | valid_balanced_accuracy: 0.64975 | valid_accuracy: 0.65014 |  0:07:28s
epoch 27 | loss: 0.6283  | train_auc: 0.70623 | train_balanced_accuracy: 0.65134 | train_accuracy: 0.65175 | valid_auc: 0.69631 | valid_balanced_accuracy: 0.64473 | valid_accuracy: 0.64511 |  0:07:43s
epoch 28 | loss: 0.62529 | train_auc: 0.70956 | train_balanced_accuracy: 0.655   | train_accuracy: 0.65526 | valid_auc: 0.70055 | valid_balanced_accuracy: 0.65086 | valid_accuracy: 0.65109 |  0:08:00s
epoch 29 | loss: 0.62425 | train_auc: 0.71324 | train_balanced_accuracy: 0.65759 | train_accuracy: 0.65797 | valid_auc: 0.70189 | valid_balanced_accuracy: 0.64615 | valid_accuracy: 0.64652 |  0:08:16s
epoch 30 | loss: 0.62321 | train_auc: 0.71411 | train_balanced_accuracy: 0.66008 | train_accuracy: 0.66053 | valid_auc: 0.70103 | valid_balanced_accuracy: 0.64654 | valid_accuracy: 0.64699 |  0:08:33s
epoch 31 | loss: 0.62522 | train_auc: 0.71498 | train_balanced_accuracy: 0.65803 | train_accuracy: 0.65852 | valid_auc: 0.70365 | valid_balanced_accuracy: 0.65485 | valid_accuracy: 0.65534 |  0:08:48s
epoch 32 | loss: 0.61995 | train_auc: 0.71655 | train_balanced_accuracy: 0.66165 | train_accuracy: 0.66218 | valid_auc: 0.70356 | valid_balanced_accuracy: 0.65355 | valid_accuracy: 0.65408 |  0:09:04s
epoch 33 | loss: 0.62532 | train_auc: 0.71692 | train_balanced_accuracy: 0.66159 | train_accuracy: 0.66206 | valid_auc: 0.70732 | valid_balanced_accuracy: 0.65485 | valid_accuracy: 0.65534 |  0:09:21s
epoch 34 | loss: 0.62272 | train_auc: 0.7169  | train_balanced_accuracy: 0.66054 | train_accuracy: 0.661   | valid_auc: 0.70809 | valid_balanced_accuracy: 0.65833 | valid_accuracy: 0.6588  |  0:09:38s
epoch 35 | loss: 0.61822 | train_auc: 0.72128 | train_balanced_accuracy: 0.66521 | train_accuracy: 0.6658  | valid_auc: 0.70953 | valid_balanced_accuracy: 0.65928 | valid_accuracy: 0.6599  |  0:09:56s
epoch 36 | loss: 0.62076 | train_auc: 0.7244  | train_balanced_accuracy: 0.66659 | train_accuracy: 0.66714 | valid_auc: 0.70948 | valid_balanced_accuracy: 0.65415 | valid_accuracy: 0.65471 |  0:10:14s
epoch 37 | loss: 0.62043 | train_auc: 0.72354 | train_balanced_accuracy: 0.66387 | train_accuracy: 0.66431 | valid_auc: 0.70944 | valid_balanced_accuracy: 0.65645 | valid_accuracy: 0.65691 |  0:10:32s
epoch 38 | loss: 0.6187  | train_auc: 0.72428 | train_balanced_accuracy: 0.66432 | train_accuracy: 0.66454 | valid_auc: 0.71127 | valid_balanced_accuracy: 0.65982 | valid_accuracy: 0.66006 |  0:10:48s
epoch 39 | loss: 0.61328 | train_auc: 0.72732 | train_balanced_accuracy: 0.66666 | train_accuracy: 0.66694 | valid_auc: 0.70982 | valid_balanced_accuracy: 0.66242 | valid_accuracy: 0.66273 |  0:11:04s
epoch 40 | loss: 0.6175  | train_auc: 0.7233  | train_balanced_accuracy: 0.66497 | train_accuracy: 0.66525 | valid_auc: 0.70902 | valid_balanced_accuracy: 0.65881 | valid_accuracy: 0.65911 |  0:11:19s
epoch 41 | loss: 0.61751 | train_auc: 0.72875 | train_balanced_accuracy: 0.6688  | train_accuracy: 0.66926 | valid_auc: 0.71132 | valid_balanced_accuracy: 0.65849 | valid_accuracy: 0.65895 |  0:11:36s
epoch 42 | loss: 0.61385 | train_auc: 0.72959 | train_balanced_accuracy: 0.67011 | train_accuracy: 0.67044 | valid_auc: 0.71081 | valid_balanced_accuracy: 0.65832 | valid_accuracy: 0.65864 |  0:11:53s
epoch 43 | loss: 0.6174  | train_auc: 0.72679 | train_balanced_accuracy: 0.66765 | train_accuracy: 0.66789 | valid_auc: 0.71225 | valid_balanced_accuracy: 0.65541 | valid_accuracy: 0.65565 |  0:12:13s
epoch 44 | loss: 0.61797 | train_auc: 0.7318  | train_balanced_accuracy: 0.67239 | train_accuracy: 0.67265 | valid_auc: 0.71234 | valid_balanced_accuracy: 0.66119 | valid_accuracy: 0.66147 |  0:12:29s
epoch 45 | loss: 0.61428 | train_auc: 0.73165 | train_balanced_accuracy: 0.66988 | train_accuracy: 0.67033 | valid_auc: 0.7143  | valid_balanced_accuracy: 0.66208 | valid_accuracy: 0.66257 |  0:12:46s
epoch 46 | loss: 0.61808 | train_auc: 0.73321 | train_balanced_accuracy: 0.67258 | train_accuracy: 0.67304 | valid_auc: 0.7143  | valid_balanced_accuracy: 0.66177 | valid_accuracy: 0.66226 |  0:13:04s
epoch 47 | loss: 0.6128  | train_auc: 0.73116 | train_balanced_accuracy: 0.66917 | train_accuracy: 0.66942 | valid_auc: 0.71506 | valid_balanced_accuracy: 0.65932 | valid_accuracy: 0.65958 |  0:13:22s
epoch 48 | loss: 0.61353 | train_auc: 0.72421 | train_balanced_accuracy: 0.66472 | train_accuracy: 0.66509 | valid_auc: 0.71204 | valid_balanced_accuracy: 0.65405 | valid_accuracy: 0.65439 |  0:13:37s
epoch 49 | loss: 0.61178 | train_auc: 0.71932 | train_balanced_accuracy: 0.66175 | train_accuracy: 0.66191 | valid_auc: 0.70991 | valid_balanced_accuracy: 0.65473 | valid_accuracy: 0.65486 |  0:13:53s
epoch 50 | loss: 0.61459 | train_auc: 0.72658 | train_balanced_accuracy: 0.66757 | train_accuracy: 0.66769 | valid_auc: 0.71146 | valid_balanced_accuracy: 0.65663 | valid_accuracy: 0.65675 |  0:14:09s
epoch 51 | loss: 0.61056 | train_auc: 0.73008 | train_balanced_accuracy: 0.6708  | train_accuracy: 0.67103 | valid_auc: 0.71424 | valid_balanced_accuracy: 0.66171 | valid_accuracy: 0.66195 |  0:14:26s
epoch 52 | loss: 0.60647 | train_auc: 0.73092 | train_balanced_accuracy: 0.67293 | train_accuracy: 0.67324 | valid_auc: 0.71433 | valid_balanced_accuracy: 0.65615 | valid_accuracy: 0.65644 |  0:14:42s
epoch 53 | loss: 0.60976 | train_auc: 0.73557 | train_balanced_accuracy: 0.67467 | train_accuracy: 0.67505 | valid_auc: 0.71745 | valid_balanced_accuracy: 0.66043 | valid_accuracy: 0.66084 |  0:14:57s
epoch 54 | loss: 0.60813 | train_auc: 0.73692 | train_balanced_accuracy: 0.6778  | train_accuracy: 0.67796 | valid_auc: 0.72007 | valid_balanced_accuracy: 0.66551 | valid_accuracy: 0.66572 |  0:15:13s
epoch 55 | loss: 0.60876 | train_auc: 0.73706 | train_balanced_accuracy: 0.67661 | train_accuracy: 0.67686 | valid_auc: 0.72046 | valid_balanced_accuracy: 0.66735 | valid_accuracy: 0.66761 |  0:15:30s
epoch 56 | loss: 0.61022 | train_auc: 0.73921 | train_balanced_accuracy: 0.67711 | train_accuracy: 0.67764 | valid_auc: 0.72129 | valid_balanced_accuracy: 0.6655  | valid_accuracy: 0.66604 |  0:15:47s
epoch 57 | loss: 0.61417 | train_auc: 0.73699 | train_balanced_accuracy: 0.67655 | train_accuracy: 0.67682 | valid_auc: 0.71929 | valid_balanced_accuracy: 0.65992 | valid_accuracy: 0.66021 |  0:16:04s
epoch 58 | loss: 0.61382 | train_auc: 0.73304 | train_balanced_accuracy: 0.67323 | train_accuracy: 0.67332 | valid_auc: 0.71751 | valid_balanced_accuracy: 0.65931 | valid_accuracy: 0.65943 |  0:16:22s
epoch 59 | loss: 0.60963 | train_auc: 0.73214 | train_balanced_accuracy: 0.67318 | train_accuracy: 0.67336 | valid_auc: 0.71532 | valid_balanced_accuracy: 0.66021 | valid_accuracy: 0.66037 |  0:16:39s
epoch 60 | loss: 0.60948 | train_auc: 0.73102 | train_balanced_accuracy: 0.67212 | train_accuracy: 0.67229 | valid_auc: 0.71603 | valid_balanced_accuracy: 0.6602  | valid_accuracy: 0.66037 |  0:16:56s
epoch 61 | loss: 0.60985 | train_auc: 0.71296 | train_balanced_accuracy: 0.65683 | train_accuracy: 0.65679 | valid_auc: 0.70712 | valid_balanced_accuracy: 0.65427 | valid_accuracy: 0.65423 |  0:17:11s
epoch 62 | loss: 0.60557 | train_auc: 0.71668 | train_balanced_accuracy: 0.66001 | train_accuracy: 0.66041 | valid_auc: 0.71002 | valid_balanced_accuracy: 0.65556 | valid_accuracy: 0.65596 |  0:17:28s
epoch 63 | loss: 0.6068  | train_auc: 0.7229  | train_balanced_accuracy: 0.66315 | train_accuracy: 0.6634  | valid_auc: 0.71341 | valid_balanced_accuracy: 0.6553  | valid_accuracy: 0.65549 |  0:17:45s
epoch 64 | loss: 0.6049  | train_auc: 0.72692 | train_balanced_accuracy: 0.66819 | train_accuracy: 0.66844 | valid_auc: 0.71426 | valid_balanced_accuracy: 0.65906 | valid_accuracy: 0.65927 |  0:18:04s
epoch 65 | loss: 0.6039  | train_auc: 0.73877 | train_balanced_accuracy: 0.67935 | train_accuracy: 0.67961 | valid_auc: 0.72118 | valid_balanced_accuracy: 0.66624 | valid_accuracy: 0.66651 |  0:18:20s
epoch 66 | loss: 0.60832 | train_auc: 0.7434  | train_balanced_accuracy: 0.68119 | train_accuracy: 0.68146 | valid_auc: 0.72292 | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66934 |  0:18:38s
epoch 67 | loss: 0.60468 | train_auc: 0.73925 | train_balanced_accuracy: 0.67655 | train_accuracy: 0.67701 | valid_auc: 0.72054 | valid_balanced_accuracy: 0.6637  | valid_accuracy: 0.66415 |  0:18:56s
epoch 68 | loss: 0.60632 | train_auc: 0.73201 | train_balanced_accuracy: 0.67253 | train_accuracy: 0.67269 | valid_auc: 0.72029 | valid_balanced_accuracy: 0.66903 | valid_accuracy: 0.66918 |  0:19:14s
epoch 69 | loss: 0.60647 | train_auc: 0.7248  | train_balanced_accuracy: 0.66576 | train_accuracy: 0.66619 | valid_auc: 0.71404 | valid_balanced_accuracy: 0.65871 | valid_accuracy: 0.65911 |  0:19:32s
epoch 70 | loss: 0.60319 | train_auc: 0.72719 | train_balanced_accuracy: 0.66792 | train_accuracy: 0.66832 | valid_auc: 0.71497 | valid_balanced_accuracy: 0.65969 | valid_accuracy: 0.66006 |  0:19:48s
epoch 71 | loss: 0.60764 | train_auc: 0.71824 | train_balanced_accuracy: 0.66255 | train_accuracy: 0.66289 | valid_auc: 0.7094  | valid_balanced_accuracy: 0.65787 | valid_accuracy: 0.65817 |  0:20:05s
epoch 72 | loss: 0.60681 | train_auc: 0.72311 | train_balanced_accuracy: 0.66567 | train_accuracy: 0.66572 | valid_auc: 0.71211 | valid_balanced_accuracy: 0.65738 | valid_accuracy: 0.65738 |  0:20:22s
epoch 73 | loss: 0.60067 | train_auc: 0.73571 | train_balanced_accuracy: 0.67528 | train_accuracy: 0.67576 | valid_auc: 0.72053 | valid_balanced_accuracy: 0.66039 | valid_accuracy: 0.66084 |  0:20:39s
epoch 74 | loss: 0.60469 | train_auc: 0.72503 | train_balanced_accuracy: 0.66903 | train_accuracy: 0.66918 | valid_auc: 0.71318 | valid_balanced_accuracy: 0.66449 | valid_accuracy: 0.66462 |  0:20:56s
epoch 75 | loss: 0.60723 | train_auc: 0.70717 | train_balanced_accuracy: 0.65249 | train_accuracy: 0.65262 | valid_auc: 0.70271 | valid_balanced_accuracy: 0.64872 | valid_accuracy: 0.64888 |  0:21:12s
epoch 76 | loss: 0.60548 | train_auc: 0.71471 | train_balanced_accuracy: 0.65951 | train_accuracy: 0.65986 | valid_auc: 0.71018 | valid_balanced_accuracy: 0.65626 | valid_accuracy: 0.65659 |  0:21:28s
epoch 77 | loss: 0.60189 | train_auc: 0.71169 | train_balanced_accuracy: 0.6547  | train_accuracy: 0.65494 | valid_auc: 0.70565 | valid_balanced_accuracy: 0.64673 | valid_accuracy: 0.64699 |  0:21:44s
epoch 78 | loss: 0.60119 | train_auc: 0.69995 | train_balanced_accuracy: 0.64666 | train_accuracy: 0.64703 | valid_auc: 0.70388 | valid_balanced_accuracy: 0.65296 | valid_accuracy: 0.65329 |  0:22:01s
epoch 79 | loss: 0.59776 | train_auc: 0.69868 | train_balanced_accuracy: 0.64415 | train_accuracy: 0.64452 | valid_auc: 0.70307 | valid_balanced_accuracy: 0.65073 | valid_accuracy: 0.65109 |  0:22:18s
epoch 80 | loss: 0.60526 | train_auc: 0.69749 | train_balanced_accuracy: 0.64423 | train_accuracy: 0.64459 | valid_auc: 0.69935 | valid_balanced_accuracy: 0.64773 | valid_accuracy: 0.6481  |  0:22:36s
epoch 81 | loss: 0.60668 | train_auc: 0.72145 | train_balanced_accuracy: 0.66624 | train_accuracy: 0.66643 | valid_auc: 0.71138 | valid_balanced_accuracy: 0.65736 | valid_accuracy: 0.65754 |  0:22:54s
epoch 82 | loss: 0.60337 | train_auc: 0.72009 | train_balanced_accuracy: 0.66091 | train_accuracy: 0.66104 | valid_auc: 0.71154 | valid_balanced_accuracy: 0.66039 | valid_accuracy: 0.66053 |  0:23:09s
epoch 83 | loss: 0.60307 | train_auc: 0.70398 | train_balanced_accuracy: 0.65059 | train_accuracy: 0.65097 | valid_auc: 0.70552 | valid_balanced_accuracy: 0.65465 | valid_accuracy: 0.65502 |  0:23:26s
epoch 84 | loss: 0.60455 | train_auc: 0.72991 | train_balanced_accuracy: 0.67119 | train_accuracy: 0.67131 | valid_auc: 0.71817 | valid_balanced_accuracy: 0.66313 | valid_accuracy: 0.6632  |  0:23:42s
epoch 85 | loss: 0.6046  | train_auc: 0.74653 | train_balanced_accuracy: 0.68132 | train_accuracy: 0.6815  | valid_auc: 0.72358 | valid_balanced_accuracy: 0.66547 | valid_accuracy: 0.66572 |  0:23:59s
epoch 86 | loss: 0.60091 | train_auc: 0.74142 | train_balanced_accuracy: 0.67788 | train_accuracy: 0.67847 | valid_auc: 0.725   | valid_balanced_accuracy: 0.66309 | valid_accuracy: 0.66368 |  0:24:16s

Early stopping occurred at epoch 86 with best_epoch = 66 and best_valid_accuracy = 0.66934
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 54/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.675 total time=24.4min
[CV 4/5; 54/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82676 | train_auc: 0.50436 | train_balanced_accuracy: 0.49987 | train_accuracy: 0.49776 | valid_auc: 0.50816 | valid_balanced_accuracy: 0.50012 | valid_accuracy: 0.49795 |  0:00:16s
epoch 1  | loss: 0.74068 | train_auc: 0.51294 | train_balanced_accuracy: 0.50633 | train_accuracy: 0.50327 | valid_auc: 0.5115  | valid_balanced_accuracy: 0.51178 | valid_accuracy: 0.50866 |  0:00:32s
epoch 2  | loss: 0.69899 | train_auc: 0.542   | train_balanced_accuracy: 0.51229 | train_accuracy: 0.50921 | valid_auc: 0.5357  | valid_balanced_accuracy: 0.51462 | valid_accuracy: 0.51149 |  0:00:49s
epoch 3  | loss: 0.69371 | train_auc: 0.56079 | train_balanced_accuracy: 0.51459 | train_accuracy: 0.51153 | valid_auc: 0.5564  | valid_balanced_accuracy: 0.5107  | valid_accuracy: 0.50755 |  0:01:04s
epoch 4  | loss: 0.68459 | train_auc: 0.56655 | train_balanced_accuracy: 0.51952 | train_accuracy: 0.5166  | valid_auc: 0.56203 | valid_balanced_accuracy: 0.52215 | valid_accuracy: 0.5192  |  0:01:21s
epoch 5  | loss: 0.67683 | train_auc: 0.58029 | train_balanced_accuracy: 0.53186 | train_accuracy: 0.52912 | valid_auc: 0.57443 | valid_balanced_accuracy: 0.52657 | valid_accuracy: 0.52376 |  0:01:38s
epoch 6  | loss: 0.67388 | train_auc: 0.59203 | train_balanced_accuracy: 0.54988 | train_accuracy: 0.54769 | valid_auc: 0.58585 | valid_balanced_accuracy: 0.54114 | valid_accuracy: 0.53887 |  0:01:54s
epoch 7  | loss: 0.67239 | train_auc: 0.59612 | train_balanced_accuracy: 0.54851 | train_accuracy: 0.54611 | valid_auc: 0.58479 | valid_balanced_accuracy: 0.53993 | valid_accuracy: 0.53746 |  0:02:10s
epoch 8  | loss: 0.66254 | train_auc: 0.61104 | train_balanced_accuracy: 0.55709 | train_accuracy: 0.55473 | valid_auc: 0.59617 | valid_balanced_accuracy: 0.54841 | valid_accuracy: 0.54596 |  0:02:27s
epoch 9  | loss: 0.65716 | train_auc: 0.6189  | train_balanced_accuracy: 0.56273 | train_accuracy: 0.56036 | valid_auc: 0.60442 | valid_balanced_accuracy: 0.55281 | valid_accuracy: 0.55036 |  0:02:44s
epoch 10 | loss: 0.65296 | train_auc: 0.63149 | train_balanced_accuracy: 0.57808 | train_accuracy: 0.57609 | valid_auc: 0.61961 | valid_balanced_accuracy: 0.56799 | valid_accuracy: 0.56594 |  0:02:58s
epoch 11 | loss: 0.654   | train_auc: 0.6458  | train_balanced_accuracy: 0.58841 | train_accuracy: 0.58668 | valid_auc: 0.63445 | valid_balanced_accuracy: 0.58074 | valid_accuracy: 0.57901 |  0:03:15s
epoch 12 | loss: 0.64543 | train_auc: 0.66026 | train_balanced_accuracy: 0.5965  | train_accuracy: 0.5949  | valid_auc: 0.64917 | valid_balanced_accuracy: 0.58625 | valid_accuracy: 0.58467 |  0:03:32s
epoch 13 | loss: 0.64688 | train_auc: 0.66766 | train_balanced_accuracy: 0.60101 | train_accuracy: 0.5995  | valid_auc: 0.65735 | valid_balanced_accuracy: 0.59354 | valid_accuracy: 0.59207 |  0:03:48s
epoch 14 | loss: 0.64246 | train_auc: 0.67298 | train_balanced_accuracy: 0.60901 | train_accuracy: 0.60788 | valid_auc: 0.66005 | valid_balanced_accuracy: 0.60214 | valid_accuracy: 0.60104 |  0:04:05s
epoch 15 | loss: 0.6436  | train_auc: 0.68199 | train_balanced_accuracy: 0.61673 | train_accuracy: 0.61571 | valid_auc: 0.66702 | valid_balanced_accuracy: 0.61051 | valid_accuracy: 0.60954 |  0:04:20s
epoch 16 | loss: 0.63749 | train_auc: 0.68682 | train_balanced_accuracy: 0.62608 | train_accuracy: 0.62531 | valid_auc: 0.67233 | valid_balanced_accuracy: 0.61421 | valid_accuracy: 0.61347 |  0:04:36s
epoch 17 | loss: 0.6327  | train_auc: 0.69033 | train_balanced_accuracy: 0.63708 | train_accuracy: 0.63672 | valid_auc: 0.67713 | valid_balanced_accuracy: 0.62778 | valid_accuracy: 0.62748 |  0:04:51s
epoch 18 | loss: 0.63683 | train_auc: 0.69424 | train_balanced_accuracy: 0.64167 | train_accuracy: 0.64153 | valid_auc: 0.68111 | valid_balanced_accuracy: 0.63543 | valid_accuracy: 0.63535 |  0:05:09s
epoch 19 | loss: 0.63395 | train_auc: 0.69643 | train_balanced_accuracy: 0.64475 | train_accuracy: 0.64483 | valid_auc: 0.68297 | valid_balanced_accuracy: 0.64465 | valid_accuracy: 0.64479 |  0:05:26s
epoch 20 | loss: 0.63412 | train_auc: 0.70011 | train_balanced_accuracy: 0.64871 | train_accuracy: 0.64888 | valid_auc: 0.68599 | valid_balanced_accuracy: 0.64248 | valid_accuracy: 0.64274 |  0:05:41s
epoch 21 | loss: 0.63015 | train_auc: 0.7015  | train_balanced_accuracy: 0.64927 | train_accuracy: 0.64943 | valid_auc: 0.68881 | valid_balanced_accuracy: 0.64268 | valid_accuracy: 0.6429  |  0:05:58s
epoch 22 | loss: 0.63215 | train_auc: 0.70321 | train_balanced_accuracy: 0.65361 | train_accuracy: 0.654   | valid_auc: 0.69159 | valid_balanced_accuracy: 0.64747 | valid_accuracy: 0.64794 |  0:06:15s
epoch 23 | loss: 0.62943 | train_auc: 0.70346 | train_balanced_accuracy: 0.65338 | train_accuracy: 0.6536  | valid_auc: 0.69113 | valid_balanced_accuracy: 0.64468 | valid_accuracy: 0.64495 |  0:06:31s
epoch 24 | loss: 0.63039 | train_auc: 0.70586 | train_balanced_accuracy: 0.65474 | train_accuracy: 0.6551  | valid_auc: 0.69204 | valid_balanced_accuracy: 0.64624 | valid_accuracy: 0.64668 |  0:06:49s
epoch 25 | loss: 0.62637 | train_auc: 0.70792 | train_balanced_accuracy: 0.65806 | train_accuracy: 0.65856 | valid_auc: 0.69439 | valid_balanced_accuracy: 0.6491  | valid_accuracy: 0.64967 |  0:07:06s
epoch 26 | loss: 0.62709 | train_auc: 0.71055 | train_balanced_accuracy: 0.65839 | train_accuracy: 0.65895 | valid_auc: 0.69659 | valid_balanced_accuracy: 0.64823 | valid_accuracy: 0.64888 |  0:07:23s
epoch 27 | loss: 0.62853 | train_auc: 0.7124  | train_balanced_accuracy: 0.6605  | train_accuracy: 0.66104 | valid_auc: 0.6971  | valid_balanced_accuracy: 0.65157 | valid_accuracy: 0.65219 |  0:07:39s
epoch 28 | loss: 0.62535 | train_auc: 0.71437 | train_balanced_accuracy: 0.65872 | train_accuracy: 0.65907 | valid_auc: 0.7016  | valid_balanced_accuracy: 0.65031 | valid_accuracy: 0.65077 |  0:07:55s
epoch 29 | loss: 0.62573 | train_auc: 0.71612 | train_balanced_accuracy: 0.65737 | train_accuracy: 0.65777 | valid_auc: 0.70196 | valid_balanced_accuracy: 0.64774 | valid_accuracy: 0.64825 |  0:08:10s
epoch 30 | loss: 0.62047 | train_auc: 0.71693 | train_balanced_accuracy: 0.6583  | train_accuracy: 0.65876 | valid_auc: 0.70499 | valid_balanced_accuracy: 0.6488  | valid_accuracy: 0.64935 |  0:08:28s
epoch 31 | loss: 0.62362 | train_auc: 0.71844 | train_balanced_accuracy: 0.65788 | train_accuracy: 0.65833 | valid_auc: 0.7019  | valid_balanced_accuracy: 0.64207 | valid_accuracy: 0.64259 |  0:08:45s
epoch 32 | loss: 0.61681 | train_auc: 0.72009 | train_balanced_accuracy: 0.6607  | train_accuracy: 0.66116 | valid_auc: 0.70535 | valid_balanced_accuracy: 0.6471  | valid_accuracy: 0.64762 |  0:09:02s
epoch 33 | loss: 0.62261 | train_auc: 0.7199  | train_balanced_accuracy: 0.65844 | train_accuracy: 0.6588  | valid_auc: 0.70309 | valid_balanced_accuracy: 0.64628 | valid_accuracy: 0.64668 |  0:09:19s
epoch 34 | loss: 0.62052 | train_auc: 0.71869 | train_balanced_accuracy: 0.65774 | train_accuracy: 0.65809 | valid_auc: 0.70084 | valid_balanced_accuracy: 0.64376 | valid_accuracy: 0.64416 |  0:09:36s
epoch 35 | loss: 0.61768 | train_auc: 0.71884 | train_balanced_accuracy: 0.6577  | train_accuracy: 0.65813 | valid_auc: 0.70118 | valid_balanced_accuracy: 0.64588 | valid_accuracy: 0.64636 |  0:09:53s
epoch 36 | loss: 0.61675 | train_auc: 0.72476 | train_balanced_accuracy: 0.66451 | train_accuracy: 0.66482 | valid_auc: 0.7048  | valid_balanced_accuracy: 0.64834 | valid_accuracy: 0.64873 |  0:10:10s
epoch 37 | loss: 0.61593 | train_auc: 0.72349 | train_balanced_accuracy: 0.66307 | train_accuracy: 0.66356 | valid_auc: 0.70238 | valid_balanced_accuracy: 0.64754 | valid_accuracy: 0.6481  |  0:10:28s
epoch 38 | loss: 0.61897 | train_auc: 0.72447 | train_balanced_accuracy: 0.66424 | train_accuracy: 0.66458 | valid_auc: 0.70299 | valid_balanced_accuracy: 0.64758 | valid_accuracy: 0.64794 |  0:10:46s
epoch 39 | loss: 0.61678 | train_auc: 0.72286 | train_balanced_accuracy: 0.6622  | train_accuracy: 0.66261 | valid_auc: 0.70333 | valid_balanced_accuracy: 0.64652 | valid_accuracy: 0.64699 |  0:11:02s
epoch 40 | loss: 0.617   | train_auc: 0.72464 | train_balanced_accuracy: 0.66295 | train_accuracy: 0.66336 | valid_auc: 0.70388 | valid_balanced_accuracy: 0.64779 | valid_accuracy: 0.64825 |  0:11:18s
epoch 41 | loss: 0.62044 | train_auc: 0.71091 | train_balanced_accuracy: 0.65489 | train_accuracy: 0.65537 | valid_auc: 0.69223 | valid_balanced_accuracy: 0.64204 | valid_accuracy: 0.64259 |  0:11:35s
epoch 42 | loss: 0.61564 | train_auc: 0.70867 | train_balanced_accuracy: 0.65255 | train_accuracy: 0.65282 | valid_auc: 0.69582 | valid_balanced_accuracy: 0.64226 | valid_accuracy: 0.64259 |  0:11:50s
epoch 43 | loss: 0.61695 | train_auc: 0.70233 | train_balanced_accuracy: 0.64695 | train_accuracy: 0.64703 | valid_auc: 0.69139 | valid_balanced_accuracy: 0.64028 | valid_accuracy: 0.64038 |  0:12:08s
epoch 44 | loss: 0.61824 | train_auc: 0.69864 | train_balanced_accuracy: 0.64263 | train_accuracy: 0.64278 | valid_auc: 0.68924 | valid_balanced_accuracy: 0.63956 | valid_accuracy: 0.63975 |  0:12:25s
epoch 45 | loss: 0.61576 | train_auc: 0.69367 | train_balanced_accuracy: 0.64206 | train_accuracy: 0.64223 | valid_auc: 0.68407 | valid_balanced_accuracy: 0.63497 | valid_accuracy: 0.63519 |  0:12:41s
epoch 46 | loss: 0.6197  | train_auc: 0.70322 | train_balanced_accuracy: 0.65177 | train_accuracy: 0.65219 | valid_auc: 0.69174 | valid_balanced_accuracy: 0.63961 | valid_accuracy: 0.64007 |  0:13:00s
epoch 47 | loss: 0.6122  | train_auc: 0.65402 | train_balanced_accuracy: 0.62147 | train_accuracy: 0.62169 | valid_auc: 0.64822 | valid_balanced_accuracy: 0.62409 | valid_accuracy: 0.62433 |  0:13:17s

Early stopping occurred at epoch 47 with best_epoch = 27 and best_valid_accuracy = 0.65219
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 54/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.648 total time=13.4min
[CV 5/5; 54/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83079 | train_auc: 0.52845 | train_balanced_accuracy: 0.51763 | train_accuracy: 0.51523 | valid_auc: 0.5206  | valid_balanced_accuracy: 0.51085 | valid_accuracy: 0.50834 |  0:00:17s
epoch 1  | loss: 0.73845 | train_auc: 0.54395 | train_balanced_accuracy: 0.51092 | train_accuracy: 0.50811 | valid_auc: 0.5463  | valid_balanced_accuracy: 0.51471 | valid_accuracy: 0.5118  |  0:00:35s
epoch 2  | loss: 0.7046  | train_auc: 0.55761 | train_balanced_accuracy: 0.51367 | train_accuracy: 0.51066 | valid_auc: 0.56365 | valid_balanced_accuracy: 0.51584 | valid_accuracy: 0.51275 |  0:00:51s
epoch 3  | loss: 0.69339 | train_auc: 0.56579 | train_balanced_accuracy: 0.52724 | train_accuracy: 0.52459 | valid_auc: 0.57176 | valid_balanced_accuracy: 0.52916 | valid_accuracy: 0.52644 |  0:01:08s
epoch 4  | loss: 0.68011 | train_auc: 0.5755  | train_balanced_accuracy: 0.53138 | train_accuracy: 0.52868 | valid_auc: 0.58037 | valid_balanced_accuracy: 0.53313 | valid_accuracy: 0.53037 |  0:01:25s
epoch 5  | loss: 0.67408 | train_auc: 0.5884  | train_balanced_accuracy: 0.53377 | train_accuracy: 0.53093 | valid_auc: 0.5914  | valid_balanced_accuracy: 0.53578 | valid_accuracy: 0.53289 |  0:01:41s
epoch 6  | loss: 0.66915 | train_auc: 0.59691 | train_balanced_accuracy: 0.54263 | train_accuracy: 0.54005 | valid_auc: 0.59871 | valid_balanced_accuracy: 0.55168 | valid_accuracy: 0.5491  |  0:01:58s
epoch 7  | loss: 0.66256 | train_auc: 0.60391 | train_balanced_accuracy: 0.5391  | train_accuracy: 0.53632 | valid_auc: 0.606   | valid_balanced_accuracy: 0.5423  | valid_accuracy: 0.5395  |  0:02:16s
epoch 8  | loss: 0.65872 | train_auc: 0.62012 | train_balanced_accuracy: 0.54868 | train_accuracy: 0.54619 | valid_auc: 0.61882 | valid_balanced_accuracy: 0.55179 | valid_accuracy: 0.54926 |  0:02:33s
epoch 9  | loss: 0.65533 | train_auc: 0.63322 | train_balanced_accuracy: 0.55577 | train_accuracy: 0.55335 | valid_auc: 0.63108 | valid_balanced_accuracy: 0.55959 | valid_accuracy: 0.55713 |  0:02:51s
epoch 10 | loss: 0.65299 | train_auc: 0.64318 | train_balanced_accuracy: 0.56799 | train_accuracy: 0.56582 | valid_auc: 0.64108 | valid_balanced_accuracy: 0.56486 | valid_accuracy: 0.56264 |  0:03:10s
epoch 11 | loss: 0.64983 | train_auc: 0.65316 | train_balanced_accuracy: 0.58144 | train_accuracy: 0.57952 | valid_auc: 0.64969 | valid_balanced_accuracy: 0.57861 | valid_accuracy: 0.57664 |  0:03:28s
epoch 12 | loss: 0.64991 | train_auc: 0.65964 | train_balanced_accuracy: 0.58942 | train_accuracy: 0.58766 | valid_auc: 0.65197 | valid_balanced_accuracy: 0.58444 | valid_accuracy: 0.58263 |  0:03:45s
epoch 13 | loss: 0.64916 | train_auc: 0.66669 | train_balanced_accuracy: 0.59772 | train_accuracy: 0.59608 | valid_auc: 0.65883 | valid_balanced_accuracy: 0.59376 | valid_accuracy: 0.59207 |  0:04:02s
epoch 14 | loss: 0.64214 | train_auc: 0.67191 | train_balanced_accuracy: 0.60887 | train_accuracy: 0.60749 | valid_auc: 0.66431 | valid_balanced_accuracy: 0.60055 | valid_accuracy: 0.59915 |  0:04:18s
epoch 15 | loss: 0.64005 | train_auc: 0.67815 | train_balanced_accuracy: 0.60984 | train_accuracy: 0.60844 | valid_auc: 0.669   | valid_balanced_accuracy: 0.60341 | valid_accuracy: 0.60198 |  0:04:34s
epoch 16 | loss: 0.64154 | train_auc: 0.68488 | train_balanced_accuracy: 0.62392 | train_accuracy: 0.62291 | valid_auc: 0.67545 | valid_balanced_accuracy: 0.61783 | valid_accuracy: 0.61678 |  0:04:51s
epoch 17 | loss: 0.64098 | train_auc: 0.68542 | train_balanced_accuracy: 0.62565 | train_accuracy: 0.6248  | valid_auc: 0.6746  | valid_balanced_accuracy: 0.61624 | valid_accuracy: 0.61536 |  0:05:11s
epoch 18 | loss: 0.64049 | train_auc: 0.68955 | train_balanced_accuracy: 0.63683 | train_accuracy: 0.63641 | valid_auc: 0.67818 | valid_balanced_accuracy: 0.62919 | valid_accuracy: 0.62874 |  0:05:29s
epoch 19 | loss: 0.63644 | train_auc: 0.69313 | train_balanced_accuracy: 0.64549 | train_accuracy: 0.64522 | valid_auc: 0.68258 | valid_balanced_accuracy: 0.63363 | valid_accuracy: 0.6333  |  0:05:45s
epoch 20 | loss: 0.6338  | train_auc: 0.6967  | train_balanced_accuracy: 0.65063 | train_accuracy: 0.65065 | valid_auc: 0.68668 | valid_balanced_accuracy: 0.64323 | valid_accuracy: 0.64322 |  0:06:01s
epoch 21 | loss: 0.63383 | train_auc: 0.69853 | train_balanced_accuracy: 0.6505  | train_accuracy: 0.65042 | valid_auc: 0.68709 | valid_balanced_accuracy: 0.64079 | valid_accuracy: 0.6407  |  0:06:16s
epoch 22 | loss: 0.6312  | train_auc: 0.70152 | train_balanced_accuracy: 0.65466 | train_accuracy: 0.65482 | valid_auc: 0.68832 | valid_balanced_accuracy: 0.64244 | valid_accuracy: 0.64259 |  0:06:32s
epoch 23 | loss: 0.62984 | train_auc: 0.70335 | train_balanced_accuracy: 0.65553 | train_accuracy: 0.65565 | valid_auc: 0.68851 | valid_balanced_accuracy: 0.64282 | valid_accuracy: 0.6429  |  0:06:48s
epoch 24 | loss: 0.63542 | train_auc: 0.70567 | train_balanced_accuracy: 0.65719 | train_accuracy: 0.65738 | valid_auc: 0.69374 | valid_balanced_accuracy: 0.64334 | valid_accuracy: 0.64353 |  0:07:05s
epoch 25 | loss: 0.62817 | train_auc: 0.70805 | train_balanced_accuracy: 0.65841 | train_accuracy: 0.65864 | valid_auc: 0.69579 | valid_balanced_accuracy: 0.64803 | valid_accuracy: 0.64825 |  0:07:22s
epoch 26 | loss: 0.62777 | train_auc: 0.70951 | train_balanced_accuracy: 0.65829 | train_accuracy: 0.65852 | valid_auc: 0.6982  | valid_balanced_accuracy: 0.65164 | valid_accuracy: 0.65187 |  0:07:38s
epoch 27 | loss: 0.62759 | train_auc: 0.71193 | train_balanced_accuracy: 0.65984 | train_accuracy: 0.66014 | valid_auc: 0.69859 | valid_balanced_accuracy: 0.65034 | valid_accuracy: 0.65061 |  0:07:56s
epoch 28 | loss: 0.62886 | train_auc: 0.71391 | train_balanced_accuracy: 0.65989 | train_accuracy: 0.66002 | valid_auc: 0.70027 | valid_balanced_accuracy: 0.64986 | valid_accuracy: 0.64998 |  0:08:11s
epoch 29 | loss: 0.62681 | train_auc: 0.71545 | train_balanced_accuracy: 0.65989 | train_accuracy: 0.66014 | valid_auc: 0.70307 | valid_balanced_accuracy: 0.6472  | valid_accuracy: 0.64747 |  0:08:27s
epoch 30 | loss: 0.62524 | train_auc: 0.71836 | train_balanced_accuracy: 0.66359 | train_accuracy: 0.66387 | valid_auc: 0.70561 | valid_balanced_accuracy: 0.65238 | valid_accuracy: 0.65266 |  0:08:45s
epoch 31 | loss: 0.6244  | train_auc: 0.71777 | train_balanced_accuracy: 0.65928 | train_accuracy: 0.65943 | valid_auc: 0.70571 | valid_balanced_accuracy: 0.65172 | valid_accuracy: 0.65187 |  0:09:02s
epoch 32 | loss: 0.62581 | train_auc: 0.71859 | train_balanced_accuracy: 0.66023 | train_accuracy: 0.66045 | valid_auc: 0.70504 | valid_balanced_accuracy: 0.64821 | valid_accuracy: 0.64841 |  0:09:19s
epoch 33 | loss: 0.62759 | train_auc: 0.7177  | train_balanced_accuracy: 0.66001 | train_accuracy: 0.66021 | valid_auc: 0.70213 | valid_balanced_accuracy: 0.64931 | valid_accuracy: 0.64951 |  0:09:36s
epoch 34 | loss: 0.61897 | train_auc: 0.71774 | train_balanced_accuracy: 0.66021 | train_accuracy: 0.66041 | valid_auc: 0.70246 | valid_balanced_accuracy: 0.64632 | valid_accuracy: 0.64652 |  0:09:52s
epoch 35 | loss: 0.62248 | train_auc: 0.71327 | train_balanced_accuracy: 0.65938 | train_accuracy: 0.65958 | valid_auc: 0.70468 | valid_balanced_accuracy: 0.64489 | valid_accuracy: 0.64511 |  0:10:10s
epoch 36 | loss: 0.61676 | train_auc: 0.71199 | train_balanced_accuracy: 0.6575  | train_accuracy: 0.65766 | valid_auc: 0.70391 | valid_balanced_accuracy: 0.64686 | valid_accuracy: 0.64699 |  0:10:26s
epoch 37 | loss: 0.62071 | train_auc: 0.71136 | train_balanced_accuracy: 0.6551  | train_accuracy: 0.65522 | valid_auc: 0.70546 | valid_balanced_accuracy: 0.64881 | valid_accuracy: 0.64888 |  0:10:44s
epoch 38 | loss: 0.61875 | train_auc: 0.70451 | train_balanced_accuracy: 0.65238 | train_accuracy: 0.65246 | valid_auc: 0.70195 | valid_balanced_accuracy: 0.65067 | valid_accuracy: 0.65077 |  0:11:00s
epoch 39 | loss: 0.62147 | train_auc: 0.70809 | train_balanced_accuracy: 0.65358 | train_accuracy: 0.65376 | valid_auc: 0.70344 | valid_balanced_accuracy: 0.64664 | valid_accuracy: 0.64684 |  0:11:19s
epoch 40 | loss: 0.61732 | train_auc: 0.71859 | train_balanced_accuracy: 0.66101 | train_accuracy: 0.6612  | valid_auc: 0.70747 | valid_balanced_accuracy: 0.64775 | valid_accuracy: 0.64794 |  0:11:36s
epoch 41 | loss: 0.61788 | train_auc: 0.71714 | train_balanced_accuracy: 0.65852 | train_accuracy: 0.65876 | valid_auc: 0.70707 | valid_balanced_accuracy: 0.64863 | valid_accuracy: 0.64888 |  0:11:53s
epoch 42 | loss: 0.61779 | train_auc: 0.71542 | train_balanced_accuracy: 0.65803 | train_accuracy: 0.65821 | valid_auc: 0.70716 | valid_balanced_accuracy: 0.65294 | valid_accuracy: 0.65313 |  0:12:11s
epoch 43 | loss: 0.61442 | train_auc: 0.72687 | train_balanced_accuracy: 0.66582 | train_accuracy: 0.66592 | valid_auc: 0.7103  | valid_balanced_accuracy: 0.64925 | valid_accuracy: 0.64935 |  0:12:29s
epoch 44 | loss: 0.61542 | train_auc: 0.72912 | train_balanced_accuracy: 0.66991 | train_accuracy: 0.67013 | valid_auc: 0.71409 | valid_balanced_accuracy: 0.65606 | valid_accuracy: 0.65628 |  0:12:44s
epoch 45 | loss: 0.61424 | train_auc: 0.70935 | train_balanced_accuracy: 0.65531 | train_accuracy: 0.65569 | valid_auc: 0.70086 | valid_balanced_accuracy: 0.64392 | valid_accuracy: 0.64432 |  0:13:02s
epoch 46 | loss: 0.61638 | train_auc: 0.70606 | train_balanced_accuracy: 0.65066 | train_accuracy: 0.65097 | valid_auc: 0.7009  | valid_balanced_accuracy: 0.64855 | valid_accuracy: 0.64888 |  0:13:20s
epoch 47 | loss: 0.61745 | train_auc: 0.73195 | train_balanced_accuracy: 0.67248 | train_accuracy: 0.67269 | valid_auc: 0.71356 | valid_balanced_accuracy: 0.65732 | valid_accuracy: 0.65754 |  0:13:38s
epoch 48 | loss: 0.61376 | train_auc: 0.73136 | train_balanced_accuracy: 0.66957 | train_accuracy: 0.66997 | valid_auc: 0.71352 | valid_balanced_accuracy: 0.65504 | valid_accuracy: 0.65549 |  0:13:54s
epoch 49 | loss: 0.61358 | train_auc: 0.73117 | train_balanced_accuracy: 0.67046 | train_accuracy: 0.67076 | valid_auc: 0.71677 | valid_balanced_accuracy: 0.65819 | valid_accuracy: 0.65848 |  0:14:10s
epoch 50 | loss: 0.61015 | train_auc: 0.72942 | train_balanced_accuracy: 0.66757 | train_accuracy: 0.66769 | valid_auc: 0.7137  | valid_balanced_accuracy: 0.65124 | valid_accuracy: 0.6514  |  0:14:28s
epoch 51 | loss: 0.61235 | train_auc: 0.72416 | train_balanced_accuracy: 0.6651  | train_accuracy: 0.66537 | valid_auc: 0.70856 | valid_balanced_accuracy: 0.64875 | valid_accuracy: 0.64904 |  0:14:44s
epoch 52 | loss: 0.61381 | train_auc: 0.72406 | train_balanced_accuracy: 0.66591 | train_accuracy: 0.66619 | valid_auc: 0.70988 | valid_balanced_accuracy: 0.653   | valid_accuracy: 0.65329 |  0:15:01s
epoch 53 | loss: 0.61603 | train_auc: 0.72601 | train_balanced_accuracy: 0.66632 | train_accuracy: 0.66659 | valid_auc: 0.71125 | valid_balanced_accuracy: 0.65382 | valid_accuracy: 0.65408 |  0:15:19s
epoch 54 | loss: 0.61608 | train_auc: 0.71389 | train_balanced_accuracy: 0.65761 | train_accuracy: 0.65781 | valid_auc: 0.70721 | valid_balanced_accuracy: 0.6457  | valid_accuracy: 0.64589 |  0:15:35s
epoch 55 | loss: 0.61457 | train_auc: 0.71962 | train_balanced_accuracy: 0.66162 | train_accuracy: 0.66195 | valid_auc: 0.7088  | valid_balanced_accuracy: 0.649   | valid_accuracy: 0.64935 |  0:15:53s
epoch 56 | loss: 0.61482 | train_auc: 0.73339 | train_balanced_accuracy: 0.67228 | train_accuracy: 0.67261 | valid_auc: 0.71684 | valid_balanced_accuracy: 0.65563 | valid_accuracy: 0.65596 |  0:16:10s
epoch 57 | loss: 0.61109 | train_auc: 0.73154 | train_balanced_accuracy: 0.67165 | train_accuracy: 0.6719  | valid_auc: 0.71663 | valid_balanced_accuracy: 0.65696 | valid_accuracy: 0.65722 |  0:16:28s
epoch 58 | loss: 0.60944 | train_auc: 0.73517 | train_balanced_accuracy: 0.67501 | train_accuracy: 0.67528 | valid_auc: 0.71779 | valid_balanced_accuracy: 0.65629 | valid_accuracy: 0.65659 |  0:16:43s
epoch 59 | loss: 0.61542 | train_auc: 0.73509 | train_balanced_accuracy: 0.67375 | train_accuracy: 0.67406 | valid_auc: 0.71984 | valid_balanced_accuracy: 0.65721 | valid_accuracy: 0.65754 |  0:17:00s
epoch 60 | loss: 0.6159  | train_auc: 0.72666 | train_balanced_accuracy: 0.66965 | train_accuracy: 0.67013 | valid_auc: 0.71535 | valid_balanced_accuracy: 0.65767 | valid_accuracy: 0.65817 |  0:17:16s
epoch 61 | loss: 0.61683 | train_auc: 0.72988 | train_balanced_accuracy: 0.67057 | train_accuracy: 0.67088 | valid_auc: 0.71903 | valid_balanced_accuracy: 0.65925 | valid_accuracy: 0.65958 |  0:17:34s
epoch 62 | loss: 0.60767 | train_auc: 0.73339 | train_balanced_accuracy: 0.67143 | train_accuracy: 0.67186 | valid_auc: 0.7195  | valid_balanced_accuracy: 0.65567 | valid_accuracy: 0.65612 |  0:17:51s
epoch 63 | loss: 0.60912 | train_auc: 0.73792 | train_balanced_accuracy: 0.67689 | train_accuracy: 0.67729 | valid_auc: 0.72314 | valid_balanced_accuracy: 0.65948 | valid_accuracy: 0.6599  |  0:18:07s
epoch 64 | loss: 0.60787 | train_auc: 0.73754 | train_balanced_accuracy: 0.67765 | train_accuracy: 0.678   | valid_auc: 0.7224  | valid_balanced_accuracy: 0.65986 | valid_accuracy: 0.66021 |  0:18:23s
epoch 65 | loss: 0.61521 | train_auc: 0.73059 | train_balanced_accuracy: 0.67076 | train_accuracy: 0.67099 | valid_auc: 0.71348 | valid_balanced_accuracy: 0.65243 | valid_accuracy: 0.65266 |  0:18:39s
epoch 66 | loss: 0.6082  | train_auc: 0.735   | train_balanced_accuracy: 0.67374 | train_accuracy: 0.67406 | valid_auc: 0.7173  | valid_balanced_accuracy: 0.65516 | valid_accuracy: 0.65549 |  0:18:57s
epoch 67 | loss: 0.61131 | train_auc: 0.72325 | train_balanced_accuracy: 0.6634  | train_accuracy: 0.66383 | valid_auc: 0.71144 | valid_balanced_accuracy: 0.65221 | valid_accuracy: 0.65266 |  0:19:13s
epoch 68 | loss: 0.60956 | train_auc: 0.7067  | train_balanced_accuracy: 0.6489  | train_accuracy: 0.64924 | valid_auc: 0.70377 | valid_balanced_accuracy: 0.64643 | valid_accuracy: 0.64684 |  0:19:29s
epoch 69 | loss: 0.61108 | train_auc: 0.70049 | train_balanced_accuracy: 0.64684 | train_accuracy: 0.64723 | valid_auc: 0.70145 | valid_balanced_accuracy: 0.64799 | valid_accuracy: 0.64841 |  0:19:47s
epoch 70 | loss: 0.60829 | train_auc: 0.72631 | train_balanced_accuracy: 0.66539 | train_accuracy: 0.66572 | valid_auc: 0.71186 | valid_balanced_accuracy: 0.65154 | valid_accuracy: 0.65187 |  0:20:04s
epoch 71 | loss: 0.60825 | train_auc: 0.73886 | train_balanced_accuracy: 0.67764 | train_accuracy: 0.67804 | valid_auc: 0.72131 | valid_balanced_accuracy: 0.65447 | valid_accuracy: 0.65486 |  0:20:21s
epoch 72 | loss: 0.60611 | train_auc: 0.73795 | train_balanced_accuracy: 0.67582 | train_accuracy: 0.67611 | valid_auc: 0.72077 | valid_balanced_accuracy: 0.65553 | valid_accuracy: 0.65581 |  0:20:40s
epoch 73 | loss: 0.60587 | train_auc: 0.70676 | train_balanced_accuracy: 0.65282 | train_accuracy: 0.65317 | valid_auc: 0.70659 | valid_balanced_accuracy: 0.65041 | valid_accuracy: 0.65077 |  0:20:57s
epoch 74 | loss: 0.60666 | train_auc: 0.7026  | train_balanced_accuracy: 0.65029 | train_accuracy: 0.65065 | valid_auc: 0.70367 | valid_balanced_accuracy: 0.65041 | valid_accuracy: 0.65077 |  0:21:12s
epoch 75 | loss: 0.60384 | train_auc: 0.70902 | train_balanced_accuracy: 0.65413 | train_accuracy: 0.65439 | valid_auc: 0.70839 | valid_balanced_accuracy: 0.64985 | valid_accuracy: 0.65014 |  0:21:27s
epoch 76 | loss: 0.60655 | train_auc: 0.73542 | train_balanced_accuracy: 0.67298 | train_accuracy: 0.67339 | valid_auc: 0.72014 | valid_balanced_accuracy: 0.6554  | valid_accuracy: 0.65581 |  0:21:44s
epoch 77 | loss: 0.60558 | train_auc: 0.73517 | train_balanced_accuracy: 0.67193 | train_accuracy: 0.67229 | valid_auc: 0.72036 | valid_balanced_accuracy: 0.65764 | valid_accuracy: 0.65801 |  0:22:03s
epoch 78 | loss: 0.60295 | train_auc: 0.73926 | train_balanced_accuracy: 0.67703 | train_accuracy: 0.67745 | valid_auc: 0.722   | valid_balanced_accuracy: 0.65823 | valid_accuracy: 0.65864 |  0:22:20s
epoch 79 | loss: 0.6066  | train_auc: 0.73788 | train_balanced_accuracy: 0.67271 | train_accuracy: 0.67304 | valid_auc: 0.71974 | valid_balanced_accuracy: 0.65314 | valid_accuracy: 0.65345 |  0:22:36s
epoch 80 | loss: 0.60809 | train_auc: 0.73793 | train_balanced_accuracy: 0.67341 | train_accuracy: 0.67391 | valid_auc: 0.72146 | valid_balanced_accuracy: 0.65535 | valid_accuracy: 0.65581 |  0:22:54s
epoch 81 | loss: 0.60229 | train_auc: 0.74337 | train_balanced_accuracy: 0.6793  | train_accuracy: 0.67957 | valid_auc: 0.72491 | valid_balanced_accuracy: 0.65951 | valid_accuracy: 0.65974 |  0:23:11s
epoch 82 | loss: 0.60362 | train_auc: 0.74042 | train_balanced_accuracy: 0.67833 | train_accuracy: 0.67855 | valid_auc: 0.72561 | valid_balanced_accuracy: 0.6614  | valid_accuracy: 0.66163 |  0:23:27s
epoch 83 | loss: 0.60283 | train_auc: 0.73049 | train_balanced_accuracy: 0.66953 | train_accuracy: 0.66981 | valid_auc: 0.72224 | valid_balanced_accuracy: 0.65978 | valid_accuracy: 0.66006 |  0:23:44s
epoch 84 | loss: 0.6036  | train_auc: 0.73049 | train_balanced_accuracy: 0.66943 | train_accuracy: 0.66977 | valid_auc: 0.72247 | valid_balanced_accuracy: 0.65921 | valid_accuracy: 0.65958 |  0:24:01s
epoch 85 | loss: 0.60622 | train_auc: 0.7385  | train_balanced_accuracy: 0.67508 | train_accuracy: 0.67544 | valid_auc: 0.72596 | valid_balanced_accuracy: 0.66503 | valid_accuracy: 0.66541 |  0:24:19s
epoch 86 | loss: 0.6031  | train_auc: 0.74393 | train_balanced_accuracy: 0.67782 | train_accuracy: 0.67835 | valid_auc: 0.72723 | valid_balanced_accuracy: 0.66441 | valid_accuracy: 0.66494 |  0:24:36s
epoch 87 | loss: 0.60286 | train_auc: 0.74096 | train_balanced_accuracy: 0.67715 | train_accuracy: 0.67753 | valid_auc: 0.72535 | valid_balanced_accuracy: 0.66363 | valid_accuracy: 0.66399 |  0:24:53s
epoch 88 | loss: 0.60527 | train_auc: 0.74361 | train_balanced_accuracy: 0.68021 | train_accuracy: 0.68052 | valid_auc: 0.72745 | valid_balanced_accuracy: 0.664   | valid_accuracy: 0.66431 |  0:25:09s
epoch 89 | loss: 0.60223 | train_auc: 0.7427  | train_balanced_accuracy: 0.67713 | train_accuracy: 0.67749 | valid_auc: 0.72598 | valid_balanced_accuracy: 0.66065 | valid_accuracy: 0.661   |  0:25:25s
epoch 90 | loss: 0.59907 | train_auc: 0.74226 | train_balanced_accuracy: 0.68062 | train_accuracy: 0.68091 | valid_auc: 0.72469 | valid_balanced_accuracy: 0.66295 | valid_accuracy: 0.6632  |  0:25:42s
epoch 91 | loss: 0.60304 | train_auc: 0.72896 | train_balanced_accuracy: 0.6673  | train_accuracy: 0.66753 | valid_auc: 0.71536 | valid_balanced_accuracy: 0.65382 | valid_accuracy: 0.65408 |  0:25:58s
epoch 92 | loss: 0.60097 | train_auc: 0.72845 | train_balanced_accuracy: 0.6682  | train_accuracy: 0.6684  | valid_auc: 0.71411 | valid_balanced_accuracy: 0.65244 | valid_accuracy: 0.65266 |  0:26:15s
epoch 93 | loss: 0.60208 | train_auc: 0.7349  | train_balanced_accuracy: 0.67148 | train_accuracy: 0.6717  | valid_auc: 0.71804 | valid_balanced_accuracy: 0.65355 | valid_accuracy: 0.65376 |  0:26:32s
epoch 94 | loss: 0.60567 | train_auc: 0.72458 | train_balanced_accuracy: 0.66374 | train_accuracy: 0.66407 | valid_auc: 0.71204 | valid_balanced_accuracy: 0.65354 | valid_accuracy: 0.65392 |  0:26:51s
epoch 95 | loss: 0.59654 | train_auc: 0.72199 | train_balanced_accuracy: 0.65985 | train_accuracy: 0.6601  | valid_auc: 0.71242 | valid_balanced_accuracy: 0.65647 | valid_accuracy: 0.65675 |  0:27:08s
epoch 96 | loss: 0.59856 | train_auc: 0.74521 | train_balanced_accuracy: 0.68269 | train_accuracy: 0.68296 | valid_auc: 0.72488 | valid_balanced_accuracy: 0.6598  | valid_accuracy: 0.66006 |  0:27:25s
epoch 97 | loss: 0.60278 | train_auc: 0.7367  | train_balanced_accuracy: 0.67559 | train_accuracy: 0.67611 | valid_auc: 0.72456 | valid_balanced_accuracy: 0.66696 | valid_accuracy: 0.66745 |  0:27:44s
epoch 98 | loss: 0.60416 | train_auc: 0.73451 | train_balanced_accuracy: 0.6742  | train_accuracy: 0.67465 | valid_auc: 0.72574 | valid_balanced_accuracy: 0.66591 | valid_accuracy: 0.66635 |  0:28:03s
epoch 99 | loss: 0.60318 | train_auc: 0.73904 | train_balanced_accuracy: 0.67671 | train_accuracy: 0.67717 | valid_auc: 0.72704 | valid_balanced_accuracy: 0.66638 | valid_accuracy: 0.66682 |  0:28:20s
epoch 100| loss: 0.59833 | train_auc: 0.7405  | train_balanced_accuracy: 0.67786 | train_accuracy: 0.67827 | valid_auc: 0.72738 | valid_balanced_accuracy: 0.66262 | valid_accuracy: 0.66305 |  0:28:37s
epoch 101| loss: 0.60388 | train_auc: 0.74004 | train_balanced_accuracy: 0.67627 | train_accuracy: 0.67666 | valid_auc: 0.7274  | valid_balanced_accuracy: 0.66486 | valid_accuracy: 0.66525 |  0:28:55s
epoch 102| loss: 0.60207 | train_auc: 0.74587 | train_balanced_accuracy: 0.68146 | train_accuracy: 0.68185 | valid_auc: 0.72848 | valid_balanced_accuracy: 0.66296 | valid_accuracy: 0.66336 |  0:29:10s
epoch 103| loss: 0.59777 | train_auc: 0.74196 | train_balanced_accuracy: 0.67797 | train_accuracy: 0.67839 | valid_auc: 0.7224  | valid_balanced_accuracy: 0.65856 | valid_accuracy: 0.65895 |  0:29:28s
epoch 104| loss: 0.59966 | train_auc: 0.7139  | train_balanced_accuracy: 0.65273 | train_accuracy: 0.65301 | valid_auc: 0.70464 | valid_balanced_accuracy: 0.64324 | valid_accuracy: 0.64353 |  0:29:43s
epoch 105| loss: 0.60267 | train_auc: 0.74433 | train_balanced_accuracy: 0.68212 | train_accuracy: 0.68248 | valid_auc: 0.72426 | valid_balanced_accuracy: 0.65768 | valid_accuracy: 0.65801 |  0:30:01s
epoch 106| loss: 0.5967  | train_auc: 0.75083 | train_balanced_accuracy: 0.6865  | train_accuracy: 0.68681 | valid_auc: 0.73128 | valid_balanced_accuracy: 0.66811 | valid_accuracy: 0.6684  |  0:30:18s
epoch 107| loss: 0.60109 | train_auc: 0.75054 | train_balanced_accuracy: 0.68598 | train_accuracy: 0.68638 | valid_auc: 0.73106 | valid_balanced_accuracy: 0.66739 | valid_accuracy: 0.66777 |  0:30:33s
epoch 108| loss: 0.60279 | train_auc: 0.75122 | train_balanced_accuracy: 0.68592 | train_accuracy: 0.68614 | valid_auc: 0.72933 | valid_balanced_accuracy: 0.66569 | valid_accuracy: 0.66588 |  0:30:50s
epoch 109| loss: 0.59866 | train_auc: 0.75089 | train_balanced_accuracy: 0.68378 | train_accuracy: 0.68394 | valid_auc: 0.73091 | valid_balanced_accuracy: 0.66512 | valid_accuracy: 0.66525 |  0:31:07s
epoch 110| loss: 0.60104 | train_auc: 0.73621 | train_balanced_accuracy: 0.67267 | train_accuracy: 0.67288 | valid_auc: 0.71905 | valid_balanced_accuracy: 0.66082 | valid_accuracy: 0.661   |  0:31:25s
epoch 111| loss: 0.59378 | train_auc: 0.74222 | train_balanced_accuracy: 0.67889 | train_accuracy: 0.6791  | valid_auc: 0.72275 | valid_balanced_accuracy: 0.66352 | valid_accuracy: 0.66368 |  0:31:43s
epoch 112| loss: 0.59642 | train_auc: 0.74578 | train_balanced_accuracy: 0.68183 | train_accuracy: 0.68201 | valid_auc: 0.72665 | valid_balanced_accuracy: 0.66385 | valid_accuracy: 0.66399 |  0:31:59s
epoch 113| loss: 0.60425 | train_auc: 0.75153 | train_balanced_accuracy: 0.68622 | train_accuracy: 0.68642 | valid_auc: 0.73182 | valid_balanced_accuracy: 0.66681 | valid_accuracy: 0.66698 |  0:32:16s
epoch 114| loss: 0.59773 | train_auc: 0.73908 | train_balanced_accuracy: 0.67797 | train_accuracy: 0.67823 | valid_auc: 0.72625 | valid_balanced_accuracy: 0.66136 | valid_accuracy: 0.66163 |  0:32:33s
epoch 115| loss: 0.59797 | train_auc: 0.73719 | train_balanced_accuracy: 0.67558 | train_accuracy: 0.67599 | valid_auc: 0.72778 | valid_balanced_accuracy: 0.66581 | valid_accuracy: 0.66619 |  0:32:50s
epoch 116| loss: 0.59874 | train_auc: 0.73886 | train_balanced_accuracy: 0.67616 | train_accuracy: 0.67662 | valid_auc: 0.72649 | valid_balanced_accuracy: 0.66795 | valid_accuracy: 0.6684  |  0:33:07s
epoch 117| loss: 0.5967  | train_auc: 0.73596 | train_balanced_accuracy: 0.67618 | train_accuracy: 0.67658 | valid_auc: 0.72742 | valid_balanced_accuracy: 0.66597 | valid_accuracy: 0.66635 |  0:33:23s
epoch 118| loss: 0.59832 | train_auc: 0.74094 | train_balanced_accuracy: 0.68065 | train_accuracy: 0.68099 | valid_auc: 0.72702 | valid_balanced_accuracy: 0.66724 | valid_accuracy: 0.66761 |  0:33:41s
epoch 119| loss: 0.60106 | train_auc: 0.74487 | train_balanced_accuracy: 0.68167 | train_accuracy: 0.68205 | valid_auc: 0.729   | valid_balanced_accuracy: 0.67118 | valid_accuracy: 0.67155 |  0:33:58s
epoch 120| loss: 0.59458 | train_auc: 0.75203 | train_balanced_accuracy: 0.68763 | train_accuracy: 0.68795 | valid_auc: 0.73052 | valid_balanced_accuracy: 0.66445 | valid_accuracy: 0.66478 |  0:34:14s
epoch 121| loss: 0.59967 | train_auc: 0.75185 | train_balanced_accuracy: 0.68855 | train_accuracy: 0.6889  | valid_auc: 0.73182 | valid_balanced_accuracy: 0.67343 | valid_accuracy: 0.67375 |  0:34:32s
epoch 122| loss: 0.59038 | train_auc: 0.74916 | train_balanced_accuracy: 0.6852  | train_accuracy: 0.68551 | valid_auc: 0.73044 | valid_balanced_accuracy: 0.6667  | valid_accuracy: 0.66698 |  0:34:47s
epoch 123| loss: 0.59734 | train_auc: 0.74107 | train_balanced_accuracy: 0.6782  | train_accuracy: 0.67839 | valid_auc: 0.72218 | valid_balanced_accuracy: 0.6651  | valid_accuracy: 0.66525 |  0:35:02s
epoch 124| loss: 0.59339 | train_auc: 0.73308 | train_balanced_accuracy: 0.67187 | train_accuracy: 0.67225 | valid_auc: 0.71884 | valid_balanced_accuracy: 0.66271 | valid_accuracy: 0.66305 |  0:35:17s
epoch 125| loss: 0.59938 | train_auc: 0.71787 | train_balanced_accuracy: 0.65763 | train_accuracy: 0.65793 | valid_auc: 0.70889 | valid_balanced_accuracy: 0.65127 | valid_accuracy: 0.65156 |  0:35:31s
epoch 126| loss: 0.59846 | train_auc: 0.72657 | train_balanced_accuracy: 0.66241 | train_accuracy: 0.66257 | valid_auc: 0.71399 | valid_balanced_accuracy: 0.6572  | valid_accuracy: 0.65738 |  0:35:48s
epoch 127| loss: 0.59596 | train_auc: 0.74917 | train_balanced_accuracy: 0.68621 | train_accuracy: 0.68642 | valid_auc: 0.72774 | valid_balanced_accuracy: 0.66569 | valid_accuracy: 0.66588 |  0:36:06s
epoch 128| loss: 0.59234 | train_auc: 0.74581 | train_balanced_accuracy: 0.683   | train_accuracy: 0.68303 | valid_auc: 0.72362 | valid_balanced_accuracy: 0.66411 | valid_accuracy: 0.66415 |  0:36:22s
epoch 129| loss: 0.59772 | train_auc: 0.73492 | train_balanced_accuracy: 0.67305 | train_accuracy: 0.67312 | valid_auc: 0.7179  | valid_balanced_accuracy: 0.66012 | valid_accuracy: 0.66021 |  0:36:38s
epoch 130| loss: 0.5978  | train_auc: 0.74281 | train_balanced_accuracy: 0.68003 | train_accuracy: 0.68032 | valid_auc: 0.72214 | valid_balanced_accuracy: 0.66166 | valid_accuracy: 0.66195 |  0:36:52s
epoch 131| loss: 0.59734 | train_auc: 0.75513 | train_balanced_accuracy: 0.68684 | train_accuracy: 0.68693 | valid_auc: 0.73452 | valid_balanced_accuracy: 0.67022 | valid_accuracy: 0.67029 |  0:37:10s
epoch 132| loss: 0.5936  | train_auc: 0.74172 | train_balanced_accuracy: 0.67945 | train_accuracy: 0.67985 | valid_auc: 0.72859 | valid_balanced_accuracy: 0.67133 | valid_accuracy: 0.6717  |  0:37:27s
epoch 133| loss: 0.59493 | train_auc: 0.75296 | train_balanced_accuracy: 0.68646 | train_accuracy: 0.68669 | valid_auc: 0.73072 | valid_balanced_accuracy: 0.66547 | valid_accuracy: 0.66572 |  0:37:43s
epoch 134| loss: 0.59181 | train_auc: 0.75422 | train_balanced_accuracy: 0.68625 | train_accuracy: 0.68642 | valid_auc: 0.73291 | valid_balanced_accuracy: 0.6736  | valid_accuracy: 0.67375 |  0:38:02s
epoch 135| loss: 0.59861 | train_auc: 0.74922 | train_balanced_accuracy: 0.68326 | train_accuracy: 0.68347 | valid_auc: 0.72875 | valid_balanced_accuracy: 0.6657  | valid_accuracy: 0.66588 |  0:38:19s
epoch 136| loss: 0.59292 | train_auc: 0.74695 | train_balanced_accuracy: 0.68359 | train_accuracy: 0.68366 | valid_auc: 0.7279  | valid_balanced_accuracy: 0.66852 | valid_accuracy: 0.66856 |  0:38:35s
epoch 137| loss: 0.59406 | train_auc: 0.75728 | train_balanced_accuracy: 0.69119 | train_accuracy: 0.69138 | valid_auc: 0.73681 | valid_balanced_accuracy: 0.67214 | valid_accuracy: 0.67233 |  0:38:53s
epoch 138| loss: 0.59285 | train_auc: 0.75739 | train_balanced_accuracy: 0.69031 | train_accuracy: 0.69051 | valid_auc: 0.73691 | valid_balanced_accuracy: 0.6718  | valid_accuracy: 0.67202 |  0:39:09s
epoch 139| loss: 0.59138 | train_auc: 0.7563  | train_balanced_accuracy: 0.68936 | train_accuracy: 0.68953 | valid_auc: 0.73559 | valid_balanced_accuracy: 0.67517 | valid_accuracy: 0.67532 |  0:39:26s
epoch 140| loss: 0.59395 | train_auc: 0.7528  | train_balanced_accuracy: 0.68716 | train_accuracy: 0.6874  | valid_auc: 0.73302 | valid_balanced_accuracy: 0.66959 | valid_accuracy: 0.66981 |  0:39:43s
epoch 141| loss: 0.59542 | train_auc: 0.75254 | train_balanced_accuracy: 0.68572 | train_accuracy: 0.68599 | valid_auc: 0.73047 | valid_balanced_accuracy: 0.66608 | valid_accuracy: 0.66635 |  0:40:00s
epoch 142| loss: 0.59164 | train_auc: 0.73673 | train_balanced_accuracy: 0.67799 | train_accuracy: 0.67831 | valid_auc: 0.72715 | valid_balanced_accuracy: 0.66856 | valid_accuracy: 0.66887 |  0:40:17s
epoch 143| loss: 0.58641 | train_auc: 0.74221 | train_balanced_accuracy: 0.67797 | train_accuracy: 0.67847 | valid_auc: 0.72988 | valid_balanced_accuracy: 0.66979 | valid_accuracy: 0.67029 |  0:40:33s
epoch 144| loss: 0.59127 | train_auc: 0.75092 | train_balanced_accuracy: 0.68699 | train_accuracy: 0.68732 | valid_auc: 0.73131 | valid_balanced_accuracy: 0.67011 | valid_accuracy: 0.67044 |  0:40:49s
epoch 145| loss: 0.59032 | train_auc: 0.75089 | train_balanced_accuracy: 0.687   | train_accuracy: 0.68724 | valid_auc: 0.7326  | valid_balanced_accuracy: 0.67177 | valid_accuracy: 0.67202 |  0:41:04s
epoch 146| loss: 0.59757 | train_auc: 0.75476 | train_balanced_accuracy: 0.68959 | train_accuracy: 0.68992 | valid_auc: 0.73511 | valid_balanced_accuracy: 0.67435 | valid_accuracy: 0.67469 |  0:41:20s
epoch 147| loss: 0.59336 | train_auc: 0.75904 | train_balanced_accuracy: 0.69256 | train_accuracy: 0.69275 | valid_auc: 0.73879 | valid_balanced_accuracy: 0.67181 | valid_accuracy: 0.67202 |  0:41:36s
epoch 148| loss: 0.59652 | train_auc: 0.75995 | train_balanced_accuracy: 0.69307 | train_accuracy: 0.6933  | valid_auc: 0.73888 | valid_balanced_accuracy: 0.67479 | valid_accuracy: 0.67501 |  0:41:52s
epoch 149| loss: 0.58994 | train_auc: 0.75601 | train_balanced_accuracy: 0.69061 | train_accuracy: 0.69082 | valid_auc: 0.73342 | valid_balanced_accuracy: 0.67618 | valid_accuracy: 0.67642 |  0:42:11s
epoch 150| loss: 0.59308 | train_auc: 0.75021 | train_balanced_accuracy: 0.68642 | train_accuracy: 0.68669 | valid_auc: 0.72729 | valid_balanced_accuracy: 0.6689  | valid_accuracy: 0.66918 |  0:42:27s
epoch 151| loss: 0.59048 | train_auc: 0.74851 | train_balanced_accuracy: 0.68655 | train_accuracy: 0.68673 | valid_auc: 0.72673 | valid_balanced_accuracy: 0.6693  | valid_accuracy: 0.6695  |  0:42:44s
epoch 152| loss: 0.59055 | train_auc: 0.75286 | train_balanced_accuracy: 0.68874 | train_accuracy: 0.68894 | valid_auc: 0.73064 | valid_balanced_accuracy: 0.67137 | valid_accuracy: 0.67155 |  0:43:03s
epoch 153| loss: 0.58995 | train_auc: 0.76082 | train_balanced_accuracy: 0.69438 | train_accuracy: 0.69464 | valid_auc: 0.73895 | valid_balanced_accuracy: 0.67475 | valid_accuracy: 0.67501 |  0:43:21s
epoch 154| loss: 0.59414 | train_auc: 0.76009 | train_balanced_accuracy: 0.69374 | train_accuracy: 0.69389 | valid_auc: 0.73709 | valid_balanced_accuracy: 0.67141 | valid_accuracy: 0.67155 |  0:43:37s
epoch 155| loss: 0.59295 | train_auc: 0.75719 | train_balanced_accuracy: 0.6906  | train_accuracy: 0.69082 | valid_auc: 0.73484 | valid_balanced_accuracy: 0.67716 | valid_accuracy: 0.67737 |  0:43:53s
epoch 156| loss: 0.59414 | train_auc: 0.75218 | train_balanced_accuracy: 0.68681 | train_accuracy: 0.68705 | valid_auc: 0.73091 | valid_balanced_accuracy: 0.67336 | valid_accuracy: 0.67359 |  0:44:09s
epoch 157| loss: 0.59662 | train_auc: 0.75396 | train_balanced_accuracy: 0.68855 | train_accuracy: 0.68882 | valid_auc: 0.73141 | valid_balanced_accuracy: 0.67462 | valid_accuracy: 0.67485 |  0:44:25s
epoch 158| loss: 0.59657 | train_auc: 0.75913 | train_balanced_accuracy: 0.69331 | train_accuracy: 0.69358 | valid_auc: 0.7359  | valid_balanced_accuracy: 0.67807 | valid_accuracy: 0.67831 |  0:44:42s
epoch 159| loss: 0.58865 | train_auc: 0.76004 | train_balanced_accuracy: 0.69449 | train_accuracy: 0.69468 | valid_auc: 0.73619 | valid_balanced_accuracy: 0.67609 | valid_accuracy: 0.67627 |  0:44:59s
epoch 160| loss: 0.59218 | train_auc: 0.76165 | train_balanced_accuracy: 0.6947  | train_accuracy: 0.69476 | valid_auc: 0.73652 | valid_balanced_accuracy: 0.67859 | valid_accuracy: 0.67863 |  0:45:16s
epoch 161| loss: 0.5888  | train_auc: 0.75786 | train_balanced_accuracy: 0.69244 | train_accuracy: 0.69267 | valid_auc: 0.73302 | valid_balanced_accuracy: 0.67451 | valid_accuracy: 0.67469 |  0:45:34s
epoch 162| loss: 0.58888 | train_auc: 0.75751 | train_balanced_accuracy: 0.69172 | train_accuracy: 0.69189 | valid_auc: 0.73233 | valid_balanced_accuracy: 0.67392 | valid_accuracy: 0.67406 |  0:45:51s
epoch 163| loss: 0.59292 | train_auc: 0.76135 | train_balanced_accuracy: 0.69466 | train_accuracy: 0.69488 | valid_auc: 0.73431 | valid_balanced_accuracy: 0.67134 | valid_accuracy: 0.67155 |  0:46:07s
epoch 164| loss: 0.58812 | train_auc: 0.75902 | train_balanced_accuracy: 0.69225 | train_accuracy: 0.69256 | valid_auc: 0.73565 | valid_balanced_accuracy: 0.6769  | valid_accuracy: 0.67721 |  0:46:25s
epoch 165| loss: 0.59048 | train_auc: 0.75546 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.68882 | valid_auc: 0.73546 | valid_balanced_accuracy: 0.67385 | valid_accuracy: 0.67422 |  0:46:44s
epoch 166| loss: 0.59028 | train_auc: 0.75807 | train_balanced_accuracy: 0.69193 | train_accuracy: 0.6922  | valid_auc: 0.73465 | valid_balanced_accuracy: 0.67002 | valid_accuracy: 0.67029 |  0:47:00s
epoch 167| loss: 0.58912 | train_auc: 0.7569  | train_balanced_accuracy: 0.69077 | train_accuracy: 0.6911  | valid_auc: 0.73244 | valid_balanced_accuracy: 0.67268 | valid_accuracy: 0.67296 |  0:47:17s
epoch 168| loss: 0.59351 | train_auc: 0.74545 | train_balanced_accuracy: 0.68096 | train_accuracy: 0.6815  | valid_auc: 0.72622 | valid_balanced_accuracy: 0.66977 | valid_accuracy: 0.67029 |  0:47:33s
epoch 169| loss: 0.59082 | train_auc: 0.76248 | train_balanced_accuracy: 0.69468 | train_accuracy: 0.69503 | valid_auc: 0.73715 | valid_balanced_accuracy: 0.67799 | valid_accuracy: 0.67831 |  0:47:51s
epoch 170| loss: 0.58793 | train_auc: 0.76306 | train_balanced_accuracy: 0.69524 | train_accuracy: 0.69547 | valid_auc: 0.73765 | valid_balanced_accuracy: 0.68092 | valid_accuracy: 0.68115 |  0:48:07s
epoch 171| loss: 0.58951 | train_auc: 0.76128 | train_balanced_accuracy: 0.69444 | train_accuracy: 0.6946  | valid_auc: 0.73441 | valid_balanced_accuracy: 0.67596 | valid_accuracy: 0.67611 |  0:48:23s
epoch 172| loss: 0.59063 | train_auc: 0.75934 | train_balanced_accuracy: 0.69061 | train_accuracy: 0.69082 | valid_auc: 0.73475 | valid_balanced_accuracy: 0.67481 | valid_accuracy: 0.67501 |  0:48:42s
epoch 173| loss: 0.59131 | train_auc: 0.76002 | train_balanced_accuracy: 0.69299 | train_accuracy: 0.69326 | valid_auc: 0.7344  | valid_balanced_accuracy: 0.67458 | valid_accuracy: 0.67485 |  0:49:00s
epoch 174| loss: 0.58922 | train_auc: 0.7611  | train_balanced_accuracy: 0.69369 | train_accuracy: 0.69393 | valid_auc: 0.73511 | valid_balanced_accuracy: 0.6729  | valid_accuracy: 0.67312 |  0:49:17s
epoch 175| loss: 0.58891 | train_auc: 0.76226 | train_balanced_accuracy: 0.69603 | train_accuracy: 0.69621 | valid_auc: 0.73694 | valid_balanced_accuracy: 0.6778  | valid_accuracy: 0.678   |  0:49:33s
epoch 176| loss: 0.58913 | train_auc: 0.76513 | train_balanced_accuracy: 0.6975  | train_accuracy: 0.69775 | valid_auc: 0.73966 | valid_balanced_accuracy: 0.68249 | valid_accuracy: 0.68272 |  0:49:49s
epoch 177| loss: 0.59241 | train_auc: 0.75936 | train_balanced_accuracy: 0.69393 | train_accuracy: 0.69413 | valid_auc: 0.73543 | valid_balanced_accuracy: 0.67828 | valid_accuracy: 0.67847 |  0:50:06s
epoch 178| loss: 0.58413 | train_auc: 0.7628  | train_balanced_accuracy: 0.69558 | train_accuracy: 0.69578 | valid_auc: 0.73839 | valid_balanced_accuracy: 0.67923 | valid_accuracy: 0.67941 |  0:50:21s
epoch 179| loss: 0.59219 | train_auc: 0.76271 | train_balanced_accuracy: 0.69588 | train_accuracy: 0.6961  | valid_auc: 0.73648 | valid_balanced_accuracy: 0.67701 | valid_accuracy: 0.67721 |  0:50:40s
epoch 180| loss: 0.58897 | train_auc: 0.73372 | train_balanced_accuracy: 0.6686  | train_accuracy: 0.66891 | valid_auc: 0.71962 | valid_balanced_accuracy: 0.6627  | valid_accuracy: 0.66305 |  0:50:58s
epoch 181| loss: 0.58712 | train_auc: 0.74469 | train_balanced_accuracy: 0.68041 | train_accuracy: 0.68056 | valid_auc: 0.72602 | valid_balanced_accuracy: 0.66873 | valid_accuracy: 0.66887 |  0:51:15s
epoch 182| loss: 0.58373 | train_auc: 0.76295 | train_balanced_accuracy: 0.69431 | train_accuracy: 0.69448 | valid_auc: 0.73793 | valid_balanced_accuracy: 0.67609 | valid_accuracy: 0.67627 |  0:51:30s
epoch 183| loss: 0.58875 | train_auc: 0.7565  | train_balanced_accuracy: 0.69159 | train_accuracy: 0.69181 | valid_auc: 0.73153 | valid_balanced_accuracy: 0.67039 | valid_accuracy: 0.6706  |  0:51:45s
epoch 184| loss: 0.58578 | train_auc: 0.75184 | train_balanced_accuracy: 0.68868 | train_accuracy: 0.68882 | valid_auc: 0.73029 | valid_balanced_accuracy: 0.6708  | valid_accuracy: 0.67092 |  0:52:01s
epoch 185| loss: 0.5851  | train_auc: 0.7634  | train_balanced_accuracy: 0.69389 | train_accuracy: 0.69421 | valid_auc: 0.73565 | valid_balanced_accuracy: 0.67974 | valid_accuracy: 0.68004 |  0:52:19s
epoch 186| loss: 0.58972 | train_auc: 0.76521 | train_balanced_accuracy: 0.69605 | train_accuracy: 0.69629 | valid_auc: 0.73894 | valid_balanced_accuracy: 0.67808 | valid_accuracy: 0.67831 |  0:52:35s
epoch 187| loss: 0.5896  | train_auc: 0.76424 | train_balanced_accuracy: 0.69663 | train_accuracy: 0.69688 | valid_auc: 0.73625 | valid_balanced_accuracy: 0.67553 | valid_accuracy: 0.67579 |  0:52:52s
epoch 188| loss: 0.58745 | train_auc: 0.76305 | train_balanced_accuracy: 0.69555 | train_accuracy: 0.69582 | valid_auc: 0.7356  | valid_balanced_accuracy: 0.67506 | valid_accuracy: 0.67532 |  0:53:09s
epoch 189| loss: 0.58678 | train_auc: 0.76509 | train_balanced_accuracy: 0.6959  | train_accuracy: 0.69621 | valid_auc: 0.73774 | valid_balanced_accuracy: 0.67926 | valid_accuracy: 0.67957 |  0:53:26s
epoch 190| loss: 0.58601 | train_auc: 0.76451 | train_balanced_accuracy: 0.69651 | train_accuracy: 0.69681 | valid_auc: 0.73847 | valid_balanced_accuracy: 0.67678 | valid_accuracy: 0.67705 |  0:53:44s
epoch 191| loss: 0.58236 | train_auc: 0.76573 | train_balanced_accuracy: 0.69558 | train_accuracy: 0.69586 | valid_auc: 0.73885 | valid_balanced_accuracy: 0.67759 | valid_accuracy: 0.67784 |  0:54:00s
epoch 192| loss: 0.58778 | train_auc: 0.76325 | train_balanced_accuracy: 0.69779 | train_accuracy: 0.69802 | valid_auc: 0.73611 | valid_balanced_accuracy: 0.67569 | valid_accuracy: 0.67595 |  0:54:15s
epoch 193| loss: 0.58823 | train_auc: 0.76233 | train_balanced_accuracy: 0.69612 | train_accuracy: 0.69633 | valid_auc: 0.73611 | valid_balanced_accuracy: 0.67574 | valid_accuracy: 0.67595 |  0:54:32s
epoch 194| loss: 0.58617 | train_auc: 0.76286 | train_balanced_accuracy: 0.69648 | train_accuracy: 0.69673 | valid_auc: 0.73666 | valid_balanced_accuracy: 0.67633 | valid_accuracy: 0.67658 |  0:54:48s
epoch 195| loss: 0.58504 | train_auc: 0.76405 | train_balanced_accuracy: 0.69762 | train_accuracy: 0.69787 | valid_auc: 0.73738 | valid_balanced_accuracy: 0.67665 | valid_accuracy: 0.6769  |  0:55:05s
epoch 196| loss: 0.58805 | train_auc: 0.76236 | train_balanced_accuracy: 0.69646 | train_accuracy: 0.69673 | valid_auc: 0.73612 | valid_balanced_accuracy: 0.67456 | valid_accuracy: 0.67485 |  0:55:22s

Early stopping occurred at epoch 196 with best_epoch = 176 and best_valid_accuracy = 0.68272
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 54/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.675 total time=55.5min
[CV 1/5; 55/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70373 | train_auc: 0.59796 | train_balanced_accuracy: 0.5728  | train_accuracy: 0.57277 | valid_auc: 0.60111 | valid_balanced_accuracy: 0.57854 | valid_accuracy: 0.57853 |  0:00:15s
epoch 1  | loss: 0.6539  | train_auc: 0.61822 | train_balanced_accuracy: 0.58759 | train_accuracy: 0.58851 | valid_auc: 0.60585 | valid_balanced_accuracy: 0.58155 | valid_accuracy: 0.58247 |  0:00:33s
epoch 2  | loss: 0.63612 | train_auc: 0.61637 | train_balanced_accuracy: 0.57177 | train_accuracy: 0.57372 | valid_auc: 0.60178 | valid_balanced_accuracy: 0.56206 | valid_accuracy: 0.56405 |  0:00:50s
epoch 3  | loss: 0.62381 | train_auc: 0.64435 | train_balanced_accuracy: 0.60282 | train_accuracy: 0.60386 | valid_auc: 0.63222 | valid_balanced_accuracy: 0.5956  | valid_accuracy: 0.59663 |  0:01:07s
epoch 4  | loss: 0.61425 | train_auc: 0.67529 | train_balanced_accuracy: 0.59165 | train_accuracy: 0.59351 | valid_auc: 0.6628  | valid_balanced_accuracy: 0.58605 | valid_accuracy: 0.58798 |  0:01:23s
epoch 5  | loss: 0.61348 | train_auc: 0.69939 | train_balanced_accuracy: 0.63699 | train_accuracy: 0.63848 | valid_auc: 0.69487 | valid_balanced_accuracy: 0.63666 | valid_accuracy: 0.63818 |  0:01:39s
epoch 6  | loss: 0.61296 | train_auc: 0.69997 | train_balanced_accuracy: 0.64129 | train_accuracy: 0.64214 | valid_auc: 0.68844 | valid_balanced_accuracy: 0.63908 | valid_accuracy: 0.63991 |  0:01:56s
epoch 7  | loss: 0.60838 | train_auc: 0.70674 | train_balanced_accuracy: 0.64553 | train_accuracy: 0.64608 | valid_auc: 0.70266 | valid_balanced_accuracy: 0.64423 | valid_accuracy: 0.64479 |  0:02:15s
epoch 8  | loss: 0.59789 | train_auc: 0.71161 | train_balanced_accuracy: 0.64955 | train_accuracy: 0.65072 | valid_auc: 0.70225 | valid_balanced_accuracy: 0.64643 | valid_accuracy: 0.64762 |  0:02:29s
epoch 9  | loss: 0.60338 | train_auc: 0.71225 | train_balanced_accuracy: 0.65053 | train_accuracy: 0.65127 | valid_auc: 0.708   | valid_balanced_accuracy: 0.6453  | valid_accuracy: 0.64605 |  0:02:45s
epoch 10 | loss: 0.59305 | train_auc: 0.71298 | train_balanced_accuracy: 0.65029 | train_accuracy: 0.65064 | valid_auc: 0.70885 | valid_balanced_accuracy: 0.64936 | valid_accuracy: 0.64967 |  0:03:02s
epoch 11 | loss: 0.59623 | train_auc: 0.71873 | train_balanced_accuracy: 0.65317 | train_accuracy: 0.65371 | valid_auc: 0.71011 | valid_balanced_accuracy: 0.64831 | valid_accuracy: 0.64888 |  0:03:19s
epoch 12 | loss: 0.5982  | train_auc: 0.7239  | train_balanced_accuracy: 0.66614 | train_accuracy: 0.66661 | valid_auc: 0.71149 | valid_balanced_accuracy: 0.65091 | valid_accuracy: 0.6514  |  0:03:35s
epoch 13 | loss: 0.5978  | train_auc: 0.72769 | train_balanced_accuracy: 0.6605  | train_accuracy: 0.6615  | valid_auc: 0.71751 | valid_balanced_accuracy: 0.65082 | valid_accuracy: 0.65187 |  0:03:52s
epoch 14 | loss: 0.59502 | train_auc: 0.72786 | train_balanced_accuracy: 0.66641 | train_accuracy: 0.66709 | valid_auc: 0.71626 | valid_balanced_accuracy: 0.66065 | valid_accuracy: 0.66132 |  0:04:10s
epoch 15 | loss: 0.59186 | train_auc: 0.73224 | train_balanced_accuracy: 0.66634 | train_accuracy: 0.66626 | valid_auc: 0.72046 | valid_balanced_accuracy: 0.65637 | valid_accuracy: 0.65628 |  0:04:25s
epoch 16 | loss: 0.58667 | train_auc: 0.72988 | train_balanced_accuracy: 0.66369 | train_accuracy: 0.66378 | valid_auc: 0.72019 | valid_balanced_accuracy: 0.65887 | valid_accuracy: 0.65895 |  0:04:43s
epoch 17 | loss: 0.58882 | train_auc: 0.73116 | train_balanced_accuracy: 0.66691 | train_accuracy: 0.66717 | valid_auc: 0.71819 | valid_balanced_accuracy: 0.65543 | valid_accuracy: 0.65565 |  0:05:01s
epoch 18 | loss: 0.58861 | train_auc: 0.73208 | train_balanced_accuracy: 0.66691 | train_accuracy: 0.66772 | valid_auc: 0.71802 | valid_balanced_accuracy: 0.65356 | valid_accuracy: 0.65439 |  0:05:18s
epoch 19 | loss: 0.59101 | train_auc: 0.73635 | train_balanced_accuracy: 0.67263 | train_accuracy: 0.67311 | valid_auc: 0.72369 | valid_balanced_accuracy: 0.66123 | valid_accuracy: 0.66163 |  0:05:34s
epoch 20 | loss: 0.59071 | train_auc: 0.73974 | train_balanced_accuracy: 0.67887 | train_accuracy: 0.67944 | valid_auc: 0.72668 | valid_balanced_accuracy: 0.66613 | valid_accuracy: 0.66667 |  0:05:51s
epoch 21 | loss: 0.58697 | train_auc: 0.74513 | train_balanced_accuracy: 0.68082 | train_accuracy: 0.68137 | valid_auc: 0.7298  | valid_balanced_accuracy: 0.66519 | valid_accuracy: 0.66572 |  0:06:07s
epoch 22 | loss: 0.59035 | train_auc: 0.74367 | train_balanced_accuracy: 0.67975 | train_accuracy: 0.68003 | valid_auc: 0.72845 | valid_balanced_accuracy: 0.667   | valid_accuracy: 0.6673  |  0:06:26s
epoch 23 | loss: 0.58358 | train_auc: 0.75609 | train_balanced_accuracy: 0.68465 | train_accuracy: 0.68542 | valid_auc: 0.74089 | valid_balanced_accuracy: 0.67045 | valid_accuracy: 0.67123 |  0:06:41s
epoch 24 | loss: 0.58974 | train_auc: 0.75239 | train_balanced_accuracy: 0.68284 | train_accuracy: 0.68342 | valid_auc: 0.734   | valid_balanced_accuracy: 0.66424 | valid_accuracy: 0.66478 |  0:06:58s
epoch 25 | loss: 0.58095 | train_auc: 0.76579 | train_balanced_accuracy: 0.69839 | train_accuracy: 0.69852 | valid_auc: 0.74951 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68445 |  0:07:15s
epoch 26 | loss: 0.5836  | train_auc: 0.7593  | train_balanced_accuracy: 0.68841 | train_accuracy: 0.68892 | valid_auc: 0.74184 | valid_balanced_accuracy: 0.6783  | valid_accuracy: 0.67879 |  0:07:32s
epoch 27 | loss: 0.58195 | train_auc: 0.76601 | train_balanced_accuracy: 0.69627 | train_accuracy: 0.69644 | valid_auc: 0.74538 | valid_balanced_accuracy: 0.6786  | valid_accuracy: 0.67879 |  0:07:48s
epoch 28 | loss: 0.57962 | train_auc: 0.75961 | train_balanced_accuracy: 0.69314 | train_accuracy: 0.69333 | valid_auc: 0.73928 | valid_balanced_accuracy: 0.67183 | valid_accuracy: 0.67202 |  0:08:05s
epoch 29 | loss: 0.57559 | train_auc: 0.76692 | train_balanced_accuracy: 0.69445 | train_accuracy: 0.69447 | valid_auc: 0.74925 | valid_balanced_accuracy: 0.68116 | valid_accuracy: 0.68115 |  0:08:20s
epoch 30 | loss: 0.58072 | train_auc: 0.76274 | train_balanced_accuracy: 0.69063 | train_accuracy: 0.69093 | valid_auc: 0.74349 | valid_balanced_accuracy: 0.67412 | valid_accuracy: 0.67438 |  0:08:38s
epoch 31 | loss: 0.57676 | train_auc: 0.77014 | train_balanced_accuracy: 0.6994  | train_accuracy: 0.69943 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.68821 | valid_accuracy: 0.68823 |  0:08:53s
epoch 32 | loss: 0.57889 | train_auc: 0.76629 | train_balanced_accuracy: 0.6991  | train_accuracy: 0.69943 | valid_auc: 0.74695 | valid_balanced_accuracy: 0.67722 | valid_accuracy: 0.67753 |  0:09:10s
epoch 33 | loss: 0.5772  | train_auc: 0.76682 | train_balanced_accuracy: 0.69371 | train_accuracy: 0.69431 | valid_auc: 0.74619 | valid_balanced_accuracy: 0.67993 | valid_accuracy: 0.68052 |  0:09:26s
epoch 34 | loss: 0.57221 | train_auc: 0.77302 | train_balanced_accuracy: 0.70222 | train_accuracy: 0.70242 | valid_auc: 0.75104 | valid_balanced_accuracy: 0.68396 | valid_accuracy: 0.68414 |  0:09:41s
epoch 35 | loss: 0.57483 | train_auc: 0.77238 | train_balanced_accuracy: 0.69897 | train_accuracy: 0.69935 | valid_auc: 0.75167 | valid_balanced_accuracy: 0.68346 | valid_accuracy: 0.68382 |  0:09:59s
epoch 36 | loss: 0.57745 | train_auc: 0.77077 | train_balanced_accuracy: 0.70097 | train_accuracy: 0.70128 | valid_auc: 0.74575 | valid_balanced_accuracy: 0.6799  | valid_accuracy: 0.6802  |  0:10:15s
epoch 37 | loss: 0.57147 | train_auc: 0.77687 | train_balanced_accuracy: 0.703   | train_accuracy: 0.7034  | valid_auc: 0.75593 | valid_balanced_accuracy: 0.68453 | valid_accuracy: 0.68492 |  0:10:30s
epoch 38 | loss: 0.56952 | train_auc: 0.77092 | train_balanced_accuracy: 0.69951 | train_accuracy: 0.69963 | valid_auc: 0.74538 | valid_balanced_accuracy: 0.67952 | valid_accuracy: 0.67957 |  0:10:48s
epoch 39 | loss: 0.57565 | train_auc: 0.76971 | train_balanced_accuracy: 0.69713 | train_accuracy: 0.69742 | valid_auc: 0.7468  | valid_balanced_accuracy: 0.68181 | valid_accuracy: 0.68209 |  0:11:08s
epoch 40 | loss: 0.57531 | train_auc: 0.77393 | train_balanced_accuracy: 0.70148 | train_accuracy: 0.70171 | valid_auc: 0.75034 | valid_balanced_accuracy: 0.68817 | valid_accuracy: 0.68839 |  0:11:23s
epoch 41 | loss: 0.57478 | train_auc: 0.76945 | train_balanced_accuracy: 0.69531 | train_accuracy: 0.69506 | valid_auc: 0.74862 | valid_balanced_accuracy: 0.68141 | valid_accuracy: 0.68115 |  0:11:40s
epoch 42 | loss: 0.57169 | train_auc: 0.77539 | train_balanced_accuracy: 0.70094 | train_accuracy: 0.70136 | valid_auc: 0.75471 | valid_balanced_accuracy: 0.68609 | valid_accuracy: 0.6865  |  0:11:58s
epoch 43 | loss: 0.57492 | train_auc: 0.7802  | train_balanced_accuracy: 0.70534 | train_accuracy: 0.70545 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69442 | valid_accuracy: 0.69452 |  0:12:14s
epoch 44 | loss: 0.57173 | train_auc: 0.78092 | train_balanced_accuracy: 0.70545 | train_accuracy: 0.70557 | valid_auc: 0.7585  | valid_balanced_accuracy: 0.68813 | valid_accuracy: 0.68823 |  0:12:33s
epoch 45 | loss: 0.566   | train_auc: 0.78011 | train_balanced_accuracy: 0.70831 | train_accuracy: 0.70872 | valid_auc: 0.75853 | valid_balanced_accuracy: 0.69161 | valid_accuracy: 0.69201 |  0:12:52s
epoch 46 | loss: 0.56908 | train_auc: 0.77969 | train_balanced_accuracy: 0.70646 | train_accuracy: 0.70667 | valid_auc: 0.75328 | valid_balanced_accuracy: 0.68237 | valid_accuracy: 0.68256 |  0:13:09s
epoch 47 | loss: 0.56659 | train_auc: 0.78261 | train_balanced_accuracy: 0.70836 | train_accuracy: 0.70868 | valid_auc: 0.7548  | valid_balanced_accuracy: 0.68899 | valid_accuracy: 0.68933 |  0:13:25s
epoch 48 | loss: 0.56319 | train_auc: 0.78404 | train_balanced_accuracy: 0.70987 | train_accuracy: 0.70978 | valid_auc: 0.75712 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68823 |  0:13:42s
epoch 49 | loss: 0.5658  | train_auc: 0.78268 | train_balanced_accuracy: 0.70687 | train_accuracy: 0.7073  | valid_auc: 0.75804 | valid_balanced_accuracy: 0.68658 | valid_accuracy: 0.68697 |  0:13:56s
epoch 50 | loss: 0.56111 | train_auc: 0.78249 | train_balanced_accuracy: 0.70594 | train_accuracy: 0.70596 | valid_auc: 0.75486 | valid_balanced_accuracy: 0.67877 | valid_accuracy: 0.67879 |  0:14:12s
epoch 51 | loss: 0.55917 | train_auc: 0.7864  | train_balanced_accuracy: 0.7099  | train_accuracy: 0.70982 | valid_auc: 0.75995 | valid_balanced_accuracy: 0.68724 | valid_accuracy: 0.68713 |  0:14:29s
epoch 52 | loss: 0.56006 | train_auc: 0.78552 | train_balanced_accuracy: 0.70973 | train_accuracy: 0.70986 | valid_auc: 0.76002 | valid_balanced_accuracy: 0.68936 | valid_accuracy: 0.68949 |  0:14:47s
epoch 53 | loss: 0.56161 | train_auc: 0.7868  | train_balanced_accuracy: 0.71172 | train_accuracy: 0.71182 | valid_auc: 0.75847 | valid_balanced_accuracy: 0.69347 | valid_accuracy: 0.69358 |  0:15:03s
epoch 54 | loss: 0.56057 | train_auc: 0.78812 | train_balanced_accuracy: 0.71117 | train_accuracy: 0.71143 | valid_auc: 0.75954 | valid_balanced_accuracy: 0.68559 | valid_accuracy: 0.68587 |  0:15:20s
epoch 55 | loss: 0.56522 | train_auc: 0.78232 | train_balanced_accuracy: 0.70964 | train_accuracy: 0.70982 | valid_auc: 0.75654 | valid_balanced_accuracy: 0.69025 | valid_accuracy: 0.69043 |  0:15:37s
epoch 56 | loss: 0.5605  | train_auc: 0.78411 | train_balanced_accuracy: 0.70747 | train_accuracy: 0.70785 | valid_auc: 0.75939 | valid_balanced_accuracy: 0.69448 | valid_accuracy: 0.69484 |  0:15:57s
epoch 57 | loss: 0.56166 | train_auc: 0.78232 | train_balanced_accuracy: 0.70638 | train_accuracy: 0.70643 | valid_auc: 0.75369 | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68587 |  0:16:14s
epoch 58 | loss: 0.55822 | train_auc: 0.79155 | train_balanced_accuracy: 0.71391 | train_accuracy: 0.71418 | valid_auc: 0.76171 | valid_balanced_accuracy: 0.69191 | valid_accuracy: 0.69216 |  0:16:29s
epoch 59 | loss: 0.55847 | train_auc: 0.78838 | train_balanced_accuracy: 0.70893 | train_accuracy: 0.70907 | valid_auc: 0.75817 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.68996 |  0:16:48s
epoch 60 | loss: 0.55935 | train_auc: 0.79314 | train_balanced_accuracy: 0.71363 | train_accuracy: 0.71348 | valid_auc: 0.758   | valid_balanced_accuracy: 0.68131 | valid_accuracy: 0.68115 |  0:17:04s
epoch 61 | loss: 0.55507 | train_auc: 0.79405 | train_balanced_accuracy: 0.71458 | train_accuracy: 0.71477 | valid_auc: 0.75955 | valid_balanced_accuracy: 0.68159 | valid_accuracy: 0.68178 |  0:17:19s
epoch 62 | loss: 0.55361 | train_auc: 0.79179 | train_balanced_accuracy: 0.71437 | train_accuracy: 0.7145  | valid_auc: 0.76092 | valid_balanced_accuracy: 0.68858 | valid_accuracy: 0.6887  |  0:17:35s
epoch 63 | loss: 0.5584  | train_auc: 0.78653 | train_balanced_accuracy: 0.71187 | train_accuracy: 0.71171 | valid_auc: 0.75486 | valid_balanced_accuracy: 0.68211 | valid_accuracy: 0.68193 |  0:17:52s
epoch 64 | loss: 0.55961 | train_auc: 0.79348 | train_balanced_accuracy: 0.71363 | train_accuracy: 0.71352 | valid_auc: 0.7563  | valid_balanced_accuracy: 0.68253 | valid_accuracy: 0.6824  |  0:18:09s
epoch 65 | loss: 0.5516  | train_auc: 0.78843 | train_balanced_accuracy: 0.71312 | train_accuracy: 0.7134  | valid_auc: 0.75261 | valid_balanced_accuracy: 0.68324 | valid_accuracy: 0.68351 |  0:18:25s
epoch 66 | loss: 0.55216 | train_auc: 0.79462 | train_balanced_accuracy: 0.71611 | train_accuracy: 0.71611 | valid_auc: 0.75634 | valid_balanced_accuracy: 0.68415 | valid_accuracy: 0.68414 |  0:18:40s
epoch 67 | loss: 0.55408 | train_auc: 0.79471 | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70761 | valid_auc: 0.75566 | valid_balanced_accuracy: 0.67879 | valid_accuracy: 0.67941 |  0:18:56s
epoch 68 | loss: 0.55551 | train_auc: 0.79632 | train_balanced_accuracy: 0.71645 | train_accuracy: 0.71682 | valid_auc: 0.7647  | valid_balanced_accuracy: 0.69778 | valid_accuracy: 0.69814 |  0:19:13s
epoch 69 | loss: 0.55158 | train_auc: 0.79317 | train_balanced_accuracy: 0.71372 | train_accuracy: 0.71407 | valid_auc: 0.75279 | valid_balanced_accuracy: 0.67921 | valid_accuracy: 0.67957 |  0:19:30s
epoch 70 | loss: 0.54995 | train_auc: 0.79752 | train_balanced_accuracy: 0.71816 | train_accuracy: 0.71847 | valid_auc: 0.76337 | valid_balanced_accuracy: 0.69865 | valid_accuracy: 0.69893 |  0:19:48s
epoch 71 | loss: 0.5526  | train_auc: 0.79775 | train_balanced_accuracy: 0.72199 | train_accuracy: 0.72225 | valid_auc: 0.75801 | valid_balanced_accuracy: 0.68725 | valid_accuracy: 0.68744 |  0:20:06s
epoch 72 | loss: 0.55199 | train_auc: 0.79675 | train_balanced_accuracy: 0.71829 | train_accuracy: 0.71871 | valid_auc: 0.75805 | valid_balanced_accuracy: 0.69046 | valid_accuracy: 0.6909  |  0:20:22s
epoch 73 | loss: 0.54724 | train_auc: 0.80082 | train_balanced_accuracy: 0.7193  | train_accuracy: 0.7193  | valid_auc: 0.76315 | valid_balanced_accuracy: 0.68823 | valid_accuracy: 0.68823 |  0:20:40s
epoch 74 | loss: 0.54883 | train_auc: 0.79879 | train_balanced_accuracy: 0.7178  | train_accuracy: 0.71832 | valid_auc: 0.76209 | valid_balanced_accuracy: 0.69123 | valid_accuracy: 0.69169 |  0:20:57s
epoch 75 | loss: 0.55261 | train_auc: 0.80121 | train_balanced_accuracy: 0.72186 | train_accuracy: 0.72233 | valid_auc: 0.76274 | valid_balanced_accuracy: 0.69347 | valid_accuracy: 0.69389 |  0:21:13s
epoch 76 | loss: 0.55486 | train_auc: 0.80341 | train_balanced_accuracy: 0.7209  | train_accuracy: 0.72076 | valid_auc: 0.76218 | valid_balanced_accuracy: 0.68919 | valid_accuracy: 0.68901 |  0:21:29s
epoch 77 | loss: 0.54763 | train_auc: 0.80081 | train_balanced_accuracy: 0.71963 | train_accuracy: 0.71934 | valid_auc: 0.75732 | valid_balanced_accuracy: 0.68136 | valid_accuracy: 0.68099 |  0:21:47s
epoch 78 | loss: 0.5471  | train_auc: 0.79723 | train_balanced_accuracy: 0.71762 | train_accuracy: 0.71757 | valid_auc: 0.75909 | valid_balanced_accuracy: 0.68893 | valid_accuracy: 0.68886 |  0:22:02s
epoch 79 | loss: 0.54744 | train_auc: 0.79785 | train_balanced_accuracy: 0.71785 | train_accuracy: 0.71796 | valid_auc: 0.75972 | valid_balanced_accuracy: 0.68483 | valid_accuracy: 0.68492 |  0:22:19s
epoch 80 | loss: 0.55375 | train_auc: 0.79426 | train_balanced_accuracy: 0.70972 | train_accuracy: 0.7095  | valid_auc: 0.75639 | valid_balanced_accuracy: 0.68371 | valid_accuracy: 0.68351 |  0:22:35s
epoch 81 | loss: 0.54122 | train_auc: 0.80098 | train_balanced_accuracy: 0.72089 | train_accuracy: 0.72076 | valid_auc: 0.76223 | valid_balanced_accuracy: 0.68903 | valid_accuracy: 0.68886 |  0:22:49s
epoch 82 | loss: 0.546   | train_auc: 0.80551 | train_balanced_accuracy: 0.72444 | train_accuracy: 0.72469 | valid_auc: 0.7625  | valid_balanced_accuracy: 0.691   | valid_accuracy: 0.69122 |  0:23:04s
epoch 83 | loss: 0.54374 | train_auc: 0.79937 | train_balanced_accuracy: 0.72033 | train_accuracy: 0.72052 | valid_auc: 0.75832 | valid_balanced_accuracy: 0.68755 | valid_accuracy: 0.68776 |  0:23:19s
epoch 84 | loss: 0.54508 | train_auc: 0.80252 | train_balanced_accuracy: 0.72109 | train_accuracy: 0.72127 | valid_auc: 0.75872 | valid_balanced_accuracy: 0.68667 | valid_accuracy: 0.68681 |  0:23:38s
epoch 85 | loss: 0.54353 | train_auc: 0.80902 | train_balanced_accuracy: 0.72624 | train_accuracy: 0.72626 | valid_auc: 0.76782 | valid_balanced_accuracy: 0.69417 | valid_accuracy: 0.69421 |  0:23:53s
epoch 86 | loss: 0.54507 | train_auc: 0.80349 | train_balanced_accuracy: 0.7208  | train_accuracy: 0.7206  | valid_auc: 0.76124 | valid_balanced_accuracy: 0.68277 | valid_accuracy: 0.68256 |  0:24:09s
epoch 87 | loss: 0.54295 | train_auc: 0.80789 | train_balanced_accuracy: 0.72415 | train_accuracy: 0.72441 | valid_auc: 0.76135 | valid_balanced_accuracy: 0.6907  | valid_accuracy: 0.6909  |  0:24:27s
epoch 88 | loss: 0.54385 | train_auc: 0.80191 | train_balanced_accuracy: 0.71966 | train_accuracy: 0.71969 | valid_auc: 0.76347 | valid_balanced_accuracy: 0.69045 | valid_accuracy: 0.69043 |  0:24:43s
epoch 89 | loss: 0.54323 | train_auc: 0.79528 | train_balanced_accuracy: 0.71796 | train_accuracy: 0.7182  | valid_auc: 0.75532 | valid_balanced_accuracy: 0.68707 | valid_accuracy: 0.68728 |  0:24:59s
epoch 90 | loss: 0.5394  | train_auc: 0.79872 | train_balanced_accuracy: 0.72028 | train_accuracy: 0.72052 | valid_auc: 0.75727 | valid_balanced_accuracy: 0.69103 | valid_accuracy: 0.69122 |  0:25:17s

Early stopping occurred at epoch 90 with best_epoch = 70 and best_valid_accuracy = 0.69893
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 55/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.694 total time=25.4min
[CV 2/5; 55/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70019 | train_auc: 0.55732 | train_balanced_accuracy: 0.53352 | train_accuracy: 0.53433 | valid_auc: 0.56061 | valid_balanced_accuracy: 0.53994 | valid_accuracy: 0.54076 |  0:00:17s
epoch 1  | loss: 0.64397 | train_auc: 0.64541 | train_balanced_accuracy: 0.59932 | train_accuracy: 0.59874 | valid_auc: 0.64227 | valid_balanced_accuracy: 0.60006 | valid_accuracy: 0.59946 |  0:00:33s
epoch 2  | loss: 0.62352 | train_auc: 0.63912 | train_balanced_accuracy: 0.50155 | train_accuracy: 0.5051  | valid_auc: 0.64368 | valid_balanced_accuracy: 0.5008  | valid_accuracy: 0.50441 |  0:00:51s
epoch 3  | loss: 0.61951 | train_auc: 0.65845 | train_balanced_accuracy: 0.51847 | train_accuracy: 0.52174 | valid_auc: 0.65679 | valid_balanced_accuracy: 0.52045 | valid_accuracy: 0.52376 |  0:01:08s
epoch 4  | loss: 0.60661 | train_auc: 0.68765 | train_balanced_accuracy: 0.56045 | train_accuracy: 0.56321 | valid_auc: 0.68425 | valid_balanced_accuracy: 0.56299 | valid_accuracy: 0.56579 |  0:01:25s
epoch 5  | loss: 0.6073  | train_auc: 0.70128 | train_balanced_accuracy: 0.56744 | train_accuracy: 0.57014 | valid_auc: 0.69544 | valid_balanced_accuracy: 0.56939 | valid_accuracy: 0.57208 |  0:01:43s
epoch 6  | loss: 0.60454 | train_auc: 0.71172 | train_balanced_accuracy: 0.60743 | train_accuracy: 0.60948 | valid_auc: 0.71204 | valid_balanced_accuracy: 0.60808 | valid_accuracy: 0.61017 |  0:02:00s
epoch 7  | loss: 0.6015  | train_auc: 0.71385 | train_balanced_accuracy: 0.60542 | train_accuracy: 0.60763 | valid_auc: 0.70829 | valid_balanced_accuracy: 0.60875 | valid_accuracy: 0.61095 |  0:02:18s
epoch 8  | loss: 0.596   | train_auc: 0.71383 | train_balanced_accuracy: 0.62877 | train_accuracy: 0.63061 | valid_auc: 0.70886 | valid_balanced_accuracy: 0.63049 | valid_accuracy: 0.63236 |  0:02:34s
epoch 9  | loss: 0.6004  | train_auc: 0.71986 | train_balanced_accuracy: 0.65458 | train_accuracy: 0.65579 | valid_auc: 0.71519 | valid_balanced_accuracy: 0.65776 | valid_accuracy: 0.65895 |  0:02:50s
epoch 10 | loss: 0.59073 | train_auc: 0.72147 | train_balanced_accuracy: 0.6618  | train_accuracy: 0.66284 | valid_auc: 0.71628 | valid_balanced_accuracy: 0.66265 | valid_accuracy: 0.66368 |  0:03:05s
epoch 11 | loss: 0.59409 | train_auc: 0.72676 | train_balanced_accuracy: 0.66379 | train_accuracy: 0.6648  | valid_auc: 0.71962 | valid_balanced_accuracy: 0.66157 | valid_accuracy: 0.66257 |  0:03:23s
epoch 12 | loss: 0.59312 | train_auc: 0.7268  | train_balanced_accuracy: 0.66043 | train_accuracy: 0.66142 | valid_auc: 0.71898 | valid_balanced_accuracy: 0.66287 | valid_accuracy: 0.66383 |  0:03:40s
epoch 13 | loss: 0.58984 | train_auc: 0.72787 | train_balanced_accuracy: 0.66323 | train_accuracy: 0.66429 | valid_auc: 0.7224  | valid_balanced_accuracy: 0.66278 | valid_accuracy: 0.66383 |  0:03:56s
epoch 14 | loss: 0.59459 | train_auc: 0.73173 | train_balanced_accuracy: 0.66893 | train_accuracy: 0.66945 | valid_auc: 0.72707 | valid_balanced_accuracy: 0.66287 | valid_accuracy: 0.66336 |  0:04:12s
epoch 15 | loss: 0.59136 | train_auc: 0.73528 | train_balanced_accuracy: 0.66915 | train_accuracy: 0.66953 | valid_auc: 0.72704 | valid_balanced_accuracy: 0.6611  | valid_accuracy: 0.66147 |  0:04:29s
epoch 16 | loss: 0.58698 | train_auc: 0.74516 | train_balanced_accuracy: 0.6782  | train_accuracy: 0.67865 | valid_auc: 0.73401 | valid_balanced_accuracy: 0.67032 | valid_accuracy: 0.67076 |  0:04:46s
epoch 17 | loss: 0.58672 | train_auc: 0.73913 | train_balanced_accuracy: 0.67303 | train_accuracy: 0.67326 | valid_auc: 0.73181 | valid_balanced_accuracy: 0.66756 | valid_accuracy: 0.66777 |  0:05:03s
epoch 18 | loss: 0.586   | train_auc: 0.74307 | train_balanced_accuracy: 0.67932 | train_accuracy: 0.67976 | valid_auc: 0.73113 | valid_balanced_accuracy: 0.67188 | valid_accuracy: 0.67233 |  0:05:18s
epoch 19 | loss: 0.58328 | train_auc: 0.7488  | train_balanced_accuracy: 0.68214 | train_accuracy: 0.68243 | valid_auc: 0.73847 | valid_balanced_accuracy: 0.67785 | valid_accuracy: 0.67816 |  0:05:34s
epoch 20 | loss: 0.5844  | train_auc: 0.74983 | train_balanced_accuracy: 0.68357 | train_accuracy: 0.6842  | valid_auc: 0.73733 | valid_balanced_accuracy: 0.67829 | valid_accuracy: 0.67894 |  0:05:50s
epoch 21 | loss: 0.58367 | train_auc: 0.75366 | train_balanced_accuracy: 0.68856 | train_accuracy: 0.68912 | valid_auc: 0.74133 | valid_balanced_accuracy: 0.67947 | valid_accuracy: 0.68004 |  0:06:05s
epoch 22 | loss: 0.59152 | train_auc: 0.75689 | train_balanced_accuracy: 0.68693 | train_accuracy: 0.68774 | valid_auc: 0.74608 | valid_balanced_accuracy: 0.68109 | valid_accuracy: 0.68193 |  0:06:20s
epoch 23 | loss: 0.58647 | train_auc: 0.75383 | train_balanced_accuracy: 0.68554 | train_accuracy: 0.68621 | valid_auc: 0.74167 | valid_balanced_accuracy: 0.67327 | valid_accuracy: 0.67391 |  0:06:35s
epoch 24 | loss: 0.58898 | train_auc: 0.75742 | train_balanced_accuracy: 0.68813 | train_accuracy: 0.68873 | valid_auc: 0.74448 | valid_balanced_accuracy: 0.67772 | valid_accuracy: 0.67831 |  0:06:52s
epoch 25 | loss: 0.57982 | train_auc: 0.76147 | train_balanced_accuracy: 0.69258 | train_accuracy: 0.6925  | valid_auc: 0.75099 | valid_balanced_accuracy: 0.68675 | valid_accuracy: 0.68665 |  0:07:07s
epoch 26 | loss: 0.58252 | train_auc: 0.76352 | train_balanced_accuracy: 0.69584 | train_accuracy: 0.69632 | valid_auc: 0.7489  | valid_balanced_accuracy: 0.68525 | valid_accuracy: 0.68571 |  0:07:22s
epoch 27 | loss: 0.58234 | train_auc: 0.76442 | train_balanced_accuracy: 0.69425 | train_accuracy: 0.69447 | valid_auc: 0.74936 | valid_balanced_accuracy: 0.68551 | valid_accuracy: 0.68571 |  0:07:38s
epoch 28 | loss: 0.57931 | train_auc: 0.76389 | train_balanced_accuracy: 0.69618 | train_accuracy: 0.6964  | valid_auc: 0.74625 | valid_balanced_accuracy: 0.68186 | valid_accuracy: 0.68209 |  0:07:55s
epoch 29 | loss: 0.57995 | train_auc: 0.76608 | train_balanced_accuracy: 0.69654 | train_accuracy: 0.69664 | valid_auc: 0.75093 | valid_balanced_accuracy: 0.67934 | valid_accuracy: 0.67941 |  0:08:13s
epoch 30 | loss: 0.57827 | train_auc: 0.76557 | train_balanced_accuracy: 0.69858 | train_accuracy: 0.69876 | valid_auc: 0.74759 | valid_balanced_accuracy: 0.68475 | valid_accuracy: 0.68492 |  0:08:30s
epoch 31 | loss: 0.5811  | train_auc: 0.76537 | train_balanced_accuracy: 0.69958 | train_accuracy: 0.6999  | valid_auc: 0.74561 | valid_balanced_accuracy: 0.67817 | valid_accuracy: 0.67847 |  0:08:47s
epoch 32 | loss: 0.58595 | train_auc: 0.76239 | train_balanced_accuracy: 0.69416 | train_accuracy: 0.69408 | valid_auc: 0.74848 | valid_balanced_accuracy: 0.67998 | valid_accuracy: 0.67989 |  0:09:02s
epoch 33 | loss: 0.58431 | train_auc: 0.76605 | train_balanced_accuracy: 0.6972  | train_accuracy: 0.69789 | valid_auc: 0.74947 | valid_balanced_accuracy: 0.68343 | valid_accuracy: 0.68414 |  0:09:17s
epoch 34 | loss: 0.57884 | train_auc: 0.76541 | train_balanced_accuracy: 0.69669 | train_accuracy: 0.69723 | valid_auc: 0.75051 | valid_balanced_accuracy: 0.68594 | valid_accuracy: 0.6865  |  0:09:32s
epoch 35 | loss: 0.57885 | train_auc: 0.76843 | train_balanced_accuracy: 0.6993  | train_accuracy: 0.6999  | valid_auc: 0.74837 | valid_balanced_accuracy: 0.68447 | valid_accuracy: 0.68508 |  0:09:51s
epoch 36 | loss: 0.57712 | train_auc: 0.76974 | train_balanced_accuracy: 0.6973  | train_accuracy: 0.69754 | valid_auc: 0.75145 | valid_balanced_accuracy: 0.68518 | valid_accuracy: 0.6854  |  0:10:08s
epoch 37 | loss: 0.58    | train_auc: 0.76985 | train_balanced_accuracy: 0.69848 | train_accuracy: 0.69884 | valid_auc: 0.74878 | valid_balanced_accuracy: 0.68095 | valid_accuracy: 0.6813  |  0:10:25s
epoch 38 | loss: 0.5742  | train_auc: 0.7697  | train_balanced_accuracy: 0.70142 | train_accuracy: 0.70151 | valid_auc: 0.7541  | valid_balanced_accuracy: 0.68878 | valid_accuracy: 0.68886 |  0:10:42s
epoch 39 | loss: 0.57547 | train_auc: 0.77164 | train_balanced_accuracy: 0.70321 | train_accuracy: 0.70352 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.68779 | valid_accuracy: 0.68807 |  0:10:59s
epoch 40 | loss: 0.57768 | train_auc: 0.77362 | train_balanced_accuracy: 0.70527 | train_accuracy: 0.70569 | valid_auc: 0.7509  | valid_balanced_accuracy: 0.69191 | valid_accuracy: 0.69232 |  0:11:19s
epoch 41 | loss: 0.57409 | train_auc: 0.77071 | train_balanced_accuracy: 0.69927 | train_accuracy: 0.69931 | valid_auc: 0.75311 | valid_balanced_accuracy: 0.68643 | valid_accuracy: 0.6865  |  0:11:35s
epoch 42 | loss: 0.57029 | train_auc: 0.7725  | train_balanced_accuracy: 0.70294 | train_accuracy: 0.70352 | valid_auc: 0.75501 | valid_balanced_accuracy: 0.69286 | valid_accuracy: 0.69342 |  0:11:53s
epoch 43 | loss: 0.57649 | train_auc: 0.77649 | train_balanced_accuracy: 0.70518 | train_accuracy: 0.70529 | valid_auc: 0.75518 | valid_balanced_accuracy: 0.68624 | valid_accuracy: 0.68634 |  0:12:10s
epoch 44 | loss: 0.57062 | train_auc: 0.77555 | train_balanced_accuracy: 0.70895 | train_accuracy: 0.70931 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.69419 | valid_accuracy: 0.69452 |  0:12:27s
epoch 45 | loss: 0.57014 | train_auc: 0.7718  | train_balanced_accuracy: 0.7005  | train_accuracy: 0.70112 | valid_auc: 0.74563 | valid_balanced_accuracy: 0.68481 | valid_accuracy: 0.6854  |  0:12:44s
epoch 46 | loss: 0.57275 | train_auc: 0.77176 | train_balanced_accuracy: 0.70335 | train_accuracy: 0.70356 | valid_auc: 0.74848 | valid_balanced_accuracy: 0.68883 | valid_accuracy: 0.68901 |  0:13:00s
epoch 47 | loss: 0.57172 | train_auc: 0.77384 | train_balanced_accuracy: 0.70399 | train_accuracy: 0.70451 | valid_auc: 0.7524  | valid_balanced_accuracy: 0.69071 | valid_accuracy: 0.69122 |  0:13:16s
epoch 48 | loss: 0.56871 | train_auc: 0.7765  | train_balanced_accuracy: 0.70763 | train_accuracy: 0.70773 | valid_auc: 0.7508  | valid_balanced_accuracy: 0.68945 | valid_accuracy: 0.68949 |  0:13:33s
epoch 49 | loss: 0.56943 | train_auc: 0.77708 | train_balanced_accuracy: 0.70693 | train_accuracy: 0.70738 | valid_auc: 0.75293 | valid_balanced_accuracy: 0.68884 | valid_accuracy: 0.68933 |  0:13:50s
epoch 50 | loss: 0.56988 | train_auc: 0.77887 | train_balanced_accuracy: 0.70789 | train_accuracy: 0.7082  | valid_auc: 0.75808 | valid_balanced_accuracy: 0.69436 | valid_accuracy: 0.69468 |  0:14:04s
epoch 51 | loss: 0.56824 | train_auc: 0.77801 | train_balanced_accuracy: 0.70836 | train_accuracy: 0.70864 | valid_auc: 0.7594  | valid_balanced_accuracy: 0.69787 | valid_accuracy: 0.69814 |  0:14:21s
epoch 52 | loss: 0.56696 | train_auc: 0.78101 | train_balanced_accuracy: 0.71105 | train_accuracy: 0.71115 | valid_auc: 0.75698 | valid_balanced_accuracy: 0.69175 | valid_accuracy: 0.69185 |  0:14:38s
epoch 53 | loss: 0.5643  | train_auc: 0.77915 | train_balanced_accuracy: 0.70662 | train_accuracy: 0.70694 | valid_auc: 0.75418 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69547 |  0:14:54s
epoch 54 | loss: 0.56965 | train_auc: 0.77871 | train_balanced_accuracy: 0.70784 | train_accuracy: 0.70797 | valid_auc: 0.75615 | valid_balanced_accuracy: 0.69032 | valid_accuracy: 0.69043 |  0:15:13s
epoch 55 | loss: 0.57229 | train_auc: 0.78074 | train_balanced_accuracy: 0.70871 | train_accuracy: 0.70915 | valid_auc: 0.75485 | valid_balanced_accuracy: 0.69066 | valid_accuracy: 0.69106 |  0:15:29s
epoch 56 | loss: 0.5686  | train_auc: 0.77622 | train_balanced_accuracy: 0.70605 | train_accuracy: 0.70628 | valid_auc: 0.75078 | valid_balanced_accuracy: 0.69008 | valid_accuracy: 0.69027 |  0:15:44s
epoch 57 | loss: 0.5685  | train_auc: 0.77995 | train_balanced_accuracy: 0.70534 | train_accuracy: 0.70545 | valid_auc: 0.75397 | valid_balanced_accuracy: 0.68849 | valid_accuracy: 0.68854 |  0:16:01s
epoch 58 | loss: 0.56326 | train_auc: 0.7826  | train_balanced_accuracy: 0.71237 | train_accuracy: 0.71261 | valid_auc: 0.75581 | valid_balanced_accuracy: 0.69509 | valid_accuracy: 0.69531 |  0:16:18s
epoch 59 | loss: 0.56346 | train_auc: 0.78086 | train_balanced_accuracy: 0.71006 | train_accuracy: 0.71049 | valid_auc: 0.75536 | valid_balanced_accuracy: 0.69157 | valid_accuracy: 0.69201 |  0:16:35s
epoch 60 | loss: 0.56607 | train_auc: 0.77908 | train_balanced_accuracy: 0.70898 | train_accuracy: 0.70923 | valid_auc: 0.75424 | valid_balanced_accuracy: 0.69241 | valid_accuracy: 0.69263 |  0:16:49s
epoch 61 | loss: 0.56572 | train_auc: 0.78188 | train_balanced_accuracy: 0.7107  | train_accuracy: 0.711   | valid_auc: 0.76    | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69279 |  0:17:05s
epoch 62 | loss: 0.5644  | train_auc: 0.78126 | train_balanced_accuracy: 0.70892 | train_accuracy: 0.70907 | valid_auc: 0.7525  | valid_balanced_accuracy: 0.68812 | valid_accuracy: 0.68823 |  0:17:23s
epoch 63 | loss: 0.56734 | train_auc: 0.77878 | train_balanced_accuracy: 0.70823 | train_accuracy: 0.7084  | valid_auc: 0.75252 | valid_balanced_accuracy: 0.69044 | valid_accuracy: 0.69059 |  0:17:39s
epoch 64 | loss: 0.56514 | train_auc: 0.78302 | train_balanced_accuracy: 0.70887 | train_accuracy: 0.70891 | valid_auc: 0.75183 | valid_balanced_accuracy: 0.68836 | valid_accuracy: 0.68839 |  0:17:54s
epoch 65 | loss: 0.55873 | train_auc: 0.78562 | train_balanced_accuracy: 0.71538 | train_accuracy: 0.71568 | valid_auc: 0.75697 | valid_balanced_accuracy: 0.6958  | valid_accuracy: 0.6961  |  0:18:10s
epoch 66 | loss: 0.56147 | train_auc: 0.78524 | train_balanced_accuracy: 0.71426 | train_accuracy: 0.71438 | valid_auc: 0.75701 | valid_balanced_accuracy: 0.69426 | valid_accuracy: 0.69437 |  0:18:26s
epoch 67 | loss: 0.55798 | train_auc: 0.78142 | train_balanced_accuracy: 0.70827 | train_accuracy: 0.70887 | valid_auc: 0.75519 | valid_balanced_accuracy: 0.68856 | valid_accuracy: 0.68917 |  0:18:41s
epoch 68 | loss: 0.56427 | train_auc: 0.78635 | train_balanced_accuracy: 0.71472 | train_accuracy: 0.71505 | valid_auc: 0.75451 | valid_balanced_accuracy: 0.69597 | valid_accuracy: 0.69625 |  0:18:57s
epoch 69 | loss: 0.56133 | train_auc: 0.78668 | train_balanced_accuracy: 0.71795 | train_accuracy: 0.7182  | valid_auc: 0.75957 | valid_balanced_accuracy: 0.69412 | valid_accuracy: 0.69437 |  0:19:15s
epoch 70 | loss: 0.56145 | train_auc: 0.78477 | train_balanced_accuracy: 0.71269 | train_accuracy: 0.71304 | valid_auc: 0.75538 | valid_balanced_accuracy: 0.6953  | valid_accuracy: 0.69562 |  0:19:33s
epoch 71 | loss: 0.56237 | train_auc: 0.78652 | train_balanced_accuracy: 0.71594 | train_accuracy: 0.71607 | valid_auc: 0.75756 | valid_balanced_accuracy: 0.69647 | valid_accuracy: 0.69657 |  0:19:47s

Early stopping occurred at epoch 71 with best_epoch = 51 and best_valid_accuracy = 0.69814
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 55/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=19.9min
[CV 3/5; 55/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7069  | train_auc: 0.5795  | train_balanced_accuracy: 0.52846 | train_accuracy: 0.52585 | valid_auc: 0.59043 | valid_balanced_accuracy: 0.53115 | valid_accuracy: 0.52849 |  0:00:18s
epoch 1  | loss: 0.6612  | train_auc: 0.64137 | train_balanced_accuracy: 0.51077 | train_accuracy: 0.5142  | valid_auc: 0.64728 | valid_balanced_accuracy: 0.51056 | valid_accuracy: 0.51401 |  0:00:34s
epoch 2  | loss: 0.64547 | train_auc: 0.65533 | train_balanced_accuracy: 0.6109  | train_accuracy: 0.61209 | valid_auc: 0.66133 | valid_balanced_accuracy: 0.61968 | valid_accuracy: 0.62087 |  0:00:52s
epoch 3  | loss: 0.63474 | train_auc: 0.6826  | train_balanced_accuracy: 0.62684 | train_accuracy: 0.62819 | valid_auc: 0.68246 | valid_balanced_accuracy: 0.62788 | valid_accuracy: 0.62921 |  0:01:06s
epoch 4  | loss: 0.62549 | train_auc: 0.70409 | train_balanced_accuracy: 0.64702 | train_accuracy: 0.64821 | valid_auc: 0.70561 | valid_balanced_accuracy: 0.64865 | valid_accuracy: 0.64983 |  0:01:22s
epoch 5  | loss: 0.62079 | train_auc: 0.70232 | train_balanced_accuracy: 0.65484 | train_accuracy: 0.65593 | valid_auc: 0.70084 | valid_balanced_accuracy: 0.65916 | valid_accuracy: 0.66021 |  0:01:38s
epoch 6  | loss: 0.61804 | train_auc: 0.71267 | train_balanced_accuracy: 0.65637 | train_accuracy: 0.65746 | valid_auc: 0.70884 | valid_balanced_accuracy: 0.65569 | valid_accuracy: 0.65675 |  0:01:56s
epoch 7  | loss: 0.61781 | train_auc: 0.70783 | train_balanced_accuracy: 0.65501 | train_accuracy: 0.65604 | valid_auc: 0.70416 | valid_balanced_accuracy: 0.65513 | valid_accuracy: 0.65612 |  0:02:12s
epoch 8  | loss: 0.61364 | train_auc: 0.71801 | train_balanced_accuracy: 0.6564  | train_accuracy: 0.65774 | valid_auc: 0.7136  | valid_balanced_accuracy: 0.65386 | valid_accuracy: 0.65518 |  0:02:29s
epoch 9  | loss: 0.61242 | train_auc: 0.71909 | train_balanced_accuracy: 0.66213 | train_accuracy: 0.66265 | valid_auc: 0.71004 | valid_balanced_accuracy: 0.66172 | valid_accuracy: 0.66226 |  0:02:44s
epoch 10 | loss: 0.60392 | train_auc: 0.71838 | train_balanced_accuracy: 0.66459 | train_accuracy: 0.66525 | valid_auc: 0.71301 | valid_balanced_accuracy: 0.66504 | valid_accuracy: 0.66572 |  0:03:01s
epoch 11 | loss: 0.60758 | train_auc: 0.72166 | train_balanced_accuracy: 0.66386 | train_accuracy: 0.6647  | valid_auc: 0.71481 | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66242 |  0:03:18s
epoch 12 | loss: 0.60537 | train_auc: 0.72369 | train_balanced_accuracy: 0.6652  | train_accuracy: 0.66592 | valid_auc: 0.71593 | valid_balanced_accuracy: 0.66517 | valid_accuracy: 0.66588 |  0:03:34s
epoch 13 | loss: 0.60684 | train_auc: 0.72377 | train_balanced_accuracy: 0.6662  | train_accuracy: 0.66686 | valid_auc: 0.71771 | valid_balanced_accuracy: 0.66489 | valid_accuracy: 0.66556 |  0:03:50s
epoch 14 | loss: 0.60429 | train_auc: 0.72428 | train_balanced_accuracy: 0.66842 | train_accuracy: 0.66907 | valid_auc: 0.7208  | valid_balanced_accuracy: 0.66633 | valid_accuracy: 0.66698 |  0:04:06s
epoch 15 | loss: 0.60469 | train_auc: 0.72552 | train_balanced_accuracy: 0.66762 | train_accuracy: 0.66812 | valid_auc: 0.72389 | valid_balanced_accuracy: 0.66852 | valid_accuracy: 0.66903 |  0:04:24s
epoch 16 | loss: 0.60188 | train_auc: 0.72822 | train_balanced_accuracy: 0.66642 | train_accuracy: 0.66702 | valid_auc: 0.72189 | valid_balanced_accuracy: 0.66624 | valid_accuracy: 0.66682 |  0:04:41s
epoch 17 | loss: 0.59625 | train_auc: 0.72812 | train_balanced_accuracy: 0.66423 | train_accuracy: 0.66462 | valid_auc: 0.72256 | valid_balanced_accuracy: 0.66075 | valid_accuracy: 0.66116 |  0:04:59s
epoch 18 | loss: 0.60782 | train_auc: 0.72603 | train_balanced_accuracy: 0.66622 | train_accuracy: 0.66702 | valid_auc: 0.71607 | valid_balanced_accuracy: 0.65891 | valid_accuracy: 0.65974 |  0:05:15s
epoch 19 | loss: 0.6016  | train_auc: 0.73165 | train_balanced_accuracy: 0.66822 | train_accuracy: 0.66891 | valid_auc: 0.72569 | valid_balanced_accuracy: 0.66834 | valid_accuracy: 0.66903 |  0:05:31s
epoch 20 | loss: 0.5996  | train_auc: 0.73551 | train_balanced_accuracy: 0.67019 | train_accuracy: 0.67088 | valid_auc: 0.72433 | valid_balanced_accuracy: 0.66048 | valid_accuracy: 0.66116 |  0:05:48s
epoch 21 | loss: 0.59074 | train_auc: 0.73917 | train_balanced_accuracy: 0.67216 | train_accuracy: 0.67277 | valid_auc: 0.72913 | valid_balanced_accuracy: 0.66858 | valid_accuracy: 0.66918 |  0:06:04s
epoch 22 | loss: 0.59991 | train_auc: 0.73693 | train_balanced_accuracy: 0.6731  | train_accuracy: 0.67355 | valid_auc: 0.72871 | valid_balanced_accuracy: 0.66324 | valid_accuracy: 0.66368 |  0:06:19s
epoch 23 | loss: 0.59541 | train_auc: 0.74333 | train_balanced_accuracy: 0.68225 | train_accuracy: 0.68272 | valid_auc: 0.73734 | valid_balanced_accuracy: 0.67994 | valid_accuracy: 0.68036 |  0:06:36s
epoch 24 | loss: 0.5953  | train_auc: 0.74177 | train_balanced_accuracy: 0.67951 | train_accuracy: 0.68    | valid_auc: 0.73299 | valid_balanced_accuracy: 0.6693  | valid_accuracy: 0.66981 |  0:06:53s
epoch 25 | loss: 0.59386 | train_auc: 0.748   | train_balanced_accuracy: 0.68445 | train_accuracy: 0.68492 | valid_auc: 0.74059 | valid_balanced_accuracy: 0.68035 | valid_accuracy: 0.68083 |  0:07:09s
epoch 26 | loss: 0.59163 | train_auc: 0.75276 | train_balanced_accuracy: 0.68646 | train_accuracy: 0.68713 | valid_auc: 0.74554 | valid_balanced_accuracy: 0.68223 | valid_accuracy: 0.68288 |  0:07:26s
epoch 27 | loss: 0.59224 | train_auc: 0.75326 | train_balanced_accuracy: 0.6868  | train_accuracy: 0.68697 | valid_auc: 0.74491 | valid_balanced_accuracy: 0.68207 | valid_accuracy: 0.68225 |  0:07:42s
epoch 28 | loss: 0.5896  | train_auc: 0.75254 | train_balanced_accuracy: 0.68966 | train_accuracy: 0.69    | valid_auc: 0.74144 | valid_balanced_accuracy: 0.67922 | valid_accuracy: 0.67957 |  0:08:00s
epoch 29 | loss: 0.58846 | train_auc: 0.75494 | train_balanced_accuracy: 0.68766 | train_accuracy: 0.68783 | valid_auc: 0.74433 | valid_balanced_accuracy: 0.68649 | valid_accuracy: 0.68665 |  0:08:17s
epoch 30 | loss: 0.58788 | train_auc: 0.75796 | train_balanced_accuracy: 0.68927 | train_accuracy: 0.68972 | valid_auc: 0.74513 | valid_balanced_accuracy: 0.68136 | valid_accuracy: 0.68178 |  0:08:34s
epoch 31 | loss: 0.5916  | train_auc: 0.75536 | train_balanced_accuracy: 0.68944 | train_accuracy: 0.68984 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.67964 | valid_accuracy: 0.68004 |  0:08:50s
epoch 32 | loss: 0.58357 | train_auc: 0.75259 | train_balanced_accuracy: 0.68798 | train_accuracy: 0.68831 | valid_auc: 0.74734 | valid_balanced_accuracy: 0.68126 | valid_accuracy: 0.68162 |  0:09:08s
epoch 33 | loss: 0.58831 | train_auc: 0.75452 | train_balanced_accuracy: 0.68909 | train_accuracy: 0.68945 | valid_auc: 0.74864 | valid_balanced_accuracy: 0.68709 | valid_accuracy: 0.68744 |  0:09:25s
epoch 34 | loss: 0.58608 | train_auc: 0.75641 | train_balanced_accuracy: 0.68547 | train_accuracy: 0.68602 | valid_auc: 0.74743 | valid_balanced_accuracy: 0.68439 | valid_accuracy: 0.68492 |  0:09:41s
epoch 35 | loss: 0.58595 | train_auc: 0.75413 | train_balanced_accuracy: 0.68576 | train_accuracy: 0.68614 | valid_auc: 0.74545 | valid_balanced_accuracy: 0.68281 | valid_accuracy: 0.68319 |  0:09:58s
epoch 36 | loss: 0.58966 | train_auc: 0.75611 | train_balanced_accuracy: 0.68829 | train_accuracy: 0.68882 | valid_auc: 0.74708 | valid_balanced_accuracy: 0.68249 | valid_accuracy: 0.68303 |  0:10:13s
epoch 37 | loss: 0.58418 | train_auc: 0.75791 | train_balanced_accuracy: 0.68817 | train_accuracy: 0.68878 | valid_auc: 0.74857 | valid_balanced_accuracy: 0.68303 | valid_accuracy: 0.68366 |  0:10:31s
epoch 38 | loss: 0.58334 | train_auc: 0.75832 | train_balanced_accuracy: 0.68574 | train_accuracy: 0.68583 | valid_auc: 0.74745 | valid_balanced_accuracy: 0.67646 | valid_accuracy: 0.67658 |  0:10:48s
epoch 39 | loss: 0.57972 | train_auc: 0.72246 | train_balanced_accuracy: 0.67012 | train_accuracy: 0.67021 | valid_auc: 0.72141 | valid_balanced_accuracy: 0.66752 | valid_accuracy: 0.66761 |  0:11:05s
epoch 40 | loss: 0.58399 | train_auc: 0.72109 | train_balanced_accuracy: 0.66755 | train_accuracy: 0.66765 | valid_auc: 0.72233 | valid_balanced_accuracy: 0.66733 | valid_accuracy: 0.66745 |  0:11:22s
epoch 41 | loss: 0.58325 | train_auc: 0.73926 | train_balanced_accuracy: 0.67911 | train_accuracy: 0.67938 | valid_auc: 0.73762 | valid_balanced_accuracy: 0.6771  | valid_accuracy: 0.67737 |  0:11:39s
epoch 42 | loss: 0.57848 | train_auc: 0.74204 | train_balanced_accuracy: 0.68336 | train_accuracy: 0.68374 | valid_auc: 0.73783 | valid_balanced_accuracy: 0.68298 | valid_accuracy: 0.68335 |  0:11:57s
epoch 43 | loss: 0.58579 | train_auc: 0.75858 | train_balanced_accuracy: 0.69082 | train_accuracy: 0.69098 | valid_auc: 0.7536  | valid_balanced_accuracy: 0.69172 | valid_accuracy: 0.69185 |  0:12:14s
epoch 44 | loss: 0.5854  | train_auc: 0.76288 | train_balanced_accuracy: 0.69126 | train_accuracy: 0.69134 | valid_auc: 0.75384 | valid_balanced_accuracy: 0.6869  | valid_accuracy: 0.68697 |  0:12:31s
epoch 45 | loss: 0.58241 | train_auc: 0.76606 | train_balanced_accuracy: 0.69493 | train_accuracy: 0.69515 | valid_auc: 0.75237 | valid_balanced_accuracy: 0.68347 | valid_accuracy: 0.68366 |  0:12:46s
epoch 46 | loss: 0.5831  | train_auc: 0.76712 | train_balanced_accuracy: 0.69263 | train_accuracy: 0.69287 | valid_auc: 0.75257 | valid_balanced_accuracy: 0.68518 | valid_accuracy: 0.6854  |  0:13:01s
epoch 47 | loss: 0.58127 | train_auc: 0.75821 | train_balanced_accuracy: 0.68901 | train_accuracy: 0.68949 | valid_auc: 0.74602 | valid_balanced_accuracy: 0.6802  | valid_accuracy: 0.68067 |  0:13:18s
epoch 48 | loss: 0.58456 | train_auc: 0.76095 | train_balanced_accuracy: 0.68874 | train_accuracy: 0.6889  | valid_auc: 0.74435 | valid_balanced_accuracy: 0.67766 | valid_accuracy: 0.67784 |  0:13:36s
epoch 49 | loss: 0.58219 | train_auc: 0.7589  | train_balanced_accuracy: 0.68639 | train_accuracy: 0.68689 | valid_auc: 0.74108 | valid_balanced_accuracy: 0.67878 | valid_accuracy: 0.67926 |  0:13:52s
epoch 50 | loss: 0.58451 | train_auc: 0.76432 | train_balanced_accuracy: 0.69236 | train_accuracy: 0.69256 | valid_auc: 0.74817 | valid_balanced_accuracy: 0.68428 | valid_accuracy: 0.68445 |  0:14:09s
epoch 51 | loss: 0.57794 | train_auc: 0.76136 | train_balanced_accuracy: 0.69125 | train_accuracy: 0.69145 | valid_auc: 0.74369 | valid_balanced_accuracy: 0.68125 | valid_accuracy: 0.68146 |  0:14:26s
epoch 52 | loss: 0.57385 | train_auc: 0.768   | train_balanced_accuracy: 0.69457 | train_accuracy: 0.69472 | valid_auc: 0.74754 | valid_balanced_accuracy: 0.68084 | valid_accuracy: 0.68099 |  0:14:40s
epoch 53 | loss: 0.57706 | train_auc: 0.76542 | train_balanced_accuracy: 0.69372 | train_accuracy: 0.69366 | valid_auc: 0.74956 | valid_balanced_accuracy: 0.68921 | valid_accuracy: 0.68917 |  0:14:58s
epoch 54 | loss: 0.5772  | train_auc: 0.76963 | train_balanced_accuracy: 0.69536 | train_accuracy: 0.69559 | valid_auc: 0.75393 | valid_balanced_accuracy: 0.68454 | valid_accuracy: 0.68477 |  0:15:16s
epoch 55 | loss: 0.57713 | train_auc: 0.76884 | train_balanced_accuracy: 0.69454 | train_accuracy: 0.69429 | valid_auc: 0.74765 | valid_balanced_accuracy: 0.68213 | valid_accuracy: 0.68193 |  0:15:33s
epoch 56 | loss: 0.57403 | train_auc: 0.76574 | train_balanced_accuracy: 0.69121 | train_accuracy: 0.69126 | valid_auc: 0.74666 | valid_balanced_accuracy: 0.68282 | valid_accuracy: 0.68288 |  0:15:50s
epoch 57 | loss: 0.58363 | train_auc: 0.77015 | train_balanced_accuracy: 0.69633 | train_accuracy: 0.69625 | valid_auc: 0.754   | valid_balanced_accuracy: 0.68008 | valid_accuracy: 0.68004 |  0:16:08s
epoch 58 | loss: 0.5802  | train_auc: 0.77019 | train_balanced_accuracy: 0.69585 | train_accuracy: 0.69625 | valid_auc: 0.75074 | valid_balanced_accuracy: 0.6804  | valid_accuracy: 0.68083 |  0:16:24s
epoch 59 | loss: 0.57057 | train_auc: 0.77123 | train_balanced_accuracy: 0.6978  | train_accuracy: 0.69799 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.67969 | valid_accuracy: 0.67989 |  0:16:39s
epoch 60 | loss: 0.57363 | train_auc: 0.77304 | train_balanced_accuracy: 0.69639 | train_accuracy: 0.69649 | valid_auc: 0.75285 | valid_balanced_accuracy: 0.67823 | valid_accuracy: 0.67831 |  0:16:56s
epoch 61 | loss: 0.57562 | train_auc: 0.77332 | train_balanced_accuracy: 0.69597 | train_accuracy: 0.69653 | valid_auc: 0.75385 | valid_balanced_accuracy: 0.68707 | valid_accuracy: 0.6876  |  0:17:13s
epoch 62 | loss: 0.572   | train_auc: 0.76745 | train_balanced_accuracy: 0.69082 | train_accuracy: 0.69126 | valid_auc: 0.75185 | valid_balanced_accuracy: 0.68447 | valid_accuracy: 0.68492 |  0:17:28s
epoch 63 | loss: 0.57309 | train_auc: 0.77548 | train_balanced_accuracy: 0.69872 | train_accuracy: 0.69928 | valid_auc: 0.75358 | valid_balanced_accuracy: 0.68377 | valid_accuracy: 0.68429 |  0:17:45s

Early stopping occurred at epoch 63 with best_epoch = 43 and best_valid_accuracy = 0.69185
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 55/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=17.9min
[CV 4/5; 55/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6899  | train_auc: 0.64153 | train_balanced_accuracy: 0.57435 | train_accuracy: 0.5724  | valid_auc: 0.63058 | valid_balanced_accuracy: 0.56287 | valid_accuracy: 0.56091 |  0:00:15s
epoch 1  | loss: 0.64866 | train_auc: 0.65886 | train_balanced_accuracy: 0.60577 | train_accuracy: 0.60434 | valid_auc: 0.65246 | valid_balanced_accuracy: 0.60087 | valid_accuracy: 0.59946 |  0:00:32s
epoch 2  | loss: 0.63531 | train_auc: 0.66007 | train_balanced_accuracy: 0.60501 | train_accuracy: 0.60399 | valid_auc: 0.65501 | valid_balanced_accuracy: 0.59637 | valid_accuracy: 0.59537 |  0:00:49s
epoch 3  | loss: 0.63559 | train_auc: 0.67306 | train_balanced_accuracy: 0.60088 | train_accuracy: 0.59915 | valid_auc: 0.66874 | valid_balanced_accuracy: 0.59365 | valid_accuracy: 0.59191 |  0:01:05s
epoch 4  | loss: 0.62564 | train_auc: 0.68692 | train_balanced_accuracy: 0.63016 | train_accuracy: 0.62956 | valid_auc: 0.68348 | valid_balanced_accuracy: 0.62477 | valid_accuracy: 0.62417 |  0:01:24s
epoch 5  | loss: 0.62472 | train_auc: 0.68755 | train_balanced_accuracy: 0.62821 | train_accuracy: 0.6274  | valid_auc: 0.68566 | valid_balanced_accuracy: 0.62028 | valid_accuracy: 0.61945 |  0:01:40s
epoch 6  | loss: 0.61868 | train_auc: 0.69841 | train_balanced_accuracy: 0.62719 | train_accuracy: 0.62598 | valid_auc: 0.69414 | valid_balanced_accuracy: 0.61924 | valid_accuracy: 0.61804 |  0:01:58s
epoch 7  | loss: 0.61683 | train_auc: 0.70633 | train_balanced_accuracy: 0.64286 | train_accuracy: 0.64192 | valid_auc: 0.70256 | valid_balanced_accuracy: 0.6344  | valid_accuracy: 0.63346 |  0:02:15s
epoch 8  | loss: 0.61919 | train_auc: 0.70611 | train_balanced_accuracy: 0.64492 | train_accuracy: 0.64483 | valid_auc: 0.70248 | valid_balanced_accuracy: 0.6425  | valid_accuracy: 0.64243 |  0:02:32s
epoch 9  | loss: 0.61257 | train_auc: 0.70076 | train_balanced_accuracy: 0.63863 | train_accuracy: 0.63861 | valid_auc: 0.69719 | valid_balanced_accuracy: 0.63444 | valid_accuracy: 0.6344  |  0:02:49s
epoch 10 | loss: 0.61007 | train_auc: 0.70983 | train_balanced_accuracy: 0.65708 | train_accuracy: 0.65679 | valid_auc: 0.70506 | valid_balanced_accuracy: 0.65136 | valid_accuracy: 0.65109 |  0:03:05s
epoch 11 | loss: 0.60816 | train_auc: 0.7232  | train_balanced_accuracy: 0.66423 | train_accuracy: 0.66423 | valid_auc: 0.71758 | valid_balanced_accuracy: 0.66346 | valid_accuracy: 0.66352 |  0:03:21s
epoch 12 | loss: 0.60208 | train_auc: 0.73136 | train_balanced_accuracy: 0.67198 | train_accuracy: 0.67194 | valid_auc: 0.72404 | valid_balanced_accuracy: 0.67008 | valid_accuracy: 0.67013 |  0:03:38s
epoch 13 | loss: 0.60219 | train_auc: 0.72965 | train_balanced_accuracy: 0.66762 | train_accuracy: 0.66785 | valid_auc: 0.72208 | valid_balanced_accuracy: 0.6609  | valid_accuracy: 0.66116 |  0:03:56s
epoch 14 | loss: 0.60263 | train_auc: 0.73219 | train_balanced_accuracy: 0.6668  | train_accuracy: 0.66667 | valid_auc: 0.72216 | valid_balanced_accuracy: 0.6614  | valid_accuracy: 0.66132 |  0:04:13s
epoch 15 | loss: 0.60241 | train_auc: 0.73446 | train_balanced_accuracy: 0.66766 | train_accuracy: 0.66737 | valid_auc: 0.72671 | valid_balanced_accuracy: 0.66156 | valid_accuracy: 0.66132 |  0:04:30s
epoch 16 | loss: 0.59562 | train_auc: 0.7364  | train_balanced_accuracy: 0.67567 | train_accuracy: 0.67576 | valid_auc: 0.7307  | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67328 |  0:04:49s
epoch 17 | loss: 0.59809 | train_auc: 0.73461 | train_balanced_accuracy: 0.67134 | train_accuracy: 0.67123 | valid_auc: 0.72597 | valid_balanced_accuracy: 0.66249 | valid_accuracy: 0.66242 |  0:05:08s
epoch 18 | loss: 0.59814 | train_auc: 0.74193 | train_balanced_accuracy: 0.67564 | train_accuracy: 0.67599 | valid_auc: 0.7319  | valid_balanced_accuracy: 0.66956 | valid_accuracy: 0.66997 |  0:05:24s
epoch 19 | loss: 0.59384 | train_auc: 0.73454 | train_balanced_accuracy: 0.66923 | train_accuracy: 0.6697  | valid_auc: 0.72685 | valid_balanced_accuracy: 0.66587 | valid_accuracy: 0.66635 |  0:05:41s
epoch 20 | loss: 0.59861 | train_auc: 0.7353  | train_balanced_accuracy: 0.6735  | train_accuracy: 0.67406 | valid_auc: 0.72298 | valid_balanced_accuracy: 0.66716 | valid_accuracy: 0.66777 |  0:05:58s
epoch 21 | loss: 0.59655 | train_auc: 0.74111 | train_balanced_accuracy: 0.67579 | train_accuracy: 0.67627 | valid_auc: 0.72978 | valid_balanced_accuracy: 0.66882 | valid_accuracy: 0.66934 |  0:06:17s
epoch 22 | loss: 0.59794 | train_auc: 0.73933 | train_balanced_accuracy: 0.67505 | train_accuracy: 0.6754  | valid_auc: 0.72995 | valid_balanced_accuracy: 0.67084 | valid_accuracy: 0.67123 |  0:06:34s
epoch 23 | loss: 0.59929 | train_auc: 0.74497 | train_balanced_accuracy: 0.68187 | train_accuracy: 0.68209 | valid_auc: 0.73117 | valid_balanced_accuracy: 0.67221 | valid_accuracy: 0.67249 |  0:06:51s
epoch 24 | loss: 0.59672 | train_auc: 0.74383 | train_balanced_accuracy: 0.67765 | train_accuracy: 0.67792 | valid_auc: 0.73427 | valid_balanced_accuracy: 0.67218 | valid_accuracy: 0.67249 |  0:07:07s
epoch 25 | loss: 0.59144 | train_auc: 0.75151 | train_balanced_accuracy: 0.68455 | train_accuracy: 0.68461 | valid_auc: 0.74129 | valid_balanced_accuracy: 0.67851 | valid_accuracy: 0.67863 |  0:07:21s
epoch 26 | loss: 0.58879 | train_auc: 0.75419 | train_balanced_accuracy: 0.69017 | train_accuracy: 0.69059 | valid_auc: 0.73847 | valid_balanced_accuracy: 0.68197 | valid_accuracy: 0.6824  |  0:07:38s
epoch 27 | loss: 0.59203 | train_auc: 0.75906 | train_balanced_accuracy: 0.68974 | train_accuracy: 0.68984 | valid_auc: 0.74163 | valid_balanced_accuracy: 0.67693 | valid_accuracy: 0.67705 |  0:07:53s
epoch 28 | loss: 0.58775 | train_auc: 0.75772 | train_balanced_accuracy: 0.69086 | train_accuracy: 0.69079 | valid_auc: 0.74125 | valid_balanced_accuracy: 0.67805 | valid_accuracy: 0.678   |  0:08:09s
epoch 29 | loss: 0.5881  | train_auc: 0.76154 | train_balanced_accuracy: 0.69111 | train_accuracy: 0.6911  | valid_auc: 0.74291 | valid_balanced_accuracy: 0.67939 | valid_accuracy: 0.67941 |  0:08:26s
epoch 30 | loss: 0.58049 | train_auc: 0.76296 | train_balanced_accuracy: 0.69006 | train_accuracy: 0.68988 | valid_auc: 0.74257 | valid_balanced_accuracy: 0.67581 | valid_accuracy: 0.67564 |  0:08:42s
epoch 31 | loss: 0.58256 | train_auc: 0.76035 | train_balanced_accuracy: 0.69357 | train_accuracy: 0.69385 | valid_auc: 0.74411 | valid_balanced_accuracy: 0.68098 | valid_accuracy: 0.6813  |  0:08:57s
epoch 32 | loss: 0.58213 | train_auc: 0.75846 | train_balanced_accuracy: 0.68847 | train_accuracy: 0.68835 | valid_auc: 0.74137 | valid_balanced_accuracy: 0.67575 | valid_accuracy: 0.67564 |  0:09:15s
epoch 33 | loss: 0.5868  | train_auc: 0.76406 | train_balanced_accuracy: 0.69454 | train_accuracy: 0.69476 | valid_auc: 0.74762 | valid_balanced_accuracy: 0.67601 | valid_accuracy: 0.67627 |  0:09:32s
epoch 34 | loss: 0.58197 | train_auc: 0.76203 | train_balanced_accuracy: 0.69479 | train_accuracy: 0.69492 | valid_auc: 0.74589 | valid_balanced_accuracy: 0.68317 | valid_accuracy: 0.68335 |  0:09:47s
epoch 35 | loss: 0.57583 | train_auc: 0.76289 | train_balanced_accuracy: 0.69045 | train_accuracy: 0.6909  | valid_auc: 0.74052 | valid_balanced_accuracy: 0.67562 | valid_accuracy: 0.67611 |  0:10:03s
epoch 36 | loss: 0.57787 | train_auc: 0.76609 | train_balanced_accuracy: 0.69483 | train_accuracy: 0.69523 | valid_auc: 0.74974 | valid_balanced_accuracy: 0.68495 | valid_accuracy: 0.6854  |  0:10:21s
epoch 37 | loss: 0.5792  | train_auc: 0.76734 | train_balanced_accuracy: 0.69533 | train_accuracy: 0.69559 | valid_auc: 0.74863 | valid_balanced_accuracy: 0.6818  | valid_accuracy: 0.68209 |  0:10:38s
epoch 38 | loss: 0.57843 | train_auc: 0.76699 | train_balanced_accuracy: 0.69415 | train_accuracy: 0.69425 | valid_auc: 0.74209 | valid_balanced_accuracy: 0.67519 | valid_accuracy: 0.67532 |  0:10:57s
epoch 39 | loss: 0.57879 | train_auc: 0.76893 | train_balanced_accuracy: 0.69531 | train_accuracy: 0.69555 | valid_auc: 0.74587 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.68115 |  0:11:13s
epoch 40 | loss: 0.57474 | train_auc: 0.76947 | train_balanced_accuracy: 0.69393 | train_accuracy: 0.69409 | valid_auc: 0.74761 | valid_balanced_accuracy: 0.68366 | valid_accuracy: 0.68382 |  0:11:30s
epoch 41 | loss: 0.57792 | train_auc: 0.77174 | train_balanced_accuracy: 0.69871 | train_accuracy: 0.69889 | valid_auc: 0.74725 | valid_balanced_accuracy: 0.68    | valid_accuracy: 0.6802  |  0:11:46s
epoch 42 | loss: 0.57222 | train_auc: 0.77274 | train_balanced_accuracy: 0.69948 | train_accuracy: 0.69999 | valid_auc: 0.74822 | valid_balanced_accuracy: 0.68598 | valid_accuracy: 0.6865  |  0:12:02s
epoch 43 | loss: 0.5765  | train_auc: 0.76841 | train_balanced_accuracy: 0.69712 | train_accuracy: 0.6972  | valid_auc: 0.74915 | valid_balanced_accuracy: 0.68717 | valid_accuracy: 0.68728 |  0:12:17s
epoch 44 | loss: 0.57857 | train_auc: 0.76418 | train_balanced_accuracy: 0.69305 | train_accuracy: 0.6933  | valid_auc: 0.75023 | valid_balanced_accuracy: 0.6835  | valid_accuracy: 0.68382 |  0:12:34s
epoch 45 | loss: 0.57285 | train_auc: 0.76854 | train_balanced_accuracy: 0.69665 | train_accuracy: 0.69728 | valid_auc: 0.74975 | valid_balanced_accuracy: 0.68535 | valid_accuracy: 0.68602 |  0:12:51s
epoch 46 | loss: 0.57846 | train_auc: 0.77368 | train_balanced_accuracy: 0.69706 | train_accuracy: 0.69704 | valid_auc: 0.74515 | valid_balanced_accuracy: 0.68018 | valid_accuracy: 0.6802  |  0:13:09s
epoch 47 | loss: 0.57294 | train_auc: 0.77628 | train_balanced_accuracy: 0.70322 | train_accuracy: 0.70361 | valid_auc: 0.75029 | valid_balanced_accuracy: 0.68591 | valid_accuracy: 0.68634 |  0:13:26s
epoch 48 | loss: 0.56861 | train_auc: 0.77757 | train_balanced_accuracy: 0.70261 | train_accuracy: 0.70279 | valid_auc: 0.75026 | valid_balanced_accuracy: 0.68566 | valid_accuracy: 0.68587 |  0:13:42s
epoch 49 | loss: 0.56762 | train_auc: 0.77923 | train_balanced_accuracy: 0.70224 | train_accuracy: 0.70255 | valid_auc: 0.74743 | valid_balanced_accuracy: 0.6816  | valid_accuracy: 0.68193 |  0:13:59s
epoch 50 | loss: 0.56942 | train_auc: 0.77967 | train_balanced_accuracy: 0.70173 | train_accuracy: 0.70184 | valid_auc: 0.74849 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.6854  |  0:14:12s
epoch 51 | loss: 0.56608 | train_auc: 0.77887 | train_balanced_accuracy: 0.70029 | train_accuracy: 0.70046 | valid_auc: 0.74991 | valid_balanced_accuracy: 0.68094 | valid_accuracy: 0.68115 |  0:14:28s
epoch 52 | loss: 0.56623 | train_auc: 0.77943 | train_balanced_accuracy: 0.69954 | train_accuracy: 0.69976 | valid_auc: 0.74891 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.68115 |  0:14:46s
epoch 53 | loss: 0.56964 | train_auc: 0.77737 | train_balanced_accuracy: 0.70298 | train_accuracy: 0.70314 | valid_auc: 0.74907 | valid_balanced_accuracy: 0.68554 | valid_accuracy: 0.68571 |  0:15:03s
epoch 54 | loss: 0.57012 | train_auc: 0.78077 | train_balanced_accuracy: 0.70479 | train_accuracy: 0.70495 | valid_auc: 0.74922 | valid_balanced_accuracy: 0.67841 | valid_accuracy: 0.67863 |  0:15:20s
epoch 55 | loss: 0.56564 | train_auc: 0.77668 | train_balanced_accuracy: 0.70162 | train_accuracy: 0.70168 | valid_auc: 0.74686 | valid_balanced_accuracy: 0.67856 | valid_accuracy: 0.67863 |  0:15:35s
epoch 56 | loss: 0.56651 | train_auc: 0.78148 | train_balanced_accuracy: 0.70508 | train_accuracy: 0.70526 | valid_auc: 0.74876 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.6813  |  0:15:52s
epoch 57 | loss: 0.56726 | train_auc: 0.78067 | train_balanced_accuracy: 0.706   | train_accuracy: 0.70621 | valid_auc: 0.74654 | valid_balanced_accuracy: 0.6836  | valid_accuracy: 0.68382 |  0:16:10s
epoch 58 | loss: 0.5703  | train_auc: 0.78392 | train_balanced_accuracy: 0.7026  | train_accuracy: 0.70259 | valid_auc: 0.74983 | valid_balanced_accuracy: 0.68095 | valid_accuracy: 0.68099 |  0:16:28s
epoch 59 | loss: 0.56519 | train_auc: 0.7796  | train_balanced_accuracy: 0.70486 | train_accuracy: 0.70507 | valid_auc: 0.74905 | valid_balanced_accuracy: 0.68297 | valid_accuracy: 0.68319 |  0:16:45s
epoch 60 | loss: 0.5627  | train_auc: 0.78718 | train_balanced_accuracy: 0.70945 | train_accuracy: 0.70971 | valid_auc: 0.75564 | valid_balanced_accuracy: 0.68727 | valid_accuracy: 0.6876  |  0:17:03s
epoch 61 | loss: 0.56118 | train_auc: 0.78526 | train_balanced_accuracy: 0.70822 | train_accuracy: 0.70853 | valid_auc: 0.75382 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68886 |  0:17:19s
epoch 62 | loss: 0.56375 | train_auc: 0.7857  | train_balanced_accuracy: 0.70902 | train_accuracy: 0.7092  | valid_auc: 0.7527  | valid_balanced_accuracy: 0.68549 | valid_accuracy: 0.68571 |  0:17:35s
epoch 63 | loss: 0.56197 | train_auc: 0.78713 | train_balanced_accuracy: 0.70744 | train_accuracy: 0.70766 | valid_auc: 0.7526  | valid_balanced_accuracy: 0.68795 | valid_accuracy: 0.68823 |  0:17:51s
epoch 64 | loss: 0.55855 | train_auc: 0.7879  | train_balanced_accuracy: 0.7093  | train_accuracy: 0.70936 | valid_auc: 0.75019 | valid_balanced_accuracy: 0.68307 | valid_accuracy: 0.68319 |  0:18:08s
epoch 65 | loss: 0.55885 | train_auc: 0.78381 | train_balanced_accuracy: 0.70639 | train_accuracy: 0.70668 | valid_auc: 0.74856 | valid_balanced_accuracy: 0.68302 | valid_accuracy: 0.68335 |  0:18:25s
epoch 66 | loss: 0.565   | train_auc: 0.78548 | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70711 | valid_auc: 0.74905 | valid_balanced_accuracy: 0.68191 | valid_accuracy: 0.68209 |  0:18:41s
epoch 67 | loss: 0.55989 | train_auc: 0.77959 | train_balanced_accuracy: 0.70179 | train_accuracy: 0.70216 | valid_auc: 0.74879 | valid_balanced_accuracy: 0.68626 | valid_accuracy: 0.68665 |  0:18:57s
epoch 68 | loss: 0.56381 | train_auc: 0.78288 | train_balanced_accuracy: 0.70533 | train_accuracy: 0.70589 | valid_auc: 0.75184 | valid_balanced_accuracy: 0.68451 | valid_accuracy: 0.68508 |  0:19:14s
epoch 69 | loss: 0.56447 | train_auc: 0.78464 | train_balanced_accuracy: 0.7076  | train_accuracy: 0.70794 | valid_auc: 0.75548 | valid_balanced_accuracy: 0.694   | valid_accuracy: 0.69437 |  0:19:28s
epoch 70 | loss: 0.55904 | train_auc: 0.78705 | train_balanced_accuracy: 0.70635 | train_accuracy: 0.70641 | valid_auc: 0.75288 | valid_balanced_accuracy: 0.68512 | valid_accuracy: 0.68524 |  0:19:45s
epoch 71 | loss: 0.55948 | train_auc: 0.78872 | train_balanced_accuracy: 0.70981 | train_accuracy: 0.7101  | valid_auc: 0.75605 | valid_balanced_accuracy: 0.69405 | valid_accuracy: 0.69437 |  0:20:00s
epoch 72 | loss: 0.55621 | train_auc: 0.78989 | train_balanced_accuracy: 0.70895 | train_accuracy: 0.70924 | valid_auc: 0.75426 | valid_balanced_accuracy: 0.69062 | valid_accuracy: 0.6909  |  0:20:16s
epoch 73 | loss: 0.55805 | train_auc: 0.78901 | train_balanced_accuracy: 0.71072 | train_accuracy: 0.71077 | valid_auc: 0.75323 | valid_balanced_accuracy: 0.6889  | valid_accuracy: 0.68901 |  0:20:32s
epoch 74 | loss: 0.55938 | train_auc: 0.79121 | train_balanced_accuracy: 0.708   | train_accuracy: 0.70849 | valid_auc: 0.75102 | valid_balanced_accuracy: 0.68376 | valid_accuracy: 0.68429 |  0:20:48s
epoch 75 | loss: 0.55983 | train_auc: 0.78903 | train_balanced_accuracy: 0.71007 | train_accuracy: 0.71014 | valid_auc: 0.75024 | valid_balanced_accuracy: 0.68102 | valid_accuracy: 0.68115 |  0:21:05s
epoch 76 | loss: 0.55969 | train_auc: 0.79254 | train_balanced_accuracy: 0.71044 | train_accuracy: 0.71042 | valid_auc: 0.75411 | valid_balanced_accuracy: 0.68557 | valid_accuracy: 0.68555 |  0:21:21s
epoch 77 | loss: 0.55716 | train_auc: 0.79473 | train_balanced_accuracy: 0.71156 | train_accuracy: 0.71176 | valid_auc: 0.75284 | valid_balanced_accuracy: 0.68404 | valid_accuracy: 0.68429 |  0:21:38s
epoch 78 | loss: 0.54592 | train_auc: 0.79643 | train_balanced_accuracy: 0.7139  | train_accuracy: 0.71404 | valid_auc: 0.75714 | valid_balanced_accuracy: 0.69088 | valid_accuracy: 0.69106 |  0:21:53s
epoch 79 | loss: 0.54794 | train_auc: 0.79405 | train_balanced_accuracy: 0.70878 | train_accuracy: 0.70869 | valid_auc: 0.75827 | valid_balanced_accuracy: 0.68357 | valid_accuracy: 0.68351 |  0:22:10s
epoch 80 | loss: 0.55553 | train_auc: 0.79716 | train_balanced_accuracy: 0.7162  | train_accuracy: 0.71636 | valid_auc: 0.75648 | valid_balanced_accuracy: 0.69166 | valid_accuracy: 0.69185 |  0:22:25s
epoch 81 | loss: 0.55152 | train_auc: 0.79599 | train_balanced_accuracy: 0.71208 | train_accuracy: 0.71207 | valid_auc: 0.75235 | valid_balanced_accuracy: 0.67794 | valid_accuracy: 0.678   |  0:22:41s
epoch 82 | loss: 0.55002 | train_auc: 0.79591 | train_balanced_accuracy: 0.71353 | train_accuracy: 0.71392 | valid_auc: 0.75472 | valid_balanced_accuracy: 0.68811 | valid_accuracy: 0.68854 |  0:22:56s
epoch 83 | loss: 0.55084 | train_auc: 0.79288 | train_balanced_accuracy: 0.71027 | train_accuracy: 0.7103  | valid_auc: 0.75136 | valid_balanced_accuracy: 0.68015 | valid_accuracy: 0.6802  |  0:23:13s
epoch 84 | loss: 0.54972 | train_auc: 0.7921  | train_balanced_accuracy: 0.71272 | train_accuracy: 0.71298 | valid_auc: 0.75535 | valid_balanced_accuracy: 0.68718 | valid_accuracy: 0.68744 |  0:23:30s
epoch 85 | loss: 0.5516  | train_auc: 0.79475 | train_balanced_accuracy: 0.71262 | train_accuracy: 0.71286 | valid_auc: 0.75449 | valid_balanced_accuracy: 0.69014 | valid_accuracy: 0.69043 |  0:23:48s
epoch 86 | loss: 0.55637 | train_auc: 0.79049 | train_balanced_accuracy: 0.70926 | train_accuracy: 0.70944 | valid_auc: 0.75112 | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68335 |  0:24:03s
epoch 87 | loss: 0.54922 | train_auc: 0.79542 | train_balanced_accuracy: 0.71265 | train_accuracy: 0.7125  | valid_auc: 0.75154 | valid_balanced_accuracy: 0.68111 | valid_accuracy: 0.68099 |  0:24:20s
epoch 88 | loss: 0.54855 | train_auc: 0.79871 | train_balanced_accuracy: 0.71592 | train_accuracy: 0.71632 | valid_auc: 0.75582 | valid_balanced_accuracy: 0.68988 | valid_accuracy: 0.69027 |  0:24:34s
epoch 89 | loss: 0.54597 | train_auc: 0.79949 | train_balanced_accuracy: 0.71455 | train_accuracy: 0.71459 | valid_auc: 0.75807 | valid_balanced_accuracy: 0.69067 | valid_accuracy: 0.69075 |  0:24:50s

Early stopping occurred at epoch 89 with best_epoch = 69 and best_valid_accuracy = 0.69437
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 55/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=25.0min
[CV 5/5; 55/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70686 | train_auc: 0.51562 | train_balanced_accuracy: 0.50014 | train_accuracy: 0.50189 | valid_auc: 0.51793 | valid_balanced_accuracy: 0.49777 | valid_accuracy: 0.49953 |  0:00:16s
epoch 1  | loss: 0.65533 | train_auc: 0.59638 | train_balanced_accuracy: 0.57069 | train_accuracy: 0.57196 | valid_auc: 0.58659 | valid_balanced_accuracy: 0.56392 | valid_accuracy: 0.56516 |  0:00:33s
epoch 2  | loss: 0.64457 | train_auc: 0.63272 | train_balanced_accuracy: 0.6047  | train_accuracy: 0.60482 | valid_auc: 0.62842 | valid_balanced_accuracy: 0.59576 | valid_accuracy: 0.59585 |  0:00:49s
epoch 3  | loss: 0.63623 | train_auc: 0.62408 | train_balanced_accuracy: 0.5631  | train_accuracy: 0.56492 | valid_auc: 0.61742 | valid_balanced_accuracy: 0.55809 | valid_accuracy: 0.55996 |  0:01:07s
epoch 4  | loss: 0.62185 | train_auc: 0.68589 | train_balanced_accuracy: 0.63756 | train_accuracy: 0.63873 | valid_auc: 0.68211 | valid_balanced_accuracy: 0.63875 | valid_accuracy: 0.63991 |  0:01:24s
epoch 5  | loss: 0.61422 | train_auc: 0.70331 | train_balanced_accuracy: 0.64928 | train_accuracy: 0.64998 | valid_auc: 0.70082 | valid_balanced_accuracy: 0.65021 | valid_accuracy: 0.65093 |  0:01:39s
epoch 6  | loss: 0.61313 | train_auc: 0.70293 | train_balanced_accuracy: 0.63102 | train_accuracy: 0.63259 | valid_auc: 0.69874 | valid_balanced_accuracy: 0.62979 | valid_accuracy: 0.63141 |  0:01:55s
epoch 7  | loss: 0.61043 | train_auc: 0.70188 | train_balanced_accuracy: 0.64361 | train_accuracy: 0.64483 | valid_auc: 0.69777 | valid_balanced_accuracy: 0.63899 | valid_accuracy: 0.64023 |  0:02:12s
epoch 8  | loss: 0.61251 | train_auc: 0.71678 | train_balanced_accuracy: 0.65598 | train_accuracy: 0.65695 | valid_auc: 0.71004 | valid_balanced_accuracy: 0.65177 | valid_accuracy: 0.65282 |  0:02:30s
epoch 9  | loss: 0.60476 | train_auc: 0.71974 | train_balanced_accuracy: 0.66117 | train_accuracy: 0.66187 | valid_auc: 0.71234 | valid_balanced_accuracy: 0.65395 | valid_accuracy: 0.65471 |  0:02:49s
epoch 10 | loss: 0.60071 | train_auc: 0.71841 | train_balanced_accuracy: 0.66233 | train_accuracy: 0.66313 | valid_auc: 0.7124  | valid_balanced_accuracy: 0.66132 | valid_accuracy: 0.6621  |  0:03:05s
epoch 11 | loss: 0.60028 | train_auc: 0.71732 | train_balanced_accuracy: 0.66158 | train_accuracy: 0.66206 | valid_auc: 0.71406 | valid_balanced_accuracy: 0.66068 | valid_accuracy: 0.66116 |  0:03:22s
epoch 12 | loss: 0.59934 | train_auc: 0.71904 | train_balanced_accuracy: 0.66623 | train_accuracy: 0.66682 | valid_auc: 0.71695 | valid_balanced_accuracy: 0.66181 | valid_accuracy: 0.66242 |  0:03:38s
epoch 13 | loss: 0.60198 | train_auc: 0.72565 | train_balanced_accuracy: 0.66887 | train_accuracy: 0.66938 | valid_auc: 0.72368 | valid_balanced_accuracy: 0.6641  | valid_accuracy: 0.66462 |  0:03:55s
epoch 14 | loss: 0.59291 | train_auc: 0.73132 | train_balanced_accuracy: 0.67372 | train_accuracy: 0.67402 | valid_auc: 0.7283  | valid_balanced_accuracy: 0.6725  | valid_accuracy: 0.6728  |  0:04:11s
epoch 15 | loss: 0.59168 | train_auc: 0.72714 | train_balanced_accuracy: 0.66782 | train_accuracy: 0.66852 | valid_auc: 0.72706 | valid_balanced_accuracy: 0.66784 | valid_accuracy: 0.66856 |  0:04:28s
epoch 16 | loss: 0.59464 | train_auc: 0.73373 | train_balanced_accuracy: 0.67631 | train_accuracy: 0.6769  | valid_auc: 0.73256 | valid_balanced_accuracy: 0.67254 | valid_accuracy: 0.67312 |  0:04:45s
epoch 17 | loss: 0.59628 | train_auc: 0.73896 | train_balanced_accuracy: 0.67634 | train_accuracy: 0.67686 | valid_auc: 0.73417 | valid_balanced_accuracy: 0.66868 | valid_accuracy: 0.66918 |  0:05:03s
epoch 18 | loss: 0.59076 | train_auc: 0.73973 | train_balanced_accuracy: 0.67121 | train_accuracy: 0.67194 | valid_auc: 0.72949 | valid_balanced_accuracy: 0.66137 | valid_accuracy: 0.6621  |  0:05:20s
epoch 19 | loss: 0.5927  | train_auc: 0.73657 | train_balanced_accuracy: 0.6675  | train_accuracy: 0.66832 | valid_auc: 0.73172 | valid_balanced_accuracy: 0.66571 | valid_accuracy: 0.66651 |  0:05:34s
epoch 20 | loss: 0.5907  | train_auc: 0.74422 | train_balanced_accuracy: 0.67704 | train_accuracy: 0.67764 | valid_auc: 0.73548 | valid_balanced_accuracy: 0.67112 | valid_accuracy: 0.6717  |  0:05:52s
epoch 21 | loss: 0.58653 | train_auc: 0.73393 | train_balanced_accuracy: 0.67458 | train_accuracy: 0.67505 | valid_auc: 0.73136 | valid_balanced_accuracy: 0.66701 | valid_accuracy: 0.66745 |  0:06:08s
epoch 22 | loss: 0.58615 | train_auc: 0.74896 | train_balanced_accuracy: 0.68108 | train_accuracy: 0.68158 | valid_auc: 0.73987 | valid_balanced_accuracy: 0.67548 | valid_accuracy: 0.67595 |  0:06:24s
epoch 23 | loss: 0.58351 | train_auc: 0.74738 | train_balanced_accuracy: 0.67683 | train_accuracy: 0.67749 | valid_auc: 0.74224 | valid_balanced_accuracy: 0.6695  | valid_accuracy: 0.67013 |  0:06:41s
epoch 24 | loss: 0.58928 | train_auc: 0.75676 | train_balanced_accuracy: 0.68947 | train_accuracy: 0.6898  | valid_auc: 0.74606 | valid_balanced_accuracy: 0.68177 | valid_accuracy: 0.68209 |  0:06:56s
epoch 25 | loss: 0.58617 | train_auc: 0.75294 | train_balanced_accuracy: 0.68457 | train_accuracy: 0.68496 | valid_auc: 0.74545 | valid_balanced_accuracy: 0.67719 | valid_accuracy: 0.67753 |  0:07:12s
epoch 26 | loss: 0.58619 | train_auc: 0.75117 | train_balanced_accuracy: 0.68088 | train_accuracy: 0.68154 | valid_auc: 0.74098 | valid_balanced_accuracy: 0.6666  | valid_accuracy: 0.6673  |  0:07:28s
epoch 27 | loss: 0.58507 | train_auc: 0.75706 | train_balanced_accuracy: 0.68857 | train_accuracy: 0.68894 | valid_auc: 0.7474  | valid_balanced_accuracy: 0.6822  | valid_accuracy: 0.68256 |  0:07:44s
epoch 28 | loss: 0.58562 | train_auc: 0.76477 | train_balanced_accuracy: 0.69753 | train_accuracy: 0.69767 | valid_auc: 0.7532  | valid_balanced_accuracy: 0.69186 | valid_accuracy: 0.69201 |  0:07:59s
epoch 29 | loss: 0.58441 | train_auc: 0.76294 | train_balanced_accuracy: 0.68971 | train_accuracy: 0.68957 | valid_auc: 0.75114 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.68508 |  0:08:17s
epoch 30 | loss: 0.58573 | train_auc: 0.76553 | train_balanced_accuracy: 0.69377 | train_accuracy: 0.69421 | valid_auc: 0.7513  | valid_balanced_accuracy: 0.6834  | valid_accuracy: 0.68382 |  0:08:34s
epoch 31 | loss: 0.58351 | train_auc: 0.7647  | train_balanced_accuracy: 0.69247 | train_accuracy: 0.69267 | valid_auc: 0.75457 | valid_balanced_accuracy: 0.68662 | valid_accuracy: 0.68681 |  0:08:50s
epoch 32 | loss: 0.5876  | train_auc: 0.7556  | train_balanced_accuracy: 0.68935 | train_accuracy: 0.68968 | valid_auc: 0.74316 | valid_balanced_accuracy: 0.67985 | valid_accuracy: 0.6802  |  0:09:06s
epoch 33 | loss: 0.58852 | train_auc: 0.76257 | train_balanced_accuracy: 0.68946 | train_accuracy: 0.69016 | valid_auc: 0.74597 | valid_balanced_accuracy: 0.67414 | valid_accuracy: 0.67485 |  0:09:22s
epoch 34 | loss: 0.57921 | train_auc: 0.76938 | train_balanced_accuracy: 0.69647 | train_accuracy: 0.69669 | valid_auc: 0.75782 | valid_balanced_accuracy: 0.69038 | valid_accuracy: 0.69059 |  0:09:39s
epoch 35 | loss: 0.57694 | train_auc: 0.76819 | train_balanced_accuracy: 0.69352 | train_accuracy: 0.6935  | valid_auc: 0.75149 | valid_balanced_accuracy: 0.68212 | valid_accuracy: 0.68209 |  0:09:56s
epoch 36 | loss: 0.5721  | train_auc: 0.76978 | train_balanced_accuracy: 0.69633 | train_accuracy: 0.69629 | valid_auc: 0.75653 | valid_balanced_accuracy: 0.68611 | valid_accuracy: 0.68602 |  0:10:14s
epoch 37 | loss: 0.57698 | train_auc: 0.76707 | train_balanced_accuracy: 0.69558 | train_accuracy: 0.69559 | valid_auc: 0.75507 | valid_balanced_accuracy: 0.68637 | valid_accuracy: 0.68634 |  0:10:31s
epoch 38 | loss: 0.57553 | train_auc: 0.76752 | train_balanced_accuracy: 0.69429 | train_accuracy: 0.69413 | valid_auc: 0.75187 | valid_balanced_accuracy: 0.68243 | valid_accuracy: 0.68225 |  0:10:47s
epoch 39 | loss: 0.57932 | train_auc: 0.77289 | train_balanced_accuracy: 0.69945 | train_accuracy: 0.69999 | valid_auc: 0.75935 | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69153 |  0:11:05s
epoch 40 | loss: 0.57503 | train_auc: 0.77099 | train_balanced_accuracy: 0.6998  | train_accuracy: 0.70003 | valid_auc: 0.75394 | valid_balanced_accuracy: 0.68626 | valid_accuracy: 0.6865  |  0:11:21s
epoch 41 | loss: 0.57482 | train_auc: 0.76766 | train_balanced_accuracy: 0.69776 | train_accuracy: 0.69802 | valid_auc: 0.75405 | valid_balanced_accuracy: 0.6897  | valid_accuracy: 0.68996 |  0:11:39s
epoch 42 | loss: 0.57591 | train_auc: 0.77163 | train_balanced_accuracy: 0.69571 | train_accuracy: 0.69621 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.69258 | valid_accuracy: 0.69311 |  0:11:54s
epoch 43 | loss: 0.57186 | train_auc: 0.77837 | train_balanced_accuracy: 0.70502 | train_accuracy: 0.70546 | valid_auc: 0.75773 | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68949 |  0:12:08s
epoch 44 | loss: 0.57093 | train_auc: 0.77364 | train_balanced_accuracy: 0.70338 | train_accuracy: 0.70369 | valid_auc: 0.75363 | valid_balanced_accuracy: 0.68682 | valid_accuracy: 0.68713 |  0:12:26s
epoch 45 | loss: 0.57389 | train_auc: 0.76785 | train_balanced_accuracy: 0.69385 | train_accuracy: 0.69441 | valid_auc: 0.75425 | valid_balanced_accuracy: 0.68198 | valid_accuracy: 0.68256 |  0:12:41s
epoch 46 | loss: 0.57928 | train_auc: 0.63218 | train_balanced_accuracy: 0.58829 | train_accuracy: 0.58774 | valid_auc: 0.63364 | valid_balanced_accuracy: 0.58789 | valid_accuracy: 0.58735 |  0:12:58s
epoch 47 | loss: 0.57327 | train_auc: 0.66543 | train_balanced_accuracy: 0.6196  | train_accuracy: 0.62036 | valid_auc: 0.66592 | valid_balanced_accuracy: 0.62043 | valid_accuracy: 0.62118 |  0:13:12s
epoch 48 | loss: 0.5709  | train_auc: 0.73526 | train_balanced_accuracy: 0.67541 | train_accuracy: 0.67587 | valid_auc: 0.72709 | valid_balanced_accuracy: 0.66828 | valid_accuracy: 0.66871 |  0:13:29s
epoch 49 | loss: 0.56672 | train_auc: 0.76015 | train_balanced_accuracy: 0.69202 | train_accuracy: 0.69256 | valid_auc: 0.73976 | valid_balanced_accuracy: 0.6724  | valid_accuracy: 0.67296 |  0:13:44s
epoch 50 | loss: 0.56913 | train_auc: 0.77539 | train_balanced_accuracy: 0.7018  | train_accuracy: 0.70196 | valid_auc: 0.76002 | valid_balanced_accuracy: 0.68825 | valid_accuracy: 0.68839 |  0:14:01s
epoch 51 | loss: 0.56813 | train_auc: 0.77505 | train_balanced_accuracy: 0.70292 | train_accuracy: 0.70322 | valid_auc: 0.75391 | valid_balanced_accuracy: 0.68665 | valid_accuracy: 0.68697 |  0:14:17s
epoch 52 | loss: 0.56797 | train_auc: 0.77627 | train_balanced_accuracy: 0.70514 | train_accuracy: 0.7053  | valid_auc: 0.75805 | valid_balanced_accuracy: 0.6821  | valid_accuracy: 0.68225 |  0:14:34s
epoch 53 | loss: 0.57678 | train_auc: 0.77498 | train_balanced_accuracy: 0.70195 | train_accuracy: 0.70235 | valid_auc: 0.75741 | valid_balanced_accuracy: 0.6875  | valid_accuracy: 0.68791 |  0:14:50s
epoch 54 | loss: 0.56986 | train_auc: 0.78141 | train_balanced_accuracy: 0.70718 | train_accuracy: 0.70751 | valid_auc: 0.76011 | valid_balanced_accuracy: 0.68822 | valid_accuracy: 0.68854 |  0:15:06s
epoch 55 | loss: 0.57096 | train_auc: 0.77955 | train_balanced_accuracy: 0.70611 | train_accuracy: 0.70621 | valid_auc: 0.762   | valid_balanced_accuracy: 0.68783 | valid_accuracy: 0.68791 |  0:15:21s
epoch 56 | loss: 0.57262 | train_auc: 0.77765 | train_balanced_accuracy: 0.70428 | train_accuracy: 0.70428 | valid_auc: 0.75715 | valid_balanced_accuracy: 0.68477 | valid_accuracy: 0.68477 |  0:15:38s
epoch 57 | loss: 0.57163 | train_auc: 0.76789 | train_balanced_accuracy: 0.69622 | train_accuracy: 0.69641 | valid_auc: 0.75277 | valid_balanced_accuracy: 0.68079 | valid_accuracy: 0.68099 |  0:15:53s
epoch 58 | loss: 0.58089 | train_auc: 0.76622 | train_balanced_accuracy: 0.69502 | train_accuracy: 0.69496 | valid_auc: 0.75138 | valid_balanced_accuracy: 0.68844 | valid_accuracy: 0.68839 |  0:16:09s
epoch 59 | loss: 0.57753 | train_auc: 0.76031 | train_balanced_accuracy: 0.68722 | train_accuracy: 0.68764 | valid_auc: 0.74943 | valid_balanced_accuracy: 0.67943 | valid_accuracy: 0.67989 |  0:16:25s
epoch 60 | loss: 0.58126 | train_auc: 0.77227 | train_balanced_accuracy: 0.69831 | train_accuracy: 0.6985  | valid_auc: 0.75416 | valid_balanced_accuracy: 0.68757 | valid_accuracy: 0.68776 |  0:16:41s
epoch 61 | loss: 0.5796  | train_auc: 0.77673 | train_balanced_accuracy: 0.70212 | train_accuracy: 0.70251 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.68261 | valid_accuracy: 0.68303 |  0:16:58s
epoch 62 | loss: 0.56994 | train_auc: 0.77395 | train_balanced_accuracy: 0.69958 | train_accuracy: 0.69983 | valid_auc: 0.75878 | valid_balanced_accuracy: 0.68448 | valid_accuracy: 0.68477 |  0:17:12s

Early stopping occurred at epoch 62 with best_epoch = 42 and best_valid_accuracy = 0.69311
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 55/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=17.3min
[CV 1/5; 56/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71515 | train_auc: 0.53068 | train_balanced_accuracy: 0.51252 | train_accuracy: 0.51033 | valid_auc: 0.54169 | valid_balanced_accuracy: 0.51335 | valid_accuracy: 0.51102 |  0:00:16s
epoch 1  | loss: 0.65681 | train_auc: 0.55274 | train_balanced_accuracy: 0.51871 | train_accuracy: 0.51615 | valid_auc: 0.55711 | valid_balanced_accuracy: 0.52107 | valid_accuracy: 0.51841 |  0:00:32s
epoch 2  | loss: 0.64269 | train_auc: 0.65619 | train_balanced_accuracy: 0.53086 | train_accuracy: 0.52796 | valid_auc: 0.65944 | valid_balanced_accuracy: 0.52691 | valid_accuracy: 0.52392 |  0:00:48s
epoch 3  | loss: 0.63264 | train_auc: 0.65711 | train_balanced_accuracy: 0.55521 | train_accuracy: 0.55294 | valid_auc: 0.65584 | valid_balanced_accuracy: 0.55441 | valid_accuracy: 0.55209 |  0:01:05s
epoch 4  | loss: 0.62125 | train_auc: 0.67266 | train_balanced_accuracy: 0.58253 | train_accuracy: 0.58068 | valid_auc: 0.67304 | valid_balanced_accuracy: 0.58214 | valid_accuracy: 0.58026 |  0:01:21s
epoch 5  | loss: 0.61887 | train_auc: 0.66863 | train_balanced_accuracy: 0.59902 | train_accuracy: 0.59772 | valid_auc: 0.6714  | valid_balanced_accuracy: 0.60266 | valid_accuracy: 0.60135 |  0:01:36s
epoch 6  | loss: 0.61729 | train_auc: 0.68052 | train_balanced_accuracy: 0.60907 | train_accuracy: 0.60787 | valid_auc: 0.68167 | valid_balanced_accuracy: 0.61134 | valid_accuracy: 0.61017 |  0:01:53s
epoch 7  | loss: 0.61434 | train_auc: 0.6913  | train_balanced_accuracy: 0.62288 | train_accuracy: 0.62203 | valid_auc: 0.69336 | valid_balanced_accuracy: 0.62488 | valid_accuracy: 0.62402 |  0:02:10s
epoch 8  | loss: 0.6073  | train_auc: 0.68996 | train_balanced_accuracy: 0.62942 | train_accuracy: 0.62943 | valid_auc: 0.68789 | valid_balanced_accuracy: 0.63237 | valid_accuracy: 0.63236 |  0:02:26s
epoch 9  | loss: 0.61271 | train_auc: 0.69106 | train_balanced_accuracy: 0.62132 | train_accuracy: 0.62038 | valid_auc: 0.69326 | valid_balanced_accuracy: 0.61998 | valid_accuracy: 0.61898 |  0:02:43s
epoch 10 | loss: 0.60388 | train_auc: 0.69564 | train_balanced_accuracy: 0.63356 | train_accuracy: 0.6338  | valid_auc: 0.69694 | valid_balanced_accuracy: 0.64204 | valid_accuracy: 0.64227 |  0:02:59s
epoch 11 | loss: 0.60453 | train_auc: 0.71056 | train_balanced_accuracy: 0.65647 | train_accuracy: 0.65709 | valid_auc: 0.70797 | valid_balanced_accuracy: 0.64884 | valid_accuracy: 0.64951 |  0:03:14s
epoch 12 | loss: 0.60336 | train_auc: 0.70842 | train_balanced_accuracy: 0.64835 | train_accuracy: 0.64863 | valid_auc: 0.70991 | valid_balanced_accuracy: 0.64828 | valid_accuracy: 0.64857 |  0:03:31s
epoch 13 | loss: 0.60441 | train_auc: 0.71343 | train_balanced_accuracy: 0.65554 | train_accuracy: 0.65615 | valid_auc: 0.70886 | valid_balanced_accuracy: 0.65846 | valid_accuracy: 0.65911 |  0:03:47s
epoch 14 | loss: 0.60154 | train_auc: 0.71881 | train_balanced_accuracy: 0.66208 | train_accuracy: 0.66276 | valid_auc: 0.71039 | valid_balanced_accuracy: 0.65887 | valid_accuracy: 0.65958 |  0:04:03s
epoch 15 | loss: 0.60013 | train_auc: 0.72374 | train_balanced_accuracy: 0.66467 | train_accuracy: 0.66528 | valid_auc: 0.71476 | valid_balanced_accuracy: 0.65977 | valid_accuracy: 0.66037 |  0:04:21s
epoch 16 | loss: 0.59778 | train_auc: 0.72685 | train_balanced_accuracy: 0.66481 | train_accuracy: 0.66536 | valid_auc: 0.71708 | valid_balanced_accuracy: 0.65743 | valid_accuracy: 0.65801 |  0:04:36s
epoch 17 | loss: 0.59821 | train_auc: 0.72434 | train_balanced_accuracy: 0.66546 | train_accuracy: 0.6661  | valid_auc: 0.71795 | valid_balanced_accuracy: 0.66442 | valid_accuracy: 0.66509 |  0:04:52s
epoch 18 | loss: 0.59694 | train_auc: 0.72906 | train_balanced_accuracy: 0.67124 | train_accuracy: 0.67169 | valid_auc: 0.71756 | valid_balanced_accuracy: 0.66161 | valid_accuracy: 0.6621  |  0:05:11s
epoch 19 | loss: 0.59905 | train_auc: 0.74027 | train_balanced_accuracy: 0.67702 | train_accuracy: 0.67779 | valid_auc: 0.72739 | valid_balanced_accuracy: 0.67074 | valid_accuracy: 0.67155 |  0:05:27s
epoch 20 | loss: 0.59431 | train_auc: 0.73704 | train_balanced_accuracy: 0.67644 | train_accuracy: 0.677   | valid_auc: 0.72398 | valid_balanced_accuracy: 0.6647  | valid_accuracy: 0.66525 |  0:05:45s
epoch 21 | loss: 0.5955  | train_auc: 0.74122 | train_balanced_accuracy: 0.67731 | train_accuracy: 0.67779 | valid_auc: 0.72893 | valid_balanced_accuracy: 0.66993 | valid_accuracy: 0.67044 |  0:06:03s
epoch 22 | loss: 0.59587 | train_auc: 0.74409 | train_balanced_accuracy: 0.68344 | train_accuracy: 0.68389 | valid_auc: 0.72833 | valid_balanced_accuracy: 0.67049 | valid_accuracy: 0.67092 |  0:06:19s
epoch 23 | loss: 0.59176 | train_auc: 0.74787 | train_balanced_accuracy: 0.68332 | train_accuracy: 0.68393 | valid_auc: 0.73438 | valid_balanced_accuracy: 0.67848 | valid_accuracy: 0.6791  |  0:06:36s
epoch 24 | loss: 0.59814 | train_auc: 0.74499 | train_balanced_accuracy: 0.67576 | train_accuracy: 0.67629 | valid_auc: 0.73115 | valid_balanced_accuracy: 0.67305 | valid_accuracy: 0.67359 |  0:06:52s
epoch 25 | loss: 0.58782 | train_auc: 0.7541  | train_balanced_accuracy: 0.68718 | train_accuracy: 0.68751 | valid_auc: 0.73973 | valid_balanced_accuracy: 0.67829 | valid_accuracy: 0.67863 |  0:07:06s
epoch 26 | loss: 0.59047 | train_auc: 0.74868 | train_balanced_accuracy: 0.68695 | train_accuracy: 0.68739 | valid_auc: 0.73464 | valid_balanced_accuracy: 0.67423 | valid_accuracy: 0.67469 |  0:07:22s
epoch 27 | loss: 0.59331 | train_auc: 0.75512 | train_balanced_accuracy: 0.68806 | train_accuracy: 0.68818 | valid_auc: 0.73907 | valid_balanced_accuracy: 0.67235 | valid_accuracy: 0.67249 |  0:07:39s
epoch 28 | loss: 0.59213 | train_auc: 0.75439 | train_balanced_accuracy: 0.68921 | train_accuracy: 0.68967 | valid_auc: 0.73925 | valid_balanced_accuracy: 0.67582 | valid_accuracy: 0.67627 |  0:07:54s
epoch 29 | loss: 0.58497 | train_auc: 0.75918 | train_balanced_accuracy: 0.69238 | train_accuracy: 0.6925  | valid_auc: 0.74314 | valid_balanced_accuracy: 0.6788  | valid_accuracy: 0.67894 |  0:08:10s
epoch 30 | loss: 0.58847 | train_auc: 0.75471 | train_balanced_accuracy: 0.68733 | train_accuracy: 0.68763 | valid_auc: 0.74001 | valid_balanced_accuracy: 0.6747  | valid_accuracy: 0.67501 |  0:08:26s
epoch 31 | loss: 0.58676 | train_auc: 0.75101 | train_balanced_accuracy: 0.68844 | train_accuracy: 0.68885 | valid_auc: 0.73821 | valid_balanced_accuracy: 0.67511 | valid_accuracy: 0.67548 |  0:08:40s
epoch 32 | loss: 0.59161 | train_auc: 0.75589 | train_balanced_accuracy: 0.68598 | train_accuracy: 0.68605 | valid_auc: 0.74185 | valid_balanced_accuracy: 0.67351 | valid_accuracy: 0.67359 |  0:08:57s
epoch 33 | loss: 0.59082 | train_auc: 0.75002 | train_balanced_accuracy: 0.68599 | train_accuracy: 0.68648 | valid_auc: 0.73511 | valid_balanced_accuracy: 0.67389 | valid_accuracy: 0.67438 |  0:09:13s
epoch 34 | loss: 0.58484 | train_auc: 0.75425 | train_balanced_accuracy: 0.68731 | train_accuracy: 0.6877  | valid_auc: 0.73891 | valid_balanced_accuracy: 0.67804 | valid_accuracy: 0.67847 |  0:09:28s
epoch 35 | loss: 0.58697 | train_auc: 0.75822 | train_balanced_accuracy: 0.6913  | train_accuracy: 0.6916  | valid_auc: 0.74344 | valid_balanced_accuracy: 0.68259 | valid_accuracy: 0.68288 |  0:09:45s
epoch 36 | loss: 0.58464 | train_auc: 0.76118 | train_balanced_accuracy: 0.69121 | train_accuracy: 0.69117 | valid_auc: 0.74482 | valid_balanced_accuracy: 0.68418 | valid_accuracy: 0.68414 |  0:10:01s
epoch 37 | loss: 0.58431 | train_auc: 0.75338 | train_balanced_accuracy: 0.6903  | train_accuracy: 0.69069 | valid_auc: 0.74329 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.68146 |  0:10:17s
epoch 38 | loss: 0.57827 | train_auc: 0.75766 | train_balanced_accuracy: 0.68893 | train_accuracy: 0.68877 | valid_auc: 0.74574 | valid_balanced_accuracy: 0.67833 | valid_accuracy: 0.67816 |  0:10:34s
epoch 39 | loss: 0.58178 | train_auc: 0.76214 | train_balanced_accuracy: 0.69305 | train_accuracy: 0.69313 | valid_auc: 0.74235 | valid_balanced_accuracy: 0.6771  | valid_accuracy: 0.67721 |  0:10:50s
epoch 40 | loss: 0.58315 | train_auc: 0.76652 | train_balanced_accuracy: 0.69879 | train_accuracy: 0.69888 | valid_auc: 0.74834 | valid_balanced_accuracy: 0.68408 | valid_accuracy: 0.68414 |  0:11:06s
epoch 41 | loss: 0.58217 | train_auc: 0.75849 | train_balanced_accuracy: 0.68725 | train_accuracy: 0.68704 | valid_auc: 0.74312 | valid_balanced_accuracy: 0.67636 | valid_accuracy: 0.67611 |  0:11:23s
epoch 42 | loss: 0.58212 | train_auc: 0.75653 | train_balanced_accuracy: 0.69378 | train_accuracy: 0.6942  | valid_auc: 0.74078 | valid_balanced_accuracy: 0.68593 | valid_accuracy: 0.68634 |  0:11:42s
epoch 43 | loss: 0.58595 | train_auc: 0.75637 | train_balanced_accuracy: 0.68534 | train_accuracy: 0.68542 | valid_auc: 0.74504 | valid_balanced_accuracy: 0.67603 | valid_accuracy: 0.67611 |  0:11:57s
epoch 44 | loss: 0.57931 | train_auc: 0.75735 | train_balanced_accuracy: 0.69026 | train_accuracy: 0.69006 | valid_auc: 0.74399 | valid_balanced_accuracy: 0.67395 | valid_accuracy: 0.67375 |  0:12:14s
epoch 45 | loss: 0.57973 | train_auc: 0.76511 | train_balanced_accuracy: 0.69753 | train_accuracy: 0.69786 | valid_auc: 0.74629 | valid_balanced_accuracy: 0.68666 | valid_accuracy: 0.68697 |  0:12:31s
epoch 46 | loss: 0.57756 | train_auc: 0.76631 | train_balanced_accuracy: 0.69676 | train_accuracy: 0.69671 | valid_auc: 0.74653 | valid_balanced_accuracy: 0.68138 | valid_accuracy: 0.6813  |  0:12:48s
epoch 47 | loss: 0.57936 | train_auc: 0.76511 | train_balanced_accuracy: 0.6935  | train_accuracy: 0.69408 | valid_auc: 0.74414 | valid_balanced_accuracy: 0.67917 | valid_accuracy: 0.67973 |  0:13:05s
epoch 48 | loss: 0.57335 | train_auc: 0.76589 | train_balanced_accuracy: 0.69618 | train_accuracy: 0.69624 | valid_auc: 0.74999 | valid_balanced_accuracy: 0.68499 | valid_accuracy: 0.68508 |  0:13:23s
epoch 49 | loss: 0.57989 | train_auc: 0.77063 | train_balanced_accuracy: 0.6985  | train_accuracy: 0.69888 | valid_auc: 0.75292 | valid_balanced_accuracy: 0.68722 | valid_accuracy: 0.6876  |  0:13:40s
epoch 50 | loss: 0.57591 | train_auc: 0.76653 | train_balanced_accuracy: 0.69867 | train_accuracy: 0.69864 | valid_auc: 0.74868 | valid_balanced_accuracy: 0.68243 | valid_accuracy: 0.6824  |  0:13:56s
epoch 51 | loss: 0.57276 | train_auc: 0.7658  | train_balanced_accuracy: 0.69708 | train_accuracy: 0.6975  | valid_auc: 0.74585 | valid_balanced_accuracy: 0.68373 | valid_accuracy: 0.68414 |  0:14:14s
epoch 52 | loss: 0.57512 | train_auc: 0.76013 | train_balanced_accuracy: 0.69178 | train_accuracy: 0.69203 | valid_auc: 0.7433  | valid_balanced_accuracy: 0.68535 | valid_accuracy: 0.68555 |  0:14:30s
epoch 53 | loss: 0.5796  | train_auc: 0.76536 | train_balanced_accuracy: 0.6967  | train_accuracy: 0.69703 | valid_auc: 0.74802 | valid_balanced_accuracy: 0.6846  | valid_accuracy: 0.68492 |  0:14:46s
epoch 54 | loss: 0.57129 | train_auc: 0.76586 | train_balanced_accuracy: 0.69396 | train_accuracy: 0.69416 | valid_auc: 0.75048 | valid_balanced_accuracy: 0.68395 | valid_accuracy: 0.68414 |  0:15:00s
epoch 55 | loss: 0.5764  | train_auc: 0.77013 | train_balanced_accuracy: 0.69901 | train_accuracy: 0.699   | valid_auc: 0.75012 | valid_balanced_accuracy: 0.68671 | valid_accuracy: 0.68665 |  0:15:14s
epoch 56 | loss: 0.5709  | train_auc: 0.77506 | train_balanced_accuracy: 0.70185 | train_accuracy: 0.70211 | valid_auc: 0.75322 | valid_balanced_accuracy: 0.68659 | valid_accuracy: 0.68681 |  0:15:31s
epoch 57 | loss: 0.57301 | train_auc: 0.77303 | train_balanced_accuracy: 0.70077 | train_accuracy: 0.70104 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.68183 | valid_accuracy: 0.68209 |  0:15:48s
epoch 58 | loss: 0.5747  | train_auc: 0.77482 | train_balanced_accuracy: 0.70304 | train_accuracy: 0.70336 | valid_auc: 0.74913 | valid_balanced_accuracy: 0.68477 | valid_accuracy: 0.68508 |  0:16:05s
epoch 59 | loss: 0.57385 | train_auc: 0.77284 | train_balanced_accuracy: 0.70053 | train_accuracy: 0.70033 | valid_auc: 0.75034 | valid_balanced_accuracy: 0.67992 | valid_accuracy: 0.67973 |  0:16:21s
epoch 60 | loss: 0.5735  | train_auc: 0.77629 | train_balanced_accuracy: 0.70545 | train_accuracy: 0.70557 | valid_auc: 0.75291 | valid_balanced_accuracy: 0.68716 | valid_accuracy: 0.68728 |  0:16:37s
epoch 61 | loss: 0.57091 | train_auc: 0.7738  | train_balanced_accuracy: 0.7008  | train_accuracy: 0.701   | valid_auc: 0.75255 | valid_balanced_accuracy: 0.68915 | valid_accuracy: 0.68933 |  0:16:55s
epoch 62 | loss: 0.56677 | train_auc: 0.77482 | train_balanced_accuracy: 0.70447 | train_accuracy: 0.70443 | valid_auc: 0.7531  | valid_balanced_accuracy: 0.68322 | valid_accuracy: 0.68319 |  0:17:13s
epoch 63 | loss: 0.57129 | train_auc: 0.77553 | train_balanced_accuracy: 0.7048  | train_accuracy: 0.70482 | valid_auc: 0.75131 | valid_balanced_accuracy: 0.68833 | valid_accuracy: 0.68839 |  0:17:30s
epoch 64 | loss: 0.56887 | train_auc: 0.78    | train_balanced_accuracy: 0.70608 | train_accuracy: 0.70608 | valid_auc: 0.7544  | valid_balanced_accuracy: 0.686   | valid_accuracy: 0.68602 |  0:17:48s
epoch 65 | loss: 0.56721 | train_auc: 0.7775  | train_balanced_accuracy: 0.70505 | train_accuracy: 0.70513 | valid_auc: 0.75366 | valid_balanced_accuracy: 0.68501 | valid_accuracy: 0.68508 |  0:18:04s
epoch 66 | loss: 0.56928 | train_auc: 0.77732 | train_balanced_accuracy: 0.70527 | train_accuracy: 0.70537 | valid_auc: 0.75493 | valid_balanced_accuracy: 0.6853  | valid_accuracy: 0.6854  |  0:18:19s
epoch 67 | loss: 0.56793 | train_auc: 0.77989 | train_balanced_accuracy: 0.70606 | train_accuracy: 0.70639 | valid_auc: 0.75689 | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69059 |  0:18:37s
epoch 68 | loss: 0.56818 | train_auc: 0.77467 | train_balanced_accuracy: 0.70169 | train_accuracy: 0.70214 | valid_auc: 0.74471 | valid_balanced_accuracy: 0.67773 | valid_accuracy: 0.67816 |  0:18:53s
epoch 69 | loss: 0.5687  | train_auc: 0.7701  | train_balanced_accuracy: 0.70009 | train_accuracy: 0.70045 | valid_auc: 0.74335 | valid_balanced_accuracy: 0.67905 | valid_accuracy: 0.67941 |  0:19:09s
epoch 70 | loss: 0.56361 | train_auc: 0.7687  | train_balanced_accuracy: 0.69994 | train_accuracy: 0.7003  | valid_auc: 0.73901 | valid_balanced_accuracy: 0.67576 | valid_accuracy: 0.67611 |  0:19:26s
epoch 71 | loss: 0.56949 | train_auc: 0.78206 | train_balanced_accuracy: 0.70633 | train_accuracy: 0.70663 | valid_auc: 0.75281 | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.68776 |  0:19:42s
epoch 72 | loss: 0.56206 | train_auc: 0.78262 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70872 | valid_auc: 0.75227 | valid_balanced_accuracy: 0.68732 | valid_accuracy: 0.68744 |  0:19:59s
epoch 73 | loss: 0.56138 | train_auc: 0.7816  | train_balanced_accuracy: 0.70768 | train_accuracy: 0.70777 | valid_auc: 0.75231 | valid_balanced_accuracy: 0.68545 | valid_accuracy: 0.68555 |  0:20:15s
epoch 74 | loss: 0.56402 | train_auc: 0.78507 | train_balanced_accuracy: 0.70805 | train_accuracy: 0.70836 | valid_auc: 0.75524 | valid_balanced_accuracy: 0.68872 | valid_accuracy: 0.68901 |  0:20:32s
epoch 75 | loss: 0.56888 | train_auc: 0.78479 | train_balanced_accuracy: 0.71037 | train_accuracy: 0.71053 | valid_auc: 0.756   | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68854 |  0:20:50s
epoch 76 | loss: 0.56807 | train_auc: 0.78483 | train_balanced_accuracy: 0.70846 | train_accuracy: 0.70832 | valid_auc: 0.75156 | valid_balanced_accuracy: 0.68336 | valid_accuracy: 0.68319 |  0:21:07s
epoch 77 | loss: 0.56549 | train_auc: 0.78584 | train_balanced_accuracy: 0.70679 | train_accuracy: 0.70647 | valid_auc: 0.75466 | valid_balanced_accuracy: 0.68617 | valid_accuracy: 0.68587 |  0:21:24s
epoch 78 | loss: 0.55762 | train_auc: 0.78192 | train_balanced_accuracy: 0.70763 | train_accuracy: 0.70769 | valid_auc: 0.74876 | valid_balanced_accuracy: 0.68267 | valid_accuracy: 0.68272 |  0:21:41s
epoch 79 | loss: 0.56488 | train_auc: 0.75204 | train_balanced_accuracy: 0.6788  | train_accuracy: 0.67869 | valid_auc: 0.738   | valid_balanced_accuracy: 0.66427 | valid_accuracy: 0.66415 |  0:21:58s
epoch 80 | loss: 0.56786 | train_auc: 0.7631  | train_balanced_accuracy: 0.68606 | train_accuracy: 0.68566 | valid_auc: 0.74406 | valid_balanced_accuracy: 0.67353 | valid_accuracy: 0.67312 |  0:22:13s
epoch 81 | loss: 0.55719 | train_auc: 0.75425 | train_balanced_accuracy: 0.68003 | train_accuracy: 0.67999 | valid_auc: 0.73736 | valid_balanced_accuracy: 0.66846 | valid_accuracy: 0.6684  |  0:22:29s
epoch 82 | loss: 0.56473 | train_auc: 0.76956 | train_balanced_accuracy: 0.69786 | train_accuracy: 0.69789 | valid_auc: 0.74718 | valid_balanced_accuracy: 0.67894 | valid_accuracy: 0.67894 |  0:22:46s
epoch 83 | loss: 0.56105 | train_auc: 0.75658 | train_balanced_accuracy: 0.68499 | train_accuracy: 0.68507 | valid_auc: 0.74015 | valid_balanced_accuracy: 0.67416 | valid_accuracy: 0.67422 |  0:23:02s
epoch 84 | loss: 0.56297 | train_auc: 0.763   | train_balanced_accuracy: 0.6886  | train_accuracy: 0.68857 | valid_auc: 0.73974 | valid_balanced_accuracy: 0.6785  | valid_accuracy: 0.67847 |  0:23:19s
epoch 85 | loss: 0.56261 | train_auc: 0.78803 | train_balanced_accuracy: 0.71073 | train_accuracy: 0.711   | valid_auc: 0.75594 | valid_balanced_accuracy: 0.68293 | valid_accuracy: 0.68319 |  0:23:34s
epoch 86 | loss: 0.56333 | train_auc: 0.77713 | train_balanced_accuracy: 0.70193 | train_accuracy: 0.70207 | valid_auc: 0.74459 | valid_balanced_accuracy: 0.68292 | valid_accuracy: 0.68303 |  0:23:51s
epoch 87 | loss: 0.55702 | train_auc: 0.78475 | train_balanced_accuracy: 0.71142 | train_accuracy: 0.71139 | valid_auc: 0.74961 | valid_balanced_accuracy: 0.68311 | valid_accuracy: 0.68303 |  0:24:07s

Early stopping occurred at epoch 87 with best_epoch = 67 and best_valid_accuracy = 0.69059
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 56/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=24.2min
[CV 2/5; 56/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71088 | train_auc: 0.56131 | train_balanced_accuracy: 0.53165 | train_accuracy: 0.52953 | valid_auc: 0.5742  | valid_balanced_accuracy: 0.53915 | valid_accuracy: 0.53698 |  0:00:16s
epoch 1  | loss: 0.65897 | train_auc: 0.57572 | train_balanced_accuracy: 0.53736 | train_accuracy: 0.53488 | valid_auc: 0.59091 | valid_balanced_accuracy: 0.54043 | valid_accuracy: 0.53793 |  0:00:34s
epoch 2  | loss: 0.6411  | train_auc: 0.63459 | train_balanced_accuracy: 0.53472 | train_accuracy: 0.53177 | valid_auc: 0.63845 | valid_balanced_accuracy: 0.53712 | valid_accuracy: 0.53415 |  0:00:50s
epoch 3  | loss: 0.63353 | train_auc: 0.64099 | train_balanced_accuracy: 0.53744 | train_accuracy: 0.53457 | valid_auc: 0.64409 | valid_balanced_accuracy: 0.54207 | valid_accuracy: 0.53919 |  0:01:06s
epoch 4  | loss: 0.62579 | train_auc: 0.65283 | train_balanced_accuracy: 0.53556 | train_accuracy: 0.53252 | valid_auc: 0.65591 | valid_balanced_accuracy: 0.53548 | valid_accuracy: 0.53242 |  0:01:22s
epoch 5  | loss: 0.62251 | train_auc: 0.67286 | train_balanced_accuracy: 0.57695 | train_accuracy: 0.57482 | valid_auc: 0.67042 | valid_balanced_accuracy: 0.56965 | valid_accuracy: 0.56752 |  0:01:40s
epoch 6  | loss: 0.61844 | train_auc: 0.67734 | train_balanced_accuracy: 0.56545 | train_accuracy: 0.56305 | valid_auc: 0.68349 | valid_balanced_accuracy: 0.56683 | valid_accuracy: 0.56437 |  0:01:57s
epoch 7  | loss: 0.61479 | train_auc: 0.68377 | train_balanced_accuracy: 0.58743 | train_accuracy: 0.58552 | valid_auc: 0.68849 | valid_balanced_accuracy: 0.58868 | valid_accuracy: 0.58672 |  0:02:14s
epoch 8  | loss: 0.60412 | train_auc: 0.68781 | train_balanced_accuracy: 0.61937 | train_accuracy: 0.61857 | valid_auc: 0.69331 | valid_balanced_accuracy: 0.61888 | valid_accuracy: 0.61804 |  0:02:32s
epoch 9  | loss: 0.61013 | train_auc: 0.69531 | train_balanced_accuracy: 0.59955 | train_accuracy: 0.59772 | valid_auc: 0.69045 | valid_balanced_accuracy: 0.58613 | valid_accuracy: 0.5842  |  0:02:48s
epoch 10 | loss: 0.6018  | train_auc: 0.70399 | train_balanced_accuracy: 0.62785 | train_accuracy: 0.62672 | valid_auc: 0.70068 | valid_balanced_accuracy: 0.62141 | valid_accuracy: 0.62024 |  0:03:06s
epoch 11 | loss: 0.60544 | train_auc: 0.71421 | train_balanced_accuracy: 0.64605 | train_accuracy: 0.64533 | valid_auc: 0.71199 | valid_balanced_accuracy: 0.64303 | valid_accuracy: 0.64227 |  0:03:23s
epoch 12 | loss: 0.60376 | train_auc: 0.71585 | train_balanced_accuracy: 0.65653 | train_accuracy: 0.65623 | valid_auc: 0.71149 | valid_balanced_accuracy: 0.65706 | valid_accuracy: 0.65675 |  0:03:40s
epoch 13 | loss: 0.59889 | train_auc: 0.72148 | train_balanced_accuracy: 0.66301 | train_accuracy: 0.66311 | valid_auc: 0.71643 | valid_balanced_accuracy: 0.66007 | valid_accuracy: 0.66021 |  0:03:57s
epoch 14 | loss: 0.59892 | train_auc: 0.72157 | train_balanced_accuracy: 0.65766 | train_accuracy: 0.65721 | valid_auc: 0.71766 | valid_balanced_accuracy: 0.65644 | valid_accuracy: 0.65596 |  0:04:15s
epoch 15 | loss: 0.59774 | train_auc: 0.72363 | train_balanced_accuracy: 0.66366 | train_accuracy: 0.66366 | valid_auc: 0.72126 | valid_balanced_accuracy: 0.66267 | valid_accuracy: 0.66273 |  0:04:34s
epoch 16 | loss: 0.596   | train_auc: 0.71952 | train_balanced_accuracy: 0.65878 | train_accuracy: 0.65902 | valid_auc: 0.71758 | valid_balanced_accuracy: 0.66295 | valid_accuracy: 0.6632  |  0:04:52s
epoch 17 | loss: 0.5959  | train_auc: 0.72185 | train_balanced_accuracy: 0.65295 | train_accuracy: 0.65272 | valid_auc: 0.71606 | valid_balanced_accuracy: 0.64721 | valid_accuracy: 0.64699 |  0:05:12s
epoch 18 | loss: 0.59622 | train_auc: 0.72824 | train_balanced_accuracy: 0.66575 | train_accuracy: 0.66598 | valid_auc: 0.7258  | valid_balanced_accuracy: 0.66153 | valid_accuracy: 0.66179 |  0:05:30s
epoch 19 | loss: 0.59507 | train_auc: 0.72353 | train_balanced_accuracy: 0.65461 | train_accuracy: 0.65446 | valid_auc: 0.72209 | valid_balanced_accuracy: 0.65236 | valid_accuracy: 0.65219 |  0:05:45s
epoch 20 | loss: 0.59314 | train_auc: 0.71816 | train_balanced_accuracy: 0.65485 | train_accuracy: 0.65501 | valid_auc: 0.71777 | valid_balanced_accuracy: 0.65534 | valid_accuracy: 0.65549 |  0:06:00s
epoch 21 | loss: 0.59473 | train_auc: 0.72845 | train_balanced_accuracy: 0.66045 | train_accuracy: 0.6604  | valid_auc: 0.72791 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.66289 |  0:06:17s
epoch 22 | loss: 0.59706 | train_auc: 0.73997 | train_balanced_accuracy: 0.67796 | train_accuracy: 0.6781  | valid_auc: 0.73376 | valid_balanced_accuracy: 0.67565 | valid_accuracy: 0.67579 |  0:06:33s
epoch 23 | loss: 0.59007 | train_auc: 0.73117 | train_balanced_accuracy: 0.67128 | train_accuracy: 0.67169 | valid_auc: 0.72637 | valid_balanced_accuracy: 0.66422 | valid_accuracy: 0.66462 |  0:06:49s
epoch 24 | loss: 0.59458 | train_auc: 0.74188 | train_balanced_accuracy: 0.67616 | train_accuracy: 0.67645 | valid_auc: 0.73515 | valid_balanced_accuracy: 0.67408 | valid_accuracy: 0.67438 |  0:07:07s
epoch 25 | loss: 0.58569 | train_auc: 0.75845 | train_balanced_accuracy: 0.68622 | train_accuracy: 0.68589 | valid_auc: 0.74719 | valid_balanced_accuracy: 0.68149 | valid_accuracy: 0.68115 |  0:07:25s
epoch 26 | loss: 0.58702 | train_auc: 0.75754 | train_balanced_accuracy: 0.68872 | train_accuracy: 0.68904 | valid_auc: 0.74648 | valid_balanced_accuracy: 0.68694 | valid_accuracy: 0.68728 |  0:07:41s
epoch 27 | loss: 0.59153 | train_auc: 0.74647 | train_balanced_accuracy: 0.68194 | train_accuracy: 0.68212 | valid_auc: 0.73656 | valid_balanced_accuracy: 0.67988 | valid_accuracy: 0.68004 |  0:07:56s
epoch 28 | loss: 0.58584 | train_auc: 0.76101 | train_balanced_accuracy: 0.69333 | train_accuracy: 0.69372 | valid_auc: 0.74797 | valid_balanced_accuracy: 0.68565 | valid_accuracy: 0.68602 |  0:08:12s
epoch 29 | loss: 0.58724 | train_auc: 0.76023 | train_balanced_accuracy: 0.69317 | train_accuracy: 0.69337 | valid_auc: 0.7488  | valid_balanced_accuracy: 0.68299 | valid_accuracy: 0.68319 |  0:08:30s
epoch 30 | loss: 0.58327 | train_auc: 0.75855 | train_balanced_accuracy: 0.69088 | train_accuracy: 0.69113 | valid_auc: 0.74561 | valid_balanced_accuracy: 0.67936 | valid_accuracy: 0.67957 |  0:08:48s
epoch 31 | loss: 0.5896  | train_auc: 0.76306 | train_balanced_accuracy: 0.69572 | train_accuracy: 0.69593 | valid_auc: 0.7477  | valid_balanced_accuracy: 0.68413 | valid_accuracy: 0.68429 |  0:09:03s
epoch 32 | loss: 0.58634 | train_auc: 0.76227 | train_balanced_accuracy: 0.69516 | train_accuracy: 0.69542 | valid_auc: 0.74762 | valid_balanced_accuracy: 0.68658 | valid_accuracy: 0.68681 |  0:09:19s
epoch 33 | loss: 0.58466 | train_auc: 0.75776 | train_balanced_accuracy: 0.69376 | train_accuracy: 0.69396 | valid_auc: 0.74278 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68445 |  0:09:35s
epoch 34 | loss: 0.58066 | train_auc: 0.71374 | train_balanced_accuracy: 0.66249 | train_accuracy: 0.66319 | valid_auc: 0.71205 | valid_balanced_accuracy: 0.66315 | valid_accuracy: 0.66383 |  0:09:51s
epoch 35 | loss: 0.58133 | train_auc: 0.7406  | train_balanced_accuracy: 0.67833 | train_accuracy: 0.67881 | valid_auc: 0.73377 | valid_balanced_accuracy: 0.66966 | valid_accuracy: 0.67013 |  0:10:08s
epoch 36 | loss: 0.57954 | train_auc: 0.73428 | train_balanced_accuracy: 0.66648 | train_accuracy: 0.66646 | valid_auc: 0.7256  | valid_balanced_accuracy: 0.65676 | valid_accuracy: 0.65675 |  0:10:25s
epoch 37 | loss: 0.58302 | train_auc: 0.74178 | train_balanced_accuracy: 0.67457 | train_accuracy: 0.6746  | valid_auc: 0.737   | valid_balanced_accuracy: 0.66823 | valid_accuracy: 0.66824 |  0:10:43s
epoch 38 | loss: 0.58052 | train_auc: 0.76345 | train_balanced_accuracy: 0.69733 | train_accuracy: 0.69746 | valid_auc: 0.74881 | valid_balanced_accuracy: 0.68375 | valid_accuracy: 0.68382 |  0:11:01s
epoch 39 | loss: 0.58141 | train_auc: 0.72161 | train_balanced_accuracy: 0.65813 | train_accuracy: 0.65776 | valid_auc: 0.71947 | valid_balanced_accuracy: 0.65318 | valid_accuracy: 0.65282 |  0:11:18s
epoch 40 | loss: 0.58561 | train_auc: 0.72619 | train_balanced_accuracy: 0.66441 | train_accuracy: 0.66437 | valid_auc: 0.72034 | valid_balanced_accuracy: 0.65869 | valid_accuracy: 0.65864 |  0:11:33s
epoch 41 | loss: 0.58179 | train_auc: 0.73459 | train_balanced_accuracy: 0.66602 | train_accuracy: 0.66587 | valid_auc: 0.72157 | valid_balanced_accuracy: 0.65371 | valid_accuracy: 0.6536  |  0:11:48s
epoch 42 | loss: 0.57647 | train_auc: 0.76774 | train_balanced_accuracy: 0.69907 | train_accuracy: 0.69935 | valid_auc: 0.75109 | valid_balanced_accuracy: 0.68812 | valid_accuracy: 0.68839 |  0:12:07s
epoch 43 | loss: 0.58503 | train_auc: 0.75987 | train_balanced_accuracy: 0.69317 | train_accuracy: 0.69353 | valid_auc: 0.74726 | valid_balanced_accuracy: 0.68776 | valid_accuracy: 0.68807 |  0:12:23s
epoch 44 | loss: 0.57892 | train_auc: 0.74044 | train_balanced_accuracy: 0.68279 | train_accuracy: 0.6833  | valid_auc: 0.73188 | valid_balanced_accuracy: 0.68196 | valid_accuracy: 0.6824  |  0:12:39s
epoch 45 | loss: 0.57686 | train_auc: 0.75855 | train_balanced_accuracy: 0.69056 | train_accuracy: 0.69132 | valid_auc: 0.74401 | valid_balanced_accuracy: 0.68327 | valid_accuracy: 0.68398 |  0:12:56s
epoch 46 | loss: 0.57447 | train_auc: 0.70247 | train_balanced_accuracy: 0.6591  | train_accuracy: 0.6602  | valid_auc: 0.70355 | valid_balanced_accuracy: 0.66939 | valid_accuracy: 0.67044 |  0:13:12s
epoch 47 | loss: 0.57836 | train_auc: 0.71954 | train_balanced_accuracy: 0.66055 | train_accuracy: 0.66059 | valid_auc: 0.71639 | valid_balanced_accuracy: 0.66159 | valid_accuracy: 0.66163 |  0:13:31s
epoch 48 | loss: 0.57449 | train_auc: 0.72102 | train_balanced_accuracy: 0.6608  | train_accuracy: 0.66055 | valid_auc: 0.71575 | valid_balanced_accuracy: 0.65794 | valid_accuracy: 0.6577  |  0:13:46s
epoch 49 | loss: 0.57543 | train_auc: 0.72475 | train_balanced_accuracy: 0.66404 | train_accuracy: 0.66386 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.66309 | valid_accuracy: 0.66289 |  0:14:03s
epoch 50 | loss: 0.57304 | train_auc: 0.73686 | train_balanced_accuracy: 0.67367 | train_accuracy: 0.6737  | valid_auc: 0.72777 | valid_balanced_accuracy: 0.66616 | valid_accuracy: 0.66619 |  0:14:21s
epoch 51 | loss: 0.57463 | train_auc: 0.7526  | train_balanced_accuracy: 0.6847  | train_accuracy: 0.68452 | valid_auc: 0.73749 | valid_balanced_accuracy: 0.66924 | valid_accuracy: 0.66903 |  0:14:38s
epoch 52 | loss: 0.5729  | train_auc: 0.73718 | train_balanced_accuracy: 0.67534 | train_accuracy: 0.67543 | valid_auc: 0.73119 | valid_balanced_accuracy: 0.67022 | valid_accuracy: 0.67029 |  0:14:55s
epoch 53 | loss: 0.57552 | train_auc: 0.74516 | train_balanced_accuracy: 0.68182 | train_accuracy: 0.682   | valid_auc: 0.73278 | valid_balanced_accuracy: 0.6714  | valid_accuracy: 0.67155 |  0:15:13s
epoch 54 | loss: 0.57672 | train_auc: 0.76022 | train_balanced_accuracy: 0.69306 | train_accuracy: 0.69325 | valid_auc: 0.74173 | valid_balanced_accuracy: 0.67941 | valid_accuracy: 0.67957 |  0:15:31s
epoch 55 | loss: 0.57616 | train_auc: 0.77581 | train_balanced_accuracy: 0.70399 | train_accuracy: 0.70423 | valid_auc: 0.75204 | valid_balanced_accuracy: 0.68663 | valid_accuracy: 0.68681 |  0:15:48s
epoch 56 | loss: 0.57293 | train_auc: 0.72894 | train_balanced_accuracy: 0.67569 | train_accuracy: 0.67621 | valid_auc: 0.71989 | valid_balanced_accuracy: 0.67498 | valid_accuracy: 0.67548 |  0:16:04s
epoch 57 | loss: 0.57363 | train_auc: 0.72362 | train_balanced_accuracy: 0.67499 | train_accuracy: 0.67574 | valid_auc: 0.71584 | valid_balanced_accuracy: 0.66941 | valid_accuracy: 0.67013 |  0:16:21s
epoch 58 | loss: 0.57255 | train_auc: 0.77281 | train_balanced_accuracy: 0.70255 | train_accuracy: 0.70289 | valid_auc: 0.75302 | valid_balanced_accuracy: 0.68665 | valid_accuracy: 0.68697 |  0:16:39s
epoch 59 | loss: 0.57363 | train_auc: 0.77537 | train_balanced_accuracy: 0.70211 | train_accuracy: 0.70246 | valid_auc: 0.75185 | valid_balanced_accuracy: 0.68572 | valid_accuracy: 0.68602 |  0:16:57s
epoch 60 | loss: 0.57064 | train_auc: 0.77911 | train_balanced_accuracy: 0.70703 | train_accuracy: 0.70714 | valid_auc: 0.75492 | valid_balanced_accuracy: 0.68862 | valid_accuracy: 0.6887  |  0:17:13s
epoch 61 | loss: 0.56535 | train_auc: 0.77675 | train_balanced_accuracy: 0.70506 | train_accuracy: 0.70533 | valid_auc: 0.74848 | valid_balanced_accuracy: 0.68265 | valid_accuracy: 0.68288 |  0:17:29s
epoch 62 | loss: 0.56651 | train_auc: 0.77171 | train_balanced_accuracy: 0.70068 | train_accuracy: 0.70085 | valid_auc: 0.74539 | valid_balanced_accuracy: 0.68354 | valid_accuracy: 0.68366 |  0:17:45s
epoch 63 | loss: 0.57105 | train_auc: 0.74493 | train_balanced_accuracy: 0.68381 | train_accuracy: 0.68436 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.68002 | valid_accuracy: 0.68052 |  0:18:02s
epoch 64 | loss: 0.56966 | train_auc: 0.71962 | train_balanced_accuracy: 0.67303 | train_accuracy: 0.67358 | valid_auc: 0.71509 | valid_balanced_accuracy: 0.66569 | valid_accuracy: 0.66619 |  0:18:16s
epoch 65 | loss: 0.56588 | train_auc: 0.73444 | train_balanced_accuracy: 0.68176 | train_accuracy: 0.68208 | valid_auc: 0.72132 | valid_balanced_accuracy: 0.67408 | valid_accuracy: 0.67438 |  0:18:33s
epoch 66 | loss: 0.56924 | train_auc: 0.72996 | train_balanced_accuracy: 0.68026 | train_accuracy: 0.68039 | valid_auc: 0.71887 | valid_balanced_accuracy: 0.67759 | valid_accuracy: 0.67768 |  0:18:48s
epoch 67 | loss: 0.5628  | train_auc: 0.78194 | train_balanced_accuracy: 0.70506 | train_accuracy: 0.70576 | valid_auc: 0.75297 | valid_balanced_accuracy: 0.68454 | valid_accuracy: 0.68524 |  0:19:06s
epoch 68 | loss: 0.56745 | train_auc: 0.78389 | train_balanced_accuracy: 0.70916 | train_accuracy: 0.70946 | valid_auc: 0.7575  | valid_balanced_accuracy: 0.68794 | valid_accuracy: 0.68823 |  0:19:22s
epoch 69 | loss: 0.56737 | train_auc: 0.74376 | train_balanced_accuracy: 0.67331 | train_accuracy: 0.67322 | valid_auc: 0.73086 | valid_balanced_accuracy: 0.66487 | valid_accuracy: 0.66478 |  0:19:39s
epoch 70 | loss: 0.56969 | train_auc: 0.73308 | train_balanced_accuracy: 0.66988 | train_accuracy: 0.67008 | valid_auc: 0.72582 | valid_balanced_accuracy: 0.66156 | valid_accuracy: 0.66179 |  0:19:53s
epoch 71 | loss: 0.56662 | train_auc: 0.74443 | train_balanced_accuracy: 0.6748  | train_accuracy: 0.67503 | valid_auc: 0.72786 | valid_balanced_accuracy: 0.66218 | valid_accuracy: 0.66242 |  0:20:10s
epoch 72 | loss: 0.56017 | train_auc: 0.75074 | train_balanced_accuracy: 0.68193 | train_accuracy: 0.68212 | valid_auc: 0.73148 | valid_balanced_accuracy: 0.66853 | valid_accuracy: 0.66871 |  0:20:27s
epoch 73 | loss: 0.56535 | train_auc: 0.76105 | train_balanced_accuracy: 0.69077 | train_accuracy: 0.69097 | valid_auc: 0.7377  | valid_balanced_accuracy: 0.67218 | valid_accuracy: 0.67233 |  0:20:46s
epoch 74 | loss: 0.56541 | train_auc: 0.78313 | train_balanced_accuracy: 0.70872 | train_accuracy: 0.70923 | valid_auc: 0.7512  | valid_balanced_accuracy: 0.68853 | valid_accuracy: 0.68901 |  0:21:03s
epoch 75 | loss: 0.56632 | train_auc: 0.78373 | train_balanced_accuracy: 0.70959 | train_accuracy: 0.70978 | valid_auc: 0.75484 | valid_balanced_accuracy: 0.692   | valid_accuracy: 0.69216 |  0:21:21s
epoch 76 | loss: 0.56701 | train_auc: 0.78591 | train_balanced_accuracy: 0.71052 | train_accuracy: 0.71033 | valid_auc: 0.75445 | valid_balanced_accuracy: 0.68451 | valid_accuracy: 0.68429 |  0:21:36s
epoch 77 | loss: 0.56404 | train_auc: 0.7804  | train_balanced_accuracy: 0.70658 | train_accuracy: 0.70651 | valid_auc: 0.75397 | valid_balanced_accuracy: 0.68596 | valid_accuracy: 0.68587 |  0:21:54s
epoch 78 | loss: 0.55715 | train_auc: 0.78367 | train_balanced_accuracy: 0.70815 | train_accuracy: 0.70801 | valid_auc: 0.75345 | valid_balanced_accuracy: 0.68492 | valid_accuracy: 0.68477 |  0:22:12s
epoch 79 | loss: 0.55983 | train_auc: 0.78839 | train_balanced_accuracy: 0.71426 | train_accuracy: 0.7143  | valid_auc: 0.75583 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68839 |  0:22:28s
epoch 80 | loss: 0.56226 | train_auc: 0.7883  | train_balanced_accuracy: 0.71402 | train_accuracy: 0.71407 | valid_auc: 0.7565  | valid_balanced_accuracy: 0.68778 | valid_accuracy: 0.68776 |  0:22:47s
epoch 81 | loss: 0.55829 | train_auc: 0.78936 | train_balanced_accuracy: 0.71549 | train_accuracy: 0.71556 | valid_auc: 0.75645 | valid_balanced_accuracy: 0.68885 | valid_accuracy: 0.68886 |  0:23:05s
epoch 82 | loss: 0.56546 | train_auc: 0.78441 | train_balanced_accuracy: 0.70848 | train_accuracy: 0.70868 | valid_auc: 0.75326 | valid_balanced_accuracy: 0.68777 | valid_accuracy: 0.68791 |  0:23:23s
epoch 83 | loss: 0.56327 | train_auc: 0.77416 | train_balanced_accuracy: 0.69754 | train_accuracy: 0.69758 | valid_auc: 0.74705 | valid_balanced_accuracy: 0.67424 | valid_accuracy: 0.67422 |  0:23:42s
epoch 84 | loss: 0.56565 | train_auc: 0.78305 | train_balanced_accuracy: 0.70854 | train_accuracy: 0.70864 | valid_auc: 0.75605 | valid_balanced_accuracy: 0.68109 | valid_accuracy: 0.68115 |  0:23:58s
epoch 85 | loss: 0.56188 | train_auc: 0.77886 | train_balanced_accuracy: 0.70338 | train_accuracy: 0.70364 | valid_auc: 0.75055 | valid_balanced_accuracy: 0.68324 | valid_accuracy: 0.68351 |  0:24:16s
epoch 86 | loss: 0.56161 | train_auc: 0.78525 | train_balanced_accuracy: 0.70874 | train_accuracy: 0.70868 | valid_auc: 0.7555  | valid_balanced_accuracy: 0.68801 | valid_accuracy: 0.68791 |  0:24:30s
epoch 87 | loss: 0.55601 | train_auc: 0.79213 | train_balanced_accuracy: 0.71501 | train_accuracy: 0.71505 | valid_auc: 0.7585  | valid_balanced_accuracy: 0.69407 | valid_accuracy: 0.69405 |  0:24:47s
epoch 88 | loss: 0.55614 | train_auc: 0.76223 | train_balanced_accuracy: 0.69202 | train_accuracy: 0.6925  | valid_auc: 0.74358 | valid_balanced_accuracy: 0.68057 | valid_accuracy: 0.68099 |  0:25:04s
epoch 89 | loss: 0.56688 | train_auc: 0.77933 | train_balanced_accuracy: 0.70577 | train_accuracy: 0.70608 | valid_auc: 0.75084 | valid_balanced_accuracy: 0.68545 | valid_accuracy: 0.68571 |  0:25:20s
epoch 90 | loss: 0.56385 | train_auc: 0.76674 | train_balanced_accuracy: 0.69261 | train_accuracy: 0.69278 | valid_auc: 0.74176 | valid_balanced_accuracy: 0.67139 | valid_accuracy: 0.67155 |  0:25:36s
epoch 91 | loss: 0.55336 | train_auc: 0.77157 | train_balanced_accuracy: 0.69996 | train_accuracy: 0.70002 | valid_auc: 0.74212 | valid_balanced_accuracy: 0.68089 | valid_accuracy: 0.68099 |  0:25:53s
epoch 92 | loss: 0.55803 | train_auc: 0.7777  | train_balanced_accuracy: 0.70494 | train_accuracy: 0.7051  | valid_auc: 0.74833 | valid_balanced_accuracy: 0.68619 | valid_accuracy: 0.68634 |  0:26:09s
epoch 93 | loss: 0.55479 | train_auc: 0.79016 | train_balanced_accuracy: 0.71658 | train_accuracy: 0.71682 | valid_auc: 0.7566  | valid_balanced_accuracy: 0.68958 | valid_accuracy: 0.6898  |  0:26:27s
epoch 94 | loss: 0.55376 | train_auc: 0.79516 | train_balanced_accuracy: 0.71957 | train_accuracy: 0.71985 | valid_auc: 0.7581  | valid_balanced_accuracy: 0.69345 | valid_accuracy: 0.69374 |  0:26:42s
epoch 95 | loss: 0.5579  | train_auc: 0.70958 | train_balanced_accuracy: 0.66603 | train_accuracy: 0.66642 | valid_auc: 0.70558 | valid_balanced_accuracy: 0.66574 | valid_accuracy: 0.66604 |  0:26:59s
epoch 96 | loss: 0.5557  | train_auc: 0.76439 | train_balanced_accuracy: 0.70027 | train_accuracy: 0.70053 | valid_auc: 0.73967 | valid_balanced_accuracy: 0.6806  | valid_accuracy: 0.68083 |  0:27:15s
epoch 97 | loss: 0.55159 | train_auc: 0.78378 | train_balanced_accuracy: 0.71106 | train_accuracy: 0.71143 | valid_auc: 0.75698 | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.69012 |  0:27:31s
epoch 98 | loss: 0.55465 | train_auc: 0.74143 | train_balanced_accuracy: 0.687   | train_accuracy: 0.68727 | valid_auc: 0.72934 | valid_balanced_accuracy: 0.68482 | valid_accuracy: 0.68508 |  0:27:49s
epoch 99 | loss: 0.54966 | train_auc: 0.72586 | train_balanced_accuracy: 0.67606 | train_accuracy: 0.6761  | valid_auc: 0.72079 | valid_balanced_accuracy: 0.67045 | valid_accuracy: 0.67044 |  0:28:05s
epoch 100| loss: 0.55507 | train_auc: 0.79775 | train_balanced_accuracy: 0.71908 | train_accuracy: 0.71918 | valid_auc: 0.76008 | valid_balanced_accuracy: 0.68987 | valid_accuracy: 0.68996 |  0:28:22s
epoch 101| loss: 0.55101 | train_auc: 0.79735 | train_balanced_accuracy: 0.71844 | train_accuracy: 0.71839 | valid_auc: 0.7593  | valid_balanced_accuracy: 0.68894 | valid_accuracy: 0.68886 |  0:28:40s
epoch 102| loss: 0.54955 | train_auc: 0.79168 | train_balanced_accuracy: 0.71613 | train_accuracy: 0.71615 | valid_auc: 0.75665 | valid_balanced_accuracy: 0.68431 | valid_accuracy: 0.68429 |  0:28:56s
epoch 103| loss: 0.55558 | train_auc: 0.75754 | train_balanced_accuracy: 0.68816 | train_accuracy: 0.68833 | valid_auc: 0.73769 | valid_balanced_accuracy: 0.66896 | valid_accuracy: 0.66918 |  0:29:12s
epoch 104| loss: 0.55372 | train_auc: 0.75322 | train_balanced_accuracy: 0.68275 | train_accuracy: 0.68271 | valid_auc: 0.73209 | valid_balanced_accuracy: 0.66419 | valid_accuracy: 0.66415 |  0:29:27s
epoch 105| loss: 0.55423 | train_auc: 0.76009 | train_balanced_accuracy: 0.68876 | train_accuracy: 0.68896 | valid_auc: 0.72894 | valid_balanced_accuracy: 0.66393 | valid_accuracy: 0.66415 |  0:29:42s
epoch 106| loss: 0.55284 | train_auc: 0.77041 | train_balanced_accuracy: 0.69496 | train_accuracy: 0.69526 | valid_auc: 0.74078 | valid_balanced_accuracy: 0.67097 | valid_accuracy: 0.67123 |  0:30:00s
epoch 107| loss: 0.55088 | train_auc: 0.78468 | train_balanced_accuracy: 0.71027 | train_accuracy: 0.71041 | valid_auc: 0.74742 | valid_balanced_accuracy: 0.6765  | valid_accuracy: 0.67658 |  0:30:16s

Early stopping occurred at epoch 107 with best_epoch = 87 and best_valid_accuracy = 0.69405
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 56/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=30.4min
[CV 3/5; 56/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.72152 | train_auc: 0.55288 | train_balanced_accuracy: 0.52716 | train_accuracy: 0.52734 | valid_auc: 0.55359 | valid_balanced_accuracy: 0.52532 | valid_accuracy: 0.5255  |  0:00:15s
epoch 1  | loss: 0.66928 | train_auc: 0.53749 | train_balanced_accuracy: 0.51742 | train_accuracy: 0.51562 | valid_auc: 0.54165 | valid_balanced_accuracy: 0.51742 | valid_accuracy: 0.51558 |  0:00:31s
epoch 2  | loss: 0.64925 | train_auc: 0.63129 | train_balanced_accuracy: 0.53652 | train_accuracy: 0.53376 | valid_auc: 0.62637 | valid_balanced_accuracy: 0.53695 | valid_accuracy: 0.53415 |  0:00:47s
epoch 3  | loss: 0.63883 | train_auc: 0.62298 | train_balanced_accuracy: 0.54032 | train_accuracy: 0.53801 | valid_auc: 0.62827 | valid_balanced_accuracy: 0.5439  | valid_accuracy: 0.54155 |  0:01:04s
epoch 4  | loss: 0.62709 | train_auc: 0.64334 | train_balanced_accuracy: 0.56248 | train_accuracy: 0.56012 | valid_auc: 0.63898 | valid_balanced_accuracy: 0.5595  | valid_accuracy: 0.55713 |  0:01:21s
epoch 5  | loss: 0.62151 | train_auc: 0.67365 | train_balanced_accuracy: 0.5902  | train_accuracy: 0.58829 | valid_auc: 0.66706 | valid_balanced_accuracy: 0.58894 | valid_accuracy: 0.58703 |  0:01:37s
epoch 6  | loss: 0.62058 | train_auc: 0.69077 | train_balanced_accuracy: 0.62632 | train_accuracy: 0.62539 | valid_auc: 0.68522 | valid_balanced_accuracy: 0.61991 | valid_accuracy: 0.61898 |  0:01:54s
epoch 7  | loss: 0.62021 | train_auc: 0.68694 | train_balanced_accuracy: 0.63224 | train_accuracy: 0.63204 | valid_auc: 0.67872 | valid_balanced_accuracy: 0.62815 | valid_accuracy: 0.62795 |  0:02:11s
epoch 8  | loss: 0.61296 | train_auc: 0.69547 | train_balanced_accuracy: 0.63142 | train_accuracy: 0.63192 | valid_auc: 0.6894  | valid_balanced_accuracy: 0.6309  | valid_accuracy: 0.63141 |  0:02:27s
epoch 9  | loss: 0.61319 | train_auc: 0.69322 | train_balanced_accuracy: 0.63535 | train_accuracy: 0.63515 | valid_auc: 0.68883 | valid_balanced_accuracy: 0.63398 | valid_accuracy: 0.63377 |  0:02:45s
epoch 10 | loss: 0.60517 | train_auc: 0.70067 | train_balanced_accuracy: 0.63775 | train_accuracy: 0.63743 | valid_auc: 0.69426 | valid_balanced_accuracy: 0.63634 | valid_accuracy: 0.63598 |  0:03:00s
epoch 11 | loss: 0.60709 | train_auc: 0.70843 | train_balanced_accuracy: 0.64793 | train_accuracy: 0.64806 | valid_auc: 0.70302 | valid_balanced_accuracy: 0.64107 | valid_accuracy: 0.64117 |  0:03:17s
epoch 12 | loss: 0.60511 | train_auc: 0.71457 | train_balanced_accuracy: 0.65276 | train_accuracy: 0.65317 | valid_auc: 0.709   | valid_balanced_accuracy: 0.64848 | valid_accuracy: 0.64888 |  0:03:34s
epoch 13 | loss: 0.60159 | train_auc: 0.71549 | train_balanced_accuracy: 0.65315 | train_accuracy: 0.65325 | valid_auc: 0.70796 | valid_balanced_accuracy: 0.6524  | valid_accuracy: 0.6525  |  0:03:50s
epoch 14 | loss: 0.59913 | train_auc: 0.72481 | train_balanced_accuracy: 0.66047 | train_accuracy: 0.66061 | valid_auc: 0.71695 | valid_balanced_accuracy: 0.65286 | valid_accuracy: 0.65297 |  0:04:08s
epoch 15 | loss: 0.60062 | train_auc: 0.72462 | train_balanced_accuracy: 0.65902 | train_accuracy: 0.65919 | valid_auc: 0.71685 | valid_balanced_accuracy: 0.65599 | valid_accuracy: 0.65612 |  0:04:25s
epoch 16 | loss: 0.5963  | train_auc: 0.7262  | train_balanced_accuracy: 0.66434 | train_accuracy: 0.66446 | valid_auc: 0.71893 | valid_balanced_accuracy: 0.662   | valid_accuracy: 0.6621  |  0:04:41s
epoch 17 | loss: 0.59382 | train_auc: 0.73158 | train_balanced_accuracy: 0.66797 | train_accuracy: 0.66828 | valid_auc: 0.72412 | valid_balanced_accuracy: 0.66561 | valid_accuracy: 0.66588 |  0:05:01s
epoch 18 | loss: 0.60048 | train_auc: 0.73676 | train_balanced_accuracy: 0.67195 | train_accuracy: 0.67261 | valid_auc: 0.72635 | valid_balanced_accuracy: 0.67419 | valid_accuracy: 0.67485 |  0:05:20s
epoch 19 | loss: 0.59525 | train_auc: 0.73933 | train_balanced_accuracy: 0.67414 | train_accuracy: 0.67446 | valid_auc: 0.72919 | valid_balanced_accuracy: 0.67436 | valid_accuracy: 0.67469 |  0:05:36s
epoch 20 | loss: 0.59528 | train_auc: 0.74608 | train_balanced_accuracy: 0.68241 | train_accuracy: 0.68307 | valid_auc: 0.73346 | valid_balanced_accuracy: 0.67684 | valid_accuracy: 0.67753 |  0:05:54s
epoch 21 | loss: 0.5892  | train_auc: 0.74801 | train_balanced_accuracy: 0.68269 | train_accuracy: 0.68296 | valid_auc: 0.73547 | valid_balanced_accuracy: 0.67508 | valid_accuracy: 0.67532 |  0:06:12s
epoch 22 | loss: 0.59643 | train_auc: 0.75076 | train_balanced_accuracy: 0.6864  | train_accuracy: 0.68677 | valid_auc: 0.73717 | valid_balanced_accuracy: 0.67901 | valid_accuracy: 0.67941 |  0:06:27s
epoch 23 | loss: 0.59301 | train_auc: 0.75115 | train_balanced_accuracy: 0.6879  | train_accuracy: 0.68811 | valid_auc: 0.74135 | valid_balanced_accuracy: 0.67606 | valid_accuracy: 0.67627 |  0:06:42s
epoch 24 | loss: 0.59505 | train_auc: 0.74937 | train_balanced_accuracy: 0.68592 | train_accuracy: 0.68646 | valid_auc: 0.73704 | valid_balanced_accuracy: 0.67922 | valid_accuracy: 0.67973 |  0:06:59s
epoch 25 | loss: 0.58962 | train_auc: 0.75265 | train_balanced_accuracy: 0.68239 | train_accuracy: 0.68233 | valid_auc: 0.74096 | valid_balanced_accuracy: 0.67856 | valid_accuracy: 0.67847 |  0:07:16s
epoch 26 | loss: 0.5893  | train_auc: 0.75572 | train_balanced_accuracy: 0.6929  | train_accuracy: 0.69315 | valid_auc: 0.74255 | valid_balanced_accuracy: 0.68327 | valid_accuracy: 0.68351 |  0:07:32s
epoch 27 | loss: 0.58715 | train_auc: 0.75748 | train_balanced_accuracy: 0.69145 | train_accuracy: 0.69138 | valid_auc: 0.74637 | valid_balanced_accuracy: 0.68263 | valid_accuracy: 0.68256 |  0:07:49s
epoch 28 | loss: 0.58407 | train_auc: 0.7574  | train_balanced_accuracy: 0.6928  | train_accuracy: 0.69322 | valid_auc: 0.74104 | valid_balanced_accuracy: 0.68165 | valid_accuracy: 0.68209 |  0:08:04s
epoch 29 | loss: 0.58738 | train_auc: 0.75944 | train_balanced_accuracy: 0.69268 | train_accuracy: 0.69279 | valid_auc: 0.74309 | valid_balanced_accuracy: 0.68588 | valid_accuracy: 0.68602 |  0:08:21s
epoch 30 | loss: 0.58761 | train_auc: 0.75922 | train_balanced_accuracy: 0.69381 | train_accuracy: 0.69405 | valid_auc: 0.74056 | valid_balanced_accuracy: 0.68672 | valid_accuracy: 0.68697 |  0:08:37s
epoch 31 | loss: 0.5884  | train_auc: 0.75889 | train_balanced_accuracy: 0.69307 | train_accuracy: 0.69319 | valid_auc: 0.74386 | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68917 |  0:08:54s
epoch 32 | loss: 0.58325 | train_auc: 0.75989 | train_balanced_accuracy: 0.6932  | train_accuracy: 0.69334 | valid_auc: 0.74179 | valid_balanced_accuracy: 0.68041 | valid_accuracy: 0.68052 |  0:09:11s
epoch 33 | loss: 0.58491 | train_auc: 0.75704 | train_balanced_accuracy: 0.68991 | train_accuracy: 0.6902  | valid_auc: 0.74001 | valid_balanced_accuracy: 0.68198 | valid_accuracy: 0.68225 |  0:09:27s
epoch 34 | loss: 0.58627 | train_auc: 0.75467 | train_balanced_accuracy: 0.68964 | train_accuracy: 0.6898  | valid_auc: 0.74206 | valid_balanced_accuracy: 0.68513 | valid_accuracy: 0.68524 |  0:09:44s
epoch 35 | loss: 0.58157 | train_auc: 0.75273 | train_balanced_accuracy: 0.6883  | train_accuracy: 0.68842 | valid_auc: 0.74084 | valid_balanced_accuracy: 0.67819 | valid_accuracy: 0.67831 |  0:09:59s
epoch 36 | loss: 0.58718 | train_auc: 0.76108 | train_balanced_accuracy: 0.6966  | train_accuracy: 0.69688 | valid_auc: 0.74481 | valid_balanced_accuracy: 0.69015 | valid_accuracy: 0.69043 |  0:10:15s
epoch 37 | loss: 0.58339 | train_auc: 0.75656 | train_balanced_accuracy: 0.68931 | train_accuracy: 0.6896  | valid_auc: 0.74456 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68398 |  0:10:34s
epoch 38 | loss: 0.58169 | train_auc: 0.71651 | train_balanced_accuracy: 0.65946 | train_accuracy: 0.65951 | valid_auc: 0.71837 | valid_balanced_accuracy: 0.66236 | valid_accuracy: 0.66242 |  0:10:51s
epoch 39 | loss: 0.57921 | train_auc: 0.71398 | train_balanced_accuracy: 0.65517 | train_accuracy: 0.65561 | valid_auc: 0.71116 | valid_balanced_accuracy: 0.65964 | valid_accuracy: 0.66006 |  0:11:07s
epoch 40 | loss: 0.58254 | train_auc: 0.76154 | train_balanced_accuracy: 0.69413 | train_accuracy: 0.69421 | valid_auc: 0.74373 | valid_balanced_accuracy: 0.683   | valid_accuracy: 0.68303 |  0:11:24s
epoch 41 | loss: 0.58244 | train_auc: 0.74416 | train_balanced_accuracy: 0.68057 | train_accuracy: 0.68067 | valid_auc: 0.7359  | valid_balanced_accuracy: 0.6757  | valid_accuracy: 0.67579 |  0:11:41s
epoch 42 | loss: 0.57795 | train_auc: 0.73699 | train_balanced_accuracy: 0.67534 | train_accuracy: 0.67607 | valid_auc: 0.72718 | valid_balanced_accuracy: 0.67286 | valid_accuracy: 0.67359 |  0:11:55s
epoch 43 | loss: 0.58557 | train_auc: 0.74111 | train_balanced_accuracy: 0.68159 | train_accuracy: 0.68201 | valid_auc: 0.72854 | valid_balanced_accuracy: 0.67558 | valid_accuracy: 0.67595 |  0:12:11s
epoch 44 | loss: 0.58437 | train_auc: 0.73811 | train_balanced_accuracy: 0.67919 | train_accuracy: 0.67938 | valid_auc: 0.72888 | valid_balanced_accuracy: 0.67485 | valid_accuracy: 0.67501 |  0:12:27s
epoch 45 | loss: 0.58118 | train_auc: 0.74842 | train_balanced_accuracy: 0.68531 | train_accuracy: 0.68575 | valid_auc: 0.73627 | valid_balanced_accuracy: 0.68374 | valid_accuracy: 0.68414 |  0:12:44s
epoch 46 | loss: 0.58297 | train_auc: 0.74599 | train_balanced_accuracy: 0.68225 | train_accuracy: 0.68284 | valid_auc: 0.73513 | valid_balanced_accuracy: 0.67445 | valid_accuracy: 0.67501 |  0:13:02s
epoch 47 | loss: 0.58018 | train_auc: 0.76539 | train_balanced_accuracy: 0.69371 | train_accuracy: 0.69437 | valid_auc: 0.74869 | valid_balanced_accuracy: 0.68363 | valid_accuracy: 0.68429 |  0:13:19s
epoch 48 | loss: 0.58082 | train_auc: 0.76143 | train_balanced_accuracy: 0.68975 | train_accuracy: 0.6898  | valid_auc: 0.74621 | valid_balanced_accuracy: 0.68777 | valid_accuracy: 0.68776 |  0:13:37s
epoch 49 | loss: 0.57706 | train_auc: 0.76407 | train_balanced_accuracy: 0.6952  | train_accuracy: 0.69559 | valid_auc: 0.7461  | valid_balanced_accuracy: 0.69023 | valid_accuracy: 0.69059 |  0:13:53s
epoch 50 | loss: 0.57811 | train_auc: 0.75465 | train_balanced_accuracy: 0.68245 | train_accuracy: 0.68233 | valid_auc: 0.74271 | valid_balanced_accuracy: 0.67499 | valid_accuracy: 0.67485 |  0:14:09s
epoch 51 | loss: 0.57491 | train_auc: 0.70936 | train_balanced_accuracy: 0.65449 | train_accuracy: 0.65451 | valid_auc: 0.70458 | valid_balanced_accuracy: 0.65784 | valid_accuracy: 0.65785 |  0:14:25s
epoch 52 | loss: 0.57371 | train_auc: 0.7675  | train_balanced_accuracy: 0.70039 | train_accuracy: 0.70058 | valid_auc: 0.74914 | valid_balanced_accuracy: 0.68407 | valid_accuracy: 0.68429 |  0:14:41s
epoch 53 | loss: 0.57497 | train_auc: 0.75289 | train_balanced_accuracy: 0.68819 | train_accuracy: 0.68839 | valid_auc: 0.73863 | valid_balanced_accuracy: 0.68    | valid_accuracy: 0.6802  |  0:14:59s
epoch 54 | loss: 0.57662 | train_auc: 0.72366 | train_balanced_accuracy: 0.67073 | train_accuracy: 0.67131 | valid_auc: 0.71862 | valid_balanced_accuracy: 0.6686  | valid_accuracy: 0.66918 |  0:15:17s
epoch 55 | loss: 0.57579 | train_auc: 0.70695 | train_balanced_accuracy: 0.64991 | train_accuracy: 0.64975 | valid_auc: 0.70629 | valid_balanced_accuracy: 0.65257 | valid_accuracy: 0.65234 |  0:15:32s
epoch 56 | loss: 0.57278 | train_auc: 0.71186 | train_balanced_accuracy: 0.65009 | train_accuracy: 0.64971 | valid_auc: 0.71448 | valid_balanced_accuracy: 0.65447 | valid_accuracy: 0.65408 |  0:15:48s
epoch 57 | loss: 0.58225 | train_auc: 0.71871 | train_balanced_accuracy: 0.64835 | train_accuracy: 0.6477  | valid_auc: 0.71577 | valid_balanced_accuracy: 0.64907 | valid_accuracy: 0.64841 |  0:16:04s
epoch 58 | loss: 0.58113 | train_auc: 0.72992 | train_balanced_accuracy: 0.6657  | train_accuracy: 0.66568 | valid_auc: 0.72827 | valid_balanced_accuracy: 0.66246 | valid_accuracy: 0.66242 |  0:16:20s
epoch 59 | loss: 0.57629 | train_auc: 0.73276 | train_balanced_accuracy: 0.66982 | train_accuracy: 0.66977 | valid_auc: 0.72658 | valid_balanced_accuracy: 0.67021 | valid_accuracy: 0.67013 |  0:16:36s
epoch 60 | loss: 0.58047 | train_auc: 0.74344 | train_balanced_accuracy: 0.67358 | train_accuracy: 0.6732  | valid_auc: 0.73334 | valid_balanced_accuracy: 0.66316 | valid_accuracy: 0.66273 |  0:16:53s
epoch 61 | loss: 0.57895 | train_auc: 0.75205 | train_balanced_accuracy: 0.68627 | train_accuracy: 0.68642 | valid_auc: 0.73944 | valid_balanced_accuracy: 0.68007 | valid_accuracy: 0.6802  |  0:17:11s
epoch 62 | loss: 0.57477 | train_auc: 0.75901 | train_balanced_accuracy: 0.6928  | train_accuracy: 0.69291 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.68561 | valid_accuracy: 0.68571 |  0:17:26s
epoch 63 | loss: 0.57474 | train_auc: 0.76145 | train_balanced_accuracy: 0.6932  | train_accuracy: 0.69326 | valid_auc: 0.74363 | valid_balanced_accuracy: 0.68362 | valid_accuracy: 0.68366 |  0:17:43s
epoch 64 | loss: 0.57311 | train_auc: 0.76686 | train_balanced_accuracy: 0.69753 | train_accuracy: 0.69747 | valid_auc: 0.7484  | valid_balanced_accuracy: 0.68467 | valid_accuracy: 0.68461 |  0:18:00s
epoch 65 | loss: 0.56754 | train_auc: 0.77273 | train_balanced_accuracy: 0.69988 | train_accuracy: 0.69983 | valid_auc: 0.75527 | valid_balanced_accuracy: 0.6911  | valid_accuracy: 0.69106 |  0:18:17s
epoch 66 | loss: 0.57285 | train_auc: 0.77609 | train_balanced_accuracy: 0.70149 | train_accuracy: 0.70149 | valid_auc: 0.75374 | valid_balanced_accuracy: 0.6879  | valid_accuracy: 0.68791 |  0:18:32s
epoch 67 | loss: 0.56954 | train_auc: 0.77756 | train_balanced_accuracy: 0.70177 | train_accuracy: 0.70204 | valid_auc: 0.75024 | valid_balanced_accuracy: 0.68634 | valid_accuracy: 0.68665 |  0:18:48s
epoch 68 | loss: 0.57105 | train_auc: 0.77517 | train_balanced_accuracy: 0.70208 | train_accuracy: 0.70239 | valid_auc: 0.75217 | valid_balanced_accuracy: 0.68899 | valid_accuracy: 0.68933 |  0:19:04s
epoch 69 | loss: 0.57104 | train_auc: 0.77739 | train_balanced_accuracy: 0.70357 | train_accuracy: 0.70373 | valid_auc: 0.75297 | valid_balanced_accuracy: 0.69056 | valid_accuracy: 0.69075 |  0:19:21s
epoch 70 | loss: 0.56935 | train_auc: 0.78094 | train_balanced_accuracy: 0.70585 | train_accuracy: 0.70593 | valid_auc: 0.7558  | valid_balanced_accuracy: 0.6889  | valid_accuracy: 0.68901 |  0:19:38s
epoch 71 | loss: 0.57087 | train_auc: 0.77908 | train_balanced_accuracy: 0.70448 | train_accuracy: 0.70456 | valid_auc: 0.75305 | valid_balanced_accuracy: 0.69177 | valid_accuracy: 0.69185 |  0:19:54s
epoch 72 | loss: 0.57324 | train_auc: 0.77636 | train_balanced_accuracy: 0.70234 | train_accuracy: 0.70251 | valid_auc: 0.75244 | valid_balanced_accuracy: 0.69495 | valid_accuracy: 0.69515 |  0:20:12s
epoch 73 | loss: 0.56492 | train_auc: 0.78092 | train_balanced_accuracy: 0.70683 | train_accuracy: 0.70676 | valid_auc: 0.75725 | valid_balanced_accuracy: 0.69077 | valid_accuracy: 0.69075 |  0:20:30s
epoch 74 | loss: 0.56989 | train_auc: 0.78068 | train_balanced_accuracy: 0.70549 | train_accuracy: 0.70593 | valid_auc: 0.75636 | valid_balanced_accuracy: 0.69122 | valid_accuracy: 0.69169 |  0:20:46s
epoch 75 | loss: 0.57016 | train_auc: 0.78243 | train_balanced_accuracy: 0.70749 | train_accuracy: 0.70759 | valid_auc: 0.75541 | valid_balanced_accuracy: 0.69064 | valid_accuracy: 0.69075 |  0:21:01s
epoch 76 | loss: 0.56793 | train_auc: 0.78188 | train_balanced_accuracy: 0.70245 | train_accuracy: 0.70231 | valid_auc: 0.75499 | valid_balanced_accuracy: 0.69006 | valid_accuracy: 0.68996 |  0:21:19s
epoch 77 | loss: 0.56331 | train_auc: 0.7813  | train_balanced_accuracy: 0.70707 | train_accuracy: 0.70715 | valid_auc: 0.7547  | valid_balanced_accuracy: 0.69362 | valid_accuracy: 0.69374 |  0:21:37s
epoch 78 | loss: 0.56081 | train_auc: 0.78016 | train_balanced_accuracy: 0.70741 | train_accuracy: 0.70755 | valid_auc: 0.75315 | valid_balanced_accuracy: 0.69197 | valid_accuracy: 0.69216 |  0:21:53s
epoch 79 | loss: 0.56262 | train_auc: 0.78098 | train_balanced_accuracy: 0.70705 | train_accuracy: 0.70711 | valid_auc: 0.75291 | valid_balanced_accuracy: 0.69206 | valid_accuracy: 0.69216 |  0:22:09s
epoch 80 | loss: 0.5691  | train_auc: 0.78173 | train_balanced_accuracy: 0.70706 | train_accuracy: 0.70727 | valid_auc: 0.75247 | valid_balanced_accuracy: 0.69035 | valid_accuracy: 0.69059 |  0:22:28s
epoch 81 | loss: 0.57111 | train_auc: 0.77999 | train_balanced_accuracy: 0.70734 | train_accuracy: 0.70763 | valid_auc: 0.75249 | valid_balanced_accuracy: 0.68936 | valid_accuracy: 0.68964 |  0:22:45s
epoch 82 | loss: 0.56635 | train_auc: 0.78046 | train_balanced_accuracy: 0.70597 | train_accuracy: 0.70621 | valid_auc: 0.75489 | valid_balanced_accuracy: 0.6949  | valid_accuracy: 0.69515 |  0:23:01s
epoch 83 | loss: 0.56882 | train_auc: 0.78397 | train_balanced_accuracy: 0.71019 | train_accuracy: 0.7103  | valid_auc: 0.75807 | valid_balanced_accuracy: 0.69348 | valid_accuracy: 0.69358 |  0:23:19s
epoch 84 | loss: 0.56607 | train_auc: 0.78371 | train_balanced_accuracy: 0.70992 | train_accuracy: 0.71014 | valid_auc: 0.75378 | valid_balanced_accuracy: 0.68926 | valid_accuracy: 0.68949 |  0:23:35s
epoch 85 | loss: 0.56749 | train_auc: 0.75673 | train_balanced_accuracy: 0.6887  | train_accuracy: 0.6887  | valid_auc: 0.7451  | valid_balanced_accuracy: 0.68241 | valid_accuracy: 0.6824  |  0:23:52s
epoch 86 | loss: 0.56655 | train_auc: 0.75285 | train_balanced_accuracy: 0.68176 | train_accuracy: 0.68142 | valid_auc: 0.74081 | valid_balanced_accuracy: 0.67519 | valid_accuracy: 0.67485 |  0:24:08s
epoch 87 | loss: 0.56056 | train_auc: 0.7679  | train_balanced_accuracy: 0.69289 | train_accuracy: 0.6926  | valid_auc: 0.74714 | valid_balanced_accuracy: 0.67723 | valid_accuracy: 0.6769  |  0:24:26s
epoch 88 | loss: 0.5597  | train_auc: 0.77628 | train_balanced_accuracy: 0.70573 | train_accuracy: 0.70578 | valid_auc: 0.75606 | valid_balanced_accuracy: 0.69576 | valid_accuracy: 0.69578 |  0:24:45s
epoch 89 | loss: 0.56378 | train_auc: 0.78222 | train_balanced_accuracy: 0.70869 | train_accuracy: 0.70916 | valid_auc: 0.75483 | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69295 |  0:25:00s
epoch 90 | loss: 0.56573 | train_auc: 0.78675 | train_balanced_accuracy: 0.71089 | train_accuracy: 0.71085 | valid_auc: 0.75821 | valid_balanced_accuracy: 0.69423 | valid_accuracy: 0.69421 |  0:25:17s
epoch 91 | loss: 0.56111 | train_auc: 0.7877  | train_balanced_accuracy: 0.71369 | train_accuracy: 0.7138  | valid_auc: 0.75544 | valid_balanced_accuracy: 0.69014 | valid_accuracy: 0.69027 |  0:25:33s
epoch 92 | loss: 0.5603  | train_auc: 0.78875 | train_balanced_accuracy: 0.71411 | train_accuracy: 0.71424 | valid_auc: 0.75186 | valid_balanced_accuracy: 0.6912  | valid_accuracy: 0.69138 |  0:25:50s
epoch 93 | loss: 0.55886 | train_auc: 0.78898 | train_balanced_accuracy: 0.71339 | train_accuracy: 0.71349 | valid_auc: 0.75635 | valid_balanced_accuracy: 0.69232 | valid_accuracy: 0.69248 |  0:26:05s
epoch 94 | loss: 0.56549 | train_auc: 0.78899 | train_balanced_accuracy: 0.71367 | train_accuracy: 0.71372 | valid_auc: 0.75594 | valid_balanced_accuracy: 0.69145 | valid_accuracy: 0.69153 |  0:26:24s
epoch 95 | loss: 0.55484 | train_auc: 0.78545 | train_balanced_accuracy: 0.70887 | train_accuracy: 0.70904 | valid_auc: 0.75437 | valid_balanced_accuracy: 0.69556 | valid_accuracy: 0.69578 |  0:26:38s
epoch 96 | loss: 0.56112 | train_auc: 0.78574 | train_balanced_accuracy: 0.71187 | train_accuracy: 0.71227 | valid_auc: 0.75666 | valid_balanced_accuracy: 0.69348 | valid_accuracy: 0.69389 |  0:26:55s
epoch 97 | loss: 0.55999 | train_auc: 0.78773 | train_balanced_accuracy: 0.71454 | train_accuracy: 0.71475 | valid_auc: 0.75532 | valid_balanced_accuracy: 0.69161 | valid_accuracy: 0.69185 |  0:27:12s
epoch 98 | loss: 0.56061 | train_auc: 0.78244 | train_balanced_accuracy: 0.70701 | train_accuracy: 0.70723 | valid_auc: 0.75367 | valid_balanced_accuracy: 0.69239 | valid_accuracy: 0.69263 |  0:27:30s
epoch 99 | loss: 0.56139 | train_auc: 0.78597 | train_balanced_accuracy: 0.71136 | train_accuracy: 0.71148 | valid_auc: 0.75474 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.68886 |  0:27:45s
epoch 100| loss: 0.56208 | train_auc: 0.78787 | train_balanced_accuracy: 0.71104 | train_accuracy: 0.71093 | valid_auc: 0.75553 | valid_balanced_accuracy: 0.68832 | valid_accuracy: 0.68823 |  0:28:01s
epoch 101| loss: 0.55716 | train_auc: 0.79032 | train_balanced_accuracy: 0.71244 | train_accuracy: 0.71239 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.68983 | valid_accuracy: 0.6898  |  0:28:17s
epoch 102| loss: 0.55624 | train_auc: 0.79081 | train_balanced_accuracy: 0.71332 | train_accuracy: 0.71337 | valid_auc: 0.75575 | valid_balanced_accuracy: 0.69023 | valid_accuracy: 0.69027 |  0:28:33s
epoch 103| loss: 0.55751 | train_auc: 0.79129 | train_balanced_accuracy: 0.71505 | train_accuracy: 0.7151  | valid_auc: 0.75974 | valid_balanced_accuracy: 0.69629 | valid_accuracy: 0.69641 |  0:28:50s
epoch 104| loss: 0.55826 | train_auc: 0.77572 | train_balanced_accuracy: 0.69968 | train_accuracy: 0.6996  | valid_auc: 0.75305 | valid_balanced_accuracy: 0.68708 | valid_accuracy: 0.68697 |  0:29:06s
epoch 105| loss: 0.55882 | train_auc: 0.78631 | train_balanced_accuracy: 0.70896 | train_accuracy: 0.70896 | valid_auc: 0.75748 | valid_balanced_accuracy: 0.69245 | valid_accuracy: 0.69248 |  0:29:24s
epoch 106| loss: 0.55621 | train_auc: 0.78634 | train_balanced_accuracy: 0.71184 | train_accuracy: 0.71219 | valid_auc: 0.75812 | valid_balanced_accuracy: 0.69272 | valid_accuracy: 0.69311 |  0:29:39s
epoch 107| loss: 0.5601  | train_auc: 0.78698 | train_balanced_accuracy: 0.71064 | train_accuracy: 0.71058 | valid_auc: 0.75326 | valid_balanced_accuracy: 0.68841 | valid_accuracy: 0.68839 |  0:29:55s
epoch 108| loss: 0.55693 | train_auc: 0.78916 | train_balanced_accuracy: 0.71329 | train_accuracy: 0.71345 | valid_auc: 0.75599 | valid_balanced_accuracy: 0.68743 | valid_accuracy: 0.6876  |  0:30:12s
epoch 109| loss: 0.55382 | train_auc: 0.78755 | train_balanced_accuracy: 0.71193 | train_accuracy: 0.71219 | valid_auc: 0.75281 | valid_balanced_accuracy: 0.68638 | valid_accuracy: 0.68665 |  0:30:29s
epoch 110| loss: 0.56172 | train_auc: 0.78136 | train_balanced_accuracy: 0.7074  | train_accuracy: 0.70774 | valid_auc: 0.74964 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68933 |  0:30:47s
epoch 111| loss: 0.56055 | train_auc: 0.78173 | train_balanced_accuracy: 0.70908 | train_accuracy: 0.7094  | valid_auc: 0.75183 | valid_balanced_accuracy: 0.68967 | valid_accuracy: 0.68996 |  0:31:04s
epoch 112| loss: 0.55349 | train_auc: 0.79252 | train_balanced_accuracy: 0.71385 | train_accuracy: 0.714   | valid_auc: 0.75315 | valid_balanced_accuracy: 0.69169 | valid_accuracy: 0.69185 |  0:31:19s
epoch 113| loss: 0.55509 | train_auc: 0.78915 | train_balanced_accuracy: 0.71224 | train_accuracy: 0.71239 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.68966 | valid_accuracy: 0.6898  |  0:31:36s
epoch 114| loss: 0.56009 | train_auc: 0.78351 | train_balanced_accuracy: 0.7054  | train_accuracy: 0.70574 | valid_auc: 0.75186 | valid_balanced_accuracy: 0.68756 | valid_accuracy: 0.68791 |  0:31:52s
epoch 115| loss: 0.55671 | train_auc: 0.77825 | train_balanced_accuracy: 0.70365 | train_accuracy: 0.70412 | valid_auc: 0.74832 | valid_balanced_accuracy: 0.68323 | valid_accuracy: 0.68366 |  0:32:09s
epoch 116| loss: 0.5498  | train_auc: 0.79246 | train_balanced_accuracy: 0.71423 | train_accuracy: 0.71439 | valid_auc: 0.75176 | valid_balanced_accuracy: 0.68806 | valid_accuracy: 0.68823 |  0:32:27s
epoch 117| loss: 0.55318 | train_auc: 0.79591 | train_balanced_accuracy: 0.71798 | train_accuracy: 0.71825 | valid_auc: 0.75848 | valid_balanced_accuracy: 0.69551 | valid_accuracy: 0.69578 |  0:32:45s
epoch 118| loss: 0.55381 | train_auc: 0.78986 | train_balanced_accuracy: 0.71691 | train_accuracy: 0.71723 | valid_auc: 0.75242 | valid_balanced_accuracy: 0.69137 | valid_accuracy: 0.69169 |  0:33:02s
epoch 119| loss: 0.55309 | train_auc: 0.79519 | train_balanced_accuracy: 0.71965 | train_accuracy: 0.71998 | valid_auc: 0.75352 | valid_balanced_accuracy: 0.68823 | valid_accuracy: 0.68854 |  0:33:18s
epoch 120| loss: 0.5515  | train_auc: 0.77643 | train_balanced_accuracy: 0.70264 | train_accuracy: 0.70314 | valid_auc: 0.74448 | valid_balanced_accuracy: 0.68416 | valid_accuracy: 0.68461 |  0:33:35s
epoch 121| loss: 0.55384 | train_auc: 0.77051 | train_balanced_accuracy: 0.70144 | train_accuracy: 0.7018  | valid_auc: 0.74076 | valid_balanced_accuracy: 0.68143 | valid_accuracy: 0.68178 |  0:33:53s
epoch 122| loss: 0.5495  | train_auc: 0.79585 | train_balanced_accuracy: 0.71979 | train_accuracy: 0.72014 | valid_auc: 0.75496 | valid_balanced_accuracy: 0.68976 | valid_accuracy: 0.69012 |  0:34:11s
epoch 123| loss: 0.55815 | train_auc: 0.78601 | train_balanced_accuracy: 0.71144 | train_accuracy: 0.7116  | valid_auc: 0.75284 | valid_balanced_accuracy: 0.68568 | valid_accuracy: 0.68587 |  0:34:29s

Early stopping occurred at epoch 123 with best_epoch = 103 and best_valid_accuracy = 0.69641
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 56/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=34.6min
[CV 4/5; 56/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70962 | train_auc: 0.55055 | train_balanced_accuracy: 0.5352  | train_accuracy: 0.53451 | valid_auc: 0.54352 | valid_balanced_accuracy: 0.53328 | valid_accuracy: 0.53258 |  0:00:17s
epoch 1  | loss: 0.66147 | train_auc: 0.6189  | train_balanced_accuracy: 0.57992 | train_accuracy: 0.57877 | valid_auc: 0.61159 | valid_balanced_accuracy: 0.57763 | valid_accuracy: 0.57649 |  0:00:32s
epoch 2  | loss: 0.64046 | train_auc: 0.64168 | train_balanced_accuracy: 0.58487 | train_accuracy: 0.58274 | valid_auc: 0.63774 | valid_balanced_accuracy: 0.57972 | valid_accuracy: 0.57759 |  0:00:48s
epoch 3  | loss: 0.63426 | train_auc: 0.65391 | train_balanced_accuracy: 0.58572 | train_accuracy: 0.58369 | valid_auc: 0.64562 | valid_balanced_accuracy: 0.57711 | valid_accuracy: 0.57507 |  0:01:04s
epoch 4  | loss: 0.6272  | train_auc: 0.66207 | train_balanced_accuracy: 0.60259 | train_accuracy: 0.6008  | valid_auc: 0.65297 | valid_balanced_accuracy: 0.59084 | valid_accuracy: 0.58908 |  0:01:21s
epoch 5  | loss: 0.62754 | train_auc: 0.66637 | train_balanced_accuracy: 0.61304 | train_accuracy: 0.61202 | valid_auc: 0.65903 | valid_balanced_accuracy: 0.6069  | valid_accuracy: 0.60592 |  0:01:39s
epoch 6  | loss: 0.61963 | train_auc: 0.66901 | train_balanced_accuracy: 0.62156 | train_accuracy: 0.62051 | valid_auc: 0.65997 | valid_balanced_accuracy: 0.61292 | valid_accuracy: 0.6119  |  0:01:57s
epoch 7  | loss: 0.61806 | train_auc: 0.68324 | train_balanced_accuracy: 0.62365 | train_accuracy: 0.62284 | valid_auc: 0.67512 | valid_balanced_accuracy: 0.61597 | valid_accuracy: 0.6152  |  0:02:13s
epoch 8  | loss: 0.61647 | train_auc: 0.69841 | train_balanced_accuracy: 0.64896 | train_accuracy: 0.64943 | valid_auc: 0.68447 | valid_balanced_accuracy: 0.63974 | valid_accuracy: 0.64023 |  0:02:31s
epoch 9  | loss: 0.61296 | train_auc: 0.69816 | train_balanced_accuracy: 0.64699 | train_accuracy: 0.64703 | valid_auc: 0.68206 | valid_balanced_accuracy: 0.63198 | valid_accuracy: 0.63204 |  0:02:49s
epoch 10 | loss: 0.60666 | train_auc: 0.70886 | train_balanced_accuracy: 0.65687 | train_accuracy: 0.65711 | valid_auc: 0.69659 | valid_balanced_accuracy: 0.64924 | valid_accuracy: 0.64951 |  0:03:05s
epoch 11 | loss: 0.60532 | train_auc: 0.70763 | train_balanced_accuracy: 0.65393 | train_accuracy: 0.65455 | valid_auc: 0.69332 | valid_balanced_accuracy: 0.64907 | valid_accuracy: 0.64967 |  0:03:23s
epoch 12 | loss: 0.60247 | train_auc: 0.71334 | train_balanced_accuracy: 0.65967 | train_accuracy: 0.66041 | valid_auc: 0.69931 | valid_balanced_accuracy: 0.64922 | valid_accuracy: 0.64998 |  0:03:38s
epoch 13 | loss: 0.60328 | train_auc: 0.71841 | train_balanced_accuracy: 0.66161 | train_accuracy: 0.66179 | valid_auc: 0.7029  | valid_balanced_accuracy: 0.65106 | valid_accuracy: 0.65124 |  0:03:53s
epoch 14 | loss: 0.6073  | train_auc: 0.7232  | train_balanced_accuracy: 0.6625  | train_accuracy: 0.66269 | valid_auc: 0.71011 | valid_balanced_accuracy: 0.65469 | valid_accuracy: 0.65486 |  0:04:10s
epoch 15 | loss: 0.60599 | train_auc: 0.72846 | train_balanced_accuracy: 0.66227 | train_accuracy: 0.66297 | valid_auc: 0.71359 | valid_balanced_accuracy: 0.65618 | valid_accuracy: 0.65691 |  0:04:25s
epoch 16 | loss: 0.59967 | train_auc: 0.72971 | train_balanced_accuracy: 0.66255 | train_accuracy: 0.66313 | valid_auc: 0.71177 | valid_balanced_accuracy: 0.6571  | valid_accuracy: 0.6577  |  0:04:42s
epoch 17 | loss: 0.59764 | train_auc: 0.73373 | train_balanced_accuracy: 0.66753 | train_accuracy: 0.6682  | valid_auc: 0.71452 | valid_balanced_accuracy: 0.65668 | valid_accuracy: 0.65738 |  0:05:01s
epoch 18 | loss: 0.60254 | train_auc: 0.73701 | train_balanced_accuracy: 0.66865 | train_accuracy: 0.66942 | valid_auc: 0.7199  | valid_balanced_accuracy: 0.66159 | valid_accuracy: 0.66242 |  0:05:18s
epoch 19 | loss: 0.59248 | train_auc: 0.74192 | train_balanced_accuracy: 0.67569 | train_accuracy: 0.67638 | valid_auc: 0.72366 | valid_balanced_accuracy: 0.66844 | valid_accuracy: 0.66918 |  0:05:35s
epoch 20 | loss: 0.59397 | train_auc: 0.74293 | train_balanced_accuracy: 0.67644 | train_accuracy: 0.67713 | valid_auc: 0.72562 | valid_balanced_accuracy: 0.66323 | valid_accuracy: 0.66399 |  0:05:51s
epoch 21 | loss: 0.5934  | train_auc: 0.74885 | train_balanced_accuracy: 0.68626 | train_accuracy: 0.68661 | valid_auc: 0.72466 | valid_balanced_accuracy: 0.66721 | valid_accuracy: 0.66761 |  0:06:09s
epoch 22 | loss: 0.59759 | train_auc: 0.7484  | train_balanced_accuracy: 0.68231 | train_accuracy: 0.68244 | valid_auc: 0.72772 | valid_balanced_accuracy: 0.66445 | valid_accuracy: 0.66462 |  0:06:26s
epoch 23 | loss: 0.59493 | train_auc: 0.75053 | train_balanced_accuracy: 0.6837  | train_accuracy: 0.68386 | valid_auc: 0.73027 | valid_balanced_accuracy: 0.6687  | valid_accuracy: 0.66887 |  0:06:41s
epoch 24 | loss: 0.59512 | train_auc: 0.7507  | train_balanced_accuracy: 0.68397 | train_accuracy: 0.68425 | valid_auc: 0.72897 | valid_balanced_accuracy: 0.67247 | valid_accuracy: 0.6728  |  0:06:59s
epoch 25 | loss: 0.5941  | train_auc: 0.75334 | train_balanced_accuracy: 0.68837 | train_accuracy: 0.68846 | valid_auc: 0.73184 | valid_balanced_accuracy: 0.67064 | valid_accuracy: 0.67076 |  0:07:15s
epoch 26 | loss: 0.58934 | train_auc: 0.7573  | train_balanced_accuracy: 0.68832 | train_accuracy: 0.68874 | valid_auc: 0.73969 | valid_balanced_accuracy: 0.6845  | valid_accuracy: 0.68492 |  0:07:32s
epoch 27 | loss: 0.59368 | train_auc: 0.75718 | train_balanced_accuracy: 0.69188 | train_accuracy: 0.69193 | valid_auc: 0.73854 | valid_balanced_accuracy: 0.67747 | valid_accuracy: 0.67753 |  0:07:46s
epoch 28 | loss: 0.58915 | train_auc: 0.75949 | train_balanced_accuracy: 0.69268 | train_accuracy: 0.6926  | valid_auc: 0.7356  | valid_balanced_accuracy: 0.67524 | valid_accuracy: 0.67517 |  0:08:03s
epoch 29 | loss: 0.58792 | train_auc: 0.75652 | train_balanced_accuracy: 0.68656 | train_accuracy: 0.68642 | valid_auc: 0.73721 | valid_balanced_accuracy: 0.6668  | valid_accuracy: 0.66667 |  0:08:21s
epoch 30 | loss: 0.58661 | train_auc: 0.75244 | train_balanced_accuracy: 0.68598 | train_accuracy: 0.68587 | valid_auc: 0.73214 | valid_balanced_accuracy: 0.66709 | valid_accuracy: 0.66698 |  0:08:37s
epoch 31 | loss: 0.58559 | train_auc: 0.74547 | train_balanced_accuracy: 0.68384 | train_accuracy: 0.6841  | valid_auc: 0.73328 | valid_balanced_accuracy: 0.67678 | valid_accuracy: 0.67705 |  0:08:54s
epoch 32 | loss: 0.582   | train_auc: 0.72233 | train_balanced_accuracy: 0.65957 | train_accuracy: 0.65978 | valid_auc: 0.70917 | valid_balanced_accuracy: 0.64885 | valid_accuracy: 0.64904 |  0:09:11s
epoch 33 | loss: 0.58515 | train_auc: 0.68061 | train_balanced_accuracy: 0.64169 | train_accuracy: 0.64212 | valid_auc: 0.6721  | valid_balanced_accuracy: 0.63344 | valid_accuracy: 0.63393 |  0:09:27s
epoch 34 | loss: 0.58313 | train_auc: 0.67678 | train_balanced_accuracy: 0.63844 | train_accuracy: 0.6383  | valid_auc: 0.66201 | valid_balanced_accuracy: 0.62348 | valid_accuracy: 0.62339 |  0:09:45s
epoch 35 | loss: 0.57836 | train_auc: 0.68992 | train_balanced_accuracy: 0.64477 | train_accuracy: 0.64467 | valid_auc: 0.68595 | valid_balanced_accuracy: 0.63951 | valid_accuracy: 0.63944 |  0:10:03s
epoch 36 | loss: 0.5825  | train_auc: 0.70206 | train_balanced_accuracy: 0.65237 | train_accuracy: 0.65231 | valid_auc: 0.69679 | valid_balanced_accuracy: 0.65121 | valid_accuracy: 0.65124 |  0:10:19s
epoch 37 | loss: 0.58244 | train_auc: 0.70794 | train_balanced_accuracy: 0.6538  | train_accuracy: 0.65415 | valid_auc: 0.69693 | valid_balanced_accuracy: 0.6491  | valid_accuracy: 0.64951 |  0:10:35s
epoch 38 | loss: 0.58321 | train_auc: 0.71652 | train_balanced_accuracy: 0.66032 | train_accuracy: 0.66061 | valid_auc: 0.7044  | valid_balanced_accuracy: 0.65392 | valid_accuracy: 0.65423 |  0:10:51s
epoch 39 | loss: 0.58045 | train_auc: 0.72283 | train_balanced_accuracy: 0.65956 | train_accuracy: 0.65974 | valid_auc: 0.71131 | valid_balanced_accuracy: 0.64896 | valid_accuracy: 0.6492  |  0:11:05s
epoch 40 | loss: 0.58046 | train_auc: 0.73261 | train_balanced_accuracy: 0.66976 | train_accuracy: 0.66985 | valid_auc: 0.71759 | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.6632  |  0:11:21s
epoch 41 | loss: 0.57874 | train_auc: 0.73371 | train_balanced_accuracy: 0.66317 | train_accuracy: 0.66391 | valid_auc: 0.72245 | valid_balanced_accuracy: 0.6549  | valid_accuracy: 0.65565 |  0:11:38s
epoch 42 | loss: 0.5762  | train_auc: 0.74998 | train_balanced_accuracy: 0.68198 | train_accuracy: 0.68237 | valid_auc: 0.7291  | valid_balanced_accuracy: 0.66688 | valid_accuracy: 0.6673  |  0:11:54s
epoch 43 | loss: 0.57989 | train_auc: 0.7665  | train_balanced_accuracy: 0.69803 | train_accuracy: 0.69834 | valid_auc: 0.7437  | valid_balanced_accuracy: 0.68571 | valid_accuracy: 0.68602 |  0:12:10s
epoch 44 | loss: 0.58337 | train_auc: 0.76264 | train_balanced_accuracy: 0.69566 | train_accuracy: 0.69562 | valid_auc: 0.73866 | valid_balanced_accuracy: 0.67554 | valid_accuracy: 0.67548 |  0:12:26s
epoch 45 | loss: 0.57251 | train_auc: 0.7308  | train_balanced_accuracy: 0.67694 | train_accuracy: 0.67725 | valid_auc: 0.71347 | valid_balanced_accuracy: 0.66509 | valid_accuracy: 0.66541 |  0:12:42s
epoch 46 | loss: 0.57917 | train_auc: 0.71129 | train_balanced_accuracy: 0.65712 | train_accuracy: 0.65691 | valid_auc: 0.70448 | valid_balanced_accuracy: 0.65361 | valid_accuracy: 0.65345 |  0:13:00s
epoch 47 | loss: 0.57401 | train_auc: 0.69379 | train_balanced_accuracy: 0.64133 | train_accuracy: 0.64176 | valid_auc: 0.69019 | valid_balanced_accuracy: 0.63967 | valid_accuracy: 0.64007 |  0:13:17s
epoch 48 | loss: 0.57446 | train_auc: 0.775   | train_balanced_accuracy: 0.70354 | train_accuracy: 0.70373 | valid_auc: 0.74834 | valid_balanced_accuracy: 0.68127 | valid_accuracy: 0.68146 |  0:13:34s
epoch 49 | loss: 0.57379 | train_auc: 0.77036 | train_balanced_accuracy: 0.70083 | train_accuracy: 0.70102 | valid_auc: 0.74688 | valid_balanced_accuracy: 0.68471 | valid_accuracy: 0.68492 |  0:13:49s
epoch 50 | loss: 0.57551 | train_auc: 0.7767  | train_balanced_accuracy: 0.70271 | train_accuracy: 0.70259 | valid_auc: 0.75054 | valid_balanced_accuracy: 0.68348 | valid_accuracy: 0.68335 |  0:14:08s
epoch 51 | loss: 0.56957 | train_auc: 0.77689 | train_balanced_accuracy: 0.70493 | train_accuracy: 0.70495 | valid_auc: 0.75021 | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.68744 |  0:14:25s
epoch 52 | loss: 0.56783 | train_auc: 0.72405 | train_balanced_accuracy: 0.65918 | train_accuracy: 0.65966 | valid_auc: 0.71033 | valid_balanced_accuracy: 0.65043 | valid_accuracy: 0.65093 |  0:14:42s
epoch 53 | loss: 0.57064 | train_auc: 0.72576 | train_balanced_accuracy: 0.65221 | train_accuracy: 0.65282 | valid_auc: 0.71275 | valid_balanced_accuracy: 0.64557 | valid_accuracy: 0.64621 |  0:14:56s
epoch 54 | loss: 0.5731  | train_auc: 0.74288 | train_balanced_accuracy: 0.67443 | train_accuracy: 0.67481 | valid_auc: 0.72695 | valid_balanced_accuracy: 0.66296 | valid_accuracy: 0.66336 |  0:15:12s
epoch 55 | loss: 0.56679 | train_auc: 0.76156 | train_balanced_accuracy: 0.68931 | train_accuracy: 0.68945 | valid_auc: 0.73644 | valid_balanced_accuracy: 0.66906 | valid_accuracy: 0.66918 |  0:15:29s
epoch 56 | loss: 0.57394 | train_auc: 0.77363 | train_balanced_accuracy: 0.70214 | train_accuracy: 0.70235 | valid_auc: 0.75175 | valid_balanced_accuracy: 0.6855  | valid_accuracy: 0.68571 |  0:15:44s
epoch 57 | loss: 0.57459 | train_auc: 0.77544 | train_balanced_accuracy: 0.70108 | train_accuracy: 0.70094 | valid_auc: 0.74755 | valid_balanced_accuracy: 0.68539 | valid_accuracy: 0.68524 |  0:15:59s
epoch 58 | loss: 0.57593 | train_auc: 0.77471 | train_balanced_accuracy: 0.70484 | train_accuracy: 0.70519 | valid_auc: 0.7487  | valid_balanced_accuracy: 0.68379 | valid_accuracy: 0.68414 |  0:16:18s
epoch 59 | loss: 0.56821 | train_auc: 0.77941 | train_balanced_accuracy: 0.70985 | train_accuracy: 0.70971 | valid_auc: 0.74827 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68351 |  0:16:33s
epoch 60 | loss: 0.56905 | train_auc: 0.782   | train_balanced_accuracy: 0.70998 | train_accuracy: 0.70991 | valid_auc: 0.75413 | valid_balanced_accuracy: 0.68656 | valid_accuracy: 0.6865  |  0:16:48s
epoch 61 | loss: 0.56944 | train_auc: 0.77887 | train_balanced_accuracy: 0.70826 | train_accuracy: 0.70853 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.69188 | valid_accuracy: 0.69216 |  0:17:05s
epoch 62 | loss: 0.56997 | train_auc: 0.77879 | train_balanced_accuracy: 0.70634 | train_accuracy: 0.70633 | valid_auc: 0.74968 | valid_balanced_accuracy: 0.68401 | valid_accuracy: 0.68398 |  0:17:22s
epoch 63 | loss: 0.56589 | train_auc: 0.77749 | train_balanced_accuracy: 0.70782 | train_accuracy: 0.70782 | valid_auc: 0.75055 | valid_balanced_accuracy: 0.68285 | valid_accuracy: 0.68288 |  0:17:37s
epoch 64 | loss: 0.56143 | train_auc: 0.77931 | train_balanced_accuracy: 0.70695 | train_accuracy: 0.70688 | valid_auc: 0.75082 | valid_balanced_accuracy: 0.68401 | valid_accuracy: 0.68398 |  0:17:55s
epoch 65 | loss: 0.56528 | train_auc: 0.78076 | train_balanced_accuracy: 0.70965 | train_accuracy: 0.70983 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.68772 | valid_accuracy: 0.68791 |  0:18:11s
epoch 66 | loss: 0.56661 | train_auc: 0.76742 | train_balanced_accuracy: 0.70035 | train_accuracy: 0.70027 | valid_auc: 0.74482 | valid_balanced_accuracy: 0.68048 | valid_accuracy: 0.68036 |  0:18:28s
epoch 67 | loss: 0.56291 | train_auc: 0.75778 | train_balanced_accuracy: 0.69136 | train_accuracy: 0.69153 | valid_auc: 0.73544 | valid_balanced_accuracy: 0.6775  | valid_accuracy: 0.67768 |  0:18:45s
epoch 68 | loss: 0.56262 | train_auc: 0.78137 | train_balanced_accuracy: 0.7092  | train_accuracy: 0.70951 | valid_auc: 0.75213 | valid_balanced_accuracy: 0.68586 | valid_accuracy: 0.68618 |  0:19:02s
epoch 69 | loss: 0.56609 | train_auc: 0.78332 | train_balanced_accuracy: 0.71024 | train_accuracy: 0.7105  | valid_auc: 0.75209 | valid_balanced_accuracy: 0.68402 | valid_accuracy: 0.68429 |  0:19:20s
epoch 70 | loss: 0.56684 | train_auc: 0.78353 | train_balanced_accuracy: 0.70814 | train_accuracy: 0.70806 | valid_auc: 0.75589 | valid_balanced_accuracy: 0.68582 | valid_accuracy: 0.68571 |  0:19:38s
epoch 71 | loss: 0.56609 | train_auc: 0.78688 | train_balanced_accuracy: 0.71077 | train_accuracy: 0.71081 | valid_auc: 0.75477 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68901 |  0:19:55s
epoch 72 | loss: 0.56649 | train_auc: 0.78573 | train_balanced_accuracy: 0.71299 | train_accuracy: 0.71329 | valid_auc: 0.75353 | valid_balanced_accuracy: 0.68901 | valid_accuracy: 0.68933 |  0:20:10s
epoch 73 | loss: 0.5658  | train_auc: 0.78507 | train_balanced_accuracy: 0.71225 | train_accuracy: 0.7125  | valid_auc: 0.75777 | valid_balanced_accuracy: 0.6908  | valid_accuracy: 0.69106 |  0:20:29s
epoch 74 | loss: 0.56475 | train_auc: 0.78846 | train_balanced_accuracy: 0.71308 | train_accuracy: 0.71349 | valid_auc: 0.75972 | valid_balanced_accuracy: 0.69237 | valid_accuracy: 0.69279 |  0:20:45s
epoch 75 | loss: 0.56394 | train_auc: 0.78924 | train_balanced_accuracy: 0.71212 | train_accuracy: 0.71203 | valid_auc: 0.75697 | valid_balanced_accuracy: 0.69079 | valid_accuracy: 0.69075 |  0:21:03s
epoch 76 | loss: 0.56472 | train_auc: 0.78988 | train_balanced_accuracy: 0.71334 | train_accuracy: 0.71321 | valid_auc: 0.76031 | valid_balanced_accuracy: 0.69447 | valid_accuracy: 0.69437 |  0:21:20s
epoch 77 | loss: 0.56143 | train_auc: 0.79178 | train_balanced_accuracy: 0.71719 | train_accuracy: 0.7173  | valid_auc: 0.75925 | valid_balanced_accuracy: 0.6908  | valid_accuracy: 0.6909  |  0:21:35s
epoch 78 | loss: 0.55486 | train_auc: 0.79183 | train_balanced_accuracy: 0.71606 | train_accuracy: 0.71601 | valid_auc: 0.758   | valid_balanced_accuracy: 0.68925 | valid_accuracy: 0.68917 |  0:21:49s
epoch 79 | loss: 0.55721 | train_auc: 0.78146 | train_balanced_accuracy: 0.70538 | train_accuracy: 0.70538 | valid_auc: 0.75146 | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68319 |  0:22:05s
epoch 80 | loss: 0.56161 | train_auc: 0.7885  | train_balanced_accuracy: 0.71112 | train_accuracy: 0.71097 | valid_auc: 0.7582  | valid_balanced_accuracy: 0.68729 | valid_accuracy: 0.68713 |  0:22:21s
epoch 81 | loss: 0.56291 | train_auc: 0.7869  | train_balanced_accuracy: 0.71159 | train_accuracy: 0.71203 | valid_auc: 0.75455 | valid_balanced_accuracy: 0.68561 | valid_accuracy: 0.68602 |  0:22:39s
epoch 82 | loss: 0.56166 | train_auc: 0.78483 | train_balanced_accuracy: 0.71188 | train_accuracy: 0.71215 | valid_auc: 0.75495 | valid_balanced_accuracy: 0.6916  | valid_accuracy: 0.69185 |  0:22:56s
epoch 83 | loss: 0.55381 | train_auc: 0.78988 | train_balanced_accuracy: 0.71555 | train_accuracy: 0.71565 | valid_auc: 0.75448 | valid_balanced_accuracy: 0.68702 | valid_accuracy: 0.68713 |  0:23:12s
epoch 84 | loss: 0.55356 | train_auc: 0.79142 | train_balanced_accuracy: 0.71599 | train_accuracy: 0.7162  | valid_auc: 0.7555  | valid_balanced_accuracy: 0.68678 | valid_accuracy: 0.68697 |  0:23:28s
epoch 85 | loss: 0.55862 | train_auc: 0.79146 | train_balanced_accuracy: 0.71426 | train_accuracy: 0.71447 | valid_auc: 0.75408 | valid_balanced_accuracy: 0.68296 | valid_accuracy: 0.68319 |  0:23:43s
epoch 86 | loss: 0.55812 | train_auc: 0.79418 | train_balanced_accuracy: 0.7205  | train_accuracy: 0.72053 | valid_auc: 0.75517 | valid_balanced_accuracy: 0.69262 | valid_accuracy: 0.69263 |  0:24:00s
epoch 87 | loss: 0.55299 | train_auc: 0.79392 | train_balanced_accuracy: 0.71876 | train_accuracy: 0.71876 | valid_auc: 0.75279 | valid_balanced_accuracy: 0.68789 | valid_accuracy: 0.68791 |  0:24:16s
epoch 88 | loss: 0.55677 | train_auc: 0.7955  | train_balanced_accuracy: 0.71901 | train_accuracy: 0.71907 | valid_auc: 0.7579  | valid_balanced_accuracy: 0.69178 | valid_accuracy: 0.69185 |  0:24:34s
epoch 89 | loss: 0.55422 | train_auc: 0.79332 | train_balanced_accuracy: 0.71613 | train_accuracy: 0.71624 | valid_auc: 0.75454 | valid_balanced_accuracy: 0.6856  | valid_accuracy: 0.68571 |  0:24:52s
epoch 90 | loss: 0.55038 | train_auc: 0.79707 | train_balanced_accuracy: 0.7206  | train_accuracy: 0.72053 | valid_auc: 0.75849 | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.68964 |  0:25:09s
epoch 91 | loss: 0.55495 | train_auc: 0.79343 | train_balanced_accuracy: 0.71914 | train_accuracy: 0.71935 | valid_auc: 0.75526 | valid_balanced_accuracy: 0.68567 | valid_accuracy: 0.68587 |  0:25:26s
epoch 92 | loss: 0.55602 | train_auc: 0.79587 | train_balanced_accuracy: 0.71992 | train_accuracy: 0.71986 | valid_auc: 0.75593 | valid_balanced_accuracy: 0.68497 | valid_accuracy: 0.68492 |  0:25:43s
epoch 93 | loss: 0.55232 | train_auc: 0.7937  | train_balanced_accuracy: 0.72016 | train_accuracy: 0.72033 | valid_auc: 0.75285 | valid_balanced_accuracy: 0.68446 | valid_accuracy: 0.68461 |  0:26:00s
epoch 94 | loss: 0.5613  | train_auc: 0.79872 | train_balanced_accuracy: 0.72284 | train_accuracy: 0.72289 | valid_auc: 0.75616 | valid_balanced_accuracy: 0.68995 | valid_accuracy: 0.68996 |  0:26:18s
epoch 95 | loss: 0.55068 | train_auc: 0.79536 | train_balanced_accuracy: 0.72005 | train_accuracy: 0.72025 | valid_auc: 0.755   | valid_balanced_accuracy: 0.68802 | valid_accuracy: 0.68823 |  0:26:37s
epoch 96 | loss: 0.55381 | train_auc: 0.78757 | train_balanced_accuracy: 0.71255 | train_accuracy: 0.7129  | valid_auc: 0.7525  | valid_balanced_accuracy: 0.68933 | valid_accuracy: 0.68964 |  0:26:53s

Early stopping occurred at epoch 96 with best_epoch = 76 and best_valid_accuracy = 0.69437
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 56/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.691 total time=27.0min
[CV 5/5; 56/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71977 | train_auc: 0.58816 | train_balanced_accuracy: 0.49964 | train_accuracy: 0.4963  | valid_auc: 0.59615 | valid_balanced_accuracy: 0.50439 | valid_accuracy: 0.50094 |  0:00:16s
epoch 1  | loss: 0.65593 | train_auc: 0.62786 | train_balanced_accuracy: 0.58948 | train_accuracy: 0.58888 | valid_auc: 0.63113 | valid_balanced_accuracy: 0.59713 | valid_accuracy: 0.59647 |  0:00:32s
epoch 2  | loss: 0.64411 | train_auc: 0.64245 | train_balanced_accuracy: 0.57326 | train_accuracy: 0.57145 | valid_auc: 0.64309 | valid_balanced_accuracy: 0.57461 | valid_accuracy: 0.57271 |  0:00:46s
epoch 3  | loss: 0.62935 | train_auc: 0.65382 | train_balanced_accuracy: 0.60531 | train_accuracy: 0.60391 | valid_auc: 0.6517  | valid_balanced_accuracy: 0.60341 | valid_accuracy: 0.60198 |  0:01:03s
epoch 4  | loss: 0.61567 | train_auc: 0.65786 | train_balanced_accuracy: 0.61081 | train_accuracy: 0.61009 | valid_auc: 0.6572  | valid_balanced_accuracy: 0.60867 | valid_accuracy: 0.60796 |  0:01:19s
epoch 5  | loss: 0.61526 | train_auc: 0.67028 | train_balanced_accuracy: 0.61998 | train_accuracy: 0.61933 | valid_auc: 0.67035 | valid_balanced_accuracy: 0.62085 | valid_accuracy: 0.62024 |  0:01:35s
epoch 6  | loss: 0.61643 | train_auc: 0.67936 | train_balanced_accuracy: 0.62628 | train_accuracy: 0.62618 | valid_auc: 0.67986 | valid_balanced_accuracy: 0.62884 | valid_accuracy: 0.62874 |  0:01:51s
epoch 7  | loss: 0.61272 | train_auc: 0.67529 | train_balanced_accuracy: 0.62584 | train_accuracy: 0.62551 | valid_auc: 0.67044 | valid_balanced_accuracy: 0.62512 | valid_accuracy: 0.6248  |  0:02:07s
epoch 8  | loss: 0.61131 | train_auc: 0.68083 | train_balanced_accuracy: 0.62559 | train_accuracy: 0.62535 | valid_auc: 0.67705 | valid_balanced_accuracy: 0.62315 | valid_accuracy: 0.62291 |  0:02:25s
epoch 9  | loss: 0.608   | train_auc: 0.68449 | train_balanced_accuracy: 0.62641 | train_accuracy: 0.62594 | valid_auc: 0.67699 | valid_balanced_accuracy: 0.62257 | valid_accuracy: 0.62213 |  0:02:41s
epoch 10 | loss: 0.60616 | train_auc: 0.69508 | train_balanced_accuracy: 0.62452 | train_accuracy: 0.62421 | valid_auc: 0.68693 | valid_balanced_accuracy: 0.61784 | valid_accuracy: 0.61756 |  0:03:00s
epoch 11 | loss: 0.60196 | train_auc: 0.69586 | train_balanced_accuracy: 0.62712 | train_accuracy: 0.62665 | valid_auc: 0.68744 | valid_balanced_accuracy: 0.62256 | valid_accuracy: 0.62213 |  0:03:16s
epoch 12 | loss: 0.60507 | train_auc: 0.69901 | train_balanced_accuracy: 0.62633 | train_accuracy: 0.62587 | valid_auc: 0.69244 | valid_balanced_accuracy: 0.62287 | valid_accuracy: 0.62244 |  0:03:33s
epoch 13 | loss: 0.60639 | train_auc: 0.70307 | train_balanced_accuracy: 0.63256 | train_accuracy: 0.63236 | valid_auc: 0.69849 | valid_balanced_accuracy: 0.62815 | valid_accuracy: 0.62795 |  0:03:49s
epoch 14 | loss: 0.5969  | train_auc: 0.70634 | train_balanced_accuracy: 0.63435 | train_accuracy: 0.63413 | valid_auc: 0.69896 | valid_balanced_accuracy: 0.62818 | valid_accuracy: 0.62795 |  0:04:06s
epoch 15 | loss: 0.59878 | train_auc: 0.71504 | train_balanced_accuracy: 0.65279 | train_accuracy: 0.65278 | valid_auc: 0.70663 | valid_balanced_accuracy: 0.64878 | valid_accuracy: 0.64873 |  0:04:24s
epoch 16 | loss: 0.60104 | train_auc: 0.72237 | train_balanced_accuracy: 0.65068 | train_accuracy: 0.65026 | valid_auc: 0.71431 | valid_balanced_accuracy: 0.64523 | valid_accuracy: 0.64479 |  0:04:39s
epoch 17 | loss: 0.60168 | train_auc: 0.71365 | train_balanced_accuracy: 0.64201 | train_accuracy: 0.64156 | valid_auc: 0.706   | valid_balanced_accuracy: 0.63687 | valid_accuracy: 0.63645 |  0:04:59s
epoch 18 | loss: 0.59602 | train_auc: 0.72869 | train_balanced_accuracy: 0.66696 | train_accuracy: 0.66734 | valid_auc: 0.71851 | valid_balanced_accuracy: 0.66429 | valid_accuracy: 0.66462 |  0:05:15s
epoch 19 | loss: 0.59602 | train_auc: 0.73368 | train_balanced_accuracy: 0.6727  | train_accuracy: 0.67296 | valid_auc: 0.72296 | valid_balanced_accuracy: 0.6677  | valid_accuracy: 0.66793 |  0:05:32s
epoch 20 | loss: 0.596   | train_auc: 0.73167 | train_balanced_accuracy: 0.66786 | train_accuracy: 0.66789 | valid_auc: 0.7221  | valid_balanced_accuracy: 0.66054 | valid_accuracy: 0.66053 |  0:05:50s
epoch 21 | loss: 0.59328 | train_auc: 0.7389  | train_balanced_accuracy: 0.67399 | train_accuracy: 0.67426 | valid_auc: 0.7258  | valid_balanced_accuracy: 0.66895 | valid_accuracy: 0.66918 |  0:06:07s
epoch 22 | loss: 0.58991 | train_auc: 0.73631 | train_balanced_accuracy: 0.67232 | train_accuracy: 0.67261 | valid_auc: 0.72684 | valid_balanced_accuracy: 0.66889 | valid_accuracy: 0.66918 |  0:06:24s
epoch 23 | loss: 0.58915 | train_auc: 0.7437  | train_balanced_accuracy: 0.67881 | train_accuracy: 0.67918 | valid_auc: 0.73139 | valid_balanced_accuracy: 0.67244 | valid_accuracy: 0.6728  |  0:06:40s
epoch 24 | loss: 0.59427 | train_auc: 0.74307 | train_balanced_accuracy: 0.68328 | train_accuracy: 0.68374 | valid_auc: 0.72874 | valid_balanced_accuracy: 0.67486 | valid_accuracy: 0.67532 |  0:06:57s
epoch 25 | loss: 0.5891  | train_auc: 0.75076 | train_balanced_accuracy: 0.68249 | train_accuracy: 0.6824  | valid_auc: 0.73505 | valid_balanced_accuracy: 0.67245 | valid_accuracy: 0.67233 |  0:07:13s
epoch 26 | loss: 0.59284 | train_auc: 0.75262 | train_balanced_accuracy: 0.6892  | train_accuracy: 0.6896  | valid_auc: 0.74086 | valid_balanced_accuracy: 0.68185 | valid_accuracy: 0.68225 |  0:07:30s
epoch 27 | loss: 0.58631 | train_auc: 0.75047 | train_balanced_accuracy: 0.68348 | train_accuracy: 0.68362 | valid_auc: 0.73896 | valid_balanced_accuracy: 0.67536 | valid_accuracy: 0.67548 |  0:07:47s
epoch 28 | loss: 0.58519 | train_auc: 0.75553 | train_balanced_accuracy: 0.6904  | train_accuracy: 0.69075 | valid_auc: 0.74019 | valid_balanced_accuracy: 0.68019 | valid_accuracy: 0.68052 |  0:08:02s
epoch 29 | loss: 0.58844 | train_auc: 0.74917 | train_balanced_accuracy: 0.68538 | train_accuracy: 0.68579 | valid_auc: 0.73783 | valid_balanced_accuracy: 0.67602 | valid_accuracy: 0.67642 |  0:08:21s
epoch 30 | loss: 0.58812 | train_auc: 0.73465 | train_balanced_accuracy: 0.67257 | train_accuracy: 0.67284 | valid_auc: 0.73149 | valid_balanced_accuracy: 0.67254 | valid_accuracy: 0.6728  |  0:08:36s
epoch 31 | loss: 0.58378 | train_auc: 0.73598 | train_balanced_accuracy: 0.67133 | train_accuracy: 0.67143 | valid_auc: 0.72979 | valid_balanced_accuracy: 0.67003 | valid_accuracy: 0.67013 |  0:08:52s
epoch 32 | loss: 0.58577 | train_auc: 0.71622 | train_balanced_accuracy: 0.65908 | train_accuracy: 0.65907 | valid_auc: 0.7111  | valid_balanced_accuracy: 0.65865 | valid_accuracy: 0.65864 |  0:09:05s
epoch 33 | loss: 0.58726 | train_auc: 0.75748 | train_balanced_accuracy: 0.69223 | train_accuracy: 0.69283 | valid_auc: 0.73601 | valid_balanced_accuracy: 0.66942 | valid_accuracy: 0.66997 |  0:09:22s
epoch 34 | loss: 0.57633 | train_auc: 0.75318 | train_balanced_accuracy: 0.68834 | train_accuracy: 0.68858 | valid_auc: 0.73482 | valid_balanced_accuracy: 0.66768 | valid_accuracy: 0.66793 |  0:09:40s
epoch 35 | loss: 0.58464 | train_auc: 0.7405  | train_balanced_accuracy: 0.66472 | train_accuracy: 0.66435 | valid_auc: 0.72361 | valid_balanced_accuracy: 0.65397 | valid_accuracy: 0.6536  |  0:09:57s
epoch 36 | loss: 0.5756  | train_auc: 0.74283 | train_balanced_accuracy: 0.6817  | train_accuracy: 0.68158 | valid_auc: 0.7319  | valid_balanced_accuracy: 0.67213 | valid_accuracy: 0.67202 |  0:10:14s
epoch 37 | loss: 0.57768 | train_auc: 0.71427 | train_balanced_accuracy: 0.65849 | train_accuracy: 0.65836 | valid_auc: 0.71242 | valid_balanced_accuracy: 0.6598  | valid_accuracy: 0.65974 |  0:10:30s
epoch 38 | loss: 0.57925 | train_auc: 0.7013  | train_balanced_accuracy: 0.63265 | train_accuracy: 0.632   | valid_auc: 0.69948 | valid_balanced_accuracy: 0.63703 | valid_accuracy: 0.63645 |  0:10:47s
epoch 39 | loss: 0.57933 | train_auc: 0.69701 | train_balanced_accuracy: 0.64537 | train_accuracy: 0.64558 | valid_auc: 0.69893 | valid_balanced_accuracy: 0.64951 | valid_accuracy: 0.64983 |  0:11:04s
epoch 40 | loss: 0.57413 | train_auc: 0.69606 | train_balanced_accuracy: 0.63783 | train_accuracy: 0.63763 | valid_auc: 0.69288 | valid_balanced_accuracy: 0.63305 | valid_accuracy: 0.63283 |  0:11:21s
epoch 41 | loss: 0.57771 | train_auc: 0.68851 | train_balanced_accuracy: 0.6294  | train_accuracy: 0.62941 | valid_auc: 0.68736 | valid_balanced_accuracy: 0.62781 | valid_accuracy: 0.62779 |  0:11:36s
epoch 42 | loss: 0.57841 | train_auc: 0.72215 | train_balanced_accuracy: 0.6604  | train_accuracy: 0.66088 | valid_auc: 0.7168  | valid_balanced_accuracy: 0.65685 | valid_accuracy: 0.65738 |  0:11:54s
epoch 43 | loss: 0.57691 | train_auc: 0.71835 | train_balanced_accuracy: 0.66219 | train_accuracy: 0.66242 | valid_auc: 0.71244 | valid_balanced_accuracy: 0.65778 | valid_accuracy: 0.65801 |  0:12:10s
epoch 44 | loss: 0.57402 | train_auc: 0.76624 | train_balanced_accuracy: 0.69938 | train_accuracy: 0.69972 | valid_auc: 0.7454  | valid_balanced_accuracy: 0.68288 | valid_accuracy: 0.68319 |  0:12:27s
epoch 45 | loss: 0.57294 | train_auc: 0.70046 | train_balanced_accuracy: 0.65017 | train_accuracy: 0.65089 | valid_auc: 0.69467 | valid_balanced_accuracy: 0.64752 | valid_accuracy: 0.64825 |  0:12:43s
epoch 46 | loss: 0.57418 | train_auc: 0.70493 | train_balanced_accuracy: 0.652   | train_accuracy: 0.65258 | valid_auc: 0.69947 | valid_balanced_accuracy: 0.64481 | valid_accuracy: 0.64542 |  0:12:59s
epoch 47 | loss: 0.57444 | train_auc: 0.71327 | train_balanced_accuracy: 0.65561 | train_accuracy: 0.65604 | valid_auc: 0.6974  | valid_balanced_accuracy: 0.64355 | valid_accuracy: 0.644   |  0:13:16s
epoch 48 | loss: 0.57381 | train_auc: 0.73459 | train_balanced_accuracy: 0.67524 | train_accuracy: 0.67548 | valid_auc: 0.71863 | valid_balanced_accuracy: 0.65933 | valid_accuracy: 0.65958 |  0:13:34s
epoch 49 | loss: 0.57132 | train_auc: 0.7214  | train_balanced_accuracy: 0.66213 | train_accuracy: 0.66234 | valid_auc: 0.70907 | valid_balanced_accuracy: 0.65324 | valid_accuracy: 0.65345 |  0:13:51s
epoch 50 | loss: 0.56904 | train_auc: 0.76923 | train_balanced_accuracy: 0.70205 | train_accuracy: 0.70239 | valid_auc: 0.74934 | valid_balanced_accuracy: 0.68852 | valid_accuracy: 0.68886 |  0:14:08s
epoch 51 | loss: 0.57178 | train_auc: 0.77239 | train_balanced_accuracy: 0.70269 | train_accuracy: 0.70314 | valid_auc: 0.74518 | valid_balanced_accuracy: 0.68105 | valid_accuracy: 0.68146 |  0:14:26s
epoch 52 | loss: 0.56907 | train_auc: 0.75347 | train_balanced_accuracy: 0.68802 | train_accuracy: 0.68823 | valid_auc: 0.72925 | valid_balanced_accuracy: 0.66998 | valid_accuracy: 0.67013 |  0:14:42s
epoch 53 | loss: 0.57301 | train_auc: 0.76663 | train_balanced_accuracy: 0.69763 | train_accuracy: 0.69806 | valid_auc: 0.74094 | valid_balanced_accuracy: 0.67887 | valid_accuracy: 0.67926 |  0:15:00s
epoch 54 | loss: 0.57155 | train_auc: 0.75481 | train_balanced_accuracy: 0.68851 | train_accuracy: 0.68858 | valid_auc: 0.74094 | valid_balanced_accuracy: 0.67904 | valid_accuracy: 0.6791  |  0:15:16s
epoch 55 | loss: 0.57337 | train_auc: 0.74554 | train_balanced_accuracy: 0.6821  | train_accuracy: 0.68181 | valid_auc: 0.73206 | valid_balanced_accuracy: 0.66729 | valid_accuracy: 0.66698 |  0:15:33s
epoch 56 | loss: 0.5706  | train_auc: 0.77603 | train_balanced_accuracy: 0.70119 | train_accuracy: 0.70125 | valid_auc: 0.7472  | valid_balanced_accuracy: 0.68063 | valid_accuracy: 0.68067 |  0:15:51s
epoch 57 | loss: 0.56896 | train_auc: 0.77283 | train_balanced_accuracy: 0.70163 | train_accuracy: 0.70188 | valid_auc: 0.73969 | valid_balanced_accuracy: 0.67728 | valid_accuracy: 0.67753 |  0:16:08s
epoch 58 | loss: 0.56764 | train_auc: 0.73368 | train_balanced_accuracy: 0.66705 | train_accuracy: 0.66682 | valid_auc: 0.71407 | valid_balanced_accuracy: 0.65717 | valid_accuracy: 0.65691 |  0:16:27s
epoch 59 | loss: 0.57276 | train_auc: 0.71983 | train_balanced_accuracy: 0.66233 | train_accuracy: 0.6625  | valid_auc: 0.70986 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65675 |  0:16:45s
epoch 60 | loss: 0.5708  | train_auc: 0.73572 | train_balanced_accuracy: 0.6716  | train_accuracy: 0.67162 | valid_auc: 0.72347 | valid_balanced_accuracy: 0.66423 | valid_accuracy: 0.66431 |  0:17:03s
epoch 61 | loss: 0.57038 | train_auc: 0.76548 | train_balanced_accuracy: 0.69643 | train_accuracy: 0.69677 | valid_auc: 0.73548 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.67312 |  0:17:20s
epoch 62 | loss: 0.55967 | train_auc: 0.75086 | train_balanced_accuracy: 0.68417 | train_accuracy: 0.68433 | valid_auc: 0.72645 | valid_balanced_accuracy: 0.66623 | valid_accuracy: 0.66635 |  0:17:37s
epoch 63 | loss: 0.56442 | train_auc: 0.71615 | train_balanced_accuracy: 0.6622  | train_accuracy: 0.66254 | valid_auc: 0.70829 | valid_balanced_accuracy: 0.65347 | valid_accuracy: 0.65376 |  0:17:52s
epoch 64 | loss: 0.56072 | train_auc: 0.71762 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.6608  | valid_auc: 0.71078 | valid_balanced_accuracy: 0.6573  | valid_accuracy: 0.65707 |  0:18:09s
epoch 65 | loss: 0.56971 | train_auc: 0.71915 | train_balanced_accuracy: 0.66377 | train_accuracy: 0.66364 | valid_auc: 0.70385 | valid_balanced_accuracy: 0.65436 | valid_accuracy: 0.65423 |  0:18:26s
epoch 66 | loss: 0.56264 | train_auc: 0.74533 | train_balanced_accuracy: 0.68338 | train_accuracy: 0.68362 | valid_auc: 0.72639 | valid_balanced_accuracy: 0.67178 | valid_accuracy: 0.67202 |  0:18:43s
epoch 67 | loss: 0.56628 | train_auc: 0.73954 | train_balanced_accuracy: 0.67723 | train_accuracy: 0.67745 | valid_auc: 0.72075 | valid_balanced_accuracy: 0.666   | valid_accuracy: 0.66619 |  0:18:58s
epoch 68 | loss: 0.55868 | train_auc: 0.76883 | train_balanced_accuracy: 0.69757 | train_accuracy: 0.69799 | valid_auc: 0.73401 | valid_balanced_accuracy: 0.67003 | valid_accuracy: 0.67044 |  0:19:14s
epoch 69 | loss: 0.56584 | train_auc: 0.78292 | train_balanced_accuracy: 0.71013 | train_accuracy: 0.71065 | valid_auc: 0.74481 | valid_balanced_accuracy: 0.68237 | valid_accuracy: 0.68288 |  0:19:32s
epoch 70 | loss: 0.56008 | train_auc: 0.7883  | train_balanced_accuracy: 0.71503 | train_accuracy: 0.71534 | valid_auc: 0.75109 | valid_balanced_accuracy: 0.68938 | valid_accuracy: 0.68964 |  0:19:48s
epoch 71 | loss: 0.56256 | train_auc: 0.77349 | train_balanced_accuracy: 0.70514 | train_accuracy: 0.70542 | valid_auc: 0.74696 | valid_balanced_accuracy: 0.6829  | valid_accuracy: 0.68319 |  0:20:04s
epoch 72 | loss: 0.55409 | train_auc: 0.7733  | train_balanced_accuracy: 0.70608 | train_accuracy: 0.70644 | valid_auc: 0.74665 | valid_balanced_accuracy: 0.68222 | valid_accuracy: 0.68256 |  0:20:20s
epoch 73 | loss: 0.55577 | train_auc: 0.76299 | train_balanced_accuracy: 0.69528 | train_accuracy: 0.69555 | valid_auc: 0.7412  | valid_balanced_accuracy: 0.67968 | valid_accuracy: 0.67989 |  0:20:38s
epoch 74 | loss: 0.56    | train_auc: 0.77574 | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70727 | valid_auc: 0.74919 | valid_balanced_accuracy: 0.68867 | valid_accuracy: 0.68901 |  0:20:54s
epoch 75 | loss: 0.55424 | train_auc: 0.78049 | train_balanced_accuracy: 0.70805 | train_accuracy: 0.70845 | valid_auc: 0.75144 | valid_balanced_accuracy: 0.68764 | valid_accuracy: 0.68807 |  0:21:10s
epoch 76 | loss: 0.55646 | train_auc: 0.76312 | train_balanced_accuracy: 0.69476 | train_accuracy: 0.69476 | valid_auc: 0.74219 | valid_balanced_accuracy: 0.67738 | valid_accuracy: 0.67737 |  0:21:27s
epoch 77 | loss: 0.55416 | train_auc: 0.72319 | train_balanced_accuracy: 0.66537 | train_accuracy: 0.66529 | valid_auc: 0.71466 | valid_balanced_accuracy: 0.66232 | valid_accuracy: 0.66226 |  0:21:45s
epoch 78 | loss: 0.55478 | train_auc: 0.71606 | train_balanced_accuracy: 0.65121 | train_accuracy: 0.65069 | valid_auc: 0.71012 | valid_balanced_accuracy: 0.64704 | valid_accuracy: 0.64652 |  0:22:03s
epoch 79 | loss: 0.55758 | train_auc: 0.76843 | train_balanced_accuracy: 0.69986 | train_accuracy: 0.70011 | valid_auc: 0.74552 | valid_balanced_accuracy: 0.68639 | valid_accuracy: 0.68665 |  0:22:21s
epoch 80 | loss: 0.56225 | train_auc: 0.76137 | train_balanced_accuracy: 0.6946  | train_accuracy: 0.69492 | valid_auc: 0.74029 | valid_balanced_accuracy: 0.681   | valid_accuracy: 0.6813  |  0:22:38s
epoch 81 | loss: 0.55153 | train_auc: 0.78596 | train_balanced_accuracy: 0.71249 | train_accuracy: 0.71294 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.69027 |  0:22:54s
epoch 82 | loss: 0.55328 | train_auc: 0.78821 | train_balanced_accuracy: 0.71447 | train_accuracy: 0.71475 | valid_auc: 0.75489 | valid_balanced_accuracy: 0.68779 | valid_accuracy: 0.68807 |  0:23:09s
epoch 83 | loss: 0.55157 | train_auc: 0.76822 | train_balanced_accuracy: 0.69989 | train_accuracy: 0.70011 | valid_auc: 0.73778 | valid_balanced_accuracy: 0.67869 | valid_accuracy: 0.67894 |  0:23:24s
epoch 84 | loss: 0.55199 | train_auc: 0.73945 | train_balanced_accuracy: 0.67608 | train_accuracy: 0.67638 | valid_auc: 0.72079 | valid_balanced_accuracy: 0.66309 | valid_accuracy: 0.66336 |  0:23:42s
epoch 85 | loss: 0.55793 | train_auc: 0.79556 | train_balanced_accuracy: 0.72153 | train_accuracy: 0.72179 | valid_auc: 0.75532 | valid_balanced_accuracy: 0.68396 | valid_accuracy: 0.68414 |  0:23:58s
epoch 86 | loss: 0.55363 | train_auc: 0.78196 | train_balanced_accuracy: 0.7106  | train_accuracy: 0.71081 | valid_auc: 0.74508 | valid_balanced_accuracy: 0.67686 | valid_accuracy: 0.67705 |  0:24:16s
epoch 87 | loss: 0.54852 | train_auc: 0.79215 | train_balanced_accuracy: 0.7136  | train_accuracy: 0.71361 | valid_auc: 0.75756 | valid_balanced_accuracy: 0.68949 | valid_accuracy: 0.68949 |  0:24:32s
epoch 88 | loss: 0.55554 | train_auc: 0.76012 | train_balanced_accuracy: 0.69294 | train_accuracy: 0.69275 | valid_auc: 0.74098 | valid_balanced_accuracy: 0.68324 | valid_accuracy: 0.68303 |  0:24:48s
epoch 89 | loss: 0.55007 | train_auc: 0.7548  | train_balanced_accuracy: 0.68985 | train_accuracy: 0.68968 | valid_auc: 0.73557 | valid_balanced_accuracy: 0.67945 | valid_accuracy: 0.67926 |  0:25:03s
epoch 90 | loss: 0.55021 | train_auc: 0.71323 | train_balanced_accuracy: 0.6545  | train_accuracy: 0.65384 | valid_auc: 0.70676 | valid_balanced_accuracy: 0.65161 | valid_accuracy: 0.65093 |  0:25:20s
epoch 91 | loss: 0.55647 | train_auc: 0.73917 | train_balanced_accuracy: 0.67927 | train_accuracy: 0.67953 | valid_auc: 0.72051 | valid_balanced_accuracy: 0.66262 | valid_accuracy: 0.66289 |  0:25:38s
epoch 92 | loss: 0.54858 | train_auc: 0.75009 | train_balanced_accuracy: 0.68584 | train_accuracy: 0.68599 | valid_auc: 0.73002 | valid_balanced_accuracy: 0.66956 | valid_accuracy: 0.66966 |  0:25:56s
epoch 93 | loss: 0.54956 | train_auc: 0.79864 | train_balanced_accuracy: 0.7227  | train_accuracy: 0.72313 | valid_auc: 0.7543  | valid_balanced_accuracy: 0.68607 | valid_accuracy: 0.6865  |  0:26:14s
epoch 94 | loss: 0.55415 | train_auc: 0.77715 | train_balanced_accuracy: 0.70787 | train_accuracy: 0.70814 | valid_auc: 0.74943 | valid_balanced_accuracy: 0.68595 | valid_accuracy: 0.68618 |  0:26:31s
epoch 95 | loss: 0.54812 | train_auc: 0.77001 | train_balanced_accuracy: 0.70219 | train_accuracy: 0.70243 | valid_auc: 0.74348 | valid_balanced_accuracy: 0.68122 | valid_accuracy: 0.68146 |  0:26:48s
epoch 96 | loss: 0.54787 | train_auc: 0.7025  | train_balanced_accuracy: 0.65257 | train_accuracy: 0.65282 | valid_auc: 0.69369 | valid_balanced_accuracy: 0.64488 | valid_accuracy: 0.64511 |  0:27:06s
epoch 97 | loss: 0.54901 | train_auc: 0.69572 | train_balanced_accuracy: 0.64806 | train_accuracy: 0.6481  | valid_auc: 0.69042 | valid_balanced_accuracy: 0.64177 | valid_accuracy: 0.6418  |  0:27:23s
epoch 98 | loss: 0.54923 | train_auc: 0.7296  | train_balanced_accuracy: 0.67253 | train_accuracy: 0.67277 | valid_auc: 0.71424 | valid_balanced_accuracy: 0.66016 | valid_accuracy: 0.66037 |  0:27:39s
epoch 99 | loss: 0.5514  | train_auc: 0.75926 | train_balanced_accuracy: 0.69116 | train_accuracy: 0.69153 | valid_auc: 0.7293  | valid_balanced_accuracy: 0.6679  | valid_accuracy: 0.66824 |  0:27:56s
epoch 100| loss: 0.54641 | train_auc: 0.75382 | train_balanced_accuracy: 0.69059 | train_accuracy: 0.69075 | valid_auc: 0.72972 | valid_balanced_accuracy: 0.66998 | valid_accuracy: 0.67013 |  0:28:15s
epoch 101| loss: 0.55187 | train_auc: 0.78138 | train_balanced_accuracy: 0.70855 | train_accuracy: 0.70873 | valid_auc: 0.73979 | valid_balanced_accuracy: 0.67762 | valid_accuracy: 0.67784 |  0:28:34s

Early stopping occurred at epoch 101 with best_epoch = 81 and best_valid_accuracy = 0.69027
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 56/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.691 total time=28.7min
[CV 1/5; 57/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83059 | train_auc: 0.54522 | train_balanced_accuracy: 0.53378 | train_accuracy: 0.53311 | valid_auc: 0.5356  | valid_balanced_accuracy: 0.52501 | valid_accuracy: 0.52424 |  0:00:15s
epoch 1  | loss: 0.75907 | train_auc: 0.50997 | train_balanced_accuracy: 0.50789 | train_accuracy: 0.50557 | valid_auc: 0.50001 | valid_balanced_accuracy: 0.50267 | valid_accuracy: 0.50031 |  0:00:33s
epoch 2  | loss: 0.71429 | train_auc: 0.56995 | train_balanced_accuracy: 0.54673 | train_accuracy: 0.54495 | valid_auc: 0.562   | valid_balanced_accuracy: 0.54183 | valid_accuracy: 0.53997 |  0:00:51s
epoch 3  | loss: 0.69127 | train_auc: 0.57073 | train_balanced_accuracy: 0.54353 | train_accuracy: 0.54161 | valid_auc: 0.56127 | valid_balanced_accuracy: 0.53943 | valid_accuracy: 0.53746 |  0:01:08s
epoch 4  | loss: 0.67558 | train_auc: 0.57106 | train_balanced_accuracy: 0.54484 | train_accuracy: 0.54255 | valid_auc: 0.56171 | valid_balanced_accuracy: 0.53292 | valid_accuracy: 0.53053 |  0:01:23s
epoch 5  | loss: 0.67382 | train_auc: 0.58278 | train_balanced_accuracy: 0.54655 | train_accuracy: 0.54428 | valid_auc: 0.57517 | valid_balanced_accuracy: 0.53554 | valid_accuracy: 0.53321 |  0:01:40s
epoch 6  | loss: 0.67298 | train_auc: 0.56852 | train_balanced_accuracy: 0.55031 | train_accuracy: 0.54794 | valid_auc: 0.55685 | valid_balanced_accuracy: 0.54083 | valid_accuracy: 0.5384  |  0:01:57s
epoch 7  | loss: 0.66629 | train_auc: 0.60617 | train_balanced_accuracy: 0.56739 | train_accuracy: 0.56557 | valid_auc: 0.59791 | valid_balanced_accuracy: 0.56262 | valid_accuracy: 0.56075 |  0:02:13s
epoch 8  | loss: 0.65692 | train_auc: 0.60459 | train_balanced_accuracy: 0.57446 | train_accuracy: 0.57317 | valid_auc: 0.59372 | valid_balanced_accuracy: 0.56725 | valid_accuracy: 0.56594 |  0:02:30s
epoch 9  | loss: 0.65924 | train_auc: 0.61092 | train_balanced_accuracy: 0.5591  | train_accuracy: 0.55688 | valid_auc: 0.59591 | valid_balanced_accuracy: 0.54713 | valid_accuracy: 0.54485 |  0:02:47s
epoch 10 | loss: 0.65381 | train_auc: 0.62447 | train_balanced_accuracy: 0.57335 | train_accuracy: 0.57155 | valid_auc: 0.61251 | valid_balanced_accuracy: 0.55832 | valid_accuracy: 0.5565  |  0:03:04s
epoch 11 | loss: 0.65097 | train_auc: 0.63998 | train_balanced_accuracy: 0.58092 | train_accuracy: 0.57938 | valid_auc: 0.62714 | valid_balanced_accuracy: 0.56469 | valid_accuracy: 0.56311 |  0:03:20s
epoch 12 | loss: 0.64605 | train_auc: 0.64897 | train_balanced_accuracy: 0.58625 | train_accuracy: 0.58501 | valid_auc: 0.64048 | valid_balanced_accuracy: 0.58172 | valid_accuracy: 0.58042 |  0:03:38s
epoch 13 | loss: 0.64845 | train_auc: 0.64269 | train_balanced_accuracy: 0.58864 | train_accuracy: 0.58757 | valid_auc: 0.62785 | valid_balanced_accuracy: 0.57667 | valid_accuracy: 0.57554 |  0:03:53s
epoch 14 | loss: 0.64382 | train_auc: 0.66177 | train_balanced_accuracy: 0.60778 | train_accuracy: 0.60728 | valid_auc: 0.65158 | valid_balanced_accuracy: 0.59909 | valid_accuracy: 0.59852 |  0:04:10s
epoch 15 | loss: 0.64265 | train_auc: 0.67059 | train_balanced_accuracy: 0.61398 | train_accuracy: 0.61361 | valid_auc: 0.66142 | valid_balanced_accuracy: 0.60479 | valid_accuracy: 0.60434 |  0:04:28s
epoch 16 | loss: 0.63722 | train_auc: 0.66695 | train_balanced_accuracy: 0.61538 | train_accuracy: 0.61519 | valid_auc: 0.6571  | valid_balanced_accuracy: 0.60598 | valid_accuracy: 0.60576 |  0:04:41s
epoch 17 | loss: 0.64169 | train_auc: 0.66384 | train_balanced_accuracy: 0.6069  | train_accuracy: 0.60622 | valid_auc: 0.65734 | valid_balanced_accuracy: 0.59123 | valid_accuracy: 0.59049 |  0:05:01s
epoch 18 | loss: 0.63334 | train_auc: 0.67456 | train_balanced_accuracy: 0.62445 | train_accuracy: 0.62436 | valid_auc: 0.66342 | valid_balanced_accuracy: 0.61173 | valid_accuracy: 0.61158 |  0:05:18s
epoch 19 | loss: 0.63277 | train_auc: 0.67004 | train_balanced_accuracy: 0.61888 | train_accuracy: 0.61893 | valid_auc: 0.66764 | valid_balanced_accuracy: 0.62287 | valid_accuracy: 0.62291 |  0:05:37s
epoch 20 | loss: 0.63519 | train_auc: 0.66737 | train_balanced_accuracy: 0.61551 | train_accuracy: 0.61519 | valid_auc: 0.65902 | valid_balanced_accuracy: 0.60894 | valid_accuracy: 0.60859 |  0:05:55s
epoch 21 | loss: 0.6305  | train_auc: 0.68045 | train_balanced_accuracy: 0.63315 | train_accuracy: 0.63333 | valid_auc: 0.66911 | valid_balanced_accuracy: 0.62573 | valid_accuracy: 0.6259  |  0:06:11s
epoch 22 | loss: 0.63303 | train_auc: 0.68124 | train_balanced_accuracy: 0.63686 | train_accuracy: 0.63722 | valid_auc: 0.67624 | valid_balanced_accuracy: 0.63924 | valid_accuracy: 0.6396  |  0:06:28s
epoch 23 | loss: 0.63044 | train_auc: 0.68842 | train_balanced_accuracy: 0.64632 | train_accuracy: 0.64686 | valid_auc: 0.67803 | valid_balanced_accuracy: 0.64403 | valid_accuracy: 0.64463 |  0:06:45s
epoch 24 | loss: 0.63461 | train_auc: 0.68804 | train_balanced_accuracy: 0.63865 | train_accuracy: 0.63891 | valid_auc: 0.67567 | valid_balanced_accuracy: 0.63853 | valid_accuracy: 0.63881 |  0:07:01s
epoch 25 | loss: 0.62994 | train_auc: 0.69095 | train_balanced_accuracy: 0.64224 | train_accuracy: 0.64246 | valid_auc: 0.68031 | valid_balanced_accuracy: 0.63921 | valid_accuracy: 0.63944 |  0:07:17s
epoch 26 | loss: 0.63017 | train_auc: 0.69743 | train_balanced_accuracy: 0.64691 | train_accuracy: 0.64714 | valid_auc: 0.68461 | valid_balanced_accuracy: 0.6438  | valid_accuracy: 0.644   |  0:07:33s
epoch 27 | loss: 0.62868 | train_auc: 0.70238 | train_balanced_accuracy: 0.65776 | train_accuracy: 0.65819 | valid_auc: 0.68981 | valid_balanced_accuracy: 0.64807 | valid_accuracy: 0.64857 |  0:07:50s
epoch 28 | loss: 0.6272  | train_auc: 0.7053  | train_balanced_accuracy: 0.65652 | train_accuracy: 0.65693 | valid_auc: 0.68774 | valid_balanced_accuracy: 0.64292 | valid_accuracy: 0.64337 |  0:08:07s
epoch 29 | loss: 0.62432 | train_auc: 0.70742 | train_balanced_accuracy: 0.65626 | train_accuracy: 0.65658 | valid_auc: 0.69361 | valid_balanced_accuracy: 0.64542 | valid_accuracy: 0.64573 |  0:08:25s
epoch 30 | loss: 0.62496 | train_auc: 0.70739 | train_balanced_accuracy: 0.65438 | train_accuracy: 0.65465 | valid_auc: 0.6901  | valid_balanced_accuracy: 0.64196 | valid_accuracy: 0.64227 |  0:08:43s
epoch 31 | loss: 0.62197 | train_auc: 0.70941 | train_balanced_accuracy: 0.65669 | train_accuracy: 0.65701 | valid_auc: 0.69446 | valid_balanced_accuracy: 0.64695 | valid_accuracy: 0.64731 |  0:08:58s
epoch 32 | loss: 0.62636 | train_auc: 0.70668 | train_balanced_accuracy: 0.65293 | train_accuracy: 0.65316 | valid_auc: 0.69466 | valid_balanced_accuracy: 0.64684 | valid_accuracy: 0.64715 |  0:09:15s
epoch 33 | loss: 0.62307 | train_auc: 0.70809 | train_balanced_accuracy: 0.65495 | train_accuracy: 0.65536 | valid_auc: 0.69974 | valid_balanced_accuracy: 0.65441 | valid_accuracy: 0.65486 |  0:09:30s
epoch 34 | loss: 0.62048 | train_auc: 0.70906 | train_balanced_accuracy: 0.65139 | train_accuracy: 0.65178 | valid_auc: 0.69561 | valid_balanced_accuracy: 0.64705 | valid_accuracy: 0.64747 |  0:09:48s
epoch 35 | loss: 0.61856 | train_auc: 0.7079  | train_balanced_accuracy: 0.65602 | train_accuracy: 0.65642 | valid_auc: 0.69634 | valid_balanced_accuracy: 0.64182 | valid_accuracy: 0.64227 |  0:10:05s
epoch 36 | loss: 0.62279 | train_auc: 0.69606 | train_balanced_accuracy: 0.64371 | train_accuracy: 0.64411 | valid_auc: 0.68097 | valid_balanced_accuracy: 0.6367  | valid_accuracy: 0.63708 |  0:10:23s
epoch 37 | loss: 0.61737 | train_auc: 0.68081 | train_balanced_accuracy: 0.63223 | train_accuracy: 0.63246 | valid_auc: 0.66735 | valid_balanced_accuracy: 0.61882 | valid_accuracy: 0.61898 |  0:10:39s
epoch 38 | loss: 0.61908 | train_auc: 0.68344 | train_balanced_accuracy: 0.6329  | train_accuracy: 0.63317 | valid_auc: 0.66955 | valid_balanced_accuracy: 0.623   | valid_accuracy: 0.62323 |  0:10:57s
epoch 39 | loss: 0.61844 | train_auc: 0.66263 | train_balanced_accuracy: 0.61827 | train_accuracy: 0.61873 | valid_auc: 0.65127 | valid_balanced_accuracy: 0.61086 | valid_accuracy: 0.61127 |  0:11:13s
epoch 40 | loss: 0.61701 | train_auc: 0.65964 | train_balanced_accuracy: 0.6223  | train_accuracy: 0.62266 | valid_auc: 0.65425 | valid_balanced_accuracy: 0.61206 | valid_accuracy: 0.61237 |  0:11:30s
epoch 41 | loss: 0.61717 | train_auc: 0.65704 | train_balanced_accuracy: 0.61432 | train_accuracy: 0.6144  | valid_auc: 0.64411 | valid_balanced_accuracy: 0.60602 | valid_accuracy: 0.60607 |  0:11:48s
epoch 42 | loss: 0.61311 | train_auc: 0.65829 | train_balanced_accuracy: 0.61793 | train_accuracy: 0.61834 | valid_auc: 0.6493  | valid_balanced_accuracy: 0.60889 | valid_accuracy: 0.60922 |  0:12:05s
epoch 43 | loss: 0.6168  | train_auc: 0.65366 | train_balanced_accuracy: 0.61409 | train_accuracy: 0.61456 | valid_auc: 0.64182 | valid_balanced_accuracy: 0.6077  | valid_accuracy: 0.60812 |  0:12:22s
epoch 44 | loss: 0.61382 | train_auc: 0.6553  | train_balanced_accuracy: 0.61107 | train_accuracy: 0.61125 | valid_auc: 0.64773 | valid_balanced_accuracy: 0.60858 | valid_accuracy: 0.60875 |  0:12:38s
epoch 45 | loss: 0.61573 | train_auc: 0.68501 | train_balanced_accuracy: 0.63614 | train_accuracy: 0.63647 | valid_auc: 0.67454 | valid_balanced_accuracy: 0.6272  | valid_accuracy: 0.62748 |  0:12:53s
epoch 46 | loss: 0.6146  | train_auc: 0.70643 | train_balanced_accuracy: 0.65566 | train_accuracy: 0.65607 | valid_auc: 0.69131 | valid_balanced_accuracy: 0.64045 | valid_accuracy: 0.64086 |  0:13:10s
epoch 47 | loss: 0.61369 | train_auc: 0.69611 | train_balanced_accuracy: 0.64389 | train_accuracy: 0.64415 | valid_auc: 0.68589 | valid_balanced_accuracy: 0.63688 | valid_accuracy: 0.63708 |  0:13:28s
epoch 48 | loss: 0.60827 | train_auc: 0.6848  | train_balanced_accuracy: 0.63408 | train_accuracy: 0.63459 | valid_auc: 0.68115 | valid_balanced_accuracy: 0.63203 | valid_accuracy: 0.63251 |  0:13:43s
epoch 49 | loss: 0.61121 | train_auc: 0.67743 | train_balanced_accuracy: 0.63449 | train_accuracy: 0.6349  | valid_auc: 0.67199 | valid_balanced_accuracy: 0.62961 | valid_accuracy: 0.63    |  0:14:00s
epoch 50 | loss: 0.61083 | train_auc: 0.69998 | train_balanced_accuracy: 0.64593 | train_accuracy: 0.64588 | valid_auc: 0.68479 | valid_balanced_accuracy: 0.63139 | valid_accuracy: 0.63126 |  0:14:16s
epoch 51 | loss: 0.60833 | train_auc: 0.71645 | train_balanced_accuracy: 0.66429 | train_accuracy: 0.66469 | valid_auc: 0.6986  | valid_balanced_accuracy: 0.65135 | valid_accuracy: 0.65172 |  0:14:34s
epoch 52 | loss: 0.60754 | train_auc: 0.73502 | train_balanced_accuracy: 0.67651 | train_accuracy: 0.67712 | valid_auc: 0.71462 | valid_balanced_accuracy: 0.66037 | valid_accuracy: 0.661   |  0:14:48s
epoch 53 | loss: 0.60857 | train_auc: 0.7315  | train_balanced_accuracy: 0.67278 | train_accuracy: 0.67319 | valid_auc: 0.71378 | valid_balanced_accuracy: 0.656   | valid_accuracy: 0.65644 |  0:15:03s
epoch 54 | loss: 0.60902 | train_auc: 0.71657 | train_balanced_accuracy: 0.66189 | train_accuracy: 0.66229 | valid_auc: 0.70758 | valid_balanced_accuracy: 0.656   | valid_accuracy: 0.65644 |  0:15:21s
epoch 55 | loss: 0.61208 | train_auc: 0.72383 | train_balanced_accuracy: 0.66752 | train_accuracy: 0.66791 | valid_auc: 0.71232 | valid_balanced_accuracy: 0.65713 | valid_accuracy: 0.65754 |  0:15:38s
epoch 56 | loss: 0.60778 | train_auc: 0.71319 | train_balanced_accuracy: 0.65813 | train_accuracy: 0.65851 | valid_auc: 0.70451 | valid_balanced_accuracy: 0.65887 | valid_accuracy: 0.65927 |  0:15:56s
epoch 57 | loss: 0.60402 | train_auc: 0.71332 | train_balanced_accuracy: 0.66028 | train_accuracy: 0.66063 | valid_auc: 0.702   | valid_balanced_accuracy: 0.65558 | valid_accuracy: 0.65596 |  0:16:13s
epoch 58 | loss: 0.6078  | train_auc: 0.71687 | train_balanced_accuracy: 0.65849 | train_accuracy: 0.65898 | valid_auc: 0.70728 | valid_balanced_accuracy: 0.65437 | valid_accuracy: 0.65486 |  0:16:28s
epoch 59 | loss: 0.60501 | train_auc: 0.71632 | train_balanced_accuracy: 0.6614  | train_accuracy: 0.66174 | valid_auc: 0.70821 | valid_balanced_accuracy: 0.6581  | valid_accuracy: 0.65848 |  0:16:45s
epoch 60 | loss: 0.60749 | train_auc: 0.69493 | train_balanced_accuracy: 0.64414 | train_accuracy: 0.64407 | valid_auc: 0.69634 | valid_balanced_accuracy: 0.64202 | valid_accuracy: 0.64196 |  0:17:02s
epoch 61 | loss: 0.60835 | train_auc: 0.69832 | train_balanced_accuracy: 0.64744 | train_accuracy: 0.64733 | valid_auc: 0.69672 | valid_balanced_accuracy: 0.64538 | valid_accuracy: 0.64526 |  0:17:19s
epoch 62 | loss: 0.60287 | train_auc: 0.70574 | train_balanced_accuracy: 0.65169 | train_accuracy: 0.65174 | valid_auc: 0.70298 | valid_balanced_accuracy: 0.64552 | valid_accuracy: 0.64558 |  0:17:36s
epoch 63 | loss: 0.60748 | train_auc: 0.70682 | train_balanced_accuracy: 0.65377 | train_accuracy: 0.65394 | valid_auc: 0.70017 | valid_balanced_accuracy: 0.64494 | valid_accuracy: 0.64511 |  0:17:52s
epoch 64 | loss: 0.60553 | train_auc: 0.71915 | train_balanced_accuracy: 0.66301 | train_accuracy: 0.66319 | valid_auc: 0.70945 | valid_balanced_accuracy: 0.65667 | valid_accuracy: 0.65691 |  0:18:08s
epoch 65 | loss: 0.60532 | train_auc: 0.71976 | train_balanced_accuracy: 0.66707 | train_accuracy: 0.66748 | valid_auc: 0.70961 | valid_balanced_accuracy: 0.66119 | valid_accuracy: 0.66163 |  0:18:25s
epoch 66 | loss: 0.60308 | train_auc: 0.72322 | train_balanced_accuracy: 0.66529 | train_accuracy: 0.66555 | valid_auc: 0.70742 | valid_balanced_accuracy: 0.65208 | valid_accuracy: 0.65234 |  0:18:41s
epoch 67 | loss: 0.60333 | train_auc: 0.72285 | train_balanced_accuracy: 0.66127 | train_accuracy: 0.66213 | valid_auc: 0.70904 | valid_balanced_accuracy: 0.6571  | valid_accuracy: 0.65801 |  0:18:58s
epoch 68 | loss: 0.60597 | train_auc: 0.73756 | train_balanced_accuracy: 0.67569 | train_accuracy: 0.67602 | valid_auc: 0.71903 | valid_balanced_accuracy: 0.65919 | valid_accuracy: 0.65958 |  0:19:15s
epoch 69 | loss: 0.60376 | train_auc: 0.72785 | train_balanced_accuracy: 0.66987 | train_accuracy: 0.67004 | valid_auc: 0.71472 | valid_balanced_accuracy: 0.65555 | valid_accuracy: 0.65581 |  0:19:33s
epoch 70 | loss: 0.60376 | train_auc: 0.72341 | train_balanced_accuracy: 0.66607 | train_accuracy: 0.6663  | valid_auc: 0.7105  | valid_balanced_accuracy: 0.65554 | valid_accuracy: 0.65581 |  0:19:49s
epoch 71 | loss: 0.60453 | train_auc: 0.73879 | train_balanced_accuracy: 0.67685 | train_accuracy: 0.6772  | valid_auc: 0.72179 | valid_balanced_accuracy: 0.6653  | valid_accuracy: 0.66572 |  0:20:04s
epoch 72 | loss: 0.60121 | train_auc: 0.74437 | train_balanced_accuracy: 0.68053 | train_accuracy: 0.68086 | valid_auc: 0.72206 | valid_balanced_accuracy: 0.66629 | valid_accuracy: 0.66667 |  0:20:22s
epoch 73 | loss: 0.60189 | train_auc: 0.74364 | train_balanced_accuracy: 0.68061 | train_accuracy: 0.68098 | valid_auc: 0.7207  | valid_balanced_accuracy: 0.66484 | valid_accuracy: 0.66525 |  0:20:39s
epoch 74 | loss: 0.60263 | train_auc: 0.74158 | train_balanced_accuracy: 0.67879 | train_accuracy: 0.67893 | valid_auc: 0.71572 | valid_balanced_accuracy: 0.65942 | valid_accuracy: 0.65958 |  0:20:56s
epoch 75 | loss: 0.60467 | train_auc: 0.72955 | train_balanced_accuracy: 0.67132 | train_accuracy: 0.67153 | valid_auc: 0.70814 | valid_balanced_accuracy: 0.65479 | valid_accuracy: 0.65502 |  0:21:11s
epoch 76 | loss: 0.60382 | train_auc: 0.70872 | train_balanced_accuracy: 0.6546  | train_accuracy: 0.65489 | valid_auc: 0.68614 | valid_balanced_accuracy: 0.63978 | valid_accuracy: 0.64007 |  0:21:30s
epoch 77 | loss: 0.60422 | train_auc: 0.71753 | train_balanced_accuracy: 0.66104 | train_accuracy: 0.66126 | valid_auc: 0.69557 | valid_balanced_accuracy: 0.64159 | valid_accuracy: 0.6418  |  0:21:45s
epoch 78 | loss: 0.59986 | train_auc: 0.71908 | train_balanced_accuracy: 0.66282 | train_accuracy: 0.66319 | valid_auc: 0.69742 | valid_balanced_accuracy: 0.64744 | valid_accuracy: 0.64778 |  0:22:00s
epoch 79 | loss: 0.60197 | train_auc: 0.70884 | train_balanced_accuracy: 0.65368 | train_accuracy: 0.6541  | valid_auc: 0.68821 | valid_balanced_accuracy: 0.63996 | valid_accuracy: 0.64038 |  0:22:17s
epoch 80 | loss: 0.60415 | train_auc: 0.74361 | train_balanced_accuracy: 0.68222 | train_accuracy: 0.68239 | valid_auc: 0.72164 | valid_balanced_accuracy: 0.66596 | valid_accuracy: 0.66619 |  0:22:35s
epoch 81 | loss: 0.5956  | train_auc: 0.7445  | train_balanced_accuracy: 0.68328 | train_accuracy: 0.68342 | valid_auc: 0.72138 | valid_balanced_accuracy: 0.66285 | valid_accuracy: 0.66305 |  0:22:51s
epoch 82 | loss: 0.60139 | train_auc: 0.7445  | train_balanced_accuracy: 0.68045 | train_accuracy: 0.68062 | valid_auc: 0.719   | valid_balanced_accuracy: 0.66614 | valid_accuracy: 0.66635 |  0:23:08s
epoch 83 | loss: 0.5998  | train_auc: 0.70873 | train_balanced_accuracy: 0.65863 | train_accuracy: 0.65894 | valid_auc: 0.68633 | valid_balanced_accuracy: 0.63963 | valid_accuracy: 0.63991 |  0:23:26s
epoch 84 | loss: 0.60018 | train_auc: 0.6966  | train_balanced_accuracy: 0.64545 | train_accuracy: 0.64564 | valid_auc: 0.67918 | valid_balanced_accuracy: 0.63727 | valid_accuracy: 0.63739 |  0:23:42s
epoch 85 | loss: 0.60423 | train_auc: 0.69392 | train_balanced_accuracy: 0.64415 | train_accuracy: 0.64442 | valid_auc: 0.67423 | valid_balanced_accuracy: 0.62687 | valid_accuracy: 0.62716 |  0:23:59s
epoch 86 | loss: 0.60208 | train_auc: 0.71976 | train_balanced_accuracy: 0.66296 | train_accuracy: 0.66327 | valid_auc: 0.70236 | valid_balanced_accuracy: 0.65002 | valid_accuracy: 0.6503  |  0:24:17s
epoch 87 | loss: 0.59542 | train_auc: 0.72781 | train_balanced_accuracy: 0.67009 | train_accuracy: 0.67047 | valid_auc: 0.70475 | valid_balanced_accuracy: 0.65578 | valid_accuracy: 0.65612 |  0:24:33s
epoch 88 | loss: 0.59939 | train_auc: 0.73595 | train_balanced_accuracy: 0.67739 | train_accuracy: 0.67767 | valid_auc: 0.71292 | valid_balanced_accuracy: 0.65453 | valid_accuracy: 0.65486 |  0:24:49s
epoch 89 | loss: 0.60044 | train_auc: 0.73719 | train_balanced_accuracy: 0.67457 | train_accuracy: 0.67456 | valid_auc: 0.71405 | valid_balanced_accuracy: 0.65342 | valid_accuracy: 0.65345 |  0:25:08s
epoch 90 | loss: 0.60055 | train_auc: 0.73976 | train_balanced_accuracy: 0.67974 | train_accuracy: 0.67991 | valid_auc: 0.71462 | valid_balanced_accuracy: 0.65733 | valid_accuracy: 0.65754 |  0:25:24s
epoch 91 | loss: 0.59677 | train_auc: 0.74868 | train_balanced_accuracy: 0.68398 | train_accuracy: 0.68424 | valid_auc: 0.72319 | valid_balanced_accuracy: 0.66619 | valid_accuracy: 0.66651 |  0:25:40s
epoch 92 | loss: 0.6003  | train_auc: 0.73732 | train_balanced_accuracy: 0.67683 | train_accuracy: 0.67704 | valid_auc: 0.71316 | valid_balanced_accuracy: 0.65761 | valid_accuracy: 0.65785 |  0:25:57s

Early stopping occurred at epoch 92 with best_epoch = 72 and best_valid_accuracy = 0.66667
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 57/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.680 total time=26.1min
[CV 2/5; 57/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83005 | train_auc: 0.52377 | train_balanced_accuracy: 0.52216 | train_accuracy: 0.5204  | valid_auc: 0.51637 | valid_balanced_accuracy: 0.5124  | valid_accuracy: 0.51054 |  0:00:17s
epoch 1  | loss: 0.75262 | train_auc: 0.51728 | train_balanced_accuracy: 0.5191  | train_accuracy: 0.51674 | valid_auc: 0.51401 | valid_balanced_accuracy: 0.51594 | valid_accuracy: 0.51353 |  0:00:32s
epoch 2  | loss: 0.71586 | train_auc: 0.54768 | train_balanced_accuracy: 0.53067 | train_accuracy: 0.52823 | valid_auc: 0.54367 | valid_balanced_accuracy: 0.51861 | valid_accuracy: 0.51605 |  0:00:49s
epoch 3  | loss: 0.69519 | train_auc: 0.55878 | train_balanced_accuracy: 0.53123 | train_accuracy: 0.52878 | valid_auc: 0.55127 | valid_balanced_accuracy: 0.52661 | valid_accuracy: 0.52408 |  0:01:05s
epoch 4  | loss: 0.68497 | train_auc: 0.54867 | train_balanced_accuracy: 0.50807 | train_accuracy: 0.50494 | valid_auc: 0.55203 | valid_balanced_accuracy: 0.5078  | valid_accuracy: 0.50456 |  0:01:23s
epoch 5  | loss: 0.67946 | train_auc: 0.55625 | train_balanced_accuracy: 0.52617 | train_accuracy: 0.52363 | valid_auc: 0.56362 | valid_balanced_accuracy: 0.52342 | valid_accuracy: 0.52077 |  0:01:41s
epoch 6  | loss: 0.67535 | train_auc: 0.56509 | train_balanced_accuracy: 0.54381 | train_accuracy: 0.54161 | valid_auc: 0.56881 | valid_balanced_accuracy: 0.54069 | valid_accuracy: 0.5384  |  0:01:59s
epoch 7  | loss: 0.66797 | train_auc: 0.59181 | train_balanced_accuracy: 0.55444 | train_accuracy: 0.55231 | valid_auc: 0.59168 | valid_balanced_accuracy: 0.55053 | valid_accuracy: 0.54832 |  0:02:16s
epoch 8  | loss: 0.65963 | train_auc: 0.59659 | train_balanced_accuracy: 0.55763 | train_accuracy: 0.5557  | valid_auc: 0.59409 | valid_balanced_accuracy: 0.56215 | valid_accuracy: 0.56012 |  0:02:32s
epoch 9  | loss: 0.66295 | train_auc: 0.608   | train_balanced_accuracy: 0.55801 | train_accuracy: 0.55589 | valid_auc: 0.60503 | valid_balanced_accuracy: 0.55066 | valid_accuracy: 0.54847 |  0:02:49s
epoch 10 | loss: 0.65502 | train_auc: 0.62214 | train_balanced_accuracy: 0.57232 | train_accuracy: 0.57057 | valid_auc: 0.62299 | valid_balanced_accuracy: 0.56903 | valid_accuracy: 0.5672  |  0:03:06s
epoch 11 | loss: 0.65254 | train_auc: 0.63533 | train_balanced_accuracy: 0.58901 | train_accuracy: 0.58772 | valid_auc: 0.63524 | valid_balanced_accuracy: 0.58599 | valid_accuracy: 0.58467 |  0:03:23s
epoch 12 | loss: 0.64959 | train_auc: 0.63959 | train_balanced_accuracy: 0.59338 | train_accuracy: 0.59209 | valid_auc: 0.63635 | valid_balanced_accuracy: 0.58284 | valid_accuracy: 0.58152 |  0:03:41s
epoch 13 | loss: 0.64906 | train_auc: 0.65079 | train_balanced_accuracy: 0.60115 | train_accuracy: 0.60004 | valid_auc: 0.645   | valid_balanced_accuracy: 0.59708 | valid_accuracy: 0.596   |  0:03:57s
epoch 14 | loss: 0.64931 | train_auc: 0.66571 | train_balanced_accuracy: 0.61803 | train_accuracy: 0.61727 | valid_auc: 0.66157 | valid_balanced_accuracy: 0.61251 | valid_accuracy: 0.61174 |  0:04:14s
epoch 15 | loss: 0.6435  | train_auc: 0.66773 | train_balanced_accuracy: 0.60831 | train_accuracy: 0.60728 | valid_auc: 0.66087 | valid_balanced_accuracy: 0.59624 | valid_accuracy: 0.59522 |  0:04:30s
epoch 16 | loss: 0.64373 | train_auc: 0.67502 | train_balanced_accuracy: 0.6244  | train_accuracy: 0.6238  | valid_auc: 0.6698  | valid_balanced_accuracy: 0.62527 | valid_accuracy: 0.62465 |  0:04:46s
epoch 17 | loss: 0.64009 | train_auc: 0.6825  | train_balanced_accuracy: 0.63288 | train_accuracy: 0.6323  | valid_auc: 0.67716 | valid_balanced_accuracy: 0.62919 | valid_accuracy: 0.62858 |  0:05:06s
epoch 18 | loss: 0.6382  | train_auc: 0.68659 | train_balanced_accuracy: 0.63551 | train_accuracy: 0.63514 | valid_auc: 0.67619 | valid_balanced_accuracy: 0.62836 | valid_accuracy: 0.62795 |  0:05:23s
epoch 19 | loss: 0.63517 | train_auc: 0.69166 | train_balanced_accuracy: 0.63948 | train_accuracy: 0.63927 | valid_auc: 0.6843  | valid_balanced_accuracy: 0.63417 | valid_accuracy: 0.63393 |  0:05:39s
epoch 20 | loss: 0.63792 | train_auc: 0.69677 | train_balanced_accuracy: 0.64645 | train_accuracy: 0.64639 | valid_auc: 0.68769 | valid_balanced_accuracy: 0.64108 | valid_accuracy: 0.64101 |  0:05:55s
epoch 21 | loss: 0.6332  | train_auc: 0.69888 | train_balanced_accuracy: 0.64695 | train_accuracy: 0.64694 | valid_auc: 0.69227 | valid_balanced_accuracy: 0.64375 | valid_accuracy: 0.64369 |  0:06:12s
epoch 22 | loss: 0.63616 | train_auc: 0.69593 | train_balanced_accuracy: 0.64579 | train_accuracy: 0.64631 | valid_auc: 0.68806 | valid_balanced_accuracy: 0.64522 | valid_accuracy: 0.64573 |  0:06:30s
epoch 23 | loss: 0.63364 | train_auc: 0.69889 | train_balanced_accuracy: 0.64743 | train_accuracy: 0.64785 | valid_auc: 0.69422 | valid_balanced_accuracy: 0.64429 | valid_accuracy: 0.64463 |  0:06:47s
epoch 24 | loss: 0.63085 | train_auc: 0.69899 | train_balanced_accuracy: 0.64641 | train_accuracy: 0.64674 | valid_auc: 0.69631 | valid_balanced_accuracy: 0.64877 | valid_accuracy: 0.64904 |  0:07:05s
epoch 25 | loss: 0.63173 | train_auc: 0.70382 | train_balanced_accuracy: 0.6527  | train_accuracy: 0.653   | valid_auc: 0.69641 | valid_balanced_accuracy: 0.64398 | valid_accuracy: 0.64416 |  0:07:21s
epoch 26 | loss: 0.62825 | train_auc: 0.70509 | train_balanced_accuracy: 0.64744 | train_accuracy: 0.64781 | valid_auc: 0.69772 | valid_balanced_accuracy: 0.64402 | valid_accuracy: 0.64432 |  0:07:39s
epoch 27 | loss: 0.63067 | train_auc: 0.70735 | train_balanced_accuracy: 0.65369 | train_accuracy: 0.65422 | valid_auc: 0.69853 | valid_balanced_accuracy: 0.64966 | valid_accuracy: 0.65014 |  0:07:57s
epoch 28 | loss: 0.62725 | train_auc: 0.70365 | train_balanced_accuracy: 0.65213 | train_accuracy: 0.65233 | valid_auc: 0.69342 | valid_balanced_accuracy: 0.64447 | valid_accuracy: 0.64463 |  0:08:14s
epoch 29 | loss: 0.62762 | train_auc: 0.71132 | train_balanced_accuracy: 0.65756 | train_accuracy: 0.658   | valid_auc: 0.70072 | valid_balanced_accuracy: 0.64612 | valid_accuracy: 0.64652 |  0:08:30s
epoch 30 | loss: 0.62407 | train_auc: 0.7127  | train_balanced_accuracy: 0.6573  | train_accuracy: 0.6576  | valid_auc: 0.70519 | valid_balanced_accuracy: 0.64643 | valid_accuracy: 0.64668 |  0:08:47s
epoch 31 | loss: 0.62451 | train_auc: 0.71274 | train_balanced_accuracy: 0.65421 | train_accuracy: 0.65453 | valid_auc: 0.69831 | valid_balanced_accuracy: 0.64485 | valid_accuracy: 0.64511 |  0:09:03s
epoch 32 | loss: 0.62559 | train_auc: 0.71506 | train_balanced_accuracy: 0.65755 | train_accuracy: 0.65788 | valid_auc: 0.70839 | valid_balanced_accuracy: 0.6458  | valid_accuracy: 0.64605 |  0:09:18s
epoch 33 | loss: 0.62438 | train_auc: 0.7159  | train_balanced_accuracy: 0.65948 | train_accuracy: 0.65993 | valid_auc: 0.70638 | valid_balanced_accuracy: 0.65177 | valid_accuracy: 0.65219 |  0:09:35s
epoch 34 | loss: 0.62371 | train_auc: 0.71619 | train_balanced_accuracy: 0.65719 | train_accuracy: 0.65753 | valid_auc: 0.70824 | valid_balanced_accuracy: 0.65326 | valid_accuracy: 0.6536  |  0:09:53s
epoch 35 | loss: 0.61891 | train_auc: 0.71803 | train_balanced_accuracy: 0.65994 | train_accuracy: 0.6604  | valid_auc: 0.7091  | valid_balanced_accuracy: 0.65477 | valid_accuracy: 0.65518 |  0:10:08s
epoch 36 | loss: 0.61952 | train_auc: 0.71529 | train_balanced_accuracy: 0.65671 | train_accuracy: 0.65693 | valid_auc: 0.70903 | valid_balanced_accuracy: 0.65516 | valid_accuracy: 0.65534 |  0:10:25s
epoch 37 | loss: 0.6209  | train_auc: 0.72035 | train_balanced_accuracy: 0.6592  | train_accuracy: 0.65961 | valid_auc: 0.71488 | valid_balanced_accuracy: 0.65481 | valid_accuracy: 0.65518 |  0:10:43s
epoch 38 | loss: 0.62199 | train_auc: 0.71999 | train_balanced_accuracy: 0.65857 | train_accuracy: 0.65886 | valid_auc: 0.71347 | valid_balanced_accuracy: 0.65775 | valid_accuracy: 0.65801 |  0:11:00s
epoch 39 | loss: 0.61766 | train_auc: 0.71897 | train_balanced_accuracy: 0.65799 | train_accuracy: 0.65843 | valid_auc: 0.71335 | valid_balanced_accuracy: 0.66235 | valid_accuracy: 0.66273 |  0:11:15s
epoch 40 | loss: 0.62107 | train_auc: 0.71899 | train_balanced_accuracy: 0.65906 | train_accuracy: 0.65949 | valid_auc: 0.71164 | valid_balanced_accuracy: 0.65353 | valid_accuracy: 0.65392 |  0:11:30s
epoch 41 | loss: 0.62131 | train_auc: 0.72428 | train_balanced_accuracy: 0.66277 | train_accuracy: 0.66295 | valid_auc: 0.71654 | valid_balanced_accuracy: 0.66248 | valid_accuracy: 0.66257 |  0:11:46s
epoch 42 | loss: 0.61648 | train_auc: 0.72497 | train_balanced_accuracy: 0.66358 | train_accuracy: 0.66378 | valid_auc: 0.71928 | valid_balanced_accuracy: 0.65866 | valid_accuracy: 0.6588  |  0:12:03s
epoch 43 | loss: 0.62013 | train_auc: 0.72508 | train_balanced_accuracy: 0.66577 | train_accuracy: 0.6661  | valid_auc: 0.71889 | valid_balanced_accuracy: 0.66023 | valid_accuracy: 0.66053 |  0:12:19s
epoch 44 | loss: 0.61297 | train_auc: 0.70954 | train_balanced_accuracy: 0.64785 | train_accuracy: 0.64773 | valid_auc: 0.70888 | valid_balanced_accuracy: 0.64745 | valid_accuracy: 0.64731 |  0:12:38s
epoch 45 | loss: 0.61488 | train_auc: 0.71407 | train_balanced_accuracy: 0.65378 | train_accuracy: 0.65394 | valid_auc: 0.71025 | valid_balanced_accuracy: 0.65366 | valid_accuracy: 0.65376 |  0:12:55s
epoch 46 | loss: 0.61383 | train_auc: 0.7151  | train_balanced_accuracy: 0.65621 | train_accuracy: 0.65607 | valid_auc: 0.71189 | valid_balanced_accuracy: 0.64942 | valid_accuracy: 0.6492  |  0:13:13s
epoch 47 | loss: 0.61659 | train_auc: 0.71657 | train_balanced_accuracy: 0.65692 | train_accuracy: 0.65693 | valid_auc: 0.70944 | valid_balanced_accuracy: 0.64785 | valid_accuracy: 0.64778 |  0:13:31s
epoch 48 | loss: 0.61074 | train_auc: 0.72191 | train_balanced_accuracy: 0.66166 | train_accuracy: 0.66221 | valid_auc: 0.71452 | valid_balanced_accuracy: 0.6597  | valid_accuracy: 0.66021 |  0:13:48s
epoch 49 | loss: 0.61404 | train_auc: 0.72256 | train_balanced_accuracy: 0.66164 | train_accuracy: 0.66209 | valid_auc: 0.7167  | valid_balanced_accuracy: 0.65635 | valid_accuracy: 0.65675 |  0:14:06s
epoch 50 | loss: 0.61142 | train_auc: 0.72059 | train_balanced_accuracy: 0.65727 | train_accuracy: 0.65717 | valid_auc: 0.71362 | valid_balanced_accuracy: 0.65297 | valid_accuracy: 0.65282 |  0:14:22s
epoch 51 | loss: 0.60949 | train_auc: 0.7243  | train_balanced_accuracy: 0.66545 | train_accuracy: 0.66559 | valid_auc: 0.71853 | valid_balanced_accuracy: 0.65791 | valid_accuracy: 0.65801 |  0:14:38s
epoch 52 | loss: 0.61051 | train_auc: 0.72559 | train_balanced_accuracy: 0.66398 | train_accuracy: 0.66441 | valid_auc: 0.72265 | valid_balanced_accuracy: 0.66405 | valid_accuracy: 0.66446 |  0:14:56s
epoch 53 | loss: 0.61237 | train_auc: 0.72406 | train_balanced_accuracy: 0.66153 | train_accuracy: 0.66185 | valid_auc: 0.7191  | valid_balanced_accuracy: 0.65915 | valid_accuracy: 0.65943 |  0:15:14s
epoch 54 | loss: 0.61305 | train_auc: 0.71536 | train_balanced_accuracy: 0.6559  | train_accuracy: 0.65603 | valid_auc: 0.71321 | valid_balanced_accuracy: 0.65134 | valid_accuracy: 0.6514  |  0:15:31s
epoch 55 | loss: 0.61501 | train_auc: 0.7166  | train_balanced_accuracy: 0.65953 | train_accuracy: 0.65981 | valid_auc: 0.71494 | valid_balanced_accuracy: 0.65401 | valid_accuracy: 0.65423 |  0:15:49s
epoch 56 | loss: 0.61326 | train_auc: 0.71974 | train_balanced_accuracy: 0.6599  | train_accuracy: 0.66048 | valid_auc: 0.7135  | valid_balanced_accuracy: 0.65234 | valid_accuracy: 0.65282 |  0:16:07s
epoch 57 | loss: 0.61224 | train_auc: 0.71709 | train_balanced_accuracy: 0.66033 | train_accuracy: 0.66071 | valid_auc: 0.71079 | valid_balanced_accuracy: 0.64998 | valid_accuracy: 0.6503  |  0:16:23s
epoch 58 | loss: 0.61002 | train_auc: 0.70589 | train_balanced_accuracy: 0.64871 | train_accuracy: 0.64895 | valid_auc: 0.70307 | valid_balanced_accuracy: 0.64338 | valid_accuracy: 0.64353 |  0:16:39s
epoch 59 | loss: 0.61177 | train_auc: 0.71129 | train_balanced_accuracy: 0.64885 | train_accuracy: 0.64907 | valid_auc: 0.7129  | valid_balanced_accuracy: 0.64986 | valid_accuracy: 0.64998 |  0:16:56s
epoch 60 | loss: 0.60922 | train_auc: 0.70709 | train_balanced_accuracy: 0.64721 | train_accuracy: 0.64737 | valid_auc: 0.70629 | valid_balanced_accuracy: 0.64768 | valid_accuracy: 0.64778 |  0:17:14s
epoch 61 | loss: 0.60852 | train_auc: 0.7173  | train_balanced_accuracy: 0.65399 | train_accuracy: 0.65414 | valid_auc: 0.71552 | valid_balanced_accuracy: 0.65574 | valid_accuracy: 0.65581 |  0:17:32s
epoch 62 | loss: 0.60472 | train_auc: 0.7236  | train_balanced_accuracy: 0.66036 | train_accuracy: 0.66055 | valid_auc: 0.72086 | valid_balanced_accuracy: 0.66114 | valid_accuracy: 0.66132 |  0:17:49s
epoch 63 | loss: 0.60796 | train_auc: 0.73423 | train_balanced_accuracy: 0.67155 | train_accuracy: 0.67177 | valid_auc: 0.72299 | valid_balanced_accuracy: 0.66129 | valid_accuracy: 0.66147 |  0:18:06s
epoch 64 | loss: 0.60922 | train_auc: 0.73201 | train_balanced_accuracy: 0.66946 | train_accuracy: 0.66972 | valid_auc: 0.71786 | valid_balanced_accuracy: 0.65982 | valid_accuracy: 0.66006 |  0:18:23s
epoch 65 | loss: 0.60829 | train_auc: 0.7357  | train_balanced_accuracy: 0.6723  | train_accuracy: 0.67252 | valid_auc: 0.72612 | valid_balanced_accuracy: 0.67088 | valid_accuracy: 0.67107 |  0:18:40s
epoch 66 | loss: 0.60974 | train_auc: 0.72709 | train_balanced_accuracy: 0.66605 | train_accuracy: 0.66626 | valid_auc: 0.71953 | valid_balanced_accuracy: 0.65912 | valid_accuracy: 0.65927 |  0:18:56s
epoch 67 | loss: 0.60507 | train_auc: 0.7405  | train_balanced_accuracy: 0.67705 | train_accuracy: 0.67759 | valid_auc: 0.72665 | valid_balanced_accuracy: 0.66524 | valid_accuracy: 0.66572 |  0:19:13s
epoch 68 | loss: 0.60561 | train_auc: 0.73997 | train_balanced_accuracy: 0.67584 | train_accuracy: 0.67606 | valid_auc: 0.72565 | valid_balanced_accuracy: 0.66442 | valid_accuracy: 0.66462 |  0:19:29s
epoch 69 | loss: 0.60936 | train_auc: 0.74168 | train_balanced_accuracy: 0.67848 | train_accuracy: 0.67873 | valid_auc: 0.72856 | valid_balanced_accuracy: 0.67054 | valid_accuracy: 0.67076 |  0:19:45s
epoch 70 | loss: 0.60838 | train_auc: 0.72893 | train_balanced_accuracy: 0.66662 | train_accuracy: 0.66713 | valid_auc: 0.72165 | valid_balanced_accuracy: 0.65851 | valid_accuracy: 0.65895 |  0:20:02s
epoch 71 | loss: 0.60756 | train_auc: 0.72576 | train_balanced_accuracy: 0.66814 | train_accuracy: 0.66842 | valid_auc: 0.71772 | valid_balanced_accuracy: 0.6633  | valid_accuracy: 0.66352 |  0:20:19s
epoch 72 | loss: 0.60453 | train_auc: 0.71921 | train_balanced_accuracy: 0.66537 | train_accuracy: 0.66559 | valid_auc: 0.71265 | valid_balanced_accuracy: 0.65927 | valid_accuracy: 0.65943 |  0:20:36s
epoch 73 | loss: 0.60747 | train_auc: 0.72517 | train_balanced_accuracy: 0.66883 | train_accuracy: 0.66925 | valid_auc: 0.71639 | valid_balanced_accuracy: 0.66142 | valid_accuracy: 0.66179 |  0:20:54s
epoch 74 | loss: 0.60494 | train_auc: 0.72361 | train_balanced_accuracy: 0.66747 | train_accuracy: 0.66791 | valid_auc: 0.71611 | valid_balanced_accuracy: 0.65711 | valid_accuracy: 0.65754 |  0:21:12s
epoch 75 | loss: 0.60611 | train_auc: 0.72093 | train_balanced_accuracy: 0.66575 | train_accuracy: 0.66602 | valid_auc: 0.71429 | valid_balanced_accuracy: 0.65698 | valid_accuracy: 0.65722 |  0:21:28s
epoch 76 | loss: 0.60919 | train_auc: 0.7398  | train_balanced_accuracy: 0.67557 | train_accuracy: 0.67574 | valid_auc: 0.7291  | valid_balanced_accuracy: 0.66639 | valid_accuracy: 0.66651 |  0:21:47s
epoch 77 | loss: 0.60667 | train_auc: 0.74258 | train_balanced_accuracy: 0.67937 | train_accuracy: 0.67944 | valid_auc: 0.7297  | valid_balanced_accuracy: 0.66557 | valid_accuracy: 0.66556 |  0:22:03s
epoch 78 | loss: 0.60135 | train_auc: 0.74432 | train_balanced_accuracy: 0.68071 | train_accuracy: 0.68094 | valid_auc: 0.72807 | valid_balanced_accuracy: 0.66726 | valid_accuracy: 0.66745 |  0:22:21s
epoch 79 | loss: 0.60174 | train_auc: 0.74552 | train_balanced_accuracy: 0.68162 | train_accuracy: 0.68184 | valid_auc: 0.7289  | valid_balanced_accuracy: 0.67046 | valid_accuracy: 0.6706  |  0:22:37s
epoch 80 | loss: 0.60567 | train_auc: 0.74203 | train_balanced_accuracy: 0.67835 | train_accuracy: 0.67854 | valid_auc: 0.7291  | valid_balanced_accuracy: 0.67093 | valid_accuracy: 0.67107 |  0:22:52s
epoch 81 | loss: 0.59964 | train_auc: 0.74015 | train_balanced_accuracy: 0.67801 | train_accuracy: 0.67814 | valid_auc: 0.72956 | valid_balanced_accuracy: 0.66927 | valid_accuracy: 0.66934 |  0:23:08s
epoch 82 | loss: 0.60678 | train_auc: 0.74502 | train_balanced_accuracy: 0.68107 | train_accuracy: 0.68141 | valid_auc: 0.72915 | valid_balanced_accuracy: 0.66964 | valid_accuracy: 0.66997 |  0:23:25s
epoch 83 | loss: 0.6037  | train_auc: 0.74474 | train_balanced_accuracy: 0.68132 | train_accuracy: 0.68157 | valid_auc: 0.72896 | valid_balanced_accuracy: 0.66756 | valid_accuracy: 0.66777 |  0:23:41s
epoch 84 | loss: 0.60308 | train_auc: 0.74702 | train_balanced_accuracy: 0.68268 | train_accuracy: 0.68298 | valid_auc: 0.72995 | valid_balanced_accuracy: 0.66624 | valid_accuracy: 0.66651 |  0:24:00s
epoch 85 | loss: 0.60317 | train_auc: 0.74365 | train_balanced_accuracy: 0.67958 | train_accuracy: 0.68003 | valid_auc: 0.73111 | valid_balanced_accuracy: 0.67631 | valid_accuracy: 0.67674 |  0:24:17s
epoch 86 | loss: 0.60555 | train_auc: 0.74008 | train_balanced_accuracy: 0.67667 | train_accuracy: 0.67684 | valid_auc: 0.73123 | valid_balanced_accuracy: 0.67189 | valid_accuracy: 0.67202 |  0:24:35s
epoch 87 | loss: 0.6009  | train_auc: 0.74079 | train_balanced_accuracy: 0.67391 | train_accuracy: 0.67413 | valid_auc: 0.73022 | valid_balanced_accuracy: 0.66744 | valid_accuracy: 0.66761 |  0:24:51s
epoch 88 | loss: 0.60212 | train_auc: 0.73894 | train_balanced_accuracy: 0.67625 | train_accuracy: 0.67665 | valid_auc: 0.72968 | valid_balanced_accuracy: 0.67231 | valid_accuracy: 0.67265 |  0:25:07s
epoch 89 | loss: 0.60321 | train_auc: 0.7204  | train_balanced_accuracy: 0.66292 | train_accuracy: 0.66299 | valid_auc: 0.7223  | valid_balanced_accuracy: 0.66351 | valid_accuracy: 0.66352 |  0:25:25s
epoch 90 | loss: 0.60416 | train_auc: 0.71103 | train_balanced_accuracy: 0.65133 | train_accuracy: 0.65162 | valid_auc: 0.71081 | valid_balanced_accuracy: 0.65461 | valid_accuracy: 0.65486 |  0:25:42s
epoch 91 | loss: 0.60054 | train_auc: 0.70266 | train_balanced_accuracy: 0.64089 | train_accuracy: 0.64151 | valid_auc: 0.70156 | valid_balanced_accuracy: 0.6406  | valid_accuracy: 0.64117 |  0:26:00s
epoch 92 | loss: 0.59978 | train_auc: 0.70899 | train_balanced_accuracy: 0.64913 | train_accuracy: 0.6495  | valid_auc: 0.70914 | valid_balanced_accuracy: 0.64955 | valid_accuracy: 0.64983 |  0:26:18s
epoch 93 | loss: 0.59797 | train_auc: 0.70335 | train_balanced_accuracy: 0.64394 | train_accuracy: 0.64427 | valid_auc: 0.7037  | valid_balanced_accuracy: 0.64421 | valid_accuracy: 0.64448 |  0:26:37s
epoch 94 | loss: 0.60067 | train_auc: 0.67429 | train_balanced_accuracy: 0.61673 | train_accuracy: 0.61716 | valid_auc: 0.67148 | valid_balanced_accuracy: 0.61146 | valid_accuracy: 0.6119  |  0:26:53s
epoch 95 | loss: 0.60179 | train_auc: 0.6593  | train_balanced_accuracy: 0.61031 | train_accuracy: 0.61047 | valid_auc: 0.65385 | valid_balanced_accuracy: 0.59885 | valid_accuracy: 0.59899 |  0:27:10s
epoch 96 | loss: 0.59576 | train_auc: 0.63712 | train_balanced_accuracy: 0.59451 | train_accuracy: 0.59492 | valid_auc: 0.63158 | valid_balanced_accuracy: 0.59109 | valid_accuracy: 0.59144 |  0:27:25s
epoch 97 | loss: 0.59694 | train_auc: 0.64922 | train_balanced_accuracy: 0.6013  | train_accuracy: 0.60165 | valid_auc: 0.6401  | valid_balanced_accuracy: 0.58917 | valid_accuracy: 0.58955 |  0:27:41s
epoch 98 | loss: 0.59793 | train_auc: 0.64189 | train_balanced_accuracy: 0.58544 | train_accuracy: 0.5865  | valid_auc: 0.63615 | valid_balanced_accuracy: 0.58433 | valid_accuracy: 0.58546 |  0:27:59s
epoch 99 | loss: 0.59538 | train_auc: 0.6418  | train_balanced_accuracy: 0.58919 | train_accuracy: 0.58949 | valid_auc: 0.63295 | valid_balanced_accuracy: 0.58344 | valid_accuracy: 0.58373 |  0:28:17s
epoch 100| loss: 0.60353 | train_auc: 0.61521 | train_balanced_accuracy: 0.53289 | train_accuracy: 0.53461 | valid_auc: 0.5989  | valid_balanced_accuracy: 0.5226  | valid_accuracy: 0.52439 |  0:28:33s
epoch 101| loss: 0.59679 | train_auc: 0.65082 | train_balanced_accuracy: 0.59512 | train_accuracy: 0.59544 | valid_auc: 0.64692 | valid_balanced_accuracy: 0.59016 | valid_accuracy: 0.59049 |  0:28:50s
epoch 102| loss: 0.59512 | train_auc: 0.67587 | train_balanced_accuracy: 0.62545 | train_accuracy: 0.62561 | valid_auc: 0.67349 | valid_balanced_accuracy: 0.62116 | valid_accuracy: 0.62134 |  0:29:06s
epoch 103| loss: 0.59794 | train_auc: 0.68188 | train_balanced_accuracy: 0.63233 | train_accuracy: 0.63278 | valid_auc: 0.67754 | valid_balanced_accuracy: 0.62371 | valid_accuracy: 0.62417 |  0:29:23s
epoch 104| loss: 0.59913 | train_auc: 0.68025 | train_balanced_accuracy: 0.62877 | train_accuracy: 0.629   | valid_auc: 0.68196 | valid_balanced_accuracy: 0.62742 | valid_accuracy: 0.62764 |  0:29:40s
epoch 105| loss: 0.59564 | train_auc: 0.64892 | train_balanced_accuracy: 0.60357 | train_accuracy: 0.60362 | valid_auc: 0.6375  | valid_balanced_accuracy: 0.59592 | valid_accuracy: 0.596   |  0:29:57s

Early stopping occurred at epoch 105 with best_epoch = 85 and best_valid_accuracy = 0.67674
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 57/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.666 total time=30.1min
[CV 3/5; 57/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82845 | train_auc: 0.5231  | train_balanced_accuracy: 0.51495 | train_accuracy: 0.51401 | valid_auc: 0.53177 | valid_balanced_accuracy: 0.52328 | valid_accuracy: 0.52235 |  0:00:16s
epoch 1  | loss: 0.74235 | train_auc: 0.51119 | train_balanced_accuracy: 0.50207 | train_accuracy: 0.4987  | valid_auc: 0.50797 | valid_balanced_accuracy: 0.5023  | valid_accuracy: 0.4989  |  0:00:32s
epoch 2  | loss: 0.70965 | train_auc: 0.53339 | train_balanced_accuracy: 0.50352 | train_accuracy: 0.50024 | valid_auc: 0.52804 | valid_balanced_accuracy: 0.50177 | valid_accuracy: 0.49843 |  0:00:47s
epoch 3  | loss: 0.69801 | train_auc: 0.55907 | train_balanced_accuracy: 0.52387 | train_accuracy: 0.52105 | valid_auc: 0.56664 | valid_balanced_accuracy: 0.53021 | valid_accuracy: 0.52738 |  0:01:03s
epoch 4  | loss: 0.68807 | train_auc: 0.56571 | train_balanced_accuracy: 0.52568 | train_accuracy: 0.52282 | valid_auc: 0.55766 | valid_balanced_accuracy: 0.5304  | valid_accuracy: 0.52754 |  0:01:19s
epoch 5  | loss: 0.6809  | train_auc: 0.57967 | train_balanced_accuracy: 0.53775 | train_accuracy: 0.53541 | valid_auc: 0.58189 | valid_balanced_accuracy: 0.53637 | valid_accuracy: 0.53399 |  0:01:39s
epoch 6  | loss: 0.67368 | train_auc: 0.57193 | train_balanced_accuracy: 0.53223 | train_accuracy: 0.52955 | valid_auc: 0.56577 | valid_balanced_accuracy: 0.53074 | valid_accuracy: 0.52801 |  0:01:54s
epoch 7  | loss: 0.67071 | train_auc: 0.57221 | train_balanced_accuracy: 0.52702 | train_accuracy: 0.524   | valid_auc: 0.56623 | valid_balanced_accuracy: 0.52886 | valid_accuracy: 0.52581 |  0:02:12s
epoch 8  | loss: 0.66272 | train_auc: 0.59901 | train_balanced_accuracy: 0.53479 | train_accuracy: 0.53183 | valid_auc: 0.58573 | valid_balanced_accuracy: 0.5337  | valid_accuracy: 0.53069 |  0:02:29s
epoch 9  | loss: 0.66199 | train_auc: 0.61113 | train_balanced_accuracy: 0.53949 | train_accuracy: 0.53659 | valid_auc: 0.60094 | valid_balanced_accuracy: 0.53868 | valid_accuracy: 0.53573 |  0:02:45s
epoch 10 | loss: 0.6532  | train_auc: 0.62415 | train_balanced_accuracy: 0.54957 | train_accuracy: 0.54698 | valid_auc: 0.62749 | valid_balanced_accuracy: 0.54813 | valid_accuracy: 0.54548 |  0:03:03s
epoch 11 | loss: 0.6562  | train_auc: 0.64681 | train_balanced_accuracy: 0.57746 | train_accuracy: 0.57558 | valid_auc: 0.64058 | valid_balanced_accuracy: 0.57867 | valid_accuracy: 0.5768  |  0:03:18s
epoch 12 | loss: 0.65083 | train_auc: 0.6521  | train_balanced_accuracy: 0.57324 | train_accuracy: 0.57114 | valid_auc: 0.64886 | valid_balanced_accuracy: 0.57666 | valid_accuracy: 0.5746  |  0:03:34s
epoch 13 | loss: 0.64998 | train_auc: 0.66345 | train_balanced_accuracy: 0.58005 | train_accuracy: 0.57806 | valid_auc: 0.65933 | valid_balanced_accuracy: 0.58238 | valid_accuracy: 0.58042 |  0:03:51s
epoch 14 | loss: 0.6452  | train_auc: 0.6732  | train_balanced_accuracy: 0.58004 | train_accuracy: 0.57798 | valid_auc: 0.67215 | valid_balanced_accuracy: 0.58338 | valid_accuracy: 0.58137 |  0:04:10s
epoch 15 | loss: 0.64577 | train_auc: 0.67229 | train_balanced_accuracy: 0.58767 | train_accuracy: 0.58581 | valid_auc: 0.66647 | valid_balanced_accuracy: 0.58128 | valid_accuracy: 0.57948 |  0:04:25s
epoch 16 | loss: 0.64226 | train_auc: 0.67699 | train_balanced_accuracy: 0.59522 | train_accuracy: 0.59364 | valid_auc: 0.67313 | valid_balanced_accuracy: 0.59624 | valid_accuracy: 0.59474 |  0:04:42s
epoch 17 | loss: 0.63976 | train_auc: 0.68454 | train_balanced_accuracy: 0.61177 | train_accuracy: 0.61036 | valid_auc: 0.68362 | valid_balanced_accuracy: 0.61483 | valid_accuracy: 0.61347 |  0:05:01s
epoch 18 | loss: 0.63758 | train_auc: 0.68407 | train_balanced_accuracy: 0.6273  | train_accuracy: 0.62673 | valid_auc: 0.6821  | valid_balanced_accuracy: 0.62784 | valid_accuracy: 0.62732 |  0:05:18s
epoch 19 | loss: 0.63827 | train_auc: 0.68831 | train_balanced_accuracy: 0.63017 | train_accuracy: 0.62956 | valid_auc: 0.68174 | valid_balanced_accuracy: 0.63152 | valid_accuracy: 0.63094 |  0:05:36s
epoch 20 | loss: 0.63647 | train_auc: 0.69178 | train_balanced_accuracy: 0.6381  | train_accuracy: 0.63779 | valid_auc: 0.68693 | valid_balanced_accuracy: 0.63821 | valid_accuracy: 0.63787 |  0:05:53s
epoch 21 | loss: 0.63082 | train_auc: 0.69562 | train_balanced_accuracy: 0.63761 | train_accuracy: 0.6372  | valid_auc: 0.69188 | valid_balanced_accuracy: 0.64127 | valid_accuracy: 0.64086 |  0:06:10s
epoch 22 | loss: 0.63582 | train_auc: 0.69596 | train_balanced_accuracy: 0.64113 | train_accuracy: 0.64109 | valid_auc: 0.69432 | valid_balanced_accuracy: 0.6466  | valid_accuracy: 0.64652 |  0:06:27s
epoch 23 | loss: 0.63449 | train_auc: 0.69604 | train_balanced_accuracy: 0.64008 | train_accuracy: 0.64011 | valid_auc: 0.68987 | valid_balanced_accuracy: 0.63783 | valid_accuracy: 0.63787 |  0:06:45s
epoch 24 | loss: 0.63255 | train_auc: 0.70172 | train_balanced_accuracy: 0.64811 | train_accuracy: 0.64825 | valid_auc: 0.69469 | valid_balanced_accuracy: 0.64437 | valid_accuracy: 0.64448 |  0:07:03s
epoch 25 | loss: 0.63023 | train_auc: 0.69929 | train_balanced_accuracy: 0.64101 | train_accuracy: 0.64125 | valid_auc: 0.6945  | valid_balanced_accuracy: 0.64001 | valid_accuracy: 0.64023 |  0:07:20s
epoch 26 | loss: 0.62829 | train_auc: 0.70449 | train_balanced_accuracy: 0.64872 | train_accuracy: 0.64904 | valid_auc: 0.69804 | valid_balanced_accuracy: 0.64842 | valid_accuracy: 0.64873 |  0:07:37s
epoch 27 | loss: 0.6283  | train_auc: 0.70409 | train_balanced_accuracy: 0.64957 | train_accuracy: 0.64991 | valid_auc: 0.69698 | valid_balanced_accuracy: 0.6467  | valid_accuracy: 0.64699 |  0:07:54s
epoch 28 | loss: 0.62529 | train_auc: 0.70915 | train_balanced_accuracy: 0.65447 | train_accuracy: 0.65471 | valid_auc: 0.70007 | valid_balanced_accuracy: 0.6496  | valid_accuracy: 0.64983 |  0:08:11s
epoch 29 | loss: 0.62425 | train_auc: 0.71226 | train_balanced_accuracy: 0.65942 | train_accuracy: 0.65974 | valid_auc: 0.70232 | valid_balanced_accuracy: 0.65143 | valid_accuracy: 0.65172 |  0:08:30s
epoch 30 | loss: 0.62321 | train_auc: 0.71333 | train_balanced_accuracy: 0.65771 | train_accuracy: 0.65801 | valid_auc: 0.70323 | valid_balanced_accuracy: 0.65067 | valid_accuracy: 0.65093 |  0:08:46s
epoch 31 | loss: 0.62522 | train_auc: 0.71413 | train_balanced_accuracy: 0.65495 | train_accuracy: 0.65537 | valid_auc: 0.70104 | valid_balanced_accuracy: 0.64937 | valid_accuracy: 0.64983 |  0:09:01s
epoch 32 | loss: 0.61995 | train_auc: 0.71476 | train_balanced_accuracy: 0.66076 | train_accuracy: 0.66124 | valid_auc: 0.70134 | valid_balanced_accuracy: 0.65455 | valid_accuracy: 0.65502 |  0:09:17s
epoch 33 | loss: 0.62532 | train_auc: 0.71541 | train_balanced_accuracy: 0.66228 | train_accuracy: 0.66285 | valid_auc: 0.70236 | valid_balanced_accuracy: 0.65394 | valid_accuracy: 0.65455 |  0:09:34s
epoch 34 | loss: 0.62272 | train_auc: 0.71413 | train_balanced_accuracy: 0.65817 | train_accuracy: 0.65856 | valid_auc: 0.70688 | valid_balanced_accuracy: 0.65869 | valid_accuracy: 0.65911 |  0:09:51s
epoch 35 | loss: 0.61822 | train_auc: 0.71915 | train_balanced_accuracy: 0.66193 | train_accuracy: 0.66254 | valid_auc: 0.7068  | valid_balanced_accuracy: 0.6533  | valid_accuracy: 0.65392 |  0:10:08s
epoch 36 | loss: 0.62076 | train_auc: 0.72278 | train_balanced_accuracy: 0.6641  | train_accuracy: 0.66462 | valid_auc: 0.70951 | valid_balanced_accuracy: 0.65355 | valid_accuracy: 0.65408 |  0:10:24s
epoch 37 | loss: 0.62043 | train_auc: 0.72272 | train_balanced_accuracy: 0.66394 | train_accuracy: 0.66438 | valid_auc: 0.70973 | valid_balanced_accuracy: 0.65665 | valid_accuracy: 0.65707 |  0:10:43s
epoch 38 | loss: 0.6187  | train_auc: 0.72249 | train_balanced_accuracy: 0.66327 | train_accuracy: 0.6634  | valid_auc: 0.70982 | valid_balanced_accuracy: 0.65615 | valid_accuracy: 0.65628 |  0:10:59s
epoch 39 | loss: 0.61328 | train_auc: 0.72582 | train_balanced_accuracy: 0.6649  | train_accuracy: 0.66529 | valid_auc: 0.70862 | valid_balanced_accuracy: 0.65585 | valid_accuracy: 0.65628 |  0:11:14s
epoch 40 | loss: 0.6175  | train_auc: 0.72155 | train_balanced_accuracy: 0.66154 | train_accuracy: 0.66191 | valid_auc: 0.7047  | valid_balanced_accuracy: 0.65434 | valid_accuracy: 0.65471 |  0:11:29s
epoch 41 | loss: 0.61751 | train_auc: 0.72671 | train_balanced_accuracy: 0.66583 | train_accuracy: 0.66616 | valid_auc: 0.70845 | valid_balanced_accuracy: 0.6572  | valid_accuracy: 0.65754 |  0:11:44s
epoch 42 | loss: 0.61385 | train_auc: 0.72712 | train_balanced_accuracy: 0.66666 | train_accuracy: 0.66702 | valid_auc: 0.71081 | valid_balanced_accuracy: 0.65876 | valid_accuracy: 0.65911 |  0:12:02s
epoch 43 | loss: 0.6174  | train_auc: 0.72597 | train_balanced_accuracy: 0.66585 | train_accuracy: 0.666   | valid_auc: 0.70832 | valid_balanced_accuracy: 0.65657 | valid_accuracy: 0.65675 |  0:12:18s
epoch 44 | loss: 0.61797 | train_auc: 0.72993 | train_balanced_accuracy: 0.66769 | train_accuracy: 0.66769 | valid_auc: 0.71077 | valid_balanced_accuracy: 0.65424 | valid_accuracy: 0.65423 |  0:12:33s
epoch 45 | loss: 0.61428 | train_auc: 0.7289  | train_balanced_accuracy: 0.66757 | train_accuracy: 0.66781 | valid_auc: 0.71182 | valid_balanced_accuracy: 0.65529 | valid_accuracy: 0.65549 |  0:12:49s
epoch 46 | loss: 0.61808 | train_auc: 0.73165 | train_balanced_accuracy: 0.66904 | train_accuracy: 0.66942 | valid_auc: 0.71495 | valid_balanced_accuracy: 0.6614  | valid_accuracy: 0.66179 |  0:13:07s
epoch 47 | loss: 0.6128  | train_auc: 0.72837 | train_balanced_accuracy: 0.66816 | train_accuracy: 0.66848 | valid_auc: 0.71259 | valid_balanced_accuracy: 0.66114 | valid_accuracy: 0.66147 |  0:13:23s
epoch 48 | loss: 0.61353 | train_auc: 0.72224 | train_balanced_accuracy: 0.66243 | train_accuracy: 0.66277 | valid_auc: 0.71095 | valid_balanced_accuracy: 0.65284 | valid_accuracy: 0.65313 |  0:13:41s
epoch 49 | loss: 0.61178 | train_auc: 0.71805 | train_balanced_accuracy: 0.66154 | train_accuracy: 0.66171 | valid_auc: 0.70941 | valid_balanced_accuracy: 0.65266 | valid_accuracy: 0.65282 |  0:13:58s
epoch 50 | loss: 0.61459 | train_auc: 0.7249  | train_balanced_accuracy: 0.66528 | train_accuracy: 0.66533 | valid_auc: 0.71032 | valid_balanced_accuracy: 0.6545  | valid_accuracy: 0.65455 |  0:14:16s
epoch 51 | loss: 0.61056 | train_auc: 0.72857 | train_balanced_accuracy: 0.66643 | train_accuracy: 0.66671 | valid_auc: 0.71181 | valid_balanced_accuracy: 0.65555 | valid_accuracy: 0.65581 |  0:14:34s
epoch 52 | loss: 0.60647 | train_auc: 0.72695 | train_balanced_accuracy: 0.66765 | train_accuracy: 0.66769 | valid_auc: 0.71001 | valid_balanced_accuracy: 0.65548 | valid_accuracy: 0.65549 |  0:14:52s
epoch 53 | loss: 0.60976 | train_auc: 0.72985 | train_balanced_accuracy: 0.67084 | train_accuracy: 0.67123 | valid_auc: 0.71338 | valid_balanced_accuracy: 0.65933 | valid_accuracy: 0.65974 |  0:15:07s
epoch 54 | loss: 0.60813 | train_auc: 0.73402 | train_balanced_accuracy: 0.67314 | train_accuracy: 0.67336 | valid_auc: 0.71929 | valid_balanced_accuracy: 0.66361 | valid_accuracy: 0.66383 |  0:15:25s
epoch 55 | loss: 0.60876 | train_auc: 0.73064 | train_balanced_accuracy: 0.66796 | train_accuracy: 0.66789 | valid_auc: 0.7137  | valid_balanced_accuracy: 0.65443 | valid_accuracy: 0.65439 |  0:15:42s
epoch 56 | loss: 0.61022 | train_auc: 0.73698 | train_balanced_accuracy: 0.67554 | train_accuracy: 0.67607 | valid_auc: 0.71884 | valid_balanced_accuracy: 0.66379 | valid_accuracy: 0.66431 |  0:15:59s
epoch 57 | loss: 0.61417 | train_auc: 0.73437 | train_balanced_accuracy: 0.67533 | train_accuracy: 0.67548 | valid_auc: 0.7197  | valid_balanced_accuracy: 0.66399 | valid_accuracy: 0.66415 |  0:16:15s
epoch 58 | loss: 0.61382 | train_auc: 0.72977 | train_balanced_accuracy: 0.67011 | train_accuracy: 0.67029 | valid_auc: 0.7166  | valid_balanced_accuracy: 0.6554  | valid_accuracy: 0.65565 |  0:16:30s
epoch 59 | loss: 0.60963 | train_auc: 0.73051 | train_balanced_accuracy: 0.67023 | train_accuracy: 0.67029 | valid_auc: 0.71266 | valid_balanced_accuracy: 0.65437 | valid_accuracy: 0.65439 |  0:16:46s
epoch 60 | loss: 0.60948 | train_auc: 0.72651 | train_balanced_accuracy: 0.66436 | train_accuracy: 0.66419 | valid_auc: 0.71446 | valid_balanced_accuracy: 0.65253 | valid_accuracy: 0.65234 |  0:17:01s
epoch 61 | loss: 0.60985 | train_auc: 0.71105 | train_balanced_accuracy: 0.65485 | train_accuracy: 0.65486 | valid_auc: 0.70633 | valid_balanced_accuracy: 0.65064 | valid_accuracy: 0.65061 |  0:17:18s
epoch 62 | loss: 0.60557 | train_auc: 0.71944 | train_balanced_accuracy: 0.66273 | train_accuracy: 0.66336 | valid_auc: 0.71114 | valid_balanced_accuracy: 0.65109 | valid_accuracy: 0.65172 |  0:17:33s
epoch 63 | loss: 0.6068  | train_auc: 0.71568 | train_balanced_accuracy: 0.65826 | train_accuracy: 0.65852 | valid_auc: 0.70686 | valid_balanced_accuracy: 0.64986 | valid_accuracy: 0.65014 |  0:17:51s
epoch 64 | loss: 0.6049  | train_auc: 0.72717 | train_balanced_accuracy: 0.66493 | train_accuracy: 0.66494 | valid_auc: 0.71528 | valid_balanced_accuracy: 0.65694 | valid_accuracy: 0.65691 |  0:18:08s
epoch 65 | loss: 0.6039  | train_auc: 0.73648 | train_balanced_accuracy: 0.67581 | train_accuracy: 0.67599 | valid_auc: 0.71969 | valid_balanced_accuracy: 0.66943 | valid_accuracy: 0.66966 |  0:18:25s
epoch 66 | loss: 0.60832 | train_auc: 0.74163 | train_balanced_accuracy: 0.68118 | train_accuracy: 0.6813  | valid_auc: 0.72362 | valid_balanced_accuracy: 0.66622 | valid_accuracy: 0.66635 |  0:18:42s
epoch 67 | loss: 0.60468 | train_auc: 0.73559 | train_balanced_accuracy: 0.67497 | train_accuracy: 0.67524 | valid_auc: 0.72083 | valid_balanced_accuracy: 0.66874 | valid_accuracy: 0.66903 |  0:18:59s
epoch 68 | loss: 0.60632 | train_auc: 0.7277  | train_balanced_accuracy: 0.66722 | train_accuracy: 0.66745 | valid_auc: 0.71526 | valid_balanced_accuracy: 0.66472 | valid_accuracy: 0.66494 |  0:19:17s
epoch 69 | loss: 0.60647 | train_auc: 0.72329 | train_balanced_accuracy: 0.66426 | train_accuracy: 0.66462 | valid_auc: 0.71274 | valid_balanced_accuracy: 0.66131 | valid_accuracy: 0.66163 |  0:19:34s
epoch 70 | loss: 0.60319 | train_auc: 0.72499 | train_balanced_accuracy: 0.66503 | train_accuracy: 0.66509 | valid_auc: 0.71258 | valid_balanced_accuracy: 0.65563 | valid_accuracy: 0.65565 |  0:19:52s
epoch 71 | loss: 0.60764 | train_auc: 0.7139  | train_balanced_accuracy: 0.65796 | train_accuracy: 0.6584  | valid_auc: 0.7063  | valid_balanced_accuracy: 0.64901 | valid_accuracy: 0.64935 |  0:20:10s
epoch 72 | loss: 0.60681 | train_auc: 0.72107 | train_balanced_accuracy: 0.66389 | train_accuracy: 0.66391 | valid_auc: 0.7114  | valid_balanced_accuracy: 0.65831 | valid_accuracy: 0.65833 |  0:20:27s
epoch 73 | loss: 0.60067 | train_auc: 0.73597 | train_balanced_accuracy: 0.67535 | train_accuracy: 0.67564 | valid_auc: 0.72026 | valid_balanced_accuracy: 0.66531 | valid_accuracy: 0.66556 |  0:20:45s
epoch 74 | loss: 0.60469 | train_auc: 0.72067 | train_balanced_accuracy: 0.6658  | train_accuracy: 0.66592 | valid_auc: 0.71144 | valid_balanced_accuracy: 0.66011 | valid_accuracy: 0.66021 |  0:21:02s
epoch 75 | loss: 0.60723 | train_auc: 0.70753 | train_balanced_accuracy: 0.65218 | train_accuracy: 0.65223 | valid_auc: 0.70292 | valid_balanced_accuracy: 0.64759 | valid_accuracy: 0.64762 |  0:21:19s
epoch 76 | loss: 0.60548 | train_auc: 0.7156  | train_balanced_accuracy: 0.66    | train_accuracy: 0.66045 | valid_auc: 0.71014 | valid_balanced_accuracy: 0.6571  | valid_accuracy: 0.65754 |  0:21:37s
epoch 77 | loss: 0.60189 | train_auc: 0.70797 | train_balanced_accuracy: 0.65337 | train_accuracy: 0.6536  | valid_auc: 0.70323 | valid_balanced_accuracy: 0.64707 | valid_accuracy: 0.64731 |  0:21:52s
epoch 78 | loss: 0.60119 | train_auc: 0.70013 | train_balanced_accuracy: 0.64629 | train_accuracy: 0.64644 | valid_auc: 0.69788 | valid_balanced_accuracy: 0.64466 | valid_accuracy: 0.64479 |  0:22:08s
epoch 79 | loss: 0.59776 | train_auc: 0.69885 | train_balanced_accuracy: 0.64311 | train_accuracy: 0.6433  | valid_auc: 0.69941 | valid_balanced_accuracy: 0.64305 | valid_accuracy: 0.64322 |  0:22:26s
epoch 80 | loss: 0.60526 | train_auc: 0.69681 | train_balanced_accuracy: 0.64337 | train_accuracy: 0.64373 | valid_auc: 0.69649 | valid_balanced_accuracy: 0.64115 | valid_accuracy: 0.64149 |  0:22:45s
epoch 81 | loss: 0.60668 | train_auc: 0.71388 | train_balanced_accuracy: 0.65881 | train_accuracy: 0.65892 | valid_auc: 0.70487 | valid_balanced_accuracy: 0.6551  | valid_accuracy: 0.65518 |  0:23:02s
epoch 82 | loss: 0.60337 | train_auc: 0.71868 | train_balanced_accuracy: 0.66195 | train_accuracy: 0.66226 | valid_auc: 0.71224 | valid_balanced_accuracy: 0.65254 | valid_accuracy: 0.65282 |  0:23:18s
epoch 83 | loss: 0.60307 | train_auc: 0.7029  | train_balanced_accuracy: 0.65073 | train_accuracy: 0.65113 | valid_auc: 0.70247 | valid_balanced_accuracy: 0.65242 | valid_accuracy: 0.65282 |  0:23:33s
epoch 84 | loss: 0.60455 | train_auc: 0.72881 | train_balanced_accuracy: 0.6693  | train_accuracy: 0.66942 | valid_auc: 0.71605 | valid_balanced_accuracy: 0.66264 | valid_accuracy: 0.66273 |  0:23:50s
epoch 85 | loss: 0.6046  | train_auc: 0.74331 | train_balanced_accuracy: 0.67981 | train_accuracy: 0.68012 | valid_auc: 0.72168 | valid_balanced_accuracy: 0.66681 | valid_accuracy: 0.66714 |  0:24:06s

Early stopping occurred at epoch 85 with best_epoch = 65 and best_valid_accuracy = 0.66966
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 57/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.669 total time=24.2min
[CV 4/5; 57/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82676 | train_auc: 0.51306 | train_balanced_accuracy: 0.50914 | train_accuracy: 0.50783 | valid_auc: 0.5136  | valid_balanced_accuracy: 0.5149  | valid_accuracy: 0.51353 |  0:00:17s
epoch 1  | loss: 0.74068 | train_auc: 0.51376 | train_balanced_accuracy: 0.50703 | train_accuracy: 0.50382 | valid_auc: 0.5108  | valid_balanced_accuracy: 0.5047  | valid_accuracy: 0.50142 |  0:00:33s
epoch 2  | loss: 0.69899 | train_auc: 0.54819 | train_balanced_accuracy: 0.50978 | train_accuracy: 0.50653 | valid_auc: 0.54444 | valid_balanced_accuracy: 0.51305 | valid_accuracy: 0.50976 |  0:00:48s
epoch 3  | loss: 0.69371 | train_auc: 0.57143 | train_balanced_accuracy: 0.51915 | train_accuracy: 0.51633 | valid_auc: 0.56834 | valid_balanced_accuracy: 0.51907 | valid_accuracy: 0.51621 |  0:01:06s
epoch 4  | loss: 0.68459 | train_auc: 0.56036 | train_balanced_accuracy: 0.51638 | train_accuracy: 0.5133  | valid_auc: 0.55443 | valid_balanced_accuracy: 0.51601 | valid_accuracy: 0.51291 |  0:01:24s
epoch 5  | loss: 0.67683 | train_auc: 0.5825  | train_balanced_accuracy: 0.54506 | train_accuracy: 0.5432  | valid_auc: 0.58408 | valid_balanced_accuracy: 0.54554 | valid_accuracy: 0.54359 |  0:01:40s
epoch 6  | loss: 0.67388 | train_auc: 0.59601 | train_balanced_accuracy: 0.55858 | train_accuracy: 0.55693 | valid_auc: 0.59089 | valid_balanced_accuracy: 0.55973 | valid_accuracy: 0.55807 |  0:01:57s
epoch 7  | loss: 0.67239 | train_auc: 0.58387 | train_balanced_accuracy: 0.54295 | train_accuracy: 0.54045 | valid_auc: 0.57446 | valid_balanced_accuracy: 0.53701 | valid_accuracy: 0.53447 |  0:02:13s
epoch 8  | loss: 0.66254 | train_auc: 0.61224 | train_balanced_accuracy: 0.5619  | train_accuracy: 0.55957 | valid_auc: 0.59803 | valid_balanced_accuracy: 0.55244 | valid_accuracy: 0.55005 |  0:02:31s
epoch 9  | loss: 0.65716 | train_auc: 0.62244 | train_balanced_accuracy: 0.55665 | train_accuracy: 0.55414 | valid_auc: 0.6076  | valid_balanced_accuracy: 0.54887 | valid_accuracy: 0.54627 |  0:02:47s
epoch 10 | loss: 0.65296 | train_auc: 0.63538 | train_balanced_accuracy: 0.58417 | train_accuracy: 0.58247 | valid_auc: 0.62364 | valid_balanced_accuracy: 0.57788 | valid_accuracy: 0.57617 |  0:03:05s
epoch 11 | loss: 0.654   | train_auc: 0.65292 | train_balanced_accuracy: 0.59149 | train_accuracy: 0.58983 | valid_auc: 0.64109 | valid_balanced_accuracy: 0.58599 | valid_accuracy: 0.58436 |  0:03:22s
epoch 12 | loss: 0.64543 | train_auc: 0.65937 | train_balanced_accuracy: 0.59561 | train_accuracy: 0.594   | valid_auc: 0.64783 | valid_balanced_accuracy: 0.58751 | valid_accuracy: 0.58593 |  0:03:39s
epoch 13 | loss: 0.64688 | train_auc: 0.66847 | train_balanced_accuracy: 0.59992 | train_accuracy: 0.59836 | valid_auc: 0.65743 | valid_balanced_accuracy: 0.58761 | valid_accuracy: 0.58609 |  0:03:53s
epoch 14 | loss: 0.64246 | train_auc: 0.6664  | train_balanced_accuracy: 0.61129 | train_accuracy: 0.61044 | valid_auc: 0.65141 | valid_balanced_accuracy: 0.59936 | valid_accuracy: 0.59852 |  0:04:11s
epoch 15 | loss: 0.6436  | train_auc: 0.67692 | train_balanced_accuracy: 0.61261 | train_accuracy: 0.61143 | valid_auc: 0.66218 | valid_balanced_accuracy: 0.60187 | valid_accuracy: 0.60072 |  0:04:28s
epoch 16 | loss: 0.63749 | train_auc: 0.68107 | train_balanced_accuracy: 0.62435 | train_accuracy: 0.62366 | valid_auc: 0.66647 | valid_balanced_accuracy: 0.61392 | valid_accuracy: 0.61331 |  0:04:43s
epoch 17 | loss: 0.6327  | train_auc: 0.6885  | train_balanced_accuracy: 0.63419 | train_accuracy: 0.63381 | valid_auc: 0.67806 | valid_balanced_accuracy: 0.62797 | valid_accuracy: 0.62764 |  0:05:00s
epoch 18 | loss: 0.63683 | train_auc: 0.69532 | train_balanced_accuracy: 0.64506 | train_accuracy: 0.64503 | valid_auc: 0.6846  | valid_balanced_accuracy: 0.6433  | valid_accuracy: 0.64337 |  0:05:17s
epoch 19 | loss: 0.63395 | train_auc: 0.69395 | train_balanced_accuracy: 0.64217 | train_accuracy: 0.642   | valid_auc: 0.68323 | valid_balanced_accuracy: 0.63656 | valid_accuracy: 0.63645 |  0:05:36s
epoch 20 | loss: 0.63412 | train_auc: 0.69639 | train_balanced_accuracy: 0.64824 | train_accuracy: 0.64853 | valid_auc: 0.68168 | valid_balanced_accuracy: 0.63622 | valid_accuracy: 0.63661 |  0:05:53s
epoch 21 | loss: 0.63015 | train_auc: 0.69988 | train_balanced_accuracy: 0.6517  | train_accuracy: 0.65191 | valid_auc: 0.68525 | valid_balanced_accuracy: 0.64282 | valid_accuracy: 0.64306 |  0:06:09s
epoch 22 | loss: 0.63215 | train_auc: 0.69876 | train_balanced_accuracy: 0.64885 | train_accuracy: 0.6492  | valid_auc: 0.68427 | valid_balanced_accuracy: 0.6428  | valid_accuracy: 0.64322 |  0:06:25s
epoch 23 | loss: 0.62943 | train_auc: 0.69994 | train_balanced_accuracy: 0.64775 | train_accuracy: 0.6479  | valid_auc: 0.68668 | valid_balanced_accuracy: 0.64157 | valid_accuracy: 0.6418  |  0:06:42s
epoch 24 | loss: 0.63039 | train_auc: 0.70452 | train_balanced_accuracy: 0.65313 | train_accuracy: 0.65337 | valid_auc: 0.69065 | valid_balanced_accuracy: 0.64038 | valid_accuracy: 0.6407  |  0:06:59s
epoch 25 | loss: 0.62637 | train_auc: 0.7048  | train_balanced_accuracy: 0.65152 | train_accuracy: 0.65168 | valid_auc: 0.69242 | valid_balanced_accuracy: 0.64619 | valid_accuracy: 0.64636 |  0:07:16s
epoch 26 | loss: 0.62709 | train_auc: 0.70832 | train_balanced_accuracy: 0.65803 | train_accuracy: 0.65836 | valid_auc: 0.69366 | valid_balanced_accuracy: 0.649   | valid_accuracy: 0.64935 |  0:07:33s
epoch 27 | loss: 0.62853 | train_auc: 0.71051 | train_balanced_accuracy: 0.65863 | train_accuracy: 0.65907 | valid_auc: 0.69635 | valid_balanced_accuracy: 0.64929 | valid_accuracy: 0.64983 |  0:07:50s
epoch 28 | loss: 0.62535 | train_auc: 0.71411 | train_balanced_accuracy: 0.65712 | train_accuracy: 0.65726 | valid_auc: 0.70296 | valid_balanced_accuracy: 0.65071 | valid_accuracy: 0.65093 |  0:08:06s
epoch 29 | loss: 0.62573 | train_auc: 0.71292 | train_balanced_accuracy: 0.65673 | train_accuracy: 0.65699 | valid_auc: 0.69913 | valid_balanced_accuracy: 0.64651 | valid_accuracy: 0.64684 |  0:08:21s
epoch 30 | loss: 0.62047 | train_auc: 0.71535 | train_balanced_accuracy: 0.65595 | train_accuracy: 0.65624 | valid_auc: 0.7045  | valid_balanced_accuracy: 0.6468  | valid_accuracy: 0.64715 |  0:08:37s
epoch 31 | loss: 0.62362 | train_auc: 0.71601 | train_balanced_accuracy: 0.65816 | train_accuracy: 0.65852 | valid_auc: 0.69693 | valid_balanced_accuracy: 0.64105 | valid_accuracy: 0.64149 |  0:08:54s
epoch 32 | loss: 0.61681 | train_auc: 0.71723 | train_balanced_accuracy: 0.65869 | train_accuracy: 0.65903 | valid_auc: 0.69904 | valid_balanced_accuracy: 0.64671 | valid_accuracy: 0.64715 |  0:09:11s
epoch 33 | loss: 0.62261 | train_auc: 0.72002 | train_balanced_accuracy: 0.66087 | train_accuracy: 0.66116 | valid_auc: 0.70126 | valid_balanced_accuracy: 0.64161 | valid_accuracy: 0.64196 |  0:09:27s
epoch 34 | loss: 0.62052 | train_auc: 0.7158  | train_balanced_accuracy: 0.65513 | train_accuracy: 0.65549 | valid_auc: 0.69781 | valid_balanced_accuracy: 0.63915 | valid_accuracy: 0.6396  |  0:09:42s
epoch 35 | loss: 0.61768 | train_auc: 0.71703 | train_balanced_accuracy: 0.65635 | train_accuracy: 0.65675 | valid_auc: 0.70096 | valid_balanced_accuracy: 0.64619 | valid_accuracy: 0.64668 |  0:09:57s
epoch 36 | loss: 0.61675 | train_auc: 0.72173 | train_balanced_accuracy: 0.66107 | train_accuracy: 0.66139 | valid_auc: 0.70302 | valid_balanced_accuracy: 0.64569 | valid_accuracy: 0.64605 |  0:10:14s
epoch 37 | loss: 0.61593 | train_auc: 0.72244 | train_balanced_accuracy: 0.66521 | train_accuracy: 0.6656  | valid_auc: 0.70429 | valid_balanced_accuracy: 0.6516  | valid_accuracy: 0.65203 |  0:10:31s
epoch 38 | loss: 0.61897 | train_auc: 0.72216 | train_balanced_accuracy: 0.66508 | train_accuracy: 0.66553 | valid_auc: 0.70253 | valid_balanced_accuracy: 0.64667 | valid_accuracy: 0.64715 |  0:10:49s
epoch 39 | loss: 0.61678 | train_auc: 0.71901 | train_balanced_accuracy: 0.66018 | train_accuracy: 0.66041 | valid_auc: 0.70027 | valid_balanced_accuracy: 0.6447  | valid_accuracy: 0.64495 |  0:11:06s
epoch 40 | loss: 0.617   | train_auc: 0.71836 | train_balanced_accuracy: 0.66039 | train_accuracy: 0.66065 | valid_auc: 0.69936 | valid_balanced_accuracy: 0.63964 | valid_accuracy: 0.63991 |  0:11:21s
epoch 41 | loss: 0.62044 | train_auc: 0.70917 | train_balanced_accuracy: 0.6542  | train_accuracy: 0.65478 | valid_auc: 0.69204 | valid_balanced_accuracy: 0.64228 | valid_accuracy: 0.6429  |  0:11:37s
epoch 42 | loss: 0.61564 | train_auc: 0.70907 | train_balanced_accuracy: 0.65362 | train_accuracy: 0.65384 | valid_auc: 0.69922 | valid_balanced_accuracy: 0.64796 | valid_accuracy: 0.64825 |  0:11:53s
epoch 43 | loss: 0.61695 | train_auc: 0.69962 | train_balanced_accuracy: 0.64676 | train_accuracy: 0.64684 | valid_auc: 0.68761 | valid_balanced_accuracy: 0.63902 | valid_accuracy: 0.63912 |  0:12:12s
epoch 44 | loss: 0.61824 | train_auc: 0.69792 | train_balanced_accuracy: 0.64012 | train_accuracy: 0.64007 | valid_auc: 0.68462 | valid_balanced_accuracy: 0.62812 | valid_accuracy: 0.62811 |  0:12:29s
epoch 45 | loss: 0.61576 | train_auc: 0.69071 | train_balanced_accuracy: 0.63686 | train_accuracy: 0.63708 | valid_auc: 0.68033 | valid_balanced_accuracy: 0.63272 | valid_accuracy: 0.63299 |  0:12:44s
epoch 46 | loss: 0.6197  | train_auc: 0.70179 | train_balanced_accuracy: 0.65123 | train_accuracy: 0.6516  | valid_auc: 0.69026 | valid_balanced_accuracy: 0.64028 | valid_accuracy: 0.6407  |  0:13:01s
epoch 47 | loss: 0.6122  | train_auc: 0.64894 | train_balanced_accuracy: 0.61954 | train_accuracy: 0.61981 | valid_auc: 0.64734 | valid_balanced_accuracy: 0.61759 | valid_accuracy: 0.61788 |  0:13:16s
epoch 48 | loss: 0.61744 | train_auc: 0.64435 | train_balanced_accuracy: 0.61072 | train_accuracy: 0.61107 | valid_auc: 0.64556 | valid_balanced_accuracy: 0.62018 | valid_accuracy: 0.62055 |  0:13:33s
epoch 49 | loss: 0.61211 | train_auc: 0.7212  | train_balanced_accuracy: 0.663   | train_accuracy: 0.6632  | valid_auc: 0.7068  | valid_balanced_accuracy: 0.6516  | valid_accuracy: 0.65187 |  0:13:50s
epoch 50 | loss: 0.61655 | train_auc: 0.72847 | train_balanced_accuracy: 0.66527 | train_accuracy: 0.66533 | valid_auc: 0.71517 | valid_balanced_accuracy: 0.65995 | valid_accuracy: 0.66006 |  0:14:05s
epoch 51 | loss: 0.61021 | train_auc: 0.73085 | train_balanced_accuracy: 0.66897 | train_accuracy: 0.66946 | valid_auc: 0.70983 | valid_balanced_accuracy: 0.64741 | valid_accuracy: 0.64794 |  0:14:23s
epoch 52 | loss: 0.61058 | train_auc: 0.72439 | train_balanced_accuracy: 0.66634 | train_accuracy: 0.66682 | valid_auc: 0.71073 | valid_balanced_accuracy: 0.65612 | valid_accuracy: 0.65659 |  0:14:39s
epoch 53 | loss: 0.61135 | train_auc: 0.7311  | train_balanced_accuracy: 0.66786 | train_accuracy: 0.66844 | valid_auc: 0.71314 | valid_balanced_accuracy: 0.6539  | valid_accuracy: 0.65455 |  0:14:54s
epoch 54 | loss: 0.61425 | train_auc: 0.71623 | train_balanced_accuracy: 0.66067 | train_accuracy: 0.66096 | valid_auc: 0.70499 | valid_balanced_accuracy: 0.65263 | valid_accuracy: 0.65297 |  0:15:11s
epoch 55 | loss: 0.60942 | train_auc: 0.72093 | train_balanced_accuracy: 0.66394 | train_accuracy: 0.66419 | valid_auc: 0.71239 | valid_balanced_accuracy: 0.65473 | valid_accuracy: 0.65502 |  0:15:29s
epoch 56 | loss: 0.61333 | train_auc: 0.72534 | train_balanced_accuracy: 0.66515 | train_accuracy: 0.66576 | valid_auc: 0.71383 | valid_balanced_accuracy: 0.65705 | valid_accuracy: 0.6577  |  0:15:43s
epoch 57 | loss: 0.61409 | train_auc: 0.72334 | train_balanced_accuracy: 0.66563 | train_accuracy: 0.66588 | valid_auc: 0.7112  | valid_balanced_accuracy: 0.65532 | valid_accuracy: 0.65565 |  0:16:00s
epoch 58 | loss: 0.61313 | train_auc: 0.72064 | train_balanced_accuracy: 0.66624 | train_accuracy: 0.66663 | valid_auc: 0.70779 | valid_balanced_accuracy: 0.65445 | valid_accuracy: 0.65486 |  0:16:16s
epoch 59 | loss: 0.61116 | train_auc: 0.70288 | train_balanced_accuracy: 0.64664 | train_accuracy: 0.64676 | valid_auc: 0.69801 | valid_balanced_accuracy: 0.64788 | valid_accuracy: 0.6481  |  0:16:33s
epoch 60 | loss: 0.60921 | train_auc: 0.69896 | train_balanced_accuracy: 0.64273 | train_accuracy: 0.64286 | valid_auc: 0.69729 | valid_balanced_accuracy: 0.64553 | valid_accuracy: 0.64573 |  0:16:48s
epoch 61 | loss: 0.60933 | train_auc: 0.71478 | train_balanced_accuracy: 0.65906 | train_accuracy: 0.65931 | valid_auc: 0.70667 | valid_balanced_accuracy: 0.65564 | valid_accuracy: 0.65596 |  0:17:05s
epoch 62 | loss: 0.60927 | train_auc: 0.72372 | train_balanced_accuracy: 0.66533 | train_accuracy: 0.66592 | valid_auc: 0.7134  | valid_balanced_accuracy: 0.66098 | valid_accuracy: 0.66163 |  0:17:21s
epoch 63 | loss: 0.61092 | train_auc: 0.73352 | train_balanced_accuracy: 0.67255 | train_accuracy: 0.67288 | valid_auc: 0.71562 | valid_balanced_accuracy: 0.65635 | valid_accuracy: 0.65675 |  0:17:38s
epoch 64 | loss: 0.6076  | train_auc: 0.7355  | train_balanced_accuracy: 0.67139 | train_accuracy: 0.67151 | valid_auc: 0.71772 | valid_balanced_accuracy: 0.65865 | valid_accuracy: 0.6588  |  0:17:55s
epoch 65 | loss: 0.60769 | train_auc: 0.73781 | train_balanced_accuracy: 0.67256 | train_accuracy: 0.67277 | valid_auc: 0.71668 | valid_balanced_accuracy: 0.66046 | valid_accuracy: 0.66069 |  0:18:12s
epoch 66 | loss: 0.60868 | train_auc: 0.7362  | train_balanced_accuracy: 0.67226 | train_accuracy: 0.67233 | valid_auc: 0.71442 | valid_balanced_accuracy: 0.65551 | valid_accuracy: 0.65565 |  0:18:31s
epoch 67 | loss: 0.60807 | train_auc: 0.72569 | train_balanced_accuracy: 0.6651  | train_accuracy: 0.66541 | valid_auc: 0.71417 | valid_balanced_accuracy: 0.65913 | valid_accuracy: 0.65943 |  0:18:48s
epoch 68 | loss: 0.6088  | train_auc: 0.71419 | train_balanced_accuracy: 0.66074 | train_accuracy: 0.661   | valid_auc: 0.70672 | valid_balanced_accuracy: 0.65425 | valid_accuracy: 0.65455 |  0:19:06s
epoch 69 | loss: 0.60602 | train_auc: 0.70551 | train_balanced_accuracy: 0.65458 | train_accuracy: 0.65475 | valid_auc: 0.70339 | valid_balanced_accuracy: 0.65419 | valid_accuracy: 0.65439 |  0:19:23s
epoch 70 | loss: 0.609   | train_auc: 0.7215  | train_balanced_accuracy: 0.66297 | train_accuracy: 0.66309 | valid_auc: 0.70804 | valid_balanced_accuracy: 0.65422 | valid_accuracy: 0.65439 |  0:19:39s
epoch 71 | loss: 0.60962 | train_auc: 0.70657 | train_balanced_accuracy: 0.65151 | train_accuracy: 0.65183 | valid_auc: 0.70154 | valid_balanced_accuracy: 0.64913 | valid_accuracy: 0.64951 |  0:19:55s
epoch 72 | loss: 0.61047 | train_auc: 0.7093  | train_balanced_accuracy: 0.65474 | train_accuracy: 0.65467 | valid_auc: 0.70394 | valid_balanced_accuracy: 0.65501 | valid_accuracy: 0.65502 |  0:20:12s
epoch 73 | loss: 0.60774 | train_auc: 0.72397 | train_balanced_accuracy: 0.66693 | train_accuracy: 0.6671  | valid_auc: 0.70837 | valid_balanced_accuracy: 0.65447 | valid_accuracy: 0.65471 |  0:20:29s
epoch 74 | loss: 0.60559 | train_auc: 0.71993 | train_balanced_accuracy: 0.6647  | train_accuracy: 0.66494 | valid_auc: 0.71001 | valid_balanced_accuracy: 0.65569 | valid_accuracy: 0.65596 |  0:20:46s
epoch 75 | loss: 0.60919 | train_auc: 0.67062 | train_balanced_accuracy: 0.62016 | train_accuracy: 0.61989 | valid_auc: 0.66971 | valid_balanced_accuracy: 0.62489 | valid_accuracy: 0.62465 |  0:21:01s
epoch 76 | loss: 0.60589 | train_auc: 0.66156 | train_balanced_accuracy: 0.62117 | train_accuracy: 0.62114 | valid_auc: 0.6649  | valid_balanced_accuracy: 0.62982 | valid_accuracy: 0.62984 |  0:21:18s
epoch 77 | loss: 0.6056  | train_auc: 0.72908 | train_balanced_accuracy: 0.6698  | train_accuracy: 0.66981 | valid_auc: 0.71453 | valid_balanced_accuracy: 0.65824 | valid_accuracy: 0.65833 |  0:21:36s
epoch 78 | loss: 0.60017 | train_auc: 0.73665 | train_balanced_accuracy: 0.6769  | train_accuracy: 0.67717 | valid_auc: 0.72296 | valid_balanced_accuracy: 0.66493 | valid_accuracy: 0.66525 |  0:21:53s
epoch 79 | loss: 0.60114 | train_auc: 0.73872 | train_balanced_accuracy: 0.6781  | train_accuracy: 0.67835 | valid_auc: 0.72653 | valid_balanced_accuracy: 0.66812 | valid_accuracy: 0.6684  |  0:22:10s
epoch 80 | loss: 0.60575 | train_auc: 0.74218 | train_balanced_accuracy: 0.6782  | train_accuracy: 0.67839 | valid_auc: 0.71986 | valid_balanced_accuracy: 0.66156 | valid_accuracy: 0.66179 |  0:22:25s
epoch 81 | loss: 0.60555 | train_auc: 0.69376 | train_balanced_accuracy: 0.64332 | train_accuracy: 0.64357 | valid_auc: 0.69185 | valid_balanced_accuracy: 0.64103 | valid_accuracy: 0.64133 |  0:22:41s
epoch 82 | loss: 0.60677 | train_auc: 0.72965 | train_balanced_accuracy: 0.66953 | train_accuracy: 0.66981 | valid_auc: 0.71148 | valid_balanced_accuracy: 0.65785 | valid_accuracy: 0.65817 |  0:22:58s
epoch 83 | loss: 0.60344 | train_auc: 0.71924 | train_balanced_accuracy: 0.66317 | train_accuracy: 0.66336 | valid_auc: 0.70808 | valid_balanced_accuracy: 0.65193 | valid_accuracy: 0.65219 |  0:23:14s
epoch 84 | loss: 0.60373 | train_auc: 0.6992  | train_balanced_accuracy: 0.64748 | train_accuracy: 0.64743 | valid_auc: 0.69743 | valid_balanced_accuracy: 0.64481 | valid_accuracy: 0.64479 |  0:23:29s
epoch 85 | loss: 0.60267 | train_auc: 0.71947 | train_balanced_accuracy: 0.66405 | train_accuracy: 0.66415 | valid_auc: 0.71032 | valid_balanced_accuracy: 0.65989 | valid_accuracy: 0.66006 |  0:23:45s
epoch 86 | loss: 0.60466 | train_auc: 0.74591 | train_balanced_accuracy: 0.6822  | train_accuracy: 0.6824  | valid_auc: 0.72351 | valid_balanced_accuracy: 0.66204 | valid_accuracy: 0.66226 |  0:24:01s
epoch 87 | loss: 0.60033 | train_auc: 0.74002 | train_balanced_accuracy: 0.68055 | train_accuracy: 0.68079 | valid_auc: 0.72479 | valid_balanced_accuracy: 0.66733 | valid_accuracy: 0.66761 |  0:24:20s
epoch 88 | loss: 0.60024 | train_auc: 0.72596 | train_balanced_accuracy: 0.66675 | train_accuracy: 0.66722 | valid_auc: 0.71835 | valid_balanced_accuracy: 0.66646 | valid_accuracy: 0.66698 |  0:24:36s
epoch 89 | loss: 0.59839 | train_auc: 0.73088 | train_balanced_accuracy: 0.67169 | train_accuracy: 0.67206 | valid_auc: 0.7194  | valid_balanced_accuracy: 0.66955 | valid_accuracy: 0.66997 |  0:24:50s
epoch 90 | loss: 0.60234 | train_auc: 0.73708 | train_balanced_accuracy: 0.67444 | train_accuracy: 0.67485 | valid_auc: 0.72222 | valid_balanced_accuracy: 0.66433 | valid_accuracy: 0.66478 |  0:25:06s
epoch 91 | loss: 0.60013 | train_auc: 0.74444 | train_balanced_accuracy: 0.6798  | train_accuracy: 0.68    | valid_auc: 0.72831 | valid_balanced_accuracy: 0.66577 | valid_accuracy: 0.66604 |  0:25:24s
epoch 92 | loss: 0.59891 | train_auc: 0.74107 | train_balanced_accuracy: 0.67661 | train_accuracy: 0.67674 | valid_auc: 0.7232  | valid_balanced_accuracy: 0.66241 | valid_accuracy: 0.66257 |  0:25:41s
epoch 93 | loss: 0.59827 | train_auc: 0.74688 | train_balanced_accuracy: 0.68476 | train_accuracy: 0.68504 | valid_auc: 0.72661 | valid_balanced_accuracy: 0.66572 | valid_accuracy: 0.66604 |  0:25:58s
epoch 94 | loss: 0.60486 | train_auc: 0.74033 | train_balanced_accuracy: 0.67735 | train_accuracy: 0.67745 | valid_auc: 0.72306 | valid_balanced_accuracy: 0.66623 | valid_accuracy: 0.66635 |  0:26:15s
epoch 95 | loss: 0.59892 | train_auc: 0.74849 | train_balanced_accuracy: 0.68338 | train_accuracy: 0.68366 | valid_auc: 0.72579 | valid_balanced_accuracy: 0.66758 | valid_accuracy: 0.66793 |  0:26:32s
epoch 96 | loss: 0.59964 | train_auc: 0.74878 | train_balanced_accuracy: 0.68333 | train_accuracy: 0.68362 | valid_auc: 0.72613 | valid_balanced_accuracy: 0.66635 | valid_accuracy: 0.66667 |  0:26:49s
epoch 97 | loss: 0.59771 | train_auc: 0.7483  | train_balanced_accuracy: 0.68168 | train_accuracy: 0.68189 | valid_auc: 0.72408 | valid_balanced_accuracy: 0.66801 | valid_accuracy: 0.66824 |  0:27:06s
epoch 98 | loss: 0.60103 | train_auc: 0.74983 | train_balanced_accuracy: 0.68451 | train_accuracy: 0.68473 | valid_auc: 0.72741 | valid_balanced_accuracy: 0.66704 | valid_accuracy: 0.6673  |  0:27:22s
epoch 99 | loss: 0.60239 | train_auc: 0.75143 | train_balanced_accuracy: 0.68567 | train_accuracy: 0.68606 | valid_auc: 0.72671 | valid_balanced_accuracy: 0.66794 | valid_accuracy: 0.6684  |  0:27:40s
epoch 100| loss: 0.59522 | train_auc: 0.74734 | train_balanced_accuracy: 0.68367 | train_accuracy: 0.68374 | valid_auc: 0.72359 | valid_balanced_accuracy: 0.66418 | valid_accuracy: 0.66431 |  0:27:58s
epoch 101| loss: 0.59615 | train_auc: 0.74688 | train_balanced_accuracy: 0.68229 | train_accuracy: 0.6824  | valid_auc: 0.72375 | valid_balanced_accuracy: 0.66446 | valid_accuracy: 0.66462 |  0:28:14s
epoch 102| loss: 0.60033 | train_auc: 0.74705 | train_balanced_accuracy: 0.6818  | train_accuracy: 0.68205 | valid_auc: 0.72637 | valid_balanced_accuracy: 0.6695  | valid_accuracy: 0.66981 |  0:28:30s
epoch 103| loss: 0.5945  | train_auc: 0.74198 | train_balanced_accuracy: 0.67875 | train_accuracy: 0.6791  | valid_auc: 0.72567 | valid_balanced_accuracy: 0.66816 | valid_accuracy: 0.66856 |  0:28:46s
epoch 104| loss: 0.59435 | train_auc: 0.74999 | train_balanced_accuracy: 0.6858  | train_accuracy: 0.68583 | valid_auc: 0.7275  | valid_balanced_accuracy: 0.66909 | valid_accuracy: 0.66918 |  0:29:02s
epoch 105| loss: 0.60105 | train_auc: 0.7446  | train_balanced_accuracy: 0.68054 | train_accuracy: 0.68063 | valid_auc: 0.72959 | valid_balanced_accuracy: 0.67372 | valid_accuracy: 0.67391 |  0:29:17s
epoch 106| loss: 0.59496 | train_auc: 0.7521  | train_balanced_accuracy: 0.68489 | train_accuracy: 0.68516 | valid_auc: 0.72828 | valid_balanced_accuracy: 0.66792 | valid_accuracy: 0.66824 |  0:29:36s
epoch 107| loss: 0.60075 | train_auc: 0.75067 | train_balanced_accuracy: 0.68534 | train_accuracy: 0.68551 | valid_auc: 0.72697 | valid_balanced_accuracy: 0.67145 | valid_accuracy: 0.6717  |  0:29:54s
epoch 108| loss: 0.59151 | train_auc: 0.75231 | train_balanced_accuracy: 0.68663 | train_accuracy: 0.68677 | valid_auc: 0.73088 | valid_balanced_accuracy: 0.66886 | valid_accuracy: 0.66903 |  0:30:10s
epoch 109| loss: 0.59584 | train_auc: 0.74558 | train_balanced_accuracy: 0.68085 | train_accuracy: 0.68115 | valid_auc: 0.72556 | valid_balanced_accuracy: 0.66648 | valid_accuracy: 0.66682 |  0:30:27s
epoch 110| loss: 0.59735 | train_auc: 0.7334  | train_balanced_accuracy: 0.67318 | train_accuracy: 0.67383 | valid_auc: 0.72106 | valid_balanced_accuracy: 0.66696 | valid_accuracy: 0.66761 |  0:30:43s
epoch 111| loss: 0.59717 | train_auc: 0.7428  | train_balanced_accuracy: 0.67847 | train_accuracy: 0.67875 | valid_auc: 0.72654 | valid_balanced_accuracy: 0.66429 | valid_accuracy: 0.66462 |  0:31:00s
epoch 112| loss: 0.59407 | train_auc: 0.75325 | train_balanced_accuracy: 0.68882 | train_accuracy: 0.68909 | valid_auc: 0.72998 | valid_balanced_accuracy: 0.67093 | valid_accuracy: 0.67123 |  0:31:17s
epoch 113| loss: 0.59684 | train_auc: 0.74859 | train_balanced_accuracy: 0.68355 | train_accuracy: 0.68343 | valid_auc: 0.73062 | valid_balanced_accuracy: 0.67161 | valid_accuracy: 0.67155 |  0:31:33s
epoch 114| loss: 0.59716 | train_auc: 0.73994 | train_balanced_accuracy: 0.67769 | train_accuracy: 0.67792 | valid_auc: 0.72479 | valid_balanced_accuracy: 0.66814 | valid_accuracy: 0.6684  |  0:31:48s
epoch 115| loss: 0.59443 | train_auc: 0.74533 | train_balanced_accuracy: 0.68318 | train_accuracy: 0.68343 | valid_auc: 0.72891 | valid_balanced_accuracy: 0.6733  | valid_accuracy: 0.67359 |  0:32:05s
epoch 116| loss: 0.59221 | train_auc: 0.75028 | train_balanced_accuracy: 0.68479 | train_accuracy: 0.68473 | valid_auc: 0.73373 | valid_balanced_accuracy: 0.67266 | valid_accuracy: 0.67265 |  0:32:21s
epoch 117| loss: 0.59365 | train_auc: 0.75413 | train_balanced_accuracy: 0.68782 | train_accuracy: 0.68795 | valid_auc: 0.73145 | valid_balanced_accuracy: 0.67149 | valid_accuracy: 0.6717  |  0:32:35s
epoch 118| loss: 0.59285 | train_auc: 0.74682 | train_balanced_accuracy: 0.68071 | train_accuracy: 0.68079 | valid_auc: 0.72616 | valid_balanced_accuracy: 0.66061 | valid_accuracy: 0.66069 |  0:32:53s
epoch 119| loss: 0.59383 | train_auc: 0.75296 | train_balanced_accuracy: 0.68358 | train_accuracy: 0.68351 | valid_auc: 0.73244 | valid_balanced_accuracy: 0.66938 | valid_accuracy: 0.66934 |  0:33:10s
epoch 120| loss: 0.5888  | train_auc: 0.74323 | train_balanced_accuracy: 0.68086 | train_accuracy: 0.68111 | valid_auc: 0.72837 | valid_balanced_accuracy: 0.66657 | valid_accuracy: 0.66682 |  0:33:25s
epoch 121| loss: 0.59559 | train_auc: 0.74722 | train_balanced_accuracy: 0.68531 | train_accuracy: 0.68559 | valid_auc: 0.73294 | valid_balanced_accuracy: 0.66983 | valid_accuracy: 0.67013 |  0:33:43s
epoch 122| loss: 0.59311 | train_auc: 0.75158 | train_balanced_accuracy: 0.68533 | train_accuracy: 0.68587 | valid_auc: 0.7303  | valid_balanced_accuracy: 0.6716  | valid_accuracy: 0.67218 |  0:33:59s
epoch 123| loss: 0.5958  | train_auc: 0.75566 | train_balanced_accuracy: 0.68886 | train_accuracy: 0.68901 | valid_auc: 0.73401 | valid_balanced_accuracy: 0.6693  | valid_accuracy: 0.6695  |  0:34:16s
epoch 124| loss: 0.59502 | train_auc: 0.75546 | train_balanced_accuracy: 0.68795 | train_accuracy: 0.68835 | valid_auc: 0.73315 | valid_balanced_accuracy: 0.66526 | valid_accuracy: 0.66572 |  0:34:32s
epoch 125| loss: 0.59475 | train_auc: 0.75118 | train_balanced_accuracy: 0.68238 | train_accuracy: 0.68205 | valid_auc: 0.72975 | valid_balanced_accuracy: 0.66747 | valid_accuracy: 0.66714 |  0:34:49s

Early stopping occurred at epoch 125 with best_epoch = 105 and best_valid_accuracy = 0.67391
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 57/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.667 total time=35.0min
[CV 5/5; 57/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.83079 | train_auc: 0.53756 | train_balanced_accuracy: 0.52384 | train_accuracy: 0.52195 | valid_auc: 0.52706 | valid_balanced_accuracy: 0.52132 | valid_accuracy: 0.51936 |  0:00:15s
epoch 1  | loss: 0.73845 | train_auc: 0.54551 | train_balanced_accuracy: 0.51136 | train_accuracy: 0.50818 | valid_auc: 0.5498  | valid_balanced_accuracy: 0.51205 | valid_accuracy: 0.50881 |  0:00:32s
epoch 2  | loss: 0.7046  | train_auc: 0.53273 | train_balanced_accuracy: 0.5079  | train_accuracy: 0.50472 | valid_auc: 0.54111 | valid_balanced_accuracy: 0.51192 | valid_accuracy: 0.50866 |  0:00:49s
epoch 3  | loss: 0.69339 | train_auc: 0.56689 | train_balanced_accuracy: 0.52457 | train_accuracy: 0.52192 | valid_auc: 0.57373 | valid_balanced_accuracy: 0.52381 | valid_accuracy: 0.52109 |  0:01:05s
epoch 4  | loss: 0.68011 | train_auc: 0.58488 | train_balanced_accuracy: 0.52601 | train_accuracy: 0.52317 | valid_auc: 0.58611 | valid_balanced_accuracy: 0.52555 | valid_accuracy: 0.52266 |  0:01:21s
epoch 5  | loss: 0.67408 | train_auc: 0.59286 | train_balanced_accuracy: 0.53439 | train_accuracy: 0.53159 | valid_auc: 0.59447 | valid_balanced_accuracy: 0.53937 | valid_accuracy: 0.53651 |  0:01:37s
epoch 6  | loss: 0.66915 | train_auc: 0.59791 | train_balanced_accuracy: 0.54044 | train_accuracy: 0.53793 | valid_auc: 0.60111 | valid_balanced_accuracy: 0.54236 | valid_accuracy: 0.53982 |  0:01:55s
epoch 7  | loss: 0.66256 | train_auc: 0.60885 | train_balanced_accuracy: 0.54564 | train_accuracy: 0.54297 | valid_auc: 0.60833 | valid_balanced_accuracy: 0.54681 | valid_accuracy: 0.54407 |  0:02:12s
epoch 8  | loss: 0.65872 | train_auc: 0.633   | train_balanced_accuracy: 0.56504 | train_accuracy: 0.56307 | valid_auc: 0.6278  | valid_balanced_accuracy: 0.56621 | valid_accuracy: 0.56421 |  0:02:29s
epoch 9  | loss: 0.65533 | train_auc: 0.63917 | train_balanced_accuracy: 0.56002 | train_accuracy: 0.55807 | valid_auc: 0.63707 | valid_balanced_accuracy: 0.56145 | valid_accuracy: 0.55949 |  0:02:45s
epoch 10 | loss: 0.65299 | train_auc: 0.64467 | train_balanced_accuracy: 0.56278 | train_accuracy: 0.56047 | valid_auc: 0.64049 | valid_balanced_accuracy: 0.56011 | valid_accuracy: 0.55776 |  0:03:02s
epoch 11 | loss: 0.64983 | train_auc: 0.64958 | train_balanced_accuracy: 0.56937 | train_accuracy: 0.56716 | valid_auc: 0.6425  | valid_balanced_accuracy: 0.56711 | valid_accuracy: 0.56484 |  0:03:18s
epoch 12 | loss: 0.64991 | train_auc: 0.6595  | train_balanced_accuracy: 0.57992 | train_accuracy: 0.57794 | valid_auc: 0.65353 | valid_balanced_accuracy: 0.57661 | valid_accuracy: 0.5746  |  0:03:34s
epoch 13 | loss: 0.64916 | train_auc: 0.6661  | train_balanced_accuracy: 0.59832 | train_accuracy: 0.59703 | valid_auc: 0.65858 | valid_balanced_accuracy: 0.59287 | valid_accuracy: 0.5916  |  0:03:50s
epoch 14 | loss: 0.64214 | train_auc: 0.66958 | train_balanced_accuracy: 0.6099  | train_accuracy: 0.60871 | valid_auc: 0.66319 | valid_balanced_accuracy: 0.60445 | valid_accuracy: 0.60324 |  0:04:07s
epoch 15 | loss: 0.64005 | train_auc: 0.67527 | train_balanced_accuracy: 0.61586 | train_accuracy: 0.61489 | valid_auc: 0.66807 | valid_balanced_accuracy: 0.61067 | valid_accuracy: 0.60969 |  0:04:24s
epoch 16 | loss: 0.64154 | train_auc: 0.67682 | train_balanced_accuracy: 0.62193 | train_accuracy: 0.62122 | valid_auc: 0.66793 | valid_balanced_accuracy: 0.61531 | valid_accuracy: 0.61457 |  0:04:39s
epoch 17 | loss: 0.64098 | train_auc: 0.68141 | train_balanced_accuracy: 0.62481 | train_accuracy: 0.62406 | valid_auc: 0.67223 | valid_balanced_accuracy: 0.61932 | valid_accuracy: 0.61851 |  0:04:56s
epoch 18 | loss: 0.64049 | train_auc: 0.68996 | train_balanced_accuracy: 0.63836 | train_accuracy: 0.6381  | valid_auc: 0.67588 | valid_balanced_accuracy: 0.63076 | valid_accuracy: 0.63047 |  0:05:13s
epoch 19 | loss: 0.63644 | train_auc: 0.68931 | train_balanced_accuracy: 0.64226 | train_accuracy: 0.64208 | valid_auc: 0.6774  | valid_balanced_accuracy: 0.63272 | valid_accuracy: 0.63251 |  0:05:29s
epoch 20 | loss: 0.6338  | train_auc: 0.69537 | train_balanced_accuracy: 0.65037 | train_accuracy: 0.65042 | valid_auc: 0.68585 | valid_balanced_accuracy: 0.64741 | valid_accuracy: 0.64747 |  0:05:45s
epoch 21 | loss: 0.63383 | train_auc: 0.69286 | train_balanced_accuracy: 0.64768 | train_accuracy: 0.64758 | valid_auc: 0.6827  | valid_balanced_accuracy: 0.63764 | valid_accuracy: 0.63755 |  0:06:02s
epoch 22 | loss: 0.6312  | train_auc: 0.69921 | train_balanced_accuracy: 0.65075 | train_accuracy: 0.65085 | valid_auc: 0.68835 | valid_balanced_accuracy: 0.64061 | valid_accuracy: 0.6407  |  0:06:19s
epoch 23 | loss: 0.62984 | train_auc: 0.70012 | train_balanced_accuracy: 0.65181 | train_accuracy: 0.65195 | valid_auc: 0.68852 | valid_balanced_accuracy: 0.64232 | valid_accuracy: 0.64243 |  0:06:35s
epoch 24 | loss: 0.63542 | train_auc: 0.70431 | train_balanced_accuracy: 0.6564  | train_accuracy: 0.65636 | valid_auc: 0.69491 | valid_balanced_accuracy: 0.64434 | valid_accuracy: 0.64432 |  0:06:51s
epoch 25 | loss: 0.62817 | train_auc: 0.70384 | train_balanced_accuracy: 0.65459 | train_accuracy: 0.65471 | valid_auc: 0.69396 | valid_balanced_accuracy: 0.64719 | valid_accuracy: 0.64731 |  0:07:09s
epoch 26 | loss: 0.62777 | train_auc: 0.70758 | train_balanced_accuracy: 0.65816 | train_accuracy: 0.65825 | valid_auc: 0.69824 | valid_balanced_accuracy: 0.6458  | valid_accuracy: 0.64589 |  0:07:26s
epoch 27 | loss: 0.62759 | train_auc: 0.70807 | train_balanced_accuracy: 0.6585  | train_accuracy: 0.65892 | valid_auc: 0.69349 | valid_balanced_accuracy: 0.64771 | valid_accuracy: 0.6481  |  0:07:41s
epoch 28 | loss: 0.62886 | train_auc: 0.71133 | train_balanced_accuracy: 0.65635 | train_accuracy: 0.6564  | valid_auc: 0.69614 | valid_balanced_accuracy: 0.64395 | valid_accuracy: 0.644   |  0:07:58s
epoch 29 | loss: 0.62681 | train_auc: 0.71599 | train_balanced_accuracy: 0.66005 | train_accuracy: 0.66033 | valid_auc: 0.70125 | valid_balanced_accuracy: 0.64781 | valid_accuracy: 0.6481  |  0:08:14s
epoch 30 | loss: 0.62524 | train_auc: 0.71563 | train_balanced_accuracy: 0.66143 | train_accuracy: 0.66171 | valid_auc: 0.70436 | valid_balanced_accuracy: 0.6527  | valid_accuracy: 0.65297 |  0:08:33s
epoch 31 | loss: 0.6244  | train_auc: 0.71465 | train_balanced_accuracy: 0.65666 | train_accuracy: 0.65675 | valid_auc: 0.70721 | valid_balanced_accuracy: 0.65192 | valid_accuracy: 0.65203 |  0:08:49s
epoch 32 | loss: 0.62581 | train_auc: 0.71774 | train_balanced_accuracy: 0.66105 | train_accuracy: 0.66136 | valid_auc: 0.70457 | valid_balanced_accuracy: 0.65049 | valid_accuracy: 0.65077 |  0:09:05s
epoch 33 | loss: 0.62759 | train_auc: 0.7149  | train_balanced_accuracy: 0.6592  | train_accuracy: 0.65955 | valid_auc: 0.6975  | valid_balanced_accuracy: 0.64838 | valid_accuracy: 0.64873 |  0:09:23s
epoch 34 | loss: 0.61897 | train_auc: 0.71371 | train_balanced_accuracy: 0.65744 | train_accuracy: 0.65754 | valid_auc: 0.69964 | valid_balanced_accuracy: 0.64292 | valid_accuracy: 0.64306 |  0:09:39s
epoch 35 | loss: 0.62248 | train_auc: 0.71133 | train_balanced_accuracy: 0.65787 | train_accuracy: 0.65805 | valid_auc: 0.7042  | valid_balanced_accuracy: 0.64883 | valid_accuracy: 0.64904 |  0:09:54s
epoch 36 | loss: 0.61676 | train_auc: 0.70917 | train_balanced_accuracy: 0.65351 | train_accuracy: 0.6538  | valid_auc: 0.70208 | valid_balanced_accuracy: 0.64703 | valid_accuracy: 0.64731 |  0:10:09s
epoch 37 | loss: 0.62071 | train_auc: 0.71167 | train_balanced_accuracy: 0.65664 | train_accuracy: 0.65655 | valid_auc: 0.70702 | valid_balanced_accuracy: 0.6543  | valid_accuracy: 0.65423 |  0:10:25s
epoch 38 | loss: 0.61875 | train_auc: 0.70165 | train_balanced_accuracy: 0.64849 | train_accuracy: 0.64869 | valid_auc: 0.69895 | valid_balanced_accuracy: 0.64174 | valid_accuracy: 0.64196 |  0:10:41s
epoch 39 | loss: 0.62147 | train_auc: 0.70627 | train_balanced_accuracy: 0.65246 | train_accuracy: 0.65274 | valid_auc: 0.70164 | valid_balanced_accuracy: 0.64643 | valid_accuracy: 0.64668 |  0:10:57s
epoch 40 | loss: 0.61732 | train_auc: 0.71827 | train_balanced_accuracy: 0.66176 | train_accuracy: 0.66218 | valid_auc: 0.70691 | valid_balanced_accuracy: 0.64924 | valid_accuracy: 0.64967 |  0:11:13s
epoch 41 | loss: 0.61788 | train_auc: 0.71363 | train_balanced_accuracy: 0.65564 | train_accuracy: 0.65573 | valid_auc: 0.70345 | valid_balanced_accuracy: 0.64658 | valid_accuracy: 0.64668 |  0:11:30s
epoch 42 | loss: 0.61779 | train_auc: 0.71036 | train_balanced_accuracy: 0.65257 | train_accuracy: 0.65278 | valid_auc: 0.6979  | valid_balanced_accuracy: 0.64436 | valid_accuracy: 0.64463 |  0:11:47s
epoch 43 | loss: 0.61442 | train_auc: 0.72572 | train_balanced_accuracy: 0.66527 | train_accuracy: 0.66529 | valid_auc: 0.70995 | valid_balanced_accuracy: 0.6512  | valid_accuracy: 0.65124 |  0:12:06s
epoch 44 | loss: 0.61542 | train_auc: 0.72486 | train_balanced_accuracy: 0.6631  | train_accuracy: 0.6632  | valid_auc: 0.71043 | valid_balanced_accuracy: 0.65161 | valid_accuracy: 0.65172 |  0:12:23s
epoch 45 | loss: 0.61424 | train_auc: 0.7073  | train_balanced_accuracy: 0.6511  | train_accuracy: 0.65168 | valid_auc: 0.70222 | valid_balanced_accuracy: 0.65036 | valid_accuracy: 0.65093 |  0:12:40s
epoch 46 | loss: 0.61638 | train_auc: 0.7046  | train_balanced_accuracy: 0.64996 | train_accuracy: 0.65042 | valid_auc: 0.70207 | valid_balanced_accuracy: 0.64729 | valid_accuracy: 0.64778 |  0:12:54s
epoch 47 | loss: 0.61745 | train_auc: 0.72905 | train_balanced_accuracy: 0.66796 | train_accuracy: 0.66804 | valid_auc: 0.71429 | valid_balanced_accuracy: 0.65227 | valid_accuracy: 0.65234 |  0:13:10s
epoch 48 | loss: 0.61376 | train_auc: 0.7299  | train_balanced_accuracy: 0.66876 | train_accuracy: 0.66926 | valid_auc: 0.71161 | valid_balanced_accuracy: 0.65279 | valid_accuracy: 0.65329 |  0:13:28s
epoch 49 | loss: 0.61358 | train_auc: 0.73022 | train_balanced_accuracy: 0.67053 | train_accuracy: 0.67084 | valid_auc: 0.71562 | valid_balanced_accuracy: 0.6519  | valid_accuracy: 0.65219 |  0:13:44s
epoch 50 | loss: 0.61015 | train_auc: 0.72806 | train_balanced_accuracy: 0.66665 | train_accuracy: 0.66671 | valid_auc: 0.70907 | valid_balanced_accuracy: 0.64597 | valid_accuracy: 0.64605 |  0:14:01s
epoch 51 | loss: 0.61235 | train_auc: 0.71998 | train_balanced_accuracy: 0.66183 | train_accuracy: 0.66202 | valid_auc: 0.70907 | valid_balanced_accuracy: 0.65105 | valid_accuracy: 0.65124 |  0:14:18s
epoch 52 | loss: 0.61381 | train_auc: 0.72183 | train_balanced_accuracy: 0.66242 | train_accuracy: 0.66261 | valid_auc: 0.70842 | valid_balanced_accuracy: 0.64755 | valid_accuracy: 0.64778 |  0:14:33s
epoch 53 | loss: 0.61603 | train_auc: 0.72407 | train_balanced_accuracy: 0.66255 | train_accuracy: 0.66316 | valid_auc: 0.70996 | valid_balanced_accuracy: 0.65123 | valid_accuracy: 0.65187 |  0:14:50s
epoch 54 | loss: 0.61608 | train_auc: 0.71242 | train_balanced_accuracy: 0.65565 | train_accuracy: 0.656   | valid_auc: 0.70695 | valid_balanced_accuracy: 0.65542 | valid_accuracy: 0.65581 |  0:15:06s
epoch 55 | loss: 0.61457 | train_auc: 0.71176 | train_balanced_accuracy: 0.65431 | train_accuracy: 0.65455 | valid_auc: 0.70173 | valid_balanced_accuracy: 0.64284 | valid_accuracy: 0.64306 |  0:15:24s
epoch 56 | loss: 0.61482 | train_auc: 0.73245 | train_balanced_accuracy: 0.67207 | train_accuracy: 0.67245 | valid_auc: 0.71427 | valid_balanced_accuracy: 0.65421 | valid_accuracy: 0.65455 |  0:15:41s
epoch 57 | loss: 0.61109 | train_auc: 0.72832 | train_balanced_accuracy: 0.66889 | train_accuracy: 0.66915 | valid_auc: 0.71198 | valid_balanced_accuracy: 0.65491 | valid_accuracy: 0.65518 |  0:15:55s
epoch 58 | loss: 0.60944 | train_auc: 0.73388 | train_balanced_accuracy: 0.67167 | train_accuracy: 0.67174 | valid_auc: 0.71564 | valid_balanced_accuracy: 0.65277 | valid_accuracy: 0.65282 |  0:16:12s
epoch 59 | loss: 0.61542 | train_auc: 0.73457 | train_balanced_accuracy: 0.67319 | train_accuracy: 0.67363 | valid_auc: 0.71938 | valid_balanced_accuracy: 0.65978 | valid_accuracy: 0.66021 |  0:16:28s
epoch 60 | loss: 0.6159  | train_auc: 0.72622 | train_balanced_accuracy: 0.66753 | train_accuracy: 0.668   | valid_auc: 0.7149  | valid_balanced_accuracy: 0.65598 | valid_accuracy: 0.65644 |  0:16:45s
epoch 61 | loss: 0.61683 | train_auc: 0.72968 | train_balanced_accuracy: 0.67268 | train_accuracy: 0.67296 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.66169 | valid_accuracy: 0.66195 |  0:17:02s
epoch 62 | loss: 0.60767 | train_auc: 0.72977 | train_balanced_accuracy: 0.67009 | train_accuracy: 0.6706  | valid_auc: 0.71601 | valid_balanced_accuracy: 0.65374 | valid_accuracy: 0.65423 |  0:17:18s
epoch 63 | loss: 0.60912 | train_auc: 0.73641 | train_balanced_accuracy: 0.67424 | train_accuracy: 0.67473 | valid_auc: 0.71889 | valid_balanced_accuracy: 0.6583  | valid_accuracy: 0.6588  |  0:17:34s
epoch 64 | loss: 0.60787 | train_auc: 0.73619 | train_balanced_accuracy: 0.67425 | train_accuracy: 0.67465 | valid_auc: 0.71889 | valid_balanced_accuracy: 0.65635 | valid_accuracy: 0.65675 |  0:17:51s
epoch 65 | loss: 0.61521 | train_auc: 0.72881 | train_balanced_accuracy: 0.66877 | train_accuracy: 0.66907 | valid_auc: 0.71012 | valid_balanced_accuracy: 0.64842 | valid_accuracy: 0.64873 |  0:18:09s
epoch 66 | loss: 0.6082  | train_auc: 0.73379 | train_balanced_accuracy: 0.66993 | train_accuracy: 0.67037 | valid_auc: 0.71385 | valid_balanced_accuracy: 0.65494 | valid_accuracy: 0.65534 |  0:18:26s
epoch 67 | loss: 0.61131 | train_auc: 0.71852 | train_balanced_accuracy: 0.65881 | train_accuracy: 0.65927 | valid_auc: 0.71182 | valid_balanced_accuracy: 0.65043 | valid_accuracy: 0.65093 |  0:18:44s
epoch 68 | loss: 0.60956 | train_auc: 0.69909 | train_balanced_accuracy: 0.64828 | train_accuracy: 0.64857 | valid_auc: 0.69782 | valid_balanced_accuracy: 0.64793 | valid_accuracy: 0.64825 |  0:19:02s
epoch 69 | loss: 0.61108 | train_auc: 0.69841 | train_balanced_accuracy: 0.64036 | train_accuracy: 0.6409  | valid_auc: 0.69943 | valid_balanced_accuracy: 0.63998 | valid_accuracy: 0.64054 |  0:19:19s
epoch 70 | loss: 0.60829 | train_auc: 0.72553 | train_balanced_accuracy: 0.66611 | train_accuracy: 0.66643 | valid_auc: 0.71534 | valid_balanced_accuracy: 0.65392 | valid_accuracy: 0.65423 |  0:19:36s
epoch 71 | loss: 0.60825 | train_auc: 0.73727 | train_balanced_accuracy: 0.67378 | train_accuracy: 0.67414 | valid_auc: 0.71884 | valid_balanced_accuracy: 0.65764 | valid_accuracy: 0.65801 |  0:19:52s
epoch 72 | loss: 0.60611 | train_auc: 0.7358  | train_balanced_accuracy: 0.6717  | train_accuracy: 0.67206 | valid_auc: 0.71771 | valid_balanced_accuracy: 0.65292 | valid_accuracy: 0.65329 |  0:20:10s
epoch 73 | loss: 0.60587 | train_auc: 0.70612 | train_balanced_accuracy: 0.65251 | train_accuracy: 0.65278 | valid_auc: 0.70181 | valid_balanced_accuracy: 0.64878 | valid_accuracy: 0.64904 |  0:20:26s
epoch 74 | loss: 0.60666 | train_auc: 0.69601 | train_balanced_accuracy: 0.64182 | train_accuracy: 0.64231 | valid_auc: 0.69869 | valid_balanced_accuracy: 0.63878 | valid_accuracy: 0.63928 |  0:20:43s
epoch 75 | loss: 0.60384 | train_auc: 0.70914 | train_balanced_accuracy: 0.65087 | train_accuracy: 0.65136 | valid_auc: 0.70716 | valid_balanced_accuracy: 0.64729 | valid_accuracy: 0.64778 |  0:21:00s
epoch 76 | loss: 0.60655 | train_auc: 0.73364 | train_balanced_accuracy: 0.67449 | train_accuracy: 0.67489 | valid_auc: 0.72017 | valid_balanced_accuracy: 0.65904 | valid_accuracy: 0.65943 |  0:21:17s
epoch 77 | loss: 0.60558 | train_auc: 0.73275 | train_balanced_accuracy: 0.66979 | train_accuracy: 0.67017 | valid_auc: 0.71802 | valid_balanced_accuracy: 0.65686 | valid_accuracy: 0.65722 |  0:21:34s
epoch 78 | loss: 0.60295 | train_auc: 0.73886 | train_balanced_accuracy: 0.67689 | train_accuracy: 0.67717 | valid_auc: 0.72168 | valid_balanced_accuracy: 0.65789 | valid_accuracy: 0.65817 |  0:21:50s
epoch 79 | loss: 0.6066  | train_auc: 0.73686 | train_balanced_accuracy: 0.67253 | train_accuracy: 0.67284 | valid_auc: 0.71939 | valid_balanced_accuracy: 0.65614 | valid_accuracy: 0.65644 |  0:22:08s
epoch 80 | loss: 0.60809 | train_auc: 0.73625 | train_balanced_accuracy: 0.67144 | train_accuracy: 0.67198 | valid_auc: 0.71853 | valid_balanced_accuracy: 0.65563 | valid_accuracy: 0.65612 |  0:22:25s
epoch 81 | loss: 0.60229 | train_auc: 0.74175 | train_balanced_accuracy: 0.67677 | train_accuracy: 0.67717 | valid_auc: 0.7245  | valid_balanced_accuracy: 0.65827 | valid_accuracy: 0.65864 |  0:22:42s

Early stopping occurred at epoch 81 with best_epoch = 61 and best_valid_accuracy = 0.66195
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 57/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=sparsemax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=22.8min
[CV 1/5; 58/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68567 | train_auc: 0.62467 | train_balanced_accuracy: 0.60416 | train_accuracy: 0.60362 | valid_auc: 0.61877 | valid_balanced_accuracy: 0.59957 | valid_accuracy: 0.59899 |  0:00:16s
epoch 1  | loss: 0.63153 | train_auc: 0.64841 | train_balanced_accuracy: 0.60768 | train_accuracy: 0.60653 | valid_auc: 0.64714 | valid_balanced_accuracy: 0.6082  | valid_accuracy: 0.60702 |  0:00:32s
epoch 2  | loss: 0.6147  | train_auc: 0.68478 | train_balanced_accuracy: 0.61651 | train_accuracy: 0.61538 | valid_auc: 0.67722 | valid_balanced_accuracy: 0.61417 | valid_accuracy: 0.613   |  0:00:51s
epoch 3  | loss: 0.61137 | train_auc: 0.68238 | train_balanced_accuracy: 0.62157 | train_accuracy: 0.6205  | valid_auc: 0.67705 | valid_balanced_accuracy: 0.62023 | valid_accuracy: 0.61914 |  0:01:07s
epoch 4  | loss: 0.60147 | train_auc: 0.69087 | train_balanced_accuracy: 0.61972 | train_accuracy: 0.61873 | valid_auc: 0.68449 | valid_balanced_accuracy: 0.61558 | valid_accuracy: 0.61457 |  0:01:23s
epoch 5  | loss: 0.60113 | train_auc: 0.70207 | train_balanced_accuracy: 0.62971 | train_accuracy: 0.62892 | valid_auc: 0.6963  | valid_balanced_accuracy: 0.6261  | valid_accuracy: 0.62528 |  0:01:40s
epoch 6  | loss: 0.60199 | train_auc: 0.71203 | train_balanced_accuracy: 0.62919 | train_accuracy: 0.62813 | valid_auc: 0.70469 | valid_balanced_accuracy: 0.62357 | valid_accuracy: 0.62244 |  0:01:56s
epoch 7  | loss: 0.59758 | train_auc: 0.71209 | train_balanced_accuracy: 0.63766 | train_accuracy: 0.63703 | valid_auc: 0.70139 | valid_balanced_accuracy: 0.63224 | valid_accuracy: 0.63157 |  0:02:14s
epoch 8  | loss: 0.58935 | train_auc: 0.70665 | train_balanced_accuracy: 0.6408  | train_accuracy: 0.64065 | valid_auc: 0.70105 | valid_balanced_accuracy: 0.64072 | valid_accuracy: 0.64054 |  0:02:33s
epoch 9  | loss: 0.59294 | train_auc: 0.72533 | train_balanced_accuracy: 0.66258 | train_accuracy: 0.6624  | valid_auc: 0.71499 | valid_balanced_accuracy: 0.65791 | valid_accuracy: 0.6577  |  0:02:50s
epoch 10 | loss: 0.58624 | train_auc: 0.72091 | train_balanced_accuracy: 0.65972 | train_accuracy: 0.65957 | valid_auc: 0.71303 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65046 |  0:03:08s
epoch 11 | loss: 0.58824 | train_auc: 0.72611 | train_balanced_accuracy: 0.66504 | train_accuracy: 0.66567 | valid_auc: 0.71752 | valid_balanced_accuracy: 0.65201 | valid_accuracy: 0.65266 |  0:03:23s
epoch 12 | loss: 0.58637 | train_auc: 0.73441 | train_balanced_accuracy: 0.67097 | train_accuracy: 0.6713  | valid_auc: 0.72039 | valid_balanced_accuracy: 0.65943 | valid_accuracy: 0.65974 |  0:03:39s
epoch 13 | loss: 0.58462 | train_auc: 0.7373  | train_balanced_accuracy: 0.67115 | train_accuracy: 0.67165 | valid_auc: 0.72436 | valid_balanced_accuracy: 0.66287 | valid_accuracy: 0.66336 |  0:03:56s
epoch 14 | loss: 0.58375 | train_auc: 0.73982 | train_balanced_accuracy: 0.67442 | train_accuracy: 0.67488 | valid_auc: 0.72705 | valid_balanced_accuracy: 0.66245 | valid_accuracy: 0.66289 |  0:04:12s
epoch 15 | loss: 0.58188 | train_auc: 0.74163 | train_balanced_accuracy: 0.67576 | train_accuracy: 0.67586 | valid_auc: 0.72885 | valid_balanced_accuracy: 0.66328 | valid_accuracy: 0.66336 |  0:04:29s
epoch 16 | loss: 0.57797 | train_auc: 0.74467 | train_balanced_accuracy: 0.6785  | train_accuracy: 0.67858 | valid_auc: 0.73006 | valid_balanced_accuracy: 0.66538 | valid_accuracy: 0.66541 |  0:04:48s
epoch 17 | loss: 0.57472 | train_auc: 0.7446  | train_balanced_accuracy: 0.67838 | train_accuracy: 0.67877 | valid_auc: 0.73082 | valid_balanced_accuracy: 0.65951 | valid_accuracy: 0.6599  |  0:05:06s
epoch 18 | loss: 0.57465 | train_auc: 0.75025 | train_balanced_accuracy: 0.68441 | train_accuracy: 0.68507 | valid_auc: 0.734   | valid_balanced_accuracy: 0.66884 | valid_accuracy: 0.6695  |  0:05:23s
epoch 19 | loss: 0.57862 | train_auc: 0.75765 | train_balanced_accuracy: 0.68975 | train_accuracy: 0.69014 | valid_auc: 0.74046 | valid_balanced_accuracy: 0.67198 | valid_accuracy: 0.67233 |  0:05:40s
epoch 20 | loss: 0.57397 | train_auc: 0.75166 | train_balanced_accuracy: 0.68443 | train_accuracy: 0.68436 | valid_auc: 0.73388 | valid_balanced_accuracy: 0.6702  | valid_accuracy: 0.67013 |  0:05:57s
epoch 21 | loss: 0.57301 | train_auc: 0.76062 | train_balanced_accuracy: 0.68828 | train_accuracy: 0.68881 | valid_auc: 0.74176 | valid_balanced_accuracy: 0.67225 | valid_accuracy: 0.6728  |  0:06:13s
epoch 22 | loss: 0.579   | train_auc: 0.76051 | train_balanced_accuracy: 0.68794 | train_accuracy: 0.68845 | valid_auc: 0.74372 | valid_balanced_accuracy: 0.6775  | valid_accuracy: 0.678   |  0:06:31s
epoch 23 | loss: 0.57174 | train_auc: 0.77028 | train_balanced_accuracy: 0.69795 | train_accuracy: 0.69856 | valid_auc: 0.75087 | valid_balanced_accuracy: 0.68685 | valid_accuracy: 0.68744 |  0:06:49s
epoch 24 | loss: 0.57419 | train_auc: 0.7578  | train_balanced_accuracy: 0.68838 | train_accuracy: 0.68877 | valid_auc: 0.7402  | valid_balanced_accuracy: 0.67482 | valid_accuracy: 0.67517 |  0:07:07s
epoch 25 | loss: 0.56859 | train_auc: 0.76288 | train_balanced_accuracy: 0.69318 | train_accuracy: 0.69313 | valid_auc: 0.74359 | valid_balanced_accuracy: 0.6798  | valid_accuracy: 0.67973 |  0:07:25s
epoch 26 | loss: 0.57426 | train_auc: 0.76929 | train_balanced_accuracy: 0.6972  | train_accuracy: 0.6977  | valid_auc: 0.74601 | valid_balanced_accuracy: 0.68192 | valid_accuracy: 0.6824  |  0:07:43s
epoch 27 | loss: 0.57148 | train_auc: 0.77058 | train_balanced_accuracy: 0.70186 | train_accuracy: 0.70207 | valid_auc: 0.74473 | valid_balanced_accuracy: 0.68394 | valid_accuracy: 0.68414 |  0:08:00s
epoch 28 | loss: 0.5706  | train_auc: 0.77352 | train_balanced_accuracy: 0.69895 | train_accuracy: 0.69915 | valid_auc: 0.7464  | valid_balanced_accuracy: 0.68207 | valid_accuracy: 0.68225 |  0:08:17s
epoch 29 | loss: 0.56354 | train_auc: 0.77887 | train_balanced_accuracy: 0.70727 | train_accuracy: 0.70753 | valid_auc: 0.75685 | valid_balanced_accuracy: 0.693   | valid_accuracy: 0.69326 |  0:08:35s
epoch 30 | loss: 0.56471 | train_auc: 0.7707  | train_balanced_accuracy: 0.70335 | train_accuracy: 0.70364 | valid_auc: 0.74704 | valid_balanced_accuracy: 0.6837  | valid_accuracy: 0.68398 |  0:08:52s
epoch 31 | loss: 0.56912 | train_auc: 0.76068 | train_balanced_accuracy: 0.69125 | train_accuracy: 0.69168 | valid_auc: 0.74376 | valid_balanced_accuracy: 0.67861 | valid_accuracy: 0.6791  |  0:09:09s
epoch 32 | loss: 0.56416 | train_auc: 0.77327 | train_balanced_accuracy: 0.70061 | train_accuracy: 0.70096 | valid_auc: 0.74961 | valid_balanced_accuracy: 0.68773 | valid_accuracy: 0.68807 |  0:09:25s
epoch 33 | loss: 0.56575 | train_auc: 0.76885 | train_balanced_accuracy: 0.69298 | train_accuracy: 0.6938  | valid_auc: 0.74651 | valid_balanced_accuracy: 0.67997 | valid_accuracy: 0.68083 |  0:09:43s
epoch 34 | loss: 0.55783 | train_auc: 0.76821 | train_balanced_accuracy: 0.69822 | train_accuracy: 0.69849 | valid_auc: 0.74621 | valid_balanced_accuracy: 0.68163 | valid_accuracy: 0.68193 |  0:10:00s
epoch 35 | loss: 0.56418 | train_auc: 0.77371 | train_balanced_accuracy: 0.70631 | train_accuracy: 0.70683 | valid_auc: 0.75181 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68949 |  0:10:17s
epoch 36 | loss: 0.56241 | train_auc: 0.78212 | train_balanced_accuracy: 0.70951 | train_accuracy: 0.70966 | valid_auc: 0.75262 | valid_balanced_accuracy: 0.6862  | valid_accuracy: 0.68634 |  0:10:35s
epoch 37 | loss: 0.55882 | train_auc: 0.78488 | train_balanced_accuracy: 0.71288 | train_accuracy: 0.71324 | valid_auc: 0.75389 | valid_balanced_accuracy: 0.6929  | valid_accuracy: 0.69326 |  0:10:52s
epoch 38 | loss: 0.55578 | train_auc: 0.78435 | train_balanced_accuracy: 0.70836 | train_accuracy: 0.7082  | valid_auc: 0.75359 | valid_balanced_accuracy: 0.68471 | valid_accuracy: 0.68461 |  0:11:10s
epoch 39 | loss: 0.55869 | train_auc: 0.79064 | train_balanced_accuracy: 0.7172  | train_accuracy: 0.71737 | valid_auc: 0.75103 | valid_balanced_accuracy: 0.68884 | valid_accuracy: 0.68901 |  0:11:27s
epoch 40 | loss: 0.55677 | train_auc: 0.79179 | train_balanced_accuracy: 0.71759 | train_accuracy: 0.71773 | valid_auc: 0.75355 | valid_balanced_accuracy: 0.68623 | valid_accuracy: 0.68634 |  0:11:44s
epoch 41 | loss: 0.55298 | train_auc: 0.79397 | train_balanced_accuracy: 0.71835 | train_accuracy: 0.71859 | valid_auc: 0.75269 | valid_balanced_accuracy: 0.68844 | valid_accuracy: 0.6887  |  0:12:01s
epoch 42 | loss: 0.55152 | train_auc: 0.79461 | train_balanced_accuracy: 0.71626 | train_accuracy: 0.71658 | valid_auc: 0.7549  | valid_balanced_accuracy: 0.68785 | valid_accuracy: 0.68823 |  0:12:18s
epoch 43 | loss: 0.55623 | train_auc: 0.7962  | train_balanced_accuracy: 0.72117 | train_accuracy: 0.72127 | valid_auc: 0.76011 | valid_balanced_accuracy: 0.69523 | valid_accuracy: 0.69531 |  0:12:36s
epoch 44 | loss: 0.55172 | train_auc: 0.79972 | train_balanced_accuracy: 0.72298 | train_accuracy: 0.72323 | valid_auc: 0.76085 | valid_balanced_accuracy: 0.69976 | valid_accuracy: 0.70003 |  0:12:54s
epoch 45 | loss: 0.55004 | train_auc: 0.79243 | train_balanced_accuracy: 0.71368 | train_accuracy: 0.71415 | valid_auc: 0.75128 | valid_balanced_accuracy: 0.68823 | valid_accuracy: 0.6887  |  0:13:12s
epoch 46 | loss: 0.54899 | train_auc: 0.79896 | train_balanced_accuracy: 0.7238  | train_accuracy: 0.72386 | valid_auc: 0.75481 | valid_balanced_accuracy: 0.69037 | valid_accuracy: 0.69043 |  0:13:30s
epoch 47 | loss: 0.54942 | train_auc: 0.79347 | train_balanced_accuracy: 0.71459 | train_accuracy: 0.71513 | valid_auc: 0.7485  | valid_balanced_accuracy: 0.67935 | valid_accuracy: 0.67989 |  0:13:47s
epoch 48 | loss: 0.54749 | train_auc: 0.8001  | train_balanced_accuracy: 0.72186 | train_accuracy: 0.7219  | valid_auc: 0.75789 | valid_balanced_accuracy: 0.68864 | valid_accuracy: 0.6887  |  0:14:03s
epoch 49 | loss: 0.54519 | train_auc: 0.79784 | train_balanced_accuracy: 0.72094 | train_accuracy: 0.72111 | valid_auc: 0.75468 | valid_balanced_accuracy: 0.69151 | valid_accuracy: 0.69169 |  0:14:22s
epoch 50 | loss: 0.5449  | train_auc: 0.79989 | train_balanced_accuracy: 0.72097 | train_accuracy: 0.72087 | valid_auc: 0.75709 | valid_balanced_accuracy: 0.68797 | valid_accuracy: 0.68791 |  0:14:40s
epoch 51 | loss: 0.54598 | train_auc: 0.80258 | train_balanced_accuracy: 0.72135 | train_accuracy: 0.72178 | valid_auc: 0.76095 | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69075 |  0:14:58s
epoch 52 | loss: 0.54236 | train_auc: 0.8062  | train_balanced_accuracy: 0.72691 | train_accuracy: 0.72693 | valid_auc: 0.76696 | valid_balanced_accuracy: 0.69935 | valid_accuracy: 0.6994  |  0:15:16s
epoch 53 | loss: 0.54366 | train_auc: 0.7989  | train_balanced_accuracy: 0.71914 | train_accuracy: 0.71946 | valid_auc: 0.75845 | valid_balanced_accuracy: 0.69262 | valid_accuracy: 0.69295 |  0:15:32s
epoch 54 | loss: 0.54304 | train_auc: 0.80531 | train_balanced_accuracy: 0.72615 | train_accuracy: 0.72642 | valid_auc: 0.76263 | valid_balanced_accuracy: 0.69331 | valid_accuracy: 0.69358 |  0:15:50s
epoch 55 | loss: 0.54492 | train_auc: 0.80109 | train_balanced_accuracy: 0.72022 | train_accuracy: 0.7206  | valid_auc: 0.75405 | valid_balanced_accuracy: 0.68957 | valid_accuracy: 0.68996 |  0:16:08s
epoch 56 | loss: 0.5433  | train_auc: 0.80736 | train_balanced_accuracy: 0.72652 | train_accuracy: 0.72678 | valid_auc: 0.75974 | valid_balanced_accuracy: 0.69271 | valid_accuracy: 0.69295 |  0:16:26s
epoch 57 | loss: 0.54225 | train_auc: 0.80584 | train_balanced_accuracy: 0.72698 | train_accuracy: 0.72705 | valid_auc: 0.75663 | valid_balanced_accuracy: 0.68629 | valid_accuracy: 0.68634 |  0:16:43s
epoch 58 | loss: 0.54301 | train_auc: 0.80603 | train_balanced_accuracy: 0.72448 | train_accuracy: 0.72485 | valid_auc: 0.76059 | valid_balanced_accuracy: 0.69574 | valid_accuracy: 0.6961  |  0:17:00s
epoch 59 | loss: 0.53958 | train_auc: 0.8075  | train_balanced_accuracy: 0.72535 | train_accuracy: 0.72567 | valid_auc: 0.76251 | valid_balanced_accuracy: 0.69213 | valid_accuracy: 0.69248 |  0:17:17s
epoch 60 | loss: 0.53993 | train_auc: 0.8091  | train_balanced_accuracy: 0.72969 | train_accuracy: 0.72984 | valid_auc: 0.76086 | valid_balanced_accuracy: 0.69293 | valid_accuracy: 0.69311 |  0:17:34s
epoch 61 | loss: 0.53743 | train_auc: 0.81096 | train_balanced_accuracy: 0.73099 | train_accuracy: 0.7313  | valid_auc: 0.76121 | valid_balanced_accuracy: 0.68981 | valid_accuracy: 0.69012 |  0:17:52s
epoch 62 | loss: 0.53492 | train_auc: 0.81043 | train_balanced_accuracy: 0.72704 | train_accuracy: 0.72693 | valid_auc: 0.76492 | valid_balanced_accuracy: 0.69086 | valid_accuracy: 0.69075 |  0:18:08s
epoch 63 | loss: 0.53608 | train_auc: 0.8098  | train_balanced_accuracy: 0.73181 | train_accuracy: 0.73201 | valid_auc: 0.75932 | valid_balanced_accuracy: 0.69337 | valid_accuracy: 0.69358 |  0:18:26s
epoch 64 | loss: 0.53766 | train_auc: 0.81307 | train_balanced_accuracy: 0.72832 | train_accuracy: 0.72811 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.68493 | valid_accuracy: 0.68477 |  0:18:43s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.70003
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 58/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.703 total time=18.9min
[CV 2/5; 58/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6972  | train_auc: 0.62238 | train_balanced_accuracy: 0.56947 | train_accuracy: 0.56734 | valid_auc: 0.61246 | valid_balanced_accuracy: 0.55807 | valid_accuracy: 0.55587 |  0:00:18s
epoch 1  | loss: 0.63972 | train_auc: 0.65667 | train_balanced_accuracy: 0.59898 | train_accuracy: 0.59768 | valid_auc: 0.65304 | valid_balanced_accuracy: 0.59263 | valid_accuracy: 0.59128 |  0:00:36s
epoch 2  | loss: 0.62886 | train_auc: 0.67663 | train_balanced_accuracy: 0.61183 | train_accuracy: 0.61334 | valid_auc: 0.67359 | valid_balanced_accuracy: 0.60579 | valid_accuracy: 0.60733 |  0:00:53s
epoch 3  | loss: 0.61948 | train_auc: 0.69021 | train_balanced_accuracy: 0.64794 | train_accuracy: 0.64879 | valid_auc: 0.68887 | valid_balanced_accuracy: 0.64632 | valid_accuracy: 0.64715 |  0:01:10s
epoch 4  | loss: 0.60633 | train_auc: 0.69903 | train_balanced_accuracy: 0.63693 | train_accuracy: 0.63813 | valid_auc: 0.69737 | valid_balanced_accuracy: 0.64391 | valid_accuracy: 0.64511 |  0:01:28s
epoch 5  | loss: 0.6042  | train_auc: 0.69992 | train_balanced_accuracy: 0.63308 | train_accuracy: 0.63427 | valid_auc: 0.69831 | valid_balanced_accuracy: 0.63665 | valid_accuracy: 0.63787 |  0:01:45s
epoch 6  | loss: 0.60425 | train_auc: 0.70423 | train_balanced_accuracy: 0.63252 | train_accuracy: 0.63364 | valid_auc: 0.69889 | valid_balanced_accuracy: 0.62717 | valid_accuracy: 0.62827 |  0:02:03s
epoch 7  | loss: 0.60424 | train_auc: 0.69926 | train_balanced_accuracy: 0.62342 | train_accuracy: 0.62459 | valid_auc: 0.69298 | valid_balanced_accuracy: 0.61876 | valid_accuracy: 0.61992 |  0:02:22s
epoch 8  | loss: 0.59447 | train_auc: 0.70252 | train_balanced_accuracy: 0.61864 | train_accuracy: 0.61983 | valid_auc: 0.69373 | valid_balanced_accuracy: 0.61321 | valid_accuracy: 0.61442 |  0:02:38s
epoch 9  | loss: 0.60037 | train_auc: 0.70115 | train_balanced_accuracy: 0.63986 | train_accuracy: 0.64068 | valid_auc: 0.69642 | valid_balanced_accuracy: 0.63752 | valid_accuracy: 0.63834 |  0:02:56s
epoch 10 | loss: 0.5917  | train_auc: 0.71483 | train_balanced_accuracy: 0.66485 | train_accuracy: 0.66536 | valid_auc: 0.70971 | valid_balanced_accuracy: 0.66464 | valid_accuracy: 0.66509 |  0:03:14s
epoch 11 | loss: 0.59415 | train_auc: 0.71453 | train_balanced_accuracy: 0.66427 | train_accuracy: 0.66484 | valid_auc: 0.71055 | valid_balanced_accuracy: 0.6625  | valid_accuracy: 0.66305 |  0:03:30s
epoch 12 | loss: 0.59173 | train_auc: 0.72373 | train_balanced_accuracy: 0.6621  | train_accuracy: 0.66276 | valid_auc: 0.72135 | valid_balanced_accuracy: 0.66317 | valid_accuracy: 0.66383 |  0:03:47s
epoch 13 | loss: 0.58852 | train_auc: 0.72489 | train_balanced_accuracy: 0.66751 | train_accuracy: 0.66799 | valid_auc: 0.71984 | valid_balanced_accuracy: 0.66559 | valid_accuracy: 0.66604 |  0:04:04s
epoch 14 | loss: 0.58895 | train_auc: 0.73633 | train_balanced_accuracy: 0.66704 | train_accuracy: 0.66791 | valid_auc: 0.73223 | valid_balanced_accuracy: 0.67001 | valid_accuracy: 0.67092 |  0:04:23s
epoch 15 | loss: 0.58656 | train_auc: 0.74079 | train_balanced_accuracy: 0.67295 | train_accuracy: 0.67299 | valid_auc: 0.73657 | valid_balanced_accuracy: 0.67152 | valid_accuracy: 0.67155 |  0:04:40s
epoch 16 | loss: 0.58676 | train_auc: 0.73985 | train_balanced_accuracy: 0.67433 | train_accuracy: 0.67437 | valid_auc: 0.73339 | valid_balanced_accuracy: 0.67202 | valid_accuracy: 0.67202 |  0:04:58s
epoch 17 | loss: 0.58057 | train_auc: 0.74447 | train_balanced_accuracy: 0.67773 | train_accuracy: 0.67763 | valid_auc: 0.74035 | valid_balanced_accuracy: 0.67528 | valid_accuracy: 0.67517 |  0:05:17s
epoch 18 | loss: 0.58172 | train_auc: 0.75208 | train_balanced_accuracy: 0.68326 | train_accuracy: 0.68365 | valid_auc: 0.74268 | valid_balanced_accuracy: 0.6774  | valid_accuracy: 0.67784 |  0:05:32s
epoch 19 | loss: 0.58297 | train_auc: 0.75538 | train_balanced_accuracy: 0.68725 | train_accuracy: 0.68751 | valid_auc: 0.74499 | valid_balanced_accuracy: 0.68104 | valid_accuracy: 0.6813  |  0:05:50s
epoch 20 | loss: 0.57916 | train_auc: 0.75625 | train_balanced_accuracy: 0.68873 | train_accuracy: 0.68892 | valid_auc: 0.74347 | valid_balanced_accuracy: 0.68427 | valid_accuracy: 0.68445 |  0:06:07s
epoch 21 | loss: 0.57796 | train_auc: 0.75069 | train_balanced_accuracy: 0.68118 | train_accuracy: 0.68164 | valid_auc: 0.74016 | valid_balanced_accuracy: 0.67642 | valid_accuracy: 0.6769  |  0:06:25s
epoch 22 | loss: 0.58607 | train_auc: 0.76724 | train_balanced_accuracy: 0.70088 | train_accuracy: 0.70104 | valid_auc: 0.75303 | valid_balanced_accuracy: 0.68947 | valid_accuracy: 0.68964 |  0:06:41s
epoch 23 | loss: 0.57763 | train_auc: 0.77151 | train_balanced_accuracy: 0.69865 | train_accuracy: 0.69904 | valid_auc: 0.75409 | valid_balanced_accuracy: 0.68627 | valid_accuracy: 0.68665 |  0:06:59s
epoch 24 | loss: 0.57882 | train_auc: 0.76854 | train_balanced_accuracy: 0.69995 | train_accuracy: 0.70026 | valid_auc: 0.74867 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.68886 |  0:07:18s
epoch 25 | loss: 0.57204 | train_auc: 0.76416 | train_balanced_accuracy: 0.69457 | train_accuracy: 0.69463 | valid_auc: 0.74773 | valid_balanced_accuracy: 0.68168 | valid_accuracy: 0.68178 |  0:07:37s
epoch 26 | loss: 0.57545 | train_auc: 0.7694  | train_balanced_accuracy: 0.69672 | train_accuracy: 0.69727 | valid_auc: 0.75165 | valid_balanced_accuracy: 0.68501 | valid_accuracy: 0.68555 |  0:07:56s
epoch 27 | loss: 0.57076 | train_auc: 0.7739  | train_balanced_accuracy: 0.70283 | train_accuracy: 0.70266 | valid_auc: 0.75579 | valid_balanced_accuracy: 0.68633 | valid_accuracy: 0.68618 |  0:08:15s
epoch 28 | loss: 0.56629 | train_auc: 0.7709  | train_balanced_accuracy: 0.69872 | train_accuracy: 0.69911 | valid_auc: 0.7558  | valid_balanced_accuracy: 0.69081 | valid_accuracy: 0.69122 |  0:08:31s
epoch 29 | loss: 0.56981 | train_auc: 0.76777 | train_balanced_accuracy: 0.69879 | train_accuracy: 0.6986  | valid_auc: 0.74702 | valid_balanced_accuracy: 0.6865  | valid_accuracy: 0.68634 |  0:08:48s
epoch 30 | loss: 0.56638 | train_auc: 0.76766 | train_balanced_accuracy: 0.69635 | train_accuracy: 0.69671 | valid_auc: 0.74714 | valid_balanced_accuracy: 0.68612 | valid_accuracy: 0.6865  |  0:09:05s
epoch 31 | loss: 0.56521 | train_auc: 0.78558 | train_balanced_accuracy: 0.70689 | train_accuracy: 0.7073  | valid_auc: 0.75751 | valid_balanced_accuracy: 0.6864  | valid_accuracy: 0.68681 |  0:09:24s
epoch 32 | loss: 0.56481 | train_auc: 0.78399 | train_balanced_accuracy: 0.70999 | train_accuracy: 0.71033 | valid_auc: 0.75764 | valid_balanced_accuracy: 0.69041 | valid_accuracy: 0.69075 |  0:09:41s
epoch 33 | loss: 0.56538 | train_auc: 0.77865 | train_balanced_accuracy: 0.70594 | train_accuracy: 0.70612 | valid_auc: 0.75356 | valid_balanced_accuracy: 0.69065 | valid_accuracy: 0.6909  |  0:09:58s
epoch 34 | loss: 0.56355 | train_auc: 0.78013 | train_balanced_accuracy: 0.70923 | train_accuracy: 0.70958 | valid_auc: 0.7571  | valid_balanced_accuracy: 0.69432 | valid_accuracy: 0.69468 |  0:10:16s
epoch 35 | loss: 0.56055 | train_auc: 0.77999 | train_balanced_accuracy: 0.70367 | train_accuracy: 0.70419 | valid_auc: 0.75745 | valid_balanced_accuracy: 0.69164 | valid_accuracy: 0.69216 |  0:10:32s
epoch 36 | loss: 0.55928 | train_auc: 0.78983 | train_balanced_accuracy: 0.71487 | train_accuracy: 0.71513 | valid_auc: 0.76277 | valid_balanced_accuracy: 0.69097 | valid_accuracy: 0.69122 |  0:10:50s
epoch 37 | loss: 0.56109 | train_auc: 0.78865 | train_balanced_accuracy: 0.71245 | train_accuracy: 0.71289 | valid_auc: 0.75731 | valid_balanced_accuracy: 0.68981 | valid_accuracy: 0.69027 |  0:11:08s
epoch 38 | loss: 0.55565 | train_auc: 0.78175 | train_balanced_accuracy: 0.7038  | train_accuracy: 0.70352 | valid_auc: 0.74964 | valid_balanced_accuracy: 0.67907 | valid_accuracy: 0.67879 |  0:11:26s
epoch 39 | loss: 0.56061 | train_auc: 0.78821 | train_balanced_accuracy: 0.71013 | train_accuracy: 0.70997 | valid_auc: 0.75622 | valid_balanced_accuracy: 0.68981 | valid_accuracy: 0.68964 |  0:11:44s
epoch 40 | loss: 0.55874 | train_auc: 0.79284 | train_balanced_accuracy: 0.71887 | train_accuracy: 0.71895 | valid_auc: 0.76177 | valid_balanced_accuracy: 0.6962  | valid_accuracy: 0.69625 |  0:12:00s
epoch 41 | loss: 0.55581 | train_auc: 0.7947  | train_balanced_accuracy: 0.71955 | train_accuracy: 0.71981 | valid_auc: 0.76357 | valid_balanced_accuracy: 0.69739 | valid_accuracy: 0.69767 |  0:12:17s
epoch 42 | loss: 0.55036 | train_auc: 0.78934 | train_balanced_accuracy: 0.71424 | train_accuracy: 0.71446 | valid_auc: 0.75976 | valid_balanced_accuracy: 0.68975 | valid_accuracy: 0.68996 |  0:12:33s
epoch 43 | loss: 0.56147 | train_auc: 0.79512 | train_balanced_accuracy: 0.71481 | train_accuracy: 0.7147  | valid_auc: 0.76322 | valid_balanced_accuracy: 0.69041 | valid_accuracy: 0.69027 |  0:12:51s
epoch 44 | loss: 0.55121 | train_auc: 0.79459 | train_balanced_accuracy: 0.72025 | train_accuracy: 0.72052 | valid_auc: 0.76028 | valid_balanced_accuracy: 0.69598 | valid_accuracy: 0.69625 |  0:13:08s
epoch 45 | loss: 0.54878 | train_auc: 0.79373 | train_balanced_accuracy: 0.71599 | train_accuracy: 0.71651 | valid_auc: 0.75672 | valid_balanced_accuracy: 0.69318 | valid_accuracy: 0.69374 |  0:13:25s
epoch 46 | loss: 0.54974 | train_auc: 0.79447 | train_balanced_accuracy: 0.71687 | train_accuracy: 0.71698 | valid_auc: 0.76095 | valid_balanced_accuracy: 0.69472 | valid_accuracy: 0.69484 |  0:13:41s
epoch 47 | loss: 0.54869 | train_auc: 0.78528 | train_balanced_accuracy: 0.70684 | train_accuracy: 0.70734 | valid_auc: 0.75214 | valid_balanced_accuracy: 0.68773 | valid_accuracy: 0.68823 |  0:13:59s
epoch 48 | loss: 0.54496 | train_auc: 0.79118 | train_balanced_accuracy: 0.71916 | train_accuracy: 0.71926 | valid_auc: 0.75903 | valid_balanced_accuracy: 0.69586 | valid_accuracy: 0.69594 |  0:14:17s
epoch 49 | loss: 0.54605 | train_auc: 0.79528 | train_balanced_accuracy: 0.72004 | train_accuracy: 0.72013 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69284 | valid_accuracy: 0.69295 |  0:14:33s
epoch 50 | loss: 0.54655 | train_auc: 0.78721 | train_balanced_accuracy: 0.7081  | train_accuracy: 0.70793 | valid_auc: 0.75427 | valid_balanced_accuracy: 0.6854  | valid_accuracy: 0.68524 |  0:14:50s
epoch 51 | loss: 0.54762 | train_auc: 0.7983  | train_balanced_accuracy: 0.71979 | train_accuracy: 0.71993 | valid_auc: 0.75947 | valid_balanced_accuracy: 0.68758 | valid_accuracy: 0.68776 |  0:15:08s
epoch 52 | loss: 0.54387 | train_auc: 0.80025 | train_balanced_accuracy: 0.72286 | train_accuracy: 0.72288 | valid_auc: 0.76412 | valid_balanced_accuracy: 0.69624 | valid_accuracy: 0.69625 |  0:15:25s
epoch 53 | loss: 0.54436 | train_auc: 0.80107 | train_balanced_accuracy: 0.72237 | train_accuracy: 0.72268 | valid_auc: 0.76445 | valid_balanced_accuracy: 0.69957 | valid_accuracy: 0.69987 |  0:15:42s
epoch 54 | loss: 0.54726 | train_auc: 0.807   | train_balanced_accuracy: 0.72956 | train_accuracy: 0.72957 | valid_auc: 0.76579 | valid_balanced_accuracy: 0.69926 | valid_accuracy: 0.69924 |  0:16:00s
epoch 55 | loss: 0.54429 | train_auc: 0.80014 | train_balanced_accuracy: 0.72173 | train_accuracy: 0.72217 | valid_auc: 0.76294 | valid_balanced_accuracy: 0.70163 | valid_accuracy: 0.70208 |  0:16:17s
epoch 56 | loss: 0.54078 | train_auc: 0.78237 | train_balanced_accuracy: 0.70885 | train_accuracy: 0.70919 | valid_auc: 0.75361 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.68886 |  0:16:34s
epoch 57 | loss: 0.54062 | train_auc: 0.80184 | train_balanced_accuracy: 0.72143 | train_accuracy: 0.72154 | valid_auc: 0.76186 | valid_balanced_accuracy: 0.69505 | valid_accuracy: 0.69515 |  0:16:52s
epoch 58 | loss: 0.53991 | train_auc: 0.80342 | train_balanced_accuracy: 0.72543 | train_accuracy: 0.72571 | valid_auc: 0.76158 | valid_balanced_accuracy: 0.68761 | valid_accuracy: 0.68791 |  0:17:09s
epoch 59 | loss: 0.53915 | train_auc: 0.80266 | train_balanced_accuracy: 0.72553 | train_accuracy: 0.7256  | valid_auc: 0.7568  | valid_balanced_accuracy: 0.69271 | valid_accuracy: 0.69279 |  0:17:26s
epoch 60 | loss: 0.5438  | train_auc: 0.80212 | train_balanced_accuracy: 0.72368 | train_accuracy: 0.72382 | valid_auc: 0.76048 | valid_balanced_accuracy: 0.69348 | valid_accuracy: 0.69358 |  0:17:44s
epoch 61 | loss: 0.53878 | train_auc: 0.79595 | train_balanced_accuracy: 0.71959 | train_accuracy: 0.71993 | valid_auc: 0.75862 | valid_balanced_accuracy: 0.69403 | valid_accuracy: 0.69437 |  0:18:01s
epoch 62 | loss: 0.53648 | train_auc: 0.77104 | train_balanced_accuracy: 0.70203 | train_accuracy: 0.70211 | valid_auc: 0.74411 | valid_balanced_accuracy: 0.68676 | valid_accuracy: 0.68681 |  0:18:19s
epoch 63 | loss: 0.54244 | train_auc: 0.77987 | train_balanced_accuracy: 0.7059  | train_accuracy: 0.70604 | valid_auc: 0.74997 | valid_balanced_accuracy: 0.68417 | valid_accuracy: 0.68429 |  0:18:36s
epoch 64 | loss: 0.53604 | train_auc: 0.79557 | train_balanced_accuracy: 0.71708 | train_accuracy: 0.71698 | valid_auc: 0.75273 | valid_balanced_accuracy: 0.68094 | valid_accuracy: 0.68083 |  0:18:54s
epoch 65 | loss: 0.53795 | train_auc: 0.79522 | train_balanced_accuracy: 0.71897 | train_accuracy: 0.7191  | valid_auc: 0.75435 | valid_balanced_accuracy: 0.68004 | valid_accuracy: 0.6802  |  0:19:11s
epoch 66 | loss: 0.53766 | train_auc: 0.79611 | train_balanced_accuracy: 0.71817 | train_accuracy: 0.71816 | valid_auc: 0.75176 | valid_balanced_accuracy: 0.68711 | valid_accuracy: 0.68713 |  0:19:27s
epoch 67 | loss: 0.53434 | train_auc: 0.80404 | train_balanced_accuracy: 0.72523 | train_accuracy: 0.72536 | valid_auc: 0.76158 | valid_balanced_accuracy: 0.69075 | valid_accuracy: 0.6909  |  0:19:45s
epoch 68 | loss: 0.54216 | train_auc: 0.80885 | train_balanced_accuracy: 0.72808 | train_accuracy: 0.72819 | valid_auc: 0.76205 | valid_balanced_accuracy: 0.69394 | valid_accuracy: 0.69405 |  0:20:02s
epoch 69 | loss: 0.53696 | train_auc: 0.81299 | train_balanced_accuracy: 0.73289 | train_accuracy: 0.73303 | valid_auc: 0.76636 | valid_balanced_accuracy: 0.69876 | valid_accuracy: 0.69893 |  0:20:19s
epoch 70 | loss: 0.53632 | train_auc: 0.81655 | train_balanced_accuracy: 0.73412 | train_accuracy: 0.73445 | valid_auc: 0.76958 | valid_balanced_accuracy: 0.70019 | valid_accuracy: 0.7005  |  0:20:37s
epoch 71 | loss: 0.53674 | train_auc: 0.81536 | train_balanced_accuracy: 0.7324  | train_accuracy: 0.73236 | valid_auc: 0.76173 | valid_balanced_accuracy: 0.69108 | valid_accuracy: 0.69106 |  0:20:54s
epoch 72 | loss: 0.53264 | train_auc: 0.81622 | train_balanced_accuracy: 0.73369 | train_accuracy: 0.73405 | valid_auc: 0.7664  | valid_balanced_accuracy: 0.69602 | valid_accuracy: 0.69641 |  0:21:13s
epoch 73 | loss: 0.53038 | train_auc: 0.81584 | train_balanced_accuracy: 0.73562 | train_accuracy: 0.73567 | valid_auc: 0.76236 | valid_balanced_accuracy: 0.6943  | valid_accuracy: 0.69437 |  0:21:30s
epoch 74 | loss: 0.53488 | train_auc: 0.81784 | train_balanced_accuracy: 0.7362  | train_accuracy: 0.73645 | valid_auc: 0.76438 | valid_balanced_accuracy: 0.69516 | valid_accuracy: 0.69547 |  0:21:48s
epoch 75 | loss: 0.53063 | train_auc: 0.81587 | train_balanced_accuracy: 0.73705 | train_accuracy: 0.73732 | valid_auc: 0.76739 | valid_balanced_accuracy: 0.6996  | valid_accuracy: 0.69987 |  0:22:06s

Early stopping occurred at epoch 75 with best_epoch = 55 and best_valid_accuracy = 0.70208
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 58/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.687 total time=22.2min
[CV 3/5; 58/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.69306 | train_auc: 0.61686 | train_balanced_accuracy: 0.54636 | train_accuracy: 0.54375 | valid_auc: 0.61657 | valid_balanced_accuracy: 0.54447 | valid_accuracy: 0.54186 |  0:00:16s
epoch 1  | loss: 0.63907 | train_auc: 0.66191 | train_balanced_accuracy: 0.53993 | train_accuracy: 0.53695 | valid_auc: 0.65456 | valid_balanced_accuracy: 0.53732 | valid_accuracy: 0.53431 |  0:00:34s
epoch 2  | loss: 0.62433 | train_auc: 0.67353 | train_balanced_accuracy: 0.54641 | train_accuracy: 0.54348 | valid_auc: 0.66602 | valid_balanced_accuracy: 0.54589 | valid_accuracy: 0.54297 |  0:00:52s
epoch 3  | loss: 0.61702 | train_auc: 0.68318 | train_balanced_accuracy: 0.55333 | train_accuracy: 0.55044 | valid_auc: 0.67454 | valid_balanced_accuracy: 0.54935 | valid_accuracy: 0.54643 |  0:01:08s
epoch 4  | loss: 0.60732 | train_auc: 0.69725 | train_balanced_accuracy: 0.58439 | train_accuracy: 0.58203 | valid_auc: 0.69224 | valid_balanced_accuracy: 0.57493 | valid_accuracy: 0.57255 |  0:01:26s
epoch 5  | loss: 0.60403 | train_auc: 0.69707 | train_balanced_accuracy: 0.61433 | train_accuracy: 0.61276 | valid_auc: 0.68941 | valid_balanced_accuracy: 0.60561 | valid_accuracy: 0.60403 |  0:01:43s
epoch 6  | loss: 0.60231 | train_auc: 0.71015 | train_balanced_accuracy: 0.63062 | train_accuracy: 0.62952 | valid_auc: 0.70319 | valid_balanced_accuracy: 0.62653 | valid_accuracy: 0.62543 |  0:02:01s
epoch 7  | loss: 0.6044  | train_auc: 0.70772 | train_balanced_accuracy: 0.63775 | train_accuracy: 0.63684 | valid_auc: 0.70228 | valid_balanced_accuracy: 0.63849 | valid_accuracy: 0.63755 |  0:02:20s
epoch 8  | loss: 0.59627 | train_auc: 0.71011 | train_balanced_accuracy: 0.65607 | train_accuracy: 0.65604 | valid_auc: 0.70176 | valid_balanced_accuracy: 0.65947 | valid_accuracy: 0.65943 |  0:02:37s
epoch 9  | loss: 0.59234 | train_auc: 0.71233 | train_balanced_accuracy: 0.65521 | train_accuracy: 0.6553  | valid_auc: 0.70613 | valid_balanced_accuracy: 0.65383 | valid_accuracy: 0.65392 |  0:02:54s
epoch 10 | loss: 0.58123 | train_auc: 0.73123 | train_balanced_accuracy: 0.66675 | train_accuracy: 0.66682 | valid_auc: 0.72511 | valid_balanced_accuracy: 0.66848 | valid_accuracy: 0.66856 |  0:03:12s
epoch 11 | loss: 0.58699 | train_auc: 0.73478 | train_balanced_accuracy: 0.67295 | train_accuracy: 0.67316 | valid_auc: 0.7256  | valid_balanced_accuracy: 0.67087 | valid_accuracy: 0.67107 |  0:03:28s
epoch 12 | loss: 0.58721 | train_auc: 0.7382  | train_balanced_accuracy: 0.67148 | train_accuracy: 0.6717  | valid_auc: 0.72443 | valid_balanced_accuracy: 0.6639  | valid_accuracy: 0.66415 |  0:03:44s
epoch 13 | loss: 0.58335 | train_auc: 0.73872 | train_balanced_accuracy: 0.67455 | train_accuracy: 0.67505 | valid_auc: 0.72503 | valid_balanced_accuracy: 0.66459 | valid_accuracy: 0.66509 |  0:03:58s
epoch 14 | loss: 0.5823  | train_auc: 0.74186 | train_balanced_accuracy: 0.67946 | train_accuracy: 0.67961 | valid_auc: 0.72773 | valid_balanced_accuracy: 0.67299 | valid_accuracy: 0.67312 |  0:04:15s
epoch 15 | loss: 0.58459 | train_auc: 0.74615 | train_balanced_accuracy: 0.68258 | train_accuracy: 0.68284 | valid_auc: 0.73264 | valid_balanced_accuracy: 0.67384 | valid_accuracy: 0.67406 |  0:04:33s
epoch 16 | loss: 0.57905 | train_auc: 0.74869 | train_balanced_accuracy: 0.68057 | train_accuracy: 0.68095 | valid_auc: 0.73075 | valid_balanced_accuracy: 0.66979 | valid_accuracy: 0.67013 |  0:04:50s
epoch 17 | loss: 0.57749 | train_auc: 0.7515  | train_balanced_accuracy: 0.6835  | train_accuracy: 0.68406 | valid_auc: 0.73339 | valid_balanced_accuracy: 0.67117 | valid_accuracy: 0.6717  |  0:05:10s
epoch 18 | loss: 0.58132 | train_auc: 0.75683 | train_balanced_accuracy: 0.68642 | train_accuracy: 0.68709 | valid_auc: 0.73628 | valid_balanced_accuracy: 0.67672 | valid_accuracy: 0.67737 |  0:05:28s
epoch 19 | loss: 0.57645 | train_auc: 0.75447 | train_balanced_accuracy: 0.68399 | train_accuracy: 0.68449 | valid_auc: 0.7355  | valid_balanced_accuracy: 0.67656 | valid_accuracy: 0.67705 |  0:05:44s
epoch 20 | loss: 0.57561 | train_auc: 0.75969 | train_balanced_accuracy: 0.6862  | train_accuracy: 0.68673 | valid_auc: 0.73472 | valid_balanced_accuracy: 0.66996 | valid_accuracy: 0.67044 |  0:06:03s
epoch 21 | loss: 0.56961 | train_auc: 0.76702 | train_balanced_accuracy: 0.69596 | train_accuracy: 0.69649 | valid_auc: 0.74037 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.68146 |  0:06:21s
epoch 22 | loss: 0.57213 | train_auc: 0.77276 | train_balanced_accuracy: 0.69808 | train_accuracy: 0.69865 | valid_auc: 0.74308 | valid_balanced_accuracy: 0.6787  | valid_accuracy: 0.67926 |  0:06:39s
epoch 23 | loss: 0.5703  | train_auc: 0.77235 | train_balanced_accuracy: 0.70224 | train_accuracy: 0.70251 | valid_auc: 0.74312 | valid_balanced_accuracy: 0.68843 | valid_accuracy: 0.6887  |  0:06:58s
epoch 24 | loss: 0.57095 | train_auc: 0.77506 | train_balanced_accuracy: 0.70059 | train_accuracy: 0.70094 | valid_auc: 0.74331 | valid_balanced_accuracy: 0.68095 | valid_accuracy: 0.6813  |  0:07:14s
epoch 25 | loss: 0.56574 | train_auc: 0.77804 | train_balanced_accuracy: 0.7055  | train_accuracy: 0.70582 | valid_auc: 0.74671 | valid_balanced_accuracy: 0.69279 | valid_accuracy: 0.69311 |  0:07:30s
epoch 26 | loss: 0.56498 | train_auc: 0.77626 | train_balanced_accuracy: 0.70342 | train_accuracy: 0.70385 | valid_auc: 0.74306 | valid_balanced_accuracy: 0.68533 | valid_accuracy: 0.68571 |  0:07:47s
epoch 27 | loss: 0.56728 | train_auc: 0.7856  | train_balanced_accuracy: 0.71205 | train_accuracy: 0.71215 | valid_auc: 0.75563 | valid_balanced_accuracy: 0.69098 | valid_accuracy: 0.69106 |  0:08:04s
epoch 28 | loss: 0.56156 | train_auc: 0.78627 | train_balanced_accuracy: 0.71255 | train_accuracy: 0.7125  | valid_auc: 0.75262 | valid_balanced_accuracy: 0.69128 | valid_accuracy: 0.69122 |  0:08:21s
epoch 29 | loss: 0.5604  | train_auc: 0.7818  | train_balanced_accuracy: 0.70749 | train_accuracy: 0.70735 | valid_auc: 0.74999 | valid_balanced_accuracy: 0.69245 | valid_accuracy: 0.69232 |  0:08:39s
epoch 30 | loss: 0.56326 | train_auc: 0.78613 | train_balanced_accuracy: 0.71232 | train_accuracy: 0.71246 | valid_auc: 0.75223 | valid_balanced_accuracy: 0.6856  | valid_accuracy: 0.68571 |  0:08:56s
epoch 31 | loss: 0.56111 | train_auc: 0.78494 | train_balanced_accuracy: 0.7087  | train_accuracy: 0.70888 | valid_auc: 0.74684 | valid_balanced_accuracy: 0.68242 | valid_accuracy: 0.68256 |  0:09:12s
epoch 32 | loss: 0.552   | train_auc: 0.79162 | train_balanced_accuracy: 0.71658 | train_accuracy: 0.71656 | valid_auc: 0.7525  | valid_balanced_accuracy: 0.68511 | valid_accuracy: 0.68508 |  0:09:29s
epoch 33 | loss: 0.55838 | train_auc: 0.79087 | train_balanced_accuracy: 0.71516 | train_accuracy: 0.71549 | valid_auc: 0.75132 | valid_balanced_accuracy: 0.68761 | valid_accuracy: 0.68791 |  0:09:45s
epoch 34 | loss: 0.55864 | train_auc: 0.78468 | train_balanced_accuracy: 0.70999 | train_accuracy: 0.70987 | valid_auc: 0.75025 | valid_balanced_accuracy: 0.67406 | valid_accuracy: 0.67391 |  0:10:03s
epoch 35 | loss: 0.5521  | train_auc: 0.79032 | train_balanced_accuracy: 0.71207 | train_accuracy: 0.7125  | valid_auc: 0.74824 | valid_balanced_accuracy: 0.67821 | valid_accuracy: 0.67863 |  0:10:20s
epoch 36 | loss: 0.55372 | train_auc: 0.7856  | train_balanced_accuracy: 0.71115 | train_accuracy: 0.71105 | valid_auc: 0.75011 | valid_balanced_accuracy: 0.68044 | valid_accuracy: 0.68036 |  0:10:37s
epoch 37 | loss: 0.55962 | train_auc: 0.79566 | train_balanced_accuracy: 0.72127 | train_accuracy: 0.72151 | valid_auc: 0.7541  | valid_balanced_accuracy: 0.69336 | valid_accuracy: 0.69358 |  0:10:55s
epoch 38 | loss: 0.55142 | train_auc: 0.79381 | train_balanced_accuracy: 0.71567 | train_accuracy: 0.71549 | valid_auc: 0.75548 | valid_balanced_accuracy: 0.68388 | valid_accuracy: 0.68366 |  0:11:11s
epoch 39 | loss: 0.54924 | train_auc: 0.79506 | train_balanced_accuracy: 0.71795 | train_accuracy: 0.71793 | valid_auc: 0.75488 | valid_balanced_accuracy: 0.6906  | valid_accuracy: 0.69059 |  0:11:29s
epoch 40 | loss: 0.55518 | train_auc: 0.78749 | train_balanced_accuracy: 0.7092  | train_accuracy: 0.70947 | valid_auc: 0.74306 | valid_balanced_accuracy: 0.68046 | valid_accuracy: 0.68067 |  0:11:47s
epoch 41 | loss: 0.55114 | train_auc: 0.79899 | train_balanced_accuracy: 0.7219  | train_accuracy: 0.7223  | valid_auc: 0.75076 | valid_balanced_accuracy: 0.68331 | valid_accuracy: 0.68366 |  0:12:03s
epoch 42 | loss: 0.54741 | train_auc: 0.7969  | train_balanced_accuracy: 0.71605 | train_accuracy: 0.71664 | valid_auc: 0.75358 | valid_balanced_accuracy: 0.68906 | valid_accuracy: 0.68964 |  0:12:21s
epoch 43 | loss: 0.55102 | train_auc: 0.79649 | train_balanced_accuracy: 0.7183  | train_accuracy: 0.71825 | valid_auc: 0.74712 | valid_balanced_accuracy: 0.68391 | valid_accuracy: 0.68382 |  0:12:37s
epoch 44 | loss: 0.55444 | train_auc: 0.79957 | train_balanced_accuracy: 0.72136 | train_accuracy: 0.72147 | valid_auc: 0.75494 | valid_balanced_accuracy: 0.68628 | valid_accuracy: 0.68634 |  0:12:53s
epoch 45 | loss: 0.54833 | train_auc: 0.80148 | train_balanced_accuracy: 0.72371 | train_accuracy: 0.72415 | valid_auc: 0.75405 | valid_balanced_accuracy: 0.68906 | valid_accuracy: 0.68949 |  0:13:11s
epoch 46 | loss: 0.54845 | train_auc: 0.80014 | train_balanced_accuracy: 0.72443 | train_accuracy: 0.7245  | valid_auc: 0.75486 | valid_balanced_accuracy: 0.69056 | valid_accuracy: 0.69059 |  0:13:29s
epoch 47 | loss: 0.54618 | train_auc: 0.80436 | train_balanced_accuracy: 0.72758 | train_accuracy: 0.72785 | valid_auc: 0.75617 | valid_balanced_accuracy: 0.68913 | valid_accuracy: 0.68933 |  0:13:46s
epoch 48 | loss: 0.54421 | train_auc: 0.80374 | train_balanced_accuracy: 0.72613 | train_accuracy: 0.72643 | valid_auc: 0.7564  | valid_balanced_accuracy: 0.68826 | valid_accuracy: 0.68854 |  0:14:02s
epoch 49 | loss: 0.54501 | train_auc: 0.79273 | train_balanced_accuracy: 0.71514 | train_accuracy: 0.71553 | valid_auc: 0.74757 | valid_balanced_accuracy: 0.6846  | valid_accuracy: 0.68492 |  0:14:18s
epoch 50 | loss: 0.54593 | train_auc: 0.80639 | train_balanced_accuracy: 0.73173 | train_accuracy: 0.73198 | valid_auc: 0.75987 | valid_balanced_accuracy: 0.69511 | valid_accuracy: 0.69531 |  0:14:36s
epoch 51 | loss: 0.54382 | train_auc: 0.8099  | train_balanced_accuracy: 0.7306  | train_accuracy: 0.73068 | valid_auc: 0.76273 | valid_balanced_accuracy: 0.69683 | valid_accuracy: 0.69688 |  0:14:53s
epoch 52 | loss: 0.53862 | train_auc: 0.80297 | train_balanced_accuracy: 0.72465 | train_accuracy: 0.7245  | valid_auc: 0.75522 | valid_balanced_accuracy: 0.68512 | valid_accuracy: 0.68492 |  0:15:11s
epoch 53 | loss: 0.53758 | train_auc: 0.8034  | train_balanced_accuracy: 0.72493 | train_accuracy: 0.72502 | valid_auc: 0.75883 | valid_balanced_accuracy: 0.69317 | valid_accuracy: 0.69326 |  0:15:27s
epoch 54 | loss: 0.54047 | train_auc: 0.80826 | train_balanced_accuracy: 0.72737 | train_accuracy: 0.72738 | valid_auc: 0.75365 | valid_balanced_accuracy: 0.68271 | valid_accuracy: 0.68272 |  0:15:46s
epoch 55 | loss: 0.54226 | train_auc: 0.80804 | train_balanced_accuracy: 0.73027 | train_accuracy: 0.73037 | valid_auc: 0.75743 | valid_balanced_accuracy: 0.69052 | valid_accuracy: 0.69059 |  0:16:03s
epoch 56 | loss: 0.53614 | train_auc: 0.81017 | train_balanced_accuracy: 0.72855 | train_accuracy: 0.72875 | valid_auc: 0.75287 | valid_balanced_accuracy: 0.68348 | valid_accuracy: 0.68366 |  0:16:20s
epoch 57 | loss: 0.54336 | train_auc: 0.81053 | train_balanced_accuracy: 0.72788 | train_accuracy: 0.72773 | valid_auc: 0.75726 | valid_balanced_accuracy: 0.69008 | valid_accuracy: 0.68996 |  0:16:37s
epoch 58 | loss: 0.54137 | train_auc: 0.81093 | train_balanced_accuracy: 0.7322  | train_accuracy: 0.73226 | valid_auc: 0.75514 | valid_balanced_accuracy: 0.6921  | valid_accuracy: 0.69216 |  0:16:54s
epoch 59 | loss: 0.53602 | train_auc: 0.8085  | train_balanced_accuracy: 0.72935 | train_accuracy: 0.72942 | valid_auc: 0.75502 | valid_balanced_accuracy: 0.69007 | valid_accuracy: 0.69012 |  0:17:11s
epoch 60 | loss: 0.54511 | train_auc: 0.81315 | train_balanced_accuracy: 0.73439 | train_accuracy: 0.73462 | valid_auc: 0.76072 | valid_balanced_accuracy: 0.68977 | valid_accuracy: 0.68996 |  0:17:29s
epoch 61 | loss: 0.53955 | train_auc: 0.81121 | train_balanced_accuracy: 0.73164 | train_accuracy: 0.73202 | valid_auc: 0.75682 | valid_balanced_accuracy: 0.69149 | valid_accuracy: 0.69185 |  0:17:47s
epoch 62 | loss: 0.53216 | train_auc: 0.80641 | train_balanced_accuracy: 0.72558 | train_accuracy: 0.72557 | valid_auc: 0.75225 | valid_balanced_accuracy: 0.68386 | valid_accuracy: 0.68382 |  0:18:05s
epoch 63 | loss: 0.53743 | train_auc: 0.81252 | train_balanced_accuracy: 0.73326 | train_accuracy: 0.73336 | valid_auc: 0.75821 | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.6898  |  0:18:23s
epoch 64 | loss: 0.53326 | train_auc: 0.81432 | train_balanced_accuracy: 0.73122 | train_accuracy: 0.73135 | valid_auc: 0.76002 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.68996 |  0:18:39s
epoch 65 | loss: 0.52661 | train_auc: 0.8127  | train_balanced_accuracy: 0.73035 | train_accuracy: 0.73041 | valid_auc: 0.75048 | valid_balanced_accuracy: 0.68555 | valid_accuracy: 0.68555 |  0:18:57s
epoch 66 | loss: 0.53741 | train_auc: 0.81095 | train_balanced_accuracy: 0.7303  | train_accuracy: 0.73037 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.68524 |  0:19:13s
epoch 67 | loss: 0.52744 | train_auc: 0.81556 | train_balanced_accuracy: 0.73494 | train_accuracy: 0.73513 | valid_auc: 0.75824 | valid_balanced_accuracy: 0.68887 | valid_accuracy: 0.68901 |  0:19:29s
epoch 68 | loss: 0.53231 | train_auc: 0.81618 | train_balanced_accuracy: 0.73363 | train_accuracy: 0.73399 | valid_auc: 0.75611 | valid_balanced_accuracy: 0.6868  | valid_accuracy: 0.68713 |  0:19:47s
epoch 69 | loss: 0.53302 | train_auc: 0.81584 | train_balanced_accuracy: 0.73316 | train_accuracy: 0.73324 | valid_auc: 0.7566  | valid_balanced_accuracy: 0.68516 | valid_accuracy: 0.68524 |  0:20:05s
epoch 70 | loss: 0.52968 | train_auc: 0.81812 | train_balanced_accuracy: 0.73717 | train_accuracy: 0.73717 | valid_auc: 0.75901 | valid_balanced_accuracy: 0.68763 | valid_accuracy: 0.6876  |  0:20:21s
epoch 71 | loss: 0.53333 | train_auc: 0.81909 | train_balanced_accuracy: 0.73687 | train_accuracy: 0.73694 | valid_auc: 0.75706 | valid_balanced_accuracy: 0.68224 | valid_accuracy: 0.68225 |  0:20:37s

Early stopping occurred at epoch 71 with best_epoch = 51 and best_valid_accuracy = 0.69688
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 58/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.700 total time=20.8min
[CV 4/5; 58/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70074 | train_auc: 0.55824 | train_balanced_accuracy: 0.52885 | train_accuracy: 0.52695 | valid_auc: 0.57527 | valid_balanced_accuracy: 0.53945 | valid_accuracy: 0.53761 |  0:00:17s
epoch 1  | loss: 0.65233 | train_auc: 0.65893 | train_balanced_accuracy: 0.6106  | train_accuracy: 0.61178 | valid_auc: 0.66454 | valid_balanced_accuracy: 0.62026 | valid_accuracy: 0.6215  |  0:00:36s
epoch 2  | loss: 0.62247 | train_auc: 0.69681 | train_balanced_accuracy: 0.61793 | train_accuracy: 0.61981 | valid_auc: 0.69946 | valid_balanced_accuracy: 0.62198 | valid_accuracy: 0.62386 |  0:00:53s
epoch 3  | loss: 0.61469 | train_auc: 0.69201 | train_balanced_accuracy: 0.63753 | train_accuracy: 0.63901 | valid_auc: 0.69535 | valid_balanced_accuracy: 0.64139 | valid_accuracy: 0.6429  |  0:01:10s
epoch 4  | loss: 0.60815 | train_auc: 0.70293 | train_balanced_accuracy: 0.62193 | train_accuracy: 0.6237  | valid_auc: 0.70953 | valid_balanced_accuracy: 0.62488 | valid_accuracy: 0.62669 |  0:01:29s
epoch 5  | loss: 0.60365 | train_auc: 0.69977 | train_balanced_accuracy: 0.63833 | train_accuracy: 0.63972 | valid_auc: 0.705   | valid_balanced_accuracy: 0.64434 | valid_accuracy: 0.64573 |  0:01:46s
epoch 6  | loss: 0.59916 | train_auc: 0.70568 | train_balanced_accuracy: 0.63676 | train_accuracy: 0.6381  | valid_auc: 0.7095  | valid_balanced_accuracy: 0.64011 | valid_accuracy: 0.64149 |  0:02:03s
epoch 7  | loss: 0.59243 | train_auc: 0.71504 | train_balanced_accuracy: 0.65765 | train_accuracy: 0.6586  | valid_auc: 0.71561 | valid_balanced_accuracy: 0.66301 | valid_accuracy: 0.66399 |  0:02:19s
epoch 8  | loss: 0.58852 | train_auc: 0.71719 | train_balanced_accuracy: 0.66423 | train_accuracy: 0.66509 | valid_auc: 0.71365 | valid_balanced_accuracy: 0.66246 | valid_accuracy: 0.66336 |  0:02:37s
epoch 9  | loss: 0.58724 | train_auc: 0.72523 | train_balanced_accuracy: 0.65723 | train_accuracy: 0.65844 | valid_auc: 0.72021 | valid_balanced_accuracy: 0.65503 | valid_accuracy: 0.65628 |  0:02:55s
epoch 10 | loss: 0.57994 | train_auc: 0.73113 | train_balanced_accuracy: 0.6708  | train_accuracy: 0.67155 | valid_auc: 0.72398 | valid_balanced_accuracy: 0.66481 | valid_accuracy: 0.66556 |  0:03:13s
epoch 11 | loss: 0.58239 | train_auc: 0.72696 | train_balanced_accuracy: 0.67431 | train_accuracy: 0.67493 | valid_auc: 0.71824 | valid_balanced_accuracy: 0.66241 | valid_accuracy: 0.66305 |  0:03:30s
epoch 12 | loss: 0.58219 | train_auc: 0.73168 | train_balanced_accuracy: 0.67558 | train_accuracy: 0.67619 | valid_auc: 0.7207  | valid_balanced_accuracy: 0.66637 | valid_accuracy: 0.66698 |  0:03:47s
epoch 13 | loss: 0.57949 | train_auc: 0.73966 | train_balanced_accuracy: 0.67319 | train_accuracy: 0.67387 | valid_auc: 0.72767 | valid_balanced_accuracy: 0.66532 | valid_accuracy: 0.66604 |  0:04:04s
epoch 14 | loss: 0.5794  | train_auc: 0.73796 | train_balanced_accuracy: 0.67772 | train_accuracy: 0.67804 | valid_auc: 0.72924 | valid_balanced_accuracy: 0.66821 | valid_accuracy: 0.66856 |  0:04:20s
epoch 15 | loss: 0.58091 | train_auc: 0.74524 | train_balanced_accuracy: 0.67835 | train_accuracy: 0.67898 | valid_auc: 0.73196 | valid_balanced_accuracy: 0.66664 | valid_accuracy: 0.6673  |  0:04:36s
epoch 16 | loss: 0.57056 | train_auc: 0.74845 | train_balanced_accuracy: 0.68014 | train_accuracy: 0.68048 | valid_auc: 0.73107 | valid_balanced_accuracy: 0.66629 | valid_accuracy: 0.66667 |  0:04:55s
epoch 17 | loss: 0.57293 | train_auc: 0.74759 | train_balanced_accuracy: 0.67793 | train_accuracy: 0.67859 | valid_auc: 0.73296 | valid_balanced_accuracy: 0.66617 | valid_accuracy: 0.66682 |  0:05:15s
epoch 18 | loss: 0.57568 | train_auc: 0.75704 | train_balanced_accuracy: 0.68113 | train_accuracy: 0.6817  | valid_auc: 0.73753 | valid_balanced_accuracy: 0.66783 | valid_accuracy: 0.6684  |  0:05:34s
epoch 19 | loss: 0.57004 | train_auc: 0.75343 | train_balanced_accuracy: 0.68542 | train_accuracy: 0.68583 | valid_auc: 0.73723 | valid_balanced_accuracy: 0.6727  | valid_accuracy: 0.67312 |  0:05:51s
epoch 20 | loss: 0.56954 | train_auc: 0.75326 | train_balanced_accuracy: 0.6835  | train_accuracy: 0.6841  | valid_auc: 0.7382  | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66966 |  0:06:09s
epoch 21 | loss: 0.56811 | train_auc: 0.76487 | train_balanced_accuracy: 0.68427 | train_accuracy: 0.68504 | valid_auc: 0.74352 | valid_balanced_accuracy: 0.6766  | valid_accuracy: 0.67737 |  0:06:28s
epoch 22 | loss: 0.56797 | train_auc: 0.76609 | train_balanced_accuracy: 0.68927 | train_accuracy: 0.68968 | valid_auc: 0.73895 | valid_balanced_accuracy: 0.66718 | valid_accuracy: 0.66761 |  0:06:46s
epoch 23 | loss: 0.56678 | train_auc: 0.77293 | train_balanced_accuracy: 0.69771 | train_accuracy: 0.69802 | valid_auc: 0.7466  | valid_balanced_accuracy: 0.67688 | valid_accuracy: 0.67721 |  0:07:02s
epoch 24 | loss: 0.56704 | train_auc: 0.767   | train_balanced_accuracy: 0.69265 | train_accuracy: 0.69303 | valid_auc: 0.73576 | valid_balanced_accuracy: 0.66909 | valid_accuracy: 0.6695  |  0:07:20s
epoch 25 | loss: 0.56393 | train_auc: 0.77703 | train_balanced_accuracy: 0.70354 | train_accuracy: 0.70377 | valid_auc: 0.7451  | valid_balanced_accuracy: 0.68235 | valid_accuracy: 0.68256 |  0:07:37s
epoch 26 | loss: 0.55993 | train_auc: 0.76955 | train_balanced_accuracy: 0.69148 | train_accuracy: 0.69165 | valid_auc: 0.74305 | valid_balanced_accuracy: 0.67393 | valid_accuracy: 0.67406 |  0:07:55s
epoch 27 | loss: 0.56209 | train_auc: 0.78222 | train_balanced_accuracy: 0.70342 | train_accuracy: 0.70408 | valid_auc: 0.75602 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.6865  |  0:08:13s
epoch 28 | loss: 0.55955 | train_auc: 0.77881 | train_balanced_accuracy: 0.70379 | train_accuracy: 0.70393 | valid_auc: 0.74578 | valid_balanced_accuracy: 0.67771 | valid_accuracy: 0.67784 |  0:08:28s
epoch 29 | loss: 0.55981 | train_auc: 0.78105 | train_balanced_accuracy: 0.70562 | train_accuracy: 0.70562 | valid_auc: 0.75085 | valid_balanced_accuracy: 0.6813  | valid_accuracy: 0.6813  |  0:08:45s
epoch 30 | loss: 0.55551 | train_auc: 0.7849  | train_balanced_accuracy: 0.70652 | train_accuracy: 0.70652 | valid_auc: 0.75372 | valid_balanced_accuracy: 0.69104 | valid_accuracy: 0.69106 |  0:09:03s
epoch 31 | loss: 0.55825 | train_auc: 0.78269 | train_balanced_accuracy: 0.70782 | train_accuracy: 0.70774 | valid_auc: 0.74861 | valid_balanced_accuracy: 0.68214 | valid_accuracy: 0.68209 |  0:09:20s
epoch 32 | loss: 0.55255 | train_auc: 0.78063 | train_balanced_accuracy: 0.70195 | train_accuracy: 0.70153 | valid_auc: 0.74287 | valid_balanced_accuracy: 0.67416 | valid_accuracy: 0.67375 |  0:09:37s
epoch 33 | loss: 0.55532 | train_auc: 0.78964 | train_balanced_accuracy: 0.71166 | train_accuracy: 0.7116  | valid_auc: 0.7504  | valid_balanced_accuracy: 0.68253 | valid_accuracy: 0.68256 |  0:09:52s
epoch 34 | loss: 0.5563  | train_auc: 0.78946 | train_balanced_accuracy: 0.71377 | train_accuracy: 0.7138  | valid_auc: 0.75344 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.68587 |  0:10:09s
epoch 35 | loss: 0.54649 | train_auc: 0.79104 | train_balanced_accuracy: 0.71262 | train_accuracy: 0.71302 | valid_auc: 0.75027 | valid_balanced_accuracy: 0.6803  | valid_accuracy: 0.68067 |  0:10:26s
epoch 36 | loss: 0.54635 | train_auc: 0.78709 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70908 | valid_auc: 0.74969 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68602 |  0:10:43s
epoch 37 | loss: 0.55071 | train_auc: 0.799   | train_balanced_accuracy: 0.71992 | train_accuracy: 0.7201  | valid_auc: 0.75678 | valid_balanced_accuracy: 0.6923  | valid_accuracy: 0.69248 |  0:11:02s
epoch 38 | loss: 0.55334 | train_auc: 0.77504 | train_balanced_accuracy: 0.69771 | train_accuracy: 0.69826 | valid_auc: 0.74305 | valid_balanced_accuracy: 0.68076 | valid_accuracy: 0.6813  |  0:11:19s
epoch 39 | loss: 0.54854 | train_auc: 0.79183 | train_balanced_accuracy: 0.7116  | train_accuracy: 0.71219 | valid_auc: 0.75014 | valid_balanced_accuracy: 0.68259 | valid_accuracy: 0.68319 |  0:11:36s
epoch 40 | loss: 0.54657 | train_auc: 0.79529 | train_balanced_accuracy: 0.71275 | train_accuracy: 0.71313 | valid_auc: 0.7573  | valid_balanced_accuracy: 0.6916  | valid_accuracy: 0.69201 |  0:11:54s
epoch 41 | loss: 0.5473  | train_auc: 0.79986 | train_balanced_accuracy: 0.71966 | train_accuracy: 0.7199  | valid_auc: 0.75299 | valid_balanced_accuracy: 0.68746 | valid_accuracy: 0.68776 |  0:12:13s
epoch 42 | loss: 0.5456  | train_auc: 0.79761 | train_balanced_accuracy: 0.71898 | train_accuracy: 0.71923 | valid_auc: 0.75476 | valid_balanced_accuracy: 0.68822 | valid_accuracy: 0.68854 |  0:12:31s
epoch 43 | loss: 0.54813 | train_auc: 0.7931  | train_balanced_accuracy: 0.71291 | train_accuracy: 0.7127  | valid_auc: 0.74666 | valid_balanced_accuracy: 0.67694 | valid_accuracy: 0.67674 |  0:12:48s
epoch 44 | loss: 0.55072 | train_auc: 0.77746 | train_balanced_accuracy: 0.69832 | train_accuracy: 0.69799 | valid_auc: 0.7403  | valid_balanced_accuracy: 0.66963 | valid_accuracy: 0.66934 |  0:13:03s
epoch 45 | loss: 0.54438 | train_auc: 0.79568 | train_balanced_accuracy: 0.71771 | train_accuracy: 0.71785 | valid_auc: 0.74922 | valid_balanced_accuracy: 0.68031 | valid_accuracy: 0.68052 |  0:13:22s
epoch 46 | loss: 0.54674 | train_auc: 0.78219 | train_balanced_accuracy: 0.7035  | train_accuracy: 0.70314 | valid_auc: 0.74057 | valid_balanced_accuracy: 0.67391 | valid_accuracy: 0.67359 |  0:13:39s
epoch 47 | loss: 0.54834 | train_auc: 0.79104 | train_balanced_accuracy: 0.70635 | train_accuracy: 0.70719 | valid_auc: 0.75161 | valid_balanced_accuracy: 0.6732  | valid_accuracy: 0.67406 |  0:13:57s
epoch 48 | loss: 0.54465 | train_auc: 0.80364 | train_balanced_accuracy: 0.72307 | train_accuracy: 0.72301 | valid_auc: 0.75586 | valid_balanced_accuracy: 0.68608 | valid_accuracy: 0.68602 |  0:14:14s
epoch 49 | loss: 0.54125 | train_auc: 0.807   | train_balanced_accuracy: 0.72626 | train_accuracy: 0.72647 | valid_auc: 0.75971 | valid_balanced_accuracy: 0.68625 | valid_accuracy: 0.6865  |  0:14:32s
epoch 50 | loss: 0.54467 | train_auc: 0.80773 | train_balanced_accuracy: 0.7261  | train_accuracy: 0.72639 | valid_auc: 0.76132 | valid_balanced_accuracy: 0.69451 | valid_accuracy: 0.69484 |  0:14:51s
epoch 51 | loss: 0.5375  | train_auc: 0.77955 | train_balanced_accuracy: 0.69765 | train_accuracy: 0.6985  | valid_auc: 0.74729 | valid_balanced_accuracy: 0.67386 | valid_accuracy: 0.67469 |  0:15:09s
epoch 52 | loss: 0.53519 | train_auc: 0.81088 | train_balanced_accuracy: 0.72958 | train_accuracy: 0.72958 | valid_auc: 0.75895 | valid_balanced_accuracy: 0.68832 | valid_accuracy: 0.68839 |  0:15:28s
epoch 53 | loss: 0.5392  | train_auc: 0.80787 | train_balanced_accuracy: 0.72629 | train_accuracy: 0.72655 | valid_auc: 0.76555 | valid_balanced_accuracy: 0.6938  | valid_accuracy: 0.69405 |  0:15:44s
epoch 54 | loss: 0.54573 | train_auc: 0.80567 | train_balanced_accuracy: 0.72443 | train_accuracy: 0.72458 | valid_auc: 0.76244 | valid_balanced_accuracy: 0.69138 | valid_accuracy: 0.69153 |  0:16:04s
epoch 55 | loss: 0.5386  | train_auc: 0.80589 | train_balanced_accuracy: 0.72356 | train_accuracy: 0.72395 | valid_auc: 0.75825 | valid_balanced_accuracy: 0.68688 | valid_accuracy: 0.68728 |  0:16:20s
epoch 56 | loss: 0.53888 | train_auc: 0.78374 | train_balanced_accuracy: 0.7054  | train_accuracy: 0.70593 | valid_auc: 0.74617 | valid_balanced_accuracy: 0.67952 | valid_accuracy: 0.68004 |  0:16:39s
epoch 57 | loss: 0.54148 | train_auc: 0.81524 | train_balanced_accuracy: 0.73279 | train_accuracy: 0.73296 | valid_auc: 0.76295 | valid_balanced_accuracy: 0.69087 | valid_accuracy: 0.69106 |  0:16:58s
epoch 58 | loss: 0.53844 | train_auc: 0.80905 | train_balanced_accuracy: 0.72594 | train_accuracy: 0.72592 | valid_auc: 0.75948 | valid_balanced_accuracy: 0.68556 | valid_accuracy: 0.68555 |  0:17:16s
epoch 59 | loss: 0.53636 | train_auc: 0.80268 | train_balanced_accuracy: 0.71842 | train_accuracy: 0.71864 | valid_auc: 0.75683 | valid_balanced_accuracy: 0.68753 | valid_accuracy: 0.68776 |  0:17:34s
epoch 60 | loss: 0.53559 | train_auc: 0.81702 | train_balanced_accuracy: 0.73521 | train_accuracy: 0.7354  | valid_auc: 0.76458 | valid_balanced_accuracy: 0.68911 | valid_accuracy: 0.68933 |  0:17:52s
epoch 61 | loss: 0.52832 | train_auc: 0.81432 | train_balanced_accuracy: 0.73176 | train_accuracy: 0.73198 | valid_auc: 0.76339 | valid_balanced_accuracy: 0.69316 | valid_accuracy: 0.69342 |  0:18:09s
epoch 62 | loss: 0.53137 | train_auc: 0.81338 | train_balanced_accuracy: 0.73088 | train_accuracy: 0.73088 | valid_auc: 0.7608  | valid_balanced_accuracy: 0.68821 | valid_accuracy: 0.68823 |  0:18:25s
epoch 63 | loss: 0.53191 | train_auc: 0.81385 | train_balanced_accuracy: 0.72962 | train_accuracy: 0.72982 | valid_auc: 0.76617 | valid_balanced_accuracy: 0.6952  | valid_accuracy: 0.69547 |  0:18:41s
epoch 64 | loss: 0.52602 | train_auc: 0.81532 | train_balanced_accuracy: 0.73291 | train_accuracy: 0.73273 | valid_auc: 0.76138 | valid_balanced_accuracy: 0.68999 | valid_accuracy: 0.6898  |  0:18:59s
epoch 65 | loss: 0.5273  | train_auc: 0.81079 | train_balanced_accuracy: 0.72715 | train_accuracy: 0.72694 | valid_auc: 0.75695 | valid_balanced_accuracy: 0.68698 | valid_accuracy: 0.68681 |  0:19:16s
epoch 66 | loss: 0.53207 | train_auc: 0.81492 | train_balanced_accuracy: 0.73235 | train_accuracy: 0.73249 | valid_auc: 0.7603  | valid_balanced_accuracy: 0.68996 | valid_accuracy: 0.69012 |  0:19:34s
epoch 67 | loss: 0.52731 | train_auc: 0.7378  | train_balanced_accuracy: 0.66887 | train_accuracy: 0.6697  | valid_auc: 0.70743 | valid_balanced_accuracy: 0.64614 | valid_accuracy: 0.64699 |  0:19:53s
epoch 68 | loss: 0.52875 | train_auc: 0.77275 | train_balanced_accuracy: 0.69472 | train_accuracy: 0.69555 | valid_auc: 0.73495 | valid_balanced_accuracy: 0.66636 | valid_accuracy: 0.66714 |  0:20:12s
epoch 69 | loss: 0.53173 | train_auc: 0.78376 | train_balanced_accuracy: 0.70689 | train_accuracy: 0.70751 | valid_auc: 0.74573 | valid_balanced_accuracy: 0.675   | valid_accuracy: 0.67564 |  0:20:30s
epoch 70 | loss: 0.52547 | train_auc: 0.79668 | train_balanced_accuracy: 0.71461 | train_accuracy: 0.71506 | valid_auc: 0.75563 | valid_balanced_accuracy: 0.68366 | valid_accuracy: 0.68414 |  0:20:47s
epoch 71 | loss: 0.52607 | train_auc: 0.7872  | train_balanced_accuracy: 0.70573 | train_accuracy: 0.70621 | valid_auc: 0.74785 | valid_balanced_accuracy: 0.67813 | valid_accuracy: 0.67863 |  0:21:06s
epoch 72 | loss: 0.53101 | train_auc: 0.66385 | train_balanced_accuracy: 0.62289 | train_accuracy: 0.62425 | valid_auc: 0.65281 | valid_balanced_accuracy: 0.61415 | valid_accuracy: 0.61552 |  0:21:25s
epoch 73 | loss: 0.52748 | train_auc: 0.69631 | train_balanced_accuracy: 0.64682 | train_accuracy: 0.64747 | valid_auc: 0.68464 | valid_balanced_accuracy: 0.64129 | valid_accuracy: 0.64196 |  0:21:40s
epoch 74 | loss: 0.52953 | train_auc: 0.75006 | train_balanced_accuracy: 0.6763  | train_accuracy: 0.67709 | valid_auc: 0.72102 | valid_balanced_accuracy: 0.65755 | valid_accuracy: 0.65833 |  0:21:57s
epoch 75 | loss: 0.52547 | train_auc: 0.80044 | train_balanced_accuracy: 0.71972 | train_accuracy: 0.72006 | valid_auc: 0.75258 | valid_balanced_accuracy: 0.68299 | valid_accuracy: 0.68335 |  0:22:15s
epoch 76 | loss: 0.52409 | train_auc: 0.81934 | train_balanced_accuracy: 0.73199 | train_accuracy: 0.73174 | valid_auc: 0.76324 | valid_balanced_accuracy: 0.68955 | valid_accuracy: 0.68933 |  0:22:33s
epoch 77 | loss: 0.52559 | train_auc: 0.80468 | train_balanced_accuracy: 0.72588 | train_accuracy: 0.72568 | valid_auc: 0.75397 | valid_balanced_accuracy: 0.68804 | valid_accuracy: 0.68791 |  0:22:52s
epoch 78 | loss: 0.51986 | train_auc: 0.80727 | train_balanced_accuracy: 0.72454 | train_accuracy: 0.72435 | valid_auc: 0.75817 | valid_balanced_accuracy: 0.68961 | valid_accuracy: 0.68949 |  0:23:08s
epoch 79 | loss: 0.51974 | train_auc: 0.80529 | train_balanced_accuracy: 0.7247  | train_accuracy: 0.72446 | valid_auc: 0.74928 | valid_balanced_accuracy: 0.68431 | valid_accuracy: 0.68414 |  0:23:25s
epoch 80 | loss: 0.52185 | train_auc: 0.80639 | train_balanced_accuracy: 0.72879 | train_accuracy: 0.72891 | valid_auc: 0.7478  | valid_balanced_accuracy: 0.68378 | valid_accuracy: 0.68398 |  0:23:42s
epoch 81 | loss: 0.52514 | train_auc: 0.80837 | train_balanced_accuracy: 0.72573 | train_accuracy: 0.72572 | valid_auc: 0.75323 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.68524 |  0:24:00s
epoch 82 | loss: 0.51777 | train_auc: 0.80495 | train_balanced_accuracy: 0.72414 | train_accuracy: 0.72446 | valid_auc: 0.75127 | valid_balanced_accuracy: 0.67921 | valid_accuracy: 0.67957 |  0:24:20s
epoch 83 | loss: 0.51924 | train_auc: 0.8201  | train_balanced_accuracy: 0.735   | train_accuracy: 0.73521 | valid_auc: 0.76332 | valid_balanced_accuracy: 0.69127 | valid_accuracy: 0.69153 |  0:24:37s

Early stopping occurred at epoch 83 with best_epoch = 63 and best_valid_accuracy = 0.69547
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 58/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=24.7min
[CV 5/5; 58/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68515 | train_auc: 0.59958 | train_balanced_accuracy: 0.53158 | train_accuracy: 0.52915 | valid_auc: 0.60751 | valid_balanced_accuracy: 0.54115 | valid_accuracy: 0.53872 |  0:00:17s
epoch 1  | loss: 0.62944 | train_auc: 0.66435 | train_balanced_accuracy: 0.56532 | train_accuracy: 0.56287 | valid_auc: 0.66396 | valid_balanced_accuracy: 0.56527 | valid_accuracy: 0.5628  |  0:00:34s
epoch 2  | loss: 0.62171 | train_auc: 0.68357 | train_balanced_accuracy: 0.58931 | train_accuracy: 0.58715 | valid_auc: 0.679   | valid_balanced_accuracy: 0.58891 | valid_accuracy: 0.58672 |  0:00:54s
epoch 3  | loss: 0.61407 | train_auc: 0.68983 | train_balanced_accuracy: 0.62359 | train_accuracy: 0.62248 | valid_auc: 0.68626 | valid_balanced_accuracy: 0.62042 | valid_accuracy: 0.61929 |  0:01:11s
epoch 4  | loss: 0.60511 | train_auc: 0.68556 | train_balanced_accuracy: 0.62191 | train_accuracy: 0.62083 | valid_auc: 0.68334 | valid_balanced_accuracy: 0.62071 | valid_accuracy: 0.61961 |  0:01:29s
epoch 5  | loss: 0.60134 | train_auc: 0.69974 | train_balanced_accuracy: 0.63248 | train_accuracy: 0.63189 | valid_auc: 0.6944  | valid_balanced_accuracy: 0.62906 | valid_accuracy: 0.62842 |  0:01:45s
epoch 6  | loss: 0.60124 | train_auc: 0.70953 | train_balanced_accuracy: 0.64133 | train_accuracy: 0.64086 | valid_auc: 0.70289 | valid_balanced_accuracy: 0.63393 | valid_accuracy: 0.63346 |  0:02:02s
epoch 7  | loss: 0.59954 | train_auc: 0.70614 | train_balanced_accuracy: 0.65275 | train_accuracy: 0.65345 | valid_auc: 0.70098 | valid_balanced_accuracy: 0.64682 | valid_accuracy: 0.64747 |  0:02:22s
epoch 8  | loss: 0.59939 | train_auc: 0.71328 | train_balanced_accuracy: 0.66032 | train_accuracy: 0.66108 | valid_auc: 0.70892 | valid_balanced_accuracy: 0.65669 | valid_accuracy: 0.65738 |  0:02:38s
epoch 9  | loss: 0.59737 | train_auc: 0.72146 | train_balanced_accuracy: 0.66305 | train_accuracy: 0.66364 | valid_auc: 0.71311 | valid_balanced_accuracy: 0.65892 | valid_accuracy: 0.65943 |  0:02:54s
epoch 10 | loss: 0.59459 | train_auc: 0.72733 | train_balanced_accuracy: 0.66543 | train_accuracy: 0.66604 | valid_auc: 0.72178 | valid_balanced_accuracy: 0.66184 | valid_accuracy: 0.66242 |  0:03:11s
epoch 11 | loss: 0.59239 | train_auc: 0.73193 | train_balanced_accuracy: 0.67009 | train_accuracy: 0.67088 | valid_auc: 0.72653 | valid_balanced_accuracy: 0.66357 | valid_accuracy: 0.66431 |  0:03:28s
epoch 12 | loss: 0.58621 | train_auc: 0.73702 | train_balanced_accuracy: 0.67453 | train_accuracy: 0.67509 | valid_auc: 0.72742 | valid_balanced_accuracy: 0.66764 | valid_accuracy: 0.66808 |  0:03:45s
epoch 13 | loss: 0.59414 | train_auc: 0.73964 | train_balanced_accuracy: 0.67497 | train_accuracy: 0.67572 | valid_auc: 0.73099 | valid_balanced_accuracy: 0.66267 | valid_accuracy: 0.66336 |  0:04:04s
epoch 14 | loss: 0.58397 | train_auc: 0.73749 | train_balanced_accuracy: 0.66532 | train_accuracy: 0.66568 | valid_auc: 0.73007 | valid_balanced_accuracy: 0.66098 | valid_accuracy: 0.66132 |  0:04:20s
epoch 15 | loss: 0.58255 | train_auc: 0.74575 | train_balanced_accuracy: 0.67709 | train_accuracy: 0.67772 | valid_auc: 0.73856 | valid_balanced_accuracy: 0.6648  | valid_accuracy: 0.66541 |  0:04:37s
epoch 16 | loss: 0.582   | train_auc: 0.7458  | train_balanced_accuracy: 0.6744  | train_accuracy: 0.67465 | valid_auc: 0.7376  | valid_balanced_accuracy: 0.66571 | valid_accuracy: 0.66588 |  0:04:54s
epoch 17 | loss: 0.5811  | train_auc: 0.75045 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67953 | valid_auc: 0.74063 | valid_balanced_accuracy: 0.67068 | valid_accuracy: 0.67123 |  0:05:12s
epoch 18 | loss: 0.57749 | train_auc: 0.75407 | train_balanced_accuracy: 0.68226 | train_accuracy: 0.68292 | valid_auc: 0.74133 | valid_balanced_accuracy: 0.66918 | valid_accuracy: 0.66981 |  0:05:30s
epoch 19 | loss: 0.57674 | train_auc: 0.75984 | train_balanced_accuracy: 0.68454 | train_accuracy: 0.68524 | valid_auc: 0.74696 | valid_balanced_accuracy: 0.67465 | valid_accuracy: 0.67532 |  0:05:47s
epoch 20 | loss: 0.57853 | train_auc: 0.75941 | train_balanced_accuracy: 0.68825 | train_accuracy: 0.68878 | valid_auc: 0.74263 | valid_balanced_accuracy: 0.67405 | valid_accuracy: 0.67454 |  0:06:06s
epoch 21 | loss: 0.57438 | train_auc: 0.75936 | train_balanced_accuracy: 0.68803 | train_accuracy: 0.68846 | valid_auc: 0.74351 | valid_balanced_accuracy: 0.67463 | valid_accuracy: 0.67501 |  0:06:24s
epoch 22 | loss: 0.57108 | train_auc: 0.76538 | train_balanced_accuracy: 0.69411 | train_accuracy: 0.69452 | valid_auc: 0.74643 | valid_balanced_accuracy: 0.67837 | valid_accuracy: 0.67879 |  0:06:42s
epoch 23 | loss: 0.57156 | train_auc: 0.76122 | train_balanced_accuracy: 0.6928  | train_accuracy: 0.69322 | valid_auc: 0.74424 | valid_balanced_accuracy: 0.67996 | valid_accuracy: 0.68036 |  0:06:59s
epoch 24 | loss: 0.57529 | train_auc: 0.76831 | train_balanced_accuracy: 0.69652 | train_accuracy: 0.69708 | valid_auc: 0.74943 | valid_balanced_accuracy: 0.67852 | valid_accuracy: 0.6791  |  0:07:16s
epoch 25 | loss: 0.57126 | train_auc: 0.75299 | train_balanced_accuracy: 0.68151 | train_accuracy: 0.6813  | valid_auc: 0.73354 | valid_balanced_accuracy: 0.66547 | valid_accuracy: 0.66525 |  0:07:35s
epoch 26 | loss: 0.57192 | train_auc: 0.76598 | train_balanced_accuracy: 0.70034 | train_accuracy: 0.70054 | valid_auc: 0.74398 | valid_balanced_accuracy: 0.68172 | valid_accuracy: 0.68193 |  0:07:52s
epoch 27 | loss: 0.57023 | train_auc: 0.7623  | train_balanced_accuracy: 0.70056 | train_accuracy: 0.70078 | valid_auc: 0.74511 | valid_balanced_accuracy: 0.68264 | valid_accuracy: 0.68288 |  0:08:10s
epoch 28 | loss: 0.56678 | train_auc: 0.76737 | train_balanced_accuracy: 0.70019 | train_accuracy: 0.70023 | valid_auc: 0.74997 | valid_balanced_accuracy: 0.69194 | valid_accuracy: 0.69201 |  0:08:28s
epoch 29 | loss: 0.56981 | train_auc: 0.77382 | train_balanced_accuracy: 0.70018 | train_accuracy: 0.69995 | valid_auc: 0.74589 | valid_balanced_accuracy: 0.67555 | valid_accuracy: 0.67532 |  0:08:46s
epoch 30 | loss: 0.56883 | train_auc: 0.76535 | train_balanced_accuracy: 0.69706 | train_accuracy: 0.6972  | valid_auc: 0.73977 | valid_balanced_accuracy: 0.67725 | valid_accuracy: 0.67737 |  0:09:04s
epoch 31 | loss: 0.56601 | train_auc: 0.71502 | train_balanced_accuracy: 0.65365 | train_accuracy: 0.65384 | valid_auc: 0.70272 | valid_balanced_accuracy: 0.64318 | valid_accuracy: 0.64337 |  0:09:21s
epoch 32 | loss: 0.56447 | train_auc: 0.74649 | train_balanced_accuracy: 0.67237 | train_accuracy: 0.67218 | valid_auc: 0.72693 | valid_balanced_accuracy: 0.66361 | valid_accuracy: 0.66336 |  0:09:40s
epoch 33 | loss: 0.56951 | train_auc: 0.76737 | train_balanced_accuracy: 0.69388 | train_accuracy: 0.69448 | valid_auc: 0.74321 | valid_balanced_accuracy: 0.67822 | valid_accuracy: 0.67879 |  0:09:58s
epoch 34 | loss: 0.56149 | train_auc: 0.74759 | train_balanced_accuracy: 0.67884 | train_accuracy: 0.67898 | valid_auc: 0.72592 | valid_balanced_accuracy: 0.65852 | valid_accuracy: 0.65864 |  0:10:15s
epoch 35 | loss: 0.56133 | train_auc: 0.74467 | train_balanced_accuracy: 0.67523 | train_accuracy: 0.6752  | valid_auc: 0.72907 | valid_balanced_accuracy: 0.66009 | valid_accuracy: 0.66006 |  0:10:34s
epoch 36 | loss: 0.55773 | train_auc: 0.75622 | train_balanced_accuracy: 0.68473 | train_accuracy: 0.68477 | valid_auc: 0.73567 | valid_balanced_accuracy: 0.66677 | valid_accuracy: 0.66682 |  0:10:50s
epoch 37 | loss: 0.55876 | train_auc: 0.77616 | train_balanced_accuracy: 0.70005 | train_accuracy: 0.70042 | valid_auc: 0.7443  | valid_balanced_accuracy: 0.67385 | valid_accuracy: 0.67422 |  0:11:09s
epoch 38 | loss: 0.55815 | train_auc: 0.78748 | train_balanced_accuracy: 0.71049 | train_accuracy: 0.71026 | valid_auc: 0.7521  | valid_balanced_accuracy: 0.68456 | valid_accuracy: 0.68429 |  0:11:26s
epoch 39 | loss: 0.55642 | train_auc: 0.79357 | train_balanced_accuracy: 0.71486 | train_accuracy: 0.71522 | valid_auc: 0.75595 | valid_balanced_accuracy: 0.6871  | valid_accuracy: 0.68744 |  0:11:44s
epoch 40 | loss: 0.55595 | train_auc: 0.79352 | train_balanced_accuracy: 0.71685 | train_accuracy: 0.71703 | valid_auc: 0.76188 | valid_balanced_accuracy: 0.69596 | valid_accuracy: 0.6961  |  0:12:02s
epoch 41 | loss: 0.55334 | train_auc: 0.78833 | train_balanced_accuracy: 0.71243 | train_accuracy: 0.7127  | valid_auc: 0.75507 | valid_balanced_accuracy: 0.68685 | valid_accuracy: 0.68713 |  0:12:17s
epoch 42 | loss: 0.55606 | train_auc: 0.78928 | train_balanced_accuracy: 0.71274 | train_accuracy: 0.71329 | valid_auc: 0.75297 | valid_balanced_accuracy: 0.68313 | valid_accuracy: 0.68366 |  0:12:33s
epoch 43 | loss: 0.55208 | train_auc: 0.7943  | train_balanced_accuracy: 0.71978 | train_accuracy: 0.71974 | valid_auc: 0.76003 | valid_balanced_accuracy: 0.68797 | valid_accuracy: 0.68791 |  0:12:51s
epoch 44 | loss: 0.55084 | train_auc: 0.79731 | train_balanced_accuracy: 0.72094 | train_accuracy: 0.72112 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.69295 | valid_accuracy: 0.69311 |  0:13:10s
epoch 45 | loss: 0.55075 | train_auc: 0.79458 | train_balanced_accuracy: 0.71615 | train_accuracy: 0.71667 | valid_auc: 0.75755 | valid_balanced_accuracy: 0.68458 | valid_accuracy: 0.68508 |  0:13:26s
epoch 46 | loss: 0.55159 | train_auc: 0.80011 | train_balanced_accuracy: 0.71979 | train_accuracy: 0.71986 | valid_auc: 0.7607  | valid_balanced_accuracy: 0.694   | valid_accuracy: 0.69405 |  0:13:43s
epoch 47 | loss: 0.55349 | train_auc: 0.79248 | train_balanced_accuracy: 0.71632 | train_accuracy: 0.71652 | valid_auc: 0.75471 | valid_balanced_accuracy: 0.68724 | valid_accuracy: 0.68744 |  0:14:01s
epoch 48 | loss: 0.55118 | train_auc: 0.79969 | train_balanced_accuracy: 0.72173 | train_accuracy: 0.72167 | valid_auc: 0.76333 | valid_balanced_accuracy: 0.69385 | valid_accuracy: 0.69374 |  0:14:19s
epoch 49 | loss: 0.54385 | train_auc: 0.79908 | train_balanced_accuracy: 0.72148 | train_accuracy: 0.72167 | valid_auc: 0.75762 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.68886 |  0:14:36s
epoch 50 | loss: 0.54675 | train_auc: 0.80243 | train_balanced_accuracy: 0.72381 | train_accuracy: 0.72403 | valid_auc: 0.76407 | valid_balanced_accuracy: 0.69353 | valid_accuracy: 0.69374 |  0:14:54s
epoch 51 | loss: 0.54729 | train_auc: 0.80545 | train_balanced_accuracy: 0.72684 | train_accuracy: 0.72722 | valid_auc: 0.75974 | valid_balanced_accuracy: 0.69055 | valid_accuracy: 0.6909  |  0:15:12s
epoch 52 | loss: 0.54372 | train_auc: 0.80337 | train_balanced_accuracy: 0.72353 | train_accuracy: 0.72364 | valid_auc: 0.76117 | valid_balanced_accuracy: 0.69591 | valid_accuracy: 0.69594 |  0:15:29s
epoch 53 | loss: 0.54739 | train_auc: 0.80623 | train_balanced_accuracy: 0.72789 | train_accuracy: 0.72828 | valid_auc: 0.76013 | valid_balanced_accuracy: 0.68896 | valid_accuracy: 0.68933 |  0:15:46s
epoch 54 | loss: 0.54886 | train_auc: 0.80313 | train_balanced_accuracy: 0.72213 | train_accuracy: 0.72214 | valid_auc: 0.76029 | valid_balanced_accuracy: 0.69034 | valid_accuracy: 0.69027 |  0:16:05s
epoch 55 | loss: 0.54772 | train_auc: 0.80525 | train_balanced_accuracy: 0.72452 | train_accuracy: 0.72474 | valid_auc: 0.76484 | valid_balanced_accuracy: 0.69449 | valid_accuracy: 0.69468 |  0:16:23s
epoch 56 | loss: 0.54357 | train_auc: 0.80629 | train_balanced_accuracy: 0.72504 | train_accuracy: 0.72509 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.69134 | valid_accuracy: 0.69138 |  0:16:41s
epoch 57 | loss: 0.54146 | train_auc: 0.79869 | train_balanced_accuracy: 0.71852 | train_accuracy: 0.71872 | valid_auc: 0.75494 | valid_balanced_accuracy: 0.68602 | valid_accuracy: 0.68618 |  0:16:59s
epoch 58 | loss: 0.54081 | train_auc: 0.79849 | train_balanced_accuracy: 0.7208  | train_accuracy: 0.72077 | valid_auc: 0.75234 | valid_balanced_accuracy: 0.68418 | valid_accuracy: 0.68414 |  0:17:16s
epoch 59 | loss: 0.5464  | train_auc: 0.80493 | train_balanced_accuracy: 0.72502 | train_accuracy: 0.72553 | valid_auc: 0.75962 | valid_balanced_accuracy: 0.68759 | valid_accuracy: 0.68807 |  0:17:33s
epoch 60 | loss: 0.54391 | train_auc: 0.80955 | train_balanced_accuracy: 0.72935 | train_accuracy: 0.7295  | valid_auc: 0.76493 | valid_balanced_accuracy: 0.69344 | valid_accuracy: 0.69358 |  0:17:50s

Early stopping occurred at epoch 60 with best_epoch = 40 and best_valid_accuracy = 0.6961
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 58/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=18.0min
[CV 1/5; 59/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7055  | train_auc: 0.58751 | train_balanced_accuracy: 0.53391 | train_accuracy: 0.53173 | valid_auc: 0.58419 | valid_balanced_accuracy: 0.53103 | valid_accuracy: 0.5288  |  0:00:16s
epoch 1  | loss: 0.64808 | train_auc: 0.62658 | train_balanced_accuracy: 0.54453 | train_accuracy: 0.54181 | valid_auc: 0.62268 | valid_balanced_accuracy: 0.53881 | valid_accuracy: 0.53604 |  0:00:34s
epoch 2  | loss: 0.63515 | train_auc: 0.64615 | train_balanced_accuracy: 0.57355 | train_accuracy: 0.57132 | valid_auc: 0.64257 | valid_balanced_accuracy: 0.57108 | valid_accuracy: 0.56878 |  0:00:51s
epoch 3  | loss: 0.62546 | train_auc: 0.65804 | train_balanced_accuracy: 0.57025 | train_accuracy: 0.56781 | valid_auc: 0.65563 | valid_balanced_accuracy: 0.56967 | valid_accuracy: 0.5672  |  0:01:10s
epoch 4  | loss: 0.61186 | train_auc: 0.66898 | train_balanced_accuracy: 0.60804 | train_accuracy: 0.60689 | valid_auc: 0.66963 | valid_balanced_accuracy: 0.60822 | valid_accuracy: 0.60702 |  0:01:28s
epoch 5  | loss: 0.6098  | train_auc: 0.66561 | train_balanced_accuracy: 0.6111  | train_accuracy: 0.61023 | valid_auc: 0.66596 | valid_balanced_accuracy: 0.61341 | valid_accuracy: 0.61253 |  0:01:46s
epoch 6  | loss: 0.6095  | train_auc: 0.66458 | train_balanced_accuracy: 0.61375 | train_accuracy: 0.61295 | valid_auc: 0.66652 | valid_balanced_accuracy: 0.61445 | valid_accuracy: 0.61363 |  0:02:03s
epoch 7  | loss: 0.6072  | train_auc: 0.68638 | train_balanced_accuracy: 0.61267 | train_accuracy: 0.61153 | valid_auc: 0.6851  | valid_balanced_accuracy: 0.61602 | valid_accuracy: 0.61489 |  0:02:21s
epoch 8  | loss: 0.59878 | train_auc: 0.68493 | train_balanced_accuracy: 0.62427 | train_accuracy: 0.62357 | valid_auc: 0.6837  | valid_balanced_accuracy: 0.62912 | valid_accuracy: 0.62842 |  0:02:40s
epoch 9  | loss: 0.6027  | train_auc: 0.6892  | train_balanced_accuracy: 0.62367 | train_accuracy: 0.6227  | valid_auc: 0.69154 | valid_balanced_accuracy: 0.63363 | valid_accuracy: 0.63267 |  0:02:56s
epoch 10 | loss: 0.59316 | train_auc: 0.69548 | train_balanced_accuracy: 0.6308  | train_accuracy: 0.6303  | valid_auc: 0.69498 | valid_balanced_accuracy: 0.63853 | valid_accuracy: 0.63802 |  0:03:11s
epoch 11 | loss: 0.59473 | train_auc: 0.71045 | train_balanced_accuracy: 0.6415  | train_accuracy: 0.64096 | valid_auc: 0.70747 | valid_balanced_accuracy: 0.64379 | valid_accuracy: 0.64322 |  0:03:31s
epoch 12 | loss: 0.59673 | train_auc: 0.71702 | train_balanced_accuracy: 0.64893 | train_accuracy: 0.64855 | valid_auc: 0.70874 | valid_balanced_accuracy: 0.64269 | valid_accuracy: 0.64227 |  0:03:50s
epoch 13 | loss: 0.59367 | train_auc: 0.71787 | train_balanced_accuracy: 0.65028 | train_accuracy: 0.65029 | valid_auc: 0.70823 | valid_balanced_accuracy: 0.64115 | valid_accuracy: 0.64117 |  0:04:08s
epoch 14 | loss: 0.58949 | train_auc: 0.71808 | train_balanced_accuracy: 0.65386 | train_accuracy: 0.65383 | valid_auc: 0.70901 | valid_balanced_accuracy: 0.6448  | valid_accuracy: 0.64479 |  0:04:25s
epoch 15 | loss: 0.58903 | train_auc: 0.72564 | train_balanced_accuracy: 0.65693 | train_accuracy: 0.65705 | valid_auc: 0.71837 | valid_balanced_accuracy: 0.64464 | valid_accuracy: 0.64479 |  0:04:43s
epoch 16 | loss: 0.58456 | train_auc: 0.72385 | train_balanced_accuracy: 0.65896 | train_accuracy: 0.6589  | valid_auc: 0.7131  | valid_balanced_accuracy: 0.6494  | valid_accuracy: 0.64935 |  0:05:02s
epoch 17 | loss: 0.58276 | train_auc: 0.73451 | train_balanced_accuracy: 0.67015 | train_accuracy: 0.67043 | valid_auc: 0.72185 | valid_balanced_accuracy: 0.65913 | valid_accuracy: 0.65943 |  0:05:18s
epoch 18 | loss: 0.58371 | train_auc: 0.74152 | train_balanced_accuracy: 0.66971 | train_accuracy: 0.67047 | valid_auc: 0.72843 | valid_balanced_accuracy: 0.66022 | valid_accuracy: 0.661   |  0:05:34s
epoch 19 | loss: 0.58284 | train_auc: 0.7463  | train_balanced_accuracy: 0.68001 | train_accuracy: 0.6805  | valid_auc: 0.7305  | valid_balanced_accuracy: 0.67122 | valid_accuracy: 0.6717  |  0:05:52s
epoch 20 | loss: 0.5833  | train_auc: 0.74914 | train_balanced_accuracy: 0.68256 | train_accuracy: 0.6831  | valid_auc: 0.7312  | valid_balanced_accuracy: 0.66789 | valid_accuracy: 0.6684  |  0:06:09s
epoch 21 | loss: 0.57726 | train_auc: 0.75285 | train_balanced_accuracy: 0.68344 | train_accuracy: 0.68397 | valid_auc: 0.73069 | valid_balanced_accuracy: 0.66897 | valid_accuracy: 0.6695  |  0:06:24s
epoch 22 | loss: 0.58121 | train_auc: 0.75607 | train_balanced_accuracy: 0.6912  | train_accuracy: 0.69152 | valid_auc: 0.73946 | valid_balanced_accuracy: 0.67676 | valid_accuracy: 0.67705 |  0:06:41s
epoch 23 | loss: 0.57564 | train_auc: 0.75327 | train_balanced_accuracy: 0.6892  | train_accuracy: 0.68967 | valid_auc: 0.73569 | valid_balanced_accuracy: 0.67154 | valid_accuracy: 0.67202 |  0:07:00s
epoch 24 | loss: 0.58181 | train_auc: 0.7601  | train_balanced_accuracy: 0.69092 | train_accuracy: 0.69128 | valid_auc: 0.73412 | valid_balanced_accuracy: 0.67262 | valid_accuracy: 0.67296 |  0:07:17s
epoch 25 | loss: 0.57347 | train_auc: 0.76795 | train_balanced_accuracy: 0.69881 | train_accuracy: 0.69876 | valid_auc: 0.74008 | valid_balanced_accuracy: 0.67228 | valid_accuracy: 0.67218 |  0:07:36s
epoch 26 | loss: 0.57244 | train_auc: 0.76999 | train_balanced_accuracy: 0.6996  | train_accuracy: 0.70002 | valid_auc: 0.73863 | valid_balanced_accuracy: 0.67492 | valid_accuracy: 0.67532 |  0:07:52s
epoch 27 | loss: 0.57422 | train_auc: 0.77139 | train_balanced_accuracy: 0.70072 | train_accuracy: 0.70104 | valid_auc: 0.74209 | valid_balanced_accuracy: 0.68079 | valid_accuracy: 0.68115 |  0:08:09s
epoch 28 | loss: 0.57517 | train_auc: 0.77041 | train_balanced_accuracy: 0.69898 | train_accuracy: 0.69923 | valid_auc: 0.7414  | valid_balanced_accuracy: 0.67868 | valid_accuracy: 0.67894 |  0:08:25s
epoch 29 | loss: 0.56857 | train_auc: 0.77868 | train_balanced_accuracy: 0.70472 | train_accuracy: 0.70498 | valid_auc: 0.74806 | valid_balanced_accuracy: 0.68138 | valid_accuracy: 0.68162 |  0:08:41s
epoch 30 | loss: 0.56888 | train_auc: 0.77671 | train_balanced_accuracy: 0.7049  | train_accuracy: 0.70517 | valid_auc: 0.7435  | valid_balanced_accuracy: 0.67884 | valid_accuracy: 0.6791  |  0:08:57s
epoch 31 | loss: 0.56707 | train_auc: 0.78054 | train_balanced_accuracy: 0.70825 | train_accuracy: 0.70824 | valid_auc: 0.74502 | valid_balanced_accuracy: 0.67758 | valid_accuracy: 0.67753 |  0:09:13s
epoch 32 | loss: 0.57148 | train_auc: 0.78222 | train_balanced_accuracy: 0.7086  | train_accuracy: 0.70895 | valid_auc: 0.74513 | valid_balanced_accuracy: 0.68124 | valid_accuracy: 0.68162 |  0:09:32s
epoch 33 | loss: 0.56894 | train_auc: 0.78367 | train_balanced_accuracy: 0.70896 | train_accuracy: 0.70915 | valid_auc: 0.74775 | valid_balanced_accuracy: 0.68127 | valid_accuracy: 0.68146 |  0:09:49s
epoch 34 | loss: 0.56846 | train_auc: 0.78361 | train_balanced_accuracy: 0.70778 | train_accuracy: 0.70809 | valid_auc: 0.75023 | valid_balanced_accuracy: 0.68178 | valid_accuracy: 0.68209 |  0:10:07s
epoch 35 | loss: 0.56803 | train_auc: 0.78424 | train_balanced_accuracy: 0.70741 | train_accuracy: 0.70777 | valid_auc: 0.74769 | valid_balanced_accuracy: 0.67984 | valid_accuracy: 0.6802  |  0:10:24s
epoch 36 | loss: 0.56884 | train_auc: 0.78689 | train_balanced_accuracy: 0.71113 | train_accuracy: 0.71104 | valid_auc: 0.74787 | valid_balanced_accuracy: 0.68344 | valid_accuracy: 0.68335 |  0:10:43s
epoch 37 | loss: 0.56439 | train_auc: 0.78444 | train_balanced_accuracy: 0.70573 | train_accuracy: 0.70624 | valid_auc: 0.74913 | valid_balanced_accuracy: 0.68333 | valid_accuracy: 0.68382 |  0:11:01s
epoch 38 | loss: 0.56511 | train_auc: 0.77577 | train_balanced_accuracy: 0.70215 | train_accuracy: 0.70214 | valid_auc: 0.73763 | valid_balanced_accuracy: 0.67235 | valid_accuracy: 0.67233 |  0:11:17s
epoch 39 | loss: 0.5627  | train_auc: 0.78653 | train_balanced_accuracy: 0.71088 | train_accuracy: 0.71119 | valid_auc: 0.74521 | valid_balanced_accuracy: 0.67894 | valid_accuracy: 0.67926 |  0:11:33s
epoch 40 | loss: 0.56191 | train_auc: 0.7886  | train_balanced_accuracy: 0.71243 | train_accuracy: 0.71265 | valid_auc: 0.74724 | valid_balanced_accuracy: 0.6784  | valid_accuracy: 0.67863 |  0:11:51s
epoch 41 | loss: 0.56372 | train_auc: 0.78603 | train_balanced_accuracy: 0.71151 | train_accuracy: 0.71167 | valid_auc: 0.74132 | valid_balanced_accuracy: 0.67531 | valid_accuracy: 0.67548 |  0:12:09s
epoch 42 | loss: 0.554   | train_auc: 0.78962 | train_balanced_accuracy: 0.71304 | train_accuracy: 0.71304 | valid_auc: 0.7435  | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.678   |  0:12:27s
epoch 43 | loss: 0.56356 | train_auc: 0.7932  | train_balanced_accuracy: 0.7137  | train_accuracy: 0.71391 | valid_auc: 0.75038 | valid_balanced_accuracy: 0.68655 | valid_accuracy: 0.68681 |  0:12:44s
epoch 44 | loss: 0.55745 | train_auc: 0.79364 | train_balanced_accuracy: 0.7136  | train_accuracy: 0.71399 | valid_auc: 0.75045 | valid_balanced_accuracy: 0.68137 | valid_accuracy: 0.68178 |  0:13:01s
epoch 45 | loss: 0.55763 | train_auc: 0.79168 | train_balanced_accuracy: 0.71407 | train_accuracy: 0.71438 | valid_auc: 0.74876 | valid_balanced_accuracy: 0.68729 | valid_accuracy: 0.6876  |  0:13:18s
epoch 46 | loss: 0.55573 | train_auc: 0.78953 | train_balanced_accuracy: 0.71197 | train_accuracy: 0.71186 | valid_auc: 0.74504 | valid_balanced_accuracy: 0.68129 | valid_accuracy: 0.68115 |  0:13:35s
epoch 47 | loss: 0.55823 | train_auc: 0.78813 | train_balanced_accuracy: 0.71241 | train_accuracy: 0.71273 | valid_auc: 0.74605 | valid_balanced_accuracy: 0.67941 | valid_accuracy: 0.67973 |  0:13:52s
epoch 48 | loss: 0.55151 | train_auc: 0.79713 | train_balanced_accuracy: 0.71819 | train_accuracy: 0.71808 | valid_auc: 0.75017 | valid_balanced_accuracy: 0.68128 | valid_accuracy: 0.68115 |  0:14:09s
epoch 49 | loss: 0.55439 | train_auc: 0.79289 | train_balanced_accuracy: 0.71672 | train_accuracy: 0.71666 | valid_auc: 0.75094 | valid_balanced_accuracy: 0.68725 | valid_accuracy: 0.68713 |  0:14:27s
epoch 50 | loss: 0.55145 | train_auc: 0.79629 | train_balanced_accuracy: 0.71871 | train_accuracy: 0.71887 | valid_auc: 0.75267 | valid_balanced_accuracy: 0.68112 | valid_accuracy: 0.6813  |  0:14:43s
epoch 51 | loss: 0.55281 | train_auc: 0.78886 | train_balanced_accuracy: 0.71204 | train_accuracy: 0.71222 | valid_auc: 0.75207 | valid_balanced_accuracy: 0.68369 | valid_accuracy: 0.68382 |  0:15:00s
epoch 52 | loss: 0.55127 | train_auc: 0.79964 | train_balanced_accuracy: 0.72231 | train_accuracy: 0.72233 | valid_auc: 0.75615 | valid_balanced_accuracy: 0.68929 | valid_accuracy: 0.68933 |  0:15:19s
epoch 53 | loss: 0.55062 | train_auc: 0.79745 | train_balanced_accuracy: 0.71979 | train_accuracy: 0.72001 | valid_auc: 0.75299 | valid_balanced_accuracy: 0.68721 | valid_accuracy: 0.68744 |  0:15:37s
epoch 54 | loss: 0.54688 | train_auc: 0.79863 | train_balanced_accuracy: 0.71956 | train_accuracy: 0.71965 | valid_auc: 0.75272 | valid_balanced_accuracy: 0.68588 | valid_accuracy: 0.68602 |  0:15:55s
epoch 55 | loss: 0.55525 | train_auc: 0.79979 | train_balanced_accuracy: 0.7202  | train_accuracy: 0.7206  | valid_auc: 0.74875 | valid_balanced_accuracy: 0.68117 | valid_accuracy: 0.68162 |  0:16:10s
epoch 56 | loss: 0.55042 | train_auc: 0.80335 | train_balanced_accuracy: 0.72352 | train_accuracy: 0.72363 | valid_auc: 0.7532  | valid_balanced_accuracy: 0.68547 | valid_accuracy: 0.68555 |  0:16:29s
epoch 57 | loss: 0.54548 | train_auc: 0.80175 | train_balanced_accuracy: 0.72381 | train_accuracy: 0.7239  | valid_auc: 0.75436 | valid_balanced_accuracy: 0.69209 | valid_accuracy: 0.69216 |  0:16:46s
epoch 58 | loss: 0.54738 | train_auc: 0.80009 | train_balanced_accuracy: 0.72189 | train_accuracy: 0.72201 | valid_auc: 0.74917 | valid_balanced_accuracy: 0.68088 | valid_accuracy: 0.68099 |  0:17:03s
epoch 59 | loss: 0.54785 | train_auc: 0.79915 | train_balanced_accuracy: 0.72147 | train_accuracy: 0.72162 | valid_auc: 0.74708 | valid_balanced_accuracy: 0.67831 | valid_accuracy: 0.67847 |  0:17:20s
epoch 60 | loss: 0.55015 | train_auc: 0.80482 | train_balanced_accuracy: 0.72708 | train_accuracy: 0.72717 | valid_auc: 0.75334 | valid_balanced_accuracy: 0.68889 | valid_accuracy: 0.68901 |  0:17:37s
epoch 61 | loss: 0.54763 | train_auc: 0.80646 | train_balanced_accuracy: 0.72478 | train_accuracy: 0.72512 | valid_auc: 0.75195 | valid_balanced_accuracy: 0.6853  | valid_accuracy: 0.68571 |  0:17:55s
epoch 62 | loss: 0.54548 | train_auc: 0.80743 | train_balanced_accuracy: 0.7265  | train_accuracy: 0.7265  | valid_auc: 0.75584 | valid_balanced_accuracy: 0.68962 | valid_accuracy: 0.68964 |  0:18:14s
epoch 63 | loss: 0.54606 | train_auc: 0.80849 | train_balanced_accuracy: 0.72704 | train_accuracy: 0.72733 | valid_auc: 0.75271 | valid_balanced_accuracy: 0.68543 | valid_accuracy: 0.68571 |  0:18:30s
epoch 64 | loss: 0.54021 | train_auc: 0.80806 | train_balanced_accuracy: 0.72661 | train_accuracy: 0.72678 | valid_auc: 0.75161 | valid_balanced_accuracy: 0.68256 | valid_accuracy: 0.68272 |  0:18:48s
epoch 65 | loss: 0.54208 | train_auc: 0.80768 | train_balanced_accuracy: 0.72644 | train_accuracy: 0.7267  | valid_auc: 0.75028 | valid_balanced_accuracy: 0.68179 | valid_accuracy: 0.68209 |  0:19:06s
epoch 66 | loss: 0.53909 | train_auc: 0.80948 | train_balanced_accuracy: 0.72434 | train_accuracy: 0.72418 | valid_auc: 0.75233 | valid_balanced_accuracy: 0.68384 | valid_accuracy: 0.68366 |  0:19:22s
epoch 67 | loss: 0.54053 | train_auc: 0.80802 | train_balanced_accuracy: 0.72826 | train_accuracy: 0.72859 | valid_auc: 0.74824 | valid_balanced_accuracy: 0.68271 | valid_accuracy: 0.68303 |  0:19:41s
epoch 68 | loss: 0.54724 | train_auc: 0.79926 | train_balanced_accuracy: 0.72065 | train_accuracy: 0.72087 | valid_auc: 0.74668 | valid_balanced_accuracy: 0.68471 | valid_accuracy: 0.68492 |  0:19:58s
epoch 69 | loss: 0.54471 | train_auc: 0.80601 | train_balanced_accuracy: 0.72652 | train_accuracy: 0.72678 | valid_auc: 0.74925 | valid_balanced_accuracy: 0.68593 | valid_accuracy: 0.68618 |  0:20:16s
epoch 70 | loss: 0.53675 | train_auc: 0.81006 | train_balanced_accuracy: 0.72731 | train_accuracy: 0.72741 | valid_auc: 0.74911 | valid_balanced_accuracy: 0.68311 | valid_accuracy: 0.68319 |  0:20:34s
epoch 71 | loss: 0.54214 | train_auc: 0.80773 | train_balanced_accuracy: 0.7278  | train_accuracy: 0.72792 | valid_auc: 0.75146 | valid_balanced_accuracy: 0.67933 | valid_accuracy: 0.67941 |  0:20:53s
epoch 72 | loss: 0.5403  | train_auc: 0.81156 | train_balanced_accuracy: 0.72937 | train_accuracy: 0.72957 | valid_auc: 0.75411 | valid_balanced_accuracy: 0.69102 | valid_accuracy: 0.69122 |  0:21:10s
epoch 73 | loss: 0.53644 | train_auc: 0.81396 | train_balanced_accuracy: 0.73248 | train_accuracy: 0.73248 | valid_auc: 0.75196 | valid_balanced_accuracy: 0.68453 | valid_accuracy: 0.68445 |  0:21:27s
epoch 74 | loss: 0.54088 | train_auc: 0.81387 | train_balanced_accuracy: 0.72991 | train_accuracy: 0.73024 | valid_auc: 0.75293 | valid_balanced_accuracy: 0.6838  | valid_accuracy: 0.68414 |  0:21:44s
epoch 75 | loss: 0.54104 | train_auc: 0.8137  | train_balanced_accuracy: 0.7298  | train_accuracy: 0.73016 | valid_auc: 0.74947 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68303 |  0:22:01s
epoch 76 | loss: 0.54289 | train_auc: 0.81009 | train_balanced_accuracy: 0.72731 | train_accuracy: 0.72725 | valid_auc: 0.75482 | valid_balanced_accuracy: 0.68754 | valid_accuracy: 0.68744 |  0:22:18s
epoch 77 | loss: 0.53729 | train_auc: 0.80513 | train_balanced_accuracy: 0.72466 | train_accuracy: 0.72469 | valid_auc: 0.75371 | valid_balanced_accuracy: 0.68806 | valid_accuracy: 0.68807 |  0:22:34s

Early stopping occurred at epoch 77 with best_epoch = 57 and best_valid_accuracy = 0.69216
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 59/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.698 total time=22.7min
[CV 2/5; 59/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71534 | train_auc: 0.60273 | train_balanced_accuracy: 0.58409 | train_accuracy: 0.58363 | valid_auc: 0.59922 | valid_balanced_accuracy: 0.58027 | valid_accuracy: 0.57979 |  0:00:17s
epoch 1  | loss: 0.65461 | train_auc: 0.62812 | train_balanced_accuracy: 0.5705  | train_accuracy: 0.5684  | valid_auc: 0.61902 | valid_balanced_accuracy: 0.56085 | valid_accuracy: 0.5587  |  0:00:35s
epoch 2  | loss: 0.63874 | train_auc: 0.64783 | train_balanced_accuracy: 0.51896 | train_accuracy: 0.51568 | valid_auc: 0.64476 | valid_balanced_accuracy: 0.51798 | valid_accuracy: 0.51464 |  0:00:53s
epoch 3  | loss: 0.62366 | train_auc: 0.66864 | train_balanced_accuracy: 0.52684 | train_accuracy: 0.52363 | valid_auc: 0.66803 | valid_balanced_accuracy: 0.52422 | valid_accuracy: 0.52093 |  0:01:10s
epoch 4  | loss: 0.61152 | train_auc: 0.68174 | train_balanced_accuracy: 0.56404 | train_accuracy: 0.56156 | valid_auc: 0.67692 | valid_balanced_accuracy: 0.55562 | valid_accuracy: 0.55304 |  0:01:27s
epoch 5  | loss: 0.61259 | train_auc: 0.68131 | train_balanced_accuracy: 0.60152 | train_accuracy: 0.59972 | valid_auc: 0.67487 | valid_balanced_accuracy: 0.5968  | valid_accuracy: 0.5949  |  0:01:45s
epoch 6  | loss: 0.60811 | train_auc: 0.6932  | train_balanced_accuracy: 0.60778 | train_accuracy: 0.6061  | valid_auc: 0.68548 | valid_balanced_accuracy: 0.6003  | valid_accuracy: 0.59852 |  0:02:02s
epoch 7  | loss: 0.60384 | train_auc: 0.6949  | train_balanced_accuracy: 0.62128 | train_accuracy: 0.61999 | valid_auc: 0.68666 | valid_balanced_accuracy: 0.61436 | valid_accuracy: 0.613   |  0:02:19s
epoch 8  | loss: 0.59463 | train_auc: 0.70495 | train_balanced_accuracy: 0.63757 | train_accuracy: 0.63695 | valid_auc: 0.69667 | valid_balanced_accuracy: 0.63212 | valid_accuracy: 0.63141 |  0:02:37s
epoch 9  | loss: 0.59906 | train_auc: 0.71566 | train_balanced_accuracy: 0.62437 | train_accuracy: 0.6229  | valid_auc: 0.70503 | valid_balanced_accuracy: 0.60904 | valid_accuracy: 0.60749 |  0:02:53s
epoch 10 | loss: 0.58637 | train_auc: 0.7213  | train_balanced_accuracy: 0.65437 | train_accuracy: 0.65383 | valid_auc: 0.71232 | valid_balanced_accuracy: 0.64803 | valid_accuracy: 0.64747 |  0:03:11s
epoch 11 | loss: 0.59098 | train_auc: 0.72347 | train_balanced_accuracy: 0.65155 | train_accuracy: 0.65076 | valid_auc: 0.71149 | valid_balanced_accuracy: 0.63618 | valid_accuracy: 0.63535 |  0:03:28s
epoch 12 | loss: 0.58974 | train_auc: 0.72015 | train_balanced_accuracy: 0.64859 | train_accuracy: 0.64789 | valid_auc: 0.70724 | valid_balanced_accuracy: 0.63456 | valid_accuracy: 0.63377 |  0:03:45s
epoch 13 | loss: 0.5858  | train_auc: 0.73049 | train_balanced_accuracy: 0.66397 | train_accuracy: 0.66351 | valid_auc: 0.71974 | valid_balanced_accuracy: 0.65304 | valid_accuracy: 0.6525  |  0:04:02s
epoch 14 | loss: 0.58641 | train_auc: 0.73124 | train_balanced_accuracy: 0.66541 | train_accuracy: 0.66504 | valid_auc: 0.71262 | valid_balanced_accuracy: 0.64695 | valid_accuracy: 0.64652 |  0:04:18s
epoch 15 | loss: 0.58421 | train_auc: 0.73764 | train_balanced_accuracy: 0.67171 | train_accuracy: 0.67138 | valid_auc: 0.72215 | valid_balanced_accuracy: 0.66093 | valid_accuracy: 0.66053 |  0:04:36s
epoch 16 | loss: 0.58193 | train_auc: 0.74589 | train_balanced_accuracy: 0.67748 | train_accuracy: 0.67716 | valid_auc: 0.73069 | valid_balanced_accuracy: 0.66497 | valid_accuracy: 0.66462 |  0:04:53s
epoch 17 | loss: 0.5802  | train_auc: 0.74636 | train_balanced_accuracy: 0.67988 | train_accuracy: 0.6798  | valid_auc: 0.72677 | valid_balanced_accuracy: 0.66206 | valid_accuracy: 0.66195 |  0:05:14s
epoch 18 | loss: 0.57903 | train_auc: 0.75433 | train_balanced_accuracy: 0.69422 | train_accuracy: 0.69471 | valid_auc: 0.73838 | valid_balanced_accuracy: 0.67992 | valid_accuracy: 0.68036 |  0:05:31s
epoch 19 | loss: 0.57942 | train_auc: 0.76341 | train_balanced_accuracy: 0.69908 | train_accuracy: 0.69935 | valid_auc: 0.74263 | valid_balanced_accuracy: 0.67872 | valid_accuracy: 0.67894 |  0:05:49s
epoch 20 | loss: 0.57727 | train_auc: 0.76591 | train_balanced_accuracy: 0.7025  | train_accuracy: 0.70289 | valid_auc: 0.74684 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68587 |  0:06:05s
epoch 21 | loss: 0.57531 | train_auc: 0.76755 | train_balanced_accuracy: 0.70209 | train_accuracy: 0.70254 | valid_auc: 0.74557 | valid_balanced_accuracy: 0.68042 | valid_accuracy: 0.68083 |  0:06:23s
epoch 22 | loss: 0.58035 | train_auc: 0.77239 | train_balanced_accuracy: 0.70285 | train_accuracy: 0.70313 | valid_auc: 0.74775 | valid_balanced_accuracy: 0.68109 | valid_accuracy: 0.6813  |  0:06:41s
epoch 23 | loss: 0.5768  | train_auc: 0.77385 | train_balanced_accuracy: 0.7064  | train_accuracy: 0.70675 | valid_auc: 0.7497  | valid_balanced_accuracy: 0.6862  | valid_accuracy: 0.6865  |  0:06:57s
epoch 24 | loss: 0.57707 | train_auc: 0.77643 | train_balanced_accuracy: 0.70794 | train_accuracy: 0.70824 | valid_auc: 0.75277 | valid_balanced_accuracy: 0.68606 | valid_accuracy: 0.68634 |  0:07:15s
epoch 25 | loss: 0.56803 | train_auc: 0.77864 | train_balanced_accuracy: 0.70974 | train_accuracy: 0.70982 | valid_auc: 0.75273 | valid_balanced_accuracy: 0.6879  | valid_accuracy: 0.68791 |  0:07:32s
epoch 26 | loss: 0.56994 | train_auc: 0.77785 | train_balanced_accuracy: 0.7069  | train_accuracy: 0.70706 | valid_auc: 0.75347 | valid_balanced_accuracy: 0.68655 | valid_accuracy: 0.68665 |  0:07:49s
epoch 27 | loss: 0.57244 | train_auc: 0.78059 | train_balanced_accuracy: 0.70977 | train_accuracy: 0.71001 | valid_auc: 0.75229 | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68335 |  0:08:05s
epoch 28 | loss: 0.56764 | train_auc: 0.78309 | train_balanced_accuracy: 0.71358 | train_accuracy: 0.71383 | valid_auc: 0.75648 | valid_balanced_accuracy: 0.68758 | valid_accuracy: 0.68776 |  0:08:24s
epoch 29 | loss: 0.56613 | train_auc: 0.78327 | train_balanced_accuracy: 0.71148 | train_accuracy: 0.71167 | valid_auc: 0.7554  | valid_balanced_accuracy: 0.6884  | valid_accuracy: 0.68854 |  0:08:40s
epoch 30 | loss: 0.56344 | train_auc: 0.78518 | train_balanced_accuracy: 0.71397 | train_accuracy: 0.71434 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69449 | valid_accuracy: 0.69484 |  0:08:56s
epoch 31 | loss: 0.56735 | train_auc: 0.7507  | train_balanced_accuracy: 0.69277 | train_accuracy: 0.69282 | valid_auc: 0.73109 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.6728  |  0:09:14s
epoch 32 | loss: 0.56581 | train_auc: 0.73431 | train_balanced_accuracy: 0.68302 | train_accuracy: 0.68326 | valid_auc: 0.72215 | valid_balanced_accuracy: 0.67529 | valid_accuracy: 0.67548 |  0:09:29s
epoch 33 | loss: 0.5625  | train_auc: 0.75013 | train_balanced_accuracy: 0.68875 | train_accuracy: 0.68892 | valid_auc: 0.72956 | valid_balanced_accuracy: 0.67727 | valid_accuracy: 0.67737 |  0:09:46s
epoch 34 | loss: 0.56187 | train_auc: 0.75852 | train_balanced_accuracy: 0.69767 | train_accuracy: 0.69766 | valid_auc: 0.7301  | valid_balanced_accuracy: 0.67081 | valid_accuracy: 0.67076 |  0:10:03s
epoch 35 | loss: 0.56252 | train_auc: 0.76371 | train_balanced_accuracy: 0.6992  | train_accuracy: 0.69959 | valid_auc: 0.73888 | valid_balanced_accuracy: 0.68019 | valid_accuracy: 0.68052 |  0:10:20s
epoch 36 | loss: 0.56004 | train_auc: 0.78112 | train_balanced_accuracy: 0.71088 | train_accuracy: 0.71092 | valid_auc: 0.74932 | valid_balanced_accuracy: 0.68244 | valid_accuracy: 0.6824  |  0:10:37s
epoch 37 | loss: 0.56501 | train_auc: 0.78965 | train_balanced_accuracy: 0.71794 | train_accuracy: 0.7182  | valid_auc: 0.75679 | valid_balanced_accuracy: 0.69496 | valid_accuracy: 0.69515 |  0:10:54s
epoch 38 | loss: 0.55846 | train_auc: 0.7849  | train_balanced_accuracy: 0.71147 | train_accuracy: 0.71131 | valid_auc: 0.75275 | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68634 |  0:11:12s
epoch 39 | loss: 0.56005 | train_auc: 0.77731 | train_balanced_accuracy: 0.70943 | train_accuracy: 0.70978 | valid_auc: 0.7451  | valid_balanced_accuracy: 0.68228 | valid_accuracy: 0.68256 |  0:11:29s
epoch 40 | loss: 0.56185 | train_auc: 0.78189 | train_balanced_accuracy: 0.71156 | train_accuracy: 0.71155 | valid_auc: 0.74999 | valid_balanced_accuracy: 0.68454 | valid_accuracy: 0.68445 |  0:11:46s
epoch 41 | loss: 0.55678 | train_auc: 0.774   | train_balanced_accuracy: 0.70524 | train_accuracy: 0.70533 | valid_auc: 0.74447 | valid_balanced_accuracy: 0.68582 | valid_accuracy: 0.68587 |  0:12:04s
epoch 42 | loss: 0.553   | train_auc: 0.77039 | train_balanced_accuracy: 0.70444 | train_accuracy: 0.70466 | valid_auc: 0.74025 | valid_balanced_accuracy: 0.675   | valid_accuracy: 0.67517 |  0:12:22s
epoch 43 | loss: 0.56135 | train_auc: 0.78266 | train_balanced_accuracy: 0.71645 | train_accuracy: 0.7167  | valid_auc: 0.75081 | valid_balanced_accuracy: 0.68946 | valid_accuracy: 0.68964 |  0:12:39s
epoch 44 | loss: 0.55621 | train_auc: 0.7836  | train_balanced_accuracy: 0.71377 | train_accuracy: 0.71391 | valid_auc: 0.75266 | valid_balanced_accuracy: 0.68673 | valid_accuracy: 0.68681 |  0:12:58s
epoch 45 | loss: 0.55079 | train_auc: 0.78823 | train_balanced_accuracy: 0.7144  | train_accuracy: 0.71477 | valid_auc: 0.75105 | valid_balanced_accuracy: 0.68916 | valid_accuracy: 0.68949 |  0:13:14s
epoch 46 | loss: 0.55358 | train_auc: 0.79799 | train_balanced_accuracy: 0.72311 | train_accuracy: 0.72316 | valid_auc: 0.75933 | valid_balanced_accuracy: 0.6944  | valid_accuracy: 0.69437 |  0:13:32s
epoch 47 | loss: 0.55479 | train_auc: 0.79594 | train_balanced_accuracy: 0.71947 | train_accuracy: 0.71985 | valid_auc: 0.7576  | valid_balanced_accuracy: 0.68945 | valid_accuracy: 0.6898  |  0:13:49s
epoch 48 | loss: 0.54904 | train_auc: 0.79791 | train_balanced_accuracy: 0.72197 | train_accuracy: 0.72205 | valid_auc: 0.75571 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69043 |  0:14:05s
epoch 49 | loss: 0.55032 | train_auc: 0.79381 | train_balanced_accuracy: 0.7206  | train_accuracy: 0.72072 | valid_auc: 0.75366 | valid_balanced_accuracy: 0.69035 | valid_accuracy: 0.69043 |  0:14:24s
epoch 50 | loss: 0.54979 | train_auc: 0.79661 | train_balanced_accuracy: 0.7214  | train_accuracy: 0.72158 | valid_auc: 0.75711 | valid_balanced_accuracy: 0.69309 | valid_accuracy: 0.69326 |  0:14:42s
epoch 51 | loss: 0.55331 | train_auc: 0.78989 | train_balanced_accuracy: 0.71988 | train_accuracy: 0.72005 | valid_auc: 0.75708 | valid_balanced_accuracy: 0.69138 | valid_accuracy: 0.69153 |  0:14:59s
epoch 52 | loss: 0.54773 | train_auc: 0.80419 | train_balanced_accuracy: 0.7291  | train_accuracy: 0.72922 | valid_auc: 0.75962 | valid_balanced_accuracy: 0.69399 | valid_accuracy: 0.69405 |  0:15:17s
epoch 53 | loss: 0.54878 | train_auc: 0.80425 | train_balanced_accuracy: 0.72726 | train_accuracy: 0.72752 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.6905  | valid_accuracy: 0.69075 |  0:15:35s
epoch 54 | loss: 0.55097 | train_auc: 0.79598 | train_balanced_accuracy: 0.71894 | train_accuracy: 0.71922 | valid_auc: 0.7591  | valid_balanced_accuracy: 0.69428 | valid_accuracy: 0.69452 |  0:15:51s
epoch 55 | loss: 0.55311 | train_auc: 0.80075 | train_balanced_accuracy: 0.72438 | train_accuracy: 0.72477 | valid_auc: 0.7552  | valid_balanced_accuracy: 0.68926 | valid_accuracy: 0.68964 |  0:16:08s
epoch 56 | loss: 0.54549 | train_auc: 0.77804 | train_balanced_accuracy: 0.70059 | train_accuracy: 0.70112 | valid_auc: 0.74654 | valid_balanced_accuracy: 0.67987 | valid_accuracy: 0.68036 |  0:16:27s
epoch 57 | loss: 0.54712 | train_auc: 0.78416 | train_balanced_accuracy: 0.71029 | train_accuracy: 0.71045 | valid_auc: 0.74497 | valid_balanced_accuracy: 0.67835 | valid_accuracy: 0.67847 |  0:16:44s

Early stopping occurred at epoch 57 with best_epoch = 37 and best_valid_accuracy = 0.69515
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 59/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.687 total time=16.9min
[CV 3/5; 59/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71098 | train_auc: 0.57352 | train_balanced_accuracy: 0.50007 | train_accuracy: 0.4965  | valid_auc: 0.57883 | valid_balanced_accuracy: 0.50093 | valid_accuracy: 0.49732 |  0:00:16s
epoch 1  | loss: 0.64651 | train_auc: 0.63457 | train_balanced_accuracy: 0.50721 | train_accuracy: 0.5037  | valid_auc: 0.63252 | valid_balanced_accuracy: 0.50779 | valid_accuracy: 0.50425 |  0:00:33s
epoch 2  | loss: 0.62747 | train_auc: 0.64988 | train_balanced_accuracy: 0.57851 | train_accuracy: 0.57609 | valid_auc: 0.64696 | valid_balanced_accuracy: 0.57827 | valid_accuracy: 0.57586 |  0:00:49s
epoch 3  | loss: 0.621   | train_auc: 0.66434 | train_balanced_accuracy: 0.55863 | train_accuracy: 0.55583 | valid_auc: 0.66492 | valid_balanced_accuracy: 0.55382 | valid_accuracy: 0.55099 |  0:01:05s
epoch 4  | loss: 0.61275 | train_auc: 0.66965 | train_balanced_accuracy: 0.57571 | train_accuracy: 0.57326 | valid_auc: 0.66678 | valid_balanced_accuracy: 0.56999 | valid_accuracy: 0.56752 |  0:01:22s
epoch 5  | loss: 0.60998 | train_auc: 0.66964 | train_balanced_accuracy: 0.59576 | train_accuracy: 0.59376 | valid_auc: 0.66024 | valid_balanced_accuracy: 0.59329 | valid_accuracy: 0.59128 |  0:01:40s
epoch 6  | loss: 0.60688 | train_auc: 0.68804 | train_balanced_accuracy: 0.61138 | train_accuracy: 0.60969 | valid_auc: 0.68178 | valid_balanced_accuracy: 0.61058 | valid_accuracy: 0.60891 |  0:01:57s
epoch 7  | loss: 0.60868 | train_auc: 0.69273 | train_balanced_accuracy: 0.61675 | train_accuracy: 0.6152  | valid_auc: 0.68676 | valid_balanced_accuracy: 0.61375 | valid_accuracy: 0.61221 |  0:02:15s
epoch 8  | loss: 0.59802 | train_auc: 0.70156 | train_balanced_accuracy: 0.63835 | train_accuracy: 0.63739 | valid_auc: 0.69718 | valid_balanced_accuracy: 0.63536 | valid_accuracy: 0.6344  |  0:02:33s
epoch 9  | loss: 0.59662 | train_auc: 0.70753 | train_balanced_accuracy: 0.64278 | train_accuracy: 0.6418  | valid_auc: 0.70115 | valid_balanced_accuracy: 0.63398 | valid_accuracy: 0.63299 |  0:02:52s
epoch 10 | loss: 0.58732 | train_auc: 0.71844 | train_balanced_accuracy: 0.64399 | train_accuracy: 0.64294 | valid_auc: 0.71059 | valid_balanced_accuracy: 0.63673 | valid_accuracy: 0.63566 |  0:03:09s
epoch 11 | loss: 0.59128 | train_auc: 0.72515 | train_balanced_accuracy: 0.6559  | train_accuracy: 0.65534 | valid_auc: 0.71912 | valid_balanced_accuracy: 0.64724 | valid_accuracy: 0.64668 |  0:03:25s
epoch 12 | loss: 0.59102 | train_auc: 0.72972 | train_balanced_accuracy: 0.66484 | train_accuracy: 0.66466 | valid_auc: 0.72415 | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.66289 |  0:03:43s
epoch 13 | loss: 0.58692 | train_auc: 0.73301 | train_balanced_accuracy: 0.66635 | train_accuracy: 0.666   | valid_auc: 0.72817 | valid_balanced_accuracy: 0.66087 | valid_accuracy: 0.66053 |  0:04:01s
epoch 14 | loss: 0.58478 | train_auc: 0.73951 | train_balanced_accuracy: 0.67661 | train_accuracy: 0.67658 | valid_auc: 0.73487 | valid_balanced_accuracy: 0.67535 | valid_accuracy: 0.67532 |  0:04:18s
epoch 15 | loss: 0.58642 | train_auc: 0.74377 | train_balanced_accuracy: 0.67655 | train_accuracy: 0.6765  | valid_auc: 0.73758 | valid_balanced_accuracy: 0.67319 | valid_accuracy: 0.67312 |  0:04:35s
epoch 16 | loss: 0.57944 | train_auc: 0.74627 | train_balanced_accuracy: 0.67761 | train_accuracy: 0.67737 | valid_auc: 0.74144 | valid_balanced_accuracy: 0.67607 | valid_accuracy: 0.67579 |  0:04:54s
epoch 17 | loss: 0.5769  | train_auc: 0.74535 | train_balanced_accuracy: 0.67985 | train_accuracy: 0.68    | valid_auc: 0.73857 | valid_balanced_accuracy: 0.67568 | valid_accuracy: 0.67579 |  0:05:15s
epoch 18 | loss: 0.58381 | train_auc: 0.7533  | train_balanced_accuracy: 0.68515 | train_accuracy: 0.68571 | valid_auc: 0.74511 | valid_balanced_accuracy: 0.68532 | valid_accuracy: 0.68587 |  0:05:33s
epoch 19 | loss: 0.57961 | train_auc: 0.75486 | train_balanced_accuracy: 0.68522 | train_accuracy: 0.68559 | valid_auc: 0.74497 | valid_balanced_accuracy: 0.68081 | valid_accuracy: 0.68115 |  0:05:49s
epoch 20 | loss: 0.58097 | train_auc: 0.75877 | train_balanced_accuracy: 0.68931 | train_accuracy: 0.68964 | valid_auc: 0.74813 | valid_balanced_accuracy: 0.68667 | valid_accuracy: 0.68697 |  0:06:07s
epoch 21 | loss: 0.57412 | train_auc: 0.76255 | train_balanced_accuracy: 0.69309 | train_accuracy: 0.69346 | valid_auc: 0.75011 | valid_balanced_accuracy: 0.68428 | valid_accuracy: 0.68461 |  0:06:27s
epoch 22 | loss: 0.58107 | train_auc: 0.76398 | train_balanced_accuracy: 0.69521 | train_accuracy: 0.69582 | valid_auc: 0.75168 | valid_balanced_accuracy: 0.68293 | valid_accuracy: 0.68351 |  0:06:42s
epoch 23 | loss: 0.57866 | train_auc: 0.76716 | train_balanced_accuracy: 0.69891 | train_accuracy: 0.69924 | valid_auc: 0.75556 | valid_balanced_accuracy: 0.69017 | valid_accuracy: 0.69043 |  0:06:58s
epoch 24 | loss: 0.57942 | train_auc: 0.76453 | train_balanced_accuracy: 0.69485 | train_accuracy: 0.69515 | valid_auc: 0.74936 | valid_balanced_accuracy: 0.68715 | valid_accuracy: 0.68744 |  0:07:14s
epoch 25 | loss: 0.57317 | train_auc: 0.76565 | train_balanced_accuracy: 0.69436 | train_accuracy: 0.69444 | valid_auc: 0.75059 | valid_balanced_accuracy: 0.68281 | valid_accuracy: 0.68288 |  0:07:31s
epoch 26 | loss: 0.5737  | train_auc: 0.75749 | train_balanced_accuracy: 0.68928 | train_accuracy: 0.68976 | valid_auc: 0.74463 | valid_balanced_accuracy: 0.68099 | valid_accuracy: 0.68146 |  0:07:47s
epoch 27 | loss: 0.57197 | train_auc: 0.76329 | train_balanced_accuracy: 0.70042 | train_accuracy: 0.70074 | valid_auc: 0.74871 | valid_balanced_accuracy: 0.68322 | valid_accuracy: 0.68351 |  0:08:05s
epoch 28 | loss: 0.56817 | train_auc: 0.768   | train_balanced_accuracy: 0.70141 | train_accuracy: 0.70172 | valid_auc: 0.74974 | valid_balanced_accuracy: 0.68367 | valid_accuracy: 0.68398 |  0:08:23s
epoch 29 | loss: 0.56809 | train_auc: 0.77409 | train_balanced_accuracy: 0.70264 | train_accuracy: 0.7029  | valid_auc: 0.7547  | valid_balanced_accuracy: 0.69242 | valid_accuracy: 0.69263 |  0:08:41s
epoch 30 | loss: 0.56786 | train_auc: 0.77893 | train_balanced_accuracy: 0.7085  | train_accuracy: 0.70873 | valid_auc: 0.7547  | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.6876  |  0:08:58s
epoch 31 | loss: 0.57039 | train_auc: 0.77644 | train_balanced_accuracy: 0.70225 | train_accuracy: 0.70279 | valid_auc: 0.75462 | valid_balanced_accuracy: 0.69233 | valid_accuracy: 0.69279 |  0:09:16s
epoch 32 | loss: 0.5636  | train_auc: 0.77805 | train_balanced_accuracy: 0.70719 | train_accuracy: 0.70723 | valid_auc: 0.75272 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.6898  |  0:09:34s
epoch 33 | loss: 0.56607 | train_auc: 0.77866 | train_balanced_accuracy: 0.70494 | train_accuracy: 0.70534 | valid_auc: 0.75302 | valid_balanced_accuracy: 0.6871  | valid_accuracy: 0.68744 |  0:09:53s
epoch 34 | loss: 0.56563 | train_auc: 0.78402 | train_balanced_accuracy: 0.70945 | train_accuracy: 0.70967 | valid_auc: 0.75617 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68854 |  0:10:10s
epoch 35 | loss: 0.56361 | train_auc: 0.7848  | train_balanced_accuracy: 0.71219 | train_accuracy: 0.71266 | valid_auc: 0.75636 | valid_balanced_accuracy: 0.69663 | valid_accuracy: 0.69704 |  0:10:27s
epoch 36 | loss: 0.56131 | train_auc: 0.79    | train_balanced_accuracy: 0.71559 | train_accuracy: 0.71565 | valid_auc: 0.76282 | valid_balanced_accuracy: 0.69752 | valid_accuracy: 0.69751 |  0:10:43s
epoch 37 | loss: 0.56403 | train_auc: 0.78883 | train_balanced_accuracy: 0.71517 | train_accuracy: 0.71545 | valid_auc: 0.7583  | valid_balanced_accuracy: 0.69166 | valid_accuracy: 0.69185 |  0:10:59s
epoch 38 | loss: 0.56049 | train_auc: 0.78984 | train_balanced_accuracy: 0.71242 | train_accuracy: 0.71223 | valid_auc: 0.75792 | valid_balanced_accuracy: 0.6874  | valid_accuracy: 0.68713 |  0:11:16s
epoch 39 | loss: 0.55754 | train_auc: 0.78723 | train_balanced_accuracy: 0.71165 | train_accuracy: 0.71199 | valid_auc: 0.75729 | valid_balanced_accuracy: 0.68983 | valid_accuracy: 0.69012 |  0:11:33s
epoch 40 | loss: 0.5608  | train_auc: 0.78939 | train_balanced_accuracy: 0.71314 | train_accuracy: 0.71345 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.69206 | valid_accuracy: 0.69232 |  0:11:49s
epoch 41 | loss: 0.56069 | train_auc: 0.79348 | train_balanced_accuracy: 0.71777 | train_accuracy: 0.71797 | valid_auc: 0.75847 | valid_balanced_accuracy: 0.69298 | valid_accuracy: 0.69311 |  0:12:06s
epoch 42 | loss: 0.55117 | train_auc: 0.78922 | train_balanced_accuracy: 0.71443 | train_accuracy: 0.71451 | valid_auc: 0.75422 | valid_balanced_accuracy: 0.68629 | valid_accuracy: 0.68634 |  0:12:25s
epoch 43 | loss: 0.56091 | train_auc: 0.79081 | train_balanced_accuracy: 0.71466 | train_accuracy: 0.71467 | valid_auc: 0.75391 | valid_balanced_accuracy: 0.68826 | valid_accuracy: 0.68823 |  0:12:42s
epoch 44 | loss: 0.56099 | train_auc: 0.79322 | train_balanced_accuracy: 0.71782 | train_accuracy: 0.71778 | valid_auc: 0.75443 | valid_balanced_accuracy: 0.68502 | valid_accuracy: 0.68492 |  0:12:59s
epoch 45 | loss: 0.55707 | train_auc: 0.7967  | train_balanced_accuracy: 0.72046 | train_accuracy: 0.72073 | valid_auc: 0.76101 | valid_balanced_accuracy: 0.69556 | valid_accuracy: 0.69578 |  0:13:17s
epoch 46 | loss: 0.55781 | train_auc: 0.79599 | train_balanced_accuracy: 0.71965 | train_accuracy: 0.71955 | valid_auc: 0.75673 | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68634 |  0:13:36s
epoch 47 | loss: 0.55675 | train_auc: 0.79088 | train_balanced_accuracy: 0.71765 | train_accuracy: 0.71782 | valid_auc: 0.75441 | valid_balanced_accuracy: 0.68811 | valid_accuracy: 0.68823 |  0:13:54s
epoch 48 | loss: 0.55788 | train_auc: 0.79656 | train_balanced_accuracy: 0.72009 | train_accuracy: 0.71982 | valid_auc: 0.75561 | valid_balanced_accuracy: 0.6832  | valid_accuracy: 0.68288 |  0:14:13s
epoch 49 | loss: 0.55134 | train_auc: 0.79476 | train_balanced_accuracy: 0.72023 | train_accuracy: 0.72045 | valid_auc: 0.75616 | valid_balanced_accuracy: 0.69039 | valid_accuracy: 0.69059 |  0:14:29s
epoch 50 | loss: 0.55383 | train_auc: 0.79367 | train_balanced_accuracy: 0.71905 | train_accuracy: 0.71915 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.68945 | valid_accuracy: 0.68949 |  0:14:48s
epoch 51 | loss: 0.5495  | train_auc: 0.80093 | train_balanced_accuracy: 0.72417 | train_accuracy: 0.72443 | valid_auc: 0.76152 | valid_balanced_accuracy: 0.69825 | valid_accuracy: 0.69846 |  0:15:04s
epoch 52 | loss: 0.54533 | train_auc: 0.80208 | train_balanced_accuracy: 0.72652 | train_accuracy: 0.72659 | valid_auc: 0.75655 | valid_balanced_accuracy: 0.6862  | valid_accuracy: 0.68618 |  0:15:22s
epoch 53 | loss: 0.54602 | train_auc: 0.80284 | train_balanced_accuracy: 0.72693 | train_accuracy: 0.72698 | valid_auc: 0.76046 | valid_balanced_accuracy: 0.69298 | valid_accuracy: 0.69295 |  0:15:40s
epoch 54 | loss: 0.55257 | train_auc: 0.80387 | train_balanced_accuracy: 0.72487 | train_accuracy: 0.72498 | valid_auc: 0.76203 | valid_balanced_accuracy: 0.70014 | valid_accuracy: 0.70019 |  0:15:56s
epoch 55 | loss: 0.54775 | train_auc: 0.80313 | train_balanced_accuracy: 0.72639 | train_accuracy: 0.72627 | valid_auc: 0.75978 | valid_balanced_accuracy: 0.68948 | valid_accuracy: 0.68933 |  0:16:12s
epoch 56 | loss: 0.54546 | train_auc: 0.80094 | train_balanced_accuracy: 0.72333 | train_accuracy: 0.72317 | valid_auc: 0.76114 | valid_balanced_accuracy: 0.68607 | valid_accuracy: 0.68587 |  0:16:30s
epoch 57 | loss: 0.54697 | train_auc: 0.79949 | train_balanced_accuracy: 0.72211 | train_accuracy: 0.72187 | valid_auc: 0.75564 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68807 |  0:16:47s
epoch 58 | loss: 0.54702 | train_auc: 0.80264 | train_balanced_accuracy: 0.7255  | train_accuracy: 0.72549 | valid_auc: 0.75783 | valid_balanced_accuracy: 0.69172 | valid_accuracy: 0.69169 |  0:17:05s
epoch 59 | loss: 0.54217 | train_auc: 0.80086 | train_balanced_accuracy: 0.72262 | train_accuracy: 0.72254 | valid_auc: 0.75765 | valid_balanced_accuracy: 0.68867 | valid_accuracy: 0.68854 |  0:17:20s
epoch 60 | loss: 0.54835 | train_auc: 0.80535 | train_balanced_accuracy: 0.72451 | train_accuracy: 0.72427 | valid_auc: 0.75741 | valid_balanced_accuracy: 0.69199 | valid_accuracy: 0.69169 |  0:17:38s
epoch 61 | loss: 0.54628 | train_auc: 0.8073  | train_balanced_accuracy: 0.72667 | train_accuracy: 0.7269  | valid_auc: 0.76021 | valid_balanced_accuracy: 0.68963 | valid_accuracy: 0.6898  |  0:17:54s
epoch 62 | loss: 0.54192 | train_auc: 0.81186 | train_balanced_accuracy: 0.732   | train_accuracy: 0.73198 | valid_auc: 0.76367 | valid_balanced_accuracy: 0.69113 | valid_accuracy: 0.69106 |  0:18:13s
epoch 63 | loss: 0.5418  | train_auc: 0.80019 | train_balanced_accuracy: 0.72524 | train_accuracy: 0.72537 | valid_auc: 0.75373 | valid_balanced_accuracy: 0.68704 | valid_accuracy: 0.68713 |  0:18:30s
epoch 64 | loss: 0.53998 | train_auc: 0.80662 | train_balanced_accuracy: 0.72658 | train_accuracy: 0.72651 | valid_auc: 0.75915 | valid_balanced_accuracy: 0.68783 | valid_accuracy: 0.68776 |  0:18:46s
epoch 65 | loss: 0.53677 | train_auc: 0.81109 | train_balanced_accuracy: 0.73188 | train_accuracy: 0.73194 | valid_auc: 0.75597 | valid_balanced_accuracy: 0.69151 | valid_accuracy: 0.69153 |  0:19:05s
epoch 66 | loss: 0.54547 | train_auc: 0.81229 | train_balanced_accuracy: 0.73212 | train_accuracy: 0.73222 | valid_auc: 0.75884 | valid_balanced_accuracy: 0.69149 | valid_accuracy: 0.69153 |  0:19:23s
epoch 67 | loss: 0.53556 | train_auc: 0.80604 | train_balanced_accuracy: 0.72741 | train_accuracy: 0.72757 | valid_auc: 0.75743 | valid_balanced_accuracy: 0.69239 | valid_accuracy: 0.69248 |  0:19:41s
epoch 68 | loss: 0.54248 | train_auc: 0.81355 | train_balanced_accuracy: 0.73396 | train_accuracy: 0.73399 | valid_auc: 0.76102 | valid_balanced_accuracy: 0.69536 | valid_accuracy: 0.69531 |  0:19:59s
epoch 69 | loss: 0.53912 | train_auc: 0.8141  | train_balanced_accuracy: 0.7347  | train_accuracy: 0.73458 | valid_auc: 0.76035 | valid_balanced_accuracy: 0.69312 | valid_accuracy: 0.69295 |  0:20:16s
epoch 70 | loss: 0.53332 | train_auc: 0.81675 | train_balanced_accuracy: 0.73658 | train_accuracy: 0.7365  | valid_auc: 0.76289 | valid_balanced_accuracy: 0.69341 | valid_accuracy: 0.69326 |  0:20:33s
epoch 71 | loss: 0.54172 | train_auc: 0.81265 | train_balanced_accuracy: 0.73403 | train_accuracy: 0.73414 | valid_auc: 0.76028 | valid_balanced_accuracy: 0.69161 | valid_accuracy: 0.69169 |  0:20:51s
epoch 72 | loss: 0.53931 | train_auc: 0.81816 | train_balanced_accuracy: 0.73745 | train_accuracy: 0.73749 | valid_auc: 0.76128 | valid_balanced_accuracy: 0.6933  | valid_accuracy: 0.69326 |  0:21:07s
epoch 73 | loss: 0.53239 | train_auc: 0.81816 | train_balanced_accuracy: 0.73791 | train_accuracy: 0.73804 | valid_auc: 0.76485 | valid_balanced_accuracy: 0.69349 | valid_accuracy: 0.69358 |  0:21:24s
epoch 74 | loss: 0.53693 | train_auc: 0.81838 | train_balanced_accuracy: 0.73572 | train_accuracy: 0.73607 | valid_auc: 0.76606 | valid_balanced_accuracy: 0.69734 | valid_accuracy: 0.69767 |  0:21:41s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.70019
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 59/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.695 total time=21.8min
[CV 4/5; 59/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71729 | train_auc: 0.60539 | train_balanced_accuracy: 0.51351 | train_accuracy: 0.51023 | valid_auc: 0.60329 | valid_balanced_accuracy: 0.51068 | valid_accuracy: 0.5074  |  0:00:17s
epoch 1  | loss: 0.6496  | train_auc: 0.68742 | train_balanced_accuracy: 0.61852 | train_accuracy: 0.61737 | valid_auc: 0.68164 | valid_balanced_accuracy: 0.61335 | valid_accuracy: 0.61221 |  0:00:33s
epoch 2  | loss: 0.62626 | train_auc: 0.69696 | train_balanced_accuracy: 0.63709 | train_accuracy: 0.6385  | valid_auc: 0.69246 | valid_balanced_accuracy: 0.6342  | valid_accuracy: 0.63566 |  0:00:50s
epoch 3  | loss: 0.6202  | train_auc: 0.70769 | train_balanced_accuracy: 0.64073 | train_accuracy: 0.6418  | valid_auc: 0.70442 | valid_balanced_accuracy: 0.64304 | valid_accuracy: 0.64416 |  0:01:09s
epoch 4  | loss: 0.61036 | train_auc: 0.70716 | train_balanced_accuracy: 0.63821 | train_accuracy: 0.63932 | valid_auc: 0.70399 | valid_balanced_accuracy: 0.63921 | valid_accuracy: 0.64038 |  0:01:25s
epoch 5  | loss: 0.6086  | train_auc: 0.71195 | train_balanced_accuracy: 0.64753 | train_accuracy: 0.64853 | valid_auc: 0.71281 | valid_balanced_accuracy: 0.64941 | valid_accuracy: 0.65046 |  0:01:41s
epoch 6  | loss: 0.60509 | train_auc: 0.70861 | train_balanced_accuracy: 0.65511 | train_accuracy: 0.65585 | valid_auc: 0.7097  | valid_balanced_accuracy: 0.65501 | valid_accuracy: 0.65581 |  0:01:58s
epoch 7  | loss: 0.60088 | train_auc: 0.70902 | train_balanced_accuracy: 0.6464  | train_accuracy: 0.64707 | valid_auc: 0.71042 | valid_balanced_accuracy: 0.64785 | valid_accuracy: 0.64857 |  0:02:16s
epoch 8  | loss: 0.59941 | train_auc: 0.71415 | train_balanced_accuracy: 0.65649 | train_accuracy: 0.65667 | valid_auc: 0.7139  | valid_balanced_accuracy: 0.65527 | valid_accuracy: 0.65549 |  0:02:33s
epoch 9  | loss: 0.59519 | train_auc: 0.72005 | train_balanced_accuracy: 0.65887 | train_accuracy: 0.65892 | valid_auc: 0.72003 | valid_balanced_accuracy: 0.66295 | valid_accuracy: 0.66305 |  0:02:49s
epoch 10 | loss: 0.58828 | train_auc: 0.71918 | train_balanced_accuracy: 0.65856 | train_accuracy: 0.65864 | valid_auc: 0.71537 | valid_balanced_accuracy: 0.65692 | valid_accuracy: 0.65707 |  0:03:06s
epoch 11 | loss: 0.58979 | train_auc: 0.72412 | train_balanced_accuracy: 0.66099 | train_accuracy: 0.6612  | valid_auc: 0.71815 | valid_balanced_accuracy: 0.65804 | valid_accuracy: 0.65833 |  0:03:23s
epoch 12 | loss: 0.58628 | train_auc: 0.72783 | train_balanced_accuracy: 0.66386 | train_accuracy: 0.66442 | valid_auc: 0.72036 | valid_balanced_accuracy: 0.65236 | valid_accuracy: 0.65297 |  0:03:40s
epoch 13 | loss: 0.58431 | train_auc: 0.73116 | train_balanced_accuracy: 0.66407 | train_accuracy: 0.66415 | valid_auc: 0.72489 | valid_balanced_accuracy: 0.66137 | valid_accuracy: 0.66147 |  0:03:56s
epoch 14 | loss: 0.58611 | train_auc: 0.73472 | train_balanced_accuracy: 0.67057 | train_accuracy: 0.67088 | valid_auc: 0.72877 | valid_balanced_accuracy: 0.66096 | valid_accuracy: 0.66132 |  0:04:13s
epoch 15 | loss: 0.58691 | train_auc: 0.73887 | train_balanced_accuracy: 0.6698  | train_accuracy: 0.67001 | valid_auc: 0.72816 | valid_balanced_accuracy: 0.66292 | valid_accuracy: 0.6632  |  0:04:32s
epoch 16 | loss: 0.57956 | train_auc: 0.73847 | train_balanced_accuracy: 0.66982 | train_accuracy: 0.67001 | valid_auc: 0.72952 | valid_balanced_accuracy: 0.65603 | valid_accuracy: 0.65628 |  0:04:49s
epoch 17 | loss: 0.57809 | train_auc: 0.74671 | train_balanced_accuracy: 0.67891 | train_accuracy: 0.6793  | valid_auc: 0.73643 | valid_balanced_accuracy: 0.66878 | valid_accuracy: 0.66918 |  0:05:09s
epoch 18 | loss: 0.58302 | train_auc: 0.75026 | train_balanced_accuracy: 0.68042 | train_accuracy: 0.68083 | valid_auc: 0.73043 | valid_balanced_accuracy: 0.66527 | valid_accuracy: 0.66572 |  0:05:25s
epoch 19 | loss: 0.57288 | train_auc: 0.74431 | train_balanced_accuracy: 0.68214 | train_accuracy: 0.6824  | valid_auc: 0.73308 | valid_balanced_accuracy: 0.67139 | valid_accuracy: 0.6717  |  0:05:43s
epoch 20 | loss: 0.57392 | train_auc: 0.75249 | train_balanced_accuracy: 0.6845  | train_accuracy: 0.68488 | valid_auc: 0.73711 | valid_balanced_accuracy: 0.67051 | valid_accuracy: 0.67092 |  0:05:59s
epoch 21 | loss: 0.57445 | train_auc: 0.76028 | train_balanced_accuracy: 0.68959 | train_accuracy: 0.69023 | valid_auc: 0.74408 | valid_balanced_accuracy: 0.67549 | valid_accuracy: 0.67611 |  0:06:16s
epoch 22 | loss: 0.57271 | train_auc: 0.76124 | train_balanced_accuracy: 0.68662 | train_accuracy: 0.68705 | valid_auc: 0.74076 | valid_balanced_accuracy: 0.66684 | valid_accuracy: 0.6673  |  0:06:32s
epoch 23 | loss: 0.57235 | train_auc: 0.7685  | train_balanced_accuracy: 0.69369 | train_accuracy: 0.69409 | valid_auc: 0.75091 | valid_balanced_accuracy: 0.67853 | valid_accuracy: 0.67894 |  0:06:48s
epoch 24 | loss: 0.57243 | train_auc: 0.76274 | train_balanced_accuracy: 0.69196 | train_accuracy: 0.69263 | valid_auc: 0.74306 | valid_balanced_accuracy: 0.67258 | valid_accuracy: 0.67328 |  0:07:06s
epoch 25 | loss: 0.5668  | train_auc: 0.75555 | train_balanced_accuracy: 0.68928 | train_accuracy: 0.68941 | valid_auc: 0.74287 | valid_balanced_accuracy: 0.67532 | valid_accuracy: 0.67548 |  0:07:22s
epoch 26 | loss: 0.56903 | train_auc: 0.76539 | train_balanced_accuracy: 0.69328 | train_accuracy: 0.69397 | valid_auc: 0.74826 | valid_balanced_accuracy: 0.67901 | valid_accuracy: 0.67973 |  0:07:40s
epoch 27 | loss: 0.56742 | train_auc: 0.77244 | train_balanced_accuracy: 0.69849 | train_accuracy: 0.69901 | valid_auc: 0.7527  | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.68162 |  0:07:57s
epoch 28 | loss: 0.56454 | train_auc: 0.77535 | train_balanced_accuracy: 0.70172 | train_accuracy: 0.70204 | valid_auc: 0.75487 | valid_balanced_accuracy: 0.68103 | valid_accuracy: 0.6813  |  0:08:14s
epoch 29 | loss: 0.56229 | train_auc: 0.77865 | train_balanced_accuracy: 0.70614 | train_accuracy: 0.70633 | valid_auc: 0.7537  | valid_balanced_accuracy: 0.68648 | valid_accuracy: 0.68665 |  0:08:31s
epoch 30 | loss: 0.55856 | train_auc: 0.78306 | train_balanced_accuracy: 0.70418 | train_accuracy: 0.7046  | valid_auc: 0.75919 | valid_balanced_accuracy: 0.6908  | valid_accuracy: 0.69122 |  0:08:47s
epoch 31 | loss: 0.56144 | train_auc: 0.78618 | train_balanced_accuracy: 0.70771 | train_accuracy: 0.70829 | valid_auc: 0.75377 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68429 |  0:09:02s
epoch 32 | loss: 0.55543 | train_auc: 0.78533 | train_balanced_accuracy: 0.70763 | train_accuracy: 0.70743 | valid_auc: 0.75937 | valid_balanced_accuracy: 0.6843  | valid_accuracy: 0.68414 |  0:09:19s
epoch 33 | loss: 0.55936 | train_auc: 0.78444 | train_balanced_accuracy: 0.70495 | train_accuracy: 0.7053  | valid_auc: 0.75968 | valid_balanced_accuracy: 0.68992 | valid_accuracy: 0.69027 |  0:09:38s
epoch 34 | loss: 0.5567  | train_auc: 0.79034 | train_balanced_accuracy: 0.71367 | train_accuracy: 0.71392 | valid_auc: 0.76227 | valid_balanced_accuracy: 0.69081 | valid_accuracy: 0.69106 |  0:09:53s
epoch 35 | loss: 0.55088 | train_auc: 0.79077 | train_balanced_accuracy: 0.71187 | train_accuracy: 0.71199 | valid_auc: 0.75808 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68477 |  0:10:10s
epoch 36 | loss: 0.55211 | train_auc: 0.79255 | train_balanced_accuracy: 0.71597 | train_accuracy: 0.71597 | valid_auc: 0.76201 | valid_balanced_accuracy: 0.68905 | valid_accuracy: 0.68901 |  0:10:27s
epoch 37 | loss: 0.55106 | train_auc: 0.79191 | train_balanced_accuracy: 0.70734 | train_accuracy: 0.70806 | valid_auc: 0.75754 | valid_balanced_accuracy: 0.68104 | valid_accuracy: 0.68178 |  0:10:46s
epoch 38 | loss: 0.55464 | train_auc: 0.78349 | train_balanced_accuracy: 0.70591 | train_accuracy: 0.70601 | valid_auc: 0.75766 | valid_balanced_accuracy: 0.68889 | valid_accuracy: 0.68901 |  0:11:03s
epoch 39 | loss: 0.55154 | train_auc: 0.79469 | train_balanced_accuracy: 0.7166  | train_accuracy: 0.71656 | valid_auc: 0.75891 | valid_balanced_accuracy: 0.69118 | valid_accuracy: 0.69122 |  0:11:22s
epoch 40 | loss: 0.55196 | train_auc: 0.79345 | train_balanced_accuracy: 0.71375 | train_accuracy: 0.7138  | valid_auc: 0.76031 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.6854  |  0:11:41s
epoch 41 | loss: 0.55444 | train_auc: 0.79618 | train_balanced_accuracy: 0.71617 | train_accuracy: 0.71644 | valid_auc: 0.76151 | valid_balanced_accuracy: 0.69141 | valid_accuracy: 0.69169 |  0:11:58s
epoch 42 | loss: 0.54608 | train_auc: 0.7945  | train_balanced_accuracy: 0.71562 | train_accuracy: 0.71585 | valid_auc: 0.76372 | valid_balanced_accuracy: 0.69451 | valid_accuracy: 0.69468 |  0:12:15s
epoch 43 | loss: 0.55164 | train_auc: 0.79739 | train_balanced_accuracy: 0.71815 | train_accuracy: 0.71801 | valid_auc: 0.76388 | valid_balanced_accuracy: 0.68964 | valid_accuracy: 0.68949 |  0:12:35s
epoch 44 | loss: 0.55097 | train_auc: 0.79199 | train_balanced_accuracy: 0.71421 | train_accuracy: 0.71431 | valid_auc: 0.76432 | valid_balanced_accuracy: 0.6952  | valid_accuracy: 0.69531 |  0:12:52s
epoch 45 | loss: 0.54625 | train_auc: 0.79519 | train_balanced_accuracy: 0.71475 | train_accuracy: 0.71471 | valid_auc: 0.76354 | valid_balanced_accuracy: 0.68859 | valid_accuracy: 0.68854 |  0:13:09s
epoch 46 | loss: 0.54977 | train_auc: 0.77876 | train_balanced_accuracy: 0.70312 | train_accuracy: 0.70286 | valid_auc: 0.75394 | valid_balanced_accuracy: 0.67999 | valid_accuracy: 0.67973 |  0:13:26s
epoch 47 | loss: 0.54169 | train_auc: 0.79206 | train_balanced_accuracy: 0.71448 | train_accuracy: 0.71463 | valid_auc: 0.76241 | valid_balanced_accuracy: 0.69646 | valid_accuracy: 0.69657 |  0:13:43s
epoch 48 | loss: 0.54363 | train_auc: 0.78448 | train_balanced_accuracy: 0.70699 | train_accuracy: 0.7068  | valid_auc: 0.75855 | valid_balanced_accuracy: 0.68497 | valid_accuracy: 0.68477 |  0:13:59s
epoch 49 | loss: 0.54382 | train_auc: 0.80277 | train_balanced_accuracy: 0.72195 | train_accuracy: 0.72222 | valid_auc: 0.76202 | valid_balanced_accuracy: 0.69176 | valid_accuracy: 0.69201 |  0:14:15s
epoch 50 | loss: 0.54845 | train_auc: 0.79911 | train_balanced_accuracy: 0.71973 | train_accuracy: 0.71974 | valid_auc: 0.76374 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69043 |  0:14:30s
epoch 51 | loss: 0.54598 | train_auc: 0.80198 | train_balanced_accuracy: 0.72349 | train_accuracy: 0.7236  | valid_auc: 0.76332 | valid_balanced_accuracy: 0.69521 | valid_accuracy: 0.69531 |  0:14:47s
epoch 52 | loss: 0.54045 | train_auc: 0.79394 | train_balanced_accuracy: 0.71445 | train_accuracy: 0.71416 | valid_auc: 0.76083 | valid_balanced_accuracy: 0.68587 | valid_accuracy: 0.68555 |  0:15:03s
epoch 53 | loss: 0.54043 | train_auc: 0.80487 | train_balanced_accuracy: 0.72103 | train_accuracy: 0.72132 | valid_auc: 0.76476 | valid_balanced_accuracy: 0.69219 | valid_accuracy: 0.69248 |  0:15:21s
epoch 54 | loss: 0.54088 | train_auc: 0.81224 | train_balanced_accuracy: 0.72825 | train_accuracy: 0.72824 | valid_auc: 0.76794 | valid_balanced_accuracy: 0.69781 | valid_accuracy: 0.69783 |  0:15:39s
epoch 55 | loss: 0.53664 | train_auc: 0.81203 | train_balanced_accuracy: 0.72852 | train_accuracy: 0.72836 | valid_auc: 0.76411 | valid_balanced_accuracy: 0.69246 | valid_accuracy: 0.69232 |  0:15:55s
epoch 56 | loss: 0.53937 | train_auc: 0.80755 | train_balanced_accuracy: 0.72733 | train_accuracy: 0.72738 | valid_auc: 0.76497 | valid_balanced_accuracy: 0.691   | valid_accuracy: 0.69106 |  0:16:14s
epoch 57 | loss: 0.54385 | train_auc: 0.80377 | train_balanced_accuracy: 0.72303 | train_accuracy: 0.72281 | valid_auc: 0.76273 | valid_balanced_accuracy: 0.68983 | valid_accuracy: 0.68964 |  0:16:31s
epoch 58 | loss: 0.54315 | train_auc: 0.80826 | train_balanced_accuracy: 0.72525 | train_accuracy: 0.72541 | valid_auc: 0.76405 | valid_balanced_accuracy: 0.69166 | valid_accuracy: 0.69185 |  0:16:49s
epoch 59 | loss: 0.53603 | train_auc: 0.78178 | train_balanced_accuracy: 0.70813 | train_accuracy: 0.70841 | valid_auc: 0.75352 | valid_balanced_accuracy: 0.68618 | valid_accuracy: 0.6865  |  0:17:06s
epoch 60 | loss: 0.53906 | train_auc: 0.79881 | train_balanced_accuracy: 0.71997 | train_accuracy: 0.72029 | valid_auc: 0.76301 | valid_balanced_accuracy: 0.69007 | valid_accuracy: 0.69043 |  0:17:23s
epoch 61 | loss: 0.53389 | train_auc: 0.80853 | train_balanced_accuracy: 0.72651 | train_accuracy: 0.72679 | valid_auc: 0.7628  | valid_balanced_accuracy: 0.68883 | valid_accuracy: 0.68917 |  0:17:41s
epoch 62 | loss: 0.53422 | train_auc: 0.80983 | train_balanced_accuracy: 0.72712 | train_accuracy: 0.7271  | valid_auc: 0.76862 | valid_balanced_accuracy: 0.68949 | valid_accuracy: 0.68949 |  0:17:59s
epoch 63 | loss: 0.53247 | train_auc: 0.7777  | train_balanced_accuracy: 0.70225 | train_accuracy: 0.70216 | valid_auc: 0.75088 | valid_balanced_accuracy: 0.68013 | valid_accuracy: 0.68004 |  0:18:16s
epoch 64 | loss: 0.5297  | train_auc: 0.80813 | train_balanced_accuracy: 0.72722 | train_accuracy: 0.72714 | valid_auc: 0.76287 | valid_balanced_accuracy: 0.68894 | valid_accuracy: 0.68886 |  0:18:34s
epoch 65 | loss: 0.53302 | train_auc: 0.78849 | train_balanced_accuracy: 0.71216 | train_accuracy: 0.71227 | valid_auc: 0.75326 | valid_balanced_accuracy: 0.68401 | valid_accuracy: 0.68414 |  0:18:50s
epoch 66 | loss: 0.53897 | train_auc: 0.80578 | train_balanced_accuracy: 0.72655 | train_accuracy: 0.72655 | valid_auc: 0.76519 | valid_balanced_accuracy: 0.69462 | valid_accuracy: 0.69468 |  0:19:06s
epoch 67 | loss: 0.53016 | train_auc: 0.76963 | train_balanced_accuracy: 0.69416 | train_accuracy: 0.69401 | valid_auc: 0.74864 | valid_balanced_accuracy: 0.68304 | valid_accuracy: 0.68288 |  0:19:24s
epoch 68 | loss: 0.53029 | train_auc: 0.8144  | train_balanced_accuracy: 0.73427 | train_accuracy: 0.7343  | valid_auc: 0.76344 | valid_balanced_accuracy: 0.69335 | valid_accuracy: 0.69342 |  0:19:42s
epoch 69 | loss: 0.53261 | train_auc: 0.78187 | train_balanced_accuracy: 0.70684 | train_accuracy: 0.70735 | valid_auc: 0.74924 | valid_balanced_accuracy: 0.67932 | valid_accuracy: 0.67989 |  0:19:59s
epoch 70 | loss: 0.52833 | train_auc: 0.80019 | train_balanced_accuracy: 0.7229  | train_accuracy: 0.72328 | valid_auc: 0.75801 | valid_balanced_accuracy: 0.68679 | valid_accuracy: 0.68728 |  0:20:18s
epoch 71 | loss: 0.53127 | train_auc: 0.7977  | train_balanced_accuracy: 0.72132 | train_accuracy: 0.72171 | valid_auc: 0.75488 | valid_balanced_accuracy: 0.68352 | valid_accuracy: 0.68398 |  0:20:35s
epoch 72 | loss: 0.53246 | train_auc: 0.8249  | train_balanced_accuracy: 0.74049 | train_accuracy: 0.7406  | valid_auc: 0.76572 | valid_balanced_accuracy: 0.6955  | valid_accuracy: 0.69562 |  0:20:52s
epoch 73 | loss: 0.52935 | train_auc: 0.8121  | train_balanced_accuracy: 0.73208 | train_accuracy: 0.73222 | valid_auc: 0.76662 | valid_balanced_accuracy: 0.69389 | valid_accuracy: 0.69405 |  0:21:09s
epoch 74 | loss: 0.53234 | train_auc: 0.79943 | train_balanced_accuracy: 0.71874 | train_accuracy: 0.7188  | valid_auc: 0.75569 | valid_balanced_accuracy: 0.68218 | valid_accuracy: 0.68225 |  0:21:26s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69783
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 59/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=21.6min
[CV 5/5; 59/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71523 | train_auc: 0.58868 | train_balanced_accuracy: 0.53654 | train_accuracy: 0.53427 | valid_auc: 0.59438 | valid_balanced_accuracy: 0.53651 | valid_accuracy: 0.53415 |  0:00:16s
epoch 1  | loss: 0.65301 | train_auc: 0.61805 | train_balanced_accuracy: 0.5777  | train_accuracy: 0.57586 | valid_auc: 0.6213  | valid_balanced_accuracy: 0.5809  | valid_accuracy: 0.57901 |  0:00:35s
epoch 2  | loss: 0.63668 | train_auc: 0.65802 | train_balanced_accuracy: 0.60483 | train_accuracy: 0.60367 | valid_auc: 0.65523 | valid_balanced_accuracy: 0.60336 | valid_accuracy: 0.60214 |  0:00:52s
epoch 3  | loss: 0.62487 | train_auc: 0.66821 | train_balanced_accuracy: 0.60219 | train_accuracy: 0.60057 | valid_auc: 0.66652 | valid_balanced_accuracy: 0.60069 | valid_accuracy: 0.59899 |  0:01:07s
epoch 4  | loss: 0.61231 | train_auc: 0.67013 | train_balanced_accuracy: 0.60639 | train_accuracy: 0.60501 | valid_auc: 0.66855 | valid_balanced_accuracy: 0.60575 | valid_accuracy: 0.60434 |  0:01:25s
epoch 5  | loss: 0.61071 | train_auc: 0.67186 | train_balanced_accuracy: 0.6129  | train_accuracy: 0.61182 | valid_auc: 0.66844 | valid_balanced_accuracy: 0.6089  | valid_accuracy: 0.60781 |  0:01:42s
epoch 6  | loss: 0.60883 | train_auc: 0.68225 | train_balanced_accuracy: 0.6188  | train_accuracy: 0.61792 | valid_auc: 0.67796 | valid_balanced_accuracy: 0.6181  | valid_accuracy: 0.61725 |  0:02:00s
epoch 7  | loss: 0.60745 | train_auc: 0.68784 | train_balanced_accuracy: 0.61989 | train_accuracy: 0.61914 | valid_auc: 0.68441 | valid_balanced_accuracy: 0.6161  | valid_accuracy: 0.61536 |  0:02:16s
epoch 8  | loss: 0.6071  | train_auc: 0.70053 | train_balanced_accuracy: 0.62503 | train_accuracy: 0.62429 | valid_auc: 0.69948 | valid_balanced_accuracy: 0.62509 | valid_accuracy: 0.62433 |  0:02:34s
epoch 9  | loss: 0.60144 | train_auc: 0.68982 | train_balanced_accuracy: 0.62323 | train_accuracy: 0.6226  | valid_auc: 0.68945 | valid_balanced_accuracy: 0.62229 | valid_accuracy: 0.62166 |  0:02:49s
epoch 10 | loss: 0.60107 | train_auc: 0.69879 | train_balanced_accuracy: 0.62747 | train_accuracy: 0.62673 | valid_auc: 0.69816 | valid_balanced_accuracy: 0.62715 | valid_accuracy: 0.62638 |  0:03:06s
epoch 11 | loss: 0.59588 | train_auc: 0.71317 | train_balanced_accuracy: 0.64191 | train_accuracy: 0.64149 | valid_auc: 0.71039 | valid_balanced_accuracy: 0.63591 | valid_accuracy: 0.63551 |  0:03:22s
epoch 12 | loss: 0.59576 | train_auc: 0.71462 | train_balanced_accuracy: 0.64224 | train_accuracy: 0.64188 | valid_auc: 0.71137 | valid_balanced_accuracy: 0.6379  | valid_accuracy: 0.63755 |  0:03:39s
epoch 13 | loss: 0.59704 | train_auc: 0.72195 | train_balanced_accuracy: 0.65355 | train_accuracy: 0.65333 | valid_auc: 0.7166  | valid_balanced_accuracy: 0.64566 | valid_accuracy: 0.64542 |  0:03:56s
epoch 14 | loss: 0.59092 | train_auc: 0.73273 | train_balanced_accuracy: 0.66713 | train_accuracy: 0.6673  | valid_auc: 0.72462 | valid_balanced_accuracy: 0.66367 | valid_accuracy: 0.66383 |  0:04:14s
epoch 15 | loss: 0.58826 | train_auc: 0.73781 | train_balanced_accuracy: 0.67036 | train_accuracy: 0.6706  | valid_auc: 0.72988 | valid_balanced_accuracy: 0.66471 | valid_accuracy: 0.66494 |  0:04:30s
epoch 16 | loss: 0.5907  | train_auc: 0.74429 | train_balanced_accuracy: 0.67683 | train_accuracy: 0.67682 | valid_auc: 0.73295 | valid_balanced_accuracy: 0.66764 | valid_accuracy: 0.66761 |  0:04:50s
epoch 17 | loss: 0.59029 | train_auc: 0.74872 | train_balanced_accuracy: 0.6833  | train_accuracy: 0.68351 | valid_auc: 0.73695 | valid_balanced_accuracy: 0.6712  | valid_accuracy: 0.67139 |  0:05:08s
epoch 18 | loss: 0.58469 | train_auc: 0.7498  | train_balanced_accuracy: 0.68392 | train_accuracy: 0.68433 | valid_auc: 0.73649 | valid_balanced_accuracy: 0.6713  | valid_accuracy: 0.6717  |  0:05:25s
epoch 19 | loss: 0.58578 | train_auc: 0.75353 | train_balanced_accuracy: 0.68396 | train_accuracy: 0.68406 | valid_auc: 0.737   | valid_balanced_accuracy: 0.67225 | valid_accuracy: 0.67233 |  0:05:42s
epoch 20 | loss: 0.58168 | train_auc: 0.75492 | train_balanced_accuracy: 0.68783 | train_accuracy: 0.68799 | valid_auc: 0.73666 | valid_balanced_accuracy: 0.67533 | valid_accuracy: 0.67548 |  0:06:00s
epoch 21 | loss: 0.57967 | train_auc: 0.76335 | train_balanced_accuracy: 0.69742 | train_accuracy: 0.69779 | valid_auc: 0.73999 | valid_balanced_accuracy: 0.67874 | valid_accuracy: 0.6791  |  0:06:18s
epoch 22 | loss: 0.57984 | train_auc: 0.76165 | train_balanced_accuracy: 0.69397 | train_accuracy: 0.69444 | valid_auc: 0.73929 | valid_balanced_accuracy: 0.67879 | valid_accuracy: 0.67926 |  0:06:36s
epoch 23 | loss: 0.57562 | train_auc: 0.7613  | train_balanced_accuracy: 0.69332 | train_accuracy: 0.69374 | valid_auc: 0.73936 | valid_balanced_accuracy: 0.67458 | valid_accuracy: 0.67501 |  0:06:52s
epoch 24 | loss: 0.58321 | train_auc: 0.76522 | train_balanced_accuracy: 0.69393 | train_accuracy: 0.69444 | valid_auc: 0.74095 | valid_balanced_accuracy: 0.67374 | valid_accuracy: 0.67422 |  0:07:08s
epoch 25 | loss: 0.57741 | train_auc: 0.76999 | train_balanced_accuracy: 0.69917 | train_accuracy: 0.69928 | valid_auc: 0.74455 | valid_balanced_accuracy: 0.67917 | valid_accuracy: 0.67926 |  0:07:25s
epoch 26 | loss: 0.5752  | train_auc: 0.77231 | train_balanced_accuracy: 0.70349 | train_accuracy: 0.70385 | valid_auc: 0.7463  | valid_balanced_accuracy: 0.683   | valid_accuracy: 0.68335 |  0:07:43s
epoch 27 | loss: 0.57384 | train_auc: 0.77491 | train_balanced_accuracy: 0.70292 | train_accuracy: 0.70286 | valid_auc: 0.75048 | valid_balanced_accuracy: 0.6866  | valid_accuracy: 0.6865  |  0:08:00s
epoch 28 | loss: 0.57387 | train_auc: 0.77277 | train_balanced_accuracy: 0.70267 | train_accuracy: 0.70275 | valid_auc: 0.74775 | valid_balanced_accuracy: 0.68549 | valid_accuracy: 0.68555 |  0:08:18s
epoch 29 | loss: 0.57407 | train_auc: 0.77828 | train_balanced_accuracy: 0.70619 | train_accuracy: 0.70641 | valid_auc: 0.75039 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68571 |  0:08:36s
epoch 30 | loss: 0.57315 | train_auc: 0.77552 | train_balanced_accuracy: 0.70612 | train_accuracy: 0.70641 | valid_auc: 0.74559 | valid_balanced_accuracy: 0.68147 | valid_accuracy: 0.68178 |  0:08:53s
epoch 31 | loss: 0.57067 | train_auc: 0.7621  | train_balanced_accuracy: 0.6965  | train_accuracy: 0.69665 | valid_auc: 0.74026 | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68335 |  0:09:10s
epoch 32 | loss: 0.56999 | train_auc: 0.74816 | train_balanced_accuracy: 0.67966 | train_accuracy: 0.67945 | valid_auc: 0.73053 | valid_balanced_accuracy: 0.66972 | valid_accuracy: 0.6695  |  0:09:26s
epoch 33 | loss: 0.57426 | train_auc: 0.75501 | train_balanced_accuracy: 0.68962 | train_accuracy: 0.68992 | valid_auc: 0.73924 | valid_balanced_accuracy: 0.68018 | valid_accuracy: 0.68052 |  0:09:43s
epoch 34 | loss: 0.5622  | train_auc: 0.7599  | train_balanced_accuracy: 0.69155 | train_accuracy: 0.69161 | valid_auc: 0.73895 | valid_balanced_accuracy: 0.67928 | valid_accuracy: 0.67941 |  0:10:00s
epoch 35 | loss: 0.56775 | train_auc: 0.75735 | train_balanced_accuracy: 0.69063 | train_accuracy: 0.69051 | valid_auc: 0.73985 | valid_balanced_accuracy: 0.68045 | valid_accuracy: 0.68036 |  0:10:17s
epoch 36 | loss: 0.56603 | train_auc: 0.7559  | train_balanced_accuracy: 0.68951 | train_accuracy: 0.68968 | valid_auc: 0.73645 | valid_balanced_accuracy: 0.67748 | valid_accuracy: 0.67768 |  0:10:35s
epoch 37 | loss: 0.56397 | train_auc: 0.76616 | train_balanced_accuracy: 0.7     | train_accuracy: 0.70011 | valid_auc: 0.74383 | valid_balanced_accuracy: 0.68272 | valid_accuracy: 0.68288 |  0:10:52s
epoch 38 | loss: 0.56535 | train_auc: 0.76244 | train_balanced_accuracy: 0.69355 | train_accuracy: 0.69342 | valid_auc: 0.74175 | valid_balanced_accuracy: 0.6786  | valid_accuracy: 0.67847 |  0:11:08s
epoch 39 | loss: 0.56978 | train_auc: 0.76922 | train_balanced_accuracy: 0.69869 | train_accuracy: 0.69905 | valid_auc: 0.74273 | valid_balanced_accuracy: 0.68344 | valid_accuracy: 0.68382 |  0:11:26s
epoch 40 | loss: 0.56151 | train_auc: 0.77188 | train_balanced_accuracy: 0.70281 | train_accuracy: 0.70302 | valid_auc: 0.74867 | valid_balanced_accuracy: 0.68349 | valid_accuracy: 0.68366 |  0:11:43s
epoch 41 | loss: 0.55828 | train_auc: 0.77334 | train_balanced_accuracy: 0.70352 | train_accuracy: 0.70361 | valid_auc: 0.74917 | valid_balanced_accuracy: 0.68641 | valid_accuracy: 0.6865  |  0:12:01s
epoch 42 | loss: 0.55982 | train_auc: 0.78068 | train_balanced_accuracy: 0.70974 | train_accuracy: 0.7101  | valid_auc: 0.74691 | valid_balanced_accuracy: 0.68677 | valid_accuracy: 0.68713 |  0:12:18s
epoch 43 | loss: 0.55778 | train_auc: 0.77803 | train_balanced_accuracy: 0.70571 | train_accuracy: 0.70601 | valid_auc: 0.75072 | valid_balanced_accuracy: 0.68936 | valid_accuracy: 0.68964 |  0:12:36s
epoch 44 | loss: 0.55733 | train_auc: 0.79285 | train_balanced_accuracy: 0.71434 | train_accuracy: 0.71447 | valid_auc: 0.75945 | valid_balanced_accuracy: 0.6963  | valid_accuracy: 0.69641 |  0:12:53s
epoch 45 | loss: 0.55161 | train_auc: 0.79045 | train_balanced_accuracy: 0.71348 | train_accuracy: 0.71388 | valid_auc: 0.75202 | valid_balanced_accuracy: 0.68975 | valid_accuracy: 0.69012 |  0:13:09s
epoch 46 | loss: 0.55658 | train_auc: 0.79092 | train_balanced_accuracy: 0.71255 | train_accuracy: 0.7127  | valid_auc: 0.75327 | valid_balanced_accuracy: 0.68008 | valid_accuracy: 0.6802  |  0:13:27s
epoch 47 | loss: 0.55726 | train_auc: 0.79018 | train_balanced_accuracy: 0.71479 | train_accuracy: 0.71518 | valid_auc: 0.75658 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.68571 |  0:13:42s
epoch 48 | loss: 0.55505 | train_auc: 0.79361 | train_balanced_accuracy: 0.71785 | train_accuracy: 0.71809 | valid_auc: 0.75931 | valid_balanced_accuracy: 0.69608 | valid_accuracy: 0.69625 |  0:13:59s
epoch 49 | loss: 0.55214 | train_auc: 0.79466 | train_balanced_accuracy: 0.71973 | train_accuracy: 0.71978 | valid_auc: 0.75485 | valid_balanced_accuracy: 0.69131 | valid_accuracy: 0.69138 |  0:14:15s
epoch 50 | loss: 0.5492  | train_auc: 0.79919 | train_balanced_accuracy: 0.72094 | train_accuracy: 0.72096 | valid_auc: 0.75191 | valid_balanced_accuracy: 0.68244 | valid_accuracy: 0.6824  |  0:14:32s
epoch 51 | loss: 0.55237 | train_auc: 0.79677 | train_balanced_accuracy: 0.71986 | train_accuracy: 0.7201  | valid_auc: 0.7548  | valid_balanced_accuracy: 0.68866 | valid_accuracy: 0.68886 |  0:14:49s
epoch 52 | loss: 0.55002 | train_auc: 0.80106 | train_balanced_accuracy: 0.722   | train_accuracy: 0.7223  | valid_auc: 0.75422 | valid_balanced_accuracy: 0.69032 | valid_accuracy: 0.69059 |  0:15:07s
epoch 53 | loss: 0.55766 | train_auc: 0.8002  | train_balanced_accuracy: 0.72133 | train_accuracy: 0.72167 | valid_auc: 0.75549 | valid_balanced_accuracy: 0.68963 | valid_accuracy: 0.68996 |  0:15:23s
epoch 54 | loss: 0.55104 | train_auc: 0.80115 | train_balanced_accuracy: 0.723   | train_accuracy: 0.72321 | valid_auc: 0.75722 | valid_balanced_accuracy: 0.68887 | valid_accuracy: 0.68901 |  0:15:41s
epoch 55 | loss: 0.55823 | train_auc: 0.7996  | train_balanced_accuracy: 0.7207  | train_accuracy: 0.72108 | valid_auc: 0.75686 | valid_balanced_accuracy: 0.69592 | valid_accuracy: 0.69625 |  0:15:58s
epoch 56 | loss: 0.55385 | train_auc: 0.79811 | train_balanced_accuracy: 0.72035 | train_accuracy: 0.72022 | valid_auc: 0.75305 | valid_balanced_accuracy: 0.68777 | valid_accuracy: 0.6876  |  0:16:15s
epoch 57 | loss: 0.55045 | train_auc: 0.80191 | train_balanced_accuracy: 0.72491 | train_accuracy: 0.72517 | valid_auc: 0.75801 | valid_balanced_accuracy: 0.69317 | valid_accuracy: 0.69342 |  0:16:33s
epoch 58 | loss: 0.5463  | train_auc: 0.80181 | train_balanced_accuracy: 0.72178 | train_accuracy: 0.72167 | valid_auc: 0.7557  | valid_balanced_accuracy: 0.68602 | valid_accuracy: 0.68587 |  0:16:51s
epoch 59 | loss: 0.55252 | train_auc: 0.79003 | train_balanced_accuracy: 0.7092  | train_accuracy: 0.70955 | valid_auc: 0.75019 | valid_balanced_accuracy: 0.68211 | valid_accuracy: 0.6824  |  0:17:10s
epoch 60 | loss: 0.54739 | train_auc: 0.80419 | train_balanced_accuracy: 0.7247  | train_accuracy: 0.72494 | valid_auc: 0.75587 | valid_balanced_accuracy: 0.68862 | valid_accuracy: 0.68886 |  0:17:28s
epoch 61 | loss: 0.55102 | train_auc: 0.80146 | train_balanced_accuracy: 0.72295 | train_accuracy: 0.72309 | valid_auc: 0.75649 | valid_balanced_accuracy: 0.68953 | valid_accuracy: 0.68964 |  0:17:45s
epoch 62 | loss: 0.54343 | train_auc: 0.80129 | train_balanced_accuracy: 0.72233 | train_accuracy: 0.7223  | valid_auc: 0.75724 | valid_balanced_accuracy: 0.69124 | valid_accuracy: 0.69122 |  0:18:01s
epoch 63 | loss: 0.54509 | train_auc: 0.80168 | train_balanced_accuracy: 0.72325 | train_accuracy: 0.72356 | valid_auc: 0.75679 | valid_balanced_accuracy: 0.68872 | valid_accuracy: 0.68901 |  0:18:19s
epoch 64 | loss: 0.54058 | train_auc: 0.80875 | train_balanced_accuracy: 0.72933 | train_accuracy: 0.72958 | valid_auc: 0.75894 | valid_balanced_accuracy: 0.69315 | valid_accuracy: 0.69342 |  0:18:37s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69641
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 59/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.690 total time=18.7min
[CV 1/5; 60/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82139 | train_auc: 0.48213 | train_balanced_accuracy: 0.5156  | train_accuracy: 0.51332 | valid_auc: 0.46304 | valid_balanced_accuracy: 0.49952 | valid_accuracy: 0.49717 |  0:00:15s
epoch 1  | loss: 0.75373 | train_auc: 0.49714 | train_balanced_accuracy: 0.51925 | train_accuracy: 0.51678 | valid_auc: 0.48041 | valid_balanced_accuracy: 0.50803 | valid_accuracy: 0.50551 |  0:00:33s
epoch 2  | loss: 0.71183 | train_auc: 0.5185  | train_balanced_accuracy: 0.52054 | train_accuracy: 0.51792 | valid_auc: 0.50752 | valid_balanced_accuracy: 0.51103 | valid_accuracy: 0.50834 |  0:00:52s
epoch 3  | loss: 0.69021 | train_auc: 0.54624 | train_balanced_accuracy: 0.52466 | train_accuracy: 0.52213 | valid_auc: 0.54077 | valid_balanced_accuracy: 0.51927 | valid_accuracy: 0.51668 |  0:01:09s
epoch 4  | loss: 0.67191 | train_auc: 0.56845 | train_balanced_accuracy: 0.5294  | train_accuracy: 0.52674 | valid_auc: 0.56244 | valid_balanced_accuracy: 0.52572 | valid_accuracy: 0.52298 |  0:01:27s
epoch 5  | loss: 0.66748 | train_auc: 0.58542 | train_balanced_accuracy: 0.53614 | train_accuracy: 0.53354 | valid_auc: 0.57555 | valid_balanced_accuracy: 0.53291 | valid_accuracy: 0.53022 |  0:01:45s
epoch 6  | loss: 0.6654  | train_auc: 0.60019 | train_balanced_accuracy: 0.54748 | train_accuracy: 0.54503 | valid_auc: 0.58964 | valid_balanced_accuracy: 0.54187 | valid_accuracy: 0.53935 |  0:02:01s
epoch 7  | loss: 0.6591  | train_auc: 0.61002 | train_balanced_accuracy: 0.55978 | train_accuracy: 0.55754 | valid_auc: 0.59951 | valid_balanced_accuracy: 0.55221 | valid_accuracy: 0.54989 |  0:02:18s
epoch 8  | loss: 0.64933 | train_auc: 0.61914 | train_balanced_accuracy: 0.57084 | train_accuracy: 0.5688  | valid_auc: 0.60932 | valid_balanced_accuracy: 0.56428 | valid_accuracy: 0.56217 |  0:02:35s
epoch 9  | loss: 0.65035 | train_auc: 0.62917 | train_balanced_accuracy: 0.57919 | train_accuracy: 0.5773  | valid_auc: 0.62027 | valid_balanced_accuracy: 0.57121 | valid_accuracy: 0.56925 |  0:02:53s
epoch 10 | loss: 0.64555 | train_auc: 0.64086 | train_balanced_accuracy: 0.58933 | train_accuracy: 0.58761 | valid_auc: 0.63307 | valid_balanced_accuracy: 0.5792  | valid_accuracy: 0.57743 |  0:03:10s
epoch 11 | loss: 0.64005 | train_auc: 0.65196 | train_balanced_accuracy: 0.60027 | train_accuracy: 0.59878 | valid_auc: 0.64592 | valid_balanced_accuracy: 0.58969 | valid_accuracy: 0.58813 |  0:03:26s
epoch 12 | loss: 0.63904 | train_auc: 0.6604  | train_balanced_accuracy: 0.60324 | train_accuracy: 0.60177 | valid_auc: 0.65487 | valid_balanced_accuracy: 0.59391 | valid_accuracy: 0.59238 |  0:03:44s
epoch 13 | loss: 0.63969 | train_auc: 0.66845 | train_balanced_accuracy: 0.60933 | train_accuracy: 0.60803 | valid_auc: 0.66452 | valid_balanced_accuracy: 0.60114 | valid_accuracy: 0.59978 |  0:04:02s
epoch 14 | loss: 0.63419 | train_auc: 0.67657 | train_balanced_accuracy: 0.61699 | train_accuracy: 0.61586 | valid_auc: 0.67161 | valid_balanced_accuracy: 0.60865 | valid_accuracy: 0.60749 |  0:04:20s
epoch 15 | loss: 0.63006 | train_auc: 0.68193 | train_balanced_accuracy: 0.6236  | train_accuracy: 0.62266 | valid_auc: 0.67767 | valid_balanced_accuracy: 0.61962 | valid_accuracy: 0.61867 |  0:04:37s
epoch 16 | loss: 0.62818 | train_auc: 0.68641 | train_balanced_accuracy: 0.62989 | train_accuracy: 0.62912 | valid_auc: 0.68303 | valid_balanced_accuracy: 0.6322  | valid_accuracy: 0.63141 |  0:04:55s
epoch 17 | loss: 0.62826 | train_auc: 0.69081 | train_balanced_accuracy: 0.63409 | train_accuracy: 0.63337 | valid_auc: 0.68744 | valid_balanced_accuracy: 0.63546 | valid_accuracy: 0.63472 |  0:05:15s
epoch 18 | loss: 0.62286 | train_auc: 0.69701 | train_balanced_accuracy: 0.64098 | train_accuracy: 0.64049 | valid_auc: 0.6925  | valid_balanced_accuracy: 0.64217 | valid_accuracy: 0.64164 |  0:05:32s
epoch 19 | loss: 0.62282 | train_auc: 0.70333 | train_balanced_accuracy: 0.64265 | train_accuracy: 0.6421  | valid_auc: 0.69682 | valid_balanced_accuracy: 0.64253 | valid_accuracy: 0.64196 |  0:05:48s
epoch 20 | loss: 0.6249  | train_auc: 0.70727 | train_balanced_accuracy: 0.64604 | train_accuracy: 0.64564 | valid_auc: 0.69968 | valid_balanced_accuracy: 0.64144 | valid_accuracy: 0.64101 |  0:06:05s
epoch 21 | loss: 0.61983 | train_auc: 0.71002 | train_balanced_accuracy: 0.64768 | train_accuracy: 0.64741 | valid_auc: 0.70135 | valid_balanced_accuracy: 0.63956 | valid_accuracy: 0.63928 |  0:06:22s
epoch 22 | loss: 0.62183 | train_auc: 0.71305 | train_balanced_accuracy: 0.64824 | train_accuracy: 0.64804 | valid_auc: 0.70363 | valid_balanced_accuracy: 0.64232 | valid_accuracy: 0.64212 |  0:06:38s
epoch 23 | loss: 0.61746 | train_auc: 0.71696 | train_balanced_accuracy: 0.6531  | train_accuracy: 0.653   | valid_auc: 0.70642 | valid_balanced_accuracy: 0.64742 | valid_accuracy: 0.64731 |  0:06:55s
epoch 24 | loss: 0.62304 | train_auc: 0.72056 | train_balanced_accuracy: 0.65904 | train_accuracy: 0.65914 | valid_auc: 0.70982 | valid_balanced_accuracy: 0.6552  | valid_accuracy: 0.65534 |  0:07:13s
epoch 25 | loss: 0.61673 | train_auc: 0.7212  | train_balanced_accuracy: 0.66027 | train_accuracy: 0.66048 | valid_auc: 0.71023 | valid_balanced_accuracy: 0.65322 | valid_accuracy: 0.65345 |  0:07:30s
epoch 26 | loss: 0.6175  | train_auc: 0.72336 | train_balanced_accuracy: 0.66307 | train_accuracy: 0.66323 | valid_auc: 0.71112 | valid_balanced_accuracy: 0.65215 | valid_accuracy: 0.65234 |  0:07:47s
epoch 27 | loss: 0.61395 | train_auc: 0.72535 | train_balanced_accuracy: 0.66438 | train_accuracy: 0.66465 | valid_auc: 0.71247 | valid_balanced_accuracy: 0.65503 | valid_accuracy: 0.65534 |  0:08:04s
epoch 28 | loss: 0.61409 | train_auc: 0.72824 | train_balanced_accuracy: 0.66681 | train_accuracy: 0.66709 | valid_auc: 0.71389 | valid_balanced_accuracy: 0.65646 | valid_accuracy: 0.65675 |  0:08:20s
epoch 29 | loss: 0.6126  | train_auc: 0.72901 | train_balanced_accuracy: 0.66773 | train_accuracy: 0.66795 | valid_auc: 0.71436 | valid_balanced_accuracy: 0.65542 | valid_accuracy: 0.65565 |  0:08:37s
epoch 30 | loss: 0.61045 | train_auc: 0.73127 | train_balanced_accuracy: 0.66874 | train_accuracy: 0.66909 | valid_auc: 0.71668 | valid_balanced_accuracy: 0.65636 | valid_accuracy: 0.65675 |  0:08:53s
epoch 31 | loss: 0.60973 | train_auc: 0.73192 | train_balanced_accuracy: 0.66899 | train_accuracy: 0.66937 | valid_auc: 0.71833 | valid_balanced_accuracy: 0.65746 | valid_accuracy: 0.65785 |  0:09:10s
epoch 32 | loss: 0.61254 | train_auc: 0.73544 | train_balanced_accuracy: 0.67164 | train_accuracy: 0.67204 | valid_auc: 0.72006 | valid_balanced_accuracy: 0.65995 | valid_accuracy: 0.66037 |  0:09:27s
epoch 33 | loss: 0.61076 | train_auc: 0.73496 | train_balanced_accuracy: 0.67091 | train_accuracy: 0.67118 | valid_auc: 0.71987 | valid_balanced_accuracy: 0.65869 | valid_accuracy: 0.65895 |  0:09:45s
epoch 34 | loss: 0.60739 | train_auc: 0.73518 | train_balanced_accuracy: 0.67304 | train_accuracy: 0.67334 | valid_auc: 0.71989 | valid_balanced_accuracy: 0.65693 | valid_accuracy: 0.65722 |  0:10:01s
epoch 35 | loss: 0.60903 | train_auc: 0.73657 | train_balanced_accuracy: 0.66947 | train_accuracy: 0.67004 | valid_auc: 0.72165 | valid_balanced_accuracy: 0.65965 | valid_accuracy: 0.66021 |  0:10:20s
epoch 36 | loss: 0.60941 | train_auc: 0.73472 | train_balanced_accuracy: 0.67082 | train_accuracy: 0.67114 | valid_auc: 0.72092 | valid_balanced_accuracy: 0.65958 | valid_accuracy: 0.6599  |  0:10:36s
epoch 37 | loss: 0.60448 | train_auc: 0.73448 | train_balanced_accuracy: 0.67046 | train_accuracy: 0.67094 | valid_auc: 0.72042 | valid_balanced_accuracy: 0.65578 | valid_accuracy: 0.65628 |  0:10:53s
epoch 38 | loss: 0.60604 | train_auc: 0.73195 | train_balanced_accuracy: 0.66962 | train_accuracy: 0.6698  | valid_auc: 0.71917 | valid_balanced_accuracy: 0.65597 | valid_accuracy: 0.65612 |  0:11:09s
epoch 39 | loss: 0.60785 | train_auc: 0.71374 | train_balanced_accuracy: 0.65528 | train_accuracy: 0.6556  | valid_auc: 0.70235 | valid_balanced_accuracy: 0.64781 | valid_accuracy: 0.6481  |  0:11:26s
epoch 40 | loss: 0.60595 | train_auc: 0.73301 | train_balanced_accuracy: 0.66782 | train_accuracy: 0.66819 | valid_auc: 0.71861 | valid_balanced_accuracy: 0.65731 | valid_accuracy: 0.6577  |  0:11:41s
epoch 41 | loss: 0.60478 | train_auc: 0.72322 | train_balanced_accuracy: 0.66132 | train_accuracy: 0.66162 | valid_auc: 0.70944 | valid_balanced_accuracy: 0.65187 | valid_accuracy: 0.65219 |  0:11:58s
epoch 42 | loss: 0.6023  | train_auc: 0.71733 | train_balanced_accuracy: 0.65727 | train_accuracy: 0.65749 | valid_auc: 0.70355 | valid_balanced_accuracy: 0.64678 | valid_accuracy: 0.64699 |  0:12:17s
epoch 43 | loss: 0.60617 | train_auc: 0.71193 | train_balanced_accuracy: 0.65569 | train_accuracy: 0.65579 | valid_auc: 0.69829 | valid_balanced_accuracy: 0.63936 | valid_accuracy: 0.63944 |  0:12:33s
epoch 44 | loss: 0.60365 | train_auc: 0.71082 | train_balanced_accuracy: 0.65235 | train_accuracy: 0.65269 | valid_auc: 0.69621 | valid_balanced_accuracy: 0.6361  | valid_accuracy: 0.63645 |  0:12:51s
epoch 45 | loss: 0.60432 | train_auc: 0.71056 | train_balanced_accuracy: 0.65295 | train_accuracy: 0.65312 | valid_auc: 0.69744 | valid_balanced_accuracy: 0.63864 | valid_accuracy: 0.63881 |  0:13:09s
epoch 46 | loss: 0.60324 | train_auc: 0.72071 | train_balanced_accuracy: 0.66048 | train_accuracy: 0.66059 | valid_auc: 0.70793 | valid_balanced_accuracy: 0.65491 | valid_accuracy: 0.65502 |  0:13:27s
epoch 47 | loss: 0.60061 | train_auc: 0.70665 | train_balanced_accuracy: 0.65136 | train_accuracy: 0.65147 | valid_auc: 0.69446 | valid_balanced_accuracy: 0.63777 | valid_accuracy: 0.63787 |  0:13:45s
epoch 48 | loss: 0.597   | train_auc: 0.70606 | train_balanced_accuracy: 0.65476 | train_accuracy: 0.65501 | valid_auc: 0.6936  | valid_balanced_accuracy: 0.6439  | valid_accuracy: 0.64416 |  0:14:02s
epoch 49 | loss: 0.59991 | train_auc: 0.70368 | train_balanced_accuracy: 0.65277 | train_accuracy: 0.65296 | valid_auc: 0.69033 | valid_balanced_accuracy: 0.64084 | valid_accuracy: 0.64101 |  0:14:20s
epoch 50 | loss: 0.59832 | train_auc: 0.66848 | train_balanced_accuracy: 0.62664 | train_accuracy: 0.62719 | valid_auc: 0.66388 | valid_balanced_accuracy: 0.61968 | valid_accuracy: 0.62024 |  0:14:37s
epoch 51 | loss: 0.59697 | train_auc: 0.65508 | train_balanced_accuracy: 0.61611 | train_accuracy: 0.61664 | valid_auc: 0.65472 | valid_balanced_accuracy: 0.61264 | valid_accuracy: 0.61316 |  0:14:55s
epoch 52 | loss: 0.59671 | train_auc: 0.67643 | train_balanced_accuracy: 0.63318 | train_accuracy: 0.63372 | valid_auc: 0.66821 | valid_balanced_accuracy: 0.62469 | valid_accuracy: 0.62528 |  0:15:11s

Early stopping occurred at epoch 52 with best_epoch = 32 and best_valid_accuracy = 0.66037
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 60/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=15.3min
[CV 2/5; 60/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82605 | train_auc: 0.50298 | train_balanced_accuracy: 0.52417 | train_accuracy: 0.52174 | valid_auc: 0.49484 | valid_balanced_accuracy: 0.51333 | valid_accuracy: 0.51086 |  0:00:16s
epoch 1  | loss: 0.73837 | train_auc: 0.50421 | train_balanced_accuracy: 0.5209  | train_accuracy: 0.51832 | valid_auc: 0.50206 | valid_balanced_accuracy: 0.51207 | valid_accuracy: 0.50944 |  0:00:35s
epoch 2  | loss: 0.70758 | train_auc: 0.5185  | train_balanced_accuracy: 0.51408 | train_accuracy: 0.51127 | valid_auc: 0.5189  | valid_balanced_accuracy: 0.50948 | valid_accuracy: 0.50661 |  0:00:52s
epoch 3  | loss: 0.69213 | train_auc: 0.54124 | train_balanced_accuracy: 0.51721 | train_accuracy: 0.51438 | valid_auc: 0.54181 | valid_balanced_accuracy: 0.5188  | valid_accuracy: 0.5159  |  0:01:09s
epoch 4  | loss: 0.67641 | train_auc: 0.56347 | train_balanced_accuracy: 0.52623 | train_accuracy: 0.52339 | valid_auc: 0.56214 | valid_balanced_accuracy: 0.52557 | valid_accuracy: 0.52266 |  0:01:26s
epoch 5  | loss: 0.67054 | train_auc: 0.5804  | train_balanced_accuracy: 0.5297  | train_accuracy: 0.52693 | valid_auc: 0.57587 | valid_balanced_accuracy: 0.53021 | valid_accuracy: 0.52738 |  0:01:44s
epoch 6  | loss: 0.66774 | train_auc: 0.59307 | train_balanced_accuracy: 0.53874 | train_accuracy: 0.53606 | valid_auc: 0.58692 | valid_balanced_accuracy: 0.53674 | valid_accuracy: 0.53399 |  0:02:02s
epoch 7  | loss: 0.66261 | train_auc: 0.60231 | train_balanced_accuracy: 0.54547 | train_accuracy: 0.54287 | valid_auc: 0.59393 | valid_balanced_accuracy: 0.54359 | valid_accuracy: 0.54092 |  0:02:20s
epoch 8  | loss: 0.65189 | train_auc: 0.61366 | train_balanced_accuracy: 0.55621 | train_accuracy: 0.55385 | valid_auc: 0.60542 | valid_balanced_accuracy: 0.55533 | valid_accuracy: 0.55288 |  0:02:38s
epoch 9  | loss: 0.65538 | train_auc: 0.62252 | train_balanced_accuracy: 0.56333 | train_accuracy: 0.56105 | valid_auc: 0.61311 | valid_balanced_accuracy: 0.55916 | valid_accuracy: 0.55681 |  0:02:55s
epoch 10 | loss: 0.64685 | train_auc: 0.63691 | train_balanced_accuracy: 0.57107 | train_accuracy: 0.56899 | valid_auc: 0.62743 | valid_balanced_accuracy: 0.56791 | valid_accuracy: 0.56579 |  0:03:14s
epoch 11 | loss: 0.64346 | train_auc: 0.64915 | train_balanced_accuracy: 0.58067 | train_accuracy: 0.57879 | valid_auc: 0.64    | valid_balanced_accuracy: 0.57542 | valid_accuracy: 0.5735  |  0:03:30s
epoch 12 | loss: 0.64114 | train_auc: 0.6582  | train_balanced_accuracy: 0.58956 | train_accuracy: 0.58784 | valid_auc: 0.65019 | valid_balanced_accuracy: 0.58154 | valid_accuracy: 0.57979 |  0:03:48s
epoch 13 | loss: 0.63934 | train_auc: 0.66661 | train_balanced_accuracy: 0.59501 | train_accuracy: 0.59335 | valid_auc: 0.66027 | valid_balanced_accuracy: 0.58415 | valid_accuracy: 0.58247 |  0:04:05s
epoch 14 | loss: 0.63833 | train_auc: 0.67354 | train_balanced_accuracy: 0.602   | train_accuracy: 0.60051 | valid_auc: 0.66801 | valid_balanced_accuracy: 0.58837 | valid_accuracy: 0.58687 |  0:04:23s
epoch 15 | loss: 0.63065 | train_auc: 0.67799 | train_balanced_accuracy: 0.60503 | train_accuracy: 0.60362 | valid_auc: 0.67274 | valid_balanced_accuracy: 0.59287 | valid_accuracy: 0.59144 |  0:04:41s
epoch 16 | loss: 0.63236 | train_auc: 0.68359 | train_balanced_accuracy: 0.61083 | train_accuracy: 0.60952 | valid_auc: 0.67953 | valid_balanced_accuracy: 0.59905 | valid_accuracy: 0.59773 |  0:05:00s
epoch 17 | loss: 0.6306  | train_auc: 0.68816 | train_balanced_accuracy: 0.62402 | train_accuracy: 0.62294 | valid_auc: 0.68464 | valid_balanced_accuracy: 0.61521 | valid_accuracy: 0.6141  |  0:05:17s
epoch 18 | loss: 0.62835 | train_auc: 0.69277 | train_balanced_accuracy: 0.63597 | train_accuracy: 0.63525 | valid_auc: 0.68868 | valid_balanced_accuracy: 0.63376 | valid_accuracy: 0.63299 |  0:05:33s
epoch 19 | loss: 0.62492 | train_auc: 0.69628 | train_balanced_accuracy: 0.63684 | train_accuracy: 0.63608 | valid_auc: 0.6933  | valid_balanced_accuracy: 0.63504 | valid_accuracy: 0.63425 |  0:05:52s
epoch 20 | loss: 0.62465 | train_auc: 0.69909 | train_balanced_accuracy: 0.64265 | train_accuracy: 0.64218 | valid_auc: 0.69538 | valid_balanced_accuracy: 0.64168 | valid_accuracy: 0.64117 |  0:06:08s
epoch 21 | loss: 0.6225  | train_auc: 0.70167 | train_balanced_accuracy: 0.64299 | train_accuracy: 0.64261 | valid_auc: 0.69771 | valid_balanced_accuracy: 0.64235 | valid_accuracy: 0.64196 |  0:06:26s
epoch 22 | loss: 0.62592 | train_auc: 0.7046  | train_balanced_accuracy: 0.6445  | train_accuracy: 0.64419 | valid_auc: 0.70114 | valid_balanced_accuracy: 0.64197 | valid_accuracy: 0.64164 |  0:06:42s
epoch 23 | loss: 0.62148 | train_auc: 0.70934 | train_balanced_accuracy: 0.64612 | train_accuracy: 0.6458  | valid_auc: 0.70504 | valid_balanced_accuracy: 0.64293 | valid_accuracy: 0.64259 |  0:07:00s
epoch 24 | loss: 0.62075 | train_auc: 0.71242 | train_balanced_accuracy: 0.64856 | train_accuracy: 0.64832 | valid_auc: 0.70908 | valid_balanced_accuracy: 0.64741 | valid_accuracy: 0.64715 |  0:07:17s
epoch 25 | loss: 0.61744 | train_auc: 0.71375 | train_balanced_accuracy: 0.64905 | train_accuracy: 0.64887 | valid_auc: 0.71034 | valid_balanced_accuracy: 0.6491  | valid_accuracy: 0.64888 |  0:07:32s
epoch 26 | loss: 0.61615 | train_auc: 0.71689 | train_balanced_accuracy: 0.65179 | train_accuracy: 0.65162 | valid_auc: 0.71409 | valid_balanced_accuracy: 0.65239 | valid_accuracy: 0.65219 |  0:07:49s
epoch 27 | loss: 0.61561 | train_auc: 0.72078 | train_balanced_accuracy: 0.65432 | train_accuracy: 0.65418 | valid_auc: 0.7168  | valid_balanced_accuracy: 0.65348 | valid_accuracy: 0.65329 |  0:08:06s
epoch 28 | loss: 0.61406 | train_auc: 0.72289 | train_balanced_accuracy: 0.65588 | train_accuracy: 0.65579 | valid_auc: 0.71984 | valid_balanced_accuracy: 0.6575  | valid_accuracy: 0.65738 |  0:08:22s
epoch 29 | loss: 0.61256 | train_auc: 0.7265  | train_balanced_accuracy: 0.65962 | train_accuracy: 0.65941 | valid_auc: 0.72197 | valid_balanced_accuracy: 0.65761 | valid_accuracy: 0.65738 |  0:08:40s
epoch 30 | loss: 0.60954 | train_auc: 0.7315  | train_balanced_accuracy: 0.66867 | train_accuracy: 0.66874 | valid_auc: 0.72613 | valid_balanced_accuracy: 0.66189 | valid_accuracy: 0.66195 |  0:08:59s
epoch 31 | loss: 0.61107 | train_auc: 0.73466 | train_balanced_accuracy: 0.67272 | train_accuracy: 0.67291 | valid_auc: 0.7291  | valid_balanced_accuracy: 0.6695  | valid_accuracy: 0.66966 |  0:09:15s
epoch 32 | loss: 0.61285 | train_auc: 0.73749 | train_balanced_accuracy: 0.6768  | train_accuracy: 0.677   | valid_auc: 0.73069 | valid_balanced_accuracy: 0.67171 | valid_accuracy: 0.67186 |  0:09:34s
epoch 33 | loss: 0.60861 | train_auc: 0.73804 | train_balanced_accuracy: 0.67719 | train_accuracy: 0.67728 | valid_auc: 0.73173 | valid_balanced_accuracy: 0.67343 | valid_accuracy: 0.67343 |  0:09:50s
epoch 34 | loss: 0.60776 | train_auc: 0.73875 | train_balanced_accuracy: 0.67863 | train_accuracy: 0.67885 | valid_auc: 0.73081 | valid_balanced_accuracy: 0.67168 | valid_accuracy: 0.67186 |  0:10:07s
epoch 35 | loss: 0.60794 | train_auc: 0.74037 | train_balanced_accuracy: 0.67896 | train_accuracy: 0.67936 | valid_auc: 0.73194 | valid_balanced_accuracy: 0.67259 | valid_accuracy: 0.67296 |  0:10:24s
epoch 36 | loss: 0.60503 | train_auc: 0.73969 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67921 | valid_auc: 0.73208 | valid_balanced_accuracy: 0.67432 | valid_accuracy: 0.67454 |  0:10:41s
epoch 37 | loss: 0.60283 | train_auc: 0.73786 | train_balanced_accuracy: 0.6771  | train_accuracy: 0.67747 | valid_auc: 0.73027 | valid_balanced_accuracy: 0.67624 | valid_accuracy: 0.67658 |  0:11:00s
epoch 38 | loss: 0.60461 | train_auc: 0.7445  | train_balanced_accuracy: 0.68076 | train_accuracy: 0.6809  | valid_auc: 0.73701 | valid_balanced_accuracy: 0.67586 | valid_accuracy: 0.67595 |  0:11:17s
epoch 39 | loss: 0.60319 | train_auc: 0.74162 | train_balanced_accuracy: 0.67777 | train_accuracy: 0.67806 | valid_auc: 0.7348  | valid_balanced_accuracy: 0.67428 | valid_accuracy: 0.67454 |  0:11:35s
epoch 40 | loss: 0.60492 | train_auc: 0.73609 | train_balanced_accuracy: 0.67724 | train_accuracy: 0.67751 | valid_auc: 0.73048 | valid_balanced_accuracy: 0.67224 | valid_accuracy: 0.67249 |  0:11:54s
epoch 41 | loss: 0.6049  | train_auc: 0.74055 | train_balanced_accuracy: 0.67745 | train_accuracy: 0.67779 | valid_auc: 0.73399 | valid_balanced_accuracy: 0.67154 | valid_accuracy: 0.67186 |  0:12:11s
epoch 42 | loss: 0.60013 | train_auc: 0.72999 | train_balanced_accuracy: 0.6726  | train_accuracy: 0.67295 | valid_auc: 0.72489 | valid_balanced_accuracy: 0.66588 | valid_accuracy: 0.66619 |  0:12:29s
epoch 43 | loss: 0.60478 | train_auc: 0.71282 | train_balanced_accuracy: 0.65547 | train_accuracy: 0.65579 | valid_auc: 0.71096 | valid_balanced_accuracy: 0.6609  | valid_accuracy: 0.66116 |  0:12:46s
epoch 44 | loss: 0.59624 | train_auc: 0.7199  | train_balanced_accuracy: 0.66271 | train_accuracy: 0.66323 | valid_auc: 0.71738 | valid_balanced_accuracy: 0.66256 | valid_accuracy: 0.66305 |  0:13:03s
epoch 45 | loss: 0.5979  | train_auc: 0.70886 | train_balanced_accuracy: 0.65511 | train_accuracy: 0.65548 | valid_auc: 0.70912 | valid_balanced_accuracy: 0.65546 | valid_accuracy: 0.65581 |  0:13:20s
epoch 46 | loss: 0.59919 | train_auc: 0.70781 | train_balanced_accuracy: 0.65144 | train_accuracy: 0.65178 | valid_auc: 0.70896 | valid_balanced_accuracy: 0.65831 | valid_accuracy: 0.65864 |  0:13:36s
epoch 47 | loss: 0.59916 | train_auc: 0.67875 | train_balanced_accuracy: 0.62817 | train_accuracy: 0.62845 | valid_auc: 0.6774  | valid_balanced_accuracy: 0.62482 | valid_accuracy: 0.62512 |  0:13:54s
epoch 48 | loss: 0.59662 | train_auc: 0.68088 | train_balanced_accuracy: 0.62566 | train_accuracy: 0.62617 | valid_auc: 0.68238 | valid_balanced_accuracy: 0.63276 | valid_accuracy: 0.6333  |  0:14:10s
epoch 49 | loss: 0.59934 | train_auc: 0.67834 | train_balanced_accuracy: 0.62828 | train_accuracy: 0.62861 | valid_auc: 0.67865 | valid_balanced_accuracy: 0.62872 | valid_accuracy: 0.62905 |  0:14:27s
epoch 50 | loss: 0.59801 | train_auc: 0.6924  | train_balanced_accuracy: 0.63795 | train_accuracy: 0.63825 | valid_auc: 0.69168 | valid_balanced_accuracy: 0.63583 | valid_accuracy: 0.63613 |  0:14:44s
epoch 51 | loss: 0.59552 | train_auc: 0.71768 | train_balanced_accuracy: 0.65905 | train_accuracy: 0.65949 | valid_auc: 0.71344 | valid_balanced_accuracy: 0.65888 | valid_accuracy: 0.65927 |  0:15:02s
epoch 52 | loss: 0.59252 | train_auc: 0.70587 | train_balanced_accuracy: 0.65007 | train_accuracy: 0.6504  | valid_auc: 0.70384 | valid_balanced_accuracy: 0.65044 | valid_accuracy: 0.65077 |  0:15:20s
epoch 53 | loss: 0.5953  | train_auc: 0.73125 | train_balanced_accuracy: 0.67048 | train_accuracy: 0.6709  | valid_auc: 0.72647 | valid_balanced_accuracy: 0.66313 | valid_accuracy: 0.66352 |  0:15:38s
epoch 54 | loss: 0.59695 | train_auc: 0.72208 | train_balanced_accuracy: 0.66242 | train_accuracy: 0.66272 | valid_auc: 0.71762 | valid_balanced_accuracy: 0.65887 | valid_accuracy: 0.65911 |  0:15:56s
epoch 55 | loss: 0.59953 | train_auc: 0.7364  | train_balanced_accuracy: 0.67479 | train_accuracy: 0.67503 | valid_auc: 0.73038 | valid_balanced_accuracy: 0.67999 | valid_accuracy: 0.6802  |  0:16:13s
epoch 56 | loss: 0.59702 | train_auc: 0.75374 | train_balanced_accuracy: 0.68492 | train_accuracy: 0.68526 | valid_auc: 0.74515 | valid_balanced_accuracy: 0.6838  | valid_accuracy: 0.68414 |  0:16:31s
epoch 57 | loss: 0.59417 | train_auc: 0.75669 | train_balanced_accuracy: 0.68844 | train_accuracy: 0.68877 | valid_auc: 0.74534 | valid_balanced_accuracy: 0.68385 | valid_accuracy: 0.68414 |  0:16:50s
epoch 58 | loss: 0.59198 | train_auc: 0.7567  | train_balanced_accuracy: 0.69034 | train_accuracy: 0.69046 | valid_auc: 0.74486 | valid_balanced_accuracy: 0.6812  | valid_accuracy: 0.6813  |  0:17:07s
epoch 59 | loss: 0.59576 | train_auc: 0.75606 | train_balanced_accuracy: 0.68934 | train_accuracy: 0.68959 | valid_auc: 0.74391 | valid_balanced_accuracy: 0.68266 | valid_accuracy: 0.68288 |  0:17:24s
epoch 60 | loss: 0.59317 | train_auc: 0.74949 | train_balanced_accuracy: 0.68381 | train_accuracy: 0.68408 | valid_auc: 0.74054 | valid_balanced_accuracy: 0.67916 | valid_accuracy: 0.67941 |  0:17:40s
epoch 61 | loss: 0.59255 | train_auc: 0.72213 | train_balanced_accuracy: 0.65989 | train_accuracy: 0.66004 | valid_auc: 0.71636 | valid_balanced_accuracy: 0.65492 | valid_accuracy: 0.65502 |  0:17:55s
epoch 62 | loss: 0.59127 | train_auc: 0.73726 | train_balanced_accuracy: 0.67452 | train_accuracy: 0.675   | valid_auc: 0.73001 | valid_balanced_accuracy: 0.67018 | valid_accuracy: 0.6706  |  0:18:12s
epoch 63 | loss: 0.59386 | train_auc: 0.76003 | train_balanced_accuracy: 0.69257 | train_accuracy: 0.69274 | valid_auc: 0.74721 | valid_balanced_accuracy: 0.68306 | valid_accuracy: 0.68319 |  0:18:29s
epoch 64 | loss: 0.5941  | train_auc: 0.69648 | train_balanced_accuracy: 0.63879 | train_accuracy: 0.63919 | valid_auc: 0.69372 | valid_balanced_accuracy: 0.63688 | valid_accuracy: 0.63724 |  0:18:46s
epoch 65 | loss: 0.59415 | train_auc: 0.65456 | train_balanced_accuracy: 0.61463 | train_accuracy: 0.61519 | valid_auc: 0.65134 | valid_balanced_accuracy: 0.61261 | valid_accuracy: 0.61316 |  0:19:04s
epoch 66 | loss: 0.59435 | train_auc: 0.65932 | train_balanced_accuracy: 0.6161  | train_accuracy: 0.61653 | valid_auc: 0.65562 | valid_balanced_accuracy: 0.61165 | valid_accuracy: 0.61206 |  0:19:21s
epoch 67 | loss: 0.58753 | train_auc: 0.71643 | train_balanced_accuracy: 0.65758 | train_accuracy: 0.65808 | valid_auc: 0.71122 | valid_balanced_accuracy: 0.6574  | valid_accuracy: 0.65785 |  0:19:40s
epoch 68 | loss: 0.59025 | train_auc: 0.72824 | train_balanced_accuracy: 0.66625 | train_accuracy: 0.66657 | valid_auc: 0.72058 | valid_balanced_accuracy: 0.6571  | valid_accuracy: 0.65738 |  0:19:57s
epoch 69 | loss: 0.59017 | train_auc: 0.72536 | train_balanced_accuracy: 0.66424 | train_accuracy: 0.66449 | valid_auc: 0.71816 | valid_balanced_accuracy: 0.66064 | valid_accuracy: 0.66084 |  0:20:14s
epoch 70 | loss: 0.59041 | train_auc: 0.74162 | train_balanced_accuracy: 0.67541 | train_accuracy: 0.67574 | valid_auc: 0.73259 | valid_balanced_accuracy: 0.66893 | valid_accuracy: 0.66918 |  0:20:31s
epoch 71 | loss: 0.59235 | train_auc: 0.73583 | train_balanced_accuracy: 0.67251 | train_accuracy: 0.67275 | valid_auc: 0.72742 | valid_balanced_accuracy: 0.65989 | valid_accuracy: 0.66006 |  0:20:47s
epoch 72 | loss: 0.58619 | train_auc: 0.74843 | train_balanced_accuracy: 0.68332 | train_accuracy: 0.68353 | valid_auc: 0.7365  | valid_balanced_accuracy: 0.67075 | valid_accuracy: 0.67092 |  0:21:03s
epoch 73 | loss: 0.58866 | train_auc: 0.76381 | train_balanced_accuracy: 0.69351 | train_accuracy: 0.6938  | valid_auc: 0.74769 | valid_balanced_accuracy: 0.68229 | valid_accuracy: 0.68256 |  0:21:20s
epoch 74 | loss: 0.59029 | train_auc: 0.7473  | train_balanced_accuracy: 0.68063 | train_accuracy: 0.68098 | valid_auc: 0.73653 | valid_balanced_accuracy: 0.6703  | valid_accuracy: 0.6706  |  0:21:38s
epoch 75 | loss: 0.59051 | train_auc: 0.75899 | train_balanced_accuracy: 0.692   | train_accuracy: 0.69219 | valid_auc: 0.74546 | valid_balanced_accuracy: 0.67988 | valid_accuracy: 0.68004 |  0:21:56s
epoch 76 | loss: 0.59159 | train_auc: 0.75729 | train_balanced_accuracy: 0.68998 | train_accuracy: 0.69018 | valid_auc: 0.74395 | valid_balanced_accuracy: 0.67989 | valid_accuracy: 0.68004 |  0:22:14s

Early stopping occurred at epoch 76 with best_epoch = 56 and best_valid_accuracy = 0.68414
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 60/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.674 total time=22.4min
[CV 3/5; 60/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82608 | train_auc: 0.49104 | train_balanced_accuracy: 0.52059 | train_accuracy: 0.5181  | valid_auc: 0.49058 | valid_balanced_accuracy: 0.51606 | valid_accuracy: 0.51353 |  0:00:17s
epoch 1  | loss: 0.73256 | train_auc: 0.50781 | train_balanced_accuracy: 0.51496 | train_accuracy: 0.5122  | valid_auc: 0.50941 | valid_balanced_accuracy: 0.51556 | valid_accuracy: 0.51275 |  0:00:34s
epoch 2  | loss: 0.7049  | train_auc: 0.51934 | train_balanced_accuracy: 0.51044 | train_accuracy: 0.50744 | valid_auc: 0.52462 | valid_balanced_accuracy: 0.50963 | valid_accuracy: 0.50661 |  0:00:52s
epoch 3  | loss: 0.69254 | train_auc: 0.53809 | train_balanced_accuracy: 0.51059 | train_accuracy: 0.50748 | valid_auc: 0.54443 | valid_balanced_accuracy: 0.51353 | valid_accuracy: 0.51039 |  0:01:08s
epoch 4  | loss: 0.68138 | train_auc: 0.55714 | train_balanced_accuracy: 0.51833 | train_accuracy: 0.51523 | valid_auc: 0.5598  | valid_balanced_accuracy: 0.52121 | valid_accuracy: 0.5181  |  0:01:28s
epoch 5  | loss: 0.67325 | train_auc: 0.57479 | train_balanced_accuracy: 0.52491 | train_accuracy: 0.52188 | valid_auc: 0.57367 | valid_balanced_accuracy: 0.52791 | valid_accuracy: 0.52487 |  0:01:45s
epoch 6  | loss: 0.66711 | train_auc: 0.59293 | train_balanced_accuracy: 0.53432 | train_accuracy: 0.53148 | valid_auc: 0.58803 | valid_balanced_accuracy: 0.53921 | valid_accuracy: 0.53636 |  0:02:01s
epoch 7  | loss: 0.66393 | train_auc: 0.60653 | train_balanced_accuracy: 0.54013 | train_accuracy: 0.53734 | valid_auc: 0.60005 | valid_balanced_accuracy: 0.54326 | valid_accuracy: 0.54045 |  0:02:18s
epoch 8  | loss: 0.65923 | train_auc: 0.6166  | train_balanced_accuracy: 0.54978 | train_accuracy: 0.54721 | valid_auc: 0.60977 | valid_balanced_accuracy: 0.54889 | valid_accuracy: 0.54627 |  0:02:36s
epoch 9  | loss: 0.65513 | train_auc: 0.62442 | train_balanced_accuracy: 0.55784 | train_accuracy: 0.5554  | valid_auc: 0.61707 | valid_balanced_accuracy: 0.55504 | valid_accuracy: 0.55257 |  0:02:55s
epoch 10 | loss: 0.64688 | train_auc: 0.63434 | train_balanced_accuracy: 0.57152 | train_accuracy: 0.56933 | valid_auc: 0.6254  | valid_balanced_accuracy: 0.56314 | valid_accuracy: 0.56091 |  0:03:12s
epoch 11 | loss: 0.64884 | train_auc: 0.6447  | train_balanced_accuracy: 0.58225 | train_accuracy: 0.5803  | valid_auc: 0.63416 | valid_balanced_accuracy: 0.57638 | valid_accuracy: 0.57444 |  0:03:29s
epoch 12 | loss: 0.64445 | train_auc: 0.65176 | train_balanced_accuracy: 0.58798 | train_accuracy: 0.58617 | valid_auc: 0.6422  | valid_balanced_accuracy: 0.58425 | valid_accuracy: 0.58247 |  0:03:46s
epoch 13 | loss: 0.6421  | train_auc: 0.66356 | train_balanced_accuracy: 0.59482 | train_accuracy: 0.59313 | valid_auc: 0.65374 | valid_balanced_accuracy: 0.59199 | valid_accuracy: 0.59034 |  0:04:03s
epoch 14 | loss: 0.63829 | train_auc: 0.67345 | train_balanced_accuracy: 0.60447 | train_accuracy: 0.60301 | valid_auc: 0.66314 | valid_balanced_accuracy: 0.60278 | valid_accuracy: 0.60135 |  0:04:23s
epoch 15 | loss: 0.63737 | train_auc: 0.68239 | train_balanced_accuracy: 0.60728 | train_accuracy: 0.6058  | valid_auc: 0.67231 | valid_balanced_accuracy: 0.60141 | valid_accuracy: 0.59994 |  0:04:40s
epoch 16 | loss: 0.63352 | train_auc: 0.68751 | train_balanced_accuracy: 0.61541 | train_accuracy: 0.61414 | valid_auc: 0.67807 | valid_balanced_accuracy: 0.60956 | valid_accuracy: 0.60828 |  0:04:58s
epoch 17 | loss: 0.63113 | train_auc: 0.69041 | train_balanced_accuracy: 0.62136 | train_accuracy: 0.62024 | valid_auc: 0.6826  | valid_balanced_accuracy: 0.61614 | valid_accuracy: 0.61505 |  0:05:15s
epoch 18 | loss: 0.6336  | train_auc: 0.69584 | train_balanced_accuracy: 0.63362 | train_accuracy: 0.63275 | valid_auc: 0.68755 | valid_balanced_accuracy: 0.62501 | valid_accuracy: 0.62417 |  0:05:32s
epoch 19 | loss: 0.63027 | train_auc: 0.69887 | train_balanced_accuracy: 0.63638 | train_accuracy: 0.63554 | valid_auc: 0.6901  | valid_balanced_accuracy: 0.62954 | valid_accuracy: 0.62874 |  0:05:47s
epoch 20 | loss: 0.63095 | train_auc: 0.70226 | train_balanced_accuracy: 0.64059 | train_accuracy: 0.63987 | valid_auc: 0.69253 | valid_balanced_accuracy: 0.63134 | valid_accuracy: 0.63063 |  0:06:04s
epoch 21 | loss: 0.62428 | train_auc: 0.70589 | train_balanced_accuracy: 0.64357 | train_accuracy: 0.64298 | valid_auc: 0.69461 | valid_balanced_accuracy: 0.63357 | valid_accuracy: 0.63299 |  0:06:21s
epoch 22 | loss: 0.62612 | train_auc: 0.70937 | train_balanced_accuracy: 0.64952 | train_accuracy: 0.64924 | valid_auc: 0.69813 | valid_balanced_accuracy: 0.64477 | valid_accuracy: 0.64448 |  0:06:38s
epoch 23 | loss: 0.6235  | train_auc: 0.7117  | train_balanced_accuracy: 0.65059 | train_accuracy: 0.65026 | valid_auc: 0.69827 | valid_balanced_accuracy: 0.6426  | valid_accuracy: 0.64227 |  0:06:57s
epoch 24 | loss: 0.62631 | train_auc: 0.71343 | train_balanced_accuracy: 0.65212 | train_accuracy: 0.65183 | valid_auc: 0.70046 | valid_balanced_accuracy: 0.646   | valid_accuracy: 0.64573 |  0:07:13s
epoch 25 | loss: 0.62178 | train_auc: 0.71655 | train_balanced_accuracy: 0.65689 | train_accuracy: 0.65675 | valid_auc: 0.7025  | valid_balanced_accuracy: 0.6498  | valid_accuracy: 0.64967 |  0:07:30s
epoch 26 | loss: 0.62026 | train_auc: 0.71835 | train_balanced_accuracy: 0.65973 | train_accuracy: 0.65974 | valid_auc: 0.70392 | valid_balanced_accuracy: 0.65251 | valid_accuracy: 0.6525  |  0:07:48s
epoch 27 | loss: 0.6215  | train_auc: 0.72    | train_balanced_accuracy: 0.66219 | train_accuracy: 0.66218 | valid_auc: 0.70561 | valid_balanced_accuracy: 0.65423 | valid_accuracy: 0.65423 |  0:08:06s
epoch 28 | loss: 0.61813 | train_auc: 0.7223  | train_balanced_accuracy: 0.66253 | train_accuracy: 0.66254 | valid_auc: 0.70636 | valid_balanced_accuracy: 0.65235 | valid_accuracy: 0.65234 |  0:08:22s
epoch 29 | loss: 0.62056 | train_auc: 0.72441 | train_balanced_accuracy: 0.66648 | train_accuracy: 0.66659 | valid_auc: 0.70972 | valid_balanced_accuracy: 0.65746 | valid_accuracy: 0.65754 |  0:08:40s
epoch 30 | loss: 0.61501 | train_auc: 0.72633 | train_balanced_accuracy: 0.66785 | train_accuracy: 0.668   | valid_auc: 0.7123  | valid_balanced_accuracy: 0.66072 | valid_accuracy: 0.66084 |  0:08:58s
epoch 31 | loss: 0.61848 | train_auc: 0.72853 | train_balanced_accuracy: 0.67014 | train_accuracy: 0.67029 | valid_auc: 0.71445 | valid_balanced_accuracy: 0.66248 | valid_accuracy: 0.66257 |  0:09:16s
epoch 32 | loss: 0.61269 | train_auc: 0.73009 | train_balanced_accuracy: 0.67214 | train_accuracy: 0.67237 | valid_auc: 0.71552 | valid_balanced_accuracy: 0.65936 | valid_accuracy: 0.65958 |  0:09:33s
epoch 33 | loss: 0.61933 | train_auc: 0.73134 | train_balanced_accuracy: 0.67209 | train_accuracy: 0.67233 | valid_auc: 0.71627 | valid_balanced_accuracy: 0.65765 | valid_accuracy: 0.65785 |  0:09:50s
epoch 34 | loss: 0.61455 | train_auc: 0.73431 | train_balanced_accuracy: 0.67274 | train_accuracy: 0.67288 | valid_auc: 0.71815 | valid_balanced_accuracy: 0.65851 | valid_accuracy: 0.65864 |  0:10:08s
epoch 35 | loss: 0.60793 | train_auc: 0.73594 | train_balanced_accuracy: 0.6765  | train_accuracy: 0.67682 | valid_auc: 0.71889 | valid_balanced_accuracy: 0.65897 | valid_accuracy: 0.65927 |  0:10:23s
epoch 36 | loss: 0.6128  | train_auc: 0.73686 | train_balanced_accuracy: 0.67694 | train_accuracy: 0.67725 | valid_auc: 0.71917 | valid_balanced_accuracy: 0.66071 | valid_accuracy: 0.661   |  0:10:40s
epoch 37 | loss: 0.61189 | train_auc: 0.7353  | train_balanced_accuracy: 0.67465 | train_accuracy: 0.67501 | valid_auc: 0.71804 | valid_balanced_accuracy: 0.66081 | valid_accuracy: 0.66116 |  0:10:58s
epoch 38 | loss: 0.60976 | train_auc: 0.73856 | train_balanced_accuracy: 0.67627 | train_accuracy: 0.67638 | valid_auc: 0.72025 | valid_balanced_accuracy: 0.66151 | valid_accuracy: 0.66163 |  0:11:15s
epoch 39 | loss: 0.60362 | train_auc: 0.73929 | train_balanced_accuracy: 0.67672 | train_accuracy: 0.67686 | valid_auc: 0.72115 | valid_balanced_accuracy: 0.66576 | valid_accuracy: 0.66588 |  0:11:32s
epoch 40 | loss: 0.60859 | train_auc: 0.73043 | train_balanced_accuracy: 0.66777 | train_accuracy: 0.66769 | valid_auc: 0.71879 | valid_balanced_accuracy: 0.6652  | valid_accuracy: 0.66509 |  0:11:50s
epoch 41 | loss: 0.60798 | train_auc: 0.74008 | train_balanced_accuracy: 0.67747 | train_accuracy: 0.67764 | valid_auc: 0.72411 | valid_balanced_accuracy: 0.66713 | valid_accuracy: 0.6673  |  0:12:06s
epoch 42 | loss: 0.60297 | train_auc: 0.74254 | train_balanced_accuracy: 0.67997 | train_accuracy: 0.68016 | valid_auc: 0.72334 | valid_balanced_accuracy: 0.66412 | valid_accuracy: 0.66431 |  0:12:25s
epoch 43 | loss: 0.60693 | train_auc: 0.74406 | train_balanced_accuracy: 0.68141 | train_accuracy: 0.68154 | valid_auc: 0.72381 | valid_balanced_accuracy: 0.66432 | valid_accuracy: 0.66446 |  0:12:43s
epoch 44 | loss: 0.60849 | train_auc: 0.74517 | train_balanced_accuracy: 0.68265 | train_accuracy: 0.68272 | valid_auc: 0.72411 | valid_balanced_accuracy: 0.66687 | valid_accuracy: 0.66698 |  0:13:01s
epoch 45 | loss: 0.60274 | train_auc: 0.74468 | train_balanced_accuracy: 0.68148 | train_accuracy: 0.68174 | valid_auc: 0.72586 | valid_balanced_accuracy: 0.66656 | valid_accuracy: 0.66682 |  0:13:19s
epoch 46 | loss: 0.60825 | train_auc: 0.74729 | train_balanced_accuracy: 0.68358 | train_accuracy: 0.68382 | valid_auc: 0.72503 | valid_balanced_accuracy: 0.66139 | valid_accuracy: 0.66163 |  0:13:37s
epoch 47 | loss: 0.60366 | train_auc: 0.74587 | train_balanced_accuracy: 0.68323 | train_accuracy: 0.68335 | valid_auc: 0.72512 | valid_balanced_accuracy: 0.66765 | valid_accuracy: 0.66777 |  0:13:55s
epoch 48 | loss: 0.60505 | train_auc: 0.74721 | train_balanced_accuracy: 0.68414 | train_accuracy: 0.68437 | valid_auc: 0.7263  | valid_balanced_accuracy: 0.6718  | valid_accuracy: 0.67202 |  0:14:13s
epoch 49 | loss: 0.59967 | train_auc: 0.74658 | train_balanced_accuracy: 0.68222 | train_accuracy: 0.6824  | valid_auc: 0.72646 | valid_balanced_accuracy: 0.6687  | valid_accuracy: 0.66887 |  0:14:31s
epoch 50 | loss: 0.60316 | train_auc: 0.73544 | train_balanced_accuracy: 0.67124 | train_accuracy: 0.67123 | valid_auc: 0.72187 | valid_balanced_accuracy: 0.66778 | valid_accuracy: 0.66777 |  0:14:47s
epoch 51 | loss: 0.59876 | train_auc: 0.71661 | train_balanced_accuracy: 0.65788 | train_accuracy: 0.65789 | valid_auc: 0.71152 | valid_balanced_accuracy: 0.65578 | valid_accuracy: 0.65581 |  0:15:04s
epoch 52 | loss: 0.59511 | train_auc: 0.71551 | train_balanced_accuracy: 0.65574 | train_accuracy: 0.65573 | valid_auc: 0.71109 | valid_balanced_accuracy: 0.65345 | valid_accuracy: 0.65345 |  0:15:22s
epoch 53 | loss: 0.59734 | train_auc: 0.68926 | train_balanced_accuracy: 0.63586 | train_accuracy: 0.6361  | valid_auc: 0.69021 | valid_balanced_accuracy: 0.64074 | valid_accuracy: 0.64101 |  0:15:39s
epoch 54 | loss: 0.60055 | train_auc: 0.67456 | train_balanced_accuracy: 0.62949 | train_accuracy: 0.62949 | valid_auc: 0.67656 | valid_balanced_accuracy: 0.62862 | valid_accuracy: 0.62858 |  0:15:57s
epoch 55 | loss: 0.5984  | train_auc: 0.66897 | train_balanced_accuracy: 0.62516 | train_accuracy: 0.62528 | valid_auc: 0.66672 | valid_balanced_accuracy: 0.62468 | valid_accuracy: 0.6248  |  0:16:15s
epoch 56 | loss: 0.59877 | train_auc: 0.65686 | train_balanced_accuracy: 0.61295 | train_accuracy: 0.61316 | valid_auc: 0.65146 | valid_balanced_accuracy: 0.60907 | valid_accuracy: 0.60922 |  0:16:33s
epoch 57 | loss: 0.60076 | train_auc: 0.66046 | train_balanced_accuracy: 0.61717 | train_accuracy: 0.61725 | valid_auc: 0.65703 | valid_balanced_accuracy: 0.61406 | valid_accuracy: 0.6141  |  0:16:51s
epoch 58 | loss: 0.6004  | train_auc: 0.6846  | train_balanced_accuracy: 0.63539 | train_accuracy: 0.63535 | valid_auc: 0.68745 | valid_balanced_accuracy: 0.63934 | valid_accuracy: 0.63928 |  0:17:08s
epoch 59 | loss: 0.59678 | train_auc: 0.71917 | train_balanced_accuracy: 0.65965 | train_accuracy: 0.65962 | valid_auc: 0.71341 | valid_balanced_accuracy: 0.65867 | valid_accuracy: 0.65864 |  0:17:24s
epoch 60 | loss: 0.59714 | train_auc: 0.75263 | train_balanced_accuracy: 0.68692 | train_accuracy: 0.68705 | valid_auc: 0.7351  | valid_balanced_accuracy: 0.67488 | valid_accuracy: 0.67501 |  0:17:40s
epoch 61 | loss: 0.59774 | train_auc: 0.75069 | train_balanced_accuracy: 0.68747 | train_accuracy: 0.68756 | valid_auc: 0.73534 | valid_balanced_accuracy: 0.67853 | valid_accuracy: 0.67863 |  0:17:58s
epoch 62 | loss: 0.59309 | train_auc: 0.7497  | train_balanced_accuracy: 0.68727 | train_accuracy: 0.68752 | valid_auc: 0.73354 | valid_balanced_accuracy: 0.6727  | valid_accuracy: 0.67296 |  0:18:14s
epoch 63 | loss: 0.59445 | train_auc: 0.731   | train_balanced_accuracy: 0.67472 | train_accuracy: 0.67485 | valid_auc: 0.72155 | valid_balanced_accuracy: 0.66657 | valid_accuracy: 0.66667 |  0:18:32s
epoch 64 | loss: 0.59014 | train_auc: 0.73896 | train_balanced_accuracy: 0.68036 | train_accuracy: 0.68052 | valid_auc: 0.72628 | valid_balanced_accuracy: 0.66634 | valid_accuracy: 0.66651 |  0:18:51s
epoch 65 | loss: 0.59056 | train_auc: 0.75595 | train_balanced_accuracy: 0.69237 | train_accuracy: 0.69252 | valid_auc: 0.73716 | valid_balanced_accuracy: 0.67911 | valid_accuracy: 0.67926 |  0:19:08s
epoch 66 | loss: 0.59491 | train_auc: 0.75982 | train_balanced_accuracy: 0.69307 | train_accuracy: 0.69326 | valid_auc: 0.7352  | valid_balanced_accuracy: 0.67749 | valid_accuracy: 0.67768 |  0:19:27s
epoch 67 | loss: 0.59014 | train_auc: 0.75061 | train_balanced_accuracy: 0.68437 | train_accuracy: 0.68473 | valid_auc: 0.72937 | valid_balanced_accuracy: 0.67293 | valid_accuracy: 0.67328 |  0:19:45s
epoch 68 | loss: 0.59425 | train_auc: 0.75692 | train_balanced_accuracy: 0.69157 | train_accuracy: 0.69173 | valid_auc: 0.73793 | valid_balanced_accuracy: 0.67815 | valid_accuracy: 0.67831 |  0:20:03s
epoch 69 | loss: 0.59369 | train_auc: 0.75338 | train_balanced_accuracy: 0.68798 | train_accuracy: 0.68819 | valid_auc: 0.73496 | valid_balanced_accuracy: 0.67432 | valid_accuracy: 0.67454 |  0:20:21s
epoch 70 | loss: 0.59208 | train_auc: 0.75314 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.6887  | valid_auc: 0.73507 | valid_balanced_accuracy: 0.67442 | valid_accuracy: 0.67469 |  0:20:39s
epoch 71 | loss: 0.59425 | train_auc: 0.76001 | train_balanced_accuracy: 0.69105 | train_accuracy: 0.6913  | valid_auc: 0.73777 | valid_balanced_accuracy: 0.67442 | valid_accuracy: 0.67469 |  0:20:56s
epoch 72 | loss: 0.5937  | train_auc: 0.75871 | train_balanced_accuracy: 0.69195 | train_accuracy: 0.69204 | valid_auc: 0.73721 | valid_balanced_accuracy: 0.67365 | valid_accuracy: 0.67375 |  0:21:12s
epoch 73 | loss: 0.58696 | train_auc: 0.76059 | train_balanced_accuracy: 0.69333 | train_accuracy: 0.69374 | valid_auc: 0.73575 | valid_balanced_accuracy: 0.67446 | valid_accuracy: 0.67485 |  0:21:29s
epoch 74 | loss: 0.59204 | train_auc: 0.75855 | train_balanced_accuracy: 0.69211 | train_accuracy: 0.69232 | valid_auc: 0.73586 | valid_balanced_accuracy: 0.67735 | valid_accuracy: 0.67753 |  0:21:45s
epoch 75 | loss: 0.59364 | train_auc: 0.75898 | train_balanced_accuracy: 0.69267 | train_accuracy: 0.69279 | valid_auc: 0.73534 | valid_balanced_accuracy: 0.67602 | valid_accuracy: 0.67611 |  0:22:02s
epoch 76 | loss: 0.59268 | train_auc: 0.75933 | train_balanced_accuracy: 0.69299 | train_accuracy: 0.69322 | valid_auc: 0.73525 | valid_balanced_accuracy: 0.67746 | valid_accuracy: 0.67768 |  0:22:20s
epoch 77 | loss: 0.58778 | train_auc: 0.7598  | train_balanced_accuracy: 0.6922  | train_accuracy: 0.69248 | valid_auc: 0.73506 | valid_balanced_accuracy: 0.67333 | valid_accuracy: 0.67359 |  0:22:39s
epoch 78 | loss: 0.58511 | train_auc: 0.74863 | train_balanced_accuracy: 0.6831  | train_accuracy: 0.68327 | valid_auc: 0.73064 | valid_balanced_accuracy: 0.67467 | valid_accuracy: 0.67485 |  0:22:56s
epoch 79 | loss: 0.58511 | train_auc: 0.74936 | train_balanced_accuracy: 0.68408 | train_accuracy: 0.68441 | valid_auc: 0.73081 | valid_balanced_accuracy: 0.67198 | valid_accuracy: 0.67233 |  0:23:13s
epoch 80 | loss: 0.59156 | train_auc: 0.70984 | train_balanced_accuracy: 0.64979 | train_accuracy: 0.64983 | valid_auc: 0.7053  | valid_balanced_accuracy: 0.6509  | valid_accuracy: 0.65093 |  0:23:29s
epoch 81 | loss: 0.59176 | train_auc: 0.69202 | train_balanced_accuracy: 0.64175 | train_accuracy: 0.64184 | valid_auc: 0.68961 | valid_balanced_accuracy: 0.63452 | valid_accuracy: 0.63456 |  0:23:47s
epoch 82 | loss: 0.58707 | train_auc: 0.71399 | train_balanced_accuracy: 0.65314 | train_accuracy: 0.65317 | valid_auc: 0.7063  | valid_balanced_accuracy: 0.64821 | valid_accuracy: 0.64825 |  0:24:06s
epoch 83 | loss: 0.58941 | train_auc: 0.73991 | train_balanced_accuracy: 0.67455 | train_accuracy: 0.67481 | valid_auc: 0.72642 | valid_balanced_accuracy: 0.67175 | valid_accuracy: 0.67202 |  0:24:23s
epoch 84 | loss: 0.59407 | train_auc: 0.71743 | train_balanced_accuracy: 0.65746 | train_accuracy: 0.65742 | valid_auc: 0.70999 | valid_balanced_accuracy: 0.65679 | valid_accuracy: 0.65675 |  0:24:42s
epoch 85 | loss: 0.59133 | train_auc: 0.70547 | train_balanced_accuracy: 0.65066 | train_accuracy: 0.65077 | valid_auc: 0.70126 | valid_balanced_accuracy: 0.64848 | valid_accuracy: 0.64857 |  0:25:01s

Early stopping occurred at epoch 85 with best_epoch = 65 and best_valid_accuracy = 0.67926
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 60/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.684 total time=25.1min
[CV 4/5; 60/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82984 | train_auc: 0.48879 | train_balanced_accuracy: 0.52203 | train_accuracy: 0.51955 | valid_auc: 0.4844  | valid_balanced_accuracy: 0.51778 | valid_accuracy: 0.51527 |  0:00:16s
epoch 1  | loss: 0.73833 | train_auc: 0.50629 | train_balanced_accuracy: 0.5174  | train_accuracy: 0.51468 | valid_auc: 0.5042  | valid_balanced_accuracy: 0.51426 | valid_accuracy: 0.51149 |  0:00:33s
epoch 2  | loss: 0.70154 | train_auc: 0.52972 | train_balanced_accuracy: 0.51346 | train_accuracy: 0.51058 | valid_auc: 0.53064 | valid_balanced_accuracy: 0.51252 | valid_accuracy: 0.5096  |  0:00:52s
epoch 3  | loss: 0.69317 | train_auc: 0.55202 | train_balanced_accuracy: 0.51969 | train_accuracy: 0.5168  | valid_auc: 0.55341 | valid_balanced_accuracy: 0.5177  | valid_accuracy: 0.51479 |  0:01:10s
epoch 4  | loss: 0.68245 | train_auc: 0.56753 | train_balanced_accuracy: 0.5268  | train_accuracy: 0.524   | valid_auc: 0.56818 | valid_balanced_accuracy: 0.52658 | valid_accuracy: 0.52376 |  0:01:27s
epoch 5  | loss: 0.67545 | train_auc: 0.5843  | train_balanced_accuracy: 0.53472 | train_accuracy: 0.53207 | valid_auc: 0.58212 | valid_balanced_accuracy: 0.53525 | valid_accuracy: 0.53258 |  0:01:46s
epoch 6  | loss: 0.66675 | train_auc: 0.60135 | train_balanced_accuracy: 0.54338 | train_accuracy: 0.54092 | valid_auc: 0.59469 | valid_balanced_accuracy: 0.54043 | valid_accuracy: 0.53793 |  0:02:02s
epoch 7  | loss: 0.66377 | train_auc: 0.61207 | train_balanced_accuracy: 0.55249 | train_accuracy: 0.55005 | valid_auc: 0.60289 | valid_balanced_accuracy: 0.54654 | valid_accuracy: 0.54407 |  0:02:18s
epoch 8  | loss: 0.65849 | train_auc: 0.62183 | train_balanced_accuracy: 0.56556 | train_accuracy: 0.56335 | valid_auc: 0.61073 | valid_balanced_accuracy: 0.55716 | valid_accuracy: 0.55493 |  0:02:35s
epoch 9  | loss: 0.6533  | train_auc: 0.63084 | train_balanced_accuracy: 0.56947 | train_accuracy: 0.56724 | valid_auc: 0.61884 | valid_balanced_accuracy: 0.56107 | valid_accuracy: 0.55886 |  0:02:52s
epoch 10 | loss: 0.64766 | train_auc: 0.6422  | train_balanced_accuracy: 0.5802  | train_accuracy: 0.57826 | valid_auc: 0.62891 | valid_balanced_accuracy: 0.56752 | valid_accuracy: 0.56563 |  0:03:09s
epoch 11 | loss: 0.64922 | train_auc: 0.65068 | train_balanced_accuracy: 0.58917 | train_accuracy: 0.5875  | valid_auc: 0.63589 | valid_balanced_accuracy: 0.57486 | valid_accuracy: 0.57318 |  0:03:26s
epoch 12 | loss: 0.64031 | train_auc: 0.66284 | train_balanced_accuracy: 0.59811 | train_accuracy: 0.59663 | valid_auc: 0.64733 | valid_balanced_accuracy: 0.58175 | valid_accuracy: 0.58026 |  0:03:43s
epoch 13 | loss: 0.64042 | train_auc: 0.66895 | train_balanced_accuracy: 0.60138 | train_accuracy: 0.59986 | valid_auc: 0.65364 | valid_balanced_accuracy: 0.58588 | valid_accuracy: 0.58436 |  0:04:01s
epoch 14 | loss: 0.63736 | train_auc: 0.67576 | train_balanced_accuracy: 0.61124 | train_accuracy: 0.61013 | valid_auc: 0.65992 | valid_balanced_accuracy: 0.59634 | valid_accuracy: 0.59522 |  0:04:19s
epoch 15 | loss: 0.63995 | train_auc: 0.68334 | train_balanced_accuracy: 0.61346 | train_accuracy: 0.61225 | valid_auc: 0.66694 | valid_balanced_accuracy: 0.59784 | valid_accuracy: 0.59663 |  0:04:37s
epoch 16 | loss: 0.63162 | train_auc: 0.68792 | train_balanced_accuracy: 0.62322 | train_accuracy: 0.62221 | valid_auc: 0.67172 | valid_balanced_accuracy: 0.60725 | valid_accuracy: 0.60623 |  0:04:53s
epoch 17 | loss: 0.6257  | train_auc: 0.6901  | train_balanced_accuracy: 0.62545 | train_accuracy: 0.62453 | valid_auc: 0.67498 | valid_balanced_accuracy: 0.61265 | valid_accuracy: 0.61174 |  0:05:12s
epoch 18 | loss: 0.63454 | train_auc: 0.69602 | train_balanced_accuracy: 0.6348  | train_accuracy: 0.63409 | valid_auc: 0.68176 | valid_balanced_accuracy: 0.62108 | valid_accuracy: 0.6204  |  0:05:29s
epoch 19 | loss: 0.62411 | train_auc: 0.70052 | train_balanced_accuracy: 0.64025 | train_accuracy: 0.63968 | valid_auc: 0.68661 | valid_balanced_accuracy: 0.62962 | valid_accuracy: 0.62905 |  0:05:47s
epoch 20 | loss: 0.62452 | train_auc: 0.70421 | train_balanced_accuracy: 0.64369 | train_accuracy: 0.64326 | valid_auc: 0.69055 | valid_balanced_accuracy: 0.63259 | valid_accuracy: 0.6322  |  0:06:03s
epoch 21 | loss: 0.62295 | train_auc: 0.70594 | train_balanced_accuracy: 0.64285 | train_accuracy: 0.64243 | valid_auc: 0.69262 | valid_balanced_accuracy: 0.63432 | valid_accuracy: 0.63393 |  0:06:19s
epoch 22 | loss: 0.62486 | train_auc: 0.71044 | train_balanced_accuracy: 0.65132 | train_accuracy: 0.6512  | valid_auc: 0.69639 | valid_balanced_accuracy: 0.64363 | valid_accuracy: 0.64353 |  0:06:36s
epoch 23 | loss: 0.62014 | train_auc: 0.71345 | train_balanced_accuracy: 0.6524  | train_accuracy: 0.65215 | valid_auc: 0.69824 | valid_balanced_accuracy: 0.64251 | valid_accuracy: 0.64227 |  0:06:54s
epoch 24 | loss: 0.62098 | train_auc: 0.71455 | train_balanced_accuracy: 0.65428 | train_accuracy: 0.65408 | valid_auc: 0.69986 | valid_balanced_accuracy: 0.64436 | valid_accuracy: 0.64416 |  0:07:10s
epoch 25 | loss: 0.61624 | train_auc: 0.71697 | train_balanced_accuracy: 0.6567  | train_accuracy: 0.65663 | valid_auc: 0.70166 | valid_balanced_accuracy: 0.64519 | valid_accuracy: 0.64511 |  0:07:28s
epoch 26 | loss: 0.61484 | train_auc: 0.71954 | train_balanced_accuracy: 0.66118 | train_accuracy: 0.6612  | valid_auc: 0.70368 | valid_balanced_accuracy: 0.64621 | valid_accuracy: 0.64621 |  0:07:43s
epoch 27 | loss: 0.61683 | train_auc: 0.72018 | train_balanced_accuracy: 0.66139 | train_accuracy: 0.66139 | valid_auc: 0.70448 | valid_balanced_accuracy: 0.64747 | valid_accuracy: 0.64747 |  0:08:01s
epoch 28 | loss: 0.61428 | train_auc: 0.72537 | train_balanced_accuracy: 0.66432 | train_accuracy: 0.66435 | valid_auc: 0.7095  | valid_balanced_accuracy: 0.65154 | valid_accuracy: 0.65156 |  0:08:17s
epoch 29 | loss: 0.61266 | train_auc: 0.72508 | train_balanced_accuracy: 0.66427 | train_accuracy: 0.66438 | valid_auc: 0.71015 | valid_balanced_accuracy: 0.65272 | valid_accuracy: 0.65282 |  0:08:33s
epoch 30 | loss: 0.60741 | train_auc: 0.73212 | train_balanced_accuracy: 0.67021 | train_accuracy: 0.67048 | valid_auc: 0.717   | valid_balanced_accuracy: 0.66105 | valid_accuracy: 0.66132 |  0:08:50s
epoch 31 | loss: 0.60942 | train_auc: 0.734   | train_balanced_accuracy: 0.6723  | train_accuracy: 0.67265 | valid_auc: 0.71767 | valid_balanced_accuracy: 0.66459 | valid_accuracy: 0.66494 |  0:09:08s
epoch 32 | loss: 0.60606 | train_auc: 0.73182 | train_balanced_accuracy: 0.67066 | train_accuracy: 0.67111 | valid_auc: 0.71851 | valid_balanced_accuracy: 0.66322 | valid_accuracy: 0.66368 |  0:09:25s
epoch 33 | loss: 0.6104  | train_auc: 0.72898 | train_balanced_accuracy: 0.66707 | train_accuracy: 0.66749 | valid_auc: 0.71641 | valid_balanced_accuracy: 0.65947 | valid_accuracy: 0.6599  |  0:09:43s
epoch 34 | loss: 0.60764 | train_auc: 0.74047 | train_balanced_accuracy: 0.6766  | train_accuracy: 0.67694 | valid_auc: 0.72424 | valid_balanced_accuracy: 0.6669  | valid_accuracy: 0.6673  |  0:10:00s
epoch 35 | loss: 0.60299 | train_auc: 0.74181 | train_balanced_accuracy: 0.67907 | train_accuracy: 0.67941 | valid_auc: 0.72471 | valid_balanced_accuracy: 0.67005 | valid_accuracy: 0.67044 |  0:10:17s
epoch 36 | loss: 0.60391 | train_auc: 0.74335 | train_balanced_accuracy: 0.67911 | train_accuracy: 0.67938 | valid_auc: 0.72477 | valid_balanced_accuracy: 0.67016 | valid_accuracy: 0.67044 |  0:10:36s
epoch 37 | loss: 0.6019  | train_auc: 0.74194 | train_balanced_accuracy: 0.6794  | train_accuracy: 0.67961 | valid_auc: 0.72504 | valid_balanced_accuracy: 0.66813 | valid_accuracy: 0.6684  |  0:10:54s
epoch 38 | loss: 0.60401 | train_auc: 0.74551 | train_balanced_accuracy: 0.68175 | train_accuracy: 0.68197 | valid_auc: 0.72684 | valid_balanced_accuracy: 0.67205 | valid_accuracy: 0.67233 |  0:11:11s
epoch 39 | loss: 0.60246 | train_auc: 0.746   | train_balanced_accuracy: 0.68192 | train_accuracy: 0.68209 | valid_auc: 0.72753 | valid_balanced_accuracy: 0.66757 | valid_accuracy: 0.66777 |  0:11:28s
epoch 40 | loss: 0.60016 | train_auc: 0.74448 | train_balanced_accuracy: 0.68054 | train_accuracy: 0.68071 | valid_auc: 0.72731 | valid_balanced_accuracy: 0.67009 | valid_accuracy: 0.67029 |  0:11:46s
epoch 41 | loss: 0.60328 | train_auc: 0.73993 | train_balanced_accuracy: 0.67831 | train_accuracy: 0.67863 | valid_auc: 0.72257 | valid_balanced_accuracy: 0.66632 | valid_accuracy: 0.66667 |  0:12:03s
epoch 42 | loss: 0.5995  | train_auc: 0.73971 | train_balanced_accuracy: 0.67809 | train_accuracy: 0.67827 | valid_auc: 0.72257 | valid_balanced_accuracy: 0.66409 | valid_accuracy: 0.66431 |  0:12:21s
epoch 43 | loss: 0.60088 | train_auc: 0.74503 | train_balanced_accuracy: 0.6824  | train_accuracy: 0.6826  | valid_auc: 0.72759 | valid_balanced_accuracy: 0.66846 | valid_accuracy: 0.66871 |  0:12:39s
epoch 44 | loss: 0.60146 | train_auc: 0.74471 | train_balanced_accuracy: 0.68235 | train_accuracy: 0.68248 | valid_auc: 0.72735 | valid_balanced_accuracy: 0.66443 | valid_accuracy: 0.66462 |  0:12:57s
epoch 45 | loss: 0.59744 | train_auc: 0.73939 | train_balanced_accuracy: 0.67743 | train_accuracy: 0.67776 | valid_auc: 0.72261 | valid_balanced_accuracy: 0.66503 | valid_accuracy: 0.66541 |  0:13:12s
epoch 46 | loss: 0.60424 | train_auc: 0.7418  | train_balanced_accuracy: 0.68015 | train_accuracy: 0.6804  | valid_auc: 0.72454 | valid_balanced_accuracy: 0.66713 | valid_accuracy: 0.66745 |  0:13:28s
epoch 47 | loss: 0.59656 | train_auc: 0.73323 | train_balanced_accuracy: 0.67134 | train_accuracy: 0.67155 | valid_auc: 0.72086 | valid_balanced_accuracy: 0.66183 | valid_accuracy: 0.6621  |  0:13:45s
epoch 48 | loss: 0.5992  | train_auc: 0.74297 | train_balanced_accuracy: 0.67908 | train_accuracy: 0.67945 | valid_auc: 0.7255  | valid_balanced_accuracy: 0.66306 | valid_accuracy: 0.66352 |  0:14:03s
epoch 49 | loss: 0.59771 | train_auc: 0.74069 | train_balanced_accuracy: 0.67792 | train_accuracy: 0.67823 | valid_auc: 0.72339 | valid_balanced_accuracy: 0.66332 | valid_accuracy: 0.66368 |  0:14:20s
epoch 50 | loss: 0.59963 | train_auc: 0.72365 | train_balanced_accuracy: 0.66574 | train_accuracy: 0.66619 | valid_auc: 0.70734 | valid_balanced_accuracy: 0.65764 | valid_accuracy: 0.65817 |  0:14:36s
epoch 51 | loss: 0.59424 | train_auc: 0.68563 | train_balanced_accuracy: 0.62949 | train_accuracy: 0.63035 | valid_auc: 0.67769 | valid_balanced_accuracy: 0.62621 | valid_accuracy: 0.62716 |  0:14:52s
epoch 52 | loss: 0.59139 | train_auc: 0.67049 | train_balanced_accuracy: 0.62128 | train_accuracy: 0.62205 | valid_auc: 0.66993 | valid_balanced_accuracy: 0.61829 | valid_accuracy: 0.61914 |  0:15:09s
epoch 53 | loss: 0.59413 | train_auc: 0.69064 | train_balanced_accuracy: 0.63515 | train_accuracy: 0.63586 | valid_auc: 0.684   | valid_balanced_accuracy: 0.62986 | valid_accuracy: 0.63063 |  0:15:24s
epoch 54 | loss: 0.59741 | train_auc: 0.65927 | train_balanced_accuracy: 0.61657 | train_accuracy: 0.61709 | valid_auc: 0.65835 | valid_balanced_accuracy: 0.61838 | valid_accuracy: 0.61898 |  0:15:40s
epoch 55 | loss: 0.59411 | train_auc: 0.64571 | train_balanced_accuracy: 0.61078 | train_accuracy: 0.61154 | valid_auc: 0.64016 | valid_balanced_accuracy: 0.61007 | valid_accuracy: 0.61095 |  0:15:59s
epoch 56 | loss: 0.59385 | train_auc: 0.62784 | train_balanced_accuracy: 0.59233 | train_accuracy: 0.59282 | valid_auc: 0.63489 | valid_balanced_accuracy: 0.60581 | valid_accuracy: 0.60639 |  0:16:16s
epoch 57 | loss: 0.59611 | train_auc: 0.63254 | train_balanced_accuracy: 0.59972 | train_accuracy: 0.60025 | valid_auc: 0.63427 | valid_balanced_accuracy: 0.607   | valid_accuracy: 0.60765 |  0:16:32s
epoch 58 | loss: 0.59682 | train_auc: 0.64142 | train_balanced_accuracy: 0.60472 | train_accuracy: 0.60513 | valid_auc: 0.64608 | valid_balanced_accuracy: 0.60931 | valid_accuracy: 0.60985 |  0:16:49s

Early stopping occurred at epoch 58 with best_epoch = 38 and best_valid_accuracy = 0.67233
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 60/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.672 total time=16.9min
[CV 5/5; 60/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.84175 | train_auc: 0.47817 | train_balanced_accuracy: 0.51667 | train_accuracy: 0.5144  | valid_auc: 0.47891 | valid_balanced_accuracy: 0.51921 | valid_accuracy: 0.51684 |  0:00:18s
epoch 1  | loss: 0.75409 | train_auc: 0.48347 | train_balanced_accuracy: 0.51804 | train_accuracy: 0.51562 | valid_auc: 0.48575 | valid_balanced_accuracy: 0.52076 | valid_accuracy: 0.51826 |  0:00:33s
epoch 2  | loss: 0.71658 | train_auc: 0.51061 | train_balanced_accuracy: 0.51269 | train_accuracy: 0.51007 | valid_auc: 0.51273 | valid_balanced_accuracy: 0.5181  | valid_accuracy: 0.51542 |  0:00:50s
epoch 3  | loss: 0.69343 | train_auc: 0.54229 | train_balanced_accuracy: 0.5208  | train_accuracy: 0.51806 | valid_auc: 0.54246 | valid_balanced_accuracy: 0.52658 | valid_accuracy: 0.52376 |  0:01:07s
epoch 4  | loss: 0.67584 | train_auc: 0.56955 | train_balanced_accuracy: 0.53019 | train_accuracy: 0.52762 | valid_auc: 0.56898 | valid_balanced_accuracy: 0.53363 | valid_accuracy: 0.531   |  0:01:22s
epoch 5  | loss: 0.67003 | train_auc: 0.59315 | train_balanced_accuracy: 0.53651 | train_accuracy: 0.53392 | valid_auc: 0.58963 | valid_balanced_accuracy: 0.54167 | valid_accuracy: 0.53903 |  0:01:40s
epoch 6  | loss: 0.66319 | train_auc: 0.60944 | train_balanced_accuracy: 0.54907 | train_accuracy: 0.5467  | valid_auc: 0.60602 | valid_balanced_accuracy: 0.55684 | valid_accuracy: 0.55445 |  0:01:57s
epoch 7  | loss: 0.65787 | train_auc: 0.62181 | train_balanced_accuracy: 0.56036 | train_accuracy: 0.55807 | valid_auc: 0.61913 | valid_balanced_accuracy: 0.56498 | valid_accuracy: 0.56264 |  0:02:14s
epoch 8  | loss: 0.65265 | train_auc: 0.63348 | train_balanced_accuracy: 0.5758  | train_accuracy: 0.57377 | valid_auc: 0.62942 | valid_balanced_accuracy: 0.57557 | valid_accuracy: 0.5735  |  0:02:31s
epoch 9  | loss: 0.64783 | train_auc: 0.64393 | train_balanced_accuracy: 0.58592 | train_accuracy: 0.58408 | valid_auc: 0.63998 | valid_balanced_accuracy: 0.58311 | valid_accuracy: 0.58121 |  0:02:50s
epoch 10 | loss: 0.64691 | train_auc: 0.65346 | train_balanced_accuracy: 0.59841 | train_accuracy: 0.59683 | valid_auc: 0.64984 | valid_balanced_accuracy: 0.59368 | valid_accuracy: 0.59207 |  0:03:09s
epoch 11 | loss: 0.64133 | train_auc: 0.66163 | train_balanced_accuracy: 0.60589 | train_accuracy: 0.6045  | valid_auc: 0.65708 | valid_balanced_accuracy: 0.60042 | valid_accuracy: 0.59899 |  0:03:26s
epoch 12 | loss: 0.64145 | train_auc: 0.6698  | train_balanced_accuracy: 0.61089 | train_accuracy: 0.60958 | valid_auc: 0.66521 | valid_balanced_accuracy: 0.60366 | valid_accuracy: 0.6023  |  0:03:43s
epoch 13 | loss: 0.64305 | train_auc: 0.6794  | train_balanced_accuracy: 0.61272 | train_accuracy: 0.6115  | valid_auc: 0.67503 | valid_balanced_accuracy: 0.60779 | valid_accuracy: 0.60655 |  0:04:01s
epoch 14 | loss: 0.63297 | train_auc: 0.68823 | train_balanced_accuracy: 0.62265 | train_accuracy: 0.62169 | valid_auc: 0.68291 | valid_balanced_accuracy: 0.61714 | valid_accuracy: 0.61615 |  0:04:18s
epoch 15 | loss: 0.63127 | train_auc: 0.69473 | train_balanced_accuracy: 0.62692 | train_accuracy: 0.62594 | valid_auc: 0.68833 | valid_balanced_accuracy: 0.61919 | valid_accuracy: 0.61819 |  0:04:34s
epoch 16 | loss: 0.63071 | train_auc: 0.70168 | train_balanced_accuracy: 0.63695 | train_accuracy: 0.63625 | valid_auc: 0.69481 | valid_balanced_accuracy: 0.63074 | valid_accuracy: 0.63    |  0:04:51s
epoch 17 | loss: 0.62982 | train_auc: 0.70373 | train_balanced_accuracy: 0.63925 | train_accuracy: 0.63865 | valid_auc: 0.69637 | valid_balanced_accuracy: 0.63534 | valid_accuracy: 0.63472 |  0:05:11s
epoch 18 | loss: 0.62997 | train_auc: 0.70721 | train_balanced_accuracy: 0.64469 | train_accuracy: 0.64428 | valid_auc: 0.69893 | valid_balanced_accuracy: 0.64222 | valid_accuracy: 0.6418  |  0:05:28s
epoch 19 | loss: 0.62511 | train_auc: 0.70974 | train_balanced_accuracy: 0.64906 | train_accuracy: 0.64876 | valid_auc: 0.70079 | valid_balanced_accuracy: 0.63864 | valid_accuracy: 0.63834 |  0:05:47s
epoch 20 | loss: 0.62183 | train_auc: 0.71209 | train_balanced_accuracy: 0.65559 | train_accuracy: 0.65549 | valid_auc: 0.70334 | valid_balanced_accuracy: 0.64331 | valid_accuracy: 0.64322 |  0:06:06s
epoch 21 | loss: 0.62056 | train_auc: 0.71573 | train_balanced_accuracy: 0.65925 | train_accuracy: 0.65923 | valid_auc: 0.70608 | valid_balanced_accuracy: 0.6475  | valid_accuracy: 0.64747 |  0:06:23s
epoch 22 | loss: 0.61793 | train_auc: 0.71795 | train_balanced_accuracy: 0.66159 | train_accuracy: 0.66179 | valid_auc: 0.70802 | valid_balanced_accuracy: 0.65245 | valid_accuracy: 0.65266 |  0:06:41s
epoch 23 | loss: 0.61695 | train_auc: 0.72002 | train_balanced_accuracy: 0.66232 | train_accuracy: 0.6625  | valid_auc: 0.71027 | valid_balanced_accuracy: 0.65309 | valid_accuracy: 0.65329 |  0:06:58s
epoch 24 | loss: 0.6202  | train_auc: 0.72227 | train_balanced_accuracy: 0.66442 | train_accuracy: 0.66474 | valid_auc: 0.71236 | valid_balanced_accuracy: 0.65657 | valid_accuracy: 0.65691 |  0:07:15s
epoch 25 | loss: 0.61676 | train_auc: 0.72508 | train_balanced_accuracy: 0.66418 | train_accuracy: 0.66442 | valid_auc: 0.71352 | valid_balanced_accuracy: 0.65633 | valid_accuracy: 0.65659 |  0:07:33s
epoch 26 | loss: 0.61597 | train_auc: 0.72681 | train_balanced_accuracy: 0.66582 | train_accuracy: 0.66616 | valid_auc: 0.71461 | valid_balanced_accuracy: 0.65594 | valid_accuracy: 0.65628 |  0:07:50s
epoch 27 | loss: 0.61304 | train_auc: 0.72918 | train_balanced_accuracy: 0.66788 | train_accuracy: 0.6682  | valid_auc: 0.71599 | valid_balanced_accuracy: 0.6588  | valid_accuracy: 0.65911 |  0:08:08s
epoch 28 | loss: 0.61439 | train_auc: 0.72903 | train_balanced_accuracy: 0.66777 | train_accuracy: 0.66797 | valid_auc: 0.71615 | valid_balanced_accuracy: 0.65527 | valid_accuracy: 0.65549 |  0:08:27s
epoch 29 | loss: 0.61424 | train_auc: 0.72872 | train_balanced_accuracy: 0.66617 | train_accuracy: 0.66647 | valid_auc: 0.71664 | valid_balanced_accuracy: 0.65235 | valid_accuracy: 0.65266 |  0:08:44s
epoch 30 | loss: 0.61384 | train_auc: 0.72658 | train_balanced_accuracy: 0.66478 | train_accuracy: 0.66509 | valid_auc: 0.71534 | valid_balanced_accuracy: 0.65644 | valid_accuracy: 0.65675 |  0:09:02s
epoch 31 | loss: 0.60972 | train_auc: 0.72417 | train_balanced_accuracy: 0.66346 | train_accuracy: 0.66364 | valid_auc: 0.71394 | valid_balanced_accuracy: 0.65265 | valid_accuracy: 0.65282 |  0:09:19s
epoch 32 | loss: 0.61348 | train_auc: 0.7212  | train_balanced_accuracy: 0.66158 | train_accuracy: 0.66175 | valid_auc: 0.71252 | valid_balanced_accuracy: 0.65389 | valid_accuracy: 0.65408 |  0:09:37s
epoch 33 | loss: 0.615   | train_auc: 0.72682 | train_balanced_accuracy: 0.66556 | train_accuracy: 0.6658  | valid_auc: 0.71532 | valid_balanced_accuracy: 0.65465 | valid_accuracy: 0.65486 |  0:09:54s
epoch 34 | loss: 0.60687 | train_auc: 0.71074 | train_balanced_accuracy: 0.65577 | train_accuracy: 0.656   | valid_auc: 0.70867 | valid_balanced_accuracy: 0.65228 | valid_accuracy: 0.6525  |  0:10:13s
epoch 35 | loss: 0.61096 | train_auc: 0.71645 | train_balanced_accuracy: 0.65957 | train_accuracy: 0.65986 | valid_auc: 0.71113 | valid_balanced_accuracy: 0.65538 | valid_accuracy: 0.65565 |  0:10:30s
epoch 36 | loss: 0.60562 | train_auc: 0.71822 | train_balanced_accuracy: 0.66053 | train_accuracy: 0.6608  | valid_auc: 0.71135 | valid_balanced_accuracy: 0.65415 | valid_accuracy: 0.65439 |  0:10:46s
epoch 37 | loss: 0.60712 | train_auc: 0.72499 | train_balanced_accuracy: 0.66653 | train_accuracy: 0.66678 | valid_auc: 0.71548 | valid_balanced_accuracy: 0.6576  | valid_accuracy: 0.65785 |  0:11:03s
epoch 38 | loss: 0.60802 | train_auc: 0.7217  | train_balanced_accuracy: 0.66343 | train_accuracy: 0.66364 | valid_auc: 0.71576 | valid_balanced_accuracy: 0.65735 | valid_accuracy: 0.65754 |  0:11:22s
epoch 39 | loss: 0.60718 | train_auc: 0.72068 | train_balanced_accuracy: 0.66247 | train_accuracy: 0.66261 | valid_auc: 0.71332 | valid_balanced_accuracy: 0.65394 | valid_accuracy: 0.65408 |  0:11:39s
epoch 40 | loss: 0.60614 | train_auc: 0.71897 | train_balanced_accuracy: 0.66138 | train_accuracy: 0.66159 | valid_auc: 0.71089 | valid_balanced_accuracy: 0.64978 | valid_accuracy: 0.64998 |  0:11:57s
epoch 41 | loss: 0.60611 | train_auc: 0.71961 | train_balanced_accuracy: 0.66232 | train_accuracy: 0.66257 | valid_auc: 0.71095 | valid_balanced_accuracy: 0.65052 | valid_accuracy: 0.65077 |  0:12:15s
epoch 42 | loss: 0.60757 | train_auc: 0.72172 | train_balanced_accuracy: 0.6618  | train_accuracy: 0.66195 | valid_auc: 0.71458 | valid_balanced_accuracy: 0.65249 | valid_accuracy: 0.65266 |  0:12:32s
epoch 43 | loss: 0.60273 | train_auc: 0.74456 | train_balanced_accuracy: 0.68104 | train_accuracy: 0.68138 | valid_auc: 0.72864 | valid_balanced_accuracy: 0.66902 | valid_accuracy: 0.66934 |  0:12:50s
epoch 44 | loss: 0.60249 | train_auc: 0.73839 | train_balanced_accuracy: 0.67721 | train_accuracy: 0.67757 | valid_auc: 0.72553 | valid_balanced_accuracy: 0.66304 | valid_accuracy: 0.66336 |  0:13:08s
epoch 45 | loss: 0.60226 | train_auc: 0.72878 | train_balanced_accuracy: 0.66826 | train_accuracy: 0.66875 | valid_auc: 0.71632 | valid_balanced_accuracy: 0.65739 | valid_accuracy: 0.65785 |  0:13:25s
epoch 46 | loss: 0.60561 | train_auc: 0.72897 | train_balanced_accuracy: 0.67053 | train_accuracy: 0.67092 | valid_auc: 0.71628 | valid_balanced_accuracy: 0.65859 | valid_accuracy: 0.65895 |  0:13:41s
epoch 47 | loss: 0.60543 | train_auc: 0.72897 | train_balanced_accuracy: 0.67063 | train_accuracy: 0.67099 | valid_auc: 0.71689 | valid_balanced_accuracy: 0.65734 | valid_accuracy: 0.6577  |  0:13:58s
epoch 48 | loss: 0.60319 | train_auc: 0.72832 | train_balanced_accuracy: 0.67033 | train_accuracy: 0.67084 | valid_auc: 0.7155  | valid_balanced_accuracy: 0.65705 | valid_accuracy: 0.65754 |  0:14:17s
epoch 49 | loss: 0.5999  | train_auc: 0.73916 | train_balanced_accuracy: 0.67845 | train_accuracy: 0.67875 | valid_auc: 0.72699 | valid_balanced_accuracy: 0.66339 | valid_accuracy: 0.66368 |  0:14:34s
epoch 50 | loss: 0.59878 | train_auc: 0.73322 | train_balanced_accuracy: 0.67263 | train_accuracy: 0.67296 | valid_auc: 0.71984 | valid_balanced_accuracy: 0.65894 | valid_accuracy: 0.65927 |  0:14:50s
epoch 51 | loss: 0.60235 | train_auc: 0.72229 | train_balanced_accuracy: 0.66545 | train_accuracy: 0.66592 | valid_auc: 0.71119 | valid_balanced_accuracy: 0.6524  | valid_accuracy: 0.65282 |  0:15:07s
epoch 52 | loss: 0.60056 | train_auc: 0.72257 | train_balanced_accuracy: 0.66442 | train_accuracy: 0.6649  | valid_auc: 0.71159 | valid_balanced_accuracy: 0.65207 | valid_accuracy: 0.6525  |  0:15:25s
epoch 53 | loss: 0.60444 | train_auc: 0.72638 | train_balanced_accuracy: 0.66911 | train_accuracy: 0.66958 | valid_auc: 0.71406 | valid_balanced_accuracy: 0.65664 | valid_accuracy: 0.65707 |  0:15:42s
epoch 54 | loss: 0.60548 | train_auc: 0.73153 | train_balanced_accuracy: 0.67179 | train_accuracy: 0.67218 | valid_auc: 0.71792 | valid_balanced_accuracy: 0.65921 | valid_accuracy: 0.65958 |  0:16:00s
epoch 55 | loss: 0.60436 | train_auc: 0.73837 | train_balanced_accuracy: 0.67703 | train_accuracy: 0.67737 | valid_auc: 0.72431 | valid_balanced_accuracy: 0.66162 | valid_accuracy: 0.66195 |  0:16:17s
epoch 56 | loss: 0.6034  | train_auc: 0.74594 | train_balanced_accuracy: 0.68359 | train_accuracy: 0.68398 | valid_auc: 0.7312  | valid_balanced_accuracy: 0.66944 | valid_accuracy: 0.66981 |  0:16:33s
epoch 57 | loss: 0.5973  | train_auc: 0.75156 | train_balanced_accuracy: 0.68719 | train_accuracy: 0.68744 | valid_auc: 0.73503 | valid_balanced_accuracy: 0.67476 | valid_accuracy: 0.67501 |  0:16:50s
epoch 58 | loss: 0.59796 | train_auc: 0.74962 | train_balanced_accuracy: 0.6864  | train_accuracy: 0.68658 | valid_auc: 0.7338  | valid_balanced_accuracy: 0.67    | valid_accuracy: 0.67013 |  0:17:08s
epoch 59 | loss: 0.60234 | train_auc: 0.75299 | train_balanced_accuracy: 0.68611 | train_accuracy: 0.68638 | valid_auc: 0.7362  | valid_balanced_accuracy: 0.67272 | valid_accuracy: 0.67296 |  0:17:23s
epoch 60 | loss: 0.6003  | train_auc: 0.75297 | train_balanced_accuracy: 0.68628 | train_accuracy: 0.68646 | valid_auc: 0.7374  | valid_balanced_accuracy: 0.67219 | valid_accuracy: 0.67233 |  0:17:42s
epoch 61 | loss: 0.6044  | train_auc: 0.75339 | train_balanced_accuracy: 0.68791 | train_accuracy: 0.68803 | valid_auc: 0.73766 | valid_balanced_accuracy: 0.67238 | valid_accuracy: 0.67249 |  0:18:01s
epoch 62 | loss: 0.59423 | train_auc: 0.74285 | train_balanced_accuracy: 0.67759 | train_accuracy: 0.67792 | valid_auc: 0.73081 | valid_balanced_accuracy: 0.66604 | valid_accuracy: 0.66635 |  0:18:18s
epoch 63 | loss: 0.59783 | train_auc: 0.74282 | train_balanced_accuracy: 0.67907 | train_accuracy: 0.67938 | valid_auc: 0.73043 | valid_balanced_accuracy: 0.66685 | valid_accuracy: 0.66714 |  0:18:36s
epoch 64 | loss: 0.59452 | train_auc: 0.74611 | train_balanced_accuracy: 0.68112 | train_accuracy: 0.68142 | valid_auc: 0.73302 | valid_balanced_accuracy: 0.66909 | valid_accuracy: 0.66934 |  0:18:53s
epoch 65 | loss: 0.60463 | train_auc: 0.74746 | train_balanced_accuracy: 0.684   | train_accuracy: 0.68414 | valid_auc: 0.73365 | valid_balanced_accuracy: 0.6678  | valid_accuracy: 0.66793 |  0:19:09s
epoch 66 | loss: 0.59613 | train_auc: 0.75068 | train_balanced_accuracy: 0.68745 | train_accuracy: 0.68768 | valid_auc: 0.73399 | valid_balanced_accuracy: 0.6688  | valid_accuracy: 0.66903 |  0:19:27s
epoch 67 | loss: 0.59702 | train_auc: 0.7487  | train_balanced_accuracy: 0.68362 | train_accuracy: 0.68406 | valid_auc: 0.73357 | valid_balanced_accuracy: 0.66738 | valid_accuracy: 0.66777 |  0:19:44s
epoch 68 | loss: 0.59631 | train_auc: 0.74263 | train_balanced_accuracy: 0.67886 | train_accuracy: 0.67914 | valid_auc: 0.72886 | valid_balanced_accuracy: 0.66262 | valid_accuracy: 0.66289 |  0:20:02s
epoch 69 | loss: 0.59611 | train_auc: 0.75656 | train_balanced_accuracy: 0.69045 | train_accuracy: 0.69075 | valid_auc: 0.73915 | valid_balanced_accuracy: 0.67361 | valid_accuracy: 0.67391 |  0:20:19s
epoch 70 | loss: 0.59546 | train_auc: 0.75711 | train_balanced_accuracy: 0.69221 | train_accuracy: 0.69248 | valid_auc: 0.73877 | valid_balanced_accuracy: 0.67321 | valid_accuracy: 0.67343 |  0:20:37s
epoch 71 | loss: 0.59723 | train_auc: 0.75607 | train_balanced_accuracy: 0.69059 | train_accuracy: 0.69094 | valid_auc: 0.73758 | valid_balanced_accuracy: 0.67046 | valid_accuracy: 0.67076 |  0:20:53s
epoch 72 | loss: 0.59299 | train_auc: 0.75839 | train_balanced_accuracy: 0.69347 | train_accuracy: 0.69374 | valid_auc: 0.73754 | valid_balanced_accuracy: 0.67132 | valid_accuracy: 0.67155 |  0:21:12s
epoch 73 | loss: 0.59217 | train_auc: 0.75742 | train_balanced_accuracy: 0.69195 | train_accuracy: 0.69224 | valid_auc: 0.73674 | valid_balanced_accuracy: 0.67413 | valid_accuracy: 0.67438 |  0:21:30s
epoch 74 | loss: 0.59302 | train_auc: 0.75897 | train_balanced_accuracy: 0.69265 | train_accuracy: 0.69283 | valid_auc: 0.73895 | valid_balanced_accuracy: 0.67579 | valid_accuracy: 0.67595 |  0:21:46s
epoch 75 | loss: 0.59123 | train_auc: 0.75971 | train_balanced_accuracy: 0.69121 | train_accuracy: 0.69138 | valid_auc: 0.74092 | valid_balanced_accuracy: 0.67722 | valid_accuracy: 0.67737 |  0:22:03s
epoch 76 | loss: 0.59155 | train_auc: 0.75795 | train_balanced_accuracy: 0.69015 | train_accuracy: 0.69043 | valid_auc: 0.74011 | valid_balanced_accuracy: 0.67646 | valid_accuracy: 0.67674 |  0:22:20s
epoch 77 | loss: 0.59079 | train_auc: 0.74673 | train_balanced_accuracy: 0.68386 | train_accuracy: 0.68418 | valid_auc: 0.73228 | valid_balanced_accuracy: 0.66965 | valid_accuracy: 0.66997 |  0:22:36s
epoch 78 | loss: 0.58992 | train_auc: 0.73444 | train_balanced_accuracy: 0.67137 | train_accuracy: 0.67162 | valid_auc: 0.72367 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.6632  |  0:22:51s
epoch 79 | loss: 0.59063 | train_auc: 0.75578 | train_balanced_accuracy: 0.68978 | train_accuracy: 0.69008 | valid_auc: 0.73876 | valid_balanced_accuracy: 0.67255 | valid_accuracy: 0.6728  |  0:23:07s
epoch 80 | loss: 0.59382 | train_auc: 0.75034 | train_balanced_accuracy: 0.68465 | train_accuracy: 0.68512 | valid_auc: 0.73054 | valid_balanced_accuracy: 0.66671 | valid_accuracy: 0.66714 |  0:23:25s
epoch 81 | loss: 0.58793 | train_auc: 0.75515 | train_balanced_accuracy: 0.68886 | train_accuracy: 0.68905 | valid_auc: 0.73667 | valid_balanced_accuracy: 0.67435 | valid_accuracy: 0.67454 |  0:23:45s
epoch 82 | loss: 0.59098 | train_auc: 0.76161 | train_balanced_accuracy: 0.69445 | train_accuracy: 0.69468 | valid_auc: 0.7399  | valid_balanced_accuracy: 0.67778 | valid_accuracy: 0.678   |  0:24:01s
epoch 83 | loss: 0.58836 | train_auc: 0.7625  | train_balanced_accuracy: 0.69572 | train_accuracy: 0.69602 | valid_auc: 0.73979 | valid_balanced_accuracy: 0.67709 | valid_accuracy: 0.67737 |  0:24:18s
epoch 84 | loss: 0.59088 | train_auc: 0.7545  | train_balanced_accuracy: 0.6884  | train_accuracy: 0.68878 | valid_auc: 0.73438 | valid_balanced_accuracy: 0.67136 | valid_accuracy: 0.6717  |  0:24:37s
epoch 85 | loss: 0.59436 | train_auc: 0.76178 | train_balanced_accuracy: 0.69463 | train_accuracy: 0.69496 | valid_auc: 0.73859 | valid_balanced_accuracy: 0.67692 | valid_accuracy: 0.67721 |  0:24:54s
epoch 86 | loss: 0.58835 | train_auc: 0.75999 | train_balanced_accuracy: 0.69205 | train_accuracy: 0.69244 | valid_auc: 0.73813 | valid_balanced_accuracy: 0.67624 | valid_accuracy: 0.67658 |  0:25:13s
epoch 87 | loss: 0.58709 | train_auc: 0.76294 | train_balanced_accuracy: 0.69649 | train_accuracy: 0.69677 | valid_auc: 0.7388  | valid_balanced_accuracy: 0.67588 | valid_accuracy: 0.67611 |  0:25:31s
epoch 88 | loss: 0.59013 | train_auc: 0.76042 | train_balanced_accuracy: 0.69186 | train_accuracy: 0.69228 | valid_auc: 0.73645 | valid_balanced_accuracy: 0.67353 | valid_accuracy: 0.67391 |  0:25:47s
epoch 89 | loss: 0.58878 | train_auc: 0.7509  | train_balanced_accuracy: 0.68266 | train_accuracy: 0.68319 | valid_auc: 0.73095 | valid_balanced_accuracy: 0.66854 | valid_accuracy: 0.66903 |  0:26:04s
epoch 90 | loss: 0.58553 | train_auc: 0.75969 | train_balanced_accuracy: 0.69197 | train_accuracy: 0.6924  | valid_auc: 0.73854 | valid_balanced_accuracy: 0.67175 | valid_accuracy: 0.67218 |  0:26:21s
epoch 91 | loss: 0.58829 | train_auc: 0.75988 | train_balanced_accuracy: 0.69228 | train_accuracy: 0.6924  | valid_auc: 0.74254 | valid_balanced_accuracy: 0.67787 | valid_accuracy: 0.678   |  0:26:39s
epoch 92 | loss: 0.58346 | train_auc: 0.75607 | train_balanced_accuracy: 0.68853 | train_accuracy: 0.68862 | valid_auc: 0.73988 | valid_balanced_accuracy: 0.67193 | valid_accuracy: 0.67202 |  0:26:55s
epoch 93 | loss: 0.58979 | train_auc: 0.74529 | train_balanced_accuracy: 0.67872 | train_accuracy: 0.67886 | valid_auc: 0.73283 | valid_balanced_accuracy: 0.66102 | valid_accuracy: 0.66116 |  0:27:13s
epoch 94 | loss: 0.58901 | train_auc: 0.73924 | train_balanced_accuracy: 0.67326 | train_accuracy: 0.67343 | valid_auc: 0.72632 | valid_balanced_accuracy: 0.66399 | valid_accuracy: 0.66415 |  0:27:30s
epoch 95 | loss: 0.58258 | train_auc: 0.76165 | train_balanced_accuracy: 0.69423 | train_accuracy: 0.69433 | valid_auc: 0.74009 | valid_balanced_accuracy: 0.67398 | valid_accuracy: 0.67406 |  0:27:46s
epoch 96 | loss: 0.58588 | train_auc: 0.76711 | train_balanced_accuracy: 0.69901 | train_accuracy: 0.69913 | valid_auc: 0.7427  | valid_balanced_accuracy: 0.6776  | valid_accuracy: 0.67768 |  0:28:02s
epoch 97 | loss: 0.58735 | train_auc: 0.76476 | train_balanced_accuracy: 0.69565 | train_accuracy: 0.69578 | valid_auc: 0.74137 | valid_balanced_accuracy: 0.6774  | valid_accuracy: 0.67753 |  0:28:20s
epoch 98 | loss: 0.58816 | train_auc: 0.76415 | train_balanced_accuracy: 0.6958  | train_accuracy: 0.6959  | valid_auc: 0.74003 | valid_balanced_accuracy: 0.67876 | valid_accuracy: 0.67879 |  0:28:36s
epoch 99 | loss: 0.58694 | train_auc: 0.74977 | train_balanced_accuracy: 0.68478 | train_accuracy: 0.68512 | valid_auc: 0.73056 | valid_balanced_accuracy: 0.66779 | valid_accuracy: 0.66808 |  0:28:54s
epoch 100| loss: 0.58377 | train_auc: 0.74944 | train_balanced_accuracy: 0.68402 | train_accuracy: 0.68425 | valid_auc: 0.73119 | valid_balanced_accuracy: 0.67182 | valid_accuracy: 0.67202 |  0:29:12s
epoch 101| loss: 0.59128 | train_auc: 0.76036 | train_balanced_accuracy: 0.69302 | train_accuracy: 0.69326 | valid_auc: 0.73851 | valid_balanced_accuracy: 0.67464 | valid_accuracy: 0.67485 |  0:29:30s
epoch 102| loss: 0.58438 | train_auc: 0.76326 | train_balanced_accuracy: 0.6949  | train_accuracy: 0.69519 | valid_auc: 0.74057 | valid_balanced_accuracy: 0.67728 | valid_accuracy: 0.67753 |  0:29:46s
epoch 103| loss: 0.58351 | train_auc: 0.76051 | train_balanced_accuracy: 0.69159 | train_accuracy: 0.69193 | valid_auc: 0.73941 | valid_balanced_accuracy: 0.67767 | valid_accuracy: 0.678   |  0:30:04s
epoch 104| loss: 0.58125 | train_auc: 0.77037 | train_balanced_accuracy: 0.70269 | train_accuracy: 0.70282 | valid_auc: 0.74324 | valid_balanced_accuracy: 0.67917 | valid_accuracy: 0.67926 |  0:30:22s
epoch 105| loss: 0.58679 | train_auc: 0.77052 | train_balanced_accuracy: 0.70183 | train_accuracy: 0.70208 | valid_auc: 0.74309 | valid_balanced_accuracy: 0.68282 | valid_accuracy: 0.68303 |  0:30:40s
epoch 106| loss: 0.58201 | train_auc: 0.77067 | train_balanced_accuracy: 0.70237 | train_accuracy: 0.70259 | valid_auc: 0.74341 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.6854  |  0:30:58s
epoch 107| loss: 0.5824  | train_auc: 0.77132 | train_balanced_accuracy: 0.70184 | train_accuracy: 0.70208 | valid_auc: 0.74439 | valid_balanced_accuracy: 0.6833  | valid_accuracy: 0.68351 |  0:31:15s
epoch 108| loss: 0.58543 | train_auc: 0.771   | train_balanced_accuracy: 0.70144 | train_accuracy: 0.70153 | valid_auc: 0.7436  | valid_balanced_accuracy: 0.6803  | valid_accuracy: 0.68036 |  0:31:33s
epoch 109| loss: 0.582   | train_auc: 0.76812 | train_balanced_accuracy: 0.70008 | train_accuracy: 0.70011 | valid_auc: 0.74312 | valid_balanced_accuracy: 0.67954 | valid_accuracy: 0.67957 |  0:31:50s
epoch 110| loss: 0.58421 | train_auc: 0.7645  | train_balanced_accuracy: 0.6948  | train_accuracy: 0.69496 | valid_auc: 0.74277 | valid_balanced_accuracy: 0.67912 | valid_accuracy: 0.67926 |  0:32:07s
epoch 111| loss: 0.57777 | train_auc: 0.76233 | train_balanced_accuracy: 0.69324 | train_accuracy: 0.69334 | valid_auc: 0.74148 | valid_balanced_accuracy: 0.67804 | valid_accuracy: 0.67816 |  0:32:23s
epoch 112| loss: 0.58344 | train_auc: 0.7662  | train_balanced_accuracy: 0.69794 | train_accuracy: 0.69814 | valid_auc: 0.74184 | valid_balanced_accuracy: 0.67467 | valid_accuracy: 0.67485 |  0:32:42s
epoch 113| loss: 0.58702 | train_auc: 0.76554 | train_balanced_accuracy: 0.69635 | train_accuracy: 0.69649 | valid_auc: 0.74237 | valid_balanced_accuracy: 0.67648 | valid_accuracy: 0.67658 |  0:33:01s
epoch 114| loss: 0.57987 | train_auc: 0.75958 | train_balanced_accuracy: 0.69033 | train_accuracy: 0.69055 | valid_auc: 0.74097 | valid_balanced_accuracy: 0.67211 | valid_accuracy: 0.67233 |  0:33:18s
epoch 115| loss: 0.58159 | train_auc: 0.77384 | train_balanced_accuracy: 0.70421 | train_accuracy: 0.70444 | valid_auc: 0.74347 | valid_balanced_accuracy: 0.67669 | valid_accuracy: 0.6769  |  0:33:34s
epoch 116| loss: 0.58122 | train_auc: 0.76526 | train_balanced_accuracy: 0.69802 | train_accuracy: 0.69838 | valid_auc: 0.73804 | valid_balanced_accuracy: 0.67313 | valid_accuracy: 0.67343 |  0:33:51s
epoch 117| loss: 0.58252 | train_auc: 0.77604 | train_balanced_accuracy: 0.70704 | train_accuracy: 0.70723 | valid_auc: 0.74511 | valid_balanced_accuracy: 0.68258 | valid_accuracy: 0.68272 |  0:34:08s
epoch 118| loss: 0.58307 | train_auc: 0.77324 | train_balanced_accuracy: 0.70427 | train_accuracy: 0.70444 | valid_auc: 0.744   | valid_balanced_accuracy: 0.67755 | valid_accuracy: 0.67768 |  0:34:26s
epoch 119| loss: 0.58509 | train_auc: 0.76505 | train_balanced_accuracy: 0.6965  | train_accuracy: 0.69677 | valid_auc: 0.74043 | valid_balanced_accuracy: 0.67444 | valid_accuracy: 0.67469 |  0:34:41s
epoch 120| loss: 0.57681 | train_auc: 0.76681 | train_balanced_accuracy: 0.6994  | train_accuracy: 0.69964 | valid_auc: 0.74243 | valid_balanced_accuracy: 0.67541 | valid_accuracy: 0.67564 |  0:34:58s
epoch 121| loss: 0.58375 | train_auc: 0.77529 | train_balanced_accuracy: 0.70566 | train_accuracy: 0.70593 | valid_auc: 0.74397 | valid_balanced_accuracy: 0.68218 | valid_accuracy: 0.6824  |  0:35:17s
epoch 122| loss: 0.57191 | train_auc: 0.76431 | train_balanced_accuracy: 0.69626 | train_accuracy: 0.69665 | valid_auc: 0.73878 | valid_balanced_accuracy: 0.67876 | valid_accuracy: 0.6791  |  0:35:34s
epoch 123| loss: 0.58158 | train_auc: 0.76994 | train_balanced_accuracy: 0.70154 | train_accuracy: 0.70184 | valid_auc: 0.74091 | valid_balanced_accuracy: 0.67633 | valid_accuracy: 0.67658 |  0:35:51s
epoch 124| loss: 0.57869 | train_auc: 0.77395 | train_balanced_accuracy: 0.70468 | train_accuracy: 0.70491 | valid_auc: 0.74507 | valid_balanced_accuracy: 0.68318 | valid_accuracy: 0.68335 |  0:36:09s
epoch 125| loss: 0.58091 | train_auc: 0.77735 | train_balanced_accuracy: 0.70856 | train_accuracy: 0.70873 | valid_auc: 0.74679 | valid_balanced_accuracy: 0.68575 | valid_accuracy: 0.68587 |  0:36:23s
epoch 126| loss: 0.5831  | train_auc: 0.77676 | train_balanced_accuracy: 0.70694 | train_accuracy: 0.70719 | valid_auc: 0.7452  | valid_balanced_accuracy: 0.68078 | valid_accuracy: 0.68099 |  0:36:41s
epoch 127| loss: 0.57807 | train_auc: 0.76764 | train_balanced_accuracy: 0.69697 | train_accuracy: 0.69736 | valid_auc: 0.74076 | valid_balanced_accuracy: 0.67258 | valid_accuracy: 0.67296 |  0:36:58s
epoch 128| loss: 0.57718 | train_auc: 0.75368 | train_balanced_accuracy: 0.68612 | train_accuracy: 0.68658 | valid_auc: 0.73344 | valid_balanced_accuracy: 0.67063 | valid_accuracy: 0.67107 |  0:37:15s
epoch 129| loss: 0.58017 | train_auc: 0.75575 | train_balanced_accuracy: 0.68851 | train_accuracy: 0.68882 | valid_auc: 0.73584 | valid_balanced_accuracy: 0.66795 | valid_accuracy: 0.66824 |  0:37:32s
epoch 130| loss: 0.58112 | train_auc: 0.75401 | train_balanced_accuracy: 0.68685 | train_accuracy: 0.68709 | valid_auc: 0.73423 | valid_balanced_accuracy: 0.66785 | valid_accuracy: 0.66808 |  0:37:49s
epoch 131| loss: 0.58048 | train_auc: 0.75799 | train_balanced_accuracy: 0.6885  | train_accuracy: 0.68858 | valid_auc: 0.7377  | valid_balanced_accuracy: 0.66831 | valid_accuracy: 0.6684  |  0:38:07s
epoch 132| loss: 0.57611 | train_auc: 0.75923 | train_balanced_accuracy: 0.69025 | train_accuracy: 0.69043 | valid_auc: 0.73841 | valid_balanced_accuracy: 0.67247 | valid_accuracy: 0.67265 |  0:38:27s
epoch 133| loss: 0.57821 | train_auc: 0.7689  | train_balanced_accuracy: 0.70085 | train_accuracy: 0.70094 | valid_auc: 0.74179 | valid_balanced_accuracy: 0.68062 | valid_accuracy: 0.68067 |  0:38:45s
epoch 134| loss: 0.57533 | train_auc: 0.76205 | train_balanced_accuracy: 0.69547 | train_accuracy: 0.69555 | valid_auc: 0.73912 | valid_balanced_accuracy: 0.68049 | valid_accuracy: 0.68052 |  0:39:03s
epoch 135| loss: 0.58055 | train_auc: 0.76978 | train_balanced_accuracy: 0.7019  | train_accuracy: 0.70196 | valid_auc: 0.74373 | valid_balanced_accuracy: 0.68333 | valid_accuracy: 0.68335 |  0:39:20s
epoch 136| loss: 0.57605 | train_auc: 0.77552 | train_balanced_accuracy: 0.70561 | train_accuracy: 0.70562 | valid_auc: 0.74576 | valid_balanced_accuracy: 0.68307 | valid_accuracy: 0.68303 |  0:39:37s
epoch 137| loss: 0.57331 | train_auc: 0.77581 | train_balanced_accuracy: 0.70485 | train_accuracy: 0.70495 | valid_auc: 0.74544 | valid_balanced_accuracy: 0.68156 | valid_accuracy: 0.68162 |  0:39:54s
epoch 138| loss: 0.57645 | train_auc: 0.77862 | train_balanced_accuracy: 0.70754 | train_accuracy: 0.70778 | valid_auc: 0.74701 | valid_balanced_accuracy: 0.67874 | valid_accuracy: 0.67894 |  0:40:10s
epoch 139| loss: 0.57608 | train_auc: 0.77795 | train_balanced_accuracy: 0.70725 | train_accuracy: 0.70747 | valid_auc: 0.74537 | valid_balanced_accuracy: 0.67939 | valid_accuracy: 0.67957 |  0:40:27s
epoch 140| loss: 0.57735 | train_auc: 0.77688 | train_balanced_accuracy: 0.70607 | train_accuracy: 0.70641 | valid_auc: 0.74478 | valid_balanced_accuracy: 0.67802 | valid_accuracy: 0.67831 |  0:40:46s
epoch 141| loss: 0.57798 | train_auc: 0.77964 | train_balanced_accuracy: 0.70783 | train_accuracy: 0.70802 | valid_auc: 0.74573 | valid_balanced_accuracy: 0.67987 | valid_accuracy: 0.68004 |  0:41:03s
epoch 142| loss: 0.57419 | train_auc: 0.7815  | train_balanced_accuracy: 0.70995 | train_accuracy: 0.71003 | valid_auc: 0.74714 | valid_balanced_accuracy: 0.68139 | valid_accuracy: 0.68146 |  0:41:21s
epoch 143| loss: 0.56768 | train_auc: 0.78131 | train_balanced_accuracy: 0.71042 | train_accuracy: 0.71069 | valid_auc: 0.74652 | valid_balanced_accuracy: 0.68169 | valid_accuracy: 0.68193 |  0:41:38s
epoch 144| loss: 0.57355 | train_auc: 0.77924 | train_balanced_accuracy: 0.70914 | train_accuracy: 0.70947 | valid_auc: 0.74391 | valid_balanced_accuracy: 0.67849 | valid_accuracy: 0.67879 |  0:41:56s
epoch 145| loss: 0.57305 | train_auc: 0.7782  | train_balanced_accuracy: 0.70711 | train_accuracy: 0.70727 | valid_auc: 0.74386 | valid_balanced_accuracy: 0.67772 | valid_accuracy: 0.67784 |  0:42:13s

Early stopping occurred at epoch 145 with best_epoch = 125 and best_valid_accuracy = 0.68587
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 60/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.005, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.684 total time=42.4min
[CV 1/5; 61/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68567 | train_auc: 0.62792 | train_balanced_accuracy: 0.60568 | train_accuracy: 0.60496 | valid_auc: 0.62602 | valid_balanced_accuracy: 0.60258 | valid_accuracy: 0.60183 |  0:00:17s
epoch 1  | loss: 0.63153 | train_auc: 0.64847 | train_balanced_accuracy: 0.60901 | train_accuracy: 0.60787 | valid_auc: 0.64821 | valid_balanced_accuracy: 0.60677 | valid_accuracy: 0.6056  |  0:00:34s
epoch 2  | loss: 0.6147  | train_auc: 0.68444 | train_balanced_accuracy: 0.61727 | train_accuracy: 0.61617 | valid_auc: 0.67826 | valid_balanced_accuracy: 0.61367 | valid_accuracy: 0.61253 |  0:00:51s
epoch 3  | loss: 0.61137 | train_auc: 0.68698 | train_balanced_accuracy: 0.62202 | train_accuracy: 0.62097 | valid_auc: 0.68124 | valid_balanced_accuracy: 0.61927 | valid_accuracy: 0.61819 |  0:01:10s
epoch 4  | loss: 0.60147 | train_auc: 0.69327 | train_balanced_accuracy: 0.62168 | train_accuracy: 0.6207  | valid_auc: 0.68675 | valid_balanced_accuracy: 0.61715 | valid_accuracy: 0.61615 |  0:01:28s
epoch 5  | loss: 0.60113 | train_auc: 0.70192 | train_balanced_accuracy: 0.6297  | train_accuracy: 0.62892 | valid_auc: 0.69614 | valid_balanced_accuracy: 0.62688 | valid_accuracy: 0.62606 |  0:01:44s
epoch 6  | loss: 0.60199 | train_auc: 0.71204 | train_balanced_accuracy: 0.62873 | train_accuracy: 0.62766 | valid_auc: 0.70435 | valid_balanced_accuracy: 0.62232 | valid_accuracy: 0.62118 |  0:01:59s
epoch 7  | loss: 0.59758 | train_auc: 0.71239 | train_balanced_accuracy: 0.63719 | train_accuracy: 0.63647 | valid_auc: 0.70129 | valid_balanced_accuracy: 0.63279 | valid_accuracy: 0.63204 |  0:02:17s
epoch 8  | loss: 0.58935 | train_auc: 0.70773 | train_balanced_accuracy: 0.6396  | train_accuracy: 0.63935 | valid_auc: 0.70172 | valid_balanced_accuracy: 0.63912 | valid_accuracy: 0.63881 |  0:02:34s
epoch 9  | loss: 0.59294 | train_auc: 0.7263  | train_balanced_accuracy: 0.66313 | train_accuracy: 0.66288 | valid_auc: 0.71599 | valid_balanced_accuracy: 0.65989 | valid_accuracy: 0.65958 |  0:02:50s
epoch 10 | loss: 0.58624 | train_auc: 0.72259 | train_balanced_accuracy: 0.65938 | train_accuracy: 0.65922 | valid_auc: 0.71474 | valid_balanced_accuracy: 0.65316 | valid_accuracy: 0.65297 |  0:03:07s
epoch 11 | loss: 0.58824 | train_auc: 0.7276  | train_balanced_accuracy: 0.66566 | train_accuracy: 0.66622 | valid_auc: 0.71929 | valid_balanced_accuracy: 0.6546  | valid_accuracy: 0.65518 |  0:03:25s
epoch 12 | loss: 0.58637 | train_auc: 0.73429 | train_balanced_accuracy: 0.66912 | train_accuracy: 0.66957 | valid_auc: 0.72051 | valid_balanced_accuracy: 0.6579  | valid_accuracy: 0.65833 |  0:03:43s
epoch 13 | loss: 0.58462 | train_auc: 0.73806 | train_balanced_accuracy: 0.67217 | train_accuracy: 0.67271 | valid_auc: 0.72477 | valid_balanced_accuracy: 0.66266 | valid_accuracy: 0.6632  |  0:03:58s
epoch 14 | loss: 0.58375 | train_auc: 0.73965 | train_balanced_accuracy: 0.67391 | train_accuracy: 0.67444 | valid_auc: 0.72703 | valid_balanced_accuracy: 0.66128 | valid_accuracy: 0.66179 |  0:04:15s
epoch 15 | loss: 0.58188 | train_auc: 0.74217 | train_balanced_accuracy: 0.67643 | train_accuracy: 0.67657 | valid_auc: 0.73004 | valid_balanced_accuracy: 0.66435 | valid_accuracy: 0.66446 |  0:04:31s
epoch 16 | loss: 0.57797 | train_auc: 0.74412 | train_balanced_accuracy: 0.6781  | train_accuracy: 0.67818 | valid_auc: 0.72945 | valid_balanced_accuracy: 0.66552 | valid_accuracy: 0.66556 |  0:04:49s
epoch 17 | loss: 0.57472 | train_auc: 0.74401 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67936 | valid_auc: 0.7299  | valid_balanced_accuracy: 0.65919 | valid_accuracy: 0.65958 |  0:05:10s
epoch 18 | loss: 0.57465 | train_auc: 0.74999 | train_balanced_accuracy: 0.68392 | train_accuracy: 0.6846  | valid_auc: 0.73403 | valid_balanced_accuracy: 0.66915 | valid_accuracy: 0.66981 |  0:05:27s
epoch 19 | loss: 0.57862 | train_auc: 0.75614 | train_balanced_accuracy: 0.68782 | train_accuracy: 0.68822 | valid_auc: 0.73934 | valid_balanced_accuracy: 0.67027 | valid_accuracy: 0.6706  |  0:05:44s
epoch 20 | loss: 0.57397 | train_auc: 0.75231 | train_balanced_accuracy: 0.68483 | train_accuracy: 0.68483 | valid_auc: 0.73471 | valid_balanced_accuracy: 0.66949 | valid_accuracy: 0.6695  |  0:06:02s
epoch 21 | loss: 0.57301 | train_auc: 0.76207 | train_balanced_accuracy: 0.68907 | train_accuracy: 0.68967 | valid_auc: 0.74327 | valid_balanced_accuracy: 0.67236 | valid_accuracy: 0.67296 |  0:06:17s
epoch 22 | loss: 0.579   | train_auc: 0.7603  | train_balanced_accuracy: 0.6886  | train_accuracy: 0.68916 | valid_auc: 0.74372 | valid_balanced_accuracy: 0.67713 | valid_accuracy: 0.67768 |  0:06:34s
epoch 23 | loss: 0.57174 | train_auc: 0.77006 | train_balanced_accuracy: 0.69814 | train_accuracy: 0.69876 | valid_auc: 0.7508  | valid_balanced_accuracy: 0.68433 | valid_accuracy: 0.68492 |  0:06:51s
epoch 24 | loss: 0.57419 | train_auc: 0.75822 | train_balanced_accuracy: 0.6887  | train_accuracy: 0.68908 | valid_auc: 0.73941 | valid_balanced_accuracy: 0.67355 | valid_accuracy: 0.67391 |  0:07:09s
epoch 25 | loss: 0.56859 | train_auc: 0.76266 | train_balanced_accuracy: 0.69449 | train_accuracy: 0.69451 | valid_auc: 0.74315 | valid_balanced_accuracy: 0.67785 | valid_accuracy: 0.67784 |  0:07:26s
epoch 26 | loss: 0.57426 | train_auc: 0.76932 | train_balanced_accuracy: 0.69872 | train_accuracy: 0.69923 | valid_auc: 0.74635 | valid_balanced_accuracy: 0.68236 | valid_accuracy: 0.68288 |  0:07:43s
epoch 27 | loss: 0.57148 | train_auc: 0.77153 | train_balanced_accuracy: 0.70072 | train_accuracy: 0.70092 | valid_auc: 0.74535 | valid_balanced_accuracy: 0.68614 | valid_accuracy: 0.68634 |  0:08:03s
epoch 28 | loss: 0.5706  | train_auc: 0.77334 | train_balanced_accuracy: 0.69931 | train_accuracy: 0.69955 | valid_auc: 0.74603 | valid_balanced_accuracy: 0.6814  | valid_accuracy: 0.68162 |  0:08:20s
epoch 29 | loss: 0.56354 | train_auc: 0.78043 | train_balanced_accuracy: 0.70945 | train_accuracy: 0.7097  | valid_auc: 0.75765 | valid_balanced_accuracy: 0.69002 | valid_accuracy: 0.69027 |  0:08:37s
epoch 30 | loss: 0.56471 | train_auc: 0.77088 | train_balanced_accuracy: 0.70364 | train_accuracy: 0.70399 | valid_auc: 0.74691 | valid_balanced_accuracy: 0.6838  | valid_accuracy: 0.68414 |  0:08:54s
epoch 31 | loss: 0.56912 | train_auc: 0.7612  | train_balanced_accuracy: 0.69042 | train_accuracy: 0.69089 | valid_auc: 0.74394 | valid_balanced_accuracy: 0.67858 | valid_accuracy: 0.6791  |  0:09:12s
epoch 32 | loss: 0.56416 | train_auc: 0.77401 | train_balanced_accuracy: 0.70123 | train_accuracy: 0.70155 | valid_auc: 0.7504  | valid_balanced_accuracy: 0.68775 | valid_accuracy: 0.68807 |  0:09:29s
epoch 33 | loss: 0.56575 | train_auc: 0.7689  | train_balanced_accuracy: 0.69366 | train_accuracy: 0.69447 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.67934 | valid_accuracy: 0.6802  |  0:09:45s
epoch 34 | loss: 0.55783 | train_auc: 0.76771 | train_balanced_accuracy: 0.69757 | train_accuracy: 0.69789 | valid_auc: 0.7462  | valid_balanced_accuracy: 0.68331 | valid_accuracy: 0.68366 |  0:10:04s
epoch 35 | loss: 0.56418 | train_auc: 0.77453 | train_balanced_accuracy: 0.7063  | train_accuracy: 0.70683 | valid_auc: 0.75301 | valid_balanced_accuracy: 0.69101 | valid_accuracy: 0.69153 |  0:10:21s
epoch 36 | loss: 0.56241 | train_auc: 0.78166 | train_balanced_accuracy: 0.70882 | train_accuracy: 0.70899 | valid_auc: 0.75287 | valid_balanced_accuracy: 0.68556 | valid_accuracy: 0.68571 |  0:10:39s
epoch 37 | loss: 0.55882 | train_auc: 0.78522 | train_balanced_accuracy: 0.71218 | train_accuracy: 0.71257 | valid_auc: 0.75431 | valid_balanced_accuracy: 0.69477 | valid_accuracy: 0.69515 |  0:10:55s
epoch 38 | loss: 0.55578 | train_auc: 0.78582 | train_balanced_accuracy: 0.70905 | train_accuracy: 0.70895 | valid_auc: 0.7542  | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68901 |  0:11:11s
epoch 39 | loss: 0.55869 | train_auc: 0.79166 | train_balanced_accuracy: 0.71841 | train_accuracy: 0.71867 | valid_auc: 0.75186 | valid_balanced_accuracy: 0.69064 | valid_accuracy: 0.6909  |  0:11:28s
epoch 40 | loss: 0.55677 | train_auc: 0.79213 | train_balanced_accuracy: 0.71754 | train_accuracy: 0.71773 | valid_auc: 0.75428 | valid_balanced_accuracy: 0.68668 | valid_accuracy: 0.68681 |  0:11:46s
epoch 41 | loss: 0.55298 | train_auc: 0.79471 | train_balanced_accuracy: 0.71859 | train_accuracy: 0.71879 | valid_auc: 0.75335 | valid_balanced_accuracy: 0.68737 | valid_accuracy: 0.6876  |  0:12:03s
epoch 42 | loss: 0.55152 | train_auc: 0.79501 | train_balanced_accuracy: 0.7171  | train_accuracy: 0.71741 | valid_auc: 0.75614 | valid_balanced_accuracy: 0.69102 | valid_accuracy: 0.69138 |  0:12:20s
epoch 43 | loss: 0.55623 | train_auc: 0.79702 | train_balanced_accuracy: 0.72094 | train_accuracy: 0.72103 | valid_auc: 0.76065 | valid_balanced_accuracy: 0.69428 | valid_accuracy: 0.69437 |  0:12:36s
epoch 44 | loss: 0.55172 | train_auc: 0.80033 | train_balanced_accuracy: 0.723   | train_accuracy: 0.72327 | valid_auc: 0.761   | valid_balanced_accuracy: 0.69864 | valid_accuracy: 0.69893 |  0:12:52s
epoch 45 | loss: 0.55004 | train_auc: 0.79325 | train_balanced_accuracy: 0.71311 | train_accuracy: 0.71359 | valid_auc: 0.75204 | valid_balanced_accuracy: 0.68756 | valid_accuracy: 0.68807 |  0:13:09s
epoch 46 | loss: 0.54899 | train_auc: 0.8005  | train_balanced_accuracy: 0.72531 | train_accuracy: 0.72544 | valid_auc: 0.75663 | valid_balanced_accuracy: 0.68953 | valid_accuracy: 0.68964 |  0:13:25s
epoch 47 | loss: 0.54942 | train_auc: 0.79341 | train_balanced_accuracy: 0.714   | train_accuracy: 0.71454 | valid_auc: 0.74865 | valid_balanced_accuracy: 0.68171 | valid_accuracy: 0.68225 |  0:13:44s
epoch 48 | loss: 0.54749 | train_auc: 0.80086 | train_balanced_accuracy: 0.7218  | train_accuracy: 0.72182 | valid_auc: 0.75821 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69043 |  0:14:00s
epoch 49 | loss: 0.54519 | train_auc: 0.7989  | train_balanced_accuracy: 0.72215 | train_accuracy: 0.72233 | valid_auc: 0.75576 | valid_balanced_accuracy: 0.69195 | valid_accuracy: 0.69216 |  0:14:17s
epoch 50 | loss: 0.5449  | train_auc: 0.80142 | train_balanced_accuracy: 0.724   | train_accuracy: 0.72398 | valid_auc: 0.75845 | valid_balanced_accuracy: 0.69184 | valid_accuracy: 0.69185 |  0:14:36s
epoch 51 | loss: 0.54598 | train_auc: 0.80362 | train_balanced_accuracy: 0.72209 | train_accuracy: 0.72257 | valid_auc: 0.76231 | valid_balanced_accuracy: 0.6907  | valid_accuracy: 0.69122 |  0:14:53s
epoch 52 | loss: 0.54236 | train_auc: 0.80652 | train_balanced_accuracy: 0.72785 | train_accuracy: 0.72788 | valid_auc: 0.76706 | valid_balanced_accuracy: 0.69808 | valid_accuracy: 0.69814 |  0:15:09s
epoch 53 | loss: 0.54366 | train_auc: 0.79967 | train_balanced_accuracy: 0.72011 | train_accuracy: 0.72044 | valid_auc: 0.75958 | valid_balanced_accuracy: 0.69324 | valid_accuracy: 0.69358 |  0:15:26s
epoch 54 | loss: 0.54304 | train_auc: 0.80621 | train_balanced_accuracy: 0.72744 | train_accuracy: 0.72768 | valid_auc: 0.7634  | valid_balanced_accuracy: 0.69332 | valid_accuracy: 0.69358 |  0:15:42s
epoch 55 | loss: 0.54492 | train_auc: 0.80184 | train_balanced_accuracy: 0.72152 | train_accuracy: 0.7219  | valid_auc: 0.75561 | valid_balanced_accuracy: 0.69115 | valid_accuracy: 0.69153 |  0:15:58s
epoch 56 | loss: 0.5433  | train_auc: 0.80836 | train_balanced_accuracy: 0.72863 | train_accuracy: 0.7289  | valid_auc: 0.76046 | valid_balanced_accuracy: 0.69408 | valid_accuracy: 0.69437 |  0:16:15s
epoch 57 | loss: 0.54225 | train_auc: 0.80648 | train_balanced_accuracy: 0.72725 | train_accuracy: 0.72733 | valid_auc: 0.75753 | valid_balanced_accuracy: 0.68786 | valid_accuracy: 0.68791 |  0:16:33s
epoch 58 | loss: 0.54301 | train_auc: 0.80629 | train_balanced_accuracy: 0.72484 | train_accuracy: 0.7252  | valid_auc: 0.76122 | valid_balanced_accuracy: 0.69417 | valid_accuracy: 0.69452 |  0:16:50s
epoch 59 | loss: 0.53958 | train_auc: 0.80874 | train_balanced_accuracy: 0.72609 | train_accuracy: 0.72646 | valid_auc: 0.7633  | valid_balanced_accuracy: 0.69224 | valid_accuracy: 0.69263 |  0:17:07s
epoch 60 | loss: 0.53993 | train_auc: 0.8093  | train_balanced_accuracy: 0.73032 | train_accuracy: 0.73051 | valid_auc: 0.76137 | valid_balanced_accuracy: 0.69448 | valid_accuracy: 0.69468 |  0:17:23s
epoch 61 | loss: 0.53743 | train_auc: 0.81205 | train_balanced_accuracy: 0.73226 | train_accuracy: 0.7326  | valid_auc: 0.76248 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69075 |  0:17:41s
epoch 62 | loss: 0.53492 | train_auc: 0.81102 | train_balanced_accuracy: 0.72869 | train_accuracy: 0.72862 | valid_auc: 0.7657  | valid_balanced_accuracy: 0.69367 | valid_accuracy: 0.69358 |  0:17:56s
epoch 63 | loss: 0.53608 | train_auc: 0.80984 | train_balanced_accuracy: 0.73208 | train_accuracy: 0.73232 | valid_auc: 0.75976 | valid_balanced_accuracy: 0.69254 | valid_accuracy: 0.69279 |  0:18:13s
epoch 64 | loss: 0.53766 | train_auc: 0.81365 | train_balanced_accuracy: 0.73031 | train_accuracy: 0.73016 | valid_auc: 0.76129 | valid_balanced_accuracy: 0.68395 | valid_accuracy: 0.68382 |  0:18:30s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69893
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 61/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.704 total time=18.6min
[CV 2/5; 61/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6972  | train_auc: 0.61122 | train_balanced_accuracy: 0.55053 | train_accuracy: 0.54818 | valid_auc: 0.60537 | valid_balanced_accuracy: 0.55214 | valid_accuracy: 0.54973 |  0:00:17s
epoch 1  | loss: 0.63972 | train_auc: 0.65154 | train_balanced_accuracy: 0.58805 | train_accuracy: 0.58674 | valid_auc: 0.64816 | valid_balanced_accuracy: 0.58568 | valid_accuracy: 0.58436 |  0:00:33s
epoch 2  | loss: 0.62886 | train_auc: 0.67762 | train_balanced_accuracy: 0.62009 | train_accuracy: 0.62152 | valid_auc: 0.67534 | valid_balanced_accuracy: 0.61658 | valid_accuracy: 0.61804 |  0:00:51s
epoch 3  | loss: 0.61948 | train_auc: 0.69004 | train_balanced_accuracy: 0.65322 | train_accuracy: 0.65387 | valid_auc: 0.68801 | valid_balanced_accuracy: 0.64874 | valid_accuracy: 0.64935 |  0:01:08s
epoch 4  | loss: 0.60633 | train_auc: 0.69798 | train_balanced_accuracy: 0.63885 | train_accuracy: 0.64002 | valid_auc: 0.69634 | valid_balanced_accuracy: 0.64566 | valid_accuracy: 0.64684 |  0:01:24s
epoch 5  | loss: 0.6042  | train_auc: 0.69924 | train_balanced_accuracy: 0.63712 | train_accuracy: 0.63821 | valid_auc: 0.69804 | valid_balanced_accuracy: 0.6385  | valid_accuracy: 0.6396  |  0:01:39s
epoch 6  | loss: 0.60425 | train_auc: 0.70357 | train_balanced_accuracy: 0.63025 | train_accuracy: 0.63136 | valid_auc: 0.6978  | valid_balanced_accuracy: 0.62529 | valid_accuracy: 0.62638 |  0:01:57s
epoch 7  | loss: 0.60424 | train_auc: 0.69987 | train_balanced_accuracy: 0.62303 | train_accuracy: 0.6242  | valid_auc: 0.69383 | valid_balanced_accuracy: 0.61844 | valid_accuracy: 0.61961 |  0:02:15s
epoch 8  | loss: 0.59447 | train_auc: 0.70418 | train_balanced_accuracy: 0.62116 | train_accuracy: 0.62235 | valid_auc: 0.69603 | valid_balanced_accuracy: 0.61668 | valid_accuracy: 0.61788 |  0:02:33s
epoch 9  | loss: 0.60037 | train_auc: 0.70417 | train_balanced_accuracy: 0.64587 | train_accuracy: 0.64663 | valid_auc: 0.70005 | valid_balanced_accuracy: 0.64534 | valid_accuracy: 0.64605 |  0:02:51s
epoch 10 | loss: 0.5917  | train_auc: 0.71668 | train_balanced_accuracy: 0.66612 | train_accuracy: 0.66661 | valid_auc: 0.71213 | valid_balanced_accuracy: 0.66607 | valid_accuracy: 0.66651 |  0:03:08s
epoch 11 | loss: 0.59415 | train_auc: 0.71442 | train_balanced_accuracy: 0.66244 | train_accuracy: 0.66303 | valid_auc: 0.71003 | valid_balanced_accuracy: 0.66184 | valid_accuracy: 0.66242 |  0:03:25s
epoch 12 | loss: 0.59173 | train_auc: 0.72357 | train_balanced_accuracy: 0.66143 | train_accuracy: 0.66205 | valid_auc: 0.72114 | valid_balanced_accuracy: 0.66368 | valid_accuracy: 0.66431 |  0:03:44s
epoch 13 | loss: 0.58852 | train_auc: 0.72502 | train_balanced_accuracy: 0.66766 | train_accuracy: 0.66815 | valid_auc: 0.72004 | valid_balanced_accuracy: 0.66528 | valid_accuracy: 0.66572 |  0:04:00s
epoch 14 | loss: 0.58895 | train_auc: 0.73571 | train_balanced_accuracy: 0.66604 | train_accuracy: 0.66693 | valid_auc: 0.73163 | valid_balanced_accuracy: 0.67032 | valid_accuracy: 0.67123 |  0:04:18s
epoch 15 | loss: 0.58656 | train_auc: 0.74033 | train_balanced_accuracy: 0.6718  | train_accuracy: 0.67189 | valid_auc: 0.73625 | valid_balanced_accuracy: 0.67132 | valid_accuracy: 0.67139 |  0:04:37s
epoch 16 | loss: 0.58676 | train_auc: 0.74029 | train_balanced_accuracy: 0.67452 | train_accuracy: 0.67456 | valid_auc: 0.73324 | valid_balanced_accuracy: 0.67231 | valid_accuracy: 0.67233 |  0:04:56s
epoch 17 | loss: 0.58057 | train_auc: 0.74317 | train_balanced_accuracy: 0.67611 | train_accuracy: 0.67602 | valid_auc: 0.73928 | valid_balanced_accuracy: 0.67244 | valid_accuracy: 0.67233 |  0:05:16s
epoch 18 | loss: 0.58172 | train_auc: 0.75092 | train_balanced_accuracy: 0.68215 | train_accuracy: 0.68255 | valid_auc: 0.74178 | valid_balanced_accuracy: 0.67706 | valid_accuracy: 0.67753 |  0:05:32s
epoch 19 | loss: 0.58297 | train_auc: 0.75516 | train_balanced_accuracy: 0.68717 | train_accuracy: 0.68743 | valid_auc: 0.74488 | valid_balanced_accuracy: 0.68025 | valid_accuracy: 0.68052 |  0:05:50s
epoch 20 | loss: 0.57916 | train_auc: 0.75661 | train_balanced_accuracy: 0.68999 | train_accuracy: 0.69018 | valid_auc: 0.74331 | valid_balanced_accuracy: 0.68207 | valid_accuracy: 0.68225 |  0:06:06s
epoch 21 | loss: 0.57796 | train_auc: 0.7522  | train_balanced_accuracy: 0.68266 | train_accuracy: 0.6831  | valid_auc: 0.74126 | valid_balanced_accuracy: 0.67706 | valid_accuracy: 0.67753 |  0:06:22s
epoch 22 | loss: 0.58607 | train_auc: 0.76801 | train_balanced_accuracy: 0.70122 | train_accuracy: 0.7014  | valid_auc: 0.75292 | valid_balanced_accuracy: 0.68866 | valid_accuracy: 0.68886 |  0:06:39s
epoch 23 | loss: 0.57763 | train_auc: 0.77113 | train_balanced_accuracy: 0.69849 | train_accuracy: 0.69892 | valid_auc: 0.75431 | valid_balanced_accuracy: 0.68684 | valid_accuracy: 0.68728 |  0:06:55s
epoch 24 | loss: 0.57882 | train_auc: 0.76845 | train_balanced_accuracy: 0.69967 | train_accuracy: 0.70002 | valid_auc: 0.74937 | valid_balanced_accuracy: 0.6877  | valid_accuracy: 0.68807 |  0:07:12s
epoch 25 | loss: 0.57204 | train_auc: 0.76608 | train_balanced_accuracy: 0.69694 | train_accuracy: 0.69699 | valid_auc: 0.74977 | valid_balanced_accuracy: 0.6839  | valid_accuracy: 0.68398 |  0:07:31s
epoch 26 | loss: 0.57545 | train_auc: 0.77019 | train_balanced_accuracy: 0.69824 | train_accuracy: 0.69876 | valid_auc: 0.75243 | valid_balanced_accuracy: 0.68787 | valid_accuracy: 0.68839 |  0:07:48s
epoch 27 | loss: 0.57076 | train_auc: 0.77403 | train_balanced_accuracy: 0.70361 | train_accuracy: 0.70352 | valid_auc: 0.75539 | valid_balanced_accuracy: 0.68642 | valid_accuracy: 0.68634 |  0:08:05s
epoch 28 | loss: 0.56629 | train_auc: 0.77362 | train_balanced_accuracy: 0.70194 | train_accuracy: 0.7023  | valid_auc: 0.75774 | valid_balanced_accuracy: 0.69446 | valid_accuracy: 0.69484 |  0:08:22s
epoch 29 | loss: 0.56981 | train_auc: 0.7679  | train_balanced_accuracy: 0.69855 | train_accuracy: 0.69833 | valid_auc: 0.74749 | valid_balanced_accuracy: 0.68669 | valid_accuracy: 0.6865  |  0:08:39s
epoch 30 | loss: 0.56638 | train_auc: 0.7691  | train_balanced_accuracy: 0.69878 | train_accuracy: 0.69908 | valid_auc: 0.74873 | valid_balanced_accuracy: 0.68728 | valid_accuracy: 0.6876  |  0:08:56s
epoch 31 | loss: 0.56521 | train_auc: 0.78648 | train_balanced_accuracy: 0.71047 | train_accuracy: 0.7108  | valid_auc: 0.75815 | valid_balanced_accuracy: 0.68553 | valid_accuracy: 0.68587 |  0:09:14s
epoch 32 | loss: 0.56481 | train_auc: 0.78599 | train_balanced_accuracy: 0.71161 | train_accuracy: 0.7119  | valid_auc: 0.75916 | valid_balanced_accuracy: 0.69266 | valid_accuracy: 0.69295 |  0:09:31s
epoch 33 | loss: 0.56538 | train_auc: 0.78071 | train_balanced_accuracy: 0.70684 | train_accuracy: 0.7071  | valid_auc: 0.75546 | valid_balanced_accuracy: 0.69057 | valid_accuracy: 0.6909  |  0:09:49s
epoch 34 | loss: 0.56355 | train_auc: 0.7822  | train_balanced_accuracy: 0.70996 | train_accuracy: 0.71033 | valid_auc: 0.75877 | valid_balanced_accuracy: 0.69637 | valid_accuracy: 0.69673 |  0:10:06s
epoch 35 | loss: 0.56055 | train_auc: 0.7833  | train_balanced_accuracy: 0.70625 | train_accuracy: 0.70675 | valid_auc: 0.75857 | valid_balanced_accuracy: 0.69262 | valid_accuracy: 0.69311 |  0:10:23s
epoch 36 | loss: 0.55928 | train_auc: 0.79034 | train_balanced_accuracy: 0.71515 | train_accuracy: 0.71536 | valid_auc: 0.76248 | valid_balanced_accuracy: 0.69051 | valid_accuracy: 0.69075 |  0:10:40s
epoch 37 | loss: 0.56109 | train_auc: 0.78943 | train_balanced_accuracy: 0.71286 | train_accuracy: 0.71328 | valid_auc: 0.75779 | valid_balanced_accuracy: 0.69093 | valid_accuracy: 0.69138 |  0:10:57s
epoch 38 | loss: 0.55565 | train_auc: 0.78168 | train_balanced_accuracy: 0.70429 | train_accuracy: 0.70403 | valid_auc: 0.75046 | valid_balanced_accuracy: 0.67697 | valid_accuracy: 0.67674 |  0:11:14s
epoch 39 | loss: 0.56061 | train_auc: 0.79095 | train_balanced_accuracy: 0.71372 | train_accuracy: 0.71363 | valid_auc: 0.75914 | valid_balanced_accuracy: 0.69335 | valid_accuracy: 0.69326 |  0:11:34s
epoch 40 | loss: 0.55874 | train_auc: 0.79341 | train_balanced_accuracy: 0.71978 | train_accuracy: 0.71989 | valid_auc: 0.76239 | valid_balanced_accuracy: 0.69616 | valid_accuracy: 0.69625 |  0:11:51s
epoch 41 | loss: 0.55581 | train_auc: 0.79665 | train_balanced_accuracy: 0.72023 | train_accuracy: 0.72044 | valid_auc: 0.76472 | valid_balanced_accuracy: 0.69744 | valid_accuracy: 0.69767 |  0:12:09s
epoch 42 | loss: 0.55036 | train_auc: 0.79043 | train_balanced_accuracy: 0.71541 | train_accuracy: 0.71564 | valid_auc: 0.76038 | valid_balanced_accuracy: 0.69068 | valid_accuracy: 0.6909  |  0:12:26s
epoch 43 | loss: 0.56147 | train_auc: 0.79553 | train_balanced_accuracy: 0.71716 | train_accuracy: 0.71706 | valid_auc: 0.76385 | valid_balanced_accuracy: 0.6937  | valid_accuracy: 0.69358 |  0:12:44s
epoch 44 | loss: 0.55121 | train_auc: 0.79509 | train_balanced_accuracy: 0.71992 | train_accuracy: 0.7202  | valid_auc: 0.76129 | valid_balanced_accuracy: 0.69534 | valid_accuracy: 0.69562 |  0:13:01s
epoch 45 | loss: 0.54878 | train_auc: 0.79509 | train_balanced_accuracy: 0.71661 | train_accuracy: 0.71717 | valid_auc: 0.75797 | valid_balanced_accuracy: 0.69422 | valid_accuracy: 0.69484 |  0:13:20s
epoch 46 | loss: 0.54974 | train_auc: 0.79509 | train_balanced_accuracy: 0.71713 | train_accuracy: 0.71721 | valid_auc: 0.76174 | valid_balanced_accuracy: 0.69302 | valid_accuracy: 0.69311 |  0:13:39s
epoch 47 | loss: 0.54869 | train_auc: 0.78654 | train_balanced_accuracy: 0.7068  | train_accuracy: 0.7073  | valid_auc: 0.75226 | valid_balanced_accuracy: 0.68677 | valid_accuracy: 0.68728 |  0:13:56s
epoch 48 | loss: 0.54496 | train_auc: 0.79279 | train_balanced_accuracy: 0.71843 | train_accuracy: 0.71855 | valid_auc: 0.76088 | valid_balanced_accuracy: 0.6982  | valid_accuracy: 0.6983  |  0:14:11s
epoch 49 | loss: 0.54605 | train_auc: 0.79589 | train_balanced_accuracy: 0.71963 | train_accuracy: 0.71973 | valid_auc: 0.75778 | valid_balanced_accuracy: 0.69281 | valid_accuracy: 0.69295 |  0:14:28s
epoch 50 | loss: 0.54655 | train_auc: 0.78944 | train_balanced_accuracy: 0.71194 | train_accuracy: 0.71182 | valid_auc: 0.75648 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68823 |  0:14:47s
epoch 51 | loss: 0.54762 | train_auc: 0.80015 | train_balanced_accuracy: 0.72135 | train_accuracy: 0.7215  | valid_auc: 0.76103 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.68886 |  0:15:04s
epoch 52 | loss: 0.54387 | train_auc: 0.8012  | train_balanced_accuracy: 0.72364 | train_accuracy: 0.72367 | valid_auc: 0.76454 | valid_balanced_accuracy: 0.69561 | valid_accuracy: 0.69562 |  0:15:20s
epoch 53 | loss: 0.54436 | train_auc: 0.80313 | train_balanced_accuracy: 0.72469 | train_accuracy: 0.725   | valid_auc: 0.76586 | valid_balanced_accuracy: 0.69721 | valid_accuracy: 0.69751 |  0:15:39s
epoch 54 | loss: 0.54726 | train_auc: 0.80726 | train_balanced_accuracy: 0.7288  | train_accuracy: 0.72882 | valid_auc: 0.76612 | valid_balanced_accuracy: 0.69925 | valid_accuracy: 0.69924 |  0:15:58s
epoch 55 | loss: 0.54429 | train_auc: 0.80059 | train_balanced_accuracy: 0.7216  | train_accuracy: 0.72201 | valid_auc: 0.76385 | valid_balanced_accuracy: 0.70088 | valid_accuracy: 0.70129 |  0:16:15s
epoch 56 | loss: 0.54078 | train_auc: 0.78202 | train_balanced_accuracy: 0.70951 | train_accuracy: 0.70986 | valid_auc: 0.75431 | valid_balanced_accuracy: 0.69153 | valid_accuracy: 0.69185 |  0:16:33s
epoch 57 | loss: 0.54062 | train_auc: 0.80193 | train_balanced_accuracy: 0.72203 | train_accuracy: 0.72213 | valid_auc: 0.76219 | valid_balanced_accuracy: 0.6952  | valid_accuracy: 0.69531 |  0:16:51s
epoch 58 | loss: 0.53991 | train_auc: 0.8044  | train_balanced_accuracy: 0.72723 | train_accuracy: 0.72748 | valid_auc: 0.76273 | valid_balanced_accuracy: 0.68938 | valid_accuracy: 0.68964 |  0:17:08s
epoch 59 | loss: 0.53915 | train_auc: 0.80271 | train_balanced_accuracy: 0.72427 | train_accuracy: 0.72438 | valid_auc: 0.75683 | valid_balanced_accuracy: 0.69015 | valid_accuracy: 0.69027 |  0:17:26s
epoch 60 | loss: 0.5438  | train_auc: 0.80248 | train_balanced_accuracy: 0.72401 | train_accuracy: 0.72418 | valid_auc: 0.76056 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69531 |  0:17:44s
epoch 61 | loss: 0.53878 | train_auc: 0.79675 | train_balanced_accuracy: 0.71831 | train_accuracy: 0.71871 | valid_auc: 0.75979 | valid_balanced_accuracy: 0.69428 | valid_accuracy: 0.69468 |  0:18:02s
epoch 62 | loss: 0.53648 | train_auc: 0.77216 | train_balanced_accuracy: 0.70366 | train_accuracy: 0.70372 | valid_auc: 0.74512 | valid_balanced_accuracy: 0.68914 | valid_accuracy: 0.68917 |  0:18:21s
epoch 63 | loss: 0.54244 | train_auc: 0.78016 | train_balanced_accuracy: 0.70628 | train_accuracy: 0.70643 | valid_auc: 0.75024 | valid_balanced_accuracy: 0.68445 | valid_accuracy: 0.68461 |  0:18:42s
epoch 64 | loss: 0.53604 | train_auc: 0.79604 | train_balanced_accuracy: 0.71639 | train_accuracy: 0.71627 | valid_auc: 0.75276 | valid_balanced_accuracy: 0.68126 | valid_accuracy: 0.68115 |  0:19:00s
epoch 65 | loss: 0.53795 | train_auc: 0.79523 | train_balanced_accuracy: 0.71968 | train_accuracy: 0.71981 | valid_auc: 0.75445 | valid_balanced_accuracy: 0.68146 | valid_accuracy: 0.68162 |  0:19:18s
epoch 66 | loss: 0.53766 | train_auc: 0.79653 | train_balanced_accuracy: 0.71873 | train_accuracy: 0.71867 | valid_auc: 0.75256 | valid_balanced_accuracy: 0.68686 | valid_accuracy: 0.68681 |  0:19:36s
epoch 67 | loss: 0.53434 | train_auc: 0.80458 | train_balanced_accuracy: 0.72601 | train_accuracy: 0.72615 | valid_auc: 0.76213 | valid_balanced_accuracy: 0.69263 | valid_accuracy: 0.69279 |  0:19:52s
epoch 68 | loss: 0.54216 | train_auc: 0.8089  | train_balanced_accuracy: 0.72797 | train_accuracy: 0.72807 | valid_auc: 0.76244 | valid_balanced_accuracy: 0.69631 | valid_accuracy: 0.69641 |  0:20:09s
epoch 69 | loss: 0.53696 | train_auc: 0.81197 | train_balanced_accuracy: 0.732   | train_accuracy: 0.73217 | valid_auc: 0.7655  | valid_balanced_accuracy: 0.69685 | valid_accuracy: 0.69704 |  0:20:26s
epoch 70 | loss: 0.53632 | train_auc: 0.81728 | train_balanced_accuracy: 0.73361 | train_accuracy: 0.73394 | valid_auc: 0.77006 | valid_balanced_accuracy: 0.70066 | valid_accuracy: 0.70098 |  0:20:43s
epoch 71 | loss: 0.53674 | train_auc: 0.81634 | train_balanced_accuracy: 0.7331  | train_accuracy: 0.73307 | valid_auc: 0.76332 | valid_balanced_accuracy: 0.69358 | valid_accuracy: 0.69358 |  0:21:00s
epoch 72 | loss: 0.53264 | train_auc: 0.81712 | train_balanced_accuracy: 0.73374 | train_accuracy: 0.73409 | valid_auc: 0.76683 | valid_balanced_accuracy: 0.69618 | valid_accuracy: 0.69657 |  0:21:18s
epoch 73 | loss: 0.53038 | train_auc: 0.81679 | train_balanced_accuracy: 0.73616 | train_accuracy: 0.73618 | valid_auc: 0.7638  | valid_balanced_accuracy: 0.69417 | valid_accuracy: 0.69421 |  0:21:34s
epoch 74 | loss: 0.53488 | train_auc: 0.81893 | train_balanced_accuracy: 0.73677 | train_accuracy: 0.73705 | valid_auc: 0.76562 | valid_balanced_accuracy: 0.69515 | valid_accuracy: 0.69547 |  0:21:51s
epoch 75 | loss: 0.53063 | train_auc: 0.81672 | train_balanced_accuracy: 0.73692 | train_accuracy: 0.73724 | valid_auc: 0.76793 | valid_balanced_accuracy: 0.70175 | valid_accuracy: 0.70208 |  0:22:10s
epoch 76 | loss: 0.53735 | train_auc: 0.81994 | train_balanced_accuracy: 0.73767 | train_accuracy: 0.73771 | valid_auc: 0.76789 | valid_balanced_accuracy: 0.69744 | valid_accuracy: 0.69751 |  0:22:30s
epoch 77 | loss: 0.53353 | train_auc: 0.81877 | train_balanced_accuracy: 0.73906 | train_accuracy: 0.73909 | valid_auc: 0.76263 | valid_balanced_accuracy: 0.6921  | valid_accuracy: 0.69216 |  0:22:46s
epoch 78 | loss: 0.527   | train_auc: 0.81909 | train_balanced_accuracy: 0.73622 | train_accuracy: 0.73626 | valid_auc: 0.76357 | valid_balanced_accuracy: 0.69473 | valid_accuracy: 0.69484 |  0:23:04s
epoch 79 | loss: 0.52497 | train_auc: 0.81683 | train_balanced_accuracy: 0.73474 | train_accuracy: 0.73468 | valid_auc: 0.76027 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.6887  |  0:23:21s
epoch 80 | loss: 0.53174 | train_auc: 0.82226 | train_balanced_accuracy: 0.74022 | train_accuracy: 0.74015 | valid_auc: 0.77099 | valid_balanced_accuracy: 0.69771 | valid_accuracy: 0.69767 |  0:23:39s
epoch 81 | loss: 0.52437 | train_auc: 0.82015 | train_balanced_accuracy: 0.73821 | train_accuracy: 0.73838 | valid_auc: 0.76531 | valid_balanced_accuracy: 0.6923  | valid_accuracy: 0.69248 |  0:23:56s
epoch 82 | loss: 0.53378 | train_auc: 0.82293 | train_balanced_accuracy: 0.74034 | train_accuracy: 0.74063 | valid_auc: 0.76178 | valid_balanced_accuracy: 0.68936 | valid_accuracy: 0.68964 |  0:24:12s
epoch 83 | loss: 0.52741 | train_auc: 0.82028 | train_balanced_accuracy: 0.738   | train_accuracy: 0.73826 | valid_auc: 0.76271 | valid_balanced_accuracy: 0.69078 | valid_accuracy: 0.69106 |  0:24:31s
epoch 84 | loss: 0.52992 | train_auc: 0.8228  | train_balanced_accuracy: 0.74165 | train_accuracy: 0.74181 | valid_auc: 0.76868 | valid_balanced_accuracy: 0.69619 | valid_accuracy: 0.69641 |  0:24:50s
epoch 85 | loss: 0.52496 | train_auc: 0.82294 | train_balanced_accuracy: 0.7405  | train_accuracy: 0.74078 | valid_auc: 0.76641 | valid_balanced_accuracy: 0.69498 | valid_accuracy: 0.69531 |  0:25:07s
epoch 86 | loss: 0.53137 | train_auc: 0.81555 | train_balanced_accuracy: 0.73585 | train_accuracy: 0.73583 | valid_auc: 0.76028 | valid_balanced_accuracy: 0.69292 | valid_accuracy: 0.69295 |  0:25:25s
epoch 87 | loss: 0.52236 | train_auc: 0.82155 | train_balanced_accuracy: 0.74001 | train_accuracy: 0.74004 | valid_auc: 0.75922 | valid_balanced_accuracy: 0.69463 | valid_accuracy: 0.69468 |  0:25:42s
epoch 88 | loss: 0.52562 | train_auc: 0.82557 | train_balanced_accuracy: 0.74318 | train_accuracy: 0.74334 | valid_auc: 0.76725 | valid_balanced_accuracy: 0.69482 | valid_accuracy: 0.695   |  0:25:59s
epoch 89 | loss: 0.52679 | train_auc: 0.82059 | train_balanced_accuracy: 0.7398  | train_accuracy: 0.74004 | valid_auc: 0.76318 | valid_balanced_accuracy: 0.69443 | valid_accuracy: 0.69468 |  0:26:16s
epoch 90 | loss: 0.52657 | train_auc: 0.82736 | train_balanced_accuracy: 0.74584 | train_accuracy: 0.74582 | valid_auc: 0.76419 | valid_balanced_accuracy: 0.69058 | valid_accuracy: 0.69059 |  0:26:34s
epoch 91 | loss: 0.51924 | train_auc: 0.8224  | train_balanced_accuracy: 0.73982 | train_accuracy: 0.74    | valid_auc: 0.75741 | valid_balanced_accuracy: 0.68714 | valid_accuracy: 0.68728 |  0:26:50s
epoch 92 | loss: 0.52756 | train_auc: 0.82602 | train_balanced_accuracy: 0.74487 | train_accuracy: 0.74519 | valid_auc: 0.76327 | valid_balanced_accuracy: 0.69369 | valid_accuracy: 0.69405 |  0:27:07s
epoch 93 | loss: 0.5188  | train_auc: 0.82727 | train_balanced_accuracy: 0.74518 | train_accuracy: 0.74531 | valid_auc: 0.76496 | valid_balanced_accuracy: 0.69389 | valid_accuracy: 0.69405 |  0:27:24s
epoch 94 | loss: 0.52118 | train_auc: 0.82998 | train_balanced_accuracy: 0.74578 | train_accuracy: 0.7459  | valid_auc: 0.76436 | valid_balanced_accuracy: 0.69011 | valid_accuracy: 0.69027 |  0:27:41s
epoch 95 | loss: 0.51807 | train_auc: 0.82704 | train_balanced_accuracy: 0.74486 | train_accuracy: 0.74507 | valid_auc: 0.76533 | valid_balanced_accuracy: 0.69397 | valid_accuracy: 0.69421 |  0:27:57s

Early stopping occurred at epoch 95 with best_epoch = 75 and best_valid_accuracy = 0.70208
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 61/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=28.1min
[CV 3/5; 61/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.69306 | train_auc: 0.60801 | train_balanced_accuracy: 0.53452 | train_accuracy: 0.53215 | valid_auc: 0.60885 | valid_balanced_accuracy: 0.53605 | valid_accuracy: 0.53368 |  0:00:17s
epoch 1  | loss: 0.63907 | train_auc: 0.65862 | train_balanced_accuracy: 0.53782 | train_accuracy: 0.53478 | valid_auc: 0.65119 | valid_balanced_accuracy: 0.53563 | valid_accuracy: 0.53258 |  0:00:35s
epoch 2  | loss: 0.62433 | train_auc: 0.67752 | train_balanced_accuracy: 0.54973 | train_accuracy: 0.54686 | valid_auc: 0.67124 | valid_balanced_accuracy: 0.54773 | valid_accuracy: 0.54485 |  0:00:53s
epoch 3  | loss: 0.61702 | train_auc: 0.68604 | train_balanced_accuracy: 0.56023 | train_accuracy: 0.55748 | valid_auc: 0.67915 | valid_balanced_accuracy: 0.55596 | valid_accuracy: 0.55319 |  0:01:10s
epoch 4  | loss: 0.60732 | train_auc: 0.69883 | train_balanced_accuracy: 0.59109 | train_accuracy: 0.58896 | valid_auc: 0.69408 | valid_balanced_accuracy: 0.58335 | valid_accuracy: 0.58121 |  0:01:26s
epoch 5  | loss: 0.60403 | train_auc: 0.70203 | train_balanced_accuracy: 0.62039 | train_accuracy: 0.61898 | valid_auc: 0.69459 | valid_balanced_accuracy: 0.61301 | valid_accuracy: 0.61158 |  0:01:43s
epoch 6  | loss: 0.60231 | train_auc: 0.71239 | train_balanced_accuracy: 0.63172 | train_accuracy: 0.63067 | valid_auc: 0.7056  | valid_balanced_accuracy: 0.63042 | valid_accuracy: 0.62937 |  0:02:00s
epoch 7  | loss: 0.6044  | train_auc: 0.70996 | train_balanced_accuracy: 0.63849 | train_accuracy: 0.63755 | valid_auc: 0.70432 | valid_balanced_accuracy: 0.63835 | valid_accuracy: 0.63739 |  0:02:18s
epoch 8  | loss: 0.59627 | train_auc: 0.71209 | train_balanced_accuracy: 0.65663 | train_accuracy: 0.65655 | valid_auc: 0.70315 | valid_balanced_accuracy: 0.66107 | valid_accuracy: 0.661   |  0:02:35s
epoch 9  | loss: 0.59234 | train_auc: 0.71289 | train_balanced_accuracy: 0.65478 | train_accuracy: 0.65475 | valid_auc: 0.70627 | valid_balanced_accuracy: 0.65507 | valid_accuracy: 0.65502 |  0:02:52s
epoch 10 | loss: 0.58123 | train_auc: 0.73164 | train_balanced_accuracy: 0.66777 | train_accuracy: 0.66785 | valid_auc: 0.72551 | valid_balanced_accuracy: 0.66724 | valid_accuracy: 0.6673  |  0:03:09s
epoch 11 | loss: 0.58699 | train_auc: 0.73504 | train_balanced_accuracy: 0.67312 | train_accuracy: 0.67336 | valid_auc: 0.72599 | valid_balanced_accuracy: 0.67005 | valid_accuracy: 0.67029 |  0:03:27s
epoch 12 | loss: 0.58721 | train_auc: 0.73852 | train_balanced_accuracy: 0.67398 | train_accuracy: 0.67442 | valid_auc: 0.7246  | valid_balanced_accuracy: 0.6651  | valid_accuracy: 0.66556 |  0:03:44s
epoch 13 | loss: 0.58335 | train_auc: 0.73918 | train_balanced_accuracy: 0.67623 | train_accuracy: 0.67682 | valid_auc: 0.72578 | valid_balanced_accuracy: 0.66607 | valid_accuracy: 0.66667 |  0:04:01s
epoch 14 | loss: 0.5823  | train_auc: 0.74277 | train_balanced_accuracy: 0.67998 | train_accuracy: 0.68028 | valid_auc: 0.72783 | valid_balanced_accuracy: 0.67396 | valid_accuracy: 0.67422 |  0:04:18s
epoch 15 | loss: 0.58459 | train_auc: 0.74742 | train_balanced_accuracy: 0.68211 | train_accuracy: 0.68244 | valid_auc: 0.73454 | valid_balanced_accuracy: 0.67486 | valid_accuracy: 0.67517 |  0:04:35s
epoch 16 | loss: 0.57905 | train_auc: 0.74927 | train_balanced_accuracy: 0.68037 | train_accuracy: 0.68071 | valid_auc: 0.73176 | valid_balanced_accuracy: 0.67091 | valid_accuracy: 0.67123 |  0:04:51s
epoch 17 | loss: 0.57749 | train_auc: 0.75055 | train_balanced_accuracy: 0.68384 | train_accuracy: 0.68437 | valid_auc: 0.73275 | valid_balanced_accuracy: 0.67214 | valid_accuracy: 0.67265 |  0:05:12s
epoch 18 | loss: 0.58132 | train_auc: 0.75739 | train_balanced_accuracy: 0.68683 | train_accuracy: 0.68752 | valid_auc: 0.73685 | valid_balanced_accuracy: 0.67843 | valid_accuracy: 0.6791  |  0:05:29s
epoch 19 | loss: 0.57645 | train_auc: 0.75513 | train_balanced_accuracy: 0.68462 | train_accuracy: 0.68516 | valid_auc: 0.73558 | valid_balanced_accuracy: 0.67716 | valid_accuracy: 0.67768 |  0:05:46s
epoch 20 | loss: 0.57561 | train_auc: 0.75977 | train_balanced_accuracy: 0.68581 | train_accuracy: 0.68638 | valid_auc: 0.73517 | valid_balanced_accuracy: 0.66944 | valid_accuracy: 0.66997 |  0:06:04s
epoch 21 | loss: 0.56961 | train_auc: 0.76693 | train_balanced_accuracy: 0.69639 | train_accuracy: 0.69692 | valid_auc: 0.74032 | valid_balanced_accuracy: 0.68169 | valid_accuracy: 0.68225 |  0:06:21s
epoch 22 | loss: 0.57213 | train_auc: 0.77167 | train_balanced_accuracy: 0.69605 | train_accuracy: 0.69661 | valid_auc: 0.74246 | valid_balanced_accuracy: 0.67918 | valid_accuracy: 0.67973 |  0:06:39s
epoch 23 | loss: 0.5703  | train_auc: 0.7737  | train_balanced_accuracy: 0.70457 | train_accuracy: 0.70483 | valid_auc: 0.7444  | valid_balanced_accuracy: 0.68686 | valid_accuracy: 0.68713 |  0:06:56s
epoch 24 | loss: 0.57095 | train_auc: 0.7757  | train_balanced_accuracy: 0.70097 | train_accuracy: 0.70133 | valid_auc: 0.74393 | valid_balanced_accuracy: 0.68048 | valid_accuracy: 0.68083 |  0:07:14s
epoch 25 | loss: 0.56574 | train_auc: 0.78012 | train_balanced_accuracy: 0.70639 | train_accuracy: 0.70668 | valid_auc: 0.74838 | valid_balanced_accuracy: 0.69267 | valid_accuracy: 0.69295 |  0:07:32s
epoch 26 | loss: 0.56498 | train_auc: 0.77712 | train_balanced_accuracy: 0.70382 | train_accuracy: 0.70424 | valid_auc: 0.74378 | valid_balanced_accuracy: 0.68628 | valid_accuracy: 0.68665 |  0:07:49s
epoch 27 | loss: 0.56728 | train_auc: 0.78634 | train_balanced_accuracy: 0.71203 | train_accuracy: 0.71219 | valid_auc: 0.75676 | valid_balanced_accuracy: 0.69139 | valid_accuracy: 0.69153 |  0:08:06s
epoch 28 | loss: 0.56156 | train_auc: 0.78545 | train_balanced_accuracy: 0.71166 | train_accuracy: 0.71172 | valid_auc: 0.75268 | valid_balanced_accuracy: 0.68961 | valid_accuracy: 0.68964 |  0:08:23s
epoch 29 | loss: 0.5604  | train_auc: 0.78262 | train_balanced_accuracy: 0.71024 | train_accuracy: 0.71018 | valid_auc: 0.7503  | valid_balanced_accuracy: 0.69381 | valid_accuracy: 0.69374 |  0:08:42s
epoch 30 | loss: 0.56326 | train_auc: 0.78721 | train_balanced_accuracy: 0.71361 | train_accuracy: 0.7138  | valid_auc: 0.75225 | valid_balanced_accuracy: 0.6873  | valid_accuracy: 0.68744 |  0:09:01s
epoch 31 | loss: 0.56111 | train_auc: 0.78611 | train_balanced_accuracy: 0.71096 | train_accuracy: 0.71117 | valid_auc: 0.7478  | valid_balanced_accuracy: 0.68366 | valid_accuracy: 0.68382 |  0:09:20s
epoch 32 | loss: 0.552   | train_auc: 0.79233 | train_balanced_accuracy: 0.71605 | train_accuracy: 0.71605 | valid_auc: 0.75314 | valid_balanced_accuracy: 0.68667 | valid_accuracy: 0.68665 |  0:09:36s
epoch 33 | loss: 0.55838 | train_auc: 0.79132 | train_balanced_accuracy: 0.71669 | train_accuracy: 0.71707 | valid_auc: 0.75197 | valid_balanced_accuracy: 0.6874  | valid_accuracy: 0.68776 |  0:09:53s
epoch 34 | loss: 0.55864 | train_auc: 0.78712 | train_balanced_accuracy: 0.71158 | train_accuracy: 0.71148 | valid_auc: 0.7515  | valid_balanced_accuracy: 0.67705 | valid_accuracy: 0.6769  |  0:10:11s
epoch 35 | loss: 0.5521  | train_auc: 0.79056 | train_balanced_accuracy: 0.71265 | train_accuracy: 0.71309 | valid_auc: 0.7484  | valid_balanced_accuracy: 0.67946 | valid_accuracy: 0.67989 |  0:10:29s
epoch 36 | loss: 0.55372 | train_auc: 0.78373 | train_balanced_accuracy: 0.70826 | train_accuracy: 0.70806 | valid_auc: 0.74904 | valid_balanced_accuracy: 0.67693 | valid_accuracy: 0.67674 |  0:10:47s
epoch 37 | loss: 0.55962 | train_auc: 0.79559 | train_balanced_accuracy: 0.72063 | train_accuracy: 0.72085 | valid_auc: 0.75444 | valid_balanced_accuracy: 0.69104 | valid_accuracy: 0.69122 |  0:11:05s
epoch 38 | loss: 0.55142 | train_auc: 0.79444 | train_balanced_accuracy: 0.71675 | train_accuracy: 0.71664 | valid_auc: 0.75608 | valid_balanced_accuracy: 0.68413 | valid_accuracy: 0.68398 |  0:11:23s
epoch 39 | loss: 0.54924 | train_auc: 0.79553 | train_balanced_accuracy: 0.71813 | train_accuracy: 0.71813 | valid_auc: 0.75526 | valid_balanced_accuracy: 0.69105 | valid_accuracy: 0.69106 |  0:11:41s
epoch 40 | loss: 0.55518 | train_auc: 0.78849 | train_balanced_accuracy: 0.70922 | train_accuracy: 0.70951 | valid_auc: 0.74333 | valid_balanced_accuracy: 0.67855 | valid_accuracy: 0.67879 |  0:11:57s
epoch 41 | loss: 0.55114 | train_auc: 0.79943 | train_balanced_accuracy: 0.72283 | train_accuracy: 0.72321 | valid_auc: 0.75192 | valid_balanced_accuracy: 0.68414 | valid_accuracy: 0.68445 |  0:12:14s
epoch 42 | loss: 0.54741 | train_auc: 0.79722 | train_balanced_accuracy: 0.71759 | train_accuracy: 0.71817 | valid_auc: 0.75413 | valid_balanced_accuracy: 0.68876 | valid_accuracy: 0.68933 |  0:12:30s
epoch 43 | loss: 0.55102 | train_auc: 0.79705 | train_balanced_accuracy: 0.71679 | train_accuracy: 0.71667 | valid_auc: 0.74838 | valid_balanced_accuracy: 0.68318 | valid_accuracy: 0.68303 |  0:12:48s
epoch 44 | loss: 0.55444 | train_auc: 0.80072 | train_balanced_accuracy: 0.7212  | train_accuracy: 0.72136 | valid_auc: 0.75655 | valid_balanced_accuracy: 0.69065 | valid_accuracy: 0.69075 |  0:13:06s
epoch 45 | loss: 0.54833 | train_auc: 0.80182 | train_balanced_accuracy: 0.72422 | train_accuracy: 0.7247  | valid_auc: 0.7541  | valid_balanced_accuracy: 0.68762 | valid_accuracy: 0.68807 |  0:13:22s
epoch 46 | loss: 0.54845 | train_auc: 0.80082 | train_balanced_accuracy: 0.7247  | train_accuracy: 0.72482 | valid_auc: 0.75504 | valid_balanced_accuracy: 0.69145 | valid_accuracy: 0.69153 |  0:13:39s
epoch 47 | loss: 0.54618 | train_auc: 0.80461 | train_balanced_accuracy: 0.72721 | train_accuracy: 0.72749 | valid_auc: 0.75601 | valid_balanced_accuracy: 0.68879 | valid_accuracy: 0.68901 |  0:13:57s
epoch 48 | loss: 0.54421 | train_auc: 0.80464 | train_balanced_accuracy: 0.72701 | train_accuracy: 0.7273  | valid_auc: 0.75718 | valid_balanced_accuracy: 0.68859 | valid_accuracy: 0.68886 |  0:14:15s
epoch 49 | loss: 0.54501 | train_auc: 0.79463 | train_balanced_accuracy: 0.71603 | train_accuracy: 0.71644 | valid_auc: 0.74939 | valid_balanced_accuracy: 0.68377 | valid_accuracy: 0.68414 |  0:14:33s

Early stopping occurred at epoch 49 with best_epoch = 29 and best_valid_accuracy = 0.69374
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 61/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=14.7min
[CV 4/5; 61/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70074 | train_auc: 0.58966 | train_balanced_accuracy: 0.52841 | train_accuracy: 0.52538 | valid_auc: 0.60398 | valid_balanced_accuracy: 0.52775 | valid_accuracy: 0.52471 |  0:00:18s
epoch 1  | loss: 0.65233 | train_auc: 0.6743  | train_balanced_accuracy: 0.61528 | train_accuracy: 0.61446 | valid_auc: 0.67217 | valid_balanced_accuracy: 0.61581 | valid_accuracy: 0.61505 |  0:00:34s
epoch 2  | loss: 0.62247 | train_auc: 0.69524 | train_balanced_accuracy: 0.62533 | train_accuracy: 0.62701 | valid_auc: 0.69963 | valid_balanced_accuracy: 0.63414 | valid_accuracy: 0.63582 |  0:00:52s
epoch 3  | loss: 0.61469 | train_auc: 0.68996 | train_balanced_accuracy: 0.62892 | train_accuracy: 0.63059 | valid_auc: 0.69433 | valid_balanced_accuracy: 0.6321  | valid_accuracy: 0.63377 |  0:01:10s
epoch 4  | loss: 0.60815 | train_auc: 0.70437 | train_balanced_accuracy: 0.61841 | train_accuracy: 0.62028 | valid_auc: 0.70964 | valid_balanced_accuracy: 0.62337 | valid_accuracy: 0.62528 |  0:01:27s
epoch 5  | loss: 0.60365 | train_auc: 0.7     | train_balanced_accuracy: 0.63762 | train_accuracy: 0.63901 | valid_auc: 0.70492 | valid_balanced_accuracy: 0.64481 | valid_accuracy: 0.64621 |  0:01:43s
epoch 6  | loss: 0.59916 | train_auc: 0.70807 | train_balanced_accuracy: 0.63855 | train_accuracy: 0.63991 | valid_auc: 0.71175 | valid_balanced_accuracy: 0.6423  | valid_accuracy: 0.64369 |  0:01:59s
epoch 7  | loss: 0.59243 | train_auc: 0.71474 | train_balanced_accuracy: 0.65629 | train_accuracy: 0.6573  | valid_auc: 0.71556 | valid_balanced_accuracy: 0.6598  | valid_accuracy: 0.66084 |  0:02:16s
epoch 8  | loss: 0.58852 | train_auc: 0.71658 | train_balanced_accuracy: 0.66046 | train_accuracy: 0.66151 | valid_auc: 0.7132  | valid_balanced_accuracy: 0.6607  | valid_accuracy: 0.66179 |  0:02:34s
epoch 9  | loss: 0.58724 | train_auc: 0.72537 | train_balanced_accuracy: 0.65283 | train_accuracy: 0.65423 | valid_auc: 0.72048 | valid_balanced_accuracy: 0.64981 | valid_accuracy: 0.65124 |  0:02:50s
epoch 10 | loss: 0.57994 | train_auc: 0.73165 | train_balanced_accuracy: 0.66965 | train_accuracy: 0.67048 | valid_auc: 0.7248  | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66242 |  0:03:05s
epoch 11 | loss: 0.58239 | train_auc: 0.72652 | train_balanced_accuracy: 0.67266 | train_accuracy: 0.67328 | valid_auc: 0.7181  | valid_balanced_accuracy: 0.66288 | valid_accuracy: 0.66352 |  0:03:23s
epoch 12 | loss: 0.58219 | train_auc: 0.73286 | train_balanced_accuracy: 0.67396 | train_accuracy: 0.67461 | valid_auc: 0.72245 | valid_balanced_accuracy: 0.66583 | valid_accuracy: 0.66651 |  0:03:41s
epoch 13 | loss: 0.57949 | train_auc: 0.73972 | train_balanced_accuracy: 0.6732  | train_accuracy: 0.67387 | valid_auc: 0.72823 | valid_balanced_accuracy: 0.66502 | valid_accuracy: 0.66572 |  0:04:00s
epoch 14 | loss: 0.5794  | train_auc: 0.73853 | train_balanced_accuracy: 0.67869 | train_accuracy: 0.67902 | valid_auc: 0.7295  | valid_balanced_accuracy: 0.66851 | valid_accuracy: 0.66887 |  0:04:17s
epoch 15 | loss: 0.58091 | train_auc: 0.74573 | train_balanced_accuracy: 0.6778  | train_accuracy: 0.67847 | valid_auc: 0.73264 | valid_balanced_accuracy: 0.66866 | valid_accuracy: 0.66934 |  0:04:36s
epoch 16 | loss: 0.57056 | train_auc: 0.7492  | train_balanced_accuracy: 0.68048 | train_accuracy: 0.68087 | valid_auc: 0.73225 | valid_balanced_accuracy: 0.66671 | valid_accuracy: 0.66714 |  0:04:52s
epoch 17 | loss: 0.57293 | train_auc: 0.74833 | train_balanced_accuracy: 0.67812 | train_accuracy: 0.67882 | valid_auc: 0.73449 | valid_balanced_accuracy: 0.66692 | valid_accuracy: 0.66761 |  0:05:13s
epoch 18 | loss: 0.57568 | train_auc: 0.75713 | train_balanced_accuracy: 0.68157 | train_accuracy: 0.68213 | valid_auc: 0.73756 | valid_balanced_accuracy: 0.6691  | valid_accuracy: 0.66966 |  0:05:32s
epoch 19 | loss: 0.57004 | train_auc: 0.75431 | train_balanced_accuracy: 0.68588 | train_accuracy: 0.68638 | valid_auc: 0.73783 | valid_balanced_accuracy: 0.67355 | valid_accuracy: 0.67406 |  0:05:51s
epoch 20 | loss: 0.56954 | train_auc: 0.75465 | train_balanced_accuracy: 0.68422 | train_accuracy: 0.6848  | valid_auc: 0.739   | valid_balanced_accuracy: 0.66905 | valid_accuracy: 0.66966 |  0:06:10s
epoch 21 | loss: 0.56811 | train_auc: 0.76564 | train_balanced_accuracy: 0.68658 | train_accuracy: 0.68728 | valid_auc: 0.74376 | valid_balanced_accuracy: 0.67887 | valid_accuracy: 0.67957 |  0:06:27s
epoch 22 | loss: 0.56797 | train_auc: 0.76683 | train_balanced_accuracy: 0.68883 | train_accuracy: 0.68917 | valid_auc: 0.73893 | valid_balanced_accuracy: 0.67024 | valid_accuracy: 0.6706  |  0:06:44s
epoch 23 | loss: 0.56678 | train_auc: 0.77347 | train_balanced_accuracy: 0.69811 | train_accuracy: 0.69838 | valid_auc: 0.74679 | valid_balanced_accuracy: 0.6766  | valid_accuracy: 0.6769  |  0:07:01s
epoch 24 | loss: 0.56704 | train_auc: 0.76681 | train_balanced_accuracy: 0.69274 | train_accuracy: 0.69319 | valid_auc: 0.73532 | valid_balanced_accuracy: 0.66983 | valid_accuracy: 0.67029 |  0:07:16s
epoch 25 | loss: 0.56393 | train_auc: 0.77792 | train_balanced_accuracy: 0.70501 | train_accuracy: 0.70523 | valid_auc: 0.74584 | valid_balanced_accuracy: 0.68219 | valid_accuracy: 0.6824  |  0:07:33s
epoch 26 | loss: 0.55993 | train_auc: 0.77259 | train_balanced_accuracy: 0.69531 | train_accuracy: 0.69551 | valid_auc: 0.74582 | valid_balanced_accuracy: 0.6745  | valid_accuracy: 0.67469 |  0:07:50s
epoch 27 | loss: 0.56209 | train_auc: 0.7838  | train_balanced_accuracy: 0.7045  | train_accuracy: 0.70515 | valid_auc: 0.75797 | valid_balanced_accuracy: 0.68755 | valid_accuracy: 0.68823 |  0:08:08s
epoch 28 | loss: 0.55955 | train_auc: 0.78084 | train_balanced_accuracy: 0.70535 | train_accuracy: 0.70546 | valid_auc: 0.74774 | valid_balanced_accuracy: 0.68009 | valid_accuracy: 0.6802  |  0:08:24s
epoch 29 | loss: 0.55981 | train_auc: 0.78281 | train_balanced_accuracy: 0.70606 | train_accuracy: 0.70613 | valid_auc: 0.75197 | valid_balanced_accuracy: 0.68171 | valid_accuracy: 0.68178 |  0:08:39s
epoch 30 | loss: 0.55551 | train_auc: 0.78593 | train_balanced_accuracy: 0.70838 | train_accuracy: 0.70841 | valid_auc: 0.75411 | valid_balanced_accuracy: 0.69008 | valid_accuracy: 0.69012 |  0:08:58s
epoch 31 | loss: 0.55825 | train_auc: 0.78358 | train_balanced_accuracy: 0.70821 | train_accuracy: 0.7081  | valid_auc: 0.74869 | valid_balanced_accuracy: 0.682   | valid_accuracy: 0.68193 |  0:09:17s
epoch 32 | loss: 0.55255 | train_auc: 0.78193 | train_balanced_accuracy: 0.70137 | train_accuracy: 0.7009  | valid_auc: 0.74379 | valid_balanced_accuracy: 0.67263 | valid_accuracy: 0.67218 |  0:09:34s
epoch 33 | loss: 0.55532 | train_auc: 0.78962 | train_balanced_accuracy: 0.71282 | train_accuracy: 0.71282 | valid_auc: 0.74952 | valid_balanced_accuracy: 0.68296 | valid_accuracy: 0.68303 |  0:09:50s
epoch 34 | loss: 0.5563  | train_auc: 0.78943 | train_balanced_accuracy: 0.71353 | train_accuracy: 0.71357 | valid_auc: 0.75326 | valid_balanced_accuracy: 0.68751 | valid_accuracy: 0.6876  |  0:10:07s
epoch 35 | loss: 0.54649 | train_auc: 0.7921  | train_balanced_accuracy: 0.71397 | train_accuracy: 0.71431 | valid_auc: 0.75048 | valid_balanced_accuracy: 0.67973 | valid_accuracy: 0.68004 |  0:10:24s
epoch 36 | loss: 0.54635 | train_auc: 0.79036 | train_balanced_accuracy: 0.71149 | train_accuracy: 0.71195 | valid_auc: 0.75194 | valid_balanced_accuracy: 0.689   | valid_accuracy: 0.68949 |  0:10:41s
epoch 37 | loss: 0.55071 | train_auc: 0.80034 | train_balanced_accuracy: 0.72002 | train_accuracy: 0.72025 | valid_auc: 0.75713 | valid_balanced_accuracy: 0.69351 | valid_accuracy: 0.69374 |  0:10:58s
epoch 38 | loss: 0.55334 | train_auc: 0.77856 | train_balanced_accuracy: 0.70094 | train_accuracy: 0.70149 | valid_auc: 0.74574 | valid_balanced_accuracy: 0.6809  | valid_accuracy: 0.68146 |  0:11:17s
epoch 39 | loss: 0.54854 | train_auc: 0.79294 | train_balanced_accuracy: 0.71204 | train_accuracy: 0.71266 | valid_auc: 0.75154 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.68587 |  0:11:35s
epoch 40 | loss: 0.54657 | train_auc: 0.79597 | train_balanced_accuracy: 0.7152  | train_accuracy: 0.71557 | valid_auc: 0.75798 | valid_balanced_accuracy: 0.69019 | valid_accuracy: 0.69059 |  0:11:50s
epoch 41 | loss: 0.5473  | train_auc: 0.80149 | train_balanced_accuracy: 0.72065 | train_accuracy: 0.72088 | valid_auc: 0.75396 | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68933 |  0:12:07s
epoch 42 | loss: 0.5456  | train_auc: 0.79908 | train_balanced_accuracy: 0.7203  | train_accuracy: 0.72053 | valid_auc: 0.7558  | valid_balanced_accuracy: 0.68855 | valid_accuracy: 0.68886 |  0:12:24s
epoch 43 | loss: 0.54813 | train_auc: 0.79356 | train_balanced_accuracy: 0.71354 | train_accuracy: 0.71333 | valid_auc: 0.7472  | valid_balanced_accuracy: 0.67678 | valid_accuracy: 0.67658 |  0:12:40s
epoch 44 | loss: 0.55072 | train_auc: 0.77724 | train_balanced_accuracy: 0.69802 | train_accuracy: 0.69771 | valid_auc: 0.74087 | valid_balanced_accuracy: 0.67055 | valid_accuracy: 0.67029 |  0:12:56s
epoch 45 | loss: 0.54438 | train_auc: 0.79734 | train_balanced_accuracy: 0.71855 | train_accuracy: 0.71868 | valid_auc: 0.75135 | valid_balanced_accuracy: 0.68206 | valid_accuracy: 0.68225 |  0:13:14s
epoch 46 | loss: 0.54674 | train_auc: 0.78322 | train_balanced_accuracy: 0.70367 | train_accuracy: 0.7033  | valid_auc: 0.74218 | valid_balanced_accuracy: 0.67674 | valid_accuracy: 0.67642 |  0:13:33s
epoch 47 | loss: 0.54834 | train_auc: 0.79258 | train_balanced_accuracy: 0.70762 | train_accuracy: 0.70845 | valid_auc: 0.75358 | valid_balanced_accuracy: 0.67604 | valid_accuracy: 0.6769  |  0:13:50s
epoch 48 | loss: 0.54465 | train_auc: 0.8037  | train_balanced_accuracy: 0.72359 | train_accuracy: 0.72352 | valid_auc: 0.75674 | valid_balanced_accuracy: 0.68591 | valid_accuracy: 0.68587 |  0:14:08s
epoch 49 | loss: 0.54125 | train_auc: 0.80779 | train_balanced_accuracy: 0.72534 | train_accuracy: 0.72561 | valid_auc: 0.76103 | valid_balanced_accuracy: 0.68621 | valid_accuracy: 0.6865  |  0:14:26s
epoch 50 | loss: 0.54467 | train_auc: 0.80828 | train_balanced_accuracy: 0.72545 | train_accuracy: 0.72572 | valid_auc: 0.76155 | valid_balanced_accuracy: 0.69578 | valid_accuracy: 0.6961  |  0:14:44s
epoch 51 | loss: 0.5375  | train_auc: 0.77767 | train_balanced_accuracy: 0.6971  | train_accuracy: 0.69799 | valid_auc: 0.74597 | valid_balanced_accuracy: 0.6732  | valid_accuracy: 0.67406 |  0:15:02s
epoch 52 | loss: 0.53519 | train_auc: 0.81217 | train_balanced_accuracy: 0.73029 | train_accuracy: 0.73029 | valid_auc: 0.7602  | valid_balanced_accuracy: 0.691   | valid_accuracy: 0.69106 |  0:15:19s
epoch 53 | loss: 0.5392  | train_auc: 0.80818 | train_balanced_accuracy: 0.72597 | train_accuracy: 0.7262  | valid_auc: 0.76509 | valid_balanced_accuracy: 0.68973 | valid_accuracy: 0.68996 |  0:15:37s
epoch 54 | loss: 0.54573 | train_auc: 0.80684 | train_balanced_accuracy: 0.72572 | train_accuracy: 0.72588 | valid_auc: 0.76295 | valid_balanced_accuracy: 0.69357 | valid_accuracy: 0.69374 |  0:15:53s
epoch 55 | loss: 0.5386  | train_auc: 0.80691 | train_balanced_accuracy: 0.72456 | train_accuracy: 0.72494 | valid_auc: 0.75947 | valid_balanced_accuracy: 0.68672 | valid_accuracy: 0.68713 |  0:16:12s
epoch 56 | loss: 0.53888 | train_auc: 0.78542 | train_balanced_accuracy: 0.70797 | train_accuracy: 0.70849 | valid_auc: 0.74811 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.67926 |  0:16:30s
epoch 57 | loss: 0.54148 | train_auc: 0.81554 | train_balanced_accuracy: 0.73322 | train_accuracy: 0.7334  | valid_auc: 0.76362 | valid_balanced_accuracy: 0.69087 | valid_accuracy: 0.69106 |  0:16:49s
epoch 58 | loss: 0.53844 | train_auc: 0.80947 | train_balanced_accuracy: 0.72711 | train_accuracy: 0.7271  | valid_auc: 0.75985 | valid_balanced_accuracy: 0.68682 | valid_accuracy: 0.68681 |  0:17:07s
epoch 59 | loss: 0.53636 | train_auc: 0.8046  | train_balanced_accuracy: 0.72023 | train_accuracy: 0.72049 | valid_auc: 0.75905 | valid_balanced_accuracy: 0.69097 | valid_accuracy: 0.69122 |  0:17:25s
epoch 60 | loss: 0.53559 | train_auc: 0.81732 | train_balanced_accuracy: 0.73544 | train_accuracy: 0.7356  | valid_auc: 0.76511 | valid_balanced_accuracy: 0.68962 | valid_accuracy: 0.6898  |  0:17:42s
epoch 61 | loss: 0.52832 | train_auc: 0.81489 | train_balanced_accuracy: 0.73238 | train_accuracy: 0.73257 | valid_auc: 0.76366 | valid_balanced_accuracy: 0.69413 | valid_accuracy: 0.69437 |  0:18:00s
epoch 62 | loss: 0.53137 | train_auc: 0.81383 | train_balanced_accuracy: 0.7302  | train_accuracy: 0.73017 | valid_auc: 0.76116 | valid_balanced_accuracy: 0.68823 | valid_accuracy: 0.68823 |  0:18:18s
epoch 63 | loss: 0.53191 | train_auc: 0.81541 | train_balanced_accuracy: 0.73108 | train_accuracy: 0.73131 | valid_auc: 0.76761 | valid_balanced_accuracy: 0.69658 | valid_accuracy: 0.69688 |  0:18:36s
epoch 64 | loss: 0.52602 | train_auc: 0.81762 | train_balanced_accuracy: 0.73508 | train_accuracy: 0.73493 | valid_auc: 0.76295 | valid_balanced_accuracy: 0.69024 | valid_accuracy: 0.69012 |  0:18:55s
epoch 65 | loss: 0.5273  | train_auc: 0.81256 | train_balanced_accuracy: 0.7285  | train_accuracy: 0.72832 | valid_auc: 0.75803 | valid_balanced_accuracy: 0.69087 | valid_accuracy: 0.69075 |  0:19:12s
epoch 66 | loss: 0.53207 | train_auc: 0.81631 | train_balanced_accuracy: 0.73355 | train_accuracy: 0.73363 | valid_auc: 0.76128 | valid_balanced_accuracy: 0.68704 | valid_accuracy: 0.68713 |  0:19:28s
epoch 67 | loss: 0.52731 | train_auc: 0.74301 | train_balanced_accuracy: 0.6734  | train_accuracy: 0.67422 | valid_auc: 0.71247 | valid_balanced_accuracy: 0.64961 | valid_accuracy: 0.65046 |  0:19:46s
epoch 68 | loss: 0.52875 | train_auc: 0.77438 | train_balanced_accuracy: 0.69511 | train_accuracy: 0.69598 | valid_auc: 0.7373  | valid_balanced_accuracy: 0.66741 | valid_accuracy: 0.66824 |  0:20:04s
epoch 69 | loss: 0.53173 | train_auc: 0.78347 | train_balanced_accuracy: 0.7061  | train_accuracy: 0.70676 | valid_auc: 0.74685 | valid_balanced_accuracy: 0.67369 | valid_accuracy: 0.67438 |  0:20:21s
epoch 70 | loss: 0.52547 | train_auc: 0.79878 | train_balanced_accuracy: 0.71567 | train_accuracy: 0.71616 | valid_auc: 0.7572  | valid_balanced_accuracy: 0.6855  | valid_accuracy: 0.68602 |  0:20:39s
epoch 71 | loss: 0.52607 | train_auc: 0.78981 | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70747 | valid_auc: 0.75025 | valid_balanced_accuracy: 0.67953 | valid_accuracy: 0.68004 |  0:20:55s
epoch 72 | loss: 0.53101 | train_auc: 0.66389 | train_balanced_accuracy: 0.62188 | train_accuracy: 0.62327 | valid_auc: 0.65332 | valid_balanced_accuracy: 0.613   | valid_accuracy: 0.61442 |  0:21:14s
epoch 73 | loss: 0.52748 | train_auc: 0.69808 | train_balanced_accuracy: 0.64924 | train_accuracy: 0.64991 | valid_auc: 0.6863  | valid_balanced_accuracy: 0.64173 | valid_accuracy: 0.64243 |  0:21:33s
epoch 74 | loss: 0.52953 | train_auc: 0.74982 | train_balanced_accuracy: 0.6748  | train_accuracy: 0.67564 | valid_auc: 0.72112 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65738 |  0:21:51s
epoch 75 | loss: 0.52547 | train_auc: 0.80009 | train_balanced_accuracy: 0.71701 | train_accuracy: 0.71742 | valid_auc: 0.75189 | valid_balanced_accuracy: 0.68151 | valid_accuracy: 0.68193 |  0:22:07s
epoch 76 | loss: 0.52409 | train_auc: 0.82042 | train_balanced_accuracy: 0.73302 | train_accuracy: 0.73277 | valid_auc: 0.76388 | valid_balanced_accuracy: 0.69129 | valid_accuracy: 0.69106 |  0:22:25s
epoch 77 | loss: 0.52559 | train_auc: 0.80534 | train_balanced_accuracy: 0.72554 | train_accuracy: 0.72537 | valid_auc: 0.75504 | valid_balanced_accuracy: 0.68944 | valid_accuracy: 0.68933 |  0:22:42s
epoch 78 | loss: 0.51986 | train_auc: 0.80845 | train_balanced_accuracy: 0.72521 | train_accuracy: 0.72498 | valid_auc: 0.7598  | valid_balanced_accuracy: 0.69076 | valid_accuracy: 0.69059 |  0:22:58s
epoch 79 | loss: 0.51974 | train_auc: 0.80705 | train_balanced_accuracy: 0.72707 | train_accuracy: 0.72683 | valid_auc: 0.75017 | valid_balanced_accuracy: 0.68291 | valid_accuracy: 0.68272 |  0:23:15s
epoch 80 | loss: 0.52185 | train_auc: 0.80671 | train_balanced_accuracy: 0.72879 | train_accuracy: 0.72887 | valid_auc: 0.7476  | valid_balanced_accuracy: 0.6827  | valid_accuracy: 0.68288 |  0:23:32s
epoch 81 | loss: 0.52514 | train_auc: 0.8077  | train_balanced_accuracy: 0.72683 | train_accuracy: 0.72683 | valid_auc: 0.75318 | valid_balanced_accuracy: 0.68426 | valid_accuracy: 0.68429 |  0:23:48s
epoch 82 | loss: 0.51777 | train_auc: 0.80555 | train_balanced_accuracy: 0.72415 | train_accuracy: 0.7245  | valid_auc: 0.75181 | valid_balanced_accuracy: 0.67996 | valid_accuracy: 0.68036 |  0:24:07s
epoch 83 | loss: 0.51924 | train_auc: 0.82097 | train_balanced_accuracy: 0.73606 | train_accuracy: 0.73623 | valid_auc: 0.76476 | valid_balanced_accuracy: 0.69353 | valid_accuracy: 0.69374 |  0:24:23s

Early stopping occurred at epoch 83 with best_epoch = 63 and best_valid_accuracy = 0.69688
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 61/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.694 total time=24.5min
[CV 5/5; 61/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68515 | train_auc: 0.61981 | train_balanced_accuracy: 0.52406 | train_accuracy: 0.52113 | valid_auc: 0.61923 | valid_balanced_accuracy: 0.52391 | valid_accuracy: 0.52093 |  0:00:20s
epoch 1  | loss: 0.62944 | train_auc: 0.66491 | train_balanced_accuracy: 0.58889 | train_accuracy: 0.58691 | valid_auc: 0.6664  | valid_balanced_accuracy: 0.58447 | valid_accuracy: 0.58247 |  0:00:37s
epoch 2  | loss: 0.62171 | train_auc: 0.68543 | train_balanced_accuracy: 0.58769 | train_accuracy: 0.58554 | valid_auc: 0.68295 | valid_balanced_accuracy: 0.58798 | valid_accuracy: 0.58577 |  0:00:53s
epoch 3  | loss: 0.61407 | train_auc: 0.69179 | train_balanced_accuracy: 0.61735 | train_accuracy: 0.61599 | valid_auc: 0.68985 | valid_balanced_accuracy: 0.61863 | valid_accuracy: 0.61725 |  0:01:10s
epoch 4  | loss: 0.60511 | train_auc: 0.6862  | train_balanced_accuracy: 0.62094 | train_accuracy: 0.61973 | valid_auc: 0.68427 | valid_balanced_accuracy: 0.62084 | valid_accuracy: 0.61961 |  0:01:30s
epoch 5  | loss: 0.60134 | train_auc: 0.69937 | train_balanced_accuracy: 0.63334 | train_accuracy: 0.63283 | valid_auc: 0.6948  | valid_balanced_accuracy: 0.62897 | valid_accuracy: 0.62842 |  0:01:48s
epoch 6  | loss: 0.60124 | train_auc: 0.7107  | train_balanced_accuracy: 0.64144 | train_accuracy: 0.64093 | valid_auc: 0.70437 | valid_balanced_accuracy: 0.63459 | valid_accuracy: 0.63409 |  0:02:03s
epoch 7  | loss: 0.59954 | train_auc: 0.70856 | train_balanced_accuracy: 0.6547  | train_accuracy: 0.6553  | valid_auc: 0.70309 | valid_balanced_accuracy: 0.64881 | valid_accuracy: 0.64935 |  0:02:20s
epoch 8  | loss: 0.59939 | train_auc: 0.71433 | train_balanced_accuracy: 0.66109 | train_accuracy: 0.66183 | valid_auc: 0.7094  | valid_balanced_accuracy: 0.6575  | valid_accuracy: 0.65817 |  0:02:37s
epoch 9  | loss: 0.59737 | train_auc: 0.72261 | train_balanced_accuracy: 0.6637  | train_accuracy: 0.66435 | valid_auc: 0.71417 | valid_balanced_accuracy: 0.65935 | valid_accuracy: 0.6599  |  0:02:53s
epoch 10 | loss: 0.59459 | train_auc: 0.7281  | train_balanced_accuracy: 0.66613 | train_accuracy: 0.66675 | valid_auc: 0.72269 | valid_balanced_accuracy: 0.662   | valid_accuracy: 0.66257 |  0:03:11s
epoch 11 | loss: 0.59239 | train_auc: 0.73219 | train_balanced_accuracy: 0.6717  | train_accuracy: 0.67245 | valid_auc: 0.72639 | valid_balanced_accuracy: 0.66363 | valid_accuracy: 0.66431 |  0:03:28s
epoch 12 | loss: 0.58621 | train_auc: 0.73763 | train_balanced_accuracy: 0.67428 | train_accuracy: 0.67481 | valid_auc: 0.72783 | valid_balanced_accuracy: 0.66778 | valid_accuracy: 0.66824 |  0:03:45s
epoch 13 | loss: 0.59414 | train_auc: 0.73961 | train_balanced_accuracy: 0.67386 | train_accuracy: 0.67458 | valid_auc: 0.73064 | valid_balanced_accuracy: 0.66207 | valid_accuracy: 0.66273 |  0:04:02s
epoch 14 | loss: 0.58397 | train_auc: 0.73773 | train_balanced_accuracy: 0.6657  | train_accuracy: 0.666   | valid_auc: 0.73102 | valid_balanced_accuracy: 0.66402 | valid_accuracy: 0.66431 |  0:04:21s
epoch 15 | loss: 0.58255 | train_auc: 0.74569 | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67733 | valid_auc: 0.739   | valid_balanced_accuracy: 0.66464 | valid_accuracy: 0.66525 |  0:04:38s
epoch 16 | loss: 0.582   | train_auc: 0.74615 | train_balanced_accuracy: 0.67671 | train_accuracy: 0.67698 | valid_auc: 0.73791 | valid_balanced_accuracy: 0.66775 | valid_accuracy: 0.66793 |  0:04:55s
epoch 17 | loss: 0.5811  | train_auc: 0.75113 | train_balanced_accuracy: 0.67962 | train_accuracy: 0.68016 | valid_auc: 0.74109 | valid_balanced_accuracy: 0.66853 | valid_accuracy: 0.66903 |  0:05:15s
epoch 18 | loss: 0.57749 | train_auc: 0.75518 | train_balanced_accuracy: 0.68344 | train_accuracy: 0.68406 | valid_auc: 0.74229 | valid_balanced_accuracy: 0.67268 | valid_accuracy: 0.67328 |  0:05:32s
epoch 19 | loss: 0.57674 | train_auc: 0.75931 | train_balanced_accuracy: 0.68561 | train_accuracy: 0.6863  | valid_auc: 0.7471  | valid_balanced_accuracy: 0.67374 | valid_accuracy: 0.67438 |  0:05:49s
epoch 20 | loss: 0.57853 | train_auc: 0.76013 | train_balanced_accuracy: 0.6885  | train_accuracy: 0.68901 | valid_auc: 0.74266 | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67359 |  0:06:05s
epoch 21 | loss: 0.57438 | train_auc: 0.76051 | train_balanced_accuracy: 0.68852 | train_accuracy: 0.68894 | valid_auc: 0.74418 | valid_balanced_accuracy: 0.6737  | valid_accuracy: 0.67406 |  0:06:23s
epoch 22 | loss: 0.57108 | train_auc: 0.76513 | train_balanced_accuracy: 0.69337 | train_accuracy: 0.69378 | valid_auc: 0.74677 | valid_balanced_accuracy: 0.67856 | valid_accuracy: 0.67894 |  0:06:41s
epoch 23 | loss: 0.57156 | train_auc: 0.7609  | train_balanced_accuracy: 0.69246 | train_accuracy: 0.69287 | valid_auc: 0.74362 | valid_balanced_accuracy: 0.67808 | valid_accuracy: 0.67847 |  0:06:58s
epoch 24 | loss: 0.57529 | train_auc: 0.76874 | train_balanced_accuracy: 0.69778 | train_accuracy: 0.69834 | valid_auc: 0.75027 | valid_balanced_accuracy: 0.67789 | valid_accuracy: 0.67847 |  0:07:18s
epoch 25 | loss: 0.57126 | train_auc: 0.75411 | train_balanced_accuracy: 0.6828  | train_accuracy: 0.6826  | valid_auc: 0.73477 | valid_balanced_accuracy: 0.66483 | valid_accuracy: 0.66462 |  0:07:36s
epoch 26 | loss: 0.57192 | train_auc: 0.76697 | train_balanced_accuracy: 0.70086 | train_accuracy: 0.70109 | valid_auc: 0.74472 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.6813  |  0:07:54s
epoch 27 | loss: 0.57023 | train_auc: 0.76269 | train_balanced_accuracy: 0.70066 | train_accuracy: 0.7009  | valid_auc: 0.74555 | valid_balanced_accuracy: 0.68529 | valid_accuracy: 0.68555 |  0:08:11s
epoch 28 | loss: 0.56678 | train_auc: 0.76763 | train_balanced_accuracy: 0.70106 | train_accuracy: 0.70109 | valid_auc: 0.75173 | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69106 |  0:08:28s
epoch 29 | loss: 0.56981 | train_auc: 0.77513 | train_balanced_accuracy: 0.70139 | train_accuracy: 0.70125 | valid_auc: 0.74873 | valid_balanced_accuracy: 0.67861 | valid_accuracy: 0.67847 |  0:08:44s
epoch 30 | loss: 0.56883 | train_auc: 0.76737 | train_balanced_accuracy: 0.69833 | train_accuracy: 0.6985  | valid_auc: 0.74151 | valid_balanced_accuracy: 0.681   | valid_accuracy: 0.68115 |  0:09:03s
epoch 31 | loss: 0.56601 | train_auc: 0.71557 | train_balanced_accuracy: 0.65383 | train_accuracy: 0.65408 | valid_auc: 0.70363 | valid_balanced_accuracy: 0.64201 | valid_accuracy: 0.64227 |  0:09:20s
epoch 32 | loss: 0.56447 | train_auc: 0.74938 | train_balanced_accuracy: 0.67525 | train_accuracy: 0.67509 | valid_auc: 0.72894 | valid_balanced_accuracy: 0.66388 | valid_accuracy: 0.66368 |  0:09:38s
epoch 33 | loss: 0.56951 | train_auc: 0.76805 | train_balanced_accuracy: 0.69628 | train_accuracy: 0.69681 | valid_auc: 0.74447 | valid_balanced_accuracy: 0.67671 | valid_accuracy: 0.67721 |  0:09:55s
epoch 34 | loss: 0.56149 | train_auc: 0.74712 | train_balanced_accuracy: 0.67671 | train_accuracy: 0.67686 | valid_auc: 0.72622 | valid_balanced_accuracy: 0.65851 | valid_accuracy: 0.65864 |  0:10:12s
epoch 35 | loss: 0.56133 | train_auc: 0.74433 | train_balanced_accuracy: 0.67458 | train_accuracy: 0.67458 | valid_auc: 0.72897 | valid_balanced_accuracy: 0.66151 | valid_accuracy: 0.66147 |  0:10:30s
epoch 36 | loss: 0.55773 | train_auc: 0.75926 | train_balanced_accuracy: 0.68757 | train_accuracy: 0.6876  | valid_auc: 0.73843 | valid_balanced_accuracy: 0.66962 | valid_accuracy: 0.66966 |  0:10:46s
epoch 37 | loss: 0.55876 | train_auc: 0.77782 | train_balanced_accuracy: 0.70094 | train_accuracy: 0.70133 | valid_auc: 0.74543 | valid_balanced_accuracy: 0.67303 | valid_accuracy: 0.67343 |  0:11:05s
epoch 38 | loss: 0.55815 | train_auc: 0.78876 | train_balanced_accuracy: 0.7113  | train_accuracy: 0.71105 | valid_auc: 0.75343 | valid_balanced_accuracy: 0.68236 | valid_accuracy: 0.68209 |  0:11:23s
epoch 39 | loss: 0.55642 | train_auc: 0.79332 | train_balanced_accuracy: 0.71463 | train_accuracy: 0.71502 | valid_auc: 0.7557  | valid_balanced_accuracy: 0.68598 | valid_accuracy: 0.68634 |  0:11:41s
epoch 40 | loss: 0.55595 | train_auc: 0.79404 | train_balanced_accuracy: 0.71708 | train_accuracy: 0.7173  | valid_auc: 0.76222 | valid_balanced_accuracy: 0.69605 | valid_accuracy: 0.69625 |  0:11:57s
epoch 41 | loss: 0.55334 | train_auc: 0.78987 | train_balanced_accuracy: 0.71599 | train_accuracy: 0.71624 | valid_auc: 0.75683 | valid_balanced_accuracy: 0.68831 | valid_accuracy: 0.68854 |  0:12:14s
epoch 42 | loss: 0.55606 | train_auc: 0.78999 | train_balanced_accuracy: 0.71433 | train_accuracy: 0.71486 | valid_auc: 0.75383 | valid_balanced_accuracy: 0.68456 | valid_accuracy: 0.68508 |  0:12:30s
epoch 43 | loss: 0.55208 | train_auc: 0.79563 | train_balanced_accuracy: 0.72098 | train_accuracy: 0.72092 | valid_auc: 0.76077 | valid_balanced_accuracy: 0.68812 | valid_accuracy: 0.68807 |  0:12:48s
epoch 44 | loss: 0.55084 | train_auc: 0.79827 | train_balanced_accuracy: 0.72232 | train_accuracy: 0.72254 | valid_auc: 0.76234 | valid_balanced_accuracy: 0.69358 | valid_accuracy: 0.69374 |  0:13:07s
epoch 45 | loss: 0.55075 | train_auc: 0.79479 | train_balanced_accuracy: 0.71558 | train_accuracy: 0.71612 | valid_auc: 0.75833 | valid_balanced_accuracy: 0.6855  | valid_accuracy: 0.68602 |  0:13:24s
epoch 46 | loss: 0.55159 | train_auc: 0.80076 | train_balanced_accuracy: 0.72159 | train_accuracy: 0.72171 | valid_auc: 0.76125 | valid_balanced_accuracy: 0.69409 | valid_accuracy: 0.69421 |  0:13:41s
epoch 47 | loss: 0.55349 | train_auc: 0.79459 | train_balanced_accuracy: 0.71959 | train_accuracy: 0.71978 | valid_auc: 0.75649 | valid_balanced_accuracy: 0.69306 | valid_accuracy: 0.69326 |  0:14:02s
epoch 48 | loss: 0.55118 | train_auc: 0.80069 | train_balanced_accuracy: 0.72349 | train_accuracy: 0.72348 | valid_auc: 0.76409 | valid_balanced_accuracy: 0.69538 | valid_accuracy: 0.69531 |  0:14:20s
epoch 49 | loss: 0.54385 | train_auc: 0.80084 | train_balanced_accuracy: 0.72191 | train_accuracy: 0.72214 | valid_auc: 0.75737 | valid_balanced_accuracy: 0.68881 | valid_accuracy: 0.68901 |  0:14:38s
epoch 50 | loss: 0.54675 | train_auc: 0.80363 | train_balanced_accuracy: 0.72459 | train_accuracy: 0.72478 | valid_auc: 0.76508 | valid_balanced_accuracy: 0.69639 | valid_accuracy: 0.69657 |  0:14:54s
epoch 51 | loss: 0.54729 | train_auc: 0.806   | train_balanced_accuracy: 0.72571 | train_accuracy: 0.72608 | valid_auc: 0.76082 | valid_balanced_accuracy: 0.6904  | valid_accuracy: 0.69075 |  0:15:11s
epoch 52 | loss: 0.54372 | train_auc: 0.80411 | train_balanced_accuracy: 0.72464 | train_accuracy: 0.72478 | valid_auc: 0.76195 | valid_balanced_accuracy: 0.69478 | valid_accuracy: 0.69484 |  0:15:28s
epoch 53 | loss: 0.54739 | train_auc: 0.80687 | train_balanced_accuracy: 0.72789 | train_accuracy: 0.72828 | valid_auc: 0.76123 | valid_balanced_accuracy: 0.69069 | valid_accuracy: 0.69106 |  0:15:45s
epoch 54 | loss: 0.54886 | train_auc: 0.80428 | train_balanced_accuracy: 0.7239  | train_accuracy: 0.72395 | valid_auc: 0.7614  | valid_balanced_accuracy: 0.69298 | valid_accuracy: 0.69295 |  0:16:03s
epoch 55 | loss: 0.54772 | train_auc: 0.80541 | train_balanced_accuracy: 0.72441 | train_accuracy: 0.72462 | valid_auc: 0.76475 | valid_balanced_accuracy: 0.69245 | valid_accuracy: 0.69263 |  0:16:21s
epoch 56 | loss: 0.54357 | train_auc: 0.80746 | train_balanced_accuracy: 0.72519 | train_accuracy: 0.72529 | valid_auc: 0.75929 | valid_balanced_accuracy: 0.69288 | valid_accuracy: 0.69295 |  0:16:38s
epoch 57 | loss: 0.54146 | train_auc: 0.79931 | train_balanced_accuracy: 0.71944 | train_accuracy: 0.71966 | valid_auc: 0.75624 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68571 |  0:16:55s
epoch 58 | loss: 0.54081 | train_auc: 0.80091 | train_balanced_accuracy: 0.72207 | train_accuracy: 0.72203 | valid_auc: 0.75453 | valid_balanced_accuracy: 0.68875 | valid_accuracy: 0.6887  |  0:17:12s
epoch 59 | loss: 0.5464  | train_auc: 0.80491 | train_balanced_accuracy: 0.72564 | train_accuracy: 0.72616 | valid_auc: 0.75971 | valid_balanced_accuracy: 0.68774 | valid_accuracy: 0.68823 |  0:17:29s
epoch 60 | loss: 0.54391 | train_auc: 0.81055 | train_balanced_accuracy: 0.72961 | train_accuracy: 0.72974 | valid_auc: 0.76597 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69531 |  0:17:47s
epoch 61 | loss: 0.5445  | train_auc: 0.80396 | train_balanced_accuracy: 0.72399 | train_accuracy: 0.72431 | valid_auc: 0.76011 | valid_balanced_accuracy: 0.68777 | valid_accuracy: 0.68807 |  0:18:05s
epoch 62 | loss: 0.53796 | train_auc: 0.81301 | train_balanced_accuracy: 0.73026 | train_accuracy: 0.73037 | valid_auc: 0.76368 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69263 |  0:18:23s
epoch 63 | loss: 0.53598 | train_auc: 0.81297 | train_balanced_accuracy: 0.72822 | train_accuracy: 0.7286  | valid_auc: 0.76677 | valid_balanced_accuracy: 0.69548 | valid_accuracy: 0.69578 |  0:18:40s
epoch 64 | loss: 0.53874 | train_auc: 0.81008 | train_balanced_accuracy: 0.72996 | train_accuracy: 0.73029 | valid_auc: 0.76337 | valid_balanced_accuracy: 0.69324 | valid_accuracy: 0.69358 |  0:18:59s
epoch 65 | loss: 0.54479 | train_auc: 0.81203 | train_balanced_accuracy: 0.73242 | train_accuracy: 0.73269 | valid_auc: 0.76045 | valid_balanced_accuracy: 0.68798 | valid_accuracy: 0.68823 |  0:19:15s
epoch 66 | loss: 0.54062 | train_auc: 0.81254 | train_balanced_accuracy: 0.73307 | train_accuracy: 0.73328 | valid_auc: 0.76708 | valid_balanced_accuracy: 0.69261 | valid_accuracy: 0.69279 |  0:19:34s
epoch 67 | loss: 0.53912 | train_auc: 0.81291 | train_balanced_accuracy: 0.72964 | train_accuracy: 0.72989 | valid_auc: 0.76194 | valid_balanced_accuracy: 0.68991 | valid_accuracy: 0.69012 |  0:19:53s
epoch 68 | loss: 0.53088 | train_auc: 0.81146 | train_balanced_accuracy: 0.72917 | train_accuracy: 0.72962 | valid_auc: 0.76362 | valid_balanced_accuracy: 0.68984 | valid_accuracy: 0.69027 |  0:20:10s
epoch 69 | loss: 0.53989 | train_auc: 0.80885 | train_balanced_accuracy: 0.72884 | train_accuracy: 0.72915 | valid_auc: 0.76121 | valid_balanced_accuracy: 0.6958  | valid_accuracy: 0.6961  |  0:20:28s
epoch 70 | loss: 0.53462 | train_auc: 0.8161  | train_balanced_accuracy: 0.73413 | train_accuracy: 0.73438 | valid_auc: 0.76833 | valid_balanced_accuracy: 0.69494 | valid_accuracy: 0.69515 |  0:20:44s

Early stopping occurred at epoch 70 with best_epoch = 50 and best_valid_accuracy = 0.69657
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 61/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.696 total time=20.9min
[CV 1/5; 62/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7055  | train_auc: 0.60384 | train_balanced_accuracy: 0.52098 | train_accuracy: 0.51796 | valid_auc: 0.59972 | valid_balanced_accuracy: 0.52024 | valid_accuracy: 0.51715 |  0:00:17s
epoch 1  | loss: 0.64808 | train_auc: 0.62887 | train_balanced_accuracy: 0.56397 | train_accuracy: 0.5616  | valid_auc: 0.62857 | valid_balanced_accuracy: 0.5652  | valid_accuracy: 0.5628  |  0:00:35s
epoch 2  | loss: 0.63515 | train_auc: 0.64353 | train_balanced_accuracy: 0.58368 | train_accuracy: 0.5817  | valid_auc: 0.64233 | valid_balanced_accuracy: 0.57964 | valid_accuracy: 0.57759 |  0:00:52s
epoch 3  | loss: 0.62546 | train_auc: 0.65733 | train_balanced_accuracy: 0.58482 | train_accuracy: 0.58269 | valid_auc: 0.65552 | valid_balanced_accuracy: 0.57993 | valid_accuracy: 0.57775 |  0:01:09s
epoch 4  | loss: 0.61186 | train_auc: 0.66817 | train_balanced_accuracy: 0.60797 | train_accuracy: 0.60689 | valid_auc: 0.66834 | valid_balanced_accuracy: 0.60689 | valid_accuracy: 0.60576 |  0:01:26s
epoch 5  | loss: 0.6098  | train_auc: 0.66467 | train_balanced_accuracy: 0.61182 | train_accuracy: 0.61098 | valid_auc: 0.66457 | valid_balanced_accuracy: 0.6148  | valid_accuracy: 0.61394 |  0:01:45s
epoch 6  | loss: 0.6095  | train_auc: 0.66444 | train_balanced_accuracy: 0.61429 | train_accuracy: 0.61346 | valid_auc: 0.66565 | valid_balanced_accuracy: 0.61432 | valid_accuracy: 0.61347 |  0:02:02s
epoch 7  | loss: 0.6072  | train_auc: 0.68516 | train_balanced_accuracy: 0.61327 | train_accuracy: 0.6122  | valid_auc: 0.68303 | valid_balanced_accuracy: 0.61689 | valid_accuracy: 0.61583 |  0:02:19s
epoch 8  | loss: 0.59878 | train_auc: 0.6845  | train_balanced_accuracy: 0.62386 | train_accuracy: 0.62318 | valid_auc: 0.68272 | valid_balanced_accuracy: 0.62895 | valid_accuracy: 0.62827 |  0:02:35s
epoch 9  | loss: 0.6027  | train_auc: 0.6891  | train_balanced_accuracy: 0.62383 | train_accuracy: 0.62286 | valid_auc: 0.69101 | valid_balanced_accuracy: 0.63568 | valid_accuracy: 0.63472 |  0:02:53s
epoch 10 | loss: 0.59316 | train_auc: 0.69635 | train_balanced_accuracy: 0.6325  | train_accuracy: 0.63199 | valid_auc: 0.69527 | valid_balanced_accuracy: 0.63902 | valid_accuracy: 0.6385  |  0:03:12s
epoch 11 | loss: 0.59473 | train_auc: 0.71056 | train_balanced_accuracy: 0.64168 | train_accuracy: 0.64116 | valid_auc: 0.70688 | valid_balanced_accuracy: 0.64424 | valid_accuracy: 0.64369 |  0:03:28s
epoch 12 | loss: 0.59673 | train_auc: 0.71649 | train_balanced_accuracy: 0.64927 | train_accuracy: 0.64895 | valid_auc: 0.70764 | valid_balanced_accuracy: 0.64327 | valid_accuracy: 0.6429  |  0:03:45s
epoch 13 | loss: 0.59367 | train_auc: 0.71652 | train_balanced_accuracy: 0.64962 | train_accuracy: 0.64966 | valid_auc: 0.70727 | valid_balanced_accuracy: 0.64035 | valid_accuracy: 0.64038 |  0:04:03s
epoch 14 | loss: 0.58949 | train_auc: 0.71725 | train_balanced_accuracy: 0.65344 | train_accuracy: 0.65343 | valid_auc: 0.70786 | valid_balanced_accuracy: 0.64335 | valid_accuracy: 0.64337 |  0:04:21s
epoch 15 | loss: 0.58903 | train_auc: 0.72478 | train_balanced_accuracy: 0.65565 | train_accuracy: 0.65579 | valid_auc: 0.71777 | valid_balanced_accuracy: 0.64194 | valid_accuracy: 0.64212 |  0:04:38s
epoch 16 | loss: 0.58456 | train_auc: 0.72335 | train_balanced_accuracy: 0.66006 | train_accuracy: 0.66004 | valid_auc: 0.71228 | valid_balanced_accuracy: 0.64969 | valid_accuracy: 0.64967 |  0:04:54s
epoch 17 | loss: 0.58276 | train_auc: 0.73453 | train_balanced_accuracy: 0.66933 | train_accuracy: 0.66964 | valid_auc: 0.72162 | valid_balanced_accuracy: 0.65958 | valid_accuracy: 0.6599  |  0:05:15s
epoch 18 | loss: 0.58371 | train_auc: 0.74163 | train_balanced_accuracy: 0.67022 | train_accuracy: 0.67098 | valid_auc: 0.72871 | valid_balanced_accuracy: 0.661   | valid_accuracy: 0.66179 |  0:05:33s
epoch 19 | loss: 0.58284 | train_auc: 0.74709 | train_balanced_accuracy: 0.6803  | train_accuracy: 0.68082 | valid_auc: 0.73102 | valid_balanced_accuracy: 0.67247 | valid_accuracy: 0.67296 |  0:05:50s
epoch 20 | loss: 0.5833  | train_auc: 0.75033 | train_balanced_accuracy: 0.6826  | train_accuracy: 0.68314 | valid_auc: 0.73188 | valid_balanced_accuracy: 0.66678 | valid_accuracy: 0.6673  |  0:06:06s
epoch 21 | loss: 0.57726 | train_auc: 0.75353 | train_balanced_accuracy: 0.68363 | train_accuracy: 0.68416 | valid_auc: 0.73097 | valid_balanced_accuracy: 0.66784 | valid_accuracy: 0.6684  |  0:06:23s
epoch 22 | loss: 0.58121 | train_auc: 0.75592 | train_balanced_accuracy: 0.69049 | train_accuracy: 0.69085 | valid_auc: 0.73915 | valid_balanced_accuracy: 0.67783 | valid_accuracy: 0.67816 |  0:06:40s
epoch 23 | loss: 0.57564 | train_auc: 0.75375 | train_balanced_accuracy: 0.68866 | train_accuracy: 0.6892  | valid_auc: 0.73554 | valid_balanced_accuracy: 0.66989 | valid_accuracy: 0.67044 |  0:06:57s
epoch 24 | loss: 0.58181 | train_auc: 0.75946 | train_balanced_accuracy: 0.68988 | train_accuracy: 0.6903  | valid_auc: 0.73379 | valid_balanced_accuracy: 0.66956 | valid_accuracy: 0.66997 |  0:07:17s
epoch 25 | loss: 0.57347 | train_auc: 0.76852 | train_balanced_accuracy: 0.69985 | train_accuracy: 0.69982 | valid_auc: 0.74058 | valid_balanced_accuracy: 0.6738  | valid_accuracy: 0.67375 |  0:07:34s
epoch 26 | loss: 0.57244 | train_auc: 0.77006 | train_balanced_accuracy: 0.69876 | train_accuracy: 0.69923 | valid_auc: 0.73864 | valid_balanced_accuracy: 0.67265 | valid_accuracy: 0.67312 |  0:07:52s
epoch 27 | loss: 0.57422 | train_auc: 0.77044 | train_balanced_accuracy: 0.69908 | train_accuracy: 0.69943 | valid_auc: 0.74143 | valid_balanced_accuracy: 0.68138 | valid_accuracy: 0.68178 |  0:08:08s
epoch 28 | loss: 0.57517 | train_auc: 0.77111 | train_balanced_accuracy: 0.69958 | train_accuracy: 0.69982 | valid_auc: 0.74174 | valid_balanced_accuracy: 0.67665 | valid_accuracy: 0.6769  |  0:08:25s
epoch 29 | loss: 0.56857 | train_auc: 0.77936 | train_balanced_accuracy: 0.70481 | train_accuracy: 0.70506 | valid_auc: 0.74825 | valid_balanced_accuracy: 0.67982 | valid_accuracy: 0.68004 |  0:08:42s
epoch 30 | loss: 0.56888 | train_auc: 0.7768  | train_balanced_accuracy: 0.70502 | train_accuracy: 0.70525 | valid_auc: 0.74278 | valid_balanced_accuracy: 0.67825 | valid_accuracy: 0.67847 |  0:09:00s
epoch 31 | loss: 0.56707 | train_auc: 0.78117 | train_balanced_accuracy: 0.70963 | train_accuracy: 0.70962 | valid_auc: 0.74582 | valid_balanced_accuracy: 0.67883 | valid_accuracy: 0.67879 |  0:09:18s
epoch 32 | loss: 0.57148 | train_auc: 0.78214 | train_balanced_accuracy: 0.70858 | train_accuracy: 0.70895 | valid_auc: 0.74518 | valid_balanced_accuracy: 0.68233 | valid_accuracy: 0.68272 |  0:09:35s
epoch 33 | loss: 0.56894 | train_auc: 0.78392 | train_balanced_accuracy: 0.7091  | train_accuracy: 0.70931 | valid_auc: 0.74819 | valid_balanced_accuracy: 0.68172 | valid_accuracy: 0.68193 |  0:09:52s
epoch 34 | loss: 0.56846 | train_auc: 0.78393 | train_balanced_accuracy: 0.70893 | train_accuracy: 0.70923 | valid_auc: 0.75066 | valid_balanced_accuracy: 0.6824  | valid_accuracy: 0.68272 |  0:10:08s
epoch 35 | loss: 0.56803 | train_auc: 0.78465 | train_balanced_accuracy: 0.70929 | train_accuracy: 0.70962 | valid_auc: 0.7484  | valid_balanced_accuracy: 0.68237 | valid_accuracy: 0.68272 |  0:10:27s
epoch 36 | loss: 0.56884 | train_auc: 0.78742 | train_balanced_accuracy: 0.71128 | train_accuracy: 0.71115 | valid_auc: 0.74881 | valid_balanced_accuracy: 0.68332 | valid_accuracy: 0.68319 |  0:10:43s
epoch 37 | loss: 0.56439 | train_auc: 0.78449 | train_balanced_accuracy: 0.70628 | train_accuracy: 0.70679 | valid_auc: 0.74867 | valid_balanced_accuracy: 0.68318 | valid_accuracy: 0.68366 |  0:11:00s
epoch 38 | loss: 0.56511 | train_auc: 0.77507 | train_balanced_accuracy: 0.70126 | train_accuracy: 0.70124 | valid_auc: 0.73695 | valid_balanced_accuracy: 0.6719  | valid_accuracy: 0.67186 |  0:11:17s
epoch 39 | loss: 0.5627  | train_auc: 0.7871  | train_balanced_accuracy: 0.71154 | train_accuracy: 0.71182 | valid_auc: 0.74595 | valid_balanced_accuracy: 0.67754 | valid_accuracy: 0.67784 |  0:11:34s
epoch 40 | loss: 0.56191 | train_auc: 0.78922 | train_balanced_accuracy: 0.71246 | train_accuracy: 0.71269 | valid_auc: 0.74768 | valid_balanced_accuracy: 0.6801  | valid_accuracy: 0.68036 |  0:11:53s
epoch 41 | loss: 0.56372 | train_auc: 0.78659 | train_balanced_accuracy: 0.71104 | train_accuracy: 0.71115 | valid_auc: 0.74212 | valid_balanced_accuracy: 0.67722 | valid_accuracy: 0.67737 |  0:12:08s
epoch 42 | loss: 0.554   | train_auc: 0.79089 | train_balanced_accuracy: 0.71462 | train_accuracy: 0.71466 | valid_auc: 0.74452 | valid_balanced_accuracy: 0.67592 | valid_accuracy: 0.67595 |  0:12:24s
epoch 43 | loss: 0.56356 | train_auc: 0.79383 | train_balanced_accuracy: 0.71537 | train_accuracy: 0.71556 | valid_auc: 0.75057 | valid_balanced_accuracy: 0.68705 | valid_accuracy: 0.68728 |  0:12:43s
epoch 44 | loss: 0.55745 | train_auc: 0.79341 | train_balanced_accuracy: 0.71365 | train_accuracy: 0.71399 | valid_auc: 0.74997 | valid_balanced_accuracy: 0.68048 | valid_accuracy: 0.68083 |  0:13:00s
epoch 45 | loss: 0.55763 | train_auc: 0.79144 | train_balanced_accuracy: 0.71433 | train_accuracy: 0.71466 | valid_auc: 0.748   | valid_balanced_accuracy: 0.68381 | valid_accuracy: 0.68414 |  0:13:16s
epoch 46 | loss: 0.55573 | train_auc: 0.79074 | train_balanced_accuracy: 0.71337 | train_accuracy: 0.71328 | valid_auc: 0.74562 | valid_balanced_accuracy: 0.68235 | valid_accuracy: 0.68225 |  0:13:36s
epoch 47 | loss: 0.55823 | train_auc: 0.78887 | train_balanced_accuracy: 0.71387 | train_accuracy: 0.71418 | valid_auc: 0.74613 | valid_balanced_accuracy: 0.68037 | valid_accuracy: 0.68067 |  0:13:54s
epoch 48 | loss: 0.55151 | train_auc: 0.79803 | train_balanced_accuracy: 0.71823 | train_accuracy: 0.71808 | valid_auc: 0.75061 | valid_balanced_accuracy: 0.68038 | valid_accuracy: 0.6802  |  0:14:11s
epoch 49 | loss: 0.55439 | train_auc: 0.79384 | train_balanced_accuracy: 0.718   | train_accuracy: 0.71792 | valid_auc: 0.75147 | valid_balanced_accuracy: 0.68695 | valid_accuracy: 0.68681 |  0:14:29s
epoch 50 | loss: 0.55145 | train_auc: 0.79636 | train_balanced_accuracy: 0.71753 | train_accuracy: 0.71769 | valid_auc: 0.75254 | valid_balanced_accuracy: 0.68128 | valid_accuracy: 0.68146 |  0:14:47s
epoch 51 | loss: 0.55281 | train_auc: 0.78983 | train_balanced_accuracy: 0.71212 | train_accuracy: 0.71222 | valid_auc: 0.75199 | valid_balanced_accuracy: 0.68583 | valid_accuracy: 0.68587 |  0:15:03s
epoch 52 | loss: 0.55127 | train_auc: 0.79972 | train_balanced_accuracy: 0.72249 | train_accuracy: 0.72249 | valid_auc: 0.75616 | valid_balanced_accuracy: 0.69057 | valid_accuracy: 0.69059 |  0:15:19s
epoch 53 | loss: 0.55062 | train_auc: 0.79735 | train_balanced_accuracy: 0.72023 | train_accuracy: 0.72044 | valid_auc: 0.75277 | valid_balanced_accuracy: 0.68581 | valid_accuracy: 0.68602 |  0:15:35s
epoch 54 | loss: 0.54688 | train_auc: 0.79802 | train_balanced_accuracy: 0.71826 | train_accuracy: 0.71836 | valid_auc: 0.75289 | valid_balanced_accuracy: 0.68575 | valid_accuracy: 0.68587 |  0:15:52s
epoch 55 | loss: 0.55525 | train_auc: 0.79917 | train_balanced_accuracy: 0.71871 | train_accuracy: 0.71914 | valid_auc: 0.74896 | valid_balanced_accuracy: 0.68083 | valid_accuracy: 0.6813  |  0:16:09s
epoch 56 | loss: 0.55042 | train_auc: 0.80355 | train_balanced_accuracy: 0.72214 | train_accuracy: 0.72221 | valid_auc: 0.75365 | valid_balanced_accuracy: 0.68504 | valid_accuracy: 0.68508 |  0:16:26s
epoch 57 | loss: 0.54548 | train_auc: 0.80199 | train_balanced_accuracy: 0.72405 | train_accuracy: 0.7241  | valid_auc: 0.75413 | valid_balanced_accuracy: 0.69165 | valid_accuracy: 0.69169 |  0:16:44s
epoch 58 | loss: 0.54738 | train_auc: 0.80105 | train_balanced_accuracy: 0.72283 | train_accuracy: 0.72296 | valid_auc: 0.74949 | valid_balanced_accuracy: 0.68058 | valid_accuracy: 0.68067 |  0:17:00s
epoch 59 | loss: 0.54785 | train_auc: 0.79993 | train_balanced_accuracy: 0.72343 | train_accuracy: 0.72359 | valid_auc: 0.7482  | valid_balanced_accuracy: 0.67941 | valid_accuracy: 0.67957 |  0:17:17s
epoch 60 | loss: 0.55015 | train_auc: 0.80557 | train_balanced_accuracy: 0.72667 | train_accuracy: 0.72678 | valid_auc: 0.75398 | valid_balanced_accuracy: 0.68904 | valid_accuracy: 0.68917 |  0:17:33s
epoch 61 | loss: 0.54763 | train_auc: 0.80729 | train_balanced_accuracy: 0.72423 | train_accuracy: 0.72453 | valid_auc: 0.75251 | valid_balanced_accuracy: 0.68549 | valid_accuracy: 0.68587 |  0:17:52s
epoch 62 | loss: 0.54548 | train_auc: 0.8076  | train_balanced_accuracy: 0.72593 | train_accuracy: 0.72591 | valid_auc: 0.75621 | valid_balanced_accuracy: 0.68947 | valid_accuracy: 0.68949 |  0:18:10s
epoch 63 | loss: 0.54606 | train_auc: 0.80859 | train_balanced_accuracy: 0.72665 | train_accuracy: 0.72693 | valid_auc: 0.75272 | valid_balanced_accuracy: 0.68464 | valid_accuracy: 0.68492 |  0:18:27s
epoch 64 | loss: 0.54021 | train_auc: 0.80939 | train_balanced_accuracy: 0.72794 | train_accuracy: 0.72807 | valid_auc: 0.75245 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68445 |  0:18:44s
epoch 65 | loss: 0.54208 | train_auc: 0.80726 | train_balanced_accuracy: 0.72535 | train_accuracy: 0.7256  | valid_auc: 0.75019 | valid_balanced_accuracy: 0.68069 | valid_accuracy: 0.68099 |  0:19:02s
epoch 66 | loss: 0.53909 | train_auc: 0.80978 | train_balanced_accuracy: 0.72572 | train_accuracy: 0.72556 | valid_auc: 0.75249 | valid_balanced_accuracy: 0.68589 | valid_accuracy: 0.68571 |  0:19:19s
epoch 67 | loss: 0.54053 | train_auc: 0.80801 | train_balanced_accuracy: 0.72763 | train_accuracy: 0.72796 | valid_auc: 0.74871 | valid_balanced_accuracy: 0.68303 | valid_accuracy: 0.68335 |  0:19:35s
epoch 68 | loss: 0.54724 | train_auc: 0.8001  | train_balanced_accuracy: 0.72174 | train_accuracy: 0.72198 | valid_auc: 0.74757 | valid_balanced_accuracy: 0.68736 | valid_accuracy: 0.6876  |  0:19:53s
epoch 69 | loss: 0.54471 | train_auc: 0.80654 | train_balanced_accuracy: 0.7261  | train_accuracy: 0.72634 | valid_auc: 0.74983 | valid_balanced_accuracy: 0.68563 | valid_accuracy: 0.68587 |  0:20:10s
epoch 70 | loss: 0.53675 | train_auc: 0.81043 | train_balanced_accuracy: 0.72714 | train_accuracy: 0.72725 | valid_auc: 0.74976 | valid_balanced_accuracy: 0.682   | valid_accuracy: 0.68209 |  0:20:27s
epoch 71 | loss: 0.54214 | train_auc: 0.80856 | train_balanced_accuracy: 0.7289  | train_accuracy: 0.72898 | valid_auc: 0.75273 | valid_balanced_accuracy: 0.68156 | valid_accuracy: 0.68162 |  0:20:44s
epoch 72 | loss: 0.5403  | train_auc: 0.81195 | train_balanced_accuracy: 0.7299  | train_accuracy: 0.73008 | valid_auc: 0.75491 | valid_balanced_accuracy: 0.69072 | valid_accuracy: 0.6909  |  0:21:01s
epoch 73 | loss: 0.53644 | train_auc: 0.81456 | train_balanced_accuracy: 0.73209 | train_accuracy: 0.73209 | valid_auc: 0.75309 | valid_balanced_accuracy: 0.68657 | valid_accuracy: 0.6865  |  0:21:16s
epoch 74 | loss: 0.54088 | train_auc: 0.81429 | train_balanced_accuracy: 0.73033 | train_accuracy: 0.73063 | valid_auc: 0.75357 | valid_balanced_accuracy: 0.68666 | valid_accuracy: 0.68697 |  0:21:35s
epoch 75 | loss: 0.54104 | train_auc: 0.81382 | train_balanced_accuracy: 0.73085 | train_accuracy: 0.73118 | valid_auc: 0.75011 | valid_balanced_accuracy: 0.6833  | valid_accuracy: 0.68366 |  0:21:51s
epoch 76 | loss: 0.54289 | train_auc: 0.81045 | train_balanced_accuracy: 0.72738 | train_accuracy: 0.72733 | valid_auc: 0.75547 | valid_balanced_accuracy: 0.68565 | valid_accuracy: 0.68555 |  0:22:09s
epoch 77 | loss: 0.53729 | train_auc: 0.8058  | train_balanced_accuracy: 0.72569 | train_accuracy: 0.72575 | valid_auc: 0.75377 | valid_balanced_accuracy: 0.68754 | valid_accuracy: 0.6876  |  0:22:26s

Early stopping occurred at epoch 77 with best_epoch = 57 and best_valid_accuracy = 0.69169
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 62/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.699 total time=22.6min
[CV 2/5; 62/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71534 | train_auc: 0.59479 | train_balanced_accuracy: 0.58324 | train_accuracy: 0.583   | valid_auc: 0.59806 | valid_balanced_accuracy: 0.58964 | valid_accuracy: 0.58939 |  0:00:15s
epoch 1  | loss: 0.65461 | train_auc: 0.62683 | train_balanced_accuracy: 0.55073 | train_accuracy: 0.5481  | valid_auc: 0.62253 | valid_balanced_accuracy: 0.54424 | valid_accuracy: 0.54155 |  0:00:33s
epoch 2  | loss: 0.63874 | train_auc: 0.64795 | train_balanced_accuracy: 0.51734 | train_accuracy: 0.51403 | valid_auc: 0.64585 | valid_balanced_accuracy: 0.51675 | valid_accuracy: 0.51338 |  0:00:50s
epoch 3  | loss: 0.62366 | train_auc: 0.67178 | train_balanced_accuracy: 0.52901 | train_accuracy: 0.52583 | valid_auc: 0.6689  | valid_balanced_accuracy: 0.52577 | valid_accuracy: 0.52251 |  0:01:08s
epoch 4  | loss: 0.61152 | train_auc: 0.67953 | train_balanced_accuracy: 0.57662 | train_accuracy: 0.57439 | valid_auc: 0.67291 | valid_balanced_accuracy: 0.56861 | valid_accuracy: 0.56626 |  0:01:26s
epoch 5  | loss: 0.61259 | train_auc: 0.68039 | train_balanced_accuracy: 0.60372 | train_accuracy: 0.60197 | valid_auc: 0.67326 | valid_balanced_accuracy: 0.59725 | valid_accuracy: 0.59537 |  0:01:44s
epoch 6  | loss: 0.60811 | train_auc: 0.6919  | train_balanced_accuracy: 0.60654 | train_accuracy: 0.60484 | valid_auc: 0.68409 | valid_balanced_accuracy: 0.59954 | valid_accuracy: 0.59773 |  0:02:02s
epoch 7  | loss: 0.60384 | train_auc: 0.69441 | train_balanced_accuracy: 0.62029 | train_accuracy: 0.61897 | valid_auc: 0.68652 | valid_balanced_accuracy: 0.61393 | valid_accuracy: 0.61253 |  0:02:18s
epoch 8  | loss: 0.59463 | train_auc: 0.70224 | train_balanced_accuracy: 0.63392 | train_accuracy: 0.63317 | valid_auc: 0.69421 | valid_balanced_accuracy: 0.62646 | valid_accuracy: 0.62559 |  0:02:34s
epoch 9  | loss: 0.59906 | train_auc: 0.71307 | train_balanced_accuracy: 0.61934 | train_accuracy: 0.61778 | valid_auc: 0.70202 | valid_balanced_accuracy: 0.60425 | valid_accuracy: 0.60261 |  0:02:50s
epoch 10 | loss: 0.58637 | train_auc: 0.71873 | train_balanced_accuracy: 0.65164 | train_accuracy: 0.65099 | valid_auc: 0.70845 | valid_balanced_accuracy: 0.64343 | valid_accuracy: 0.64274 |  0:03:09s
epoch 11 | loss: 0.59098 | train_auc: 0.72209 | train_balanced_accuracy: 0.64762 | train_accuracy: 0.64674 | valid_auc: 0.71015 | valid_balanced_accuracy: 0.63375 | valid_accuracy: 0.63283 |  0:03:28s
epoch 12 | loss: 0.58974 | train_auc: 0.72008 | train_balanced_accuracy: 0.64654 | train_accuracy: 0.64576 | valid_auc: 0.70693 | valid_balanced_accuracy: 0.63243 | valid_accuracy: 0.63157 |  0:03:45s
epoch 13 | loss: 0.5858  | train_auc: 0.7301  | train_balanced_accuracy: 0.66253 | train_accuracy: 0.66201 | valid_auc: 0.71905 | valid_balanced_accuracy: 0.65308 | valid_accuracy: 0.6525  |  0:04:01s
epoch 14 | loss: 0.58641 | train_auc: 0.72956 | train_balanced_accuracy: 0.66216 | train_accuracy: 0.66166 | valid_auc: 0.71121 | valid_balanced_accuracy: 0.64328 | valid_accuracy: 0.64274 |  0:04:20s
epoch 15 | loss: 0.58421 | train_auc: 0.73793 | train_balanced_accuracy: 0.67307 | train_accuracy: 0.67275 | valid_auc: 0.72286 | valid_balanced_accuracy: 0.66389 | valid_accuracy: 0.66352 |  0:04:38s
epoch 16 | loss: 0.58193 | train_auc: 0.74615 | train_balanced_accuracy: 0.67738 | train_accuracy: 0.67704 | valid_auc: 0.73093 | valid_balanced_accuracy: 0.6639  | valid_accuracy: 0.66352 |  0:04:54s
epoch 17 | loss: 0.5802  | train_auc: 0.74675 | train_balanced_accuracy: 0.67889 | train_accuracy: 0.67877 | valid_auc: 0.72714 | valid_balanced_accuracy: 0.66271 | valid_accuracy: 0.66257 |  0:05:15s
epoch 18 | loss: 0.57903 | train_auc: 0.75543 | train_balanced_accuracy: 0.69544 | train_accuracy: 0.69589 | valid_auc: 0.73901 | valid_balanced_accuracy: 0.68026 | valid_accuracy: 0.68067 |  0:05:33s
epoch 19 | loss: 0.57942 | train_auc: 0.7639  | train_balanced_accuracy: 0.6993  | train_accuracy: 0.69959 | valid_auc: 0.74279 | valid_balanced_accuracy: 0.6817  | valid_accuracy: 0.68193 |  0:05:51s
epoch 20 | loss: 0.57727 | train_auc: 0.76621 | train_balanced_accuracy: 0.7021  | train_accuracy: 0.7025  | valid_auc: 0.74675 | valid_balanced_accuracy: 0.68615 | valid_accuracy: 0.6865  |  0:06:08s
epoch 21 | loss: 0.57531 | train_auc: 0.76813 | train_balanced_accuracy: 0.70234 | train_accuracy: 0.70273 | valid_auc: 0.74623 | valid_balanced_accuracy: 0.68173 | valid_accuracy: 0.68209 |  0:06:26s
epoch 22 | loss: 0.58035 | train_auc: 0.77228 | train_balanced_accuracy: 0.70279 | train_accuracy: 0.70301 | valid_auc: 0.74742 | valid_balanced_accuracy: 0.68116 | valid_accuracy: 0.6813  |  0:06:44s
epoch 23 | loss: 0.5768  | train_auc: 0.77405 | train_balanced_accuracy: 0.70599 | train_accuracy: 0.70632 | valid_auc: 0.74983 | valid_balanced_accuracy: 0.68528 | valid_accuracy: 0.68555 |  0:07:01s
epoch 24 | loss: 0.57707 | train_auc: 0.77685 | train_balanced_accuracy: 0.70798 | train_accuracy: 0.70828 | valid_auc: 0.75339 | valid_balanced_accuracy: 0.68703 | valid_accuracy: 0.68728 |  0:07:18s
epoch 25 | loss: 0.56803 | train_auc: 0.77933 | train_balanced_accuracy: 0.7094  | train_accuracy: 0.70946 | valid_auc: 0.75324 | valid_balanced_accuracy: 0.68808 | valid_accuracy: 0.68807 |  0:07:36s
epoch 26 | loss: 0.56994 | train_auc: 0.77804 | train_balanced_accuracy: 0.70761 | train_accuracy: 0.70781 | valid_auc: 0.75367 | valid_balanced_accuracy: 0.68572 | valid_accuracy: 0.68587 |  0:07:52s
epoch 27 | loss: 0.57244 | train_auc: 0.7807  | train_balanced_accuracy: 0.71019 | train_accuracy: 0.71045 | valid_auc: 0.75196 | valid_balanced_accuracy: 0.68453 | valid_accuracy: 0.68477 |  0:08:10s
epoch 28 | loss: 0.56764 | train_auc: 0.78292 | train_balanced_accuracy: 0.71289 | train_accuracy: 0.71312 | valid_auc: 0.75661 | valid_balanced_accuracy: 0.68949 | valid_accuracy: 0.68964 |  0:08:28s
epoch 29 | loss: 0.56613 | train_auc: 0.78254 | train_balanced_accuracy: 0.71136 | train_accuracy: 0.71151 | valid_auc: 0.75524 | valid_balanced_accuracy: 0.68718 | valid_accuracy: 0.68728 |  0:08:45s
epoch 30 | loss: 0.56344 | train_auc: 0.78548 | train_balanced_accuracy: 0.71326 | train_accuracy: 0.71363 | valid_auc: 0.75794 | valid_balanced_accuracy: 0.69229 | valid_accuracy: 0.69263 |  0:09:01s
epoch 31 | loss: 0.56735 | train_auc: 0.75129 | train_balanced_accuracy: 0.69319 | train_accuracy: 0.69321 | valid_auc: 0.73136 | valid_balanced_accuracy: 0.6747  | valid_accuracy: 0.67469 |  0:09:19s
epoch 32 | loss: 0.56581 | train_auc: 0.7345  | train_balanced_accuracy: 0.68306 | train_accuracy: 0.6833  | valid_auc: 0.72221 | valid_balanced_accuracy: 0.67607 | valid_accuracy: 0.67627 |  0:09:35s
epoch 33 | loss: 0.5625  | train_auc: 0.74988 | train_balanced_accuracy: 0.6898  | train_accuracy: 0.68995 | valid_auc: 0.72903 | valid_balanced_accuracy: 0.6768  | valid_accuracy: 0.6769  |  0:09:51s
epoch 34 | loss: 0.56187 | train_auc: 0.75893 | train_balanced_accuracy: 0.69749 | train_accuracy: 0.6975  | valid_auc: 0.7302  | valid_balanced_accuracy: 0.67204 | valid_accuracy: 0.67202 |  0:10:10s
epoch 35 | loss: 0.56252 | train_auc: 0.76543 | train_balanced_accuracy: 0.7006  | train_accuracy: 0.70096 | valid_auc: 0.74021 | valid_balanced_accuracy: 0.68289 | valid_accuracy: 0.68319 |  0:10:28s
epoch 36 | loss: 0.56004 | train_auc: 0.78195 | train_balanced_accuracy: 0.71149 | train_accuracy: 0.71151 | valid_auc: 0.75063 | valid_balanced_accuracy: 0.68119 | valid_accuracy: 0.68115 |  0:10:46s
epoch 37 | loss: 0.56501 | train_auc: 0.78962 | train_balanced_accuracy: 0.71797 | train_accuracy: 0.71824 | valid_auc: 0.75723 | valid_balanced_accuracy: 0.69542 | valid_accuracy: 0.69562 |  0:11:03s
epoch 38 | loss: 0.55846 | train_auc: 0.7851  | train_balanced_accuracy: 0.71293 | train_accuracy: 0.71281 | valid_auc: 0.75226 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.68508 |  0:11:20s
epoch 39 | loss: 0.56005 | train_auc: 0.77814 | train_balanced_accuracy: 0.71    | train_accuracy: 0.71033 | valid_auc: 0.74499 | valid_balanced_accuracy: 0.6834  | valid_accuracy: 0.68366 |  0:11:39s
epoch 40 | loss: 0.56185 | train_auc: 0.78261 | train_balanced_accuracy: 0.71153 | train_accuracy: 0.71155 | valid_auc: 0.75028 | valid_balanced_accuracy: 0.68576 | valid_accuracy: 0.68571 |  0:11:55s
epoch 41 | loss: 0.55678 | train_auc: 0.77411 | train_balanced_accuracy: 0.70599 | train_accuracy: 0.70608 | valid_auc: 0.74475 | valid_balanced_accuracy: 0.68549 | valid_accuracy: 0.68555 |  0:12:12s
epoch 42 | loss: 0.553   | train_auc: 0.76997 | train_balanced_accuracy: 0.70298 | train_accuracy: 0.70321 | valid_auc: 0.74045 | valid_balanced_accuracy: 0.67469 | valid_accuracy: 0.67485 |  0:12:30s
epoch 43 | loss: 0.56135 | train_auc: 0.78315 | train_balanced_accuracy: 0.7158  | train_accuracy: 0.71607 | valid_auc: 0.75218 | valid_balanced_accuracy: 0.69055 | valid_accuracy: 0.69075 |  0:12:47s
epoch 44 | loss: 0.55621 | train_auc: 0.78425 | train_balanced_accuracy: 0.71358 | train_accuracy: 0.71371 | valid_auc: 0.75311 | valid_balanced_accuracy: 0.68752 | valid_accuracy: 0.6876  |  0:13:05s
epoch 45 | loss: 0.55079 | train_auc: 0.7889  | train_balanced_accuracy: 0.71439 | train_accuracy: 0.71477 | valid_auc: 0.75135 | valid_balanced_accuracy: 0.68931 | valid_accuracy: 0.68964 |  0:13:22s
epoch 46 | loss: 0.55358 | train_auc: 0.79806 | train_balanced_accuracy: 0.72228 | train_accuracy: 0.72233 | valid_auc: 0.75866 | valid_balanced_accuracy: 0.69424 | valid_accuracy: 0.69421 |  0:13:39s
epoch 47 | loss: 0.55479 | train_auc: 0.79621 | train_balanced_accuracy: 0.71939 | train_accuracy: 0.71977 | valid_auc: 0.75813 | valid_balanced_accuracy: 0.69386 | valid_accuracy: 0.69421 |  0:13:56s
epoch 48 | loss: 0.54904 | train_auc: 0.79784 | train_balanced_accuracy: 0.72179 | train_accuracy: 0.72186 | valid_auc: 0.75617 | valid_balanced_accuracy: 0.69042 | valid_accuracy: 0.69043 |  0:14:13s
epoch 49 | loss: 0.55032 | train_auc: 0.79444 | train_balanced_accuracy: 0.72035 | train_accuracy: 0.72044 | valid_auc: 0.75368 | valid_balanced_accuracy: 0.69006 | valid_accuracy: 0.69012 |  0:14:31s
epoch 50 | loss: 0.54979 | train_auc: 0.79732 | train_balanced_accuracy: 0.72304 | train_accuracy: 0.72323 | valid_auc: 0.75776 | valid_balanced_accuracy: 0.6934  | valid_accuracy: 0.69358 |  0:14:48s
epoch 51 | loss: 0.55331 | train_auc: 0.79047 | train_balanced_accuracy: 0.71853 | train_accuracy: 0.71871 | valid_auc: 0.75766 | valid_balanced_accuracy: 0.69136 | valid_accuracy: 0.69153 |  0:15:04s
epoch 52 | loss: 0.54773 | train_auc: 0.80395 | train_balanced_accuracy: 0.72873 | train_accuracy: 0.72886 | valid_auc: 0.75958 | valid_balanced_accuracy: 0.69192 | valid_accuracy: 0.69201 |  0:15:22s
epoch 53 | loss: 0.54878 | train_auc: 0.80396 | train_balanced_accuracy: 0.72739 | train_accuracy: 0.72768 | valid_auc: 0.7577  | valid_balanced_accuracy: 0.69126 | valid_accuracy: 0.69153 |  0:15:40s
epoch 54 | loss: 0.55097 | train_auc: 0.79659 | train_balanced_accuracy: 0.7191  | train_accuracy: 0.71938 | valid_auc: 0.76016 | valid_balanced_accuracy: 0.69647 | valid_accuracy: 0.69673 |  0:15:56s
epoch 55 | loss: 0.55311 | train_auc: 0.80133 | train_balanced_accuracy: 0.72496 | train_accuracy: 0.72532 | valid_auc: 0.75561 | valid_balanced_accuracy: 0.69276 | valid_accuracy: 0.69311 |  0:16:14s
epoch 56 | loss: 0.54549 | train_auc: 0.77787 | train_balanced_accuracy: 0.70048 | train_accuracy: 0.701   | valid_auc: 0.74757 | valid_balanced_accuracy: 0.67751 | valid_accuracy: 0.678   |  0:16:32s
epoch 57 | loss: 0.54712 | train_auc: 0.78322 | train_balanced_accuracy: 0.70929 | train_accuracy: 0.70942 | valid_auc: 0.74401 | valid_balanced_accuracy: 0.67664 | valid_accuracy: 0.67674 |  0:16:50s
epoch 58 | loss: 0.54414 | train_auc: 0.76226 | train_balanced_accuracy: 0.68775 | train_accuracy: 0.68806 | valid_auc: 0.73684 | valid_balanced_accuracy: 0.67078 | valid_accuracy: 0.67107 |  0:17:05s
epoch 59 | loss: 0.54437 | train_auc: 0.80378 | train_balanced_accuracy: 0.72875 | train_accuracy: 0.7289  | valid_auc: 0.75814 | valid_balanced_accuracy: 0.69283 | valid_accuracy: 0.69295 |  0:17:23s
epoch 60 | loss: 0.5422  | train_auc: 0.74767 | train_balanced_accuracy: 0.68518 | train_accuracy: 0.6855  | valid_auc: 0.7239  | valid_balanced_accuracy: 0.66939 | valid_accuracy: 0.66966 |  0:17:40s
epoch 61 | loss: 0.54047 | train_auc: 0.72614 | train_balanced_accuracy: 0.67279 | train_accuracy: 0.67322 | valid_auc: 0.70893 | valid_balanced_accuracy: 0.65325 | valid_accuracy: 0.6536  |  0:17:58s
epoch 62 | loss: 0.54301 | train_auc: 0.74674 | train_balanced_accuracy: 0.68714 | train_accuracy: 0.68704 | valid_auc: 0.72005 | valid_balanced_accuracy: 0.66678 | valid_accuracy: 0.66667 |  0:18:16s
epoch 63 | loss: 0.54748 | train_auc: 0.77348 | train_balanced_accuracy: 0.70255 | train_accuracy: 0.70266 | valid_auc: 0.73844 | valid_balanced_accuracy: 0.67962 | valid_accuracy: 0.67973 |  0:18:31s
epoch 64 | loss: 0.54127 | train_auc: 0.78224 | train_balanced_accuracy: 0.70974 | train_accuracy: 0.70962 | valid_auc: 0.74082 | valid_balanced_accuracy: 0.68222 | valid_accuracy: 0.68209 |  0:18:48s
epoch 65 | loss: 0.53781 | train_auc: 0.80203 | train_balanced_accuracy: 0.72576 | train_accuracy: 0.72595 | valid_auc: 0.75491 | valid_balanced_accuracy: 0.69045 | valid_accuracy: 0.69059 |  0:19:06s
epoch 66 | loss: 0.54198 | train_auc: 0.80284 | train_balanced_accuracy: 0.72638 | train_accuracy: 0.72634 | valid_auc: 0.75781 | valid_balanced_accuracy: 0.69019 | valid_accuracy: 0.69012 |  0:19:23s
epoch 67 | loss: 0.5394  | train_auc: 0.80698 | train_balanced_accuracy: 0.72849 | train_accuracy: 0.7287  | valid_auc: 0.75735 | valid_balanced_accuracy: 0.68505 | valid_accuracy: 0.68524 |  0:19:42s
epoch 68 | loss: 0.54278 | train_auc: 0.80933 | train_balanced_accuracy: 0.73293 | train_accuracy: 0.73319 | valid_auc: 0.76552 | valid_balanced_accuracy: 0.69588 | valid_accuracy: 0.6961  |  0:19:59s
epoch 69 | loss: 0.53907 | train_auc: 0.81169 | train_balanced_accuracy: 0.73346 | train_accuracy: 0.73362 | valid_auc: 0.7629  | valid_balanced_accuracy: 0.69629 | valid_accuracy: 0.69641 |  0:20:17s
epoch 70 | loss: 0.53772 | train_auc: 0.80738 | train_balanced_accuracy: 0.72985 | train_accuracy: 0.73012 | valid_auc: 0.76223 | valid_balanced_accuracy: 0.69255 | valid_accuracy: 0.69279 |  0:20:35s
epoch 71 | loss: 0.54274 | train_auc: 0.80437 | train_balanced_accuracy: 0.72488 | train_accuracy: 0.725   | valid_auc: 0.75442 | valid_balanced_accuracy: 0.68956 | valid_accuracy: 0.68964 |  0:20:51s
epoch 72 | loss: 0.53613 | train_auc: 0.80618 | train_balanced_accuracy: 0.72665 | train_accuracy: 0.72693 | valid_auc: 0.76156 | valid_balanced_accuracy: 0.69319 | valid_accuracy: 0.69342 |  0:21:08s
epoch 73 | loss: 0.5349  | train_auc: 0.80788 | train_balanced_accuracy: 0.72935 | train_accuracy: 0.72953 | valid_auc: 0.7627  | valid_balanced_accuracy: 0.69311 | valid_accuracy: 0.69326 |  0:21:25s
epoch 74 | loss: 0.53771 | train_auc: 0.81299 | train_balanced_accuracy: 0.73093 | train_accuracy: 0.73138 | valid_auc: 0.76182 | valid_balanced_accuracy: 0.68984 | valid_accuracy: 0.69027 |  0:21:41s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69673
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 62/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.687 total time=21.8min
[CV 3/5; 62/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71098 | train_auc: 0.58993 | train_balanced_accuracy: 0.5     | train_accuracy: 0.49642 | valid_auc: 0.59973 | valid_balanced_accuracy: 0.5     | valid_accuracy: 0.49638 |  0:00:18s
epoch 1  | loss: 0.64651 | train_auc: 0.63835 | train_balanced_accuracy: 0.51527 | train_accuracy: 0.51188 | valid_auc: 0.63926 | valid_balanced_accuracy: 0.51648 | valid_accuracy: 0.51306 |  0:00:37s
epoch 2  | loss: 0.62747 | train_auc: 0.65193 | train_balanced_accuracy: 0.58635 | train_accuracy: 0.58412 | valid_auc: 0.6504  | valid_balanced_accuracy: 0.58564 | valid_accuracy: 0.58341 |  0:00:54s
epoch 3  | loss: 0.621   | train_auc: 0.66653 | train_balanced_accuracy: 0.56561 | train_accuracy: 0.56291 | valid_auc: 0.66686 | valid_balanced_accuracy: 0.55971 | valid_accuracy: 0.55697 |  0:01:12s
epoch 4  | loss: 0.61275 | train_auc: 0.67109 | train_balanced_accuracy: 0.5741  | train_accuracy: 0.57161 | valid_auc: 0.66699 | valid_balanced_accuracy: 0.56924 | valid_accuracy: 0.56673 |  0:01:29s
epoch 5  | loss: 0.60998 | train_auc: 0.67077 | train_balanced_accuracy: 0.59582 | train_accuracy: 0.5938  | valid_auc: 0.6613  | valid_balanced_accuracy: 0.59203 | valid_accuracy: 0.59002 |  0:01:47s
epoch 6  | loss: 0.60688 | train_auc: 0.69056 | train_balanced_accuracy: 0.61466 | train_accuracy: 0.61304 | valid_auc: 0.68455 | valid_balanced_accuracy: 0.61114 | valid_accuracy: 0.60954 |  0:02:05s
epoch 7  | loss: 0.60868 | train_auc: 0.69302 | train_balanced_accuracy: 0.61835 | train_accuracy: 0.61686 | valid_auc: 0.68741 | valid_balanced_accuracy: 0.61593 | valid_accuracy: 0.61442 |  0:02:21s
epoch 8  | loss: 0.59802 | train_auc: 0.70396 | train_balanced_accuracy: 0.63983 | train_accuracy: 0.63893 | valid_auc: 0.69922 | valid_balanced_accuracy: 0.63626 | valid_accuracy: 0.63535 |  0:02:39s
epoch 9  | loss: 0.59662 | train_auc: 0.70779 | train_balanced_accuracy: 0.6429  | train_accuracy: 0.64196 | valid_auc: 0.7015  | valid_balanced_accuracy: 0.63441 | valid_accuracy: 0.63346 |  0:02:56s
epoch 10 | loss: 0.58732 | train_auc: 0.71698 | train_balanced_accuracy: 0.64475 | train_accuracy: 0.64377 | valid_auc: 0.7091  | valid_balanced_accuracy: 0.639   | valid_accuracy: 0.63802 |  0:03:13s
epoch 11 | loss: 0.59128 | train_auc: 0.72465 | train_balanced_accuracy: 0.65619 | train_accuracy: 0.65561 | valid_auc: 0.71859 | valid_balanced_accuracy: 0.64598 | valid_accuracy: 0.64542 |  0:03:30s
epoch 12 | loss: 0.59102 | train_auc: 0.72987 | train_balanced_accuracy: 0.66558 | train_accuracy: 0.66549 | valid_auc: 0.7243  | valid_balanced_accuracy: 0.66627 | valid_accuracy: 0.66619 |  0:03:47s
epoch 13 | loss: 0.58692 | train_auc: 0.73297 | train_balanced_accuracy: 0.66697 | train_accuracy: 0.66671 | valid_auc: 0.72781 | valid_balanced_accuracy: 0.66063 | valid_accuracy: 0.66037 |  0:04:03s
epoch 14 | loss: 0.58478 | train_auc: 0.73911 | train_balanced_accuracy: 0.67544 | train_accuracy: 0.67548 | valid_auc: 0.73468 | valid_balanced_accuracy: 0.67481 | valid_accuracy: 0.67485 |  0:04:20s
epoch 15 | loss: 0.58642 | train_auc: 0.74347 | train_balanced_accuracy: 0.67701 | train_accuracy: 0.67698 | valid_auc: 0.73735 | valid_balanced_accuracy: 0.67349 | valid_accuracy: 0.67343 |  0:04:36s
epoch 16 | loss: 0.57944 | train_auc: 0.74547 | train_balanced_accuracy: 0.67659 | train_accuracy: 0.67635 | valid_auc: 0.7408  | valid_balanced_accuracy: 0.677   | valid_accuracy: 0.67674 |  0:04:52s
epoch 17 | loss: 0.5769  | train_auc: 0.74558 | train_balanced_accuracy: 0.67976 | train_accuracy: 0.67993 | valid_auc: 0.73851 | valid_balanced_accuracy: 0.67441 | valid_accuracy: 0.67454 |  0:05:12s
epoch 18 | loss: 0.58381 | train_auc: 0.75346 | train_balanced_accuracy: 0.6855  | train_accuracy: 0.68606 | valid_auc: 0.7449  | valid_balanced_accuracy: 0.68642 | valid_accuracy: 0.68697 |  0:05:29s
epoch 19 | loss: 0.57961 | train_auc: 0.75429 | train_balanced_accuracy: 0.68471 | train_accuracy: 0.68508 | valid_auc: 0.74417 | valid_balanced_accuracy: 0.68033 | valid_accuracy: 0.68067 |  0:05:44s
epoch 20 | loss: 0.58097 | train_auc: 0.75752 | train_balanced_accuracy: 0.68846 | train_accuracy: 0.68878 | valid_auc: 0.74667 | valid_balanced_accuracy: 0.68605 | valid_accuracy: 0.68634 |  0:06:00s
epoch 21 | loss: 0.57412 | train_auc: 0.76265 | train_balanced_accuracy: 0.69343 | train_accuracy: 0.69381 | valid_auc: 0.74994 | valid_balanced_accuracy: 0.68567 | valid_accuracy: 0.68602 |  0:06:17s
epoch 22 | loss: 0.58107 | train_auc: 0.76446 | train_balanced_accuracy: 0.69623 | train_accuracy: 0.69681 | valid_auc: 0.75224 | valid_balanced_accuracy: 0.68596 | valid_accuracy: 0.6865  |  0:06:34s
epoch 23 | loss: 0.57866 | train_auc: 0.76615 | train_balanced_accuracy: 0.69913 | train_accuracy: 0.69944 | valid_auc: 0.75451 | valid_balanced_accuracy: 0.68956 | valid_accuracy: 0.6898  |  0:06:53s
epoch 24 | loss: 0.57942 | train_auc: 0.76398 | train_balanced_accuracy: 0.69399 | train_accuracy: 0.69433 | valid_auc: 0.74878 | valid_balanced_accuracy: 0.68744 | valid_accuracy: 0.68776 |  0:07:09s
epoch 25 | loss: 0.57317 | train_auc: 0.76556 | train_balanced_accuracy: 0.69446 | train_accuracy: 0.69456 | valid_auc: 0.75074 | valid_balanced_accuracy: 0.68374 | valid_accuracy: 0.68382 |  0:07:24s
epoch 26 | loss: 0.5737  | train_auc: 0.75783 | train_balanced_accuracy: 0.6889  | train_accuracy: 0.68937 | valid_auc: 0.74503 | valid_balanced_accuracy: 0.68037 | valid_accuracy: 0.68083 |  0:07:42s
epoch 27 | loss: 0.57197 | train_auc: 0.76294 | train_balanced_accuracy: 0.69846 | train_accuracy: 0.69877 | valid_auc: 0.74812 | valid_balanced_accuracy: 0.68432 | valid_accuracy: 0.68461 |  0:07:57s
epoch 28 | loss: 0.56817 | train_auc: 0.76818 | train_balanced_accuracy: 0.70111 | train_accuracy: 0.70137 | valid_auc: 0.75007 | valid_balanced_accuracy: 0.68294 | valid_accuracy: 0.68319 |  0:08:13s
epoch 29 | loss: 0.56809 | train_auc: 0.77428 | train_balanced_accuracy: 0.70378 | train_accuracy: 0.70404 | valid_auc: 0.75523 | valid_balanced_accuracy: 0.69288 | valid_accuracy: 0.69311 |  0:08:29s
epoch 30 | loss: 0.56786 | train_auc: 0.77881 | train_balanced_accuracy: 0.70835 | train_accuracy: 0.70857 | valid_auc: 0.7546  | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.6876  |  0:08:46s
epoch 31 | loss: 0.57039 | train_auc: 0.77716 | train_balanced_accuracy: 0.70307 | train_accuracy: 0.70357 | valid_auc: 0.75519 | valid_balanced_accuracy: 0.69268 | valid_accuracy: 0.69311 |  0:09:02s
epoch 32 | loss: 0.5636  | train_auc: 0.77873 | train_balanced_accuracy: 0.70784 | train_accuracy: 0.70786 | valid_auc: 0.75333 | valid_balanced_accuracy: 0.68748 | valid_accuracy: 0.68744 |  0:09:21s
epoch 33 | loss: 0.56607 | train_auc: 0.77931 | train_balanced_accuracy: 0.70578 | train_accuracy: 0.70617 | valid_auc: 0.75344 | valid_balanced_accuracy: 0.68899 | valid_accuracy: 0.68933 |  0:09:37s
epoch 34 | loss: 0.56563 | train_auc: 0.78398 | train_balanced_accuracy: 0.70889 | train_accuracy: 0.70908 | valid_auc: 0.75611 | valid_balanced_accuracy: 0.68884 | valid_accuracy: 0.68901 |  0:09:55s
epoch 35 | loss: 0.56361 | train_auc: 0.78555 | train_balanced_accuracy: 0.71246 | train_accuracy: 0.7129  | valid_auc: 0.75722 | valid_balanced_accuracy: 0.69572 | valid_accuracy: 0.6961  |  0:10:13s
epoch 36 | loss: 0.56131 | train_auc: 0.79029 | train_balanced_accuracy: 0.71541 | train_accuracy: 0.71545 | valid_auc: 0.76278 | valid_balanced_accuracy: 0.69721 | valid_accuracy: 0.6972  |  0:10:29s
epoch 37 | loss: 0.56403 | train_auc: 0.78859 | train_balanced_accuracy: 0.71502 | train_accuracy: 0.71534 | valid_auc: 0.75784 | valid_balanced_accuracy: 0.69274 | valid_accuracy: 0.69295 |  0:10:44s
epoch 38 | loss: 0.56049 | train_auc: 0.7907  | train_balanced_accuracy: 0.71412 | train_accuracy: 0.71396 | valid_auc: 0.75823 | valid_balanced_accuracy: 0.68704 | valid_accuracy: 0.68681 |  0:11:02s
epoch 39 | loss: 0.55754 | train_auc: 0.78792 | train_balanced_accuracy: 0.7116  | train_accuracy: 0.71195 | valid_auc: 0.758   | valid_balanced_accuracy: 0.69029 | valid_accuracy: 0.69059 |  0:11:20s
epoch 40 | loss: 0.5608  | train_auc: 0.79001 | train_balanced_accuracy: 0.71458 | train_accuracy: 0.71483 | valid_auc: 0.75864 | valid_balanced_accuracy: 0.69527 | valid_accuracy: 0.69547 |  0:11:35s
epoch 41 | loss: 0.56069 | train_auc: 0.79321 | train_balanced_accuracy: 0.71711 | train_accuracy: 0.7173  | valid_auc: 0.7585  | valid_balanced_accuracy: 0.69158 | valid_accuracy: 0.69169 |  0:11:52s
epoch 42 | loss: 0.55117 | train_auc: 0.78961 | train_balanced_accuracy: 0.71609 | train_accuracy: 0.7162  | valid_auc: 0.75432 | valid_balanced_accuracy: 0.68737 | valid_accuracy: 0.68744 |  0:12:11s
epoch 43 | loss: 0.56091 | train_auc: 0.79224 | train_balanced_accuracy: 0.71584 | train_accuracy: 0.71589 | valid_auc: 0.75529 | valid_balanced_accuracy: 0.68885 | valid_accuracy: 0.68886 |  0:12:29s
epoch 44 | loss: 0.56099 | train_auc: 0.79466 | train_balanced_accuracy: 0.71995 | train_accuracy: 0.71994 | valid_auc: 0.75551 | valid_balanced_accuracy: 0.68546 | valid_accuracy: 0.6854  |  0:12:46s
epoch 45 | loss: 0.55707 | train_auc: 0.79709 | train_balanced_accuracy: 0.7204  | train_accuracy: 0.72065 | valid_auc: 0.76076 | valid_balanced_accuracy: 0.69369 | valid_accuracy: 0.69389 |  0:13:02s
epoch 46 | loss: 0.55781 | train_auc: 0.7958  | train_balanced_accuracy: 0.71871 | train_accuracy: 0.71856 | valid_auc: 0.75677 | valid_balanced_accuracy: 0.68829 | valid_accuracy: 0.68807 |  0:13:19s
epoch 47 | loss: 0.55675 | train_auc: 0.79209 | train_balanced_accuracy: 0.71825 | train_accuracy: 0.71845 | valid_auc: 0.75554 | valid_balanced_accuracy: 0.68808 | valid_accuracy: 0.68823 |  0:13:37s
epoch 48 | loss: 0.55788 | train_auc: 0.79759 | train_balanced_accuracy: 0.72164 | train_accuracy: 0.72144 | valid_auc: 0.75668 | valid_balanced_accuracy: 0.68565 | valid_accuracy: 0.6854  |  0:13:53s
epoch 49 | loss: 0.55134 | train_auc: 0.79631 | train_balanced_accuracy: 0.72074 | train_accuracy: 0.72096 | valid_auc: 0.75733 | valid_balanced_accuracy: 0.69275 | valid_accuracy: 0.69295 |  0:14:10s
epoch 50 | loss: 0.55383 | train_auc: 0.79406 | train_balanced_accuracy: 0.71843 | train_accuracy: 0.71852 | valid_auc: 0.75542 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68839 |  0:14:27s
epoch 51 | loss: 0.5495  | train_auc: 0.80132 | train_balanced_accuracy: 0.72396 | train_accuracy: 0.72423 | valid_auc: 0.76127 | valid_balanced_accuracy: 0.69964 | valid_accuracy: 0.69987 |  0:14:44s
epoch 52 | loss: 0.54533 | train_auc: 0.80208 | train_balanced_accuracy: 0.72598 | train_accuracy: 0.72604 | valid_auc: 0.75616 | valid_balanced_accuracy: 0.68825 | valid_accuracy: 0.68823 |  0:15:02s
epoch 53 | loss: 0.54602 | train_auc: 0.80293 | train_balanced_accuracy: 0.72644 | train_accuracy: 0.72647 | valid_auc: 0.76062 | valid_balanced_accuracy: 0.69206 | valid_accuracy: 0.69201 |  0:15:18s
epoch 54 | loss: 0.55257 | train_auc: 0.80376 | train_balanced_accuracy: 0.72425 | train_accuracy: 0.72435 | valid_auc: 0.76185 | valid_balanced_accuracy: 0.69951 | valid_accuracy: 0.69956 |  0:15:35s
epoch 55 | loss: 0.54775 | train_auc: 0.80296 | train_balanced_accuracy: 0.72576 | train_accuracy: 0.72565 | valid_auc: 0.7597  | valid_balanced_accuracy: 0.68759 | valid_accuracy: 0.68744 |  0:15:55s
epoch 56 | loss: 0.54546 | train_auc: 0.80105 | train_balanced_accuracy: 0.72466 | train_accuracy: 0.7245  | valid_auc: 0.76099 | valid_balanced_accuracy: 0.68952 | valid_accuracy: 0.68933 |  0:16:12s
epoch 57 | loss: 0.54697 | train_auc: 0.80118 | train_balanced_accuracy: 0.72327 | train_accuracy: 0.72305 | valid_auc: 0.75686 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68823 |  0:16:29s
epoch 58 | loss: 0.54702 | train_auc: 0.80339 | train_balanced_accuracy: 0.72711 | train_accuracy: 0.7271  | valid_auc: 0.75871 | valid_balanced_accuracy: 0.69187 | valid_accuracy: 0.69185 |  0:16:47s
epoch 59 | loss: 0.54217 | train_auc: 0.80178 | train_balanced_accuracy: 0.72277 | train_accuracy: 0.72269 | valid_auc: 0.75813 | valid_balanced_accuracy: 0.68834 | valid_accuracy: 0.68823 |  0:17:04s
epoch 60 | loss: 0.54835 | train_auc: 0.80622 | train_balanced_accuracy: 0.72398 | train_accuracy: 0.72376 | valid_auc: 0.75807 | valid_balanced_accuracy: 0.69164 | valid_accuracy: 0.69138 |  0:17:23s
epoch 61 | loss: 0.54628 | train_auc: 0.8079  | train_balanced_accuracy: 0.72848 | train_accuracy: 0.72871 | valid_auc: 0.76076 | valid_balanced_accuracy: 0.69041 | valid_accuracy: 0.69059 |  0:17:40s
epoch 62 | loss: 0.54192 | train_auc: 0.81209 | train_balanced_accuracy: 0.73333 | train_accuracy: 0.73324 | valid_auc: 0.76408 | valid_balanced_accuracy: 0.69246 | valid_accuracy: 0.69232 |  0:17:59s
epoch 63 | loss: 0.5418  | train_auc: 0.79989 | train_balanced_accuracy: 0.72495 | train_accuracy: 0.72509 | valid_auc: 0.75359 | valid_balanced_accuracy: 0.68891 | valid_accuracy: 0.68901 |  0:18:16s
epoch 64 | loss: 0.53998 | train_auc: 0.8075  | train_balanced_accuracy: 0.72783 | train_accuracy: 0.72789 | valid_auc: 0.75978 | valid_balanced_accuracy: 0.68835 | valid_accuracy: 0.68839 |  0:18:34s
epoch 65 | loss: 0.53677 | train_auc: 0.81146 | train_balanced_accuracy: 0.73258 | train_accuracy: 0.73265 | valid_auc: 0.7563  | valid_balanced_accuracy: 0.69025 | valid_accuracy: 0.69027 |  0:18:51s
epoch 66 | loss: 0.54547 | train_auc: 0.8125  | train_balanced_accuracy: 0.73215 | train_accuracy: 0.73222 | valid_auc: 0.75966 | valid_balanced_accuracy: 0.68962 | valid_accuracy: 0.68964 |  0:19:09s
epoch 67 | loss: 0.53556 | train_auc: 0.80711 | train_balanced_accuracy: 0.72842 | train_accuracy: 0.72856 | valid_auc: 0.75808 | valid_balanced_accuracy: 0.69085 | valid_accuracy: 0.6909  |  0:19:26s
epoch 68 | loss: 0.54248 | train_auc: 0.81406 | train_balanced_accuracy: 0.73472 | train_accuracy: 0.73477 | valid_auc: 0.76205 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69515 |  0:19:44s
epoch 69 | loss: 0.53912 | train_auc: 0.81448 | train_balanced_accuracy: 0.73454 | train_accuracy: 0.73442 | valid_auc: 0.76044 | valid_balanced_accuracy: 0.69203 | valid_accuracy: 0.69185 |  0:20:01s
epoch 70 | loss: 0.53332 | train_auc: 0.8166  | train_balanced_accuracy: 0.7369  | train_accuracy: 0.73682 | valid_auc: 0.76205 | valid_balanced_accuracy: 0.69215 | valid_accuracy: 0.69201 |  0:20:19s
epoch 71 | loss: 0.54172 | train_auc: 0.81387 | train_balanced_accuracy: 0.73415 | train_accuracy: 0.73426 | valid_auc: 0.76058 | valid_balanced_accuracy: 0.69101 | valid_accuracy: 0.69106 |  0:20:35s

Early stopping occurred at epoch 71 with best_epoch = 51 and best_valid_accuracy = 0.69987
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 62/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.699 total time=20.7min
[CV 4/5; 62/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71729 | train_auc: 0.5996  | train_balanced_accuracy: 0.51901 | train_accuracy: 0.51582 | valid_auc: 0.59703 | valid_balanced_accuracy: 0.51534 | valid_accuracy: 0.51212 |  0:00:16s
epoch 1  | loss: 0.6496  | train_auc: 0.68115 | train_balanced_accuracy: 0.6287  | train_accuracy: 0.62831 | valid_auc: 0.67525 | valid_balanced_accuracy: 0.62535 | valid_accuracy: 0.62496 |  0:00:33s
epoch 2  | loss: 0.62626 | train_auc: 0.69398 | train_balanced_accuracy: 0.63274 | train_accuracy: 0.63421 | valid_auc: 0.68837 | valid_balanced_accuracy: 0.6305  | valid_accuracy: 0.63204 |  0:00:51s
epoch 3  | loss: 0.6202  | train_auc: 0.70709 | train_balanced_accuracy: 0.64065 | train_accuracy: 0.64172 | valid_auc: 0.70382 | valid_balanced_accuracy: 0.64319 | valid_accuracy: 0.64432 |  0:01:08s
epoch 4  | loss: 0.61036 | train_auc: 0.70625 | train_balanced_accuracy: 0.63674 | train_accuracy: 0.63791 | valid_auc: 0.70361 | valid_balanced_accuracy: 0.63616 | valid_accuracy: 0.63739 |  0:01:24s
epoch 5  | loss: 0.6086  | train_auc: 0.71108 | train_balanced_accuracy: 0.6483  | train_accuracy: 0.64932 | valid_auc: 0.71255 | valid_balanced_accuracy: 0.64987 | valid_accuracy: 0.65093 |  0:01:42s
epoch 6  | loss: 0.60509 | train_auc: 0.70862 | train_balanced_accuracy: 0.65706 | train_accuracy: 0.65781 | valid_auc: 0.70985 | valid_balanced_accuracy: 0.65752 | valid_accuracy: 0.65833 |  0:01:59s
epoch 7  | loss: 0.60088 | train_auc: 0.70996 | train_balanced_accuracy: 0.64734 | train_accuracy: 0.64798 | valid_auc: 0.71163 | valid_balanced_accuracy: 0.64883 | valid_accuracy: 0.64951 |  0:02:15s
epoch 8  | loss: 0.59941 | train_auc: 0.71393 | train_balanced_accuracy: 0.65688 | train_accuracy: 0.65703 | valid_auc: 0.7136  | valid_balanced_accuracy: 0.6575  | valid_accuracy: 0.6577  |  0:02:32s
epoch 9  | loss: 0.59519 | train_auc: 0.72008 | train_balanced_accuracy: 0.659   | train_accuracy: 0.65907 | valid_auc: 0.72003 | valid_balanced_accuracy: 0.66246 | valid_accuracy: 0.66257 |  0:02:48s
epoch 10 | loss: 0.58828 | train_auc: 0.71905 | train_balanced_accuracy: 0.65957 | train_accuracy: 0.6597  | valid_auc: 0.7151  | valid_balanced_accuracy: 0.6567  | valid_accuracy: 0.65691 |  0:03:05s
epoch 11 | loss: 0.58979 | train_auc: 0.72371 | train_balanced_accuracy: 0.66033 | train_accuracy: 0.66057 | valid_auc: 0.71743 | valid_balanced_accuracy: 0.65788 | valid_accuracy: 0.65817 |  0:03:21s
epoch 12 | loss: 0.58628 | train_auc: 0.72765 | train_balanced_accuracy: 0.66339 | train_accuracy: 0.66395 | valid_auc: 0.71987 | valid_balanced_accuracy: 0.65237 | valid_accuracy: 0.65297 |  0:03:36s
epoch 13 | loss: 0.58431 | train_auc: 0.73118 | train_balanced_accuracy: 0.66381 | train_accuracy: 0.66387 | valid_auc: 0.72491 | valid_balanced_accuracy: 0.6617  | valid_accuracy: 0.66179 |  0:03:53s
epoch 14 | loss: 0.58611 | train_auc: 0.73463 | train_balanced_accuracy: 0.67094 | train_accuracy: 0.67123 | valid_auc: 0.72842 | valid_balanced_accuracy: 0.66318 | valid_accuracy: 0.66352 |  0:04:11s
epoch 15 | loss: 0.58691 | train_auc: 0.73858 | train_balanced_accuracy: 0.67012 | train_accuracy: 0.67033 | valid_auc: 0.7278  | valid_balanced_accuracy: 0.6623  | valid_accuracy: 0.66257 |  0:04:29s
epoch 16 | loss: 0.57956 | train_auc: 0.73874 | train_balanced_accuracy: 0.67043 | train_accuracy: 0.67056 | valid_auc: 0.72965 | valid_balanced_accuracy: 0.65815 | valid_accuracy: 0.65833 |  0:04:46s
epoch 17 | loss: 0.57809 | train_auc: 0.74812 | train_balanced_accuracy: 0.67895 | train_accuracy: 0.67938 | valid_auc: 0.73746 | valid_balanced_accuracy: 0.67015 | valid_accuracy: 0.6706  |  0:05:03s
epoch 18 | loss: 0.58302 | train_auc: 0.75028 | train_balanced_accuracy: 0.68126 | train_accuracy: 0.68166 | valid_auc: 0.73135 | valid_balanced_accuracy: 0.66656 | valid_accuracy: 0.66698 |  0:05:22s
epoch 19 | loss: 0.57288 | train_auc: 0.74575 | train_balanced_accuracy: 0.68135 | train_accuracy: 0.68166 | valid_auc: 0.7343  | valid_balanced_accuracy: 0.67323 | valid_accuracy: 0.67359 |  0:05:39s
epoch 20 | loss: 0.57392 | train_auc: 0.75254 | train_balanced_accuracy: 0.68422 | train_accuracy: 0.68461 | valid_auc: 0.73726 | valid_balanced_accuracy: 0.66862 | valid_accuracy: 0.66903 |  0:05:56s
epoch 21 | loss: 0.57445 | train_auc: 0.76022 | train_balanced_accuracy: 0.68895 | train_accuracy: 0.6896  | valid_auc: 0.74419 | valid_balanced_accuracy: 0.675   | valid_accuracy: 0.67564 |  0:06:13s
epoch 22 | loss: 0.57271 | train_auc: 0.76187 | train_balanced_accuracy: 0.68668 | train_accuracy: 0.68713 | valid_auc: 0.74185 | valid_balanced_accuracy: 0.66904 | valid_accuracy: 0.6695  |  0:06:30s
epoch 23 | loss: 0.57235 | train_auc: 0.76946 | train_balanced_accuracy: 0.69423 | train_accuracy: 0.6946  | valid_auc: 0.75148 | valid_balanced_accuracy: 0.67856 | valid_accuracy: 0.67894 |  0:06:46s
epoch 24 | loss: 0.57243 | train_auc: 0.76342 | train_balanced_accuracy: 0.69188 | train_accuracy: 0.69256 | valid_auc: 0.74363 | valid_balanced_accuracy: 0.67478 | valid_accuracy: 0.67548 |  0:07:02s
epoch 25 | loss: 0.5668  | train_auc: 0.75481 | train_balanced_accuracy: 0.68755 | train_accuracy: 0.68772 | valid_auc: 0.74284 | valid_balanced_accuracy: 0.67497 | valid_accuracy: 0.67517 |  0:07:18s
epoch 26 | loss: 0.56903 | train_auc: 0.76623 | train_balanced_accuracy: 0.6936  | train_accuracy: 0.69429 | valid_auc: 0.74917 | valid_balanced_accuracy: 0.68088 | valid_accuracy: 0.68162 |  0:07:36s
epoch 27 | loss: 0.56742 | train_auc: 0.77287 | train_balanced_accuracy: 0.69791 | train_accuracy: 0.69842 | valid_auc: 0.75299 | valid_balanced_accuracy: 0.68345 | valid_accuracy: 0.68398 |  0:07:51s
epoch 28 | loss: 0.56454 | train_auc: 0.7758  | train_balanced_accuracy: 0.70284 | train_accuracy: 0.70318 | valid_auc: 0.75523 | valid_balanced_accuracy: 0.68398 | valid_accuracy: 0.68429 |  0:08:07s
epoch 29 | loss: 0.56229 | train_auc: 0.77945 | train_balanced_accuracy: 0.70803 | train_accuracy: 0.70822 | valid_auc: 0.75455 | valid_balanced_accuracy: 0.68806 | valid_accuracy: 0.68823 |  0:08:26s
epoch 30 | loss: 0.55856 | train_auc: 0.78282 | train_balanced_accuracy: 0.70382 | train_accuracy: 0.7042  | valid_auc: 0.75907 | valid_balanced_accuracy: 0.69066 | valid_accuracy: 0.69106 |  0:08:43s
epoch 31 | loss: 0.56144 | train_auc: 0.78663 | train_balanced_accuracy: 0.70783 | train_accuracy: 0.70833 | valid_auc: 0.75322 | valid_balanced_accuracy: 0.68328 | valid_accuracy: 0.68382 |  0:09:00s
epoch 32 | loss: 0.55543 | train_auc: 0.78804 | train_balanced_accuracy: 0.70887 | train_accuracy: 0.70865 | valid_auc: 0.76092 | valid_balanced_accuracy: 0.68701 | valid_accuracy: 0.68681 |  0:09:18s
epoch 33 | loss: 0.55936 | train_auc: 0.7855  | train_balanced_accuracy: 0.70625 | train_accuracy: 0.70668 | valid_auc: 0.76025 | valid_balanced_accuracy: 0.69016 | valid_accuracy: 0.69059 |  0:09:37s
epoch 34 | loss: 0.5567  | train_auc: 0.79167 | train_balanced_accuracy: 0.71518 | train_accuracy: 0.71545 | valid_auc: 0.76305 | valid_balanced_accuracy: 0.69235 | valid_accuracy: 0.69263 |  0:09:54s
epoch 35 | loss: 0.55088 | train_auc: 0.79099 | train_balanced_accuracy: 0.71156 | train_accuracy: 0.71172 | valid_auc: 0.75833 | valid_balanced_accuracy: 0.68492 | valid_accuracy: 0.68508 |  0:10:11s
epoch 36 | loss: 0.55211 | train_auc: 0.79273 | train_balanced_accuracy: 0.71688 | train_accuracy: 0.71691 | valid_auc: 0.76213 | valid_balanced_accuracy: 0.69215 | valid_accuracy: 0.69216 |  0:10:25s
epoch 37 | loss: 0.55106 | train_auc: 0.79245 | train_balanced_accuracy: 0.7074  | train_accuracy: 0.7081  | valid_auc: 0.75827 | valid_balanced_accuracy: 0.68232 | valid_accuracy: 0.68303 |  0:10:44s
epoch 38 | loss: 0.55464 | train_auc: 0.78399 | train_balanced_accuracy: 0.70622 | train_accuracy: 0.70633 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.68874 | valid_accuracy: 0.68886 |  0:11:02s
epoch 39 | loss: 0.55154 | train_auc: 0.79413 | train_balanced_accuracy: 0.71625 | train_accuracy: 0.71624 | valid_auc: 0.75875 | valid_balanced_accuracy: 0.68707 | valid_accuracy: 0.68713 |  0:11:20s
epoch 40 | loss: 0.55196 | train_auc: 0.7943  | train_balanced_accuracy: 0.71359 | train_accuracy: 0.71361 | valid_auc: 0.76113 | valid_balanced_accuracy: 0.6851  | valid_accuracy: 0.68508 |  0:11:37s
epoch 41 | loss: 0.55444 | train_auc: 0.79704 | train_balanced_accuracy: 0.71735 | train_accuracy: 0.71758 | valid_auc: 0.76221 | valid_balanced_accuracy: 0.69066 | valid_accuracy: 0.6909  |  0:11:55s
epoch 42 | loss: 0.54608 | train_auc: 0.79575 | train_balanced_accuracy: 0.71867 | train_accuracy: 0.71888 | valid_auc: 0.76392 | valid_balanced_accuracy: 0.6923  | valid_accuracy: 0.69248 |  0:12:12s
epoch 43 | loss: 0.55164 | train_auc: 0.79753 | train_balanced_accuracy: 0.71845 | train_accuracy: 0.71833 | valid_auc: 0.7646  | valid_balanced_accuracy: 0.69308 | valid_accuracy: 0.69295 |  0:12:29s
epoch 44 | loss: 0.55097 | train_auc: 0.79153 | train_balanced_accuracy: 0.71373 | train_accuracy: 0.71384 | valid_auc: 0.76399 | valid_balanced_accuracy: 0.69266 | valid_accuracy: 0.69279 |  0:12:45s
epoch 45 | loss: 0.54625 | train_auc: 0.79598 | train_balanced_accuracy: 0.71591 | train_accuracy: 0.71589 | valid_auc: 0.76416 | valid_balanced_accuracy: 0.6892  | valid_accuracy: 0.68917 |  0:13:02s
epoch 46 | loss: 0.54977 | train_auc: 0.7803  | train_balanced_accuracy: 0.70563 | train_accuracy: 0.70542 | valid_auc: 0.75554 | valid_balanced_accuracy: 0.68168 | valid_accuracy: 0.68146 |  0:13:18s
epoch 47 | loss: 0.54169 | train_auc: 0.79209 | train_balanced_accuracy: 0.71503 | train_accuracy: 0.71518 | valid_auc: 0.76292 | valid_balanced_accuracy: 0.69473 | valid_accuracy: 0.69484 |  0:13:36s
epoch 48 | loss: 0.54363 | train_auc: 0.78538 | train_balanced_accuracy: 0.70845 | train_accuracy: 0.70825 | valid_auc: 0.7592  | valid_balanced_accuracy: 0.68513 | valid_accuracy: 0.68492 |  0:13:56s
epoch 49 | loss: 0.54382 | train_auc: 0.80349 | train_balanced_accuracy: 0.72116 | train_accuracy: 0.7214  | valid_auc: 0.76218 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68917 |  0:14:14s
epoch 50 | loss: 0.54845 | train_auc: 0.80005 | train_balanced_accuracy: 0.72001 | train_accuracy: 0.72002 | valid_auc: 0.76503 | valid_balanced_accuracy: 0.692   | valid_accuracy: 0.69201 |  0:14:32s
epoch 51 | loss: 0.54598 | train_auc: 0.80278 | train_balanced_accuracy: 0.72384 | train_accuracy: 0.72395 | valid_auc: 0.76384 | valid_balanced_accuracy: 0.69364 | valid_accuracy: 0.69374 |  0:14:49s
epoch 52 | loss: 0.54045 | train_auc: 0.79421 | train_balanced_accuracy: 0.71378 | train_accuracy: 0.71345 | valid_auc: 0.76105 | valid_balanced_accuracy: 0.68575 | valid_accuracy: 0.6854  |  0:15:05s
epoch 53 | loss: 0.54043 | train_auc: 0.80492 | train_balanced_accuracy: 0.72196 | train_accuracy: 0.72222 | valid_auc: 0.76447 | valid_balanced_accuracy: 0.69458 | valid_accuracy: 0.69484 |  0:15:24s
epoch 54 | loss: 0.54088 | train_auc: 0.81292 | train_balanced_accuracy: 0.72995 | train_accuracy: 0.72993 | valid_auc: 0.76849 | valid_balanced_accuracy: 0.69578 | valid_accuracy: 0.69578 |  0:15:40s
epoch 55 | loss: 0.53664 | train_auc: 0.81185 | train_balanced_accuracy: 0.72741 | train_accuracy: 0.72726 | valid_auc: 0.76361 | valid_balanced_accuracy: 0.6926  | valid_accuracy: 0.69248 |  0:15:58s
epoch 56 | loss: 0.53937 | train_auc: 0.80815 | train_balanced_accuracy: 0.72796 | train_accuracy: 0.72801 | valid_auc: 0.7652  | valid_balanced_accuracy: 0.69335 | valid_accuracy: 0.69342 |  0:16:15s
epoch 57 | loss: 0.54385 | train_auc: 0.80487 | train_balanced_accuracy: 0.72469 | train_accuracy: 0.72446 | valid_auc: 0.76273 | valid_balanced_accuracy: 0.68936 | valid_accuracy: 0.68917 |  0:16:32s
epoch 58 | loss: 0.54315 | train_auc: 0.80862 | train_balanced_accuracy: 0.72555 | train_accuracy: 0.72572 | valid_auc: 0.76466 | valid_balanced_accuracy: 0.69244 | valid_accuracy: 0.69263 |  0:16:51s
epoch 59 | loss: 0.53603 | train_auc: 0.78239 | train_balanced_accuracy: 0.70849 | train_accuracy: 0.70881 | valid_auc: 0.75407 | valid_balanced_accuracy: 0.6863  | valid_accuracy: 0.68665 |  0:17:10s
epoch 60 | loss: 0.53906 | train_auc: 0.79934 | train_balanced_accuracy: 0.71932 | train_accuracy: 0.71966 | valid_auc: 0.76377 | valid_balanced_accuracy: 0.69036 | valid_accuracy: 0.69075 |  0:17:26s
epoch 61 | loss: 0.53389 | train_auc: 0.80953 | train_balanced_accuracy: 0.72578 | train_accuracy: 0.72612 | valid_auc: 0.76403 | valid_balanced_accuracy: 0.69019 | valid_accuracy: 0.69059 |  0:17:42s
epoch 62 | loss: 0.53422 | train_auc: 0.81092 | train_balanced_accuracy: 0.72776 | train_accuracy: 0.72773 | valid_auc: 0.76897 | valid_balanced_accuracy: 0.68966 | valid_accuracy: 0.68964 |  0:18:01s
epoch 63 | loss: 0.53247 | train_auc: 0.77814 | train_balanced_accuracy: 0.70311 | train_accuracy: 0.70302 | valid_auc: 0.75068 | valid_balanced_accuracy: 0.6768  | valid_accuracy: 0.67674 |  0:18:19s
epoch 64 | loss: 0.5297  | train_auc: 0.8086  | train_balanced_accuracy: 0.72853 | train_accuracy: 0.72848 | valid_auc: 0.76345 | valid_balanced_accuracy: 0.69    | valid_accuracy: 0.68996 |  0:18:36s
epoch 65 | loss: 0.53302 | train_auc: 0.78928 | train_balanced_accuracy: 0.71252 | train_accuracy: 0.71266 | valid_auc: 0.75386 | valid_balanced_accuracy: 0.68508 | valid_accuracy: 0.68524 |  0:18:51s
epoch 66 | loss: 0.53897 | train_auc: 0.8073  | train_balanced_accuracy: 0.72769 | train_accuracy: 0.72765 | valid_auc: 0.7659  | valid_balanced_accuracy: 0.69449 | valid_accuracy: 0.69452 |  0:19:07s
epoch 67 | loss: 0.53016 | train_auc: 0.77013 | train_balanced_accuracy: 0.69464 | train_accuracy: 0.69444 | valid_auc: 0.74821 | valid_balanced_accuracy: 0.6812  | valid_accuracy: 0.68099 |  0:19:24s
epoch 68 | loss: 0.53029 | train_auc: 0.81406 | train_balanced_accuracy: 0.73406 | train_accuracy: 0.7341  | valid_auc: 0.76427 | valid_balanced_accuracy: 0.69383 | valid_accuracy: 0.69389 |  0:19:41s
epoch 69 | loss: 0.53261 | train_auc: 0.78332 | train_balanced_accuracy: 0.70965 | train_accuracy: 0.71014 | valid_auc: 0.74983 | valid_balanced_accuracy: 0.67839 | valid_accuracy: 0.67894 |  0:19:59s
epoch 70 | loss: 0.52833 | train_auc: 0.80162 | train_balanced_accuracy: 0.72392 | train_accuracy: 0.72427 | valid_auc: 0.75925 | valid_balanced_accuracy: 0.6859  | valid_accuracy: 0.68634 |  0:20:16s
epoch 71 | loss: 0.53127 | train_auc: 0.79946 | train_balanced_accuracy: 0.72259 | train_accuracy: 0.72297 | valid_auc: 0.75605 | valid_balanced_accuracy: 0.68686 | valid_accuracy: 0.68728 |  0:20:33s
epoch 72 | loss: 0.53246 | train_auc: 0.82564 | train_balanced_accuracy: 0.74113 | train_accuracy: 0.74123 | valid_auc: 0.7666  | valid_balanced_accuracy: 0.69472 | valid_accuracy: 0.69484 |  0:20:50s
epoch 73 | loss: 0.52935 | train_auc: 0.81315 | train_balanced_accuracy: 0.73258 | train_accuracy: 0.73265 | valid_auc: 0.7671  | valid_balanced_accuracy: 0.69475 | valid_accuracy: 0.69484 |  0:21:06s
epoch 74 | loss: 0.53234 | train_auc: 0.79962 | train_balanced_accuracy: 0.71883 | train_accuracy: 0.71888 | valid_auc: 0.75642 | valid_balanced_accuracy: 0.68313 | valid_accuracy: 0.68319 |  0:21:22s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69578
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 62/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.692 total time=21.5min
[CV 5/5; 62/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71523 | train_auc: 0.59649 | train_balanced_accuracy: 0.53817 | train_accuracy: 0.53604 | valid_auc: 0.59839 | valid_balanced_accuracy: 0.54183 | valid_accuracy: 0.53966 |  0:00:17s
epoch 1  | loss: 0.65301 | train_auc: 0.61818 | train_balanced_accuracy: 0.58281 | train_accuracy: 0.58129 | valid_auc: 0.62446 | valid_balanced_accuracy: 0.58749 | valid_accuracy: 0.58593 |  0:00:32s
epoch 2  | loss: 0.63668 | train_auc: 0.66039 | train_balanced_accuracy: 0.60829 | train_accuracy: 0.60745 | valid_auc: 0.65832 | valid_balanced_accuracy: 0.60729 | valid_accuracy: 0.60639 |  0:00:48s
epoch 3  | loss: 0.62487 | train_auc: 0.66792 | train_balanced_accuracy: 0.6033  | train_accuracy: 0.60175 | valid_auc: 0.66603 | valid_balanced_accuracy: 0.60108 | valid_accuracy: 0.59946 |  0:01:05s
epoch 4  | loss: 0.61231 | train_auc: 0.66935 | train_balanced_accuracy: 0.60707 | train_accuracy: 0.60572 | valid_auc: 0.66785 | valid_balanced_accuracy: 0.60415 | valid_accuracy: 0.60277 |  0:01:21s
epoch 5  | loss: 0.61071 | train_auc: 0.67088 | train_balanced_accuracy: 0.61309 | train_accuracy: 0.61206 | valid_auc: 0.66705 | valid_balanced_accuracy: 0.61059 | valid_accuracy: 0.60954 |  0:01:38s
epoch 6  | loss: 0.60883 | train_auc: 0.68123 | train_balanced_accuracy: 0.61826 | train_accuracy: 0.61749 | valid_auc: 0.6768  | valid_balanced_accuracy: 0.61925 | valid_accuracy: 0.61851 |  0:01:55s
epoch 7  | loss: 0.60745 | train_auc: 0.68542 | train_balanced_accuracy: 0.61969 | train_accuracy: 0.61898 | valid_auc: 0.68137 | valid_balanced_accuracy: 0.61384 | valid_accuracy: 0.61316 |  0:02:10s
epoch 8  | loss: 0.6071  | train_auc: 0.70017 | train_balanced_accuracy: 0.62508 | train_accuracy: 0.62433 | valid_auc: 0.70003 | valid_balanced_accuracy: 0.62433 | valid_accuracy: 0.62354 |  0:02:27s
epoch 9  | loss: 0.60144 | train_auc: 0.68985 | train_balanced_accuracy: 0.62359 | train_accuracy: 0.62295 | valid_auc: 0.6891  | valid_balanced_accuracy: 0.6204  | valid_accuracy: 0.61977 |  0:02:44s
epoch 10 | loss: 0.60107 | train_auc: 0.69992 | train_balanced_accuracy: 0.62756 | train_accuracy: 0.62681 | valid_auc: 0.69933 | valid_balanced_accuracy: 0.62843 | valid_accuracy: 0.62764 |  0:03:01s
epoch 11 | loss: 0.59588 | train_auc: 0.71352 | train_balanced_accuracy: 0.64306 | train_accuracy: 0.64263 | valid_auc: 0.7106  | valid_balanced_accuracy: 0.63608 | valid_accuracy: 0.63566 |  0:03:18s
epoch 12 | loss: 0.59576 | train_auc: 0.7154  | train_balanced_accuracy: 0.64378 | train_accuracy: 0.64341 | valid_auc: 0.71172 | valid_balanced_accuracy: 0.63822 | valid_accuracy: 0.63787 |  0:03:34s
epoch 13 | loss: 0.59704 | train_auc: 0.7221  | train_balanced_accuracy: 0.65385 | train_accuracy: 0.6536  | valid_auc: 0.71679 | valid_balanced_accuracy: 0.64474 | valid_accuracy: 0.64448 |  0:03:51s
epoch 14 | loss: 0.59092 | train_auc: 0.73319 | train_balanced_accuracy: 0.66792 | train_accuracy: 0.66812 | valid_auc: 0.72446 | valid_balanced_accuracy: 0.66379 | valid_accuracy: 0.66399 |  0:04:09s
epoch 15 | loss: 0.58826 | train_auc: 0.73793 | train_balanced_accuracy: 0.67061 | train_accuracy: 0.67084 | valid_auc: 0.73018 | valid_balanced_accuracy: 0.66488 | valid_accuracy: 0.66509 |  0:04:25s
epoch 16 | loss: 0.5907  | train_auc: 0.74486 | train_balanced_accuracy: 0.67649 | train_accuracy: 0.6765  | valid_auc: 0.73348 | valid_balanced_accuracy: 0.66793 | valid_accuracy: 0.66793 |  0:04:42s
epoch 17 | loss: 0.59029 | train_auc: 0.74863 | train_balanced_accuracy: 0.68382 | train_accuracy: 0.68398 | valid_auc: 0.73728 | valid_balanced_accuracy: 0.6714  | valid_accuracy: 0.67155 |  0:05:01s
epoch 18 | loss: 0.58469 | train_auc: 0.74948 | train_balanced_accuracy: 0.68258 | train_accuracy: 0.68296 | valid_auc: 0.73616 | valid_balanced_accuracy: 0.67085 | valid_accuracy: 0.67123 |  0:05:18s
epoch 19 | loss: 0.58578 | train_auc: 0.75358 | train_balanced_accuracy: 0.68354 | train_accuracy: 0.68362 | valid_auc: 0.73729 | valid_balanced_accuracy: 0.6743  | valid_accuracy: 0.67438 |  0:05:35s
epoch 20 | loss: 0.58168 | train_auc: 0.75555 | train_balanced_accuracy: 0.68777 | train_accuracy: 0.68795 | valid_auc: 0.73735 | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.67816 |  0:05:51s
epoch 21 | loss: 0.57967 | train_auc: 0.76328 | train_balanced_accuracy: 0.69857 | train_accuracy: 0.69897 | valid_auc: 0.73996 | valid_balanced_accuracy: 0.68091 | valid_accuracy: 0.6813  |  0:06:09s
epoch 22 | loss: 0.57984 | train_auc: 0.76119 | train_balanced_accuracy: 0.69413 | train_accuracy: 0.6946  | valid_auc: 0.73989 | valid_balanced_accuracy: 0.67988 | valid_accuracy: 0.68036 |  0:06:26s
epoch 23 | loss: 0.57562 | train_auc: 0.7613  | train_balanced_accuracy: 0.69256 | train_accuracy: 0.69299 | valid_auc: 0.73959 | valid_balanced_accuracy: 0.67551 | valid_accuracy: 0.67595 |  0:06:43s
epoch 24 | loss: 0.58321 | train_auc: 0.7657  | train_balanced_accuracy: 0.69535 | train_accuracy: 0.69582 | valid_auc: 0.74111 | valid_balanced_accuracy: 0.6741  | valid_accuracy: 0.67454 |  0:07:01s
epoch 25 | loss: 0.57741 | train_auc: 0.77008 | train_balanced_accuracy: 0.69887 | train_accuracy: 0.69897 | valid_auc: 0.7446  | valid_balanced_accuracy: 0.67872 | valid_accuracy: 0.67879 |  0:07:20s
epoch 26 | loss: 0.5752  | train_auc: 0.77281 | train_balanced_accuracy: 0.70337 | train_accuracy: 0.70373 | valid_auc: 0.74688 | valid_balanced_accuracy: 0.6841  | valid_accuracy: 0.68445 |  0:07:38s
epoch 27 | loss: 0.57384 | train_auc: 0.77526 | train_balanced_accuracy: 0.70243 | train_accuracy: 0.70239 | valid_auc: 0.75102 | valid_balanced_accuracy: 0.68973 | valid_accuracy: 0.68964 |  0:07:53s
epoch 28 | loss: 0.57387 | train_auc: 0.77318 | train_balanced_accuracy: 0.70362 | train_accuracy: 0.70373 | valid_auc: 0.74837 | valid_balanced_accuracy: 0.68467 | valid_accuracy: 0.68477 |  0:08:11s
epoch 29 | loss: 0.57407 | train_auc: 0.77831 | train_balanced_accuracy: 0.70703 | train_accuracy: 0.70719 | valid_auc: 0.74994 | valid_balanced_accuracy: 0.68695 | valid_accuracy: 0.68713 |  0:08:28s
epoch 30 | loss: 0.57315 | train_auc: 0.7764  | train_balanced_accuracy: 0.7058  | train_accuracy: 0.70605 | valid_auc: 0.74621 | valid_balanced_accuracy: 0.68058 | valid_accuracy: 0.68083 |  0:08:44s
epoch 31 | loss: 0.57067 | train_auc: 0.76194 | train_balanced_accuracy: 0.69579 | train_accuracy: 0.6959  | valid_auc: 0.73985 | valid_balanced_accuracy: 0.68255 | valid_accuracy: 0.68272 |  0:09:01s
epoch 32 | loss: 0.56999 | train_auc: 0.74772 | train_balanced_accuracy: 0.67971 | train_accuracy: 0.67949 | valid_auc: 0.72974 | valid_balanced_accuracy: 0.66832 | valid_accuracy: 0.66808 |  0:09:18s
epoch 33 | loss: 0.57426 | train_auc: 0.75621 | train_balanced_accuracy: 0.69111 | train_accuracy: 0.69141 | valid_auc: 0.74073 | valid_balanced_accuracy: 0.67877 | valid_accuracy: 0.6791  |  0:09:35s
epoch 34 | loss: 0.5622  | train_auc: 0.75998 | train_balanced_accuracy: 0.69096 | train_accuracy: 0.69098 | valid_auc: 0.73881 | valid_balanced_accuracy: 0.67916 | valid_accuracy: 0.67926 |  0:09:51s
epoch 35 | loss: 0.56775 | train_auc: 0.75885 | train_balanced_accuracy: 0.69185 | train_accuracy: 0.69177 | valid_auc: 0.74054 | valid_balanced_accuracy: 0.68325 | valid_accuracy: 0.68319 |  0:10:09s
epoch 36 | loss: 0.56603 | train_auc: 0.75592 | train_balanced_accuracy: 0.68861 | train_accuracy: 0.68878 | valid_auc: 0.73688 | valid_balanced_accuracy: 0.67762 | valid_accuracy: 0.67784 |  0:10:25s
epoch 37 | loss: 0.56397 | train_auc: 0.76633 | train_balanced_accuracy: 0.69999 | train_accuracy: 0.70015 | valid_auc: 0.74384 | valid_balanced_accuracy: 0.68158 | valid_accuracy: 0.68178 |  0:10:41s
epoch 38 | loss: 0.56535 | train_auc: 0.76405 | train_balanced_accuracy: 0.69529 | train_accuracy: 0.69515 | valid_auc: 0.74276 | valid_balanced_accuracy: 0.67894 | valid_accuracy: 0.67879 |  0:10:59s
epoch 39 | loss: 0.56978 | train_auc: 0.77093 | train_balanced_accuracy: 0.70062 | train_accuracy: 0.70102 | valid_auc: 0.74444 | valid_balanced_accuracy: 0.68483 | valid_accuracy: 0.68524 |  0:11:17s
epoch 40 | loss: 0.56151 | train_auc: 0.77197 | train_balanced_accuracy: 0.70361 | train_accuracy: 0.70381 | valid_auc: 0.7488  | valid_balanced_accuracy: 0.68492 | valid_accuracy: 0.68508 |  0:11:34s
epoch 41 | loss: 0.55828 | train_auc: 0.77384 | train_balanced_accuracy: 0.70289 | train_accuracy: 0.70298 | valid_auc: 0.74908 | valid_balanced_accuracy: 0.68673 | valid_accuracy: 0.68681 |  0:11:51s
epoch 42 | loss: 0.55982 | train_auc: 0.78064 | train_balanced_accuracy: 0.70884 | train_accuracy: 0.7092  | valid_auc: 0.74718 | valid_balanced_accuracy: 0.68551 | valid_accuracy: 0.68587 |  0:12:08s
epoch 43 | loss: 0.55778 | train_auc: 0.77738 | train_balanced_accuracy: 0.70486 | train_accuracy: 0.70515 | valid_auc: 0.75017 | valid_balanced_accuracy: 0.69002 | valid_accuracy: 0.69027 |  0:12:24s
epoch 44 | loss: 0.55733 | train_auc: 0.79287 | train_balanced_accuracy: 0.7144  | train_accuracy: 0.71455 | valid_auc: 0.75975 | valid_balanced_accuracy: 0.69803 | valid_accuracy: 0.69814 |  0:12:40s
epoch 45 | loss: 0.55161 | train_auc: 0.79003 | train_balanced_accuracy: 0.71235 | train_accuracy: 0.71278 | valid_auc: 0.7516  | valid_balanced_accuracy: 0.68751 | valid_accuracy: 0.68791 |  0:12:57s
epoch 46 | loss: 0.55658 | train_auc: 0.79076 | train_balanced_accuracy: 0.71302 | train_accuracy: 0.71317 | valid_auc: 0.75375 | valid_balanced_accuracy: 0.68385 | valid_accuracy: 0.68398 |  0:13:14s
epoch 47 | loss: 0.55726 | train_auc: 0.7896  | train_balanced_accuracy: 0.71352 | train_accuracy: 0.71392 | valid_auc: 0.75629 | valid_balanced_accuracy: 0.68538 | valid_accuracy: 0.68571 |  0:13:32s
epoch 48 | loss: 0.55505 | train_auc: 0.79415 | train_balanced_accuracy: 0.71759 | train_accuracy: 0.71782 | valid_auc: 0.7601  | valid_balanced_accuracy: 0.69389 | valid_accuracy: 0.69405 |  0:13:49s
epoch 49 | loss: 0.55214 | train_auc: 0.79494 | train_balanced_accuracy: 0.72007 | train_accuracy: 0.72014 | valid_auc: 0.7553  | valid_balanced_accuracy: 0.69084 | valid_accuracy: 0.6909  |  0:14:06s
epoch 50 | loss: 0.5492  | train_auc: 0.79957 | train_balanced_accuracy: 0.72118 | train_accuracy: 0.72124 | valid_auc: 0.75247 | valid_balanced_accuracy: 0.68413 | valid_accuracy: 0.68414 |  0:14:23s
epoch 51 | loss: 0.55237 | train_auc: 0.7976  | train_balanced_accuracy: 0.71981 | train_accuracy: 0.72006 | valid_auc: 0.75597 | valid_balanced_accuracy: 0.68928 | valid_accuracy: 0.68949 |  0:14:41s
epoch 52 | loss: 0.55002 | train_auc: 0.80107 | train_balanced_accuracy: 0.72159 | train_accuracy: 0.72191 | valid_auc: 0.75526 | valid_balanced_accuracy: 0.69171 | valid_accuracy: 0.69201 |  0:14:56s
epoch 53 | loss: 0.55766 | train_auc: 0.80015 | train_balanced_accuracy: 0.72116 | train_accuracy: 0.72147 | valid_auc: 0.75558 | valid_balanced_accuracy: 0.68999 | valid_accuracy: 0.69027 |  0:15:13s
epoch 54 | loss: 0.55104 | train_auc: 0.80104 | train_balanced_accuracy: 0.72275 | train_accuracy: 0.72293 | valid_auc: 0.75705 | valid_balanced_accuracy: 0.68812 | valid_accuracy: 0.68823 |  0:15:30s
epoch 55 | loss: 0.55823 | train_auc: 0.80024 | train_balanced_accuracy: 0.72194 | train_accuracy: 0.7223  | valid_auc: 0.75699 | valid_balanced_accuracy: 0.69467 | valid_accuracy: 0.695   |  0:15:46s
epoch 56 | loss: 0.55385 | train_auc: 0.79833 | train_balanced_accuracy: 0.72003 | train_accuracy: 0.7199  | valid_auc: 0.75321 | valid_balanced_accuracy: 0.68825 | valid_accuracy: 0.68807 |  0:16:02s
epoch 57 | loss: 0.55045 | train_auc: 0.80187 | train_balanced_accuracy: 0.72414 | train_accuracy: 0.72439 | valid_auc: 0.75791 | valid_balanced_accuracy: 0.69288 | valid_accuracy: 0.69311 |  0:16:19s
epoch 58 | loss: 0.5463  | train_auc: 0.80205 | train_balanced_accuracy: 0.72226 | train_accuracy: 0.72214 | valid_auc: 0.75552 | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68634 |  0:16:35s
epoch 59 | loss: 0.55252 | train_auc: 0.78996 | train_balanced_accuracy: 0.70962 | train_accuracy: 0.71003 | valid_auc: 0.75081 | valid_balanced_accuracy: 0.68379 | valid_accuracy: 0.68414 |  0:16:53s
epoch 60 | loss: 0.54739 | train_auc: 0.80434 | train_balanced_accuracy: 0.72494 | train_accuracy: 0.72513 | valid_auc: 0.7562  | valid_balanced_accuracy: 0.68896 | valid_accuracy: 0.68917 |  0:17:11s
epoch 61 | loss: 0.55102 | train_auc: 0.80178 | train_balanced_accuracy: 0.72236 | train_accuracy: 0.72254 | valid_auc: 0.75683 | valid_balanced_accuracy: 0.68871 | valid_accuracy: 0.68886 |  0:17:28s
epoch 62 | loss: 0.54343 | train_auc: 0.80165 | train_balanced_accuracy: 0.72263 | train_accuracy: 0.72266 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69057 | valid_accuracy: 0.69059 |  0:17:45s
epoch 63 | loss: 0.54509 | train_auc: 0.8028  | train_balanced_accuracy: 0.72414 | train_accuracy: 0.72443 | valid_auc: 0.75773 | valid_balanced_accuracy: 0.68858 | valid_accuracy: 0.68886 |  0:18:01s
epoch 64 | loss: 0.54058 | train_auc: 0.80872 | train_balanced_accuracy: 0.72768 | train_accuracy: 0.72793 | valid_auc: 0.75892 | valid_balanced_accuracy: 0.69362 | valid_accuracy: 0.69389 |  0:18:18s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69814
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 62/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.691 total time=18.4min
[CV 1/5; 63/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82139 | train_auc: 0.49841 | train_balanced_accuracy: 0.51329 | train_accuracy: 0.511   | valid_auc: 0.48094 | valid_balanced_accuracy: 0.49984 | valid_accuracy: 0.49748 |  0:00:16s
epoch 1  | loss: 0.75373 | train_auc: 0.50391 | train_balanced_accuracy: 0.51926 | train_accuracy: 0.51674 | valid_auc: 0.48948 | valid_balanced_accuracy: 0.50809 | valid_accuracy: 0.50551 |  0:00:33s
epoch 2  | loss: 0.71183 | train_auc: 0.52521 | train_balanced_accuracy: 0.5184  | train_accuracy: 0.51568 | valid_auc: 0.51704 | valid_balanced_accuracy: 0.50989 | valid_accuracy: 0.50708 |  0:00:49s
epoch 3  | loss: 0.69021 | train_auc: 0.55013 | train_balanced_accuracy: 0.52442 | train_accuracy: 0.52186 | valid_auc: 0.54551 | valid_balanced_accuracy: 0.52057 | valid_accuracy: 0.51794 |  0:01:05s
epoch 4  | loss: 0.67191 | train_auc: 0.57064 | train_balanced_accuracy: 0.52908 | train_accuracy: 0.52634 | valid_auc: 0.56452 | valid_balanced_accuracy: 0.52518 | valid_accuracy: 0.52235 |  0:01:23s
epoch 5  | loss: 0.66748 | train_auc: 0.58608 | train_balanced_accuracy: 0.53603 | train_accuracy: 0.53339 | valid_auc: 0.5757  | valid_balanced_accuracy: 0.5339  | valid_accuracy: 0.53116 |  0:01:39s
epoch 6  | loss: 0.6654  | train_auc: 0.60162 | train_balanced_accuracy: 0.54833 | train_accuracy: 0.5459  | valid_auc: 0.59102 | valid_balanced_accuracy: 0.54407 | valid_accuracy: 0.54155 |  0:01:56s
epoch 7  | loss: 0.6591  | train_auc: 0.61018 | train_balanced_accuracy: 0.56063 | train_accuracy: 0.55841 | valid_auc: 0.59996 | valid_balanced_accuracy: 0.55299 | valid_accuracy: 0.55068 |  0:02:14s
epoch 8  | loss: 0.64933 | train_auc: 0.61892 | train_balanced_accuracy: 0.57106 | train_accuracy: 0.56899 | valid_auc: 0.60946 | valid_balanced_accuracy: 0.56368 | valid_accuracy: 0.56154 |  0:02:31s
epoch 9  | loss: 0.65035 | train_auc: 0.62931 | train_balanced_accuracy: 0.5803  | train_accuracy: 0.5784  | valid_auc: 0.62053 | valid_balanced_accuracy: 0.57042 | valid_accuracy: 0.56846 |  0:02:47s
epoch 10 | loss: 0.64555 | train_auc: 0.64092 | train_balanced_accuracy: 0.59003 | train_accuracy: 0.58831 | valid_auc: 0.6334  | valid_balanced_accuracy: 0.57919 | valid_accuracy: 0.57743 |  0:03:03s
epoch 11 | loss: 0.64005 | train_auc: 0.65171 | train_balanced_accuracy: 0.601   | train_accuracy: 0.59953 | valid_auc: 0.64594 | valid_balanced_accuracy: 0.59155 | valid_accuracy: 0.59002 |  0:03:21s
epoch 12 | loss: 0.63904 | train_auc: 0.66041 | train_balanced_accuracy: 0.60355 | train_accuracy: 0.60209 | valid_auc: 0.655   | valid_balanced_accuracy: 0.59391 | valid_accuracy: 0.59238 |  0:03:38s
epoch 13 | loss: 0.63969 | train_auc: 0.66846 | train_balanced_accuracy: 0.61003 | train_accuracy: 0.60873 | valid_auc: 0.66493 | valid_balanced_accuracy: 0.60239 | valid_accuracy: 0.60104 |  0:03:55s
epoch 14 | loss: 0.63419 | train_auc: 0.67675 | train_balanced_accuracy: 0.61714 | train_accuracy: 0.61601 | valid_auc: 0.67194 | valid_balanced_accuracy: 0.6077  | valid_accuracy: 0.60655 |  0:04:11s
epoch 15 | loss: 0.63006 | train_auc: 0.68185 | train_balanced_accuracy: 0.62418 | train_accuracy: 0.62325 | valid_auc: 0.67775 | valid_balanced_accuracy: 0.61867 | valid_accuracy: 0.61772 |  0:04:29s
epoch 16 | loss: 0.62818 | train_auc: 0.68593 | train_balanced_accuracy: 0.63021 | train_accuracy: 0.62943 | valid_auc: 0.68266 | valid_balanced_accuracy: 0.63174 | valid_accuracy: 0.63094 |  0:04:47s
epoch 17 | loss: 0.62826 | train_auc: 0.6908  | train_balanced_accuracy: 0.63432 | train_accuracy: 0.6336  | valid_auc: 0.6878  | valid_balanced_accuracy: 0.63639 | valid_accuracy: 0.63566 |  0:05:07s
epoch 18 | loss: 0.62286 | train_auc: 0.69706 | train_balanced_accuracy: 0.64114 | train_accuracy: 0.64065 | valid_auc: 0.69274 | valid_balanced_accuracy: 0.6417  | valid_accuracy: 0.64117 |  0:05:25s
epoch 19 | loss: 0.62282 | train_auc: 0.7037  | train_balanced_accuracy: 0.64291 | train_accuracy: 0.64238 | valid_auc: 0.69729 | valid_balanced_accuracy: 0.64204 | valid_accuracy: 0.64149 |  0:05:42s
epoch 20 | loss: 0.6249  | train_auc: 0.70726 | train_balanced_accuracy: 0.64564 | train_accuracy: 0.64525 | valid_auc: 0.69967 | valid_balanced_accuracy: 0.64143 | valid_accuracy: 0.64101 |  0:05:59s
epoch 21 | loss: 0.61983 | train_auc: 0.70994 | train_balanced_accuracy: 0.64823 | train_accuracy: 0.64796 | valid_auc: 0.70122 | valid_balanced_accuracy: 0.63863 | valid_accuracy: 0.63834 |  0:06:15s
epoch 22 | loss: 0.62183 | train_auc: 0.71324 | train_balanced_accuracy: 0.64918 | train_accuracy: 0.64899 | valid_auc: 0.70382 | valid_balanced_accuracy: 0.64122 | valid_accuracy: 0.64101 |  0:06:31s
epoch 23 | loss: 0.61746 | train_auc: 0.71711 | train_balanced_accuracy: 0.65315 | train_accuracy: 0.65304 | valid_auc: 0.70679 | valid_balanced_accuracy: 0.64664 | valid_accuracy: 0.64652 |  0:06:49s
epoch 24 | loss: 0.62304 | train_auc: 0.72073 | train_balanced_accuracy: 0.66001 | train_accuracy: 0.66012 | valid_auc: 0.71005 | valid_balanced_accuracy: 0.65566 | valid_accuracy: 0.65581 |  0:07:06s
epoch 25 | loss: 0.61673 | train_auc: 0.72118 | train_balanced_accuracy: 0.66016 | train_accuracy: 0.66036 | valid_auc: 0.71024 | valid_balanced_accuracy: 0.65119 | valid_accuracy: 0.6514  |  0:07:24s
epoch 26 | loss: 0.6175  | train_auc: 0.72338 | train_balanced_accuracy: 0.6629  | train_accuracy: 0.66303 | valid_auc: 0.71098 | valid_balanced_accuracy: 0.65219 | valid_accuracy: 0.65234 |  0:07:42s
epoch 27 | loss: 0.61395 | train_auc: 0.72534 | train_balanced_accuracy: 0.66428 | train_accuracy: 0.66453 | valid_auc: 0.71266 | valid_balanced_accuracy: 0.65663 | valid_accuracy: 0.65691 |  0:07:59s
epoch 28 | loss: 0.61409 | train_auc: 0.7282  | train_balanced_accuracy: 0.66653 | train_accuracy: 0.66681 | valid_auc: 0.7139  | valid_balanced_accuracy: 0.65663 | valid_accuracy: 0.65691 |  0:08:15s
epoch 29 | loss: 0.6126  | train_auc: 0.72918 | train_balanced_accuracy: 0.66808 | train_accuracy: 0.66831 | valid_auc: 0.71453 | valid_balanced_accuracy: 0.65746 | valid_accuracy: 0.6577  |  0:08:31s
epoch 30 | loss: 0.61045 | train_auc: 0.73139 | train_balanced_accuracy: 0.66883 | train_accuracy: 0.66917 | valid_auc: 0.71689 | valid_balanced_accuracy: 0.65575 | valid_accuracy: 0.65612 |  0:08:48s
epoch 31 | loss: 0.60973 | train_auc: 0.73195 | train_balanced_accuracy: 0.66916 | train_accuracy: 0.66953 | valid_auc: 0.71827 | valid_balanced_accuracy: 0.65731 | valid_accuracy: 0.6577  |  0:09:05s
epoch 32 | loss: 0.61254 | train_auc: 0.73555 | train_balanced_accuracy: 0.67229 | train_accuracy: 0.67267 | valid_auc: 0.71995 | valid_balanced_accuracy: 0.66013 | valid_accuracy: 0.66053 |  0:09:22s
epoch 33 | loss: 0.61076 | train_auc: 0.73497 | train_balanced_accuracy: 0.67096 | train_accuracy: 0.67122 | valid_auc: 0.71939 | valid_balanced_accuracy: 0.65886 | valid_accuracy: 0.65911 |  0:09:41s
epoch 34 | loss: 0.60739 | train_auc: 0.73515 | train_balanced_accuracy: 0.67235 | train_accuracy: 0.67263 | valid_auc: 0.71964 | valid_balanced_accuracy: 0.656   | valid_accuracy: 0.65628 |  0:10:00s
epoch 35 | loss: 0.60903 | train_auc: 0.73626 | train_balanced_accuracy: 0.66953 | train_accuracy: 0.67008 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.65889 | valid_accuracy: 0.65943 |  0:10:18s
epoch 36 | loss: 0.60941 | train_auc: 0.73481 | train_balanced_accuracy: 0.67097 | train_accuracy: 0.67126 | valid_auc: 0.72101 | valid_balanced_accuracy: 0.65835 | valid_accuracy: 0.65864 |  0:10:34s
epoch 37 | loss: 0.60448 | train_auc: 0.73458 | train_balanced_accuracy: 0.67044 | train_accuracy: 0.6709  | valid_auc: 0.7206  | valid_balanced_accuracy: 0.65581 | valid_accuracy: 0.65628 |  0:10:51s
epoch 38 | loss: 0.60604 | train_auc: 0.73185 | train_balanced_accuracy: 0.66947 | train_accuracy: 0.66964 | valid_auc: 0.71899 | valid_balanced_accuracy: 0.65552 | valid_accuracy: 0.65565 |  0:11:09s
epoch 39 | loss: 0.60785 | train_auc: 0.71395 | train_balanced_accuracy: 0.65598 | train_accuracy: 0.65631 | valid_auc: 0.7024  | valid_balanced_accuracy: 0.64812 | valid_accuracy: 0.64841 |  0:11:25s
epoch 40 | loss: 0.60595 | train_auc: 0.73304 | train_balanced_accuracy: 0.6674  | train_accuracy: 0.66776 | valid_auc: 0.71858 | valid_balanced_accuracy: 0.657   | valid_accuracy: 0.65738 |  0:11:42s
epoch 41 | loss: 0.60478 | train_auc: 0.72333 | train_balanced_accuracy: 0.66059 | train_accuracy: 0.66087 | valid_auc: 0.70961 | valid_balanced_accuracy: 0.6522  | valid_accuracy: 0.6525  |  0:11:59s
epoch 42 | loss: 0.6023  | train_auc: 0.71725 | train_balanced_accuracy: 0.65734 | train_accuracy: 0.65756 | valid_auc: 0.70362 | valid_balanced_accuracy: 0.64708 | valid_accuracy: 0.64731 |  0:12:15s
epoch 43 | loss: 0.60617 | train_auc: 0.71175 | train_balanced_accuracy: 0.6545  | train_accuracy: 0.65465 | valid_auc: 0.69818 | valid_balanced_accuracy: 0.63853 | valid_accuracy: 0.63865 |  0:12:34s
epoch 44 | loss: 0.60365 | train_auc: 0.71024 | train_balanced_accuracy: 0.65195 | train_accuracy: 0.65229 | valid_auc: 0.6957  | valid_balanced_accuracy: 0.63438 | valid_accuracy: 0.63472 |  0:12:50s
epoch 45 | loss: 0.60432 | train_auc: 0.70979 | train_balanced_accuracy: 0.6526  | train_accuracy: 0.65276 | valid_auc: 0.69681 | valid_balanced_accuracy: 0.63848 | valid_accuracy: 0.63865 |  0:13:07s
epoch 46 | loss: 0.60324 | train_auc: 0.72047 | train_balanced_accuracy: 0.66027 | train_accuracy: 0.6604  | valid_auc: 0.70782 | valid_balanced_accuracy: 0.65505 | valid_accuracy: 0.65518 |  0:13:23s
epoch 47 | loss: 0.60061 | train_auc: 0.70657 | train_balanced_accuracy: 0.65115 | train_accuracy: 0.65123 | valid_auc: 0.69427 | valid_balanced_accuracy: 0.63763 | valid_accuracy: 0.63771 |  0:13:40s
epoch 48 | loss: 0.597   | train_auc: 0.70567 | train_balanced_accuracy: 0.65467 | train_accuracy: 0.65493 | valid_auc: 0.69317 | valid_balanced_accuracy: 0.64279 | valid_accuracy: 0.64306 |  0:13:58s
epoch 49 | loss: 0.59991 | train_auc: 0.70291 | train_balanced_accuracy: 0.65249 | train_accuracy: 0.65269 | valid_auc: 0.69009 | valid_balanced_accuracy: 0.64162 | valid_accuracy: 0.6418  |  0:14:16s
epoch 50 | loss: 0.59832 | train_auc: 0.66762 | train_balanced_accuracy: 0.62645 | train_accuracy: 0.62699 | valid_auc: 0.6632  | valid_balanced_accuracy: 0.61811 | valid_accuracy: 0.61867 |  0:14:32s
epoch 51 | loss: 0.59697 | train_auc: 0.65464 | train_balanced_accuracy: 0.61691 | train_accuracy: 0.61743 | valid_auc: 0.65483 | valid_balanced_accuracy: 0.61204 | valid_accuracy: 0.61253 |  0:14:49s
epoch 52 | loss: 0.59671 | train_auc: 0.6763  | train_balanced_accuracy: 0.63357 | train_accuracy: 0.63411 | valid_auc: 0.66855 | valid_balanced_accuracy: 0.62407 | valid_accuracy: 0.62465 |  0:15:06s

Early stopping occurred at epoch 52 with best_epoch = 32 and best_valid_accuracy = 0.66053
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 63/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=15.3min
[CV 2/5; 63/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82605 | train_auc: 0.51404 | train_balanced_accuracy: 0.52387 | train_accuracy: 0.5215  | valid_auc: 0.51203 | valid_balanced_accuracy: 0.51377 | valid_accuracy: 0.51133 |  0:00:18s
epoch 1  | loss: 0.73837 | train_auc: 0.51275 | train_balanced_accuracy: 0.51934 | train_accuracy: 0.51674 | valid_auc: 0.51508 | valid_balanced_accuracy: 0.51335 | valid_accuracy: 0.5107  |  0:00:35s
epoch 2  | loss: 0.70758 | train_auc: 0.52232 | train_balanced_accuracy: 0.51206 | train_accuracy: 0.50919 | valid_auc: 0.52721 | valid_balanced_accuracy: 0.50877 | valid_accuracy: 0.50582 |  0:00:52s
epoch 3  | loss: 0.69213 | train_auc: 0.54249 | train_balanced_accuracy: 0.51793 | train_accuracy: 0.51509 | valid_auc: 0.54507 | valid_balanced_accuracy: 0.52116 | valid_accuracy: 0.51826 |  0:01:09s
epoch 4  | loss: 0.67641 | train_auc: 0.56481 | train_balanced_accuracy: 0.52583 | train_accuracy: 0.52296 | valid_auc: 0.56394 | valid_balanced_accuracy: 0.52592 | valid_accuracy: 0.52298 |  0:01:27s
epoch 5  | loss: 0.67054 | train_auc: 0.58105 | train_balanced_accuracy: 0.52847 | train_accuracy: 0.52567 | valid_auc: 0.57648 | valid_balanced_accuracy: 0.52851 | valid_accuracy: 0.52565 |  0:01:44s
epoch 6  | loss: 0.66774 | train_auc: 0.59435 | train_balanced_accuracy: 0.5399  | train_accuracy: 0.53724 | valid_auc: 0.58821 | valid_balanced_accuracy: 0.53893 | valid_accuracy: 0.5362  |  0:02:02s
epoch 7  | loss: 0.66261 | train_auc: 0.60307 | train_balanced_accuracy: 0.54578 | train_accuracy: 0.54318 | valid_auc: 0.5947  | valid_balanced_accuracy: 0.54389 | valid_accuracy: 0.54123 |  0:02:18s
epoch 8  | loss: 0.65189 | train_auc: 0.61358 | train_balanced_accuracy: 0.55484 | train_accuracy: 0.55247 | valid_auc: 0.60553 | valid_balanced_accuracy: 0.55298 | valid_accuracy: 0.55052 |  0:02:35s
epoch 9  | loss: 0.65538 | train_auc: 0.62241 | train_balanced_accuracy: 0.56382 | train_accuracy: 0.56156 | valid_auc: 0.61297 | valid_balanced_accuracy: 0.55932 | valid_accuracy: 0.55697 |  0:02:53s
epoch 10 | loss: 0.64685 | train_auc: 0.63825 | train_balanced_accuracy: 0.5725  | train_accuracy: 0.57045 | valid_auc: 0.62912 | valid_balanced_accuracy: 0.56837 | valid_accuracy: 0.56626 |  0:03:11s
epoch 11 | loss: 0.64346 | train_auc: 0.65001 | train_balanced_accuracy: 0.58147 | train_accuracy: 0.57962 | valid_auc: 0.64114 | valid_balanced_accuracy: 0.57649 | valid_accuracy: 0.5746  |  0:03:29s
epoch 12 | loss: 0.64114 | train_auc: 0.65849 | train_balanced_accuracy: 0.59009 | train_accuracy: 0.58839 | valid_auc: 0.65086 | valid_balanced_accuracy: 0.58151 | valid_accuracy: 0.57979 |  0:03:46s
epoch 13 | loss: 0.63934 | train_auc: 0.66684 | train_balanced_accuracy: 0.59573 | train_accuracy: 0.5941  | valid_auc: 0.66095 | valid_balanced_accuracy: 0.58443 | valid_accuracy: 0.58278 |  0:04:02s
epoch 14 | loss: 0.63833 | train_auc: 0.67373 | train_balanced_accuracy: 0.60246 | train_accuracy: 0.60098 | valid_auc: 0.66854 | valid_balanced_accuracy: 0.58819 | valid_accuracy: 0.58672 |  0:04:20s
epoch 15 | loss: 0.63065 | train_auc: 0.67797 | train_balanced_accuracy: 0.60583 | train_accuracy: 0.60445 | valid_auc: 0.67282 | valid_balanced_accuracy: 0.59332 | valid_accuracy: 0.59191 |  0:04:37s
epoch 16 | loss: 0.63236 | train_auc: 0.68308 | train_balanced_accuracy: 0.61204 | train_accuracy: 0.61078 | valid_auc: 0.67947 | valid_balanced_accuracy: 0.6023  | valid_accuracy: 0.60104 |  0:04:55s
epoch 17 | loss: 0.6306  | train_auc: 0.68811 | train_balanced_accuracy: 0.62603 | train_accuracy: 0.62499 | valid_auc: 0.685   | valid_balanced_accuracy: 0.61659 | valid_accuracy: 0.61552 |  0:05:13s
epoch 18 | loss: 0.62835 | train_auc: 0.69279 | train_balanced_accuracy: 0.6361  | train_accuracy: 0.63541 | valid_auc: 0.68915 | valid_balanced_accuracy: 0.63453 | valid_accuracy: 0.63377 |  0:05:30s
epoch 19 | loss: 0.62492 | train_auc: 0.69649 | train_balanced_accuracy: 0.63788 | train_accuracy: 0.63714 | valid_auc: 0.69394 | valid_balanced_accuracy: 0.63596 | valid_accuracy: 0.63519 |  0:05:46s
epoch 20 | loss: 0.62465 | train_auc: 0.69938 | train_balanced_accuracy: 0.64249 | train_accuracy: 0.64202 | valid_auc: 0.69577 | valid_balanced_accuracy: 0.64198 | valid_accuracy: 0.64149 |  0:06:03s
epoch 21 | loss: 0.6225  | train_auc: 0.70189 | train_balanced_accuracy: 0.64432 | train_accuracy: 0.64395 | valid_auc: 0.69808 | valid_balanced_accuracy: 0.64234 | valid_accuracy: 0.64196 |  0:06:19s
epoch 22 | loss: 0.62592 | train_auc: 0.70461 | train_balanced_accuracy: 0.64427 | train_accuracy: 0.64395 | valid_auc: 0.70156 | valid_balanced_accuracy: 0.64212 | valid_accuracy: 0.6418  |  0:06:36s
epoch 23 | loss: 0.62148 | train_auc: 0.70954 | train_balanced_accuracy: 0.64599 | train_accuracy: 0.64568 | valid_auc: 0.70506 | valid_balanced_accuracy: 0.64355 | valid_accuracy: 0.64322 |  0:06:54s
epoch 24 | loss: 0.62075 | train_auc: 0.71288 | train_balanced_accuracy: 0.64887 | train_accuracy: 0.64863 | valid_auc: 0.70936 | valid_balanced_accuracy: 0.64678 | valid_accuracy: 0.64652 |  0:07:10s
epoch 25 | loss: 0.61744 | train_auc: 0.71371 | train_balanced_accuracy: 0.64901 | train_accuracy: 0.64883 | valid_auc: 0.71024 | valid_balanced_accuracy: 0.64832 | valid_accuracy: 0.6481  |  0:07:27s
epoch 26 | loss: 0.61615 | train_auc: 0.71699 | train_balanced_accuracy: 0.65183 | train_accuracy: 0.65166 | valid_auc: 0.71424 | valid_balanced_accuracy: 0.65224 | valid_accuracy: 0.65203 |  0:07:45s
epoch 27 | loss: 0.61561 | train_auc: 0.72116 | train_balanced_accuracy: 0.65502 | train_accuracy: 0.65489 | valid_auc: 0.71704 | valid_balanced_accuracy: 0.65379 | valid_accuracy: 0.6536  |  0:08:01s
epoch 28 | loss: 0.61406 | train_auc: 0.72285 | train_balanced_accuracy: 0.65584 | train_accuracy: 0.65575 | valid_auc: 0.71996 | valid_balanced_accuracy: 0.65781 | valid_accuracy: 0.6577  |  0:08:19s
epoch 29 | loss: 0.61256 | train_auc: 0.72678 | train_balanced_accuracy: 0.66027 | train_accuracy: 0.66008 | valid_auc: 0.72223 | valid_balanced_accuracy: 0.65744 | valid_accuracy: 0.65722 |  0:08:36s
epoch 30 | loss: 0.60954 | train_auc: 0.73168 | train_balanced_accuracy: 0.66824 | train_accuracy: 0.66831 | valid_auc: 0.72625 | valid_balanced_accuracy: 0.66267 | valid_accuracy: 0.66273 |  0:08:53s
epoch 31 | loss: 0.61107 | train_auc: 0.73469 | train_balanced_accuracy: 0.67278 | train_accuracy: 0.67295 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.66794 | valid_accuracy: 0.66808 |  0:09:11s
epoch 32 | loss: 0.61285 | train_auc: 0.73765 | train_balanced_accuracy: 0.67673 | train_accuracy: 0.67692 | valid_auc: 0.73089 | valid_balanced_accuracy: 0.67298 | valid_accuracy: 0.67312 |  0:09:29s
epoch 33 | loss: 0.60861 | train_auc: 0.73808 | train_balanced_accuracy: 0.67759 | train_accuracy: 0.67767 | valid_auc: 0.73186 | valid_balanced_accuracy: 0.67202 | valid_accuracy: 0.67202 |  0:09:46s
epoch 34 | loss: 0.60776 | train_auc: 0.73878 | train_balanced_accuracy: 0.67808 | train_accuracy: 0.6783  | valid_auc: 0.73081 | valid_balanced_accuracy: 0.67137 | valid_accuracy: 0.67155 |  0:10:02s
epoch 35 | loss: 0.60794 | train_auc: 0.74049 | train_balanced_accuracy: 0.67905 | train_accuracy: 0.67944 | valid_auc: 0.73229 | valid_balanced_accuracy: 0.67355 | valid_accuracy: 0.67391 |  0:10:19s
epoch 36 | loss: 0.60503 | train_auc: 0.73973 | train_balanced_accuracy: 0.67864 | train_accuracy: 0.67889 | valid_auc: 0.73206 | valid_balanced_accuracy: 0.67307 | valid_accuracy: 0.67328 |  0:10:34s
epoch 37 | loss: 0.60283 | train_auc: 0.73779 | train_balanced_accuracy: 0.67693 | train_accuracy: 0.67732 | valid_auc: 0.73023 | valid_balanced_accuracy: 0.67497 | valid_accuracy: 0.67532 |  0:10:51s
epoch 38 | loss: 0.60461 | train_auc: 0.74456 | train_balanced_accuracy: 0.6808  | train_accuracy: 0.68094 | valid_auc: 0.73714 | valid_balanced_accuracy: 0.67712 | valid_accuracy: 0.67721 |  0:11:08s
epoch 39 | loss: 0.60319 | train_auc: 0.74185 | train_balanced_accuracy: 0.67749 | train_accuracy: 0.67779 | valid_auc: 0.73488 | valid_balanced_accuracy: 0.67395 | valid_accuracy: 0.67422 |  0:11:26s
epoch 40 | loss: 0.60492 | train_auc: 0.73627 | train_balanced_accuracy: 0.67756 | train_accuracy: 0.67783 | valid_auc: 0.7309  | valid_balanced_accuracy: 0.67286 | valid_accuracy: 0.67312 |  0:11:44s
epoch 41 | loss: 0.6049  | train_auc: 0.74062 | train_balanced_accuracy: 0.67766 | train_accuracy: 0.67799 | valid_auc: 0.73412 | valid_balanced_accuracy: 0.67061 | valid_accuracy: 0.67092 |  0:12:01s
epoch 42 | loss: 0.60013 | train_auc: 0.7299  | train_balanced_accuracy: 0.67243 | train_accuracy: 0.67279 | valid_auc: 0.72494 | valid_balanced_accuracy: 0.66665 | valid_accuracy: 0.66698 |  0:12:18s
epoch 43 | loss: 0.60478 | train_auc: 0.71284 | train_balanced_accuracy: 0.65525 | train_accuracy: 0.65556 | valid_auc: 0.71096 | valid_balanced_accuracy: 0.66027 | valid_accuracy: 0.66053 |  0:12:35s
epoch 44 | loss: 0.59624 | train_auc: 0.71953 | train_balanced_accuracy: 0.66252 | train_accuracy: 0.66303 | valid_auc: 0.71661 | valid_balanced_accuracy: 0.66178 | valid_accuracy: 0.66226 |  0:12:54s
epoch 45 | loss: 0.5979  | train_auc: 0.70828 | train_balanced_accuracy: 0.65378 | train_accuracy: 0.65414 | valid_auc: 0.70854 | valid_balanced_accuracy: 0.65702 | valid_accuracy: 0.65738 |  0:13:12s
epoch 46 | loss: 0.59919 | train_auc: 0.70725 | train_balanced_accuracy: 0.65045 | train_accuracy: 0.65076 | valid_auc: 0.70833 | valid_balanced_accuracy: 0.65551 | valid_accuracy: 0.65581 |  0:13:28s
epoch 47 | loss: 0.59916 | train_auc: 0.67861 | train_balanced_accuracy: 0.62803 | train_accuracy: 0.62829 | valid_auc: 0.67738 | valid_balanced_accuracy: 0.62515 | valid_accuracy: 0.62543 |  0:13:43s
epoch 48 | loss: 0.59662 | train_auc: 0.68063 | train_balanced_accuracy: 0.62605 | train_accuracy: 0.62656 | valid_auc: 0.68237 | valid_balanced_accuracy: 0.63292 | valid_accuracy: 0.63346 |  0:14:01s
epoch 49 | loss: 0.59934 | train_auc: 0.67845 | train_balanced_accuracy: 0.6263  | train_accuracy: 0.6266  | valid_auc: 0.67889 | valid_balanced_accuracy: 0.62719 | valid_accuracy: 0.62748 |  0:14:20s
epoch 50 | loss: 0.59801 | train_auc: 0.69201 | train_balanced_accuracy: 0.63747 | train_accuracy: 0.63777 | valid_auc: 0.69085 | valid_balanced_accuracy: 0.63473 | valid_accuracy: 0.63503 |  0:14:36s
epoch 51 | loss: 0.59552 | train_auc: 0.71744 | train_balanced_accuracy: 0.65822 | train_accuracy: 0.65867 | valid_auc: 0.71337 | valid_balanced_accuracy: 0.65793 | valid_accuracy: 0.65833 |  0:14:54s
epoch 52 | loss: 0.59252 | train_auc: 0.70558 | train_balanced_accuracy: 0.64998 | train_accuracy: 0.65032 | valid_auc: 0.70353 | valid_balanced_accuracy: 0.64885 | valid_accuracy: 0.6492  |  0:15:12s
epoch 53 | loss: 0.5953  | train_auc: 0.7311  | train_balanced_accuracy: 0.67028 | train_accuracy: 0.67071 | valid_auc: 0.72633 | valid_balanced_accuracy: 0.66422 | valid_accuracy: 0.66462 |  0:15:29s
epoch 54 | loss: 0.59695 | train_auc: 0.72241 | train_balanced_accuracy: 0.66257 | train_accuracy: 0.66288 | valid_auc: 0.71823 | valid_balanced_accuracy: 0.65902 | valid_accuracy: 0.65927 |  0:15:45s
epoch 55 | loss: 0.59953 | train_auc: 0.73665 | train_balanced_accuracy: 0.67596 | train_accuracy: 0.67621 | valid_auc: 0.73062 | valid_balanced_accuracy: 0.67934 | valid_accuracy: 0.67957 |  0:16:01s
epoch 56 | loss: 0.59702 | train_auc: 0.75378 | train_balanced_accuracy: 0.68485 | train_accuracy: 0.68519 | valid_auc: 0.74521 | valid_balanced_accuracy: 0.68412 | valid_accuracy: 0.68445 |  0:16:18s
epoch 57 | loss: 0.59417 | train_auc: 0.75652 | train_balanced_accuracy: 0.68789 | train_accuracy: 0.68822 | valid_auc: 0.74516 | valid_balanced_accuracy: 0.68322 | valid_accuracy: 0.68351 |  0:16:34s
epoch 58 | loss: 0.59198 | train_auc: 0.7565  | train_balanced_accuracy: 0.69001 | train_accuracy: 0.6901  | valid_auc: 0.74462 | valid_balanced_accuracy: 0.68233 | valid_accuracy: 0.6824  |  0:16:51s
epoch 59 | loss: 0.59576 | train_auc: 0.75587 | train_balanced_accuracy: 0.68907 | train_accuracy: 0.68932 | valid_auc: 0.74373 | valid_balanced_accuracy: 0.68234 | valid_accuracy: 0.68256 |  0:17:09s
epoch 60 | loss: 0.59317 | train_auc: 0.7495  | train_balanced_accuracy: 0.6833  | train_accuracy: 0.68357 | valid_auc: 0.74068 | valid_balanced_accuracy: 0.67885 | valid_accuracy: 0.6791  |  0:17:27s
epoch 61 | loss: 0.59255 | train_auc: 0.72187 | train_balanced_accuracy: 0.65903 | train_accuracy: 0.65918 | valid_auc: 0.71612 | valid_balanced_accuracy: 0.65524 | valid_accuracy: 0.65534 |  0:17:44s
epoch 62 | loss: 0.59127 | train_auc: 0.73704 | train_balanced_accuracy: 0.67402 | train_accuracy: 0.67448 | valid_auc: 0.72996 | valid_balanced_accuracy: 0.67066 | valid_accuracy: 0.67107 |  0:18:00s
epoch 63 | loss: 0.59386 | train_auc: 0.75997 | train_balanced_accuracy: 0.69309 | train_accuracy: 0.69325 | valid_auc: 0.74718 | valid_balanced_accuracy: 0.68322 | valid_accuracy: 0.68335 |  0:18:18s
epoch 64 | loss: 0.5941  | train_auc: 0.69635 | train_balanced_accuracy: 0.63905 | train_accuracy: 0.63946 | valid_auc: 0.69347 | valid_balanced_accuracy: 0.6367  | valid_accuracy: 0.63708 |  0:18:35s
epoch 65 | loss: 0.59415 | train_auc: 0.65465 | train_balanced_accuracy: 0.61512 | train_accuracy: 0.6157  | valid_auc: 0.65154 | valid_balanced_accuracy: 0.6126  | valid_accuracy: 0.61316 |  0:18:53s
epoch 66 | loss: 0.59435 | train_auc: 0.65904 | train_balanced_accuracy: 0.61562 | train_accuracy: 0.61605 | valid_auc: 0.65558 | valid_balanced_accuracy: 0.61243 | valid_accuracy: 0.61284 |  0:19:09s
epoch 67 | loss: 0.58753 | train_auc: 0.71607 | train_balanced_accuracy: 0.65756 | train_accuracy: 0.65804 | valid_auc: 0.71074 | valid_balanced_accuracy: 0.65536 | valid_accuracy: 0.65581 |  0:19:26s
epoch 68 | loss: 0.59025 | train_auc: 0.7282  | train_balanced_accuracy: 0.66681 | train_accuracy: 0.66713 | valid_auc: 0.72039 | valid_balanced_accuracy: 0.65742 | valid_accuracy: 0.6577  |  0:19:44s
epoch 69 | loss: 0.59017 | train_auc: 0.72544 | train_balanced_accuracy: 0.66404 | train_accuracy: 0.66429 | valid_auc: 0.71832 | valid_balanced_accuracy: 0.66158 | valid_accuracy: 0.66179 |  0:20:02s
epoch 70 | loss: 0.59041 | train_auc: 0.74151 | train_balanced_accuracy: 0.67581 | train_accuracy: 0.67614 | valid_auc: 0.73248 | valid_balanced_accuracy: 0.66877 | valid_accuracy: 0.66903 |  0:20:19s
epoch 71 | loss: 0.59235 | train_auc: 0.73597 | train_balanced_accuracy: 0.67299 | train_accuracy: 0.67322 | valid_auc: 0.72747 | valid_balanced_accuracy: 0.66005 | valid_accuracy: 0.66021 |  0:20:36s
epoch 72 | loss: 0.58619 | train_auc: 0.74853 | train_balanced_accuracy: 0.68368 | train_accuracy: 0.68389 | valid_auc: 0.73663 | valid_balanced_accuracy: 0.67123 | valid_accuracy: 0.67139 |  0:20:55s
epoch 73 | loss: 0.58866 | train_auc: 0.76382 | train_balanced_accuracy: 0.69332 | train_accuracy: 0.69361 | valid_auc: 0.74765 | valid_balanced_accuracy: 0.68276 | valid_accuracy: 0.68303 |  0:21:12s
epoch 74 | loss: 0.59029 | train_auc: 0.74737 | train_balanced_accuracy: 0.68074 | train_accuracy: 0.68109 | valid_auc: 0.7367  | valid_balanced_accuracy: 0.67031 | valid_accuracy: 0.6706  |  0:21:29s
epoch 75 | loss: 0.59051 | train_auc: 0.75908 | train_balanced_accuracy: 0.69205 | train_accuracy: 0.69223 | valid_auc: 0.74541 | valid_balanced_accuracy: 0.67957 | valid_accuracy: 0.67973 |  0:21:46s
epoch 76 | loss: 0.59159 | train_auc: 0.75715 | train_balanced_accuracy: 0.68982 | train_accuracy: 0.69003 | valid_auc: 0.74384 | valid_balanced_accuracy: 0.67878 | valid_accuracy: 0.67894 |  0:22:03s

Early stopping occurred at epoch 76 with best_epoch = 56 and best_valid_accuracy = 0.68445
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 63/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.673 total time=22.2min
[CV 3/5; 63/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82608 | train_auc: 0.50617 | train_balanced_accuracy: 0.52065 | train_accuracy: 0.51814 | valid_auc: 0.5079  | valid_balanced_accuracy: 0.51593 | valid_accuracy: 0.51338 |  0:00:15s
epoch 1  | loss: 0.73256 | train_auc: 0.51711 | train_balanced_accuracy: 0.51275 | train_accuracy: 0.50992 | valid_auc: 0.52359 | valid_balanced_accuracy: 0.51498 | valid_accuracy: 0.51212 |  0:00:31s
epoch 2  | loss: 0.7049  | train_auc: 0.52265 | train_balanced_accuracy: 0.50907 | train_accuracy: 0.50598 | valid_auc: 0.53023 | valid_balanced_accuracy: 0.50941 | valid_accuracy: 0.5063  |  0:00:47s
epoch 3  | loss: 0.69254 | train_auc: 0.5406  | train_balanced_accuracy: 0.51049 | train_accuracy: 0.50732 | valid_auc: 0.54676 | valid_balanced_accuracy: 0.51138 | valid_accuracy: 0.50818 |  0:01:02s
epoch 4  | loss: 0.68138 | train_auc: 0.55838 | train_balanced_accuracy: 0.51836 | train_accuracy: 0.51523 | valid_auc: 0.56062 | valid_balanced_accuracy: 0.52046 | valid_accuracy: 0.51731 |  0:01:19s
epoch 5  | loss: 0.67325 | train_auc: 0.57557 | train_balanced_accuracy: 0.52497 | train_accuracy: 0.52192 | valid_auc: 0.57408 | valid_balanced_accuracy: 0.52668 | valid_accuracy: 0.52361 |  0:01:34s
epoch 6  | loss: 0.66711 | train_auc: 0.5944  | train_balanced_accuracy: 0.53417 | train_accuracy: 0.53132 | valid_auc: 0.58876 | valid_balanced_accuracy: 0.53906 | valid_accuracy: 0.5362  |  0:01:49s
epoch 7  | loss: 0.66393 | train_auc: 0.60728 | train_balanced_accuracy: 0.54065 | train_accuracy: 0.53785 | valid_auc: 0.60056 | valid_balanced_accuracy: 0.5417  | valid_accuracy: 0.53887 |  0:02:05s
epoch 8  | loss: 0.65923 | train_auc: 0.61739 | train_balanced_accuracy: 0.55045 | train_accuracy: 0.54788 | valid_auc: 0.61057 | valid_balanced_accuracy: 0.54921 | valid_accuracy: 0.54658 |  0:02:24s
epoch 9  | loss: 0.65513 | train_auc: 0.62485 | train_balanced_accuracy: 0.55919 | train_accuracy: 0.55678 | valid_auc: 0.61745 | valid_balanced_accuracy: 0.55723 | valid_accuracy: 0.55477 |  0:02:40s
epoch 10 | loss: 0.64688 | train_auc: 0.63458 | train_balanced_accuracy: 0.57284 | train_accuracy: 0.57066 | valid_auc: 0.62572 | valid_balanced_accuracy: 0.56624 | valid_accuracy: 0.56405 |  0:02:59s
epoch 11 | loss: 0.64884 | train_auc: 0.6444  | train_balanced_accuracy: 0.58216 | train_accuracy: 0.58023 | valid_auc: 0.63405 | valid_balanced_accuracy: 0.57558 | valid_accuracy: 0.57365 |  0:03:17s
epoch 12 | loss: 0.64445 | train_auc: 0.65136 | train_balanced_accuracy: 0.58896 | train_accuracy: 0.58719 | valid_auc: 0.64225 | valid_balanced_accuracy: 0.58546 | valid_accuracy: 0.58373 |  0:03:33s
epoch 13 | loss: 0.6421  | train_auc: 0.66421 | train_balanced_accuracy: 0.59466 | train_accuracy: 0.59297 | valid_auc: 0.65456 | valid_balanced_accuracy: 0.59231 | valid_accuracy: 0.59065 |  0:03:50s
epoch 14 | loss: 0.63829 | train_auc: 0.6741  | train_balanced_accuracy: 0.60396 | train_accuracy: 0.60249 | valid_auc: 0.66377 | valid_balanced_accuracy: 0.60263 | valid_accuracy: 0.6012  |  0:04:07s
epoch 15 | loss: 0.63737 | train_auc: 0.68287 | train_balanced_accuracy: 0.60621 | train_accuracy: 0.6047  | valid_auc: 0.67262 | valid_balanced_accuracy: 0.60112 | valid_accuracy: 0.59962 |  0:04:24s
epoch 16 | loss: 0.63352 | train_auc: 0.68769 | train_balanced_accuracy: 0.61478 | train_accuracy: 0.61351 | valid_auc: 0.67845 | valid_balanced_accuracy: 0.6083  | valid_accuracy: 0.60702 |  0:04:40s
epoch 17 | loss: 0.63113 | train_auc: 0.69064 | train_balanced_accuracy: 0.62213 | train_accuracy: 0.62103 | valid_auc: 0.68296 | valid_balanced_accuracy: 0.61646 | valid_accuracy: 0.61536 |  0:05:01s
epoch 18 | loss: 0.6336  | train_auc: 0.69586 | train_balanced_accuracy: 0.63306 | train_accuracy: 0.6322  | valid_auc: 0.68769 | valid_balanced_accuracy: 0.625   | valid_accuracy: 0.62417 |  0:05:17s
epoch 19 | loss: 0.63027 | train_auc: 0.69845 | train_balanced_accuracy: 0.63633 | train_accuracy: 0.63551 | valid_auc: 0.68983 | valid_balanced_accuracy: 0.62953 | valid_accuracy: 0.62874 |  0:05:33s
epoch 20 | loss: 0.63095 | train_auc: 0.70224 | train_balanced_accuracy: 0.64046 | train_accuracy: 0.63975 | valid_auc: 0.69282 | valid_balanced_accuracy: 0.63023 | valid_accuracy: 0.62952 |  0:05:51s
epoch 21 | loss: 0.62428 | train_auc: 0.7061  | train_balanced_accuracy: 0.64338 | train_accuracy: 0.64278 | valid_auc: 0.69456 | valid_balanced_accuracy: 0.63248 | valid_accuracy: 0.63189 |  0:06:08s
epoch 22 | loss: 0.62612 | train_auc: 0.70942 | train_balanced_accuracy: 0.65064 | train_accuracy: 0.65038 | valid_auc: 0.69817 | valid_balanced_accuracy: 0.64569 | valid_accuracy: 0.64542 |  0:06:26s
epoch 23 | loss: 0.6235  | train_auc: 0.71193 | train_balanced_accuracy: 0.6508  | train_accuracy: 0.65046 | valid_auc: 0.69834 | valid_balanced_accuracy: 0.64418 | valid_accuracy: 0.64385 |  0:06:43s
epoch 24 | loss: 0.62631 | train_auc: 0.71307 | train_balanced_accuracy: 0.65188 | train_accuracy: 0.6516  | valid_auc: 0.70043 | valid_balanced_accuracy: 0.64334 | valid_accuracy: 0.64306 |  0:07:01s
epoch 25 | loss: 0.62178 | train_auc: 0.71655 | train_balanced_accuracy: 0.65817 | train_accuracy: 0.65805 | valid_auc: 0.70268 | valid_balanced_accuracy: 0.65058 | valid_accuracy: 0.65046 |  0:07:19s
epoch 26 | loss: 0.62026 | train_auc: 0.71853 | train_balanced_accuracy: 0.66035 | train_accuracy: 0.66037 | valid_auc: 0.70362 | valid_balanced_accuracy: 0.65235 | valid_accuracy: 0.65234 |  0:07:35s
epoch 27 | loss: 0.6215  | train_auc: 0.72005 | train_balanced_accuracy: 0.6627  | train_accuracy: 0.66269 | valid_auc: 0.70529 | valid_balanced_accuracy: 0.65345 | valid_accuracy: 0.65345 |  0:07:52s
epoch 28 | loss: 0.61813 | train_auc: 0.72228 | train_balanced_accuracy: 0.66314 | train_accuracy: 0.66316 | valid_auc: 0.70619 | valid_balanced_accuracy: 0.65297 | valid_accuracy: 0.65297 |  0:08:08s
epoch 29 | loss: 0.62056 | train_auc: 0.72445 | train_balanced_accuracy: 0.66647 | train_accuracy: 0.66659 | valid_auc: 0.70973 | valid_balanced_accuracy: 0.6576  | valid_accuracy: 0.6577  |  0:08:24s
epoch 30 | loss: 0.61501 | train_auc: 0.72651 | train_balanced_accuracy: 0.6682  | train_accuracy: 0.66836 | valid_auc: 0.71224 | valid_balanced_accuracy: 0.66119 | valid_accuracy: 0.66132 |  0:08:41s
epoch 31 | loss: 0.61848 | train_auc: 0.72846 | train_balanced_accuracy: 0.67047 | train_accuracy: 0.67064 | valid_auc: 0.7148  | valid_balanced_accuracy: 0.66103 | valid_accuracy: 0.66116 |  0:08:58s
epoch 32 | loss: 0.61269 | train_auc: 0.73004 | train_balanced_accuracy: 0.67146 | train_accuracy: 0.6717  | valid_auc: 0.71554 | valid_balanced_accuracy: 0.6592  | valid_accuracy: 0.65943 |  0:09:15s
epoch 33 | loss: 0.61933 | train_auc: 0.73158 | train_balanced_accuracy: 0.67215 | train_accuracy: 0.67241 | valid_auc: 0.71631 | valid_balanced_accuracy: 0.65856 | valid_accuracy: 0.6588  |  0:09:32s
epoch 34 | loss: 0.61455 | train_auc: 0.73444 | train_balanced_accuracy: 0.67366 | train_accuracy: 0.67383 | valid_auc: 0.71839 | valid_balanced_accuracy: 0.66101 | valid_accuracy: 0.66116 |  0:09:49s
epoch 35 | loss: 0.60793 | train_auc: 0.73606 | train_balanced_accuracy: 0.6758  | train_accuracy: 0.67611 | valid_auc: 0.71883 | valid_balanced_accuracy: 0.65707 | valid_accuracy: 0.65738 |  0:10:07s
epoch 36 | loss: 0.6128  | train_auc: 0.73678 | train_balanced_accuracy: 0.67761 | train_accuracy: 0.67792 | valid_auc: 0.71921 | valid_balanced_accuracy: 0.65977 | valid_accuracy: 0.66006 |  0:10:26s
epoch 37 | loss: 0.61189 | train_auc: 0.73544 | train_balanced_accuracy: 0.6743  | train_accuracy: 0.67465 | valid_auc: 0.718   | valid_balanced_accuracy: 0.6608  | valid_accuracy: 0.66116 |  0:10:44s
epoch 38 | loss: 0.60976 | train_auc: 0.73855 | train_balanced_accuracy: 0.67634 | train_accuracy: 0.67646 | valid_auc: 0.72014 | valid_balanced_accuracy: 0.66214 | valid_accuracy: 0.66226 |  0:11:02s
epoch 39 | loss: 0.60362 | train_auc: 0.73927 | train_balanced_accuracy: 0.67674 | train_accuracy: 0.6769  | valid_auc: 0.72136 | valid_balanced_accuracy: 0.66464 | valid_accuracy: 0.66478 |  0:11:20s
epoch 40 | loss: 0.60859 | train_auc: 0.73074 | train_balanced_accuracy: 0.66807 | train_accuracy: 0.668   | valid_auc: 0.71942 | valid_balanced_accuracy: 0.66645 | valid_accuracy: 0.66635 |  0:11:37s
epoch 41 | loss: 0.60798 | train_auc: 0.74011 | train_balanced_accuracy: 0.67766 | train_accuracy: 0.67784 | valid_auc: 0.72434 | valid_balanced_accuracy: 0.66697 | valid_accuracy: 0.66714 |  0:11:53s
epoch 42 | loss: 0.60297 | train_auc: 0.7426  | train_balanced_accuracy: 0.67976 | train_accuracy: 0.67997 | valid_auc: 0.72329 | valid_balanced_accuracy: 0.66379 | valid_accuracy: 0.66399 |  0:12:11s
epoch 43 | loss: 0.60693 | train_auc: 0.7441  | train_balanced_accuracy: 0.68079 | train_accuracy: 0.68091 | valid_auc: 0.72419 | valid_balanced_accuracy: 0.66401 | valid_accuracy: 0.66415 |  0:12:31s
epoch 44 | loss: 0.60849 | train_auc: 0.74526 | train_balanced_accuracy: 0.68257 | train_accuracy: 0.68264 | valid_auc: 0.72394 | valid_balanced_accuracy: 0.66594 | valid_accuracy: 0.66604 |  0:12:48s
epoch 45 | loss: 0.60274 | train_auc: 0.74467 | train_balanced_accuracy: 0.68095 | train_accuracy: 0.68122 | valid_auc: 0.72574 | valid_balanced_accuracy: 0.66608 | valid_accuracy: 0.66635 |  0:13:06s
epoch 46 | loss: 0.60825 | train_auc: 0.74733 | train_balanced_accuracy: 0.68337 | train_accuracy: 0.68362 | valid_auc: 0.725   | valid_balanced_accuracy: 0.66201 | valid_accuracy: 0.66226 |  0:13:23s
epoch 47 | loss: 0.60366 | train_auc: 0.74607 | train_balanced_accuracy: 0.68272 | train_accuracy: 0.68284 | valid_auc: 0.7252  | valid_balanced_accuracy: 0.66719 | valid_accuracy: 0.6673  |  0:13:40s
epoch 48 | loss: 0.60505 | train_auc: 0.74731 | train_balanced_accuracy: 0.68457 | train_accuracy: 0.6848  | valid_auc: 0.72612 | valid_balanced_accuracy: 0.67132 | valid_accuracy: 0.67155 |  0:13:56s
epoch 49 | loss: 0.59967 | train_auc: 0.74654 | train_balanced_accuracy: 0.68255 | train_accuracy: 0.68272 | valid_auc: 0.72645 | valid_balanced_accuracy: 0.66903 | valid_accuracy: 0.66918 |  0:14:12s
epoch 50 | loss: 0.60316 | train_auc: 0.73581 | train_balanced_accuracy: 0.6716  | train_accuracy: 0.67158 | valid_auc: 0.72202 | valid_balanced_accuracy: 0.6667  | valid_accuracy: 0.66667 |  0:14:30s
epoch 51 | loss: 0.59876 | train_auc: 0.71672 | train_balanced_accuracy: 0.65735 | train_accuracy: 0.65734 | valid_auc: 0.71205 | valid_balanced_accuracy: 0.65658 | valid_accuracy: 0.65659 |  0:14:47s
epoch 52 | loss: 0.59511 | train_auc: 0.71591 | train_balanced_accuracy: 0.65626 | train_accuracy: 0.65624 | valid_auc: 0.71157 | valid_balanced_accuracy: 0.65598 | valid_accuracy: 0.65596 |  0:15:05s
epoch 53 | loss: 0.59734 | train_auc: 0.68953 | train_balanced_accuracy: 0.63675 | train_accuracy: 0.637   | valid_auc: 0.69014 | valid_balanced_accuracy: 0.64168 | valid_accuracy: 0.64196 |  0:15:23s
epoch 54 | loss: 0.60055 | train_auc: 0.67457 | train_balanced_accuracy: 0.62927 | train_accuracy: 0.62929 | valid_auc: 0.67608 | valid_balanced_accuracy: 0.62922 | valid_accuracy: 0.62921 |  0:15:40s
epoch 55 | loss: 0.5984  | train_auc: 0.66934 | train_balanced_accuracy: 0.62596 | train_accuracy: 0.6261  | valid_auc: 0.66704 | valid_balanced_accuracy: 0.62481 | valid_accuracy: 0.62496 |  0:15:58s
epoch 56 | loss: 0.59877 | train_auc: 0.65583 | train_balanced_accuracy: 0.61158 | train_accuracy: 0.61178 | valid_auc: 0.65077 | valid_balanced_accuracy: 0.60795 | valid_accuracy: 0.60812 |  0:16:14s
epoch 57 | loss: 0.60076 | train_auc: 0.6597  | train_balanced_accuracy: 0.6169  | train_accuracy: 0.61697 | valid_auc: 0.65608 | valid_balanced_accuracy: 0.61248 | valid_accuracy: 0.61253 |  0:16:31s
epoch 58 | loss: 0.6004  | train_auc: 0.68462 | train_balanced_accuracy: 0.63498 | train_accuracy: 0.63492 | valid_auc: 0.68712 | valid_balanced_accuracy: 0.63686 | valid_accuracy: 0.63676 |  0:16:48s
epoch 59 | loss: 0.59678 | train_auc: 0.71891 | train_balanced_accuracy: 0.65918 | train_accuracy: 0.65911 | valid_auc: 0.71292 | valid_balanced_accuracy: 0.65853 | valid_accuracy: 0.65848 |  0:17:05s
epoch 60 | loss: 0.59714 | train_auc: 0.75262 | train_balanced_accuracy: 0.68666 | train_accuracy: 0.68677 | valid_auc: 0.73493 | valid_balanced_accuracy: 0.67474 | valid_accuracy: 0.67485 |  0:17:23s
epoch 61 | loss: 0.59774 | train_auc: 0.75067 | train_balanced_accuracy: 0.68751 | train_accuracy: 0.6876  | valid_auc: 0.7354  | valid_balanced_accuracy: 0.67758 | valid_accuracy: 0.67768 |  0:17:40s
epoch 62 | loss: 0.59309 | train_auc: 0.74968 | train_balanced_accuracy: 0.68682 | train_accuracy: 0.68709 | valid_auc: 0.73344 | valid_balanced_accuracy: 0.67222 | valid_accuracy: 0.67249 |  0:17:57s
epoch 63 | loss: 0.59445 | train_auc: 0.73138 | train_balanced_accuracy: 0.67479 | train_accuracy: 0.67493 | valid_auc: 0.72205 | valid_balanced_accuracy: 0.66657 | valid_accuracy: 0.66667 |  0:18:15s
epoch 64 | loss: 0.59014 | train_auc: 0.7385  | train_balanced_accuracy: 0.6796  | train_accuracy: 0.67977 | valid_auc: 0.72566 | valid_balanced_accuracy: 0.66588 | valid_accuracy: 0.66604 |  0:18:35s
epoch 65 | loss: 0.59056 | train_auc: 0.75584 | train_balanced_accuracy: 0.69261 | train_accuracy: 0.69275 | valid_auc: 0.73673 | valid_balanced_accuracy: 0.67974 | valid_accuracy: 0.67989 |  0:18:51s
epoch 66 | loss: 0.59491 | train_auc: 0.75985 | train_balanced_accuracy: 0.69293 | train_accuracy: 0.69311 | valid_auc: 0.73522 | valid_balanced_accuracy: 0.67719 | valid_accuracy: 0.67737 |  0:19:09s
epoch 67 | loss: 0.59014 | train_auc: 0.75083 | train_balanced_accuracy: 0.68438 | train_accuracy: 0.68473 | valid_auc: 0.7297  | valid_balanced_accuracy: 0.6734  | valid_accuracy: 0.67375 |  0:19:28s
epoch 68 | loss: 0.59425 | train_auc: 0.7569  | train_balanced_accuracy: 0.69125 | train_accuracy: 0.69141 | valid_auc: 0.73789 | valid_balanced_accuracy: 0.67846 | valid_accuracy: 0.67863 |  0:19:45s
epoch 69 | loss: 0.59369 | train_auc: 0.75318 | train_balanced_accuracy: 0.68855 | train_accuracy: 0.68878 | valid_auc: 0.73485 | valid_balanced_accuracy: 0.67367 | valid_accuracy: 0.67391 |  0:20:01s
epoch 70 | loss: 0.59208 | train_auc: 0.75299 | train_balanced_accuracy: 0.6878  | train_accuracy: 0.68807 | valid_auc: 0.73514 | valid_balanced_accuracy: 0.67427 | valid_accuracy: 0.67454 |  0:20:17s
epoch 71 | loss: 0.59425 | train_auc: 0.75997 | train_balanced_accuracy: 0.69117 | train_accuracy: 0.69141 | valid_auc: 0.7376  | valid_balanced_accuracy: 0.67507 | valid_accuracy: 0.67532 |  0:20:33s
epoch 72 | loss: 0.5937  | train_auc: 0.75874 | train_balanced_accuracy: 0.69164 | train_accuracy: 0.69173 | valid_auc: 0.7372  | valid_balanced_accuracy: 0.67302 | valid_accuracy: 0.67312 |  0:20:50s
epoch 73 | loss: 0.58696 | train_auc: 0.76058 | train_balanced_accuracy: 0.69287 | train_accuracy: 0.69326 | valid_auc: 0.73566 | valid_balanced_accuracy: 0.67432 | valid_accuracy: 0.67469 |  0:21:07s
epoch 74 | loss: 0.59204 | train_auc: 0.75852 | train_balanced_accuracy: 0.69238 | train_accuracy: 0.6926  | valid_auc: 0.73571 | valid_balanced_accuracy: 0.6775  | valid_accuracy: 0.67768 |  0:21:24s
epoch 75 | loss: 0.59364 | train_auc: 0.75911 | train_balanced_accuracy: 0.69222 | train_accuracy: 0.69232 | valid_auc: 0.73531 | valid_balanced_accuracy: 0.67572 | valid_accuracy: 0.67579 |  0:21:41s
epoch 76 | loss: 0.59268 | train_auc: 0.75934 | train_balanced_accuracy: 0.69288 | train_accuracy: 0.69311 | valid_auc: 0.73539 | valid_balanced_accuracy: 0.67684 | valid_accuracy: 0.67705 |  0:21:59s
epoch 77 | loss: 0.58778 | train_auc: 0.75978 | train_balanced_accuracy: 0.69184 | train_accuracy: 0.69212 | valid_auc: 0.735   | valid_balanced_accuracy: 0.67317 | valid_accuracy: 0.67343 |  0:22:16s
epoch 78 | loss: 0.58511 | train_auc: 0.74848 | train_balanced_accuracy: 0.68322 | train_accuracy: 0.68339 | valid_auc: 0.73054 | valid_balanced_accuracy: 0.67467 | valid_accuracy: 0.67485 |  0:22:36s
epoch 79 | loss: 0.58511 | train_auc: 0.7495  | train_balanced_accuracy: 0.68479 | train_accuracy: 0.68512 | valid_auc: 0.73074 | valid_balanced_accuracy: 0.67214 | valid_accuracy: 0.67249 |  0:22:53s
epoch 80 | loss: 0.59156 | train_auc: 0.71013 | train_balanced_accuracy: 0.65042 | train_accuracy: 0.65046 | valid_auc: 0.70563 | valid_balanced_accuracy: 0.65216 | valid_accuracy: 0.65219 |  0:23:09s
epoch 81 | loss: 0.59176 | train_auc: 0.69194 | train_balanced_accuracy: 0.64144 | train_accuracy: 0.64153 | valid_auc: 0.68961 | valid_balanced_accuracy: 0.6361  | valid_accuracy: 0.63613 |  0:23:26s
epoch 82 | loss: 0.58707 | train_auc: 0.71438 | train_balanced_accuracy: 0.65289 | train_accuracy: 0.6529  | valid_auc: 0.70693 | valid_balanced_accuracy: 0.64728 | valid_accuracy: 0.64731 |  0:23:45s
epoch 83 | loss: 0.58941 | train_auc: 0.74008 | train_balanced_accuracy: 0.67445 | train_accuracy: 0.67469 | valid_auc: 0.72662 | valid_balanced_accuracy: 0.6713  | valid_accuracy: 0.67155 |  0:24:03s
epoch 84 | loss: 0.59407 | train_auc: 0.71738 | train_balanced_accuracy: 0.65769 | train_accuracy: 0.65766 | valid_auc: 0.7101  | valid_balanced_accuracy: 0.65694 | valid_accuracy: 0.65691 |  0:24:19s
epoch 85 | loss: 0.59133 | train_auc: 0.70554 | train_balanced_accuracy: 0.65024 | train_accuracy: 0.65034 | valid_auc: 0.7009  | valid_balanced_accuracy: 0.64786 | valid_accuracy: 0.64794 |  0:24:37s

Early stopping occurred at epoch 85 with best_epoch = 65 and best_valid_accuracy = 0.67989
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 63/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.683 total time=24.8min
[CV 4/5; 63/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82984 | train_auc: 0.50147 | train_balanced_accuracy: 0.521   | train_accuracy: 0.51853 | valid_auc: 0.49682 | valid_balanced_accuracy: 0.51731 | valid_accuracy: 0.51479 |  0:00:16s
epoch 1  | loss: 0.73833 | train_auc: 0.52043 | train_balanced_accuracy: 0.51409 | train_accuracy: 0.51137 | valid_auc: 0.52059 | valid_balanced_accuracy: 0.51283 | valid_accuracy: 0.51007 |  0:00:33s
epoch 2  | loss: 0.70154 | train_auc: 0.53281 | train_balanced_accuracy: 0.51504 | train_accuracy: 0.5122  | valid_auc: 0.53528 | valid_balanced_accuracy: 0.51265 | valid_accuracy: 0.50976 |  0:00:49s
epoch 3  | loss: 0.69317 | train_auc: 0.55182 | train_balanced_accuracy: 0.51843 | train_accuracy: 0.51554 | valid_auc: 0.55343 | valid_balanced_accuracy: 0.51817 | valid_accuracy: 0.51527 |  0:01:08s
epoch 4  | loss: 0.68245 | train_auc: 0.56589 | train_balanced_accuracy: 0.52685 | train_accuracy: 0.52408 | valid_auc: 0.56751 | valid_balanced_accuracy: 0.52715 | valid_accuracy: 0.52439 |  0:01:28s
epoch 5  | loss: 0.67545 | train_auc: 0.58357 | train_balanced_accuracy: 0.53447 | train_accuracy: 0.53183 | valid_auc: 0.58143 | valid_balanced_accuracy: 0.53539 | valid_accuracy: 0.53274 |  0:01:44s
epoch 6  | loss: 0.66675 | train_auc: 0.60115 | train_balanced_accuracy: 0.54369 | train_accuracy: 0.54123 | valid_auc: 0.59416 | valid_balanced_accuracy: 0.54074 | valid_accuracy: 0.53824 |  0:02:02s
epoch 7  | loss: 0.66377 | train_auc: 0.61159 | train_balanced_accuracy: 0.55002 | train_accuracy: 0.54753 | valid_auc: 0.60225 | valid_balanced_accuracy: 0.54533 | valid_accuracy: 0.54281 |  0:02:19s
epoch 8  | loss: 0.65849 | train_auc: 0.62162 | train_balanced_accuracy: 0.5636  | train_accuracy: 0.56134 | valid_auc: 0.61063 | valid_balanced_accuracy: 0.55454 | valid_accuracy: 0.55225 |  0:02:37s
epoch 9  | loss: 0.6533  | train_auc: 0.63133 | train_balanced_accuracy: 0.56866 | train_accuracy: 0.56641 | valid_auc: 0.61944 | valid_balanced_accuracy: 0.56235 | valid_accuracy: 0.56012 |  0:02:54s
epoch 10 | loss: 0.64766 | train_auc: 0.64243 | train_balanced_accuracy: 0.58069 | train_accuracy: 0.57877 | valid_auc: 0.62928 | valid_balanced_accuracy: 0.56751 | valid_accuracy: 0.56563 |  0:03:11s
epoch 11 | loss: 0.64922 | train_auc: 0.65096 | train_balanced_accuracy: 0.58918 | train_accuracy: 0.5875  | valid_auc: 0.63642 | valid_balanced_accuracy: 0.57517 | valid_accuracy: 0.5735  |  0:03:29s
epoch 12 | loss: 0.64031 | train_auc: 0.66381 | train_balanced_accuracy: 0.59869 | train_accuracy: 0.59722 | valid_auc: 0.6486  | valid_balanced_accuracy: 0.58221 | valid_accuracy: 0.58074 |  0:03:46s
epoch 13 | loss: 0.64042 | train_auc: 0.66952 | train_balanced_accuracy: 0.60205 | train_accuracy: 0.60053 | valid_auc: 0.65471 | valid_balanced_accuracy: 0.58667 | valid_accuracy: 0.58514 |  0:04:02s
epoch 14 | loss: 0.63736 | train_auc: 0.67607 | train_balanced_accuracy: 0.61162 | train_accuracy: 0.61052 | valid_auc: 0.66054 | valid_balanced_accuracy: 0.59616 | valid_accuracy: 0.59506 |  0:04:20s
epoch 15 | loss: 0.63995 | train_auc: 0.68321 | train_balanced_accuracy: 0.6135  | train_accuracy: 0.61229 | valid_auc: 0.66728 | valid_balanced_accuracy: 0.59863 | valid_accuracy: 0.59742 |  0:04:37s
epoch 16 | loss: 0.63162 | train_auc: 0.68784 | train_balanced_accuracy: 0.62269 | train_accuracy: 0.62166 | valid_auc: 0.67191 | valid_balanced_accuracy: 0.60727 | valid_accuracy: 0.60623 |  0:04:54s
epoch 17 | loss: 0.6257  | train_auc: 0.69011 | train_balanced_accuracy: 0.62623 | train_accuracy: 0.62531 | valid_auc: 0.67499 | valid_balanced_accuracy: 0.61327 | valid_accuracy: 0.61237 |  0:05:13s
epoch 18 | loss: 0.63454 | train_auc: 0.69626 | train_balanced_accuracy: 0.63499 | train_accuracy: 0.63429 | valid_auc: 0.68211 | valid_balanced_accuracy: 0.62076 | valid_accuracy: 0.62008 |  0:05:30s
epoch 19 | loss: 0.62411 | train_auc: 0.70082 | train_balanced_accuracy: 0.64061 | train_accuracy: 0.64007 | valid_auc: 0.68697 | valid_balanced_accuracy: 0.6299  | valid_accuracy: 0.62937 |  0:05:47s
epoch 20 | loss: 0.62452 | train_auc: 0.70452 | train_balanced_accuracy: 0.64384 | train_accuracy: 0.64341 | valid_auc: 0.69109 | valid_balanced_accuracy: 0.63354 | valid_accuracy: 0.63314 |  0:06:07s
epoch 21 | loss: 0.62295 | train_auc: 0.70619 | train_balanced_accuracy: 0.64299 | train_accuracy: 0.64259 | valid_auc: 0.69298 | valid_balanced_accuracy: 0.63604 | valid_accuracy: 0.63566 |  0:06:25s
epoch 22 | loss: 0.62486 | train_auc: 0.71067 | train_balanced_accuracy: 0.65137 | train_accuracy: 0.65128 | valid_auc: 0.69657 | valid_balanced_accuracy: 0.64439 | valid_accuracy: 0.64432 |  0:06:43s
epoch 23 | loss: 0.62014 | train_auc: 0.71354 | train_balanced_accuracy: 0.65271 | train_accuracy: 0.65246 | valid_auc: 0.69841 | valid_balanced_accuracy: 0.64157 | valid_accuracy: 0.64133 |  0:07:00s
epoch 24 | loss: 0.62098 | train_auc: 0.71462 | train_balanced_accuracy: 0.65416 | train_accuracy: 0.65396 | valid_auc: 0.70006 | valid_balanced_accuracy: 0.64372 | valid_accuracy: 0.64353 |  0:07:16s
epoch 25 | loss: 0.61624 | train_auc: 0.71704 | train_balanced_accuracy: 0.65688 | train_accuracy: 0.65683 | valid_auc: 0.70165 | valid_balanced_accuracy: 0.64533 | valid_accuracy: 0.64526 |  0:07:34s
epoch 26 | loss: 0.61484 | train_auc: 0.71962 | train_balanced_accuracy: 0.66157 | train_accuracy: 0.66159 | valid_auc: 0.70394 | valid_balanced_accuracy: 0.64699 | valid_accuracy: 0.64699 |  0:07:53s
epoch 27 | loss: 0.61683 | train_auc: 0.72092 | train_balanced_accuracy: 0.66186 | train_accuracy: 0.66187 | valid_auc: 0.70519 | valid_balanced_accuracy: 0.64809 | valid_accuracy: 0.6481  |  0:08:11s
epoch 28 | loss: 0.61428 | train_auc: 0.72578 | train_balanced_accuracy: 0.66476 | train_accuracy: 0.66478 | valid_auc: 0.70996 | valid_balanced_accuracy: 0.65139 | valid_accuracy: 0.6514  |  0:08:27s
epoch 29 | loss: 0.61266 | train_auc: 0.72561 | train_balanced_accuracy: 0.66501 | train_accuracy: 0.66513 | valid_auc: 0.71066 | valid_balanced_accuracy: 0.65413 | valid_accuracy: 0.65423 |  0:08:45s
epoch 30 | loss: 0.60741 | train_auc: 0.73256 | train_balanced_accuracy: 0.6713  | train_accuracy: 0.67158 | valid_auc: 0.71728 | valid_balanced_accuracy: 0.66119 | valid_accuracy: 0.66147 |  0:09:04s
epoch 31 | loss: 0.60942 | train_auc: 0.73412 | train_balanced_accuracy: 0.67284 | train_accuracy: 0.6732  | valid_auc: 0.7178  | valid_balanced_accuracy: 0.66441 | valid_accuracy: 0.66478 |  0:09:22s
epoch 32 | loss: 0.60606 | train_auc: 0.73174 | train_balanced_accuracy: 0.6704  | train_accuracy: 0.67084 | valid_auc: 0.71839 | valid_balanced_accuracy: 0.66214 | valid_accuracy: 0.66257 |  0:09:38s
epoch 33 | loss: 0.6104  | train_auc: 0.72895 | train_balanced_accuracy: 0.66797 | train_accuracy: 0.6684  | valid_auc: 0.71643 | valid_balanced_accuracy: 0.65869 | valid_accuracy: 0.65911 |  0:09:59s
epoch 34 | loss: 0.60764 | train_auc: 0.7406  | train_balanced_accuracy: 0.67595 | train_accuracy: 0.67631 | valid_auc: 0.72432 | valid_balanced_accuracy: 0.66752 | valid_accuracy: 0.66793 |  0:10:17s
epoch 35 | loss: 0.60299 | train_auc: 0.74178 | train_balanced_accuracy: 0.67756 | train_accuracy: 0.67792 | valid_auc: 0.72458 | valid_balanced_accuracy: 0.67004 | valid_accuracy: 0.67044 |  0:10:35s
epoch 36 | loss: 0.60391 | train_auc: 0.74327 | train_balanced_accuracy: 0.67915 | train_accuracy: 0.67941 | valid_auc: 0.72488 | valid_balanced_accuracy: 0.67061 | valid_accuracy: 0.67092 |  0:10:52s
epoch 37 | loss: 0.6019  | train_auc: 0.74187 | train_balanced_accuracy: 0.67971 | train_accuracy: 0.67993 | valid_auc: 0.72465 | valid_balanced_accuracy: 0.66482 | valid_accuracy: 0.66509 |  0:11:11s
epoch 38 | loss: 0.60401 | train_auc: 0.74549 | train_balanced_accuracy: 0.68186 | train_accuracy: 0.68209 | valid_auc: 0.72682 | valid_balanced_accuracy: 0.67081 | valid_accuracy: 0.67107 |  0:11:29s
epoch 39 | loss: 0.60246 | train_auc: 0.74592 | train_balanced_accuracy: 0.68228 | train_accuracy: 0.68244 | valid_auc: 0.72772 | valid_balanced_accuracy: 0.66961 | valid_accuracy: 0.66981 |  0:11:47s
epoch 40 | loss: 0.60016 | train_auc: 0.7446  | train_balanced_accuracy: 0.68076 | train_accuracy: 0.68095 | valid_auc: 0.72732 | valid_balanced_accuracy: 0.66977 | valid_accuracy: 0.66997 |  0:12:05s
epoch 41 | loss: 0.60328 | train_auc: 0.74006 | train_balanced_accuracy: 0.67815 | train_accuracy: 0.67847 | valid_auc: 0.72268 | valid_balanced_accuracy: 0.66505 | valid_accuracy: 0.66541 |  0:12:21s
epoch 42 | loss: 0.5995  | train_auc: 0.7397  | train_balanced_accuracy: 0.67828 | train_accuracy: 0.67847 | valid_auc: 0.72275 | valid_balanced_accuracy: 0.66472 | valid_accuracy: 0.66494 |  0:12:39s
epoch 43 | loss: 0.60088 | train_auc: 0.74504 | train_balanced_accuracy: 0.68233 | train_accuracy: 0.68252 | valid_auc: 0.72778 | valid_balanced_accuracy: 0.66848 | valid_accuracy: 0.66871 |  0:12:59s
epoch 44 | loss: 0.60146 | train_auc: 0.7447  | train_balanced_accuracy: 0.68216 | train_accuracy: 0.68229 | valid_auc: 0.72755 | valid_balanced_accuracy: 0.66507 | valid_accuracy: 0.66525 |  0:13:17s
epoch 45 | loss: 0.59744 | train_auc: 0.73925 | train_balanced_accuracy: 0.67661 | train_accuracy: 0.67694 | valid_auc: 0.72263 | valid_balanced_accuracy: 0.6641  | valid_accuracy: 0.66446 |  0:13:35s
epoch 46 | loss: 0.60424 | train_auc: 0.74172 | train_balanced_accuracy: 0.67939 | train_accuracy: 0.67965 | valid_auc: 0.72435 | valid_balanced_accuracy: 0.66586 | valid_accuracy: 0.66619 |  0:13:53s
epoch 47 | loss: 0.59656 | train_auc: 0.73322 | train_balanced_accuracy: 0.67182 | train_accuracy: 0.67202 | valid_auc: 0.7211  | valid_balanced_accuracy: 0.66278 | valid_accuracy: 0.66305 |  0:14:11s
epoch 48 | loss: 0.5992  | train_auc: 0.74296 | train_balanced_accuracy: 0.67975 | train_accuracy: 0.68012 | valid_auc: 0.72561 | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.66352 |  0:14:29s
epoch 49 | loss: 0.59771 | train_auc: 0.7407  | train_balanced_accuracy: 0.6769  | train_accuracy: 0.67721 | valid_auc: 0.72349 | valid_balanced_accuracy: 0.66443 | valid_accuracy: 0.66478 |  0:14:47s
epoch 50 | loss: 0.59963 | train_auc: 0.7236  | train_balanced_accuracy: 0.66506 | train_accuracy: 0.66553 | valid_auc: 0.7076  | valid_balanced_accuracy: 0.65764 | valid_accuracy: 0.65817 |  0:15:04s
epoch 51 | loss: 0.59424 | train_auc: 0.68528 | train_balanced_accuracy: 0.62939 | train_accuracy: 0.63027 | valid_auc: 0.67794 | valid_balanced_accuracy: 0.62588 | valid_accuracy: 0.62685 |  0:15:22s
epoch 52 | loss: 0.59139 | train_auc: 0.67104 | train_balanced_accuracy: 0.62193 | train_accuracy: 0.62272 | valid_auc: 0.67066 | valid_balanced_accuracy: 0.6211  | valid_accuracy: 0.62197 |  0:15:41s
epoch 53 | loss: 0.59413 | train_auc: 0.69001 | train_balanced_accuracy: 0.63455 | train_accuracy: 0.63527 | valid_auc: 0.68317 | valid_balanced_accuracy: 0.62953 | valid_accuracy: 0.63031 |  0:16:00s
epoch 54 | loss: 0.59741 | train_auc: 0.6594  | train_balanced_accuracy: 0.61734 | train_accuracy: 0.61788 | valid_auc: 0.65879 | valid_balanced_accuracy: 0.61808 | valid_accuracy: 0.61867 |  0:16:18s
epoch 55 | loss: 0.59411 | train_auc: 0.64628 | train_balanced_accuracy: 0.61075 | train_accuracy: 0.6115  | valid_auc: 0.64116 | valid_balanced_accuracy: 0.61134 | valid_accuracy: 0.61221 |  0:16:37s
epoch 56 | loss: 0.59385 | train_auc: 0.62748 | train_balanced_accuracy: 0.59336 | train_accuracy: 0.59384 | valid_auc: 0.63399 | valid_balanced_accuracy: 0.60329 | valid_accuracy: 0.60387 |  0:16:55s
epoch 57 | loss: 0.59611 | train_auc: 0.63297 | train_balanced_accuracy: 0.60047 | train_accuracy: 0.601   | valid_auc: 0.63437 | valid_balanced_accuracy: 0.60684 | valid_accuracy: 0.60749 |  0:17:12s
epoch 58 | loss: 0.59682 | train_auc: 0.64071 | train_balanced_accuracy: 0.60405 | train_accuracy: 0.60446 | valid_auc: 0.64548 | valid_balanced_accuracy: 0.60852 | valid_accuracy: 0.60907 |  0:17:32s

Early stopping occurred at epoch 58 with best_epoch = 38 and best_valid_accuracy = 0.67107
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 63/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.672 total time=17.7min
[CV 5/5; 63/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.84175 | train_auc: 0.49124 | train_balanced_accuracy: 0.51712 | train_accuracy: 0.51483 | valid_auc: 0.49256 | valid_balanced_accuracy: 0.52017 | valid_accuracy: 0.51778 |  0:00:17s
epoch 1  | loss: 0.75409 | train_auc: 0.49318 | train_balanced_accuracy: 0.51601 | train_accuracy: 0.51353 | valid_auc: 0.49698 | valid_balanced_accuracy: 0.52081 | valid_accuracy: 0.51826 |  0:00:35s
epoch 2  | loss: 0.71658 | train_auc: 0.52152 | train_balanced_accuracy: 0.51379 | train_accuracy: 0.51106 | valid_auc: 0.52562 | valid_balanced_accuracy: 0.5176  | valid_accuracy: 0.51479 |  0:00:53s
epoch 3  | loss: 0.69343 | train_auc: 0.5463  | train_balanced_accuracy: 0.52116 | train_accuracy: 0.51837 | valid_auc: 0.54702 | valid_balanced_accuracy: 0.52678 | valid_accuracy: 0.52392 |  0:01:11s
epoch 4  | loss: 0.67584 | train_auc: 0.56936 | train_balanced_accuracy: 0.53004 | train_accuracy: 0.52742 | valid_auc: 0.56906 | valid_balanced_accuracy: 0.53385 | valid_accuracy: 0.53116 |  0:01:30s
epoch 5  | loss: 0.67003 | train_auc: 0.5936  | train_balanced_accuracy: 0.53416 | train_accuracy: 0.53148 | valid_auc: 0.58963 | valid_balanced_accuracy: 0.54032 | valid_accuracy: 0.53761 |  0:01:47s
epoch 6  | loss: 0.66319 | train_auc: 0.61045 | train_balanced_accuracy: 0.5498  | train_accuracy: 0.54741 | valid_auc: 0.60673 | valid_balanced_accuracy: 0.5553  | valid_accuracy: 0.55288 |  0:02:05s
epoch 7  | loss: 0.65787 | train_auc: 0.62203 | train_balanced_accuracy: 0.56364 | train_accuracy: 0.56138 | valid_auc: 0.61969 | valid_balanced_accuracy: 0.56858 | valid_accuracy: 0.56626 |  0:02:23s
epoch 8  | loss: 0.65265 | train_auc: 0.63353 | train_balanced_accuracy: 0.5765  | train_accuracy: 0.57448 | valid_auc: 0.62948 | valid_balanced_accuracy: 0.57684 | valid_accuracy: 0.57476 |  0:02:41s
epoch 9  | loss: 0.64783 | train_auc: 0.6444  | train_balanced_accuracy: 0.58594 | train_accuracy: 0.58412 | valid_auc: 0.64041 | valid_balanced_accuracy: 0.58372 | valid_accuracy: 0.58184 |  0:02:57s
epoch 10 | loss: 0.64691 | train_auc: 0.65404 | train_balanced_accuracy: 0.60016 | train_accuracy: 0.5986  | valid_auc: 0.65015 | valid_balanced_accuracy: 0.59633 | valid_accuracy: 0.59474 |  0:03:14s
epoch 11 | loss: 0.64133 | train_auc: 0.66158 | train_balanced_accuracy: 0.60634 | train_accuracy: 0.60493 | valid_auc: 0.65685 | valid_balanced_accuracy: 0.59949 | valid_accuracy: 0.59805 |  0:03:31s
epoch 12 | loss: 0.64145 | train_auc: 0.66955 | train_balanced_accuracy: 0.61056 | train_accuracy: 0.60926 | valid_auc: 0.6652  | valid_balanced_accuracy: 0.60397 | valid_accuracy: 0.60261 |  0:03:50s
epoch 13 | loss: 0.64305 | train_auc: 0.67937 | train_balanced_accuracy: 0.6132  | train_accuracy: 0.61202 | valid_auc: 0.6753  | valid_balanced_accuracy: 0.60965 | valid_accuracy: 0.60844 |  0:04:07s
epoch 14 | loss: 0.63297 | train_auc: 0.68831 | train_balanced_accuracy: 0.62431 | train_accuracy: 0.62339 | valid_auc: 0.68314 | valid_balanced_accuracy: 0.61758 | valid_accuracy: 0.61662 |  0:04:24s
epoch 15 | loss: 0.63127 | train_auc: 0.69488 | train_balanced_accuracy: 0.62754 | train_accuracy: 0.62657 | valid_auc: 0.68876 | valid_balanced_accuracy: 0.61982 | valid_accuracy: 0.61882 |  0:04:40s
epoch 16 | loss: 0.63071 | train_auc: 0.70152 | train_balanced_accuracy: 0.63755 | train_accuracy: 0.63688 | valid_auc: 0.69499 | valid_balanced_accuracy: 0.62963 | valid_accuracy: 0.6289  |  0:04:59s
epoch 17 | loss: 0.62982 | train_auc: 0.70349 | train_balanced_accuracy: 0.63881 | train_accuracy: 0.63822 | valid_auc: 0.6963  | valid_balanced_accuracy: 0.63501 | valid_accuracy: 0.6344  |  0:05:17s
epoch 18 | loss: 0.62997 | train_auc: 0.70715 | train_balanced_accuracy: 0.64466 | train_accuracy: 0.64424 | valid_auc: 0.69897 | valid_balanced_accuracy: 0.6416  | valid_accuracy: 0.64117 |  0:05:32s
epoch 19 | loss: 0.62511 | train_auc: 0.70971 | train_balanced_accuracy: 0.64876 | train_accuracy: 0.64845 | valid_auc: 0.70089 | valid_balanced_accuracy: 0.63912 | valid_accuracy: 0.63881 |  0:05:49s
epoch 20 | loss: 0.62183 | train_auc: 0.71221 | train_balanced_accuracy: 0.6557  | train_accuracy: 0.65561 | valid_auc: 0.70357 | valid_balanced_accuracy: 0.64504 | valid_accuracy: 0.64495 |  0:06:05s
epoch 21 | loss: 0.62056 | train_auc: 0.71561 | train_balanced_accuracy: 0.65942 | train_accuracy: 0.65939 | valid_auc: 0.70609 | valid_balanced_accuracy: 0.64781 | valid_accuracy: 0.64778 |  0:06:22s
epoch 22 | loss: 0.61793 | train_auc: 0.71791 | train_balanced_accuracy: 0.6617  | train_accuracy: 0.66191 | valid_auc: 0.70826 | valid_balanced_accuracy: 0.65056 | valid_accuracy: 0.65077 |  0:06:41s
epoch 23 | loss: 0.61695 | train_auc: 0.72008 | train_balanced_accuracy: 0.66291 | train_accuracy: 0.66309 | valid_auc: 0.71057 | valid_balanced_accuracy: 0.65341 | valid_accuracy: 0.6536  |  0:07:01s
epoch 24 | loss: 0.6202  | train_auc: 0.72237 | train_balanced_accuracy: 0.66419 | train_accuracy: 0.6645  | valid_auc: 0.71256 | valid_balanced_accuracy: 0.65594 | valid_accuracy: 0.65628 |  0:07:18s
epoch 25 | loss: 0.61676 | train_auc: 0.72511 | train_balanced_accuracy: 0.66477 | train_accuracy: 0.66501 | valid_auc: 0.7138  | valid_balanced_accuracy: 0.65587 | valid_accuracy: 0.65612 |  0:07:35s
epoch 26 | loss: 0.61597 | train_auc: 0.72673 | train_balanced_accuracy: 0.66621 | train_accuracy: 0.66655 | valid_auc: 0.71502 | valid_balanced_accuracy: 0.65514 | valid_accuracy: 0.65549 |  0:07:52s
epoch 27 | loss: 0.61304 | train_auc: 0.7292  | train_balanced_accuracy: 0.66816 | train_accuracy: 0.66848 | valid_auc: 0.7162  | valid_balanced_accuracy: 0.65848 | valid_accuracy: 0.6588  |  0:08:09s
epoch 28 | loss: 0.61439 | train_auc: 0.72899 | train_balanced_accuracy: 0.66687 | train_accuracy: 0.66706 | valid_auc: 0.71623 | valid_balanced_accuracy: 0.65591 | valid_accuracy: 0.65612 |  0:08:27s
epoch 29 | loss: 0.61424 | train_auc: 0.72871 | train_balanced_accuracy: 0.66603 | train_accuracy: 0.66635 | valid_auc: 0.71661 | valid_balanced_accuracy: 0.65218 | valid_accuracy: 0.6525  |  0:08:43s
epoch 30 | loss: 0.61384 | train_auc: 0.72642 | train_balanced_accuracy: 0.66455 | train_accuracy: 0.66486 | valid_auc: 0.71516 | valid_balanced_accuracy: 0.65642 | valid_accuracy: 0.65675 |  0:09:02s
epoch 31 | loss: 0.60972 | train_auc: 0.72411 | train_balanced_accuracy: 0.66311 | train_accuracy: 0.66328 | valid_auc: 0.7137  | valid_balanced_accuracy: 0.65234 | valid_accuracy: 0.6525  |  0:09:19s
epoch 32 | loss: 0.61348 | train_auc: 0.72123 | train_balanced_accuracy: 0.66205 | train_accuracy: 0.66222 | valid_auc: 0.71286 | valid_balanced_accuracy: 0.65405 | valid_accuracy: 0.65423 |  0:09:36s
epoch 33 | loss: 0.615   | train_auc: 0.72666 | train_balanced_accuracy: 0.66564 | train_accuracy: 0.66588 | valid_auc: 0.71546 | valid_balanced_accuracy: 0.65495 | valid_accuracy: 0.65518 |  0:09:52s
epoch 34 | loss: 0.60687 | train_auc: 0.71073 | train_balanced_accuracy: 0.65553 | train_accuracy: 0.65577 | valid_auc: 0.70839 | valid_balanced_accuracy: 0.65228 | valid_accuracy: 0.6525  |  0:10:09s
epoch 35 | loss: 0.61096 | train_auc: 0.71641 | train_balanced_accuracy: 0.65948 | train_accuracy: 0.65978 | valid_auc: 0.71112 | valid_balanced_accuracy: 0.65538 | valid_accuracy: 0.65565 |  0:10:28s
epoch 36 | loss: 0.60562 | train_auc: 0.7182  | train_balanced_accuracy: 0.66001 | train_accuracy: 0.66029 | valid_auc: 0.71118 | valid_balanced_accuracy: 0.65399 | valid_accuracy: 0.65423 |  0:10:47s
epoch 37 | loss: 0.60712 | train_auc: 0.72501 | train_balanced_accuracy: 0.66654 | train_accuracy: 0.66678 | valid_auc: 0.71556 | valid_balanced_accuracy: 0.65809 | valid_accuracy: 0.65833 |  0:11:04s
epoch 38 | loss: 0.60802 | train_auc: 0.72169 | train_balanced_accuracy: 0.66309 | train_accuracy: 0.66328 | valid_auc: 0.71591 | valid_balanced_accuracy: 0.65655 | valid_accuracy: 0.65675 |  0:11:21s
epoch 39 | loss: 0.60718 | train_auc: 0.72066 | train_balanced_accuracy: 0.66295 | train_accuracy: 0.66309 | valid_auc: 0.7135  | valid_balanced_accuracy: 0.65474 | valid_accuracy: 0.65486 |  0:11:37s
epoch 40 | loss: 0.60614 | train_auc: 0.71936 | train_balanced_accuracy: 0.662   | train_accuracy: 0.66222 | valid_auc: 0.71109 | valid_balanced_accuracy: 0.64929 | valid_accuracy: 0.64951 |  0:11:56s
epoch 41 | loss: 0.60611 | train_auc: 0.71964 | train_balanced_accuracy: 0.66267 | train_accuracy: 0.66293 | valid_auc: 0.711   | valid_balanced_accuracy: 0.65083 | valid_accuracy: 0.65109 |  0:12:13s
epoch 42 | loss: 0.60757 | train_auc: 0.72142 | train_balanced_accuracy: 0.66137 | train_accuracy: 0.66151 | valid_auc: 0.71442 | valid_balanced_accuracy: 0.65092 | valid_accuracy: 0.65109 |  0:12:30s
epoch 43 | loss: 0.60273 | train_auc: 0.7446  | train_balanced_accuracy: 0.68069 | train_accuracy: 0.68103 | valid_auc: 0.72861 | valid_balanced_accuracy: 0.66966 | valid_accuracy: 0.66997 |  0:12:48s
epoch 44 | loss: 0.60249 | train_auc: 0.73817 | train_balanced_accuracy: 0.67713 | train_accuracy: 0.67749 | valid_auc: 0.72522 | valid_balanced_accuracy: 0.66367 | valid_accuracy: 0.66399 |  0:13:05s
epoch 45 | loss: 0.60226 | train_auc: 0.72883 | train_balanced_accuracy: 0.66842 | train_accuracy: 0.66891 | valid_auc: 0.71573 | valid_balanced_accuracy: 0.65723 | valid_accuracy: 0.6577  |  0:13:25s
epoch 46 | loss: 0.60561 | train_auc: 0.72894 | train_balanced_accuracy: 0.6704  | train_accuracy: 0.6708  | valid_auc: 0.71607 | valid_balanced_accuracy: 0.65873 | valid_accuracy: 0.65911 |  0:13:42s
epoch 47 | loss: 0.60543 | train_auc: 0.72889 | train_balanced_accuracy: 0.67016 | train_accuracy: 0.67052 | valid_auc: 0.71707 | valid_balanced_accuracy: 0.65844 | valid_accuracy: 0.6588  |  0:14:01s
epoch 48 | loss: 0.60319 | train_auc: 0.72844 | train_balanced_accuracy: 0.66989 | train_accuracy: 0.6704  | valid_auc: 0.71569 | valid_balanced_accuracy: 0.65768 | valid_accuracy: 0.65817 |  0:14:18s
epoch 49 | loss: 0.5999  | train_auc: 0.73918 | train_balanced_accuracy: 0.6787  | train_accuracy: 0.67898 | valid_auc: 0.72718 | valid_balanced_accuracy: 0.66292 | valid_accuracy: 0.6632  |  0:14:36s
epoch 50 | loss: 0.59878 | train_auc: 0.73326 | train_balanced_accuracy: 0.67291 | train_accuracy: 0.67324 | valid_auc: 0.72003 | valid_balanced_accuracy: 0.65942 | valid_accuracy: 0.65974 |  0:14:54s
epoch 51 | loss: 0.60235 | train_auc: 0.7223  | train_balanced_accuracy: 0.66459 | train_accuracy: 0.66505 | valid_auc: 0.71126 | valid_balanced_accuracy: 0.65144 | valid_accuracy: 0.65187 |  0:15:11s
epoch 52 | loss: 0.60056 | train_auc: 0.72288 | train_balanced_accuracy: 0.66512 | train_accuracy: 0.6656  | valid_auc: 0.71182 | valid_balanced_accuracy: 0.65348 | valid_accuracy: 0.65392 |  0:15:29s
epoch 53 | loss: 0.60444 | train_auc: 0.72645 | train_balanced_accuracy: 0.6695  | train_accuracy: 0.66997 | valid_auc: 0.71408 | valid_balanced_accuracy: 0.65585 | valid_accuracy: 0.65628 |  0:15:45s
epoch 54 | loss: 0.60548 | train_auc: 0.73141 | train_balanced_accuracy: 0.67198 | train_accuracy: 0.67237 | valid_auc: 0.71759 | valid_balanced_accuracy: 0.65921 | valid_accuracy: 0.65958 |  0:16:02s
epoch 55 | loss: 0.60436 | train_auc: 0.73829 | train_balanced_accuracy: 0.6775  | train_accuracy: 0.67784 | valid_auc: 0.72425 | valid_balanced_accuracy: 0.66115 | valid_accuracy: 0.66147 |  0:16:20s
epoch 56 | loss: 0.6034  | train_auc: 0.74583 | train_balanced_accuracy: 0.68374 | train_accuracy: 0.68414 | valid_auc: 0.7313  | valid_balanced_accuracy: 0.66913 | valid_accuracy: 0.6695  |  0:16:38s
epoch 57 | loss: 0.5973  | train_auc: 0.75161 | train_balanced_accuracy: 0.68722 | train_accuracy: 0.68748 | valid_auc: 0.73519 | valid_balanced_accuracy: 0.67523 | valid_accuracy: 0.67548 |  0:16:54s
epoch 58 | loss: 0.59796 | train_auc: 0.74954 | train_balanced_accuracy: 0.68592 | train_accuracy: 0.6861  | valid_auc: 0.73386 | valid_balanced_accuracy: 0.66952 | valid_accuracy: 0.66966 |  0:17:12s
epoch 59 | loss: 0.60234 | train_auc: 0.75294 | train_balanced_accuracy: 0.68627 | train_accuracy: 0.68654 | valid_auc: 0.73594 | valid_balanced_accuracy: 0.6724  | valid_accuracy: 0.67265 |  0:17:28s
epoch 60 | loss: 0.6003  | train_auc: 0.75304 | train_balanced_accuracy: 0.68649 | train_accuracy: 0.68669 | valid_auc: 0.73726 | valid_balanced_accuracy: 0.67138 | valid_accuracy: 0.67155 |  0:17:47s
epoch 61 | loss: 0.6044  | train_auc: 0.75329 | train_balanced_accuracy: 0.68807 | train_accuracy: 0.68819 | valid_auc: 0.73755 | valid_balanced_accuracy: 0.67142 | valid_accuracy: 0.67155 |  0:18:05s
epoch 62 | loss: 0.59423 | train_auc: 0.74283 | train_balanced_accuracy: 0.67766 | train_accuracy: 0.678   | valid_auc: 0.7307  | valid_balanced_accuracy: 0.66557 | valid_accuracy: 0.66588 |  0:18:21s
epoch 63 | loss: 0.59783 | train_auc: 0.74282 | train_balanced_accuracy: 0.67908 | train_accuracy: 0.67938 | valid_auc: 0.73037 | valid_balanced_accuracy: 0.66418 | valid_accuracy: 0.66446 |  0:18:37s
epoch 64 | loss: 0.59452 | train_auc: 0.74613 | train_balanced_accuracy: 0.68155 | train_accuracy: 0.68185 | valid_auc: 0.73307 | valid_balanced_accuracy: 0.66848 | valid_accuracy: 0.66871 |  0:18:54s
epoch 65 | loss: 0.60463 | train_auc: 0.74738 | train_balanced_accuracy: 0.68471 | train_accuracy: 0.68484 | valid_auc: 0.7333  | valid_balanced_accuracy: 0.66781 | valid_accuracy: 0.66793 |  0:19:11s
epoch 66 | loss: 0.59613 | train_auc: 0.75072 | train_balanced_accuracy: 0.68764 | train_accuracy: 0.68787 | valid_auc: 0.73383 | valid_balanced_accuracy: 0.66927 | valid_accuracy: 0.6695  |  0:19:30s
epoch 67 | loss: 0.59702 | train_auc: 0.74862 | train_balanced_accuracy: 0.68346 | train_accuracy: 0.6839  | valid_auc: 0.73361 | valid_balanced_accuracy: 0.66737 | valid_accuracy: 0.66777 |  0:19:47s
epoch 68 | loss: 0.59631 | train_auc: 0.74232 | train_balanced_accuracy: 0.67876 | train_accuracy: 0.67902 | valid_auc: 0.72834 | valid_balanced_accuracy: 0.66263 | valid_accuracy: 0.66289 |  0:20:05s
epoch 69 | loss: 0.59611 | train_auc: 0.7566  | train_balanced_accuracy: 0.6905  | train_accuracy: 0.69082 | valid_auc: 0.7391  | valid_balanced_accuracy: 0.67423 | valid_accuracy: 0.67454 |  0:20:22s
epoch 70 | loss: 0.59546 | train_auc: 0.75709 | train_balanced_accuracy: 0.69264 | train_accuracy: 0.69291 | valid_auc: 0.73854 | valid_balanced_accuracy: 0.67336 | valid_accuracy: 0.67359 |  0:20:40s
epoch 71 | loss: 0.59723 | train_auc: 0.7559  | train_balanced_accuracy: 0.69051 | train_accuracy: 0.69086 | valid_auc: 0.73735 | valid_balanced_accuracy: 0.67013 | valid_accuracy: 0.67044 |  0:20:58s
epoch 72 | loss: 0.59299 | train_auc: 0.75837 | train_balanced_accuracy: 0.69322 | train_accuracy: 0.69346 | valid_auc: 0.73731 | valid_balanced_accuracy: 0.67259 | valid_accuracy: 0.6728  |  0:21:15s
epoch 73 | loss: 0.59217 | train_auc: 0.75738 | train_balanced_accuracy: 0.69219 | train_accuracy: 0.69248 | valid_auc: 0.73679 | valid_balanced_accuracy: 0.67382 | valid_accuracy: 0.67406 |  0:21:35s
epoch 74 | loss: 0.59302 | train_auc: 0.75893 | train_balanced_accuracy: 0.6921  | train_accuracy: 0.69228 | valid_auc: 0.739   | valid_balanced_accuracy: 0.67657 | valid_accuracy: 0.67674 |  0:21:52s
epoch 75 | loss: 0.59123 | train_auc: 0.75971 | train_balanced_accuracy: 0.69157 | train_accuracy: 0.69173 | valid_auc: 0.74098 | valid_balanced_accuracy: 0.67659 | valid_accuracy: 0.67674 |  0:22:09s
epoch 76 | loss: 0.59155 | train_auc: 0.75804 | train_balanced_accuracy: 0.69047 | train_accuracy: 0.69075 | valid_auc: 0.7401  | valid_balanced_accuracy: 0.67663 | valid_accuracy: 0.6769  |  0:22:26s
epoch 77 | loss: 0.59079 | train_auc: 0.74677 | train_balanced_accuracy: 0.68378 | train_accuracy: 0.6841  | valid_auc: 0.73233 | valid_balanced_accuracy: 0.66948 | valid_accuracy: 0.66981 |  0:22:42s
epoch 78 | loss: 0.58992 | train_auc: 0.73405 | train_balanced_accuracy: 0.67087 | train_accuracy: 0.67111 | valid_auc: 0.7235  | valid_balanced_accuracy: 0.66279 | valid_accuracy: 0.66305 |  0:23:00s
epoch 79 | loss: 0.59063 | train_auc: 0.75573 | train_balanced_accuracy: 0.68946 | train_accuracy: 0.68976 | valid_auc: 0.73864 | valid_balanced_accuracy: 0.6738  | valid_accuracy: 0.67406 |  0:23:16s
epoch 80 | loss: 0.59382 | train_auc: 0.75028 | train_balanced_accuracy: 0.68417 | train_accuracy: 0.68465 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.66734 | valid_accuracy: 0.66777 |  0:23:33s
epoch 81 | loss: 0.58793 | train_auc: 0.75505 | train_balanced_accuracy: 0.68895 | train_accuracy: 0.68913 | valid_auc: 0.73643 | valid_balanced_accuracy: 0.67453 | valid_accuracy: 0.67469 |  0:23:49s
epoch 82 | loss: 0.59098 | train_auc: 0.76184 | train_balanced_accuracy: 0.69461 | train_accuracy: 0.69484 | valid_auc: 0.73978 | valid_balanced_accuracy: 0.67716 | valid_accuracy: 0.67737 |  0:24:05s
epoch 83 | loss: 0.58836 | train_auc: 0.76264 | train_balanced_accuracy: 0.69563 | train_accuracy: 0.69594 | valid_auc: 0.73989 | valid_balanced_accuracy: 0.67819 | valid_accuracy: 0.67847 |  0:24:20s
epoch 84 | loss: 0.59088 | train_auc: 0.75423 | train_balanced_accuracy: 0.68809 | train_accuracy: 0.68846 | valid_auc: 0.73421 | valid_balanced_accuracy: 0.67042 | valid_accuracy: 0.67076 |  0:24:39s
epoch 85 | loss: 0.59436 | train_auc: 0.76174 | train_balanced_accuracy: 0.69454 | train_accuracy: 0.69488 | valid_auc: 0.73846 | valid_balanced_accuracy: 0.67675 | valid_accuracy: 0.67705 |  0:24:57s
epoch 86 | loss: 0.58835 | train_auc: 0.75994 | train_balanced_accuracy: 0.69266 | train_accuracy: 0.69307 | valid_auc: 0.73785 | valid_balanced_accuracy: 0.67449 | valid_accuracy: 0.67485 |  0:25:16s
epoch 87 | loss: 0.58709 | train_auc: 0.76285 | train_balanced_accuracy: 0.69653 | train_accuracy: 0.69681 | valid_auc: 0.73904 | valid_balanced_accuracy: 0.67572 | valid_accuracy: 0.67595 |  0:25:34s
epoch 88 | loss: 0.59013 | train_auc: 0.76045 | train_balanced_accuracy: 0.6925  | train_accuracy: 0.69291 | valid_auc: 0.73663 | valid_balanced_accuracy: 0.67433 | valid_accuracy: 0.67469 |  0:25:51s
epoch 89 | loss: 0.58878 | train_auc: 0.75087 | train_balanced_accuracy: 0.68301 | train_accuracy: 0.68355 | valid_auc: 0.73107 | valid_balanced_accuracy: 0.66917 | valid_accuracy: 0.66966 |  0:26:09s
epoch 90 | loss: 0.58553 | train_auc: 0.75978 | train_balanced_accuracy: 0.69177 | train_accuracy: 0.6922  | valid_auc: 0.73867 | valid_balanced_accuracy: 0.673   | valid_accuracy: 0.67343 |  0:26:27s
epoch 91 | loss: 0.58829 | train_auc: 0.75981 | train_balanced_accuracy: 0.69245 | train_accuracy: 0.69256 | valid_auc: 0.74257 | valid_balanced_accuracy: 0.67647 | valid_accuracy: 0.67658 |  0:26:45s
epoch 92 | loss: 0.58346 | train_auc: 0.75605 | train_balanced_accuracy: 0.68854 | train_accuracy: 0.68862 | valid_auc: 0.73999 | valid_balanced_accuracy: 0.6721  | valid_accuracy: 0.67218 |  0:27:03s
epoch 93 | loss: 0.58979 | train_auc: 0.74507 | train_balanced_accuracy: 0.67853 | train_accuracy: 0.67867 | valid_auc: 0.73269 | valid_balanced_accuracy: 0.66198 | valid_accuracy: 0.6621  |  0:27:20s
epoch 94 | loss: 0.58901 | train_auc: 0.73909 | train_balanced_accuracy: 0.67331 | train_accuracy: 0.67347 | valid_auc: 0.72615 | valid_balanced_accuracy: 0.66321 | valid_accuracy: 0.66336 |  0:27:37s
epoch 95 | loss: 0.58258 | train_auc: 0.76163 | train_balanced_accuracy: 0.69411 | train_accuracy: 0.69421 | valid_auc: 0.74013 | valid_balanced_accuracy: 0.67382 | valid_accuracy: 0.67391 |  0:27:53s
epoch 96 | loss: 0.58588 | train_auc: 0.76716 | train_balanced_accuracy: 0.69943 | train_accuracy: 0.69956 | valid_auc: 0.74272 | valid_balanced_accuracy: 0.67885 | valid_accuracy: 0.67894 |  0:28:12s
epoch 97 | loss: 0.58735 | train_auc: 0.7647  | train_balanced_accuracy: 0.69593 | train_accuracy: 0.69606 | valid_auc: 0.7413  | valid_balanced_accuracy: 0.6782  | valid_accuracy: 0.67831 |  0:28:27s
epoch 98 | loss: 0.58816 | train_auc: 0.764   | train_balanced_accuracy: 0.69537 | train_accuracy: 0.69547 | valid_auc: 0.74017 | valid_balanced_accuracy: 0.67891 | valid_accuracy: 0.67894 |  0:28:44s
epoch 99 | loss: 0.58694 | train_auc: 0.74988 | train_balanced_accuracy: 0.68481 | train_accuracy: 0.68516 | valid_auc: 0.73078 | valid_balanced_accuracy: 0.66794 | valid_accuracy: 0.66824 |  0:29:02s
epoch 100| loss: 0.58377 | train_auc: 0.74956 | train_balanced_accuracy: 0.68406 | train_accuracy: 0.68429 | valid_auc: 0.73126 | valid_balanced_accuracy: 0.67197 | valid_accuracy: 0.67218 |  0:29:19s
epoch 101| loss: 0.59128 | train_auc: 0.76036 | train_balanced_accuracy: 0.69357 | train_accuracy: 0.69381 | valid_auc: 0.73868 | valid_balanced_accuracy: 0.67528 | valid_accuracy: 0.67548 |  0:29:36s
epoch 102| loss: 0.58438 | train_auc: 0.76323 | train_balanced_accuracy: 0.69458 | train_accuracy: 0.69488 | valid_auc: 0.74055 | valid_balanced_accuracy: 0.67729 | valid_accuracy: 0.67753 |  0:29:53s
epoch 103| loss: 0.58351 | train_auc: 0.76041 | train_balanced_accuracy: 0.69225 | train_accuracy: 0.6926  | valid_auc: 0.73963 | valid_balanced_accuracy: 0.67768 | valid_accuracy: 0.678   |  0:30:11s
epoch 104| loss: 0.58125 | train_auc: 0.77042 | train_balanced_accuracy: 0.70312 | train_accuracy: 0.70326 | valid_auc: 0.74315 | valid_balanced_accuracy: 0.67996 | valid_accuracy: 0.68004 |  0:30:28s
epoch 105| loss: 0.58679 | train_auc: 0.77061 | train_balanced_accuracy: 0.7025  | train_accuracy: 0.70275 | valid_auc: 0.74293 | valid_balanced_accuracy: 0.6833  | valid_accuracy: 0.68351 |  0:30:47s
epoch 106| loss: 0.58201 | train_auc: 0.7707  | train_balanced_accuracy: 0.70216 | train_accuracy: 0.70239 | valid_auc: 0.74339 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.6854  |  0:31:05s
epoch 107| loss: 0.5824  | train_auc: 0.77125 | train_balanced_accuracy: 0.70189 | train_accuracy: 0.70212 | valid_auc: 0.74445 | valid_balanced_accuracy: 0.68332 | valid_accuracy: 0.68351 |  0:31:22s
epoch 108| loss: 0.58543 | train_auc: 0.77092 | train_balanced_accuracy: 0.70132 | train_accuracy: 0.70141 | valid_auc: 0.7434  | valid_balanced_accuracy: 0.67982 | valid_accuracy: 0.67989 |  0:31:41s
epoch 109| loss: 0.582   | train_auc: 0.7678  | train_balanced_accuracy: 0.70052 | train_accuracy: 0.70054 | valid_auc: 0.74293 | valid_balanced_accuracy: 0.67813 | valid_accuracy: 0.67816 |  0:31:58s
epoch 110| loss: 0.58421 | train_auc: 0.76444 | train_balanced_accuracy: 0.69456 | train_accuracy: 0.69472 | valid_auc: 0.74277 | valid_balanced_accuracy: 0.67895 | valid_accuracy: 0.6791  |  0:32:16s
epoch 111| loss: 0.57777 | train_auc: 0.76231 | train_balanced_accuracy: 0.69363 | train_accuracy: 0.69374 | valid_auc: 0.74127 | valid_balanced_accuracy: 0.67884 | valid_accuracy: 0.67894 |  0:32:36s
epoch 112| loss: 0.58344 | train_auc: 0.76621 | train_balanced_accuracy: 0.69768 | train_accuracy: 0.69787 | valid_auc: 0.74184 | valid_balanced_accuracy: 0.6742  | valid_accuracy: 0.67438 |  0:32:55s
epoch 113| loss: 0.58702 | train_auc: 0.76559 | train_balanced_accuracy: 0.69651 | train_accuracy: 0.69665 | valid_auc: 0.74253 | valid_balanced_accuracy: 0.67648 | valid_accuracy: 0.67658 |  0:33:13s
epoch 114| loss: 0.57987 | train_auc: 0.75944 | train_balanced_accuracy: 0.69011 | train_accuracy: 0.69031 | valid_auc: 0.74121 | valid_balanced_accuracy: 0.67133 | valid_accuracy: 0.67155 |  0:33:30s
epoch 115| loss: 0.58159 | train_auc: 0.77395 | train_balanced_accuracy: 0.70362 | train_accuracy: 0.70385 | valid_auc: 0.74348 | valid_balanced_accuracy: 0.67702 | valid_accuracy: 0.67721 |  0:33:48s
epoch 116| loss: 0.58122 | train_auc: 0.76524 | train_balanced_accuracy: 0.69752 | train_accuracy: 0.69787 | valid_auc: 0.73797 | valid_balanced_accuracy: 0.67219 | valid_accuracy: 0.67249 |  0:34:06s
epoch 117| loss: 0.58252 | train_auc: 0.77597 | train_balanced_accuracy: 0.70601 | train_accuracy: 0.70621 | valid_auc: 0.74528 | valid_balanced_accuracy: 0.68163 | valid_accuracy: 0.68178 |  0:34:25s
epoch 118| loss: 0.58307 | train_auc: 0.7733  | train_balanced_accuracy: 0.70465 | train_accuracy: 0.70483 | valid_auc: 0.74404 | valid_balanced_accuracy: 0.67643 | valid_accuracy: 0.67658 |  0:34:42s
epoch 119| loss: 0.58509 | train_auc: 0.7651  | train_balanced_accuracy: 0.69658 | train_accuracy: 0.69684 | valid_auc: 0.74028 | valid_balanced_accuracy: 0.67492 | valid_accuracy: 0.67517 |  0:35:00s
epoch 120| loss: 0.57681 | train_auc: 0.76694 | train_balanced_accuracy: 0.69956 | train_accuracy: 0.6998  | valid_auc: 0.74235 | valid_balanced_accuracy: 0.67636 | valid_accuracy: 0.67658 |  0:35:20s
epoch 121| loss: 0.58375 | train_auc: 0.77532 | train_balanced_accuracy: 0.70519 | train_accuracy: 0.70546 | valid_auc: 0.74391 | valid_balanced_accuracy: 0.68124 | valid_accuracy: 0.68146 |  0:35:36s
epoch 122| loss: 0.57191 | train_auc: 0.76427 | train_balanced_accuracy: 0.69544 | train_accuracy: 0.69582 | valid_auc: 0.73881 | valid_balanced_accuracy: 0.6797  | valid_accuracy: 0.68004 |  0:35:53s
epoch 123| loss: 0.58158 | train_auc: 0.76984 | train_balanced_accuracy: 0.70137 | train_accuracy: 0.70168 | valid_auc: 0.74097 | valid_balanced_accuracy: 0.67743 | valid_accuracy: 0.67768 |  0:36:12s
epoch 124| loss: 0.57869 | train_auc: 0.77377 | train_balanced_accuracy: 0.70484 | train_accuracy: 0.70507 | valid_auc: 0.74504 | valid_balanced_accuracy: 0.68302 | valid_accuracy: 0.68319 |  0:36:29s
epoch 125| loss: 0.58091 | train_auc: 0.77729 | train_balanced_accuracy: 0.7083  | train_accuracy: 0.70845 | valid_auc: 0.74685 | valid_balanced_accuracy: 0.68544 | valid_accuracy: 0.68555 |  0:36:46s
epoch 126| loss: 0.5831  | train_auc: 0.77673 | train_balanced_accuracy: 0.70737 | train_accuracy: 0.70763 | valid_auc: 0.745   | valid_balanced_accuracy: 0.68046 | valid_accuracy: 0.68067 |  0:37:02s
epoch 127| loss: 0.57807 | train_auc: 0.76761 | train_balanced_accuracy: 0.69713 | train_accuracy: 0.69751 | valid_auc: 0.74071 | valid_balanced_accuracy: 0.67226 | valid_accuracy: 0.67265 |  0:37:18s
epoch 128| loss: 0.57718 | train_auc: 0.7535  | train_balanced_accuracy: 0.68583 | train_accuracy: 0.6863  | valid_auc: 0.73315 | valid_balanced_accuracy: 0.66999 | valid_accuracy: 0.67044 |  0:37:36s
epoch 129| loss: 0.58017 | train_auc: 0.75558 | train_balanced_accuracy: 0.68878 | train_accuracy: 0.68909 | valid_auc: 0.73541 | valid_balanced_accuracy: 0.6681  | valid_accuracy: 0.6684  |  0:37:55s
epoch 130| loss: 0.58112 | train_auc: 0.75388 | train_balanced_accuracy: 0.68669 | train_accuracy: 0.68693 | valid_auc: 0.73404 | valid_balanced_accuracy: 0.66771 | valid_accuracy: 0.66793 |  0:38:12s
epoch 131| loss: 0.58048 | train_auc: 0.75792 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.6885  | valid_auc: 0.73778 | valid_balanced_accuracy: 0.66815 | valid_accuracy: 0.66824 |  0:38:30s
epoch 132| loss: 0.57611 | train_auc: 0.75928 | train_balanced_accuracy: 0.69033 | train_accuracy: 0.69051 | valid_auc: 0.7386  | valid_balanced_accuracy: 0.67247 | valid_accuracy: 0.67265 |  0:38:46s
epoch 133| loss: 0.57821 | train_auc: 0.76882 | train_balanced_accuracy: 0.70038 | train_accuracy: 0.70046 | valid_auc: 0.74163 | valid_balanced_accuracy: 0.68126 | valid_accuracy: 0.6813  |  0:39:07s
epoch 134| loss: 0.57533 | train_auc: 0.76186 | train_balanced_accuracy: 0.69544 | train_accuracy: 0.69551 | valid_auc: 0.73905 | valid_balanced_accuracy: 0.68129 | valid_accuracy: 0.6813  |  0:39:24s
epoch 135| loss: 0.58055 | train_auc: 0.76976 | train_balanced_accuracy: 0.70186 | train_accuracy: 0.70192 | valid_auc: 0.74368 | valid_balanced_accuracy: 0.68459 | valid_accuracy: 0.68461 |  0:39:44s
epoch 136| loss: 0.57605 | train_auc: 0.77553 | train_balanced_accuracy: 0.70556 | train_accuracy: 0.70558 | valid_auc: 0.74571 | valid_balanced_accuracy: 0.68338 | valid_accuracy: 0.68335 |  0:40:03s
epoch 137| loss: 0.57331 | train_auc: 0.77575 | train_balanced_accuracy: 0.70521 | train_accuracy: 0.7053  | valid_auc: 0.74522 | valid_balanced_accuracy: 0.68094 | valid_accuracy: 0.68099 |  0:40:19s
epoch 138| loss: 0.57645 | train_auc: 0.77863 | train_balanced_accuracy: 0.70766 | train_accuracy: 0.7079  | valid_auc: 0.74694 | valid_balanced_accuracy: 0.67827 | valid_accuracy: 0.67847 |  0:40:37s
epoch 139| loss: 0.57608 | train_auc: 0.77795 | train_balanced_accuracy: 0.70741 | train_accuracy: 0.70763 | valid_auc: 0.74573 | valid_balanced_accuracy: 0.67876 | valid_accuracy: 0.67894 |  0:40:53s
epoch 140| loss: 0.57735 | train_auc: 0.77673 | train_balanced_accuracy: 0.70623 | train_accuracy: 0.70656 | valid_auc: 0.74491 | valid_balanced_accuracy: 0.67896 | valid_accuracy: 0.67926 |  0:41:09s
epoch 141| loss: 0.57798 | train_auc: 0.7796  | train_balanced_accuracy: 0.70802 | train_accuracy: 0.70822 | valid_auc: 0.74561 | valid_balanced_accuracy: 0.6805  | valid_accuracy: 0.68067 |  0:41:25s
epoch 142| loss: 0.57419 | train_auc: 0.78146 | train_balanced_accuracy: 0.71035 | train_accuracy: 0.71042 | valid_auc: 0.74709 | valid_balanced_accuracy: 0.68109 | valid_accuracy: 0.68115 |  0:41:41s
epoch 143| loss: 0.56768 | train_auc: 0.78133 | train_balanced_accuracy: 0.71003 | train_accuracy: 0.7103  | valid_auc: 0.74645 | valid_balanced_accuracy: 0.68217 | valid_accuracy: 0.6824  |  0:41:56s
epoch 144| loss: 0.57355 | train_auc: 0.7792  | train_balanced_accuracy: 0.70886 | train_accuracy: 0.7092  | valid_auc: 0.74386 | valid_balanced_accuracy: 0.67817 | valid_accuracy: 0.67847 |  0:42:13s
epoch 145| loss: 0.57305 | train_auc: 0.77823 | train_balanced_accuracy: 0.70748 | train_accuracy: 0.70763 | valid_auc: 0.74372 | valid_balanced_accuracy: 0.67772 | valid_accuracy: 0.67784 |  0:42:31s

Early stopping occurred at epoch 145 with best_epoch = 125 and best_valid_accuracy = 0.68555
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 63/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.01, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.684 total time=42.7min
[CV 1/5; 64/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68567 | train_auc: 0.62924 | train_balanced_accuracy: 0.60682 | train_accuracy: 0.60606 | valid_auc: 0.63126 | valid_balanced_accuracy: 0.60781 | valid_accuracy: 0.60702 |  0:00:15s
epoch 1  | loss: 0.63153 | train_auc: 0.64895 | train_balanced_accuracy: 0.60899 | train_accuracy: 0.60779 | valid_auc: 0.64924 | valid_balanced_accuracy: 0.6059  | valid_accuracy: 0.60466 |  0:00:34s
epoch 2  | loss: 0.6147  | train_auc: 0.68622 | train_balanced_accuracy: 0.6175  | train_accuracy: 0.61645 | valid_auc: 0.68046 | valid_balanced_accuracy: 0.61411 | valid_accuracy: 0.613   |  0:00:50s
epoch 3  | loss: 0.61137 | train_auc: 0.68923 | train_balanced_accuracy: 0.62149 | train_accuracy: 0.62046 | valid_auc: 0.68369 | valid_balanced_accuracy: 0.61815 | valid_accuracy: 0.61709 |  0:01:08s
epoch 4  | loss: 0.60147 | train_auc: 0.69366 | train_balanced_accuracy: 0.62388 | train_accuracy: 0.6229  | valid_auc: 0.68731 | valid_balanced_accuracy: 0.61936 | valid_accuracy: 0.61835 |  0:01:26s
epoch 5  | loss: 0.60113 | train_auc: 0.70187 | train_balanced_accuracy: 0.62972 | train_accuracy: 0.62896 | valid_auc: 0.69629 | valid_balanced_accuracy: 0.62747 | valid_accuracy: 0.62669 |  0:01:41s
epoch 6  | loss: 0.60199 | train_auc: 0.71148 | train_balanced_accuracy: 0.62769 | train_accuracy: 0.6266  | valid_auc: 0.70383 | valid_balanced_accuracy: 0.62044 | valid_accuracy: 0.61929 |  0:01:57s
epoch 7  | loss: 0.59758 | train_auc: 0.71295 | train_balanced_accuracy: 0.63784 | train_accuracy: 0.63706 | valid_auc: 0.70169 | valid_balanced_accuracy: 0.63331 | valid_accuracy: 0.63251 |  0:02:15s
epoch 8  | loss: 0.58935 | train_auc: 0.70846 | train_balanced_accuracy: 0.63906 | train_accuracy: 0.63876 | valid_auc: 0.70215 | valid_balanced_accuracy: 0.63855 | valid_accuracy: 0.63818 |  0:02:33s
epoch 9  | loss: 0.59294 | train_auc: 0.72598 | train_balanced_accuracy: 0.66328 | train_accuracy: 0.66303 | valid_auc: 0.7161  | valid_balanced_accuracy: 0.65987 | valid_accuracy: 0.65958 |  0:02:49s
epoch 10 | loss: 0.58624 | train_auc: 0.72357 | train_balanced_accuracy: 0.65967 | train_accuracy: 0.65949 | valid_auc: 0.71563 | valid_balanced_accuracy: 0.65425 | valid_accuracy: 0.65408 |  0:03:05s
epoch 11 | loss: 0.58824 | train_auc: 0.72809 | train_balanced_accuracy: 0.6648  | train_accuracy: 0.66528 | valid_auc: 0.72017 | valid_balanced_accuracy: 0.65737 | valid_accuracy: 0.65785 |  0:03:22s
epoch 12 | loss: 0.58637 | train_auc: 0.73403 | train_balanced_accuracy: 0.66673 | train_accuracy: 0.66736 | valid_auc: 0.72041 | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65549 |  0:03:39s
epoch 13 | loss: 0.58462 | train_auc: 0.73853 | train_balanced_accuracy: 0.67199 | train_accuracy: 0.67252 | valid_auc: 0.72513 | valid_balanced_accuracy: 0.66064 | valid_accuracy: 0.66116 |  0:03:57s
epoch 14 | loss: 0.58375 | train_auc: 0.73956 | train_balanced_accuracy: 0.67444 | train_accuracy: 0.675   | valid_auc: 0.72692 | valid_balanced_accuracy: 0.66189 | valid_accuracy: 0.66242 |  0:04:15s
epoch 15 | loss: 0.58188 | train_auc: 0.74253 | train_balanced_accuracy: 0.6766  | train_accuracy: 0.67677 | valid_auc: 0.73069 | valid_balanced_accuracy: 0.66777 | valid_accuracy: 0.66793 |  0:04:33s
epoch 16 | loss: 0.57797 | train_auc: 0.74341 | train_balanced_accuracy: 0.67752 | train_accuracy: 0.67763 | valid_auc: 0.72869 | valid_balanced_accuracy: 0.66548 | valid_accuracy: 0.66556 |  0:04:49s
epoch 17 | loss: 0.57472 | train_auc: 0.74345 | train_balanced_accuracy: 0.67948 | train_accuracy: 0.67987 | valid_auc: 0.7291  | valid_balanced_accuracy: 0.65985 | valid_accuracy: 0.66021 |  0:05:09s
epoch 18 | loss: 0.57465 | train_auc: 0.74916 | train_balanced_accuracy: 0.68314 | train_accuracy: 0.68381 | valid_auc: 0.73375 | valid_balanced_accuracy: 0.67106 | valid_accuracy: 0.6717  |  0:05:29s
epoch 19 | loss: 0.57862 | train_auc: 0.75503 | train_balanced_accuracy: 0.68595 | train_accuracy: 0.68637 | valid_auc: 0.73852 | valid_balanced_accuracy: 0.66962 | valid_accuracy: 0.66997 |  0:05:46s
epoch 20 | loss: 0.57397 | train_auc: 0.7535  | train_balanced_accuracy: 0.68583 | train_accuracy: 0.68589 | valid_auc: 0.73617 | valid_balanced_accuracy: 0.66959 | valid_accuracy: 0.66966 |  0:06:02s
epoch 21 | loss: 0.57301 | train_auc: 0.76348 | train_balanced_accuracy: 0.69001 | train_accuracy: 0.69062 | valid_auc: 0.74463 | valid_balanced_accuracy: 0.67471 | valid_accuracy: 0.67532 |  0:06:20s
epoch 22 | loss: 0.579   | train_auc: 0.75971 | train_balanced_accuracy: 0.68745 | train_accuracy: 0.68802 | valid_auc: 0.7435  | valid_balanced_accuracy: 0.67491 | valid_accuracy: 0.67548 |  0:06:37s
epoch 23 | loss: 0.57174 | train_auc: 0.76924 | train_balanced_accuracy: 0.69735 | train_accuracy: 0.69797 | valid_auc: 0.75023 | valid_balanced_accuracy: 0.68242 | valid_accuracy: 0.68303 |  0:06:55s
epoch 24 | loss: 0.57419 | train_auc: 0.75858 | train_balanced_accuracy: 0.6888  | train_accuracy: 0.68916 | valid_auc: 0.73915 | valid_balanced_accuracy: 0.67356 | valid_accuracy: 0.67391 |  0:07:13s
epoch 25 | loss: 0.56859 | train_auc: 0.7618  | train_balanced_accuracy: 0.69483 | train_accuracy: 0.69494 | valid_auc: 0.74265 | valid_balanced_accuracy: 0.67807 | valid_accuracy: 0.67816 |  0:07:30s
epoch 26 | loss: 0.57426 | train_auc: 0.76902 | train_balanced_accuracy: 0.69874 | train_accuracy: 0.69923 | valid_auc: 0.74628 | valid_balanced_accuracy: 0.68334 | valid_accuracy: 0.68382 |  0:07:48s
epoch 27 | loss: 0.57148 | train_auc: 0.7723  | train_balanced_accuracy: 0.70184 | train_accuracy: 0.70203 | valid_auc: 0.74552 | valid_balanced_accuracy: 0.68756 | valid_accuracy: 0.68776 |  0:08:05s
epoch 28 | loss: 0.5706  | train_auc: 0.77364 | train_balanced_accuracy: 0.70112 | train_accuracy: 0.70136 | valid_auc: 0.74599 | valid_balanced_accuracy: 0.6828  | valid_accuracy: 0.68303 |  0:08:20s
epoch 29 | loss: 0.56354 | train_auc: 0.78143 | train_balanced_accuracy: 0.7114  | train_accuracy: 0.71163 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.68957 | valid_accuracy: 0.6898  |  0:08:37s
epoch 30 | loss: 0.56471 | train_auc: 0.77114 | train_balanced_accuracy: 0.70421 | train_accuracy: 0.70462 | valid_auc: 0.74765 | valid_balanced_accuracy: 0.68389 | valid_accuracy: 0.68429 |  0:08:55s
epoch 31 | loss: 0.56912 | train_auc: 0.76162 | train_balanced_accuracy: 0.69124 | train_accuracy: 0.69172 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.67984 | valid_accuracy: 0.68036 |  0:09:13s
epoch 32 | loss: 0.56416 | train_auc: 0.77415 | train_balanced_accuracy: 0.70076 | train_accuracy: 0.70104 | valid_auc: 0.75089 | valid_balanced_accuracy: 0.68794 | valid_accuracy: 0.68823 |  0:09:30s
epoch 33 | loss: 0.56575 | train_auc: 0.76868 | train_balanced_accuracy: 0.69307 | train_accuracy: 0.69388 | valid_auc: 0.74797 | valid_balanced_accuracy: 0.68013 | valid_accuracy: 0.68099 |  0:09:48s
epoch 34 | loss: 0.55783 | train_auc: 0.76685 | train_balanced_accuracy: 0.69689 | train_accuracy: 0.69727 | valid_auc: 0.74554 | valid_balanced_accuracy: 0.68421 | valid_accuracy: 0.68461 |  0:10:05s
epoch 35 | loss: 0.56418 | train_auc: 0.7753  | train_balanced_accuracy: 0.70723 | train_accuracy: 0.70773 | valid_auc: 0.75319 | valid_balanced_accuracy: 0.69024 | valid_accuracy: 0.69075 |  0:10:22s
epoch 36 | loss: 0.56241 | train_auc: 0.78131 | train_balanced_accuracy: 0.70845 | train_accuracy: 0.70864 | valid_auc: 0.75298 | valid_balanced_accuracy: 0.68618 | valid_accuracy: 0.68634 |  0:10:39s
epoch 37 | loss: 0.55882 | train_auc: 0.78462 | train_balanced_accuracy: 0.71047 | train_accuracy: 0.71088 | valid_auc: 0.75372 | valid_balanced_accuracy: 0.69097 | valid_accuracy: 0.69138 |  0:10:57s
epoch 38 | loss: 0.55578 | train_auc: 0.78607 | train_balanced_accuracy: 0.70949 | train_accuracy: 0.70942 | valid_auc: 0.75389 | valid_balanced_accuracy: 0.69205 | valid_accuracy: 0.69201 |  0:11:14s
epoch 39 | loss: 0.55869 | train_auc: 0.79224 | train_balanced_accuracy: 0.71834 | train_accuracy: 0.71863 | valid_auc: 0.75333 | valid_balanced_accuracy: 0.69187 | valid_accuracy: 0.69216 |  0:11:33s
epoch 40 | loss: 0.55677 | train_auc: 0.79228 | train_balanced_accuracy: 0.71893 | train_accuracy: 0.7191  | valid_auc: 0.75468 | valid_balanced_accuracy: 0.68778 | valid_accuracy: 0.68791 |  0:11:52s
epoch 41 | loss: 0.55298 | train_auc: 0.79447 | train_balanced_accuracy: 0.71768 | train_accuracy: 0.71784 | valid_auc: 0.75329 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.6854  |  0:12:11s
epoch 42 | loss: 0.55152 | train_auc: 0.79514 | train_balanced_accuracy: 0.71748 | train_accuracy: 0.71777 | valid_auc: 0.75705 | valid_balanced_accuracy: 0.69275 | valid_accuracy: 0.69311 |  0:12:30s
epoch 43 | loss: 0.55623 | train_auc: 0.79728 | train_balanced_accuracy: 0.72084 | train_accuracy: 0.72095 | valid_auc: 0.7603  | valid_balanced_accuracy: 0.69362 | valid_accuracy: 0.69374 |  0:12:46s
epoch 44 | loss: 0.55172 | train_auc: 0.80035 | train_balanced_accuracy: 0.72296 | train_accuracy: 0.72323 | valid_auc: 0.76099 | valid_balanced_accuracy: 0.69896 | valid_accuracy: 0.69924 |  0:13:05s
epoch 45 | loss: 0.55004 | train_auc: 0.79386 | train_balanced_accuracy: 0.71399 | train_accuracy: 0.7145  | valid_auc: 0.7527  | valid_balanced_accuracy: 0.68627 | valid_accuracy: 0.68681 |  0:13:22s
epoch 46 | loss: 0.54899 | train_auc: 0.80131 | train_balanced_accuracy: 0.72601 | train_accuracy: 0.72619 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.69248 | valid_accuracy: 0.69263 |  0:13:40s
epoch 47 | loss: 0.54942 | train_auc: 0.79376 | train_balanced_accuracy: 0.71543 | train_accuracy: 0.71596 | valid_auc: 0.74912 | valid_balanced_accuracy: 0.68251 | valid_accuracy: 0.68303 |  0:13:58s
epoch 48 | loss: 0.54749 | train_auc: 0.80155 | train_balanced_accuracy: 0.72164 | train_accuracy: 0.72166 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.69104 | valid_accuracy: 0.69106 |  0:14:14s
epoch 49 | loss: 0.54519 | train_auc: 0.79985 | train_balanced_accuracy: 0.72271 | train_accuracy: 0.72292 | valid_auc: 0.75637 | valid_balanced_accuracy: 0.69351 | valid_accuracy: 0.69374 |  0:14:32s
epoch 50 | loss: 0.5449  | train_auc: 0.80218 | train_balanced_accuracy: 0.72528 | train_accuracy: 0.72532 | valid_auc: 0.75981 | valid_balanced_accuracy: 0.69399 | valid_accuracy: 0.69405 |  0:14:49s
epoch 51 | loss: 0.54598 | train_auc: 0.80471 | train_balanced_accuracy: 0.72368 | train_accuracy: 0.72414 | valid_auc: 0.76296 | valid_balanced_accuracy: 0.69133 | valid_accuracy: 0.69185 |  0:15:07s
epoch 52 | loss: 0.54236 | train_auc: 0.8069  | train_balanced_accuracy: 0.72758 | train_accuracy: 0.7276  | valid_auc: 0.76703 | valid_balanced_accuracy: 0.69666 | valid_accuracy: 0.69673 |  0:15:24s
epoch 53 | loss: 0.54366 | train_auc: 0.8006  | train_balanced_accuracy: 0.72112 | train_accuracy: 0.72142 | valid_auc: 0.76056 | valid_balanced_accuracy: 0.69609 | valid_accuracy: 0.69641 |  0:15:41s
epoch 54 | loss: 0.54304 | train_auc: 0.80718 | train_balanced_accuracy: 0.72873 | train_accuracy: 0.72894 | valid_auc: 0.76399 | valid_balanced_accuracy: 0.69445 | valid_accuracy: 0.69468 |  0:15:57s
epoch 55 | loss: 0.54492 | train_auc: 0.80281 | train_balanced_accuracy: 0.72299 | train_accuracy: 0.72339 | valid_auc: 0.75704 | valid_balanced_accuracy: 0.69096 | valid_accuracy: 0.69138 |  0:16:14s
epoch 56 | loss: 0.5433  | train_auc: 0.80894 | train_balanced_accuracy: 0.72893 | train_accuracy: 0.72922 | valid_auc: 0.76083 | valid_balanced_accuracy: 0.69312 | valid_accuracy: 0.69342 |  0:16:32s
epoch 57 | loss: 0.54225 | train_auc: 0.80724 | train_balanced_accuracy: 0.72743 | train_accuracy: 0.72752 | valid_auc: 0.75832 | valid_balanced_accuracy: 0.68958 | valid_accuracy: 0.68964 |  0:16:50s
epoch 58 | loss: 0.54301 | train_auc: 0.80651 | train_balanced_accuracy: 0.72498 | train_accuracy: 0.72532 | valid_auc: 0.76172 | valid_balanced_accuracy: 0.69547 | valid_accuracy: 0.69578 |  0:17:06s
epoch 59 | loss: 0.53958 | train_auc: 0.80928 | train_balanced_accuracy: 0.72633 | train_accuracy: 0.72674 | valid_auc: 0.76381 | valid_balanced_accuracy: 0.69345 | valid_accuracy: 0.69389 |  0:17:23s
epoch 60 | loss: 0.53993 | train_auc: 0.80966 | train_balanced_accuracy: 0.73058 | train_accuracy: 0.73079 | valid_auc: 0.76198 | valid_balanced_accuracy: 0.69588 | valid_accuracy: 0.6961  |  0:17:40s
epoch 61 | loss: 0.53743 | train_auc: 0.81225 | train_balanced_accuracy: 0.73192 | train_accuracy: 0.73228 | valid_auc: 0.76316 | valid_balanced_accuracy: 0.69133 | valid_accuracy: 0.69169 |  0:17:57s
epoch 62 | loss: 0.53492 | train_auc: 0.81145 | train_balanced_accuracy: 0.72855 | train_accuracy: 0.72851 | valid_auc: 0.76567 | valid_balanced_accuracy: 0.69334 | valid_accuracy: 0.69326 |  0:18:14s
epoch 63 | loss: 0.53608 | train_auc: 0.81033 | train_balanced_accuracy: 0.73182 | train_accuracy: 0.73209 | valid_auc: 0.7598  | valid_balanced_accuracy: 0.69284 | valid_accuracy: 0.69311 |  0:18:31s
epoch 64 | loss: 0.53766 | train_auc: 0.81381 | train_balanced_accuracy: 0.73101 | train_accuracy: 0.73091 | valid_auc: 0.76095 | valid_balanced_accuracy: 0.68548 | valid_accuracy: 0.6854  |  0:18:50s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69924
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 64/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.704 total time=19.0min
[CV 2/5; 64/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6972  | train_auc: 0.60041 | train_balanced_accuracy: 0.55639 | train_accuracy: 0.55483 | valid_auc: 0.59753 | valid_balanced_accuracy: 0.5534  | valid_accuracy: 0.55178 |  0:00:16s
epoch 1  | loss: 0.63972 | train_auc: 0.65419 | train_balanced_accuracy: 0.59938 | train_accuracy: 0.5987  | valid_auc: 0.65125 | valid_balanced_accuracy: 0.59716 | valid_accuracy: 0.59647 |  0:00:34s
epoch 2  | loss: 0.62886 | train_auc: 0.68038 | train_balanced_accuracy: 0.63032 | train_accuracy: 0.63163 | valid_auc: 0.67861 | valid_balanced_accuracy: 0.63038 | valid_accuracy: 0.63173 |  0:00:50s
epoch 3  | loss: 0.61948 | train_auc: 0.6894  | train_balanced_accuracy: 0.65319 | train_accuracy: 0.65375 | valid_auc: 0.68677 | valid_balanced_accuracy: 0.64913 | valid_accuracy: 0.64967 |  0:01:06s
epoch 4  | loss: 0.60633 | train_auc: 0.69719 | train_balanced_accuracy: 0.638   | train_accuracy: 0.63919 | valid_auc: 0.69567 | valid_balanced_accuracy: 0.64328 | valid_accuracy: 0.64448 |  0:01:24s
epoch 5  | loss: 0.6042  | train_auc: 0.69792 | train_balanced_accuracy: 0.64055 | train_accuracy: 0.64155 | valid_auc: 0.69708 | valid_balanced_accuracy: 0.64033 | valid_accuracy: 0.64133 |  0:01:41s
epoch 6  | loss: 0.60425 | train_auc: 0.70314 | train_balanced_accuracy: 0.6295  | train_accuracy: 0.63061 | valid_auc: 0.69731 | valid_balanced_accuracy: 0.62418 | valid_accuracy: 0.62528 |  0:01:59s
epoch 7  | loss: 0.60424 | train_auc: 0.70033 | train_balanced_accuracy: 0.61985 | train_accuracy: 0.62101 | valid_auc: 0.69455 | valid_balanced_accuracy: 0.6145  | valid_accuracy: 0.61568 |  0:02:15s
epoch 8  | loss: 0.59447 | train_auc: 0.70568 | train_balanced_accuracy: 0.62503 | train_accuracy: 0.6262  | valid_auc: 0.6979  | valid_balanced_accuracy: 0.62203 | valid_accuracy: 0.62323 |  0:02:33s
epoch 9  | loss: 0.60037 | train_auc: 0.70601 | train_balanced_accuracy: 0.64869 | train_accuracy: 0.64942 | valid_auc: 0.70228 | valid_balanced_accuracy: 0.64915 | valid_accuracy: 0.64983 |  0:02:50s
epoch 10 | loss: 0.5917  | train_auc: 0.71726 | train_balanced_accuracy: 0.66546 | train_accuracy: 0.66595 | valid_auc: 0.71312 | valid_balanced_accuracy: 0.66513 | valid_accuracy: 0.66556 |  0:03:07s
epoch 11 | loss: 0.59415 | train_auc: 0.71409 | train_balanced_accuracy: 0.6614  | train_accuracy: 0.66201 | valid_auc: 0.70903 | valid_balanced_accuracy: 0.66104 | valid_accuracy: 0.66163 |  0:03:23s
epoch 12 | loss: 0.59173 | train_auc: 0.7236  | train_balanced_accuracy: 0.66294 | train_accuracy: 0.66351 | valid_auc: 0.72105 | valid_balanced_accuracy: 0.66217 | valid_accuracy: 0.66273 |  0:03:41s
epoch 13 | loss: 0.58852 | train_auc: 0.72479 | train_balanced_accuracy: 0.66683 | train_accuracy: 0.66732 | valid_auc: 0.72005 | valid_balanced_accuracy: 0.66447 | valid_accuracy: 0.66494 |  0:04:00s
epoch 14 | loss: 0.58895 | train_auc: 0.73519 | train_balanced_accuracy: 0.66557 | train_accuracy: 0.66646 | valid_auc: 0.73098 | valid_balanced_accuracy: 0.66843 | valid_accuracy: 0.66934 |  0:04:18s
epoch 15 | loss: 0.58656 | train_auc: 0.73968 | train_balanced_accuracy: 0.67236 | train_accuracy: 0.67252 | valid_auc: 0.73606 | valid_balanced_accuracy: 0.67407 | valid_accuracy: 0.67422 |  0:04:37s
epoch 16 | loss: 0.58676 | train_auc: 0.74126 | train_balanced_accuracy: 0.67365 | train_accuracy: 0.6737  | valid_auc: 0.73408 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.6728  |  0:04:54s
epoch 17 | loss: 0.58057 | train_auc: 0.74267 | train_balanced_accuracy: 0.67531 | train_accuracy: 0.67523 | valid_auc: 0.73885 | valid_balanced_accuracy: 0.6732  | valid_accuracy: 0.67312 |  0:05:15s
epoch 18 | loss: 0.58172 | train_auc: 0.75052 | train_balanced_accuracy: 0.68139 | train_accuracy: 0.6818  | valid_auc: 0.7415  | valid_balanced_accuracy: 0.67657 | valid_accuracy: 0.67705 |  0:05:33s
epoch 19 | loss: 0.58297 | train_auc: 0.75542 | train_balanced_accuracy: 0.68667 | train_accuracy: 0.68692 | valid_auc: 0.74505 | valid_balanced_accuracy: 0.68057 | valid_accuracy: 0.68083 |  0:05:51s
epoch 20 | loss: 0.57916 | train_auc: 0.7569  | train_balanced_accuracy: 0.69075 | train_accuracy: 0.69093 | valid_auc: 0.7432  | valid_balanced_accuracy: 0.68003 | valid_accuracy: 0.6802  |  0:06:07s
epoch 21 | loss: 0.57796 | train_auc: 0.75359 | train_balanced_accuracy: 0.68462 | train_accuracy: 0.68503 | valid_auc: 0.74244 | valid_balanced_accuracy: 0.67852 | valid_accuracy: 0.67894 |  0:06:25s
epoch 22 | loss: 0.58607 | train_auc: 0.76738 | train_balanced_accuracy: 0.7012  | train_accuracy: 0.70144 | valid_auc: 0.75168 | valid_balanced_accuracy: 0.6886  | valid_accuracy: 0.68886 |  0:06:42s
epoch 23 | loss: 0.57763 | train_auc: 0.7703  | train_balanced_accuracy: 0.69714 | train_accuracy: 0.69758 | valid_auc: 0.7541  | valid_balanced_accuracy: 0.68683 | valid_accuracy: 0.68728 |  0:07:00s
epoch 24 | loss: 0.57882 | train_auc: 0.76915 | train_balanced_accuracy: 0.69992 | train_accuracy: 0.7003  | valid_auc: 0.75053 | valid_balanced_accuracy: 0.68752 | valid_accuracy: 0.68791 |  0:07:18s
epoch 25 | loss: 0.57204 | train_auc: 0.76723 | train_balanced_accuracy: 0.69787 | train_accuracy: 0.69793 | valid_auc: 0.75067 | valid_balanced_accuracy: 0.68483 | valid_accuracy: 0.68492 |  0:07:35s
epoch 26 | loss: 0.57545 | train_auc: 0.77085 | train_balanced_accuracy: 0.69835 | train_accuracy: 0.69884 | valid_auc: 0.75309 | valid_balanced_accuracy: 0.68681 | valid_accuracy: 0.68728 |  0:07:52s
epoch 27 | loss: 0.57076 | train_auc: 0.77382 | train_balanced_accuracy: 0.70447 | train_accuracy: 0.70447 | valid_auc: 0.75484 | valid_balanced_accuracy: 0.68697 | valid_accuracy: 0.68697 |  0:08:12s
epoch 28 | loss: 0.56629 | train_auc: 0.77666 | train_balanced_accuracy: 0.70521 | train_accuracy: 0.70549 | valid_auc: 0.75969 | valid_balanced_accuracy: 0.69612 | valid_accuracy: 0.69641 |  0:08:28s
epoch 29 | loss: 0.56981 | train_auc: 0.772   | train_balanced_accuracy: 0.69995 | train_accuracy: 0.69978 | valid_auc: 0.75148 | valid_balanced_accuracy: 0.69012 | valid_accuracy: 0.68996 |  0:08:47s
epoch 30 | loss: 0.56638 | train_auc: 0.7716  | train_balanced_accuracy: 0.70144 | train_accuracy: 0.70163 | valid_auc: 0.75051 | valid_balanced_accuracy: 0.68723 | valid_accuracy: 0.68744 |  0:09:04s
epoch 31 | loss: 0.56521 | train_auc: 0.78657 | train_balanced_accuracy: 0.71201 | train_accuracy: 0.7123  | valid_auc: 0.75797 | valid_balanced_accuracy: 0.68701 | valid_accuracy: 0.68728 |  0:09:21s
epoch 32 | loss: 0.56481 | train_auc: 0.78681 | train_balanced_accuracy: 0.7126  | train_accuracy: 0.71289 | valid_auc: 0.76008 | valid_balanced_accuracy: 0.69298 | valid_accuracy: 0.69326 |  0:09:39s
epoch 33 | loss: 0.56538 | train_auc: 0.78211 | train_balanced_accuracy: 0.7074  | train_accuracy: 0.70777 | valid_auc: 0.75705 | valid_balanced_accuracy: 0.69159 | valid_accuracy: 0.69201 |  0:09:58s
epoch 34 | loss: 0.56355 | train_auc: 0.78381 | train_balanced_accuracy: 0.71245 | train_accuracy: 0.71277 | valid_auc: 0.75878 | valid_balanced_accuracy: 0.69924 | valid_accuracy: 0.69956 |  0:10:14s
epoch 35 | loss: 0.56055 | train_auc: 0.78587 | train_balanced_accuracy: 0.70948 | train_accuracy: 0.70994 | valid_auc: 0.7591  | valid_balanced_accuracy: 0.69266 | valid_accuracy: 0.69311 |  0:10:32s
epoch 36 | loss: 0.55928 | train_auc: 0.79081 | train_balanced_accuracy: 0.71493 | train_accuracy: 0.71513 | valid_auc: 0.76292 | valid_balanced_accuracy: 0.69226 | valid_accuracy: 0.69248 |  0:10:51s
epoch 37 | loss: 0.56109 | train_auc: 0.78947 | train_balanced_accuracy: 0.71278 | train_accuracy: 0.7132  | valid_auc: 0.75811 | valid_balanced_accuracy: 0.69028 | valid_accuracy: 0.69075 |  0:11:10s
epoch 38 | loss: 0.55565 | train_auc: 0.78264 | train_balanced_accuracy: 0.7045  | train_accuracy: 0.70427 | valid_auc: 0.75195 | valid_balanced_accuracy: 0.68086 | valid_accuracy: 0.68067 |  0:11:27s
epoch 39 | loss: 0.56061 | train_auc: 0.79278 | train_balanced_accuracy: 0.71634 | train_accuracy: 0.71631 | valid_auc: 0.76094 | valid_balanced_accuracy: 0.69376 | valid_accuracy: 0.69374 |  0:11:45s
epoch 40 | loss: 0.55874 | train_auc: 0.79392 | train_balanced_accuracy: 0.72047 | train_accuracy: 0.7206  | valid_auc: 0.76265 | valid_balanced_accuracy: 0.69757 | valid_accuracy: 0.69767 |  0:12:04s
epoch 41 | loss: 0.55581 | train_auc: 0.79748 | train_balanced_accuracy: 0.72206 | train_accuracy: 0.72221 | valid_auc: 0.76504 | valid_balanced_accuracy: 0.69749 | valid_accuracy: 0.69767 |  0:12:21s
epoch 42 | loss: 0.55036 | train_auc: 0.79159 | train_balanced_accuracy: 0.71582 | train_accuracy: 0.71611 | valid_auc: 0.7611  | valid_balanced_accuracy: 0.69203 | valid_accuracy: 0.69232 |  0:12:38s
epoch 43 | loss: 0.56147 | train_auc: 0.79553 | train_balanced_accuracy: 0.71756 | train_accuracy: 0.71745 | valid_auc: 0.76385 | valid_balanced_accuracy: 0.69606 | valid_accuracy: 0.69594 |  0:12:54s
epoch 44 | loss: 0.55121 | train_auc: 0.79626 | train_balanced_accuracy: 0.72126 | train_accuracy: 0.72154 | valid_auc: 0.76257 | valid_balanced_accuracy: 0.69645 | valid_accuracy: 0.69673 |  0:13:12s
epoch 45 | loss: 0.54878 | train_auc: 0.79554 | train_balanced_accuracy: 0.71506 | train_accuracy: 0.71568 | valid_auc: 0.75825 | valid_balanced_accuracy: 0.69339 | valid_accuracy: 0.69405 |  0:13:29s
epoch 46 | loss: 0.54974 | train_auc: 0.79556 | train_balanced_accuracy: 0.71717 | train_accuracy: 0.71721 | valid_auc: 0.76225 | valid_balanced_accuracy: 0.69415 | valid_accuracy: 0.69421 |  0:13:45s
epoch 47 | loss: 0.54869 | train_auc: 0.78791 | train_balanced_accuracy: 0.70711 | train_accuracy: 0.70761 | valid_auc: 0.75292 | valid_balanced_accuracy: 0.68802 | valid_accuracy: 0.68854 |  0:14:03s
epoch 48 | loss: 0.54496 | train_auc: 0.79344 | train_balanced_accuracy: 0.71866 | train_accuracy: 0.71879 | valid_auc: 0.76187 | valid_balanced_accuracy: 0.69959 | valid_accuracy: 0.69972 |  0:14:21s
epoch 49 | loss: 0.54605 | train_auc: 0.7955  | train_balanced_accuracy: 0.71996 | train_accuracy: 0.72009 | valid_auc: 0.75719 | valid_balanced_accuracy: 0.69186 | valid_accuracy: 0.69201 |  0:14:38s
epoch 50 | loss: 0.54655 | train_auc: 0.79098 | train_balanced_accuracy: 0.71475 | train_accuracy: 0.7147  | valid_auc: 0.75789 | valid_balanced_accuracy: 0.68954 | valid_accuracy: 0.68949 |  0:14:56s
epoch 51 | loss: 0.54762 | train_auc: 0.8017  | train_balanced_accuracy: 0.72183 | train_accuracy: 0.72194 | valid_auc: 0.76217 | valid_balanced_accuracy: 0.68954 | valid_accuracy: 0.68964 |  0:15:14s
epoch 52 | loss: 0.54387 | train_auc: 0.80218 | train_balanced_accuracy: 0.72429 | train_accuracy: 0.7243  | valid_auc: 0.76501 | valid_balanced_accuracy: 0.69437 | valid_accuracy: 0.69437 |  0:15:31s
epoch 53 | loss: 0.54436 | train_auc: 0.80409 | train_balanced_accuracy: 0.72604 | train_accuracy: 0.72634 | valid_auc: 0.76653 | valid_balanced_accuracy: 0.69707 | valid_accuracy: 0.69736 |  0:15:49s
epoch 54 | loss: 0.54726 | train_auc: 0.80751 | train_balanced_accuracy: 0.72888 | train_accuracy: 0.7289  | valid_auc: 0.76639 | valid_balanced_accuracy: 0.69766 | valid_accuracy: 0.69767 |  0:16:08s
epoch 55 | loss: 0.54429 | train_auc: 0.80083 | train_balanced_accuracy: 0.72208 | train_accuracy: 0.72249 | valid_auc: 0.76409 | valid_balanced_accuracy: 0.70105 | valid_accuracy: 0.70145 |  0:16:26s
epoch 56 | loss: 0.54078 | train_auc: 0.78164 | train_balanced_accuracy: 0.70925 | train_accuracy: 0.70962 | valid_auc: 0.7546  | valid_balanced_accuracy: 0.69308 | valid_accuracy: 0.69342 |  0:16:43s
epoch 57 | loss: 0.54062 | train_auc: 0.80228 | train_balanced_accuracy: 0.72234 | train_accuracy: 0.72245 | valid_auc: 0.7625  | valid_balanced_accuracy: 0.69552 | valid_accuracy: 0.69562 |  0:17:01s
epoch 58 | loss: 0.53991 | train_auc: 0.80533 | train_balanced_accuracy: 0.72736 | train_accuracy: 0.72756 | valid_auc: 0.76358 | valid_balanced_accuracy: 0.69303 | valid_accuracy: 0.69326 |  0:17:18s
epoch 59 | loss: 0.53915 | train_auc: 0.80233 | train_balanced_accuracy: 0.724   | train_accuracy: 0.72414 | valid_auc: 0.75642 | valid_balanced_accuracy: 0.68696 | valid_accuracy: 0.68713 |  0:17:36s
epoch 60 | loss: 0.5438  | train_auc: 0.80288 | train_balanced_accuracy: 0.72502 | train_accuracy: 0.7252  | valid_auc: 0.76032 | valid_balanced_accuracy: 0.69422 | valid_accuracy: 0.69437 |  0:17:53s
epoch 61 | loss: 0.53878 | train_auc: 0.79706 | train_balanced_accuracy: 0.7177  | train_accuracy: 0.71812 | valid_auc: 0.76044 | valid_balanced_accuracy: 0.69582 | valid_accuracy: 0.69625 |  0:18:12s
epoch 62 | loss: 0.53648 | train_auc: 0.77297 | train_balanced_accuracy: 0.70448 | train_accuracy: 0.70451 | valid_auc: 0.74594 | valid_balanced_accuracy: 0.6879  | valid_accuracy: 0.68791 |  0:18:30s
epoch 63 | loss: 0.54244 | train_auc: 0.78039 | train_balanced_accuracy: 0.70653 | train_accuracy: 0.70667 | valid_auc: 0.75014 | valid_balanced_accuracy: 0.68446 | valid_accuracy: 0.68461 |  0:18:48s
epoch 64 | loss: 0.53604 | train_auc: 0.79568 | train_balanced_accuracy: 0.716   | train_accuracy: 0.71588 | valid_auc: 0.75279 | valid_balanced_accuracy: 0.68379 | valid_accuracy: 0.68366 |  0:19:07s
epoch 65 | loss: 0.53795 | train_auc: 0.79621 | train_balanced_accuracy: 0.72157 | train_accuracy: 0.7217  | valid_auc: 0.75507 | valid_balanced_accuracy: 0.68334 | valid_accuracy: 0.68351 |  0:19:23s
epoch 66 | loss: 0.53766 | train_auc: 0.79654 | train_balanced_accuracy: 0.71714 | train_accuracy: 0.71706 | valid_auc: 0.753   | valid_balanced_accuracy: 0.68389 | valid_accuracy: 0.68382 |  0:19:41s
epoch 67 | loss: 0.53434 | train_auc: 0.80512 | train_balanced_accuracy: 0.72718 | train_accuracy: 0.72733 | valid_auc: 0.76248 | valid_balanced_accuracy: 0.6923  | valid_accuracy: 0.69248 |  0:19:58s
epoch 68 | loss: 0.54216 | train_auc: 0.80899 | train_balanced_accuracy: 0.72788 | train_accuracy: 0.72796 | valid_auc: 0.76267 | valid_balanced_accuracy: 0.6946  | valid_accuracy: 0.69468 |  0:20:15s
epoch 69 | loss: 0.53696 | train_auc: 0.81099 | train_balanced_accuracy: 0.73158 | train_accuracy: 0.73177 | valid_auc: 0.76494 | valid_balanced_accuracy: 0.69493 | valid_accuracy: 0.69515 |  0:20:34s
epoch 70 | loss: 0.53632 | train_auc: 0.81766 | train_balanced_accuracy: 0.73392 | train_accuracy: 0.73421 | valid_auc: 0.77033 | valid_balanced_accuracy: 0.69942 | valid_accuracy: 0.69972 |  0:20:51s
epoch 71 | loss: 0.53674 | train_auc: 0.81696 | train_balanced_accuracy: 0.73258 | train_accuracy: 0.73256 | valid_auc: 0.764   | valid_balanced_accuracy: 0.69342 | valid_accuracy: 0.69342 |  0:21:10s
epoch 72 | loss: 0.53264 | train_auc: 0.81759 | train_balanced_accuracy: 0.73404 | train_accuracy: 0.73437 | valid_auc: 0.7671  | valid_balanced_accuracy: 0.69463 | valid_accuracy: 0.695   |  0:21:27s
epoch 73 | loss: 0.53038 | train_auc: 0.81721 | train_balanced_accuracy: 0.7363  | train_accuracy: 0.7363  | valid_auc: 0.76453 | valid_balanced_accuracy: 0.69467 | valid_accuracy: 0.69468 |  0:21:46s
epoch 74 | loss: 0.53488 | train_auc: 0.8192  | train_balanced_accuracy: 0.73773 | train_accuracy: 0.73803 | valid_auc: 0.76603 | valid_balanced_accuracy: 0.69623 | valid_accuracy: 0.69657 |  0:22:03s
epoch 75 | loss: 0.53063 | train_auc: 0.81689 | train_balanced_accuracy: 0.73773 | train_accuracy: 0.73811 | valid_auc: 0.76769 | valid_balanced_accuracy: 0.70184 | valid_accuracy: 0.70223 |  0:22:22s
epoch 76 | loss: 0.53735 | train_auc: 0.82018 | train_balanced_accuracy: 0.73734 | train_accuracy: 0.73732 | valid_auc: 0.76845 | valid_balanced_accuracy: 0.69969 | valid_accuracy: 0.69972 |  0:22:38s
epoch 77 | loss: 0.53353 | train_auc: 0.81905 | train_balanced_accuracy: 0.73884 | train_accuracy: 0.73889 | valid_auc: 0.76315 | valid_balanced_accuracy: 0.69128 | valid_accuracy: 0.69138 |  0:22:55s
epoch 78 | loss: 0.527   | train_auc: 0.81886 | train_balanced_accuracy: 0.73635 | train_accuracy: 0.73638 | valid_auc: 0.76344 | valid_balanced_accuracy: 0.69475 | valid_accuracy: 0.69484 |  0:23:11s
epoch 79 | loss: 0.52497 | train_auc: 0.81833 | train_balanced_accuracy: 0.73625 | train_accuracy: 0.73622 | valid_auc: 0.7612  | valid_balanced_accuracy: 0.69211 | valid_accuracy: 0.69216 |  0:23:30s
epoch 80 | loss: 0.53174 | train_auc: 0.82235 | train_balanced_accuracy: 0.74086 | train_accuracy: 0.74082 | valid_auc: 0.77146 | valid_balanced_accuracy: 0.70097 | valid_accuracy: 0.70098 |  0:23:47s
epoch 81 | loss: 0.52437 | train_auc: 0.82069 | train_balanced_accuracy: 0.73844 | train_accuracy: 0.73862 | valid_auc: 0.76627 | valid_balanced_accuracy: 0.69323 | valid_accuracy: 0.69342 |  0:24:04s
epoch 82 | loss: 0.53378 | train_auc: 0.8228  | train_balanced_accuracy: 0.74123 | train_accuracy: 0.74153 | valid_auc: 0.76169 | valid_balanced_accuracy: 0.68982 | valid_accuracy: 0.69012 |  0:24:22s
epoch 83 | loss: 0.52741 | train_auc: 0.82137 | train_balanced_accuracy: 0.73922 | train_accuracy: 0.73945 | valid_auc: 0.76335 | valid_balanced_accuracy: 0.69097 | valid_accuracy: 0.69122 |  0:24:39s
epoch 84 | loss: 0.52992 | train_auc: 0.82335 | train_balanced_accuracy: 0.74126 | train_accuracy: 0.74145 | valid_auc: 0.76838 | valid_balanced_accuracy: 0.6971  | valid_accuracy: 0.69736 |  0:24:57s
epoch 85 | loss: 0.52496 | train_auc: 0.82436 | train_balanced_accuracy: 0.74129 | train_accuracy: 0.74157 | valid_auc: 0.76755 | valid_balanced_accuracy: 0.69624 | valid_accuracy: 0.69657 |  0:25:13s
epoch 86 | loss: 0.53137 | train_auc: 0.81521 | train_balanced_accuracy: 0.73605 | train_accuracy: 0.73602 | valid_auc: 0.76055 | valid_balanced_accuracy: 0.69042 | valid_accuracy: 0.69043 |  0:25:30s
epoch 87 | loss: 0.52236 | train_auc: 0.82241 | train_balanced_accuracy: 0.73981 | train_accuracy: 0.73984 | valid_auc: 0.75971 | valid_balanced_accuracy: 0.69571 | valid_accuracy: 0.69578 |  0:25:49s
epoch 88 | loss: 0.52562 | train_auc: 0.82532 | train_balanced_accuracy: 0.74297 | train_accuracy: 0.74318 | valid_auc: 0.76729 | valid_balanced_accuracy: 0.69574 | valid_accuracy: 0.69594 |  0:26:07s
epoch 89 | loss: 0.52679 | train_auc: 0.821   | train_balanced_accuracy: 0.74016 | train_accuracy: 0.74039 | valid_auc: 0.76352 | valid_balanced_accuracy: 0.69506 | valid_accuracy: 0.69531 |  0:26:26s
epoch 90 | loss: 0.52657 | train_auc: 0.828   | train_balanced_accuracy: 0.74714 | train_accuracy: 0.74716 | valid_auc: 0.76523 | valid_balanced_accuracy: 0.69305 | valid_accuracy: 0.69311 |  0:26:44s
epoch 91 | loss: 0.51924 | train_auc: 0.82237 | train_balanced_accuracy: 0.74021 | train_accuracy: 0.74039 | valid_auc: 0.75791 | valid_balanced_accuracy: 0.68728 | valid_accuracy: 0.68744 |  0:27:01s
epoch 92 | loss: 0.52756 | train_auc: 0.82623 | train_balanced_accuracy: 0.7447  | train_accuracy: 0.74499 | valid_auc: 0.76343 | valid_balanced_accuracy: 0.69339 | valid_accuracy: 0.69374 |  0:27:17s
epoch 93 | loss: 0.5188  | train_auc: 0.82789 | train_balanced_accuracy: 0.74568 | train_accuracy: 0.74582 | valid_auc: 0.76532 | valid_balanced_accuracy: 0.69452 | valid_accuracy: 0.69468 |  0:27:34s
epoch 94 | loss: 0.52118 | train_auc: 0.8298  | train_balanced_accuracy: 0.74573 | train_accuracy: 0.74586 | valid_auc: 0.76463 | valid_balanced_accuracy: 0.69041 | valid_accuracy: 0.69059 |  0:27:53s
epoch 95 | loss: 0.51807 | train_auc: 0.82718 | train_balanced_accuracy: 0.74569 | train_accuracy: 0.7459  | valid_auc: 0.7655  | valid_balanced_accuracy: 0.6968  | valid_accuracy: 0.69704 |  0:28:11s

Early stopping occurred at epoch 95 with best_epoch = 75 and best_valid_accuracy = 0.70223
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 64/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=28.3min
[CV 3/5; 64/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.69306 | train_auc: 0.60106 | train_balanced_accuracy: 0.53777 | train_accuracy: 0.5358  | valid_auc: 0.59898 | valid_balanced_accuracy: 0.5337  | valid_accuracy: 0.53179 |  0:00:18s
epoch 1  | loss: 0.63907 | train_auc: 0.65666 | train_balanced_accuracy: 0.53455 | train_accuracy: 0.53148 | valid_auc: 0.64952 | valid_balanced_accuracy: 0.53551 | valid_accuracy: 0.53242 |  0:00:37s
epoch 2  | loss: 0.62433 | train_auc: 0.6777  | train_balanced_accuracy: 0.55054 | train_accuracy: 0.54769 | valid_auc: 0.67245 | valid_balanced_accuracy: 0.54865 | valid_accuracy: 0.5458  |  0:00:52s
epoch 3  | loss: 0.61702 | train_auc: 0.68828 | train_balanced_accuracy: 0.5683  | train_accuracy: 0.56567 | valid_auc: 0.68205 | valid_balanced_accuracy: 0.5637  | valid_accuracy: 0.56106 |  0:01:09s
epoch 4  | loss: 0.60732 | train_auc: 0.69915 | train_balanced_accuracy: 0.59835 | train_accuracy: 0.5964  | valid_auc: 0.69455 | valid_balanced_accuracy: 0.59168 | valid_accuracy: 0.58971 |  0:01:25s
epoch 5  | loss: 0.60403 | train_auc: 0.70448 | train_balanced_accuracy: 0.62116 | train_accuracy: 0.61977 | valid_auc: 0.6971  | valid_balanced_accuracy: 0.61457 | valid_accuracy: 0.61316 |  0:01:43s
epoch 6  | loss: 0.60231 | train_auc: 0.71414 | train_balanced_accuracy: 0.63164 | train_accuracy: 0.63059 | valid_auc: 0.70739 | valid_balanced_accuracy: 0.62838 | valid_accuracy: 0.62732 |  0:01:59s
epoch 7  | loss: 0.6044  | train_auc: 0.71157 | train_balanced_accuracy: 0.63858 | train_accuracy: 0.63763 | valid_auc: 0.70527 | valid_balanced_accuracy: 0.63852 | valid_accuracy: 0.63755 |  0:02:16s
epoch 8  | loss: 0.59627 | train_auc: 0.7127  | train_balanced_accuracy: 0.6574  | train_accuracy: 0.65726 | valid_auc: 0.70329 | valid_balanced_accuracy: 0.6602  | valid_accuracy: 0.66006 |  0:02:34s
epoch 9  | loss: 0.59234 | train_auc: 0.71302 | train_balanced_accuracy: 0.65534 | train_accuracy: 0.65526 | valid_auc: 0.70626 | valid_balanced_accuracy: 0.65355 | valid_accuracy: 0.65345 |  0:02:52s
epoch 10 | loss: 0.58123 | train_auc: 0.73176 | train_balanced_accuracy: 0.66813 | train_accuracy: 0.66824 | valid_auc: 0.72535 | valid_balanced_accuracy: 0.66702 | valid_accuracy: 0.66714 |  0:03:11s
epoch 11 | loss: 0.58699 | train_auc: 0.73512 | train_balanced_accuracy: 0.67457 | train_accuracy: 0.67485 | valid_auc: 0.72624 | valid_balanced_accuracy: 0.67002 | valid_accuracy: 0.67029 |  0:03:28s
epoch 12 | loss: 0.58721 | train_auc: 0.73827 | train_balanced_accuracy: 0.67513 | train_accuracy: 0.67568 | valid_auc: 0.72423 | valid_balanced_accuracy: 0.66595 | valid_accuracy: 0.66651 |  0:03:45s
epoch 13 | loss: 0.58335 | train_auc: 0.73969 | train_balanced_accuracy: 0.67696 | train_accuracy: 0.67757 | valid_auc: 0.72656 | valid_balanced_accuracy: 0.66748 | valid_accuracy: 0.66808 |  0:04:02s
epoch 14 | loss: 0.5823  | train_auc: 0.74307 | train_balanced_accuracy: 0.67946 | train_accuracy: 0.67989 | valid_auc: 0.72783 | valid_balanced_accuracy: 0.67225 | valid_accuracy: 0.67265 |  0:04:19s
epoch 15 | loss: 0.58459 | train_auc: 0.74765 | train_balanced_accuracy: 0.68189 | train_accuracy: 0.68229 | valid_auc: 0.73513 | valid_balanced_accuracy: 0.67371 | valid_accuracy: 0.67406 |  0:04:37s
epoch 16 | loss: 0.57905 | train_auc: 0.74941 | train_balanced_accuracy: 0.68095 | train_accuracy: 0.68126 | valid_auc: 0.7322  | valid_balanced_accuracy: 0.67112 | valid_accuracy: 0.67139 |  0:04:55s
epoch 17 | loss: 0.57749 | train_auc: 0.74968 | train_balanced_accuracy: 0.68362 | train_accuracy: 0.6841  | valid_auc: 0.73189 | valid_balanced_accuracy: 0.67203 | valid_accuracy: 0.67249 |  0:05:14s
epoch 18 | loss: 0.58132 | train_auc: 0.75813 | train_balanced_accuracy: 0.68817 | train_accuracy: 0.6889  | valid_auc: 0.73771 | valid_balanced_accuracy: 0.67981 | valid_accuracy: 0.68052 |  0:05:31s
epoch 19 | loss: 0.57645 | train_auc: 0.75557 | train_balanced_accuracy: 0.68508 | train_accuracy: 0.68563 | valid_auc: 0.73575 | valid_balanced_accuracy: 0.67747 | valid_accuracy: 0.678   |  0:05:46s
epoch 20 | loss: 0.57561 | train_auc: 0.75939 | train_balanced_accuracy: 0.68576 | train_accuracy: 0.68634 | valid_auc: 0.73535 | valid_balanced_accuracy: 0.66973 | valid_accuracy: 0.67029 |  0:06:03s
epoch 21 | loss: 0.56961 | train_auc: 0.76677 | train_balanced_accuracy: 0.69585 | train_accuracy: 0.69637 | valid_auc: 0.73998 | valid_balanced_accuracy: 0.68074 | valid_accuracy: 0.6813  |  0:06:19s
epoch 22 | loss: 0.57213 | train_auc: 0.77145 | train_balanced_accuracy: 0.69606 | train_accuracy: 0.69661 | valid_auc: 0.7428  | valid_balanced_accuracy: 0.67952 | valid_accuracy: 0.68004 |  0:06:36s
epoch 23 | loss: 0.5703  | train_auc: 0.77479 | train_balanced_accuracy: 0.7056  | train_accuracy: 0.70589 | valid_auc: 0.74549 | valid_balanced_accuracy: 0.68652 | valid_accuracy: 0.68681 |  0:06:53s
epoch 24 | loss: 0.57095 | train_auc: 0.7763  | train_balanced_accuracy: 0.70188 | train_accuracy: 0.70223 | valid_auc: 0.74449 | valid_balanced_accuracy: 0.68109 | valid_accuracy: 0.68146 |  0:07:10s
epoch 25 | loss: 0.56574 | train_auc: 0.78119 | train_balanced_accuracy: 0.70741 | train_accuracy: 0.7077  | valid_auc: 0.74953 | valid_balanced_accuracy: 0.69187 | valid_accuracy: 0.69216 |  0:07:28s
epoch 26 | loss: 0.56498 | train_auc: 0.77778 | train_balanced_accuracy: 0.70464 | train_accuracy: 0.70507 | valid_auc: 0.74451 | valid_balanced_accuracy: 0.6855  | valid_accuracy: 0.68587 |  0:07:46s
epoch 27 | loss: 0.56728 | train_auc: 0.78692 | train_balanced_accuracy: 0.71207 | train_accuracy: 0.71227 | valid_auc: 0.75724 | valid_balanced_accuracy: 0.69102 | valid_accuracy: 0.69122 |  0:08:02s
epoch 28 | loss: 0.56156 | train_auc: 0.78469 | train_balanced_accuracy: 0.71129 | train_accuracy: 0.71144 | valid_auc: 0.7524  | valid_balanced_accuracy: 0.68544 | valid_accuracy: 0.68555 |  0:08:18s
epoch 29 | loss: 0.5604  | train_auc: 0.78321 | train_balanced_accuracy: 0.71039 | train_accuracy: 0.71038 | valid_auc: 0.75061 | valid_balanced_accuracy: 0.6933  | valid_accuracy: 0.69326 |  0:08:36s
epoch 30 | loss: 0.56326 | train_auc: 0.7877  | train_balanced_accuracy: 0.71469 | train_accuracy: 0.7149  | valid_auc: 0.75232 | valid_balanced_accuracy: 0.68791 | valid_accuracy: 0.68807 |  0:08:52s
epoch 31 | loss: 0.56111 | train_auc: 0.78702 | train_balanced_accuracy: 0.71259 | train_accuracy: 0.71278 | valid_auc: 0.74885 | valid_balanced_accuracy: 0.68604 | valid_accuracy: 0.68618 |  0:09:11s
epoch 32 | loss: 0.552   | train_auc: 0.79229 | train_balanced_accuracy: 0.7164  | train_accuracy: 0.7164  | valid_auc: 0.75323 | valid_balanced_accuracy: 0.68651 | valid_accuracy: 0.6865  |  0:09:29s
epoch 33 | loss: 0.55838 | train_auc: 0.79159 | train_balanced_accuracy: 0.71658 | train_accuracy: 0.71699 | valid_auc: 0.75207 | valid_balanced_accuracy: 0.688   | valid_accuracy: 0.68839 |  0:09:47s
epoch 34 | loss: 0.55864 | train_auc: 0.78927 | train_balanced_accuracy: 0.71342 | train_accuracy: 0.71337 | valid_auc: 0.75259 | valid_balanced_accuracy: 0.68156 | valid_accuracy: 0.68146 |  0:10:05s
epoch 35 | loss: 0.5521  | train_auc: 0.79158 | train_balanced_accuracy: 0.71314 | train_accuracy: 0.71357 | valid_auc: 0.74923 | valid_balanced_accuracy: 0.68011 | valid_accuracy: 0.68052 |  0:10:23s
epoch 36 | loss: 0.55372 | train_auc: 0.78213 | train_balanced_accuracy: 0.70638 | train_accuracy: 0.70613 | valid_auc: 0.74794 | valid_balanced_accuracy: 0.67542 | valid_accuracy: 0.67517 |  0:10:39s
epoch 37 | loss: 0.55962 | train_auc: 0.7953  | train_balanced_accuracy: 0.71937 | train_accuracy: 0.71959 | valid_auc: 0.7545  | valid_balanced_accuracy: 0.68932 | valid_accuracy: 0.68949 |  0:10:55s
epoch 38 | loss: 0.55142 | train_auc: 0.79507 | train_balanced_accuracy: 0.71906 | train_accuracy: 0.719   | valid_auc: 0.75636 | valid_balanced_accuracy: 0.68467 | valid_accuracy: 0.68461 |  0:11:13s
epoch 39 | loss: 0.54924 | train_auc: 0.79571 | train_balanced_accuracy: 0.71788 | train_accuracy: 0.71789 | valid_auc: 0.75544 | valid_balanced_accuracy: 0.69009 | valid_accuracy: 0.69012 |  0:11:30s
epoch 40 | loss: 0.55518 | train_auc: 0.78967 | train_balanced_accuracy: 0.71072 | train_accuracy: 0.71101 | valid_auc: 0.7439  | valid_balanced_accuracy: 0.67776 | valid_accuracy: 0.678   |  0:11:47s
epoch 41 | loss: 0.55114 | train_auc: 0.79999 | train_balanced_accuracy: 0.72293 | train_accuracy: 0.72328 | valid_auc: 0.75305 | valid_balanced_accuracy: 0.68479 | valid_accuracy: 0.68508 |  0:12:04s
epoch 42 | loss: 0.54741 | train_auc: 0.79743 | train_balanced_accuracy: 0.71681 | train_accuracy: 0.71738 | valid_auc: 0.75395 | valid_balanced_accuracy: 0.68893 | valid_accuracy: 0.68949 |  0:12:21s
epoch 43 | loss: 0.55102 | train_auc: 0.79753 | train_balanced_accuracy: 0.7174  | train_accuracy: 0.71726 | valid_auc: 0.7492  | valid_balanced_accuracy: 0.68477 | valid_accuracy: 0.68461 |  0:12:38s
epoch 44 | loss: 0.55444 | train_auc: 0.80127 | train_balanced_accuracy: 0.72143 | train_accuracy: 0.72163 | valid_auc: 0.75715 | valid_balanced_accuracy: 0.6884  | valid_accuracy: 0.68854 |  0:12:56s
epoch 45 | loss: 0.54833 | train_auc: 0.80175 | train_balanced_accuracy: 0.72345 | train_accuracy: 0.72395 | valid_auc: 0.75384 | valid_balanced_accuracy: 0.6868  | valid_accuracy: 0.68728 |  0:13:12s
epoch 46 | loss: 0.54845 | train_auc: 0.80168 | train_balanced_accuracy: 0.72629 | train_accuracy: 0.72643 | valid_auc: 0.75551 | valid_balanced_accuracy: 0.69221 | valid_accuracy: 0.69232 |  0:13:30s
epoch 47 | loss: 0.54618 | train_auc: 0.80461 | train_balanced_accuracy: 0.72592 | train_accuracy: 0.7262  | valid_auc: 0.756   | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.68996 |  0:13:45s
epoch 48 | loss: 0.54421 | train_auc: 0.80526 | train_balanced_accuracy: 0.72722 | train_accuracy: 0.72749 | valid_auc: 0.75763 | valid_balanced_accuracy: 0.69082 | valid_accuracy: 0.69106 |  0:14:01s
epoch 49 | loss: 0.54501 | train_auc: 0.79605 | train_balanced_accuracy: 0.71665 | train_accuracy: 0.71707 | valid_auc: 0.7503  | valid_balanced_accuracy: 0.68739 | valid_accuracy: 0.68776 |  0:14:19s

Early stopping occurred at epoch 49 with best_epoch = 29 and best_valid_accuracy = 0.69326
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 64/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.694 total time=14.5min
[CV 4/5; 64/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70074 | train_auc: 0.60371 | train_balanced_accuracy: 0.51973 | train_accuracy: 0.51645 | valid_auc: 0.61856 | valid_balanced_accuracy: 0.51671 | valid_accuracy: 0.51338 |  0:00:17s
epoch 1  | loss: 0.65233 | train_auc: 0.67199 | train_balanced_accuracy: 0.59525 | train_accuracy: 0.59368 | valid_auc: 0.66608 | valid_balanced_accuracy: 0.59082 | valid_accuracy: 0.58924 |  0:00:33s
epoch 2  | loss: 0.62247 | train_auc: 0.69454 | train_balanced_accuracy: 0.6239  | train_accuracy: 0.62563 | valid_auc: 0.69923 | valid_balanced_accuracy: 0.63125 | valid_accuracy: 0.63299 |  0:00:51s
epoch 3  | loss: 0.61469 | train_auc: 0.69033 | train_balanced_accuracy: 0.62518 | train_accuracy: 0.62693 | valid_auc: 0.69495 | valid_balanced_accuracy: 0.62729 | valid_accuracy: 0.62905 |  0:01:07s
epoch 4  | loss: 0.60815 | train_auc: 0.70364 | train_balanced_accuracy: 0.61642 | train_accuracy: 0.61835 | valid_auc: 0.70844 | valid_balanced_accuracy: 0.62111 | valid_accuracy: 0.62307 |  0:01:26s
epoch 5  | loss: 0.60365 | train_auc: 0.70031 | train_balanced_accuracy: 0.63754 | train_accuracy: 0.63893 | valid_auc: 0.70515 | valid_balanced_accuracy: 0.64529 | valid_accuracy: 0.64668 |  0:01:42s
epoch 6  | loss: 0.59916 | train_auc: 0.70923 | train_balanced_accuracy: 0.63925 | train_accuracy: 0.64062 | valid_auc: 0.71291 | valid_balanced_accuracy: 0.6437  | valid_accuracy: 0.64511 |  0:02:00s
epoch 7  | loss: 0.59243 | train_auc: 0.71372 | train_balanced_accuracy: 0.65432 | train_accuracy: 0.65537 | valid_auc: 0.71493 | valid_balanced_accuracy: 0.65754 | valid_accuracy: 0.65864 |  0:02:18s
epoch 8  | loss: 0.58852 | train_auc: 0.71626 | train_balanced_accuracy: 0.65668 | train_accuracy: 0.65789 | valid_auc: 0.71291 | valid_balanced_accuracy: 0.65312 | valid_accuracy: 0.65439 |  0:02:35s
epoch 9  | loss: 0.58724 | train_auc: 0.72549 | train_balanced_accuracy: 0.64713 | train_accuracy: 0.64865 | valid_auc: 0.72099 | valid_balanced_accuracy: 0.64435 | valid_accuracy: 0.64589 |  0:02:55s
epoch 10 | loss: 0.57994 | train_auc: 0.73223 | train_balanced_accuracy: 0.66885 | train_accuracy: 0.6697  | valid_auc: 0.72502 | valid_balanced_accuracy: 0.66046 | valid_accuracy: 0.66132 |  0:03:13s
epoch 11 | loss: 0.58239 | train_auc: 0.72677 | train_balanced_accuracy: 0.67232 | train_accuracy: 0.67292 | valid_auc: 0.71847 | valid_balanced_accuracy: 0.66366 | valid_accuracy: 0.66431 |  0:03:30s
epoch 12 | loss: 0.58219 | train_auc: 0.73329 | train_balanced_accuracy: 0.67401 | train_accuracy: 0.67469 | valid_auc: 0.72318 | valid_balanced_accuracy: 0.66581 | valid_accuracy: 0.66651 |  0:03:47s
epoch 13 | loss: 0.57949 | train_auc: 0.73968 | train_balanced_accuracy: 0.67315 | train_accuracy: 0.67379 | valid_auc: 0.72858 | valid_balanced_accuracy: 0.66709 | valid_accuracy: 0.66777 |  0:04:04s
epoch 14 | loss: 0.5794  | train_auc: 0.73876 | train_balanced_accuracy: 0.68027 | train_accuracy: 0.68063 | valid_auc: 0.72948 | valid_balanced_accuracy: 0.66832 | valid_accuracy: 0.66871 |  0:04:19s
epoch 15 | loss: 0.58091 | train_auc: 0.74588 | train_balanced_accuracy: 0.6769  | train_accuracy: 0.6776  | valid_auc: 0.73282 | valid_balanced_accuracy: 0.66724 | valid_accuracy: 0.66793 |  0:04:37s
epoch 16 | loss: 0.57056 | train_auc: 0.74998 | train_balanced_accuracy: 0.68105 | train_accuracy: 0.6815  | valid_auc: 0.73356 | valid_balanced_accuracy: 0.67183 | valid_accuracy: 0.67233 |  0:04:53s
epoch 17 | loss: 0.57293 | train_auc: 0.74922 | train_balanced_accuracy: 0.67916 | train_accuracy: 0.67989 | valid_auc: 0.7352  | valid_balanced_accuracy: 0.66436 | valid_accuracy: 0.66509 |  0:05:14s
epoch 18 | loss: 0.57568 | train_auc: 0.75731 | train_balanced_accuracy: 0.68229 | train_accuracy: 0.68284 | valid_auc: 0.73744 | valid_balanced_accuracy: 0.67288 | valid_accuracy: 0.67343 |  0:05:32s
epoch 19 | loss: 0.57004 | train_auc: 0.7546  | train_balanced_accuracy: 0.68577 | train_accuracy: 0.68634 | valid_auc: 0.73827 | valid_balanced_accuracy: 0.67206 | valid_accuracy: 0.67265 |  0:05:49s
epoch 20 | loss: 0.56954 | train_auc: 0.75601 | train_balanced_accuracy: 0.68566 | train_accuracy: 0.68622 | valid_auc: 0.73958 | valid_balanced_accuracy: 0.66923 | valid_accuracy: 0.66981 |  0:06:08s
epoch 21 | loss: 0.56811 | train_auc: 0.76594 | train_balanced_accuracy: 0.68861 | train_accuracy: 0.68925 | valid_auc: 0.74383 | valid_balanced_accuracy: 0.67751 | valid_accuracy: 0.67816 |  0:06:26s
epoch 22 | loss: 0.56797 | train_auc: 0.76745 | train_balanced_accuracy: 0.68859 | train_accuracy: 0.68894 | valid_auc: 0.73902 | valid_balanced_accuracy: 0.66961 | valid_accuracy: 0.66997 |  0:06:43s
epoch 23 | loss: 0.56678 | train_auc: 0.77311 | train_balanced_accuracy: 0.6968  | train_accuracy: 0.69704 | valid_auc: 0.74621 | valid_balanced_accuracy: 0.67709 | valid_accuracy: 0.67737 |  0:07:00s
epoch 24 | loss: 0.56704 | train_auc: 0.76697 | train_balanced_accuracy: 0.69366 | train_accuracy: 0.69417 | valid_auc: 0.73558 | valid_balanced_accuracy: 0.67292 | valid_accuracy: 0.67343 |  0:07:18s
epoch 25 | loss: 0.56393 | train_auc: 0.77851 | train_balanced_accuracy: 0.70688 | train_accuracy: 0.70703 | valid_auc: 0.74633 | valid_balanced_accuracy: 0.68086 | valid_accuracy: 0.68099 |  0:07:36s
epoch 26 | loss: 0.55993 | train_auc: 0.77481 | train_balanced_accuracy: 0.69705 | train_accuracy: 0.69728 | valid_auc: 0.74769 | valid_balanced_accuracy: 0.67558 | valid_accuracy: 0.67579 |  0:07:52s
epoch 27 | loss: 0.56209 | train_auc: 0.78457 | train_balanced_accuracy: 0.70581 | train_accuracy: 0.70644 | valid_auc: 0.75853 | valid_balanced_accuracy: 0.68755 | valid_accuracy: 0.68823 |  0:08:08s
epoch 28 | loss: 0.55955 | train_auc: 0.78195 | train_balanced_accuracy: 0.70609 | train_accuracy: 0.70621 | valid_auc: 0.74913 | valid_balanced_accuracy: 0.68133 | valid_accuracy: 0.68146 |  0:08:25s
epoch 29 | loss: 0.55981 | train_auc: 0.78396 | train_balanced_accuracy: 0.70713 | train_accuracy: 0.70723 | valid_auc: 0.75226 | valid_balanced_accuracy: 0.6842  | valid_accuracy: 0.68429 |  0:08:40s
epoch 30 | loss: 0.55551 | train_auc: 0.78643 | train_balanced_accuracy: 0.70799 | train_accuracy: 0.70802 | valid_auc: 0.75443 | valid_balanced_accuracy: 0.69102 | valid_accuracy: 0.69106 |  0:08:58s
epoch 31 | loss: 0.55825 | train_auc: 0.78417 | train_balanced_accuracy: 0.70761 | train_accuracy: 0.70747 | valid_auc: 0.74851 | valid_balanced_accuracy: 0.68029 | valid_accuracy: 0.6802  |  0:09:14s
epoch 32 | loss: 0.55255 | train_auc: 0.78328 | train_balanced_accuracy: 0.70281 | train_accuracy: 0.70235 | valid_auc: 0.74451 | valid_balanced_accuracy: 0.6734  | valid_accuracy: 0.67296 |  0:09:30s
epoch 33 | loss: 0.55532 | train_auc: 0.78911 | train_balanced_accuracy: 0.71236 | train_accuracy: 0.71239 | valid_auc: 0.74885 | valid_balanced_accuracy: 0.68167 | valid_accuracy: 0.68178 |  0:09:49s
epoch 34 | loss: 0.5563  | train_auc: 0.78955 | train_balanced_accuracy: 0.71401 | train_accuracy: 0.71404 | valid_auc: 0.75369 | valid_balanced_accuracy: 0.68707 | valid_accuracy: 0.68713 |  0:10:06s
epoch 35 | loss: 0.54649 | train_auc: 0.79312 | train_balanced_accuracy: 0.71576 | train_accuracy: 0.71605 | valid_auc: 0.75105 | valid_balanced_accuracy: 0.68244 | valid_accuracy: 0.68272 |  0:10:23s
epoch 36 | loss: 0.54635 | train_auc: 0.79228 | train_balanced_accuracy: 0.71266 | train_accuracy: 0.71313 | valid_auc: 0.75379 | valid_balanced_accuracy: 0.69026 | valid_accuracy: 0.69075 |  0:10:40s
epoch 37 | loss: 0.55071 | train_auc: 0.80039 | train_balanced_accuracy: 0.71955 | train_accuracy: 0.71986 | valid_auc: 0.75627 | valid_balanced_accuracy: 0.69311 | valid_accuracy: 0.69342 |  0:10:57s
epoch 38 | loss: 0.55334 | train_auc: 0.78034 | train_balanced_accuracy: 0.70179 | train_accuracy: 0.70231 | valid_auc: 0.74748 | valid_balanced_accuracy: 0.68139 | valid_accuracy: 0.68193 |  0:11:15s
epoch 39 | loss: 0.54854 | train_auc: 0.79348 | train_balanced_accuracy: 0.71326 | train_accuracy: 0.71392 | valid_auc: 0.7521  | valid_balanced_accuracy: 0.68693 | valid_accuracy: 0.6876  |  0:11:31s
epoch 40 | loss: 0.54657 | train_auc: 0.79633 | train_balanced_accuracy: 0.71707 | train_accuracy: 0.71742 | valid_auc: 0.75803 | valid_balanced_accuracy: 0.69085 | valid_accuracy: 0.69122 |  0:11:48s
epoch 41 | loss: 0.5473  | train_auc: 0.80261 | train_balanced_accuracy: 0.72271 | train_accuracy: 0.72297 | valid_auc: 0.7545  | valid_balanced_accuracy: 0.68921 | valid_accuracy: 0.68949 |  0:12:07s
epoch 42 | loss: 0.5456  | train_auc: 0.80041 | train_balanced_accuracy: 0.72128 | train_accuracy: 0.72151 | valid_auc: 0.75667 | valid_balanced_accuracy: 0.68855 | valid_accuracy: 0.68886 |  0:12:24s
epoch 43 | loss: 0.54813 | train_auc: 0.7935  | train_balanced_accuracy: 0.71345 | train_accuracy: 0.71325 | valid_auc: 0.74756 | valid_balanced_accuracy: 0.67695 | valid_accuracy: 0.67674 |  0:12:41s
epoch 44 | loss: 0.55072 | train_auc: 0.77716 | train_balanced_accuracy: 0.69869 | train_accuracy: 0.69838 | valid_auc: 0.74123 | valid_balanced_accuracy: 0.6693  | valid_accuracy: 0.66903 |  0:12:57s
epoch 45 | loss: 0.54438 | train_auc: 0.79851 | train_balanced_accuracy: 0.71907 | train_accuracy: 0.71919 | valid_auc: 0.75276 | valid_balanced_accuracy: 0.68286 | valid_accuracy: 0.68303 |  0:13:15s
epoch 46 | loss: 0.54674 | train_auc: 0.78389 | train_balanced_accuracy: 0.70477 | train_accuracy: 0.7044  | valid_auc: 0.74328 | valid_balanced_accuracy: 0.67959 | valid_accuracy: 0.67926 |  0:13:33s
epoch 47 | loss: 0.54834 | train_auc: 0.79411 | train_balanced_accuracy: 0.70999 | train_accuracy: 0.71081 | valid_auc: 0.75525 | valid_balanced_accuracy: 0.67793 | valid_accuracy: 0.67879 |  0:13:50s
epoch 48 | loss: 0.54465 | train_auc: 0.80413 | train_balanced_accuracy: 0.72441 | train_accuracy: 0.72435 | valid_auc: 0.75719 | valid_balanced_accuracy: 0.68778 | valid_accuracy: 0.68776 |  0:14:06s
epoch 49 | loss: 0.54125 | train_auc: 0.80839 | train_balanced_accuracy: 0.72569 | train_accuracy: 0.726   | valid_auc: 0.76196 | valid_balanced_accuracy: 0.68726 | valid_accuracy: 0.6876  |  0:14:24s
epoch 50 | loss: 0.54467 | train_auc: 0.80861 | train_balanced_accuracy: 0.72574 | train_accuracy: 0.72596 | valid_auc: 0.76143 | valid_balanced_accuracy: 0.69662 | valid_accuracy: 0.69688 |  0:14:42s
epoch 51 | loss: 0.5375  | train_auc: 0.77456 | train_balanced_accuracy: 0.69286 | train_accuracy: 0.69381 | valid_auc: 0.74366 | valid_balanced_accuracy: 0.67218 | valid_accuracy: 0.67312 |  0:15:01s
epoch 52 | loss: 0.53519 | train_auc: 0.81303 | train_balanced_accuracy: 0.73093 | train_accuracy: 0.73092 | valid_auc: 0.76078 | valid_balanced_accuracy: 0.69466 | valid_accuracy: 0.69468 |  0:15:18s
epoch 53 | loss: 0.5392  | train_auc: 0.80868 | train_balanced_accuracy: 0.72593 | train_accuracy: 0.72612 | valid_auc: 0.76496 | valid_balanced_accuracy: 0.6915  | valid_accuracy: 0.69169 |  0:15:34s
epoch 54 | loss: 0.54573 | train_auc: 0.80816 | train_balanced_accuracy: 0.72597 | train_accuracy: 0.72616 | valid_auc: 0.76391 | valid_balanced_accuracy: 0.69607 | valid_accuracy: 0.69625 |  0:15:52s
epoch 55 | loss: 0.5386  | train_auc: 0.80789 | train_balanced_accuracy: 0.72505 | train_accuracy: 0.72541 | valid_auc: 0.76067 | valid_balanced_accuracy: 0.68784 | valid_accuracy: 0.68823 |  0:16:08s
epoch 56 | loss: 0.53888 | train_auc: 0.7871  | train_balanced_accuracy: 0.7099  | train_accuracy: 0.71042 | valid_auc: 0.74918 | valid_balanced_accuracy: 0.68017 | valid_accuracy: 0.68067 |  0:16:26s
epoch 57 | loss: 0.54148 | train_auc: 0.81548 | train_balanced_accuracy: 0.7328  | train_accuracy: 0.733   | valid_auc: 0.76401 | valid_balanced_accuracy: 0.69147 | valid_accuracy: 0.69169 |  0:16:43s
epoch 58 | loss: 0.53844 | train_auc: 0.81    | train_balanced_accuracy: 0.72733 | train_accuracy: 0.72734 | valid_auc: 0.76005 | valid_balanced_accuracy: 0.68727 | valid_accuracy: 0.68728 |  0:17:01s
epoch 59 | loss: 0.53636 | train_auc: 0.80687 | train_balanced_accuracy: 0.72138 | train_accuracy: 0.72163 | valid_auc: 0.76156 | valid_balanced_accuracy: 0.69159 | valid_accuracy: 0.69185 |  0:17:17s
epoch 60 | loss: 0.53559 | train_auc: 0.81716 | train_balanced_accuracy: 0.73468 | train_accuracy: 0.73481 | valid_auc: 0.76522 | valid_balanced_accuracy: 0.69044 | valid_accuracy: 0.69059 |  0:17:34s
epoch 61 | loss: 0.52832 | train_auc: 0.81546 | train_balanced_accuracy: 0.73248 | train_accuracy: 0.73265 | valid_auc: 0.76425 | valid_balanced_accuracy: 0.6932  | valid_accuracy: 0.69342 |  0:17:52s
epoch 62 | loss: 0.53137 | train_auc: 0.81357 | train_balanced_accuracy: 0.72926 | train_accuracy: 0.72919 | valid_auc: 0.7612  | valid_balanced_accuracy: 0.68796 | valid_accuracy: 0.68791 |  0:18:09s
epoch 63 | loss: 0.53191 | train_auc: 0.8164  | train_balanced_accuracy: 0.73309 | train_accuracy: 0.73336 | valid_auc: 0.76859 | valid_balanced_accuracy: 0.69481 | valid_accuracy: 0.69515 |  0:18:27s
epoch 64 | loss: 0.52602 | train_auc: 0.81891 | train_balanced_accuracy: 0.73639 | train_accuracy: 0.73627 | valid_auc: 0.76451 | valid_balanced_accuracy: 0.69351 | valid_accuracy: 0.69342 |  0:18:44s
epoch 65 | loss: 0.5273  | train_auc: 0.81312 | train_balanced_accuracy: 0.72936 | train_accuracy: 0.72919 | valid_auc: 0.75793 | valid_balanced_accuracy: 0.68947 | valid_accuracy: 0.68933 |  0:19:01s
epoch 66 | loss: 0.53207 | train_auc: 0.81735 | train_balanced_accuracy: 0.73378 | train_accuracy: 0.73379 | valid_auc: 0.76197 | valid_balanced_accuracy: 0.69151 | valid_accuracy: 0.69153 |  0:19:18s
epoch 67 | loss: 0.52731 | train_auc: 0.74718 | train_balanced_accuracy: 0.67727 | train_accuracy: 0.67808 | valid_auc: 0.71669 | valid_balanced_accuracy: 0.65228 | valid_accuracy: 0.65313 |  0:19:34s
epoch 68 | loss: 0.52875 | train_auc: 0.7735  | train_balanced_accuracy: 0.69246 | train_accuracy: 0.69338 | valid_auc: 0.73738 | valid_balanced_accuracy: 0.6683  | valid_accuracy: 0.66918 |  0:19:50s
epoch 69 | loss: 0.53173 | train_auc: 0.78282 | train_balanced_accuracy: 0.70523 | train_accuracy: 0.70593 | valid_auc: 0.74697 | valid_balanced_accuracy: 0.67397 | valid_accuracy: 0.67469 |  0:20:08s
epoch 70 | loss: 0.52547 | train_auc: 0.80194 | train_balanced_accuracy: 0.71789 | train_accuracy: 0.71837 | valid_auc: 0.75921 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.68571 |  0:20:27s

Early stopping occurred at epoch 70 with best_epoch = 50 and best_valid_accuracy = 0.69688
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 64/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.687 total time=20.6min
[CV 5/5; 64/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68515 | train_auc: 0.61617 | train_balanced_accuracy: 0.54117 | train_accuracy: 0.53872 | valid_auc: 0.60906 | valid_balanced_accuracy: 0.5425  | valid_accuracy: 0.53997 |  0:00:15s
epoch 1  | loss: 0.62944 | train_auc: 0.66832 | train_balanced_accuracy: 0.59848 | train_accuracy: 0.59671 | valid_auc: 0.67067 | valid_balanced_accuracy: 0.59543 | valid_accuracy: 0.59364 |  0:00:32s
epoch 2  | loss: 0.62171 | train_auc: 0.68873 | train_balanced_accuracy: 0.5844  | train_accuracy: 0.58211 | valid_auc: 0.68675 | valid_balanced_accuracy: 0.58417 | valid_accuracy: 0.58184 |  0:00:50s
epoch 3  | loss: 0.61407 | train_auc: 0.69292 | train_balanced_accuracy: 0.61101 | train_accuracy: 0.60942 | valid_auc: 0.6917  | valid_balanced_accuracy: 0.61269 | valid_accuracy: 0.61111 |  0:01:08s
epoch 4  | loss: 0.60511 | train_auc: 0.68579 | train_balanced_accuracy: 0.61959 | train_accuracy: 0.61835 | valid_auc: 0.68382 | valid_balanced_accuracy: 0.6204  | valid_accuracy: 0.61914 |  0:01:25s
epoch 5  | loss: 0.60134 | train_auc: 0.69962 | train_balanced_accuracy: 0.63338 | train_accuracy: 0.63291 | valid_auc: 0.69563 | valid_balanced_accuracy: 0.62782 | valid_accuracy: 0.62732 |  0:01:42s
epoch 6  | loss: 0.60124 | train_auc: 0.71123 | train_balanced_accuracy: 0.64203 | train_accuracy: 0.64149 | valid_auc: 0.70513 | valid_balanced_accuracy: 0.63557 | valid_accuracy: 0.63503 |  0:01:59s
epoch 7  | loss: 0.59954 | train_auc: 0.70999 | train_balanced_accuracy: 0.65618 | train_accuracy: 0.65667 | valid_auc: 0.70423 | valid_balanced_accuracy: 0.65017 | valid_accuracy: 0.65061 |  0:02:17s
epoch 8  | loss: 0.59939 | train_auc: 0.71509 | train_balanced_accuracy: 0.66271 | train_accuracy: 0.66348 | valid_auc: 0.71001 | valid_balanced_accuracy: 0.65795 | valid_accuracy: 0.65864 |  0:02:34s
epoch 9  | loss: 0.59737 | train_auc: 0.72259 | train_balanced_accuracy: 0.66434 | train_accuracy: 0.66497 | valid_auc: 0.71425 | valid_balanced_accuracy: 0.6595  | valid_accuracy: 0.66006 |  0:02:52s
epoch 10 | loss: 0.59459 | train_auc: 0.72824 | train_balanced_accuracy: 0.66541 | train_accuracy: 0.66604 | valid_auc: 0.72326 | valid_balanced_accuracy: 0.66106 | valid_accuracy: 0.66163 |  0:03:08s
epoch 11 | loss: 0.59239 | train_auc: 0.73193 | train_balanced_accuracy: 0.67158 | train_accuracy: 0.67229 | valid_auc: 0.72539 | valid_balanced_accuracy: 0.66398 | valid_accuracy: 0.66462 |  0:03:25s
epoch 12 | loss: 0.58621 | train_auc: 0.73782 | train_balanced_accuracy: 0.67478 | train_accuracy: 0.67528 | valid_auc: 0.72807 | valid_balanced_accuracy: 0.66512 | valid_accuracy: 0.66556 |  0:03:42s
epoch 13 | loss: 0.59414 | train_auc: 0.73959 | train_balanced_accuracy: 0.67408 | train_accuracy: 0.67477 | valid_auc: 0.73046 | valid_balanced_accuracy: 0.66508 | valid_accuracy: 0.66572 |  0:04:00s
epoch 14 | loss: 0.58397 | train_auc: 0.73833 | train_balanced_accuracy: 0.66664 | train_accuracy: 0.6669  | valid_auc: 0.73187 | valid_balanced_accuracy: 0.66595 | valid_accuracy: 0.66619 |  0:04:18s
epoch 15 | loss: 0.58255 | train_auc: 0.74498 | train_balanced_accuracy: 0.67663 | train_accuracy: 0.67729 | valid_auc: 0.73883 | valid_balanced_accuracy: 0.664   | valid_accuracy: 0.66462 |  0:04:34s
epoch 16 | loss: 0.582   | train_auc: 0.74688 | train_balanced_accuracy: 0.6773  | train_accuracy: 0.67757 | valid_auc: 0.73904 | valid_balanced_accuracy: 0.6679  | valid_accuracy: 0.66808 |  0:04:52s
epoch 17 | loss: 0.5811  | train_auc: 0.75182 | train_balanced_accuracy: 0.6796  | train_accuracy: 0.68012 | valid_auc: 0.74142 | valid_balanced_accuracy: 0.66918 | valid_accuracy: 0.66966 |  0:05:13s
epoch 18 | loss: 0.57749 | train_auc: 0.75551 | train_balanced_accuracy: 0.683   | train_accuracy: 0.68359 | valid_auc: 0.74255 | valid_balanced_accuracy: 0.67318 | valid_accuracy: 0.67375 |  0:05:30s
epoch 19 | loss: 0.57674 | train_auc: 0.75871 | train_balanced_accuracy: 0.68511 | train_accuracy: 0.68579 | valid_auc: 0.7469  | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67375 |  0:05:48s
epoch 20 | loss: 0.57853 | train_auc: 0.76098 | train_balanced_accuracy: 0.68835 | train_accuracy: 0.68882 | valid_auc: 0.74284 | valid_balanced_accuracy: 0.67361 | valid_accuracy: 0.67406 |  0:06:05s
epoch 21 | loss: 0.57438 | train_auc: 0.7602  | train_balanced_accuracy: 0.6897  | train_accuracy: 0.69012 | valid_auc: 0.74373 | valid_balanced_accuracy: 0.67449 | valid_accuracy: 0.67485 |  0:06:23s
epoch 22 | loss: 0.57108 | train_auc: 0.76488 | train_balanced_accuracy: 0.69188 | train_accuracy: 0.69228 | valid_auc: 0.74684 | valid_balanced_accuracy: 0.67826 | valid_accuracy: 0.67863 |  0:06:40s
epoch 23 | loss: 0.57156 | train_auc: 0.76075 | train_balanced_accuracy: 0.69176 | train_accuracy: 0.69216 | valid_auc: 0.74337 | valid_balanced_accuracy: 0.6754  | valid_accuracy: 0.67579 |  0:06:59s
epoch 24 | loss: 0.57529 | train_auc: 0.76908 | train_balanced_accuracy: 0.69786 | train_accuracy: 0.69842 | valid_auc: 0.75057 | valid_balanced_accuracy: 0.6779  | valid_accuracy: 0.67847 |  0:07:16s
epoch 25 | loss: 0.57126 | train_auc: 0.75443 | train_balanced_accuracy: 0.68424 | train_accuracy: 0.6841  | valid_auc: 0.73531 | valid_balanced_accuracy: 0.66385 | valid_accuracy: 0.66368 |  0:07:34s
epoch 26 | loss: 0.57192 | train_auc: 0.76755 | train_balanced_accuracy: 0.70029 | train_accuracy: 0.70054 | valid_auc: 0.74465 | valid_balanced_accuracy: 0.6831  | valid_accuracy: 0.68335 |  0:07:52s
epoch 27 | loss: 0.57023 | train_auc: 0.76305 | train_balanced_accuracy: 0.70027 | train_accuracy: 0.7005  | valid_auc: 0.7454  | valid_balanced_accuracy: 0.68765 | valid_accuracy: 0.68791 |  0:08:08s
epoch 28 | loss: 0.56678 | train_auc: 0.76761 | train_balanced_accuracy: 0.7016  | train_accuracy: 0.70164 | valid_auc: 0.75299 | valid_balanced_accuracy: 0.69209 | valid_accuracy: 0.69216 |  0:08:25s
epoch 29 | loss: 0.56981 | train_auc: 0.77584 | train_balanced_accuracy: 0.70304 | train_accuracy: 0.70298 | valid_auc: 0.75041 | valid_balanced_accuracy: 0.68371 | valid_accuracy: 0.68366 |  0:08:43s
epoch 30 | loss: 0.56883 | train_auc: 0.7685  | train_balanced_accuracy: 0.6996  | train_accuracy: 0.69976 | valid_auc: 0.74223 | valid_balanced_accuracy: 0.68101 | valid_accuracy: 0.68115 |  0:08:59s
epoch 31 | loss: 0.56601 | train_auc: 0.71487 | train_balanced_accuracy: 0.65258 | train_accuracy: 0.65286 | valid_auc: 0.70385 | valid_balanced_accuracy: 0.6415  | valid_accuracy: 0.6418  |  0:09:18s
epoch 32 | loss: 0.56447 | train_auc: 0.75157 | train_balanced_accuracy: 0.67902 | train_accuracy: 0.6789  | valid_auc: 0.7296  | valid_balanced_accuracy: 0.66323 | valid_accuracy: 0.66305 |  0:09:35s
epoch 33 | loss: 0.56951 | train_auc: 0.76833 | train_balanced_accuracy: 0.69732 | train_accuracy: 0.69779 | valid_auc: 0.74509 | valid_balanced_accuracy: 0.67881 | valid_accuracy: 0.67926 |  0:09:52s
epoch 34 | loss: 0.56149 | train_auc: 0.746   | train_balanced_accuracy: 0.67644 | train_accuracy: 0.67662 | valid_auc: 0.72565 | valid_balanced_accuracy: 0.65831 | valid_accuracy: 0.65848 |  0:10:11s
epoch 35 | loss: 0.56133 | train_auc: 0.74391 | train_balanced_accuracy: 0.67364 | train_accuracy: 0.67363 | valid_auc: 0.72874 | valid_balanced_accuracy: 0.66403 | valid_accuracy: 0.66399 |  0:10:29s
epoch 36 | loss: 0.55773 | train_auc: 0.76184 | train_balanced_accuracy: 0.68998 | train_accuracy: 0.69    | valid_auc: 0.74046 | valid_balanced_accuracy: 0.67058 | valid_accuracy: 0.6706  |  0:10:46s
epoch 37 | loss: 0.55876 | train_auc: 0.77925 | train_balanced_accuracy: 0.70206 | train_accuracy: 0.70243 | valid_auc: 0.74623 | valid_balanced_accuracy: 0.67209 | valid_accuracy: 0.67249 |  0:11:03s
epoch 38 | loss: 0.55815 | train_auc: 0.78941 | train_balanced_accuracy: 0.71123 | train_accuracy: 0.71097 | valid_auc: 0.75421 | valid_balanced_accuracy: 0.68144 | valid_accuracy: 0.68115 |  0:11:20s
epoch 39 | loss: 0.55642 | train_auc: 0.79297 | train_balanced_accuracy: 0.71473 | train_accuracy: 0.71514 | valid_auc: 0.75501 | valid_balanced_accuracy: 0.68518 | valid_accuracy: 0.68555 |  0:11:38s
epoch 40 | loss: 0.55595 | train_auc: 0.79456 | train_balanced_accuracy: 0.71719 | train_accuracy: 0.71746 | valid_auc: 0.76259 | valid_balanced_accuracy: 0.69583 | valid_accuracy: 0.6961  |  0:11:55s
epoch 41 | loss: 0.55334 | train_auc: 0.79075 | train_balanced_accuracy: 0.71706 | train_accuracy: 0.71726 | valid_auc: 0.75773 | valid_balanced_accuracy: 0.68882 | valid_accuracy: 0.68901 |  0:12:13s
epoch 42 | loss: 0.55606 | train_auc: 0.79087 | train_balanced_accuracy: 0.71508 | train_accuracy: 0.71561 | valid_auc: 0.75462 | valid_balanced_accuracy: 0.68597 | valid_accuracy: 0.6865  |  0:12:30s
epoch 43 | loss: 0.55208 | train_auc: 0.79675 | train_balanced_accuracy: 0.72093 | train_accuracy: 0.72088 | valid_auc: 0.76185 | valid_balanced_accuracy: 0.69222 | valid_accuracy: 0.69216 |  0:12:49s
epoch 44 | loss: 0.55084 | train_auc: 0.79883 | train_balanced_accuracy: 0.72282 | train_accuracy: 0.72309 | valid_auc: 0.76248 | valid_balanced_accuracy: 0.69432 | valid_accuracy: 0.69452 |  0:13:05s
epoch 45 | loss: 0.55075 | train_auc: 0.79532 | train_balanced_accuracy: 0.71583 | train_accuracy: 0.7164  | valid_auc: 0.7588  | valid_balanced_accuracy: 0.68532 | valid_accuracy: 0.68587 |  0:13:23s
epoch 46 | loss: 0.55159 | train_auc: 0.80144 | train_balanced_accuracy: 0.72241 | train_accuracy: 0.72258 | valid_auc: 0.76178 | valid_balanced_accuracy: 0.69372 | valid_accuracy: 0.69389 |  0:13:43s
epoch 47 | loss: 0.55349 | train_auc: 0.79671 | train_balanced_accuracy: 0.72111 | train_accuracy: 0.72128 | valid_auc: 0.75806 | valid_balanced_accuracy: 0.69185 | valid_accuracy: 0.69201 |  0:13:58s
epoch 48 | loss: 0.55118 | train_auc: 0.8015  | train_balanced_accuracy: 0.72368 | train_accuracy: 0.72372 | valid_auc: 0.76496 | valid_balanced_accuracy: 0.69548 | valid_accuracy: 0.69547 |  0:14:16s
epoch 49 | loss: 0.54385 | train_auc: 0.80142 | train_balanced_accuracy: 0.72162 | train_accuracy: 0.72187 | valid_auc: 0.75541 | valid_balanced_accuracy: 0.68579 | valid_accuracy: 0.68602 |  0:14:34s
epoch 50 | loss: 0.54675 | train_auc: 0.80435 | train_balanced_accuracy: 0.72572 | train_accuracy: 0.72588 | valid_auc: 0.76572 | valid_balanced_accuracy: 0.69549 | valid_accuracy: 0.69562 |  0:14:52s
epoch 51 | loss: 0.54729 | train_auc: 0.8064  | train_balanced_accuracy: 0.72558 | train_accuracy: 0.72596 | valid_auc: 0.76148 | valid_balanced_accuracy: 0.69259 | valid_accuracy: 0.69295 |  0:15:10s
epoch 52 | loss: 0.54372 | train_auc: 0.80509 | train_balanced_accuracy: 0.72667 | train_accuracy: 0.72683 | valid_auc: 0.76309 | valid_balanced_accuracy: 0.69382 | valid_accuracy: 0.69389 |  0:15:26s
epoch 53 | loss: 0.54739 | train_auc: 0.80769 | train_balanced_accuracy: 0.72958 | train_accuracy: 0.72997 | valid_auc: 0.7619  | valid_balanced_accuracy: 0.69226 | valid_accuracy: 0.69263 |  0:15:43s
epoch 54 | loss: 0.54886 | train_auc: 0.80487 | train_balanced_accuracy: 0.72565 | train_accuracy: 0.72572 | valid_auc: 0.76192 | valid_balanced_accuracy: 0.69168 | valid_accuracy: 0.69169 |  0:16:02s
epoch 55 | loss: 0.54772 | train_auc: 0.80563 | train_balanced_accuracy: 0.72509 | train_accuracy: 0.72529 | valid_auc: 0.7645  | valid_balanced_accuracy: 0.69089 | valid_accuracy: 0.69106 |  0:16:20s
epoch 56 | loss: 0.54357 | train_auc: 0.80845 | train_balanced_accuracy: 0.72657 | train_accuracy: 0.72671 | valid_auc: 0.76024 | valid_balanced_accuracy: 0.69237 | valid_accuracy: 0.69248 |  0:16:38s
epoch 57 | loss: 0.54146 | train_auc: 0.79995 | train_balanced_accuracy: 0.72083 | train_accuracy: 0.72108 | valid_auc: 0.75686 | valid_balanced_accuracy: 0.68582 | valid_accuracy: 0.68602 |  0:16:57s
epoch 58 | loss: 0.54081 | train_auc: 0.80316 | train_balanced_accuracy: 0.72253 | train_accuracy: 0.7225  | valid_auc: 0.75625 | valid_balanced_accuracy: 0.6856  | valid_accuracy: 0.68555 |  0:17:14s
epoch 59 | loss: 0.5464  | train_auc: 0.80559 | train_balanced_accuracy: 0.72546 | train_accuracy: 0.72596 | valid_auc: 0.75953 | valid_balanced_accuracy: 0.6868  | valid_accuracy: 0.68728 |  0:17:32s
epoch 60 | loss: 0.54391 | train_auc: 0.81104 | train_balanced_accuracy: 0.72909 | train_accuracy: 0.72923 | valid_auc: 0.76694 | valid_balanced_accuracy: 0.69661 | valid_accuracy: 0.69673 |  0:17:50s
epoch 61 | loss: 0.5445  | train_auc: 0.80507 | train_balanced_accuracy: 0.72531 | train_accuracy: 0.72565 | valid_auc: 0.7605  | valid_balanced_accuracy: 0.68651 | valid_accuracy: 0.68681 |  0:18:07s
epoch 62 | loss: 0.53796 | train_auc: 0.81332 | train_balanced_accuracy: 0.73169 | train_accuracy: 0.73182 | valid_auc: 0.76349 | valid_balanced_accuracy: 0.69225 | valid_accuracy: 0.69232 |  0:18:25s
epoch 63 | loss: 0.53598 | train_auc: 0.81398 | train_balanced_accuracy: 0.7294  | train_accuracy: 0.72982 | valid_auc: 0.76741 | valid_balanced_accuracy: 0.6937  | valid_accuracy: 0.69405 |  0:18:44s
epoch 64 | loss: 0.53874 | train_auc: 0.81112 | train_balanced_accuracy: 0.73013 | train_accuracy: 0.73045 | valid_auc: 0.76379 | valid_balanced_accuracy: 0.69341 | valid_accuracy: 0.69374 |  0:19:01s
epoch 65 | loss: 0.54479 | train_auc: 0.81218 | train_balanced_accuracy: 0.73182 | train_accuracy: 0.7321  | valid_auc: 0.76035 | valid_balanced_accuracy: 0.68562 | valid_accuracy: 0.68587 |  0:19:20s
epoch 66 | loss: 0.54062 | train_auc: 0.81337 | train_balanced_accuracy: 0.7331  | train_accuracy: 0.73332 | valid_auc: 0.76806 | valid_balanced_accuracy: 0.6923  | valid_accuracy: 0.69248 |  0:19:37s
epoch 67 | loss: 0.53912 | train_auc: 0.8129  | train_balanced_accuracy: 0.72955 | train_accuracy: 0.72982 | valid_auc: 0.76172 | valid_balanced_accuracy: 0.6899  | valid_accuracy: 0.69012 |  0:19:56s
epoch 68 | loss: 0.53088 | train_auc: 0.81234 | train_balanced_accuracy: 0.73065 | train_accuracy: 0.73107 | valid_auc: 0.76384 | valid_balanced_accuracy: 0.68999 | valid_accuracy: 0.69043 |  0:20:13s
epoch 69 | loss: 0.53989 | train_auc: 0.81001 | train_balanced_accuracy: 0.73029 | train_accuracy: 0.7306  | valid_auc: 0.76265 | valid_balanced_accuracy: 0.70005 | valid_accuracy: 0.70035 |  0:20:31s
epoch 70 | loss: 0.53462 | train_auc: 0.81671 | train_balanced_accuracy: 0.73648 | train_accuracy: 0.7367  | valid_auc: 0.76836 | valid_balanced_accuracy: 0.6978  | valid_accuracy: 0.69799 |  0:20:48s
epoch 71 | loss: 0.53501 | train_auc: 0.81722 | train_balanced_accuracy: 0.73495 | train_accuracy: 0.73525 | valid_auc: 0.76357 | valid_balanced_accuracy: 0.69174 | valid_accuracy: 0.69201 |  0:21:06s
epoch 72 | loss: 0.53142 | train_auc: 0.81675 | train_balanced_accuracy: 0.73299 | train_accuracy: 0.73316 | valid_auc: 0.7673  | valid_balanced_accuracy: 0.69441 | valid_accuracy: 0.69452 |  0:21:24s
epoch 73 | loss: 0.52991 | train_auc: 0.81892 | train_balanced_accuracy: 0.73633 | train_accuracy: 0.73658 | valid_auc: 0.77195 | valid_balanced_accuracy: 0.70153 | valid_accuracy: 0.70176 |  0:21:41s
epoch 74 | loss: 0.52884 | train_auc: 0.81836 | train_balanced_accuracy: 0.73456 | train_accuracy: 0.73493 | valid_auc: 0.76725 | valid_balanced_accuracy: 0.6976  | valid_accuracy: 0.69799 |  0:22:00s
epoch 75 | loss: 0.53038 | train_auc: 0.82002 | train_balanced_accuracy: 0.73825 | train_accuracy: 0.73851 | valid_auc: 0.77023 | valid_balanced_accuracy: 0.69447 | valid_accuracy: 0.69468 |  0:22:19s
epoch 76 | loss: 0.53033 | train_auc: 0.81342 | train_balanced_accuracy: 0.73269 | train_accuracy: 0.73281 | valid_auc: 0.76726 | valid_balanced_accuracy: 0.69587 | valid_accuracy: 0.69594 |  0:22:37s
epoch 77 | loss: 0.52891 | train_auc: 0.82486 | train_balanced_accuracy: 0.7397  | train_accuracy: 0.73985 | valid_auc: 0.77251 | valid_balanced_accuracy: 0.69709 | valid_accuracy: 0.6972  |  0:22:55s
epoch 78 | loss: 0.52757 | train_auc: 0.81576 | train_balanced_accuracy: 0.73251 | train_accuracy: 0.73285 | valid_auc: 0.76376 | valid_balanced_accuracy: 0.69322 | valid_accuracy: 0.69358 |  0:23:13s
epoch 79 | loss: 0.53443 | train_auc: 0.8138  | train_balanced_accuracy: 0.72966 | train_accuracy: 0.72966 | valid_auc: 0.76315 | valid_balanced_accuracy: 0.69034 | valid_accuracy: 0.69027 |  0:23:30s
epoch 80 | loss: 0.53323 | train_auc: 0.81854 | train_balanced_accuracy: 0.73804 | train_accuracy: 0.73824 | valid_auc: 0.7614  | valid_balanced_accuracy: 0.69054 | valid_accuracy: 0.69075 |  0:23:48s
epoch 81 | loss: 0.52435 | train_auc: 0.82112 | train_balanced_accuracy: 0.73783 | train_accuracy: 0.738   | valid_auc: 0.76446 | valid_balanced_accuracy: 0.69467 | valid_accuracy: 0.69484 |  0:24:07s
epoch 82 | loss: 0.53098 | train_auc: 0.82518 | train_balanced_accuracy: 0.74236 | train_accuracy: 0.7428  | valid_auc: 0.76853 | valid_balanced_accuracy: 0.69725 | valid_accuracy: 0.69767 |  0:24:25s
epoch 83 | loss: 0.52591 | train_auc: 0.81836 | train_balanced_accuracy: 0.73549 | train_accuracy: 0.73568 | valid_auc: 0.7659  | valid_balanced_accuracy: 0.69543 | valid_accuracy: 0.69562 |  0:24:43s
epoch 84 | loss: 0.52755 | train_auc: 0.81801 | train_balanced_accuracy: 0.73271 | train_accuracy: 0.73324 | valid_auc: 0.76194 | valid_balanced_accuracy: 0.68394 | valid_accuracy: 0.68445 |  0:25:01s
epoch 85 | loss: 0.52697 | train_auc: 0.82359 | train_balanced_accuracy: 0.73844 | train_accuracy: 0.73871 | valid_auc: 0.76683 | valid_balanced_accuracy: 0.69254 | valid_accuracy: 0.69279 |  0:25:18s
epoch 86 | loss: 0.52487 | train_auc: 0.82476 | train_balanced_accuracy: 0.7424  | train_accuracy: 0.7426  | valid_auc: 0.76323 | valid_balanced_accuracy: 0.69357 | valid_accuracy: 0.69374 |  0:25:37s
epoch 87 | loss: 0.52605 | train_auc: 0.8212  | train_balanced_accuracy: 0.73987 | train_accuracy: 0.73981 | valid_auc: 0.76414 | valid_balanced_accuracy: 0.69323 | valid_accuracy: 0.69311 |  0:25:56s
epoch 88 | loss: 0.52806 | train_auc: 0.8256  | train_balanced_accuracy: 0.74125 | train_accuracy: 0.74162 | valid_auc: 0.76215 | valid_balanced_accuracy: 0.68678 | valid_accuracy: 0.68713 |  0:26:14s
epoch 89 | loss: 0.52347 | train_auc: 0.82417 | train_balanced_accuracy: 0.74034 | train_accuracy: 0.74075 | valid_auc: 0.76591 | valid_balanced_accuracy: 0.68893 | valid_accuracy: 0.68933 |  0:26:32s
epoch 90 | loss: 0.52417 | train_auc: 0.82331 | train_balanced_accuracy: 0.73932 | train_accuracy: 0.73938 | valid_auc: 0.7663  | valid_balanced_accuracy: 0.69672 | valid_accuracy: 0.69673 |  0:26:50s
epoch 91 | loss: 0.52515 | train_auc: 0.82984 | train_balanced_accuracy: 0.74449 | train_accuracy: 0.74457 | valid_auc: 0.7656  | valid_balanced_accuracy: 0.69196 | valid_accuracy: 0.69201 |  0:27:09s
epoch 92 | loss: 0.5196  | train_auc: 0.82607 | train_balanced_accuracy: 0.74018 | train_accuracy: 0.7404  | valid_auc: 0.76756 | valid_balanced_accuracy: 0.69479 | valid_accuracy: 0.695   |  0:27:27s
epoch 93 | loss: 0.52042 | train_auc: 0.83014 | train_balanced_accuracy: 0.74179 | train_accuracy: 0.74201 | valid_auc: 0.76718 | valid_balanced_accuracy: 0.69775 | valid_accuracy: 0.69799 |  0:27:44s

Early stopping occurred at epoch 93 with best_epoch = 73 and best_valid_accuracy = 0.70176
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 64/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.700 total time=27.9min
[CV 1/5; 65/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7055  | train_auc: 0.60007 | train_balanced_accuracy: 0.51605 | train_accuracy: 0.51277 | valid_auc: 0.60068 | valid_balanced_accuracy: 0.51406 | valid_accuracy: 0.5107  |  0:00:15s
epoch 1  | loss: 0.64808 | train_auc: 0.63003 | train_balanced_accuracy: 0.56665 | train_accuracy: 0.56435 | valid_auc: 0.63009 | valid_balanced_accuracy: 0.56888 | valid_accuracy: 0.56657 |  0:00:32s
epoch 2  | loss: 0.63515 | train_auc: 0.64314 | train_balanced_accuracy: 0.58511 | train_accuracy: 0.5832  | valid_auc: 0.64239 | valid_balanced_accuracy: 0.58036 | valid_accuracy: 0.57838 |  0:00:49s
epoch 3  | loss: 0.62546 | train_auc: 0.658   | train_balanced_accuracy: 0.59397 | train_accuracy: 0.59205 | valid_auc: 0.65625 | valid_balanced_accuracy: 0.58775 | valid_accuracy: 0.58577 |  0:01:07s
epoch 4  | loss: 0.61186 | train_auc: 0.66781 | train_balanced_accuracy: 0.60782 | train_accuracy: 0.60673 | valid_auc: 0.66765 | valid_balanced_accuracy: 0.60736 | valid_accuracy: 0.60623 |  0:01:23s
epoch 5  | loss: 0.6098  | train_auc: 0.66483 | train_balanced_accuracy: 0.61191 | train_accuracy: 0.61106 | valid_auc: 0.66444 | valid_balanced_accuracy: 0.61464 | valid_accuracy: 0.61379 |  0:01:40s
epoch 6  | loss: 0.6095  | train_auc: 0.66456 | train_balanced_accuracy: 0.614   | train_accuracy: 0.61314 | valid_auc: 0.6652  | valid_balanced_accuracy: 0.61561 | valid_accuracy: 0.61473 |  0:01:56s
epoch 7  | loss: 0.6072  | train_auc: 0.6839  | train_balanced_accuracy: 0.61458 | train_accuracy: 0.61357 | valid_auc: 0.68145 | valid_balanced_accuracy: 0.6173  | valid_accuracy: 0.6163  |  0:02:14s
epoch 8  | loss: 0.59878 | train_auc: 0.6844  | train_balanced_accuracy: 0.62292 | train_accuracy: 0.62223 | valid_auc: 0.68258 | valid_balanced_accuracy: 0.6302  | valid_accuracy: 0.62952 |  0:02:30s
epoch 9  | loss: 0.6027  | train_auc: 0.68984 | train_balanced_accuracy: 0.62404 | train_accuracy: 0.62306 | valid_auc: 0.69118 | valid_balanced_accuracy: 0.63508 | valid_accuracy: 0.63409 |  0:02:47s
epoch 10 | loss: 0.59316 | train_auc: 0.69705 | train_balanced_accuracy: 0.6331  | train_accuracy: 0.63258 | valid_auc: 0.69576 | valid_balanced_accuracy: 0.63888 | valid_accuracy: 0.63834 |  0:03:04s
epoch 11 | loss: 0.59473 | train_auc: 0.71019 | train_balanced_accuracy: 0.64157 | train_accuracy: 0.64108 | valid_auc: 0.70622 | valid_balanced_accuracy: 0.64263 | valid_accuracy: 0.64212 |  0:03:21s
epoch 12 | loss: 0.59673 | train_auc: 0.71607 | train_balanced_accuracy: 0.64857 | train_accuracy: 0.64828 | valid_auc: 0.70711 | valid_balanced_accuracy: 0.6415  | valid_accuracy: 0.64117 |  0:03:38s
epoch 13 | loss: 0.59367 | train_auc: 0.71535 | train_balanced_accuracy: 0.64923 | train_accuracy: 0.64926 | valid_auc: 0.70679 | valid_balanced_accuracy: 0.64175 | valid_accuracy: 0.6418  |  0:03:55s
epoch 14 | loss: 0.58949 | train_auc: 0.71713 | train_balanced_accuracy: 0.65322 | train_accuracy: 0.6532  | valid_auc: 0.70767 | valid_balanced_accuracy: 0.644   | valid_accuracy: 0.644   |  0:04:11s
epoch 15 | loss: 0.58903 | train_auc: 0.72387 | train_balanced_accuracy: 0.65492 | train_accuracy: 0.65509 | valid_auc: 0.71725 | valid_balanced_accuracy: 0.64225 | valid_accuracy: 0.64243 |  0:04:27s
epoch 16 | loss: 0.58456 | train_auc: 0.72316 | train_balanced_accuracy: 0.66048 | train_accuracy: 0.66048 | valid_auc: 0.71186 | valid_balanced_accuracy: 0.64951 | valid_accuracy: 0.64951 |  0:04:45s
epoch 17 | loss: 0.58276 | train_auc: 0.73419 | train_balanced_accuracy: 0.66776 | train_accuracy: 0.66811 | valid_auc: 0.72149 | valid_balanced_accuracy: 0.65924 | valid_accuracy: 0.65958 |  0:05:04s
epoch 18 | loss: 0.58371 | train_auc: 0.74163 | train_balanced_accuracy: 0.66976 | train_accuracy: 0.67051 | valid_auc: 0.72856 | valid_balanced_accuracy: 0.66147 | valid_accuracy: 0.66226 |  0:05:21s
epoch 19 | loss: 0.58284 | train_auc: 0.74756 | train_balanced_accuracy: 0.68028 | train_accuracy: 0.68082 | valid_auc: 0.73164 | valid_balanced_accuracy: 0.67214 | valid_accuracy: 0.67265 |  0:05:39s
epoch 20 | loss: 0.5833  | train_auc: 0.75101 | train_balanced_accuracy: 0.68346 | train_accuracy: 0.68401 | valid_auc: 0.73225 | valid_balanced_accuracy: 0.66646 | valid_accuracy: 0.66698 |  0:05:56s
epoch 21 | loss: 0.57726 | train_auc: 0.75384 | train_balanced_accuracy: 0.68373 | train_accuracy: 0.68428 | valid_auc: 0.73114 | valid_balanced_accuracy: 0.66877 | valid_accuracy: 0.66934 |  0:06:14s
epoch 22 | loss: 0.58121 | train_auc: 0.75541 | train_balanced_accuracy: 0.69021 | train_accuracy: 0.69062 | valid_auc: 0.73857 | valid_balanced_accuracy: 0.67795 | valid_accuracy: 0.67831 |  0:06:31s
epoch 23 | loss: 0.57564 | train_auc: 0.75413 | train_balanced_accuracy: 0.68808 | train_accuracy: 0.68865 | valid_auc: 0.73573 | valid_balanced_accuracy: 0.66938 | valid_accuracy: 0.66997 |  0:06:48s
epoch 24 | loss: 0.58181 | train_auc: 0.75951 | train_balanced_accuracy: 0.68993 | train_accuracy: 0.69038 | valid_auc: 0.73381 | valid_balanced_accuracy: 0.6697  | valid_accuracy: 0.67013 |  0:07:05s
epoch 25 | loss: 0.57347 | train_auc: 0.76878 | train_balanced_accuracy: 0.70025 | train_accuracy: 0.70026 | valid_auc: 0.74111 | valid_balanced_accuracy: 0.67565 | valid_accuracy: 0.67564 |  0:07:22s
epoch 26 | loss: 0.57244 | train_auc: 0.76996 | train_balanced_accuracy: 0.69643 | train_accuracy: 0.69695 | valid_auc: 0.73852 | valid_balanced_accuracy: 0.67087 | valid_accuracy: 0.67139 |  0:07:39s
epoch 27 | loss: 0.57422 | train_auc: 0.76931 | train_balanced_accuracy: 0.69807 | train_accuracy: 0.69841 | valid_auc: 0.7406  | valid_balanced_accuracy: 0.67982 | valid_accuracy: 0.6802  |  0:07:56s
epoch 28 | loss: 0.57517 | train_auc: 0.77149 | train_balanced_accuracy: 0.69998 | train_accuracy: 0.70022 | valid_auc: 0.7419  | valid_balanced_accuracy: 0.67776 | valid_accuracy: 0.678   |  0:08:13s
epoch 29 | loss: 0.56857 | train_auc: 0.77959 | train_balanced_accuracy: 0.70528 | train_accuracy: 0.70549 | valid_auc: 0.74791 | valid_balanced_accuracy: 0.67827 | valid_accuracy: 0.67847 |  0:08:32s
epoch 30 | loss: 0.56888 | train_auc: 0.77637 | train_balanced_accuracy: 0.70356 | train_accuracy: 0.70376 | valid_auc: 0.74199 | valid_balanced_accuracy: 0.67922 | valid_accuracy: 0.67941 |  0:08:49s
epoch 31 | loss: 0.56707 | train_auc: 0.78134 | train_balanced_accuracy: 0.70952 | train_accuracy: 0.7095  | valid_auc: 0.74657 | valid_balanced_accuracy: 0.68069 | valid_accuracy: 0.68067 |  0:09:07s
epoch 32 | loss: 0.57148 | train_auc: 0.78192 | train_balanced_accuracy: 0.70834 | train_accuracy: 0.70872 | valid_auc: 0.74486 | valid_balanced_accuracy: 0.68014 | valid_accuracy: 0.68052 |  0:09:26s
epoch 33 | loss: 0.56894 | train_auc: 0.78399 | train_balanced_accuracy: 0.70803 | train_accuracy: 0.70824 | valid_auc: 0.74796 | valid_balanced_accuracy: 0.68092 | valid_accuracy: 0.68115 |  0:09:44s
epoch 34 | loss: 0.56846 | train_auc: 0.78426 | train_balanced_accuracy: 0.70903 | train_accuracy: 0.70931 | valid_auc: 0.75096 | valid_balanced_accuracy: 0.68353 | valid_accuracy: 0.68382 |  0:10:02s
epoch 35 | loss: 0.56803 | train_auc: 0.7843  | train_balanced_accuracy: 0.71037 | train_accuracy: 0.71068 | valid_auc: 0.74879 | valid_balanced_accuracy: 0.68539 | valid_accuracy: 0.68571 |  0:10:20s
epoch 36 | loss: 0.56884 | train_auc: 0.78776 | train_balanced_accuracy: 0.71247 | train_accuracy: 0.71234 | valid_auc: 0.74953 | valid_balanced_accuracy: 0.68413 | valid_accuracy: 0.68398 |  0:10:37s
epoch 37 | loss: 0.56439 | train_auc: 0.78452 | train_balanced_accuracy: 0.70676 | train_accuracy: 0.70726 | valid_auc: 0.74816 | valid_balanced_accuracy: 0.68412 | valid_accuracy: 0.68461 |  0:10:54s
epoch 38 | loss: 0.56511 | train_auc: 0.77451 | train_balanced_accuracy: 0.69992 | train_accuracy: 0.6999  | valid_auc: 0.73645 | valid_balanced_accuracy: 0.67049 | valid_accuracy: 0.67044 |  0:11:14s
epoch 39 | loss: 0.5627  | train_auc: 0.78766 | train_balanced_accuracy: 0.71266 | train_accuracy: 0.71293 | valid_auc: 0.74651 | valid_balanced_accuracy: 0.6793  | valid_accuracy: 0.67957 |  0:11:31s
epoch 40 | loss: 0.56191 | train_auc: 0.78941 | train_balanced_accuracy: 0.71439 | train_accuracy: 0.71466 | valid_auc: 0.74767 | valid_balanced_accuracy: 0.68009 | valid_accuracy: 0.68036 |  0:11:49s
epoch 41 | loss: 0.56372 | train_auc: 0.78667 | train_balanced_accuracy: 0.71031 | train_accuracy: 0.71041 | valid_auc: 0.74228 | valid_balanced_accuracy: 0.67852 | valid_accuracy: 0.67863 |  0:12:06s
epoch 42 | loss: 0.554   | train_auc: 0.79163 | train_balanced_accuracy: 0.71635 | train_accuracy: 0.71643 | valid_auc: 0.74495 | valid_balanced_accuracy: 0.67538 | valid_accuracy: 0.67548 |  0:12:23s
epoch 43 | loss: 0.56356 | train_auc: 0.79414 | train_balanced_accuracy: 0.7158  | train_accuracy: 0.71596 | valid_auc: 0.75041 | valid_balanced_accuracy: 0.68568 | valid_accuracy: 0.68587 |  0:12:40s
epoch 44 | loss: 0.55745 | train_auc: 0.79312 | train_balanced_accuracy: 0.71341 | train_accuracy: 0.71371 | valid_auc: 0.74955 | valid_balanced_accuracy: 0.67769 | valid_accuracy: 0.678   |  0:12:57s
epoch 45 | loss: 0.55763 | train_auc: 0.79153 | train_balanced_accuracy: 0.71429 | train_accuracy: 0.71466 | valid_auc: 0.74779 | valid_balanced_accuracy: 0.6836  | valid_accuracy: 0.68398 |  0:13:16s
epoch 46 | loss: 0.55573 | train_auc: 0.79147 | train_balanced_accuracy: 0.71356 | train_accuracy: 0.71348 | valid_auc: 0.74588 | valid_balanced_accuracy: 0.68251 | valid_accuracy: 0.6824  |  0:13:35s
epoch 47 | loss: 0.55823 | train_auc: 0.78913 | train_balanced_accuracy: 0.71408 | train_accuracy: 0.71438 | valid_auc: 0.74628 | valid_balanced_accuracy: 0.68085 | valid_accuracy: 0.68115 |  0:13:53s
epoch 48 | loss: 0.55151 | train_auc: 0.79827 | train_balanced_accuracy: 0.71858 | train_accuracy: 0.71839 | valid_auc: 0.75054 | valid_balanced_accuracy: 0.68152 | valid_accuracy: 0.6813  |  0:14:08s
epoch 49 | loss: 0.55439 | train_auc: 0.7945  | train_balanced_accuracy: 0.71847 | train_accuracy: 0.71839 | valid_auc: 0.75204 | valid_balanced_accuracy: 0.68569 | valid_accuracy: 0.68555 |  0:14:26s
epoch 50 | loss: 0.55145 | train_auc: 0.79632 | train_balanced_accuracy: 0.71713 | train_accuracy: 0.71729 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.68253 | valid_accuracy: 0.68272 |  0:14:43s
epoch 51 | loss: 0.55281 | train_auc: 0.79089 | train_balanced_accuracy: 0.71421 | train_accuracy: 0.71422 | valid_auc: 0.75192 | valid_balanced_accuracy: 0.68558 | valid_accuracy: 0.68555 |  0:15:01s
epoch 52 | loss: 0.55127 | train_auc: 0.79967 | train_balanced_accuracy: 0.72323 | train_accuracy: 0.72323 | valid_auc: 0.75613 | valid_balanced_accuracy: 0.69039 | valid_accuracy: 0.69043 |  0:15:20s
epoch 53 | loss: 0.55062 | train_auc: 0.79742 | train_balanced_accuracy: 0.72087 | train_accuracy: 0.72107 | valid_auc: 0.75274 | valid_balanced_accuracy: 0.68928 | valid_accuracy: 0.68949 |  0:15:37s
epoch 54 | loss: 0.54688 | train_auc: 0.79741 | train_balanced_accuracy: 0.71724 | train_accuracy: 0.71733 | valid_auc: 0.75301 | valid_balanced_accuracy: 0.68714 | valid_accuracy: 0.68728 |  0:15:54s
epoch 55 | loss: 0.55525 | train_auc: 0.79858 | train_balanced_accuracy: 0.7175  | train_accuracy: 0.71796 | valid_auc: 0.74906 | valid_balanced_accuracy: 0.68067 | valid_accuracy: 0.68115 |  0:16:10s
epoch 56 | loss: 0.55042 | train_auc: 0.80397 | train_balanced_accuracy: 0.72274 | train_accuracy: 0.72276 | valid_auc: 0.75388 | valid_balanced_accuracy: 0.68525 | valid_accuracy: 0.68524 |  0:16:28s
epoch 57 | loss: 0.54548 | train_auc: 0.80209 | train_balanced_accuracy: 0.72427 | train_accuracy: 0.7243  | valid_auc: 0.75402 | valid_balanced_accuracy: 0.69105 | valid_accuracy: 0.69106 |  0:16:45s
epoch 58 | loss: 0.54738 | train_auc: 0.80186 | train_balanced_accuracy: 0.72312 | train_accuracy: 0.72327 | valid_auc: 0.75001 | valid_balanced_accuracy: 0.67931 | valid_accuracy: 0.67941 |  0:17:02s
epoch 59 | loss: 0.54785 | train_auc: 0.80032 | train_balanced_accuracy: 0.72303 | train_accuracy: 0.72319 | valid_auc: 0.74892 | valid_balanced_accuracy: 0.68098 | valid_accuracy: 0.68115 |  0:17:18s
epoch 60 | loss: 0.55015 | train_auc: 0.80606 | train_balanced_accuracy: 0.72646 | train_accuracy: 0.72658 | valid_auc: 0.75425 | valid_balanced_accuracy: 0.68934 | valid_accuracy: 0.68949 |  0:17:36s
epoch 61 | loss: 0.54763 | train_auc: 0.80785 | train_balanced_accuracy: 0.72473 | train_accuracy: 0.725   | valid_auc: 0.75292 | valid_balanced_accuracy: 0.68694 | valid_accuracy: 0.68728 |  0:17:56s
epoch 62 | loss: 0.54548 | train_auc: 0.80763 | train_balanced_accuracy: 0.72625 | train_accuracy: 0.72622 | valid_auc: 0.75622 | valid_balanced_accuracy: 0.68821 | valid_accuracy: 0.68823 |  0:18:12s
epoch 63 | loss: 0.54606 | train_auc: 0.80873 | train_balanced_accuracy: 0.72724 | train_accuracy: 0.72752 | valid_auc: 0.75267 | valid_balanced_accuracy: 0.68496 | valid_accuracy: 0.68524 |  0:18:30s
epoch 64 | loss: 0.54021 | train_auc: 0.81027 | train_balanced_accuracy: 0.72849 | train_accuracy: 0.72859 | valid_auc: 0.75304 | valid_balanced_accuracy: 0.68372 | valid_accuracy: 0.68382 |  0:18:49s
epoch 65 | loss: 0.54208 | train_auc: 0.80725 | train_balanced_accuracy: 0.72509 | train_accuracy: 0.72532 | valid_auc: 0.75036 | valid_balanced_accuracy: 0.68088 | valid_accuracy: 0.68115 |  0:19:07s
epoch 66 | loss: 0.53909 | train_auc: 0.80976 | train_balanced_accuracy: 0.72638 | train_accuracy: 0.72622 | valid_auc: 0.75254 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68351 |  0:19:23s
epoch 67 | loss: 0.54053 | train_auc: 0.808   | train_balanced_accuracy: 0.72777 | train_accuracy: 0.72807 | valid_auc: 0.74898 | valid_balanced_accuracy: 0.68399 | valid_accuracy: 0.68429 |  0:19:40s
epoch 68 | loss: 0.54724 | train_auc: 0.80096 | train_balanced_accuracy: 0.72264 | train_accuracy: 0.72288 | valid_auc: 0.74849 | valid_balanced_accuracy: 0.68894 | valid_accuracy: 0.68917 |  0:19:56s
epoch 69 | loss: 0.54471 | train_auc: 0.807   | train_balanced_accuracy: 0.72765 | train_accuracy: 0.72788 | valid_auc: 0.75015 | valid_balanced_accuracy: 0.68832 | valid_accuracy: 0.68854 |  0:20:13s
epoch 70 | loss: 0.53675 | train_auc: 0.81094 | train_balanced_accuracy: 0.72705 | train_accuracy: 0.72717 | valid_auc: 0.75074 | valid_balanced_accuracy: 0.68323 | valid_accuracy: 0.68335 |  0:20:32s
epoch 71 | loss: 0.54214 | train_auc: 0.80901 | train_balanced_accuracy: 0.72831 | train_accuracy: 0.72835 | valid_auc: 0.75331 | valid_balanced_accuracy: 0.68552 | valid_accuracy: 0.68555 |  0:20:48s
epoch 72 | loss: 0.5403  | train_auc: 0.81247 | train_balanced_accuracy: 0.73058 | train_accuracy: 0.73075 | valid_auc: 0.75553 | valid_balanced_accuracy: 0.68962 | valid_accuracy: 0.6898  |  0:21:05s
epoch 73 | loss: 0.53644 | train_auc: 0.81498 | train_balanced_accuracy: 0.73246 | train_accuracy: 0.73244 | valid_auc: 0.75342 | valid_balanced_accuracy: 0.68532 | valid_accuracy: 0.68524 |  0:21:22s
epoch 74 | loss: 0.54088 | train_auc: 0.81465 | train_balanced_accuracy: 0.73104 | train_accuracy: 0.73134 | valid_auc: 0.75386 | valid_balanced_accuracy: 0.68697 | valid_accuracy: 0.68728 |  0:21:40s
epoch 75 | loss: 0.54104 | train_auc: 0.81396 | train_balanced_accuracy: 0.73074 | train_accuracy: 0.73106 | valid_auc: 0.75042 | valid_balanced_accuracy: 0.68442 | valid_accuracy: 0.68477 |  0:21:59s
epoch 76 | loss: 0.54289 | train_auc: 0.81073 | train_balanced_accuracy: 0.72788 | train_accuracy: 0.72784 | valid_auc: 0.75563 | valid_balanced_accuracy: 0.68675 | valid_accuracy: 0.68665 |  0:22:17s
epoch 77 | loss: 0.53729 | train_auc: 0.80637 | train_balanced_accuracy: 0.72503 | train_accuracy: 0.72512 | valid_auc: 0.75381 | valid_balanced_accuracy: 0.68467 | valid_accuracy: 0.68477 |  0:22:33s

Early stopping occurred at epoch 77 with best_epoch = 57 and best_valid_accuracy = 0.69106
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 65/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.698 total time=22.7min
[CV 2/5; 65/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71534 | train_auc: 0.59033 | train_balanced_accuracy: 0.573   | train_accuracy: 0.57234 | valid_auc: 0.59939 | valid_balanced_accuracy: 0.58346 | valid_accuracy: 0.58278 |  0:00:18s
epoch 1  | loss: 0.65461 | train_auc: 0.62475 | train_balanced_accuracy: 0.54426 | train_accuracy: 0.54153 | valid_auc: 0.62235 | valid_balanced_accuracy: 0.54307 | valid_accuracy: 0.54029 |  0:00:37s
epoch 2  | loss: 0.63874 | train_auc: 0.64714 | train_balanced_accuracy: 0.52341 | train_accuracy: 0.52017 | valid_auc: 0.64405 | valid_balanced_accuracy: 0.52124 | valid_accuracy: 0.51794 |  0:00:55s
epoch 3  | loss: 0.62366 | train_auc: 0.67445 | train_balanced_accuracy: 0.53041 | train_accuracy: 0.52725 | valid_auc: 0.66952 | valid_balanced_accuracy: 0.52811 | valid_accuracy: 0.52487 |  0:01:12s
epoch 4  | loss: 0.61152 | train_auc: 0.67569 | train_balanced_accuracy: 0.58126 | train_accuracy: 0.57911 | valid_auc: 0.66842 | valid_balanced_accuracy: 0.57325 | valid_accuracy: 0.57098 |  0:01:29s
epoch 5  | loss: 0.61259 | train_auc: 0.68095 | train_balanced_accuracy: 0.60164 | train_accuracy: 0.59984 | valid_auc: 0.67327 | valid_balanced_accuracy: 0.59304 | valid_accuracy: 0.59112 |  0:01:44s
epoch 6  | loss: 0.60811 | train_auc: 0.6911  | train_balanced_accuracy: 0.60372 | train_accuracy: 0.60197 | valid_auc: 0.6835  | valid_balanced_accuracy: 0.59849 | valid_accuracy: 0.59663 |  0:02:01s
epoch 7  | loss: 0.60384 | train_auc: 0.69437 | train_balanced_accuracy: 0.61953 | train_accuracy: 0.61818 | valid_auc: 0.68682 | valid_balanced_accuracy: 0.61223 | valid_accuracy: 0.6108  |  0:02:18s
epoch 8  | loss: 0.59463 | train_auc: 0.69954 | train_balanced_accuracy: 0.63372 | train_accuracy: 0.63297 | valid_auc: 0.69198 | valid_balanced_accuracy: 0.62579 | valid_accuracy: 0.62496 |  0:02:33s
epoch 9  | loss: 0.59906 | train_auc: 0.71113 | train_balanced_accuracy: 0.61943 | train_accuracy: 0.61786 | valid_auc: 0.69982 | valid_balanced_accuracy: 0.60379 | valid_accuracy: 0.60214 |  0:02:51s
epoch 10 | loss: 0.58637 | train_auc: 0.71787 | train_balanced_accuracy: 0.65093 | train_accuracy: 0.65025 | valid_auc: 0.70647 | valid_balanced_accuracy: 0.64158 | valid_accuracy: 0.64086 |  0:03:08s
epoch 11 | loss: 0.59098 | train_auc: 0.72208 | train_balanced_accuracy: 0.64591 | train_accuracy: 0.64497 | valid_auc: 0.71067 | valid_balanced_accuracy: 0.63396 | valid_accuracy: 0.63299 |  0:03:27s
epoch 12 | loss: 0.58974 | train_auc: 0.71965 | train_balanced_accuracy: 0.64442 | train_accuracy: 0.64356 | valid_auc: 0.70588 | valid_balanced_accuracy: 0.62733 | valid_accuracy: 0.62638 |  0:03:44s
epoch 13 | loss: 0.5858  | train_auc: 0.72986 | train_balanced_accuracy: 0.66142 | train_accuracy: 0.66087 | valid_auc: 0.71872 | valid_balanced_accuracy: 0.64856 | valid_accuracy: 0.64794 |  0:04:00s
epoch 14 | loss: 0.58641 | train_auc: 0.72932 | train_balanced_accuracy: 0.65996 | train_accuracy: 0.65941 | valid_auc: 0.71179 | valid_balanced_accuracy: 0.64097 | valid_accuracy: 0.64038 |  0:04:17s
epoch 15 | loss: 0.58421 | train_auc: 0.73829 | train_balanced_accuracy: 0.67536 | train_accuracy: 0.67511 | valid_auc: 0.72337 | valid_balanced_accuracy: 0.66633 | valid_accuracy: 0.66604 |  0:04:34s
epoch 16 | loss: 0.58193 | train_auc: 0.7461  | train_balanced_accuracy: 0.67577 | train_accuracy: 0.67539 | valid_auc: 0.73052 | valid_balanced_accuracy: 0.66331 | valid_accuracy: 0.66289 |  0:04:50s
epoch 17 | loss: 0.5802  | train_auc: 0.74698 | train_balanced_accuracy: 0.67936 | train_accuracy: 0.67924 | valid_auc: 0.72762 | valid_balanced_accuracy: 0.66303 | valid_accuracy: 0.66289 |  0:05:10s
epoch 18 | loss: 0.57903 | train_auc: 0.75581 | train_balanced_accuracy: 0.69667 | train_accuracy: 0.69707 | valid_auc: 0.73903 | valid_balanced_accuracy: 0.67703 | valid_accuracy: 0.67737 |  0:05:26s
epoch 19 | loss: 0.57942 | train_auc: 0.76397 | train_balanced_accuracy: 0.6992  | train_accuracy: 0.69951 | valid_auc: 0.74266 | valid_balanced_accuracy: 0.68151 | valid_accuracy: 0.68178 |  0:05:42s
epoch 20 | loss: 0.57727 | train_auc: 0.76614 | train_balanced_accuracy: 0.70135 | train_accuracy: 0.70175 | valid_auc: 0.74662 | valid_balanced_accuracy: 0.68756 | valid_accuracy: 0.68791 |  0:05:58s
epoch 21 | loss: 0.57531 | train_auc: 0.76855 | train_balanced_accuracy: 0.70269 | train_accuracy: 0.70305 | valid_auc: 0.74657 | valid_balanced_accuracy: 0.68161 | valid_accuracy: 0.68193 |  0:06:16s
epoch 22 | loss: 0.58035 | train_auc: 0.77195 | train_balanced_accuracy: 0.70307 | train_accuracy: 0.70325 | valid_auc: 0.74687 | valid_balanced_accuracy: 0.68199 | valid_accuracy: 0.68209 |  0:06:33s
epoch 23 | loss: 0.5768  | train_auc: 0.77407 | train_balanced_accuracy: 0.70619 | train_accuracy: 0.70651 | valid_auc: 0.75025 | valid_balanced_accuracy: 0.6856  | valid_accuracy: 0.68587 |  0:06:51s
epoch 24 | loss: 0.57707 | train_auc: 0.77738 | train_balanced_accuracy: 0.70827 | train_accuracy: 0.70856 | valid_auc: 0.75377 | valid_balanced_accuracy: 0.6891  | valid_accuracy: 0.68933 |  0:07:09s
epoch 25 | loss: 0.56803 | train_auc: 0.77972 | train_balanced_accuracy: 0.70959 | train_accuracy: 0.70966 | valid_auc: 0.75361 | valid_balanced_accuracy: 0.6906  | valid_accuracy: 0.69059 |  0:07:27s
epoch 26 | loss: 0.56994 | train_auc: 0.77799 | train_balanced_accuracy: 0.70688 | train_accuracy: 0.7071  | valid_auc: 0.75362 | valid_balanced_accuracy: 0.68588 | valid_accuracy: 0.68602 |  0:07:45s
epoch 27 | loss: 0.57244 | train_auc: 0.78079 | train_balanced_accuracy: 0.71065 | train_accuracy: 0.71092 | valid_auc: 0.75184 | valid_balanced_accuracy: 0.68406 | valid_accuracy: 0.68429 |  0:08:01s
epoch 28 | loss: 0.56764 | train_auc: 0.78283 | train_balanced_accuracy: 0.71224 | train_accuracy: 0.71245 | valid_auc: 0.75703 | valid_balanced_accuracy: 0.68764 | valid_accuracy: 0.68776 |  0:08:18s
epoch 29 | loss: 0.56613 | train_auc: 0.78205 | train_balanced_accuracy: 0.71166 | train_accuracy: 0.71178 | valid_auc: 0.75471 | valid_balanced_accuracy: 0.68784 | valid_accuracy: 0.68791 |  0:08:36s
epoch 30 | loss: 0.56344 | train_auc: 0.78572 | train_balanced_accuracy: 0.71345 | train_accuracy: 0.71383 | valid_auc: 0.75837 | valid_balanced_accuracy: 0.69323 | valid_accuracy: 0.69358 |  0:08:54s
epoch 31 | loss: 0.56735 | train_auc: 0.75159 | train_balanced_accuracy: 0.69309 | train_accuracy: 0.69309 | valid_auc: 0.73141 | valid_balanced_accuracy: 0.67316 | valid_accuracy: 0.67312 |  0:09:11s
epoch 32 | loss: 0.56581 | train_auc: 0.73433 | train_balanced_accuracy: 0.68354 | train_accuracy: 0.68377 | valid_auc: 0.72171 | valid_balanced_accuracy: 0.6753  | valid_accuracy: 0.67548 |  0:09:27s
epoch 33 | loss: 0.5625  | train_auc: 0.74901 | train_balanced_accuracy: 0.6891  | train_accuracy: 0.68924 | valid_auc: 0.72808 | valid_balanced_accuracy: 0.67414 | valid_accuracy: 0.67422 |  0:09:44s
epoch 34 | loss: 0.56187 | train_auc: 0.75949 | train_balanced_accuracy: 0.69806 | train_accuracy: 0.69809 | valid_auc: 0.73036 | valid_balanced_accuracy: 0.67313 | valid_accuracy: 0.67312 |  0:10:00s
epoch 35 | loss: 0.56252 | train_auc: 0.7665  | train_balanced_accuracy: 0.70172 | train_accuracy: 0.70207 | valid_auc: 0.74099 | valid_balanced_accuracy: 0.68306 | valid_accuracy: 0.68335 |  0:10:17s
epoch 36 | loss: 0.56004 | train_auc: 0.78229 | train_balanced_accuracy: 0.71177 | train_accuracy: 0.71178 | valid_auc: 0.75157 | valid_balanced_accuracy: 0.68228 | valid_accuracy: 0.68225 |  0:10:34s
epoch 37 | loss: 0.56501 | train_auc: 0.78954 | train_balanced_accuracy: 0.71681 | train_accuracy: 0.7171  | valid_auc: 0.75698 | valid_balanced_accuracy: 0.69604 | valid_accuracy: 0.69625 |  0:10:52s
epoch 38 | loss: 0.55846 | train_auc: 0.78534 | train_balanced_accuracy: 0.71381 | train_accuracy: 0.71371 | valid_auc: 0.75188 | valid_balanced_accuracy: 0.68551 | valid_accuracy: 0.6854  |  0:11:10s
epoch 39 | loss: 0.56005 | train_auc: 0.7787  | train_balanced_accuracy: 0.70946 | train_accuracy: 0.70974 | valid_auc: 0.74482 | valid_balanced_accuracy: 0.68343 | valid_accuracy: 0.68366 |  0:11:25s
epoch 40 | loss: 0.56185 | train_auc: 0.78307 | train_balanced_accuracy: 0.71291 | train_accuracy: 0.71296 | valid_auc: 0.75042 | valid_balanced_accuracy: 0.68635 | valid_accuracy: 0.68634 |  0:11:42s
epoch 41 | loss: 0.55678 | train_auc: 0.77404 | train_balanced_accuracy: 0.70545 | train_accuracy: 0.70553 | valid_auc: 0.74476 | valid_balanced_accuracy: 0.68488 | valid_accuracy: 0.68492 |  0:11:59s
epoch 42 | loss: 0.553   | train_auc: 0.76906 | train_balanced_accuracy: 0.70239 | train_accuracy: 0.70266 | valid_auc: 0.74039 | valid_balanced_accuracy: 0.67778 | valid_accuracy: 0.678   |  0:12:15s
epoch 43 | loss: 0.56135 | train_auc: 0.7831  | train_balanced_accuracy: 0.71506 | train_accuracy: 0.71533 | valid_auc: 0.75278 | valid_balanced_accuracy: 0.69307 | valid_accuracy: 0.69326 |  0:12:33s
epoch 44 | loss: 0.55621 | train_auc: 0.78472 | train_balanced_accuracy: 0.71448 | train_accuracy: 0.71462 | valid_auc: 0.75308 | valid_balanced_accuracy: 0.68909 | valid_accuracy: 0.68917 |  0:12:51s
epoch 45 | loss: 0.55079 | train_auc: 0.78924 | train_balanced_accuracy: 0.71555 | train_accuracy: 0.71592 | valid_auc: 0.75117 | valid_balanced_accuracy: 0.68838 | valid_accuracy: 0.6887  |  0:13:09s
epoch 46 | loss: 0.55358 | train_auc: 0.79805 | train_balanced_accuracy: 0.72314 | train_accuracy: 0.72319 | valid_auc: 0.75805 | valid_balanced_accuracy: 0.69485 | valid_accuracy: 0.69484 |  0:13:26s
epoch 47 | loss: 0.55479 | train_auc: 0.79642 | train_balanced_accuracy: 0.71883 | train_accuracy: 0.71922 | valid_auc: 0.75888 | valid_balanced_accuracy: 0.69401 | valid_accuracy: 0.69437 |  0:13:44s
epoch 48 | loss: 0.54904 | train_auc: 0.79785 | train_balanced_accuracy: 0.722   | train_accuracy: 0.72205 | valid_auc: 0.75649 | valid_balanced_accuracy: 0.69248 | valid_accuracy: 0.69248 |  0:14:00s
epoch 49 | loss: 0.55032 | train_auc: 0.79505 | train_balanced_accuracy: 0.72087 | train_accuracy: 0.72095 | valid_auc: 0.75368 | valid_balanced_accuracy: 0.68961 | valid_accuracy: 0.68964 |  0:14:19s
epoch 50 | loss: 0.54979 | train_auc: 0.79741 | train_balanced_accuracy: 0.72406 | train_accuracy: 0.72426 | valid_auc: 0.75805 | valid_balanced_accuracy: 0.69451 | valid_accuracy: 0.69468 |  0:14:36s
epoch 51 | loss: 0.55331 | train_auc: 0.79064 | train_balanced_accuracy: 0.71826 | train_accuracy: 0.71847 | valid_auc: 0.75755 | valid_balanced_accuracy: 0.69054 | valid_accuracy: 0.69075 |  0:14:52s
epoch 52 | loss: 0.54773 | train_auc: 0.80379 | train_balanced_accuracy: 0.72753 | train_accuracy: 0.72764 | valid_auc: 0.75948 | valid_balanced_accuracy: 0.6924  | valid_accuracy: 0.69248 |  0:15:10s
epoch 53 | loss: 0.54878 | train_auc: 0.80372 | train_balanced_accuracy: 0.7273  | train_accuracy: 0.7276  | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69251 | valid_accuracy: 0.69279 |  0:15:28s
epoch 54 | loss: 0.55097 | train_auc: 0.79688 | train_balanced_accuracy: 0.71921 | train_accuracy: 0.7195  | valid_auc: 0.7608  | valid_balanced_accuracy: 0.69743 | valid_accuracy: 0.69767 |  0:15:44s
epoch 55 | loss: 0.55311 | train_auc: 0.80157 | train_balanced_accuracy: 0.72534 | train_accuracy: 0.72567 | valid_auc: 0.75601 | valid_balanced_accuracy: 0.69326 | valid_accuracy: 0.69358 |  0:16:02s
epoch 56 | loss: 0.54549 | train_auc: 0.77807 | train_balanced_accuracy: 0.70139 | train_accuracy: 0.70191 | valid_auc: 0.74846 | valid_balanced_accuracy: 0.67861 | valid_accuracy: 0.6791  |  0:16:18s
epoch 57 | loss: 0.54712 | train_auc: 0.78233 | train_balanced_accuracy: 0.70766 | train_accuracy: 0.70777 | valid_auc: 0.74262 | valid_balanced_accuracy: 0.67634 | valid_accuracy: 0.67642 |  0:16:37s
epoch 58 | loss: 0.54414 | train_auc: 0.76254 | train_balanced_accuracy: 0.68771 | train_accuracy: 0.68802 | valid_auc: 0.73689 | valid_balanced_accuracy: 0.66874 | valid_accuracy: 0.66903 |  0:16:54s
epoch 59 | loss: 0.54437 | train_auc: 0.80417 | train_balanced_accuracy: 0.72841 | train_accuracy: 0.72859 | valid_auc: 0.75804 | valid_balanced_accuracy: 0.69267 | valid_accuracy: 0.69279 |  0:17:11s
epoch 60 | loss: 0.5422  | train_auc: 0.74778 | train_balanced_accuracy: 0.68597 | train_accuracy: 0.68629 | valid_auc: 0.72398 | valid_balanced_accuracy: 0.6686  | valid_accuracy: 0.66887 |  0:17:29s
epoch 61 | loss: 0.54047 | train_auc: 0.72721 | train_balanced_accuracy: 0.67348 | train_accuracy: 0.67393 | valid_auc: 0.71006 | valid_balanced_accuracy: 0.65385 | valid_accuracy: 0.65423 |  0:17:46s
epoch 62 | loss: 0.54301 | train_auc: 0.74677 | train_balanced_accuracy: 0.68778 | train_accuracy: 0.68766 | valid_auc: 0.72033 | valid_balanced_accuracy: 0.66617 | valid_accuracy: 0.66604 |  0:18:04s
epoch 63 | loss: 0.54748 | train_auc: 0.77402 | train_balanced_accuracy: 0.70339 | train_accuracy: 0.70348 | valid_auc: 0.73888 | valid_balanced_accuracy: 0.67963 | valid_accuracy: 0.67973 |  0:18:20s
epoch 64 | loss: 0.54127 | train_auc: 0.78311 | train_balanced_accuracy: 0.71035 | train_accuracy: 0.71025 | valid_auc: 0.74106 | valid_balanced_accuracy: 0.68235 | valid_accuracy: 0.68225 |  0:18:38s
epoch 65 | loss: 0.53781 | train_auc: 0.80287 | train_balanced_accuracy: 0.72701 | train_accuracy: 0.72721 | valid_auc: 0.75514 | valid_balanced_accuracy: 0.69074 | valid_accuracy: 0.6909  |  0:18:55s
epoch 66 | loss: 0.54198 | train_auc: 0.80277 | train_balanced_accuracy: 0.72598 | train_accuracy: 0.72595 | valid_auc: 0.75712 | valid_balanced_accuracy: 0.68972 | valid_accuracy: 0.68964 |  0:19:12s
epoch 67 | loss: 0.5394  | train_auc: 0.80679 | train_balanced_accuracy: 0.72793 | train_accuracy: 0.72815 | valid_auc: 0.75754 | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68602 |  0:19:31s
epoch 68 | loss: 0.54278 | train_auc: 0.8093  | train_balanced_accuracy: 0.73248 | train_accuracy: 0.73276 | valid_auc: 0.76538 | valid_balanced_accuracy: 0.69428 | valid_accuracy: 0.69452 |  0:19:48s
epoch 69 | loss: 0.53907 | train_auc: 0.81205 | train_balanced_accuracy: 0.73423 | train_accuracy: 0.73437 | valid_auc: 0.76322 | valid_balanced_accuracy: 0.69631 | valid_accuracy: 0.69641 |  0:20:05s
epoch 70 | loss: 0.53772 | train_auc: 0.80755 | train_balanced_accuracy: 0.72996 | train_accuracy: 0.7302  | valid_auc: 0.76217 | valid_balanced_accuracy: 0.69338 | valid_accuracy: 0.69358 |  0:20:24s
epoch 71 | loss: 0.54274 | train_auc: 0.80408 | train_balanced_accuracy: 0.72509 | train_accuracy: 0.7252  | valid_auc: 0.75462 | valid_balanced_accuracy: 0.68847 | valid_accuracy: 0.68854 |  0:20:42s
epoch 72 | loss: 0.53613 | train_auc: 0.80644 | train_balanced_accuracy: 0.72613 | train_accuracy: 0.72646 | valid_auc: 0.76169 | valid_balanced_accuracy: 0.69313 | valid_accuracy: 0.69342 |  0:20:59s
epoch 73 | loss: 0.5349  | train_auc: 0.80767 | train_balanced_accuracy: 0.72865 | train_accuracy: 0.72882 | valid_auc: 0.76223 | valid_balanced_accuracy: 0.69205 | valid_accuracy: 0.69216 |  0:21:18s
epoch 74 | loss: 0.53771 | train_auc: 0.81316 | train_balanced_accuracy: 0.73196 | train_accuracy: 0.7324  | valid_auc: 0.76157 | valid_balanced_accuracy: 0.68907 | valid_accuracy: 0.68949 |  0:21:35s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69767
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 65/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=21.7min
[CV 3/5; 65/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71098 | train_auc: 0.60005 | train_balanced_accuracy: 0.50015 | train_accuracy: 0.49658 | valid_auc: 0.61255 | valid_balanced_accuracy: 0.50047 | valid_accuracy: 0.49685 |  0:00:17s
epoch 1  | loss: 0.64651 | train_auc: 0.63768 | train_balanced_accuracy: 0.51795 | train_accuracy: 0.5146  | valid_auc: 0.6387  | valid_balanced_accuracy: 0.51881 | valid_accuracy: 0.51542 |  0:00:35s
epoch 2  | loss: 0.62747 | train_auc: 0.65241 | train_balanced_accuracy: 0.58984 | train_accuracy: 0.5877  | valid_auc: 0.65038 | valid_balanced_accuracy: 0.58806 | valid_accuracy: 0.58593 |  0:00:51s
epoch 3  | loss: 0.621   | train_auc: 0.66754 | train_balanced_accuracy: 0.56716 | train_accuracy: 0.56449 | valid_auc: 0.66701 | valid_balanced_accuracy: 0.56268 | valid_accuracy: 0.55996 |  0:01:08s
epoch 4  | loss: 0.61275 | train_auc: 0.67153 | train_balanced_accuracy: 0.5703  | train_accuracy: 0.56775 | valid_auc: 0.66653 | valid_balanced_accuracy: 0.56758 | valid_accuracy: 0.565   |  0:01:26s
epoch 5  | loss: 0.60998 | train_auc: 0.67205 | train_balanced_accuracy: 0.59471 | train_accuracy: 0.59266 | valid_auc: 0.66253 | valid_balanced_accuracy: 0.59083 | valid_accuracy: 0.58876 |  0:01:44s
epoch 6  | loss: 0.60688 | train_auc: 0.68972 | train_balanced_accuracy: 0.61564 | train_accuracy: 0.6141  | valid_auc: 0.68389 | valid_balanced_accuracy: 0.61186 | valid_accuracy: 0.61032 |  0:02:00s
epoch 7  | loss: 0.60868 | train_auc: 0.692   | train_balanced_accuracy: 0.61799 | train_accuracy: 0.6165  | valid_auc: 0.68625 | valid_balanced_accuracy: 0.61481 | valid_accuracy: 0.61331 |  0:02:16s
epoch 8  | loss: 0.59802 | train_auc: 0.70522 | train_balanced_accuracy: 0.63994 | train_accuracy: 0.63905 | valid_auc: 0.7001  | valid_balanced_accuracy: 0.63752 | valid_accuracy: 0.63661 |  0:02:33s
epoch 9  | loss: 0.59662 | train_auc: 0.70767 | train_balanced_accuracy: 0.64372 | train_accuracy: 0.64282 | valid_auc: 0.70144 | valid_balanced_accuracy: 0.6339  | valid_accuracy: 0.63299 |  0:02:49s
epoch 10 | loss: 0.58732 | train_auc: 0.7158  | train_balanced_accuracy: 0.64416 | train_accuracy: 0.64322 | valid_auc: 0.70791 | valid_balanced_accuracy: 0.6377  | valid_accuracy: 0.63676 |  0:03:05s
epoch 11 | loss: 0.59128 | train_auc: 0.72456 | train_balanced_accuracy: 0.6555  | train_accuracy: 0.6549  | valid_auc: 0.71859 | valid_balanced_accuracy: 0.6482  | valid_accuracy: 0.64762 |  0:03:23s
epoch 12 | loss: 0.59102 | train_auc: 0.73022 | train_balanced_accuracy: 0.66642 | train_accuracy: 0.66639 | valid_auc: 0.72449 | valid_balanced_accuracy: 0.66621 | valid_accuracy: 0.66619 |  0:03:39s
epoch 13 | loss: 0.58692 | train_auc: 0.73259 | train_balanced_accuracy: 0.66603 | train_accuracy: 0.6658  | valid_auc: 0.72731 | valid_balanced_accuracy: 0.66171 | valid_accuracy: 0.66147 |  0:03:57s
epoch 14 | loss: 0.58478 | train_auc: 0.7387  | train_balanced_accuracy: 0.67482 | train_accuracy: 0.67489 | valid_auc: 0.73445 | valid_balanced_accuracy: 0.67809 | valid_accuracy: 0.67816 |  0:04:14s
epoch 15 | loss: 0.58642 | train_auc: 0.74314 | train_balanced_accuracy: 0.67658 | train_accuracy: 0.67654 | valid_auc: 0.73707 | valid_balanced_accuracy: 0.67318 | valid_accuracy: 0.67312 |  0:04:32s
epoch 16 | loss: 0.57944 | train_auc: 0.74518 | train_balanced_accuracy: 0.67509 | train_accuracy: 0.67485 | valid_auc: 0.74054 | valid_balanced_accuracy: 0.67685 | valid_accuracy: 0.67658 |  0:04:47s
epoch 17 | loss: 0.5769  | train_auc: 0.74627 | train_balanced_accuracy: 0.68011 | train_accuracy: 0.68028 | valid_auc: 0.73883 | valid_balanced_accuracy: 0.67551 | valid_accuracy: 0.67564 |  0:05:08s
epoch 18 | loss: 0.58381 | train_auc: 0.75295 | train_balanced_accuracy: 0.6844  | train_accuracy: 0.68496 | valid_auc: 0.74435 | valid_balanced_accuracy: 0.68548 | valid_accuracy: 0.68602 |  0:05:25s
epoch 19 | loss: 0.57961 | train_auc: 0.75378 | train_balanced_accuracy: 0.68489 | train_accuracy: 0.68524 | valid_auc: 0.7435  | valid_balanced_accuracy: 0.68144 | valid_accuracy: 0.68178 |  0:05:43s
epoch 20 | loss: 0.58097 | train_auc: 0.7572  | train_balanced_accuracy: 0.68824 | train_accuracy: 0.68854 | valid_auc: 0.74639 | valid_balanced_accuracy: 0.68417 | valid_accuracy: 0.68445 |  0:06:01s
epoch 21 | loss: 0.57412 | train_auc: 0.76274 | train_balanced_accuracy: 0.69345 | train_accuracy: 0.69385 | valid_auc: 0.75028 | valid_balanced_accuracy: 0.68629 | valid_accuracy: 0.68665 |  0:06:16s
epoch 22 | loss: 0.58107 | train_auc: 0.76469 | train_balanced_accuracy: 0.69712 | train_accuracy: 0.69767 | valid_auc: 0.752   | valid_balanced_accuracy: 0.68616 | valid_accuracy: 0.68665 |  0:06:33s
epoch 23 | loss: 0.57866 | train_auc: 0.76553 | train_balanced_accuracy: 0.6979  | train_accuracy: 0.69818 | valid_auc: 0.75383 | valid_balanced_accuracy: 0.69162 | valid_accuracy: 0.69185 |  0:06:50s
epoch 24 | loss: 0.57942 | train_auc: 0.76449 | train_balanced_accuracy: 0.69448 | train_accuracy: 0.69484 | valid_auc: 0.74857 | valid_balanced_accuracy: 0.68693 | valid_accuracy: 0.68728 |  0:07:07s
epoch 25 | loss: 0.57317 | train_auc: 0.76558 | train_balanced_accuracy: 0.69478 | train_accuracy: 0.69488 | valid_auc: 0.75082 | valid_balanced_accuracy: 0.68327 | valid_accuracy: 0.68335 |  0:07:24s
epoch 26 | loss: 0.5737  | train_auc: 0.75783 | train_balanced_accuracy: 0.68946 | train_accuracy: 0.68992 | valid_auc: 0.74508 | valid_balanced_accuracy: 0.68085 | valid_accuracy: 0.6813  |  0:07:41s
epoch 27 | loss: 0.57197 | train_auc: 0.76152 | train_balanced_accuracy: 0.69693 | train_accuracy: 0.69724 | valid_auc: 0.74712 | valid_balanced_accuracy: 0.68447 | valid_accuracy: 0.68477 |  0:07:59s
epoch 28 | loss: 0.56817 | train_auc: 0.76841 | train_balanced_accuracy: 0.70102 | train_accuracy: 0.70125 | valid_auc: 0.75037 | valid_balanced_accuracy: 0.68393 | valid_accuracy: 0.68414 |  0:08:16s
epoch 29 | loss: 0.56809 | train_auc: 0.77441 | train_balanced_accuracy: 0.70457 | train_accuracy: 0.70483 | valid_auc: 0.75564 | valid_balanced_accuracy: 0.69117 | valid_accuracy: 0.69138 |  0:08:35s
epoch 30 | loss: 0.56786 | train_auc: 0.77867 | train_balanced_accuracy: 0.70845 | train_accuracy: 0.70869 | valid_auc: 0.75464 | valid_balanced_accuracy: 0.6874  | valid_accuracy: 0.6876  |  0:08:52s
epoch 31 | loss: 0.57039 | train_auc: 0.77743 | train_balanced_accuracy: 0.70356 | train_accuracy: 0.70404 | valid_auc: 0.75545 | valid_balanced_accuracy: 0.6927  | valid_accuracy: 0.69311 |  0:09:09s
epoch 32 | loss: 0.5636  | train_auc: 0.77913 | train_balanced_accuracy: 0.7073  | train_accuracy: 0.70735 | valid_auc: 0.75397 | valid_balanced_accuracy: 0.68714 | valid_accuracy: 0.68713 |  0:09:27s
epoch 33 | loss: 0.56607 | train_auc: 0.77972 | train_balanced_accuracy: 0.70624 | train_accuracy: 0.7066  | valid_auc: 0.75371 | valid_balanced_accuracy: 0.68825 | valid_accuracy: 0.68854 |  0:09:44s
epoch 34 | loss: 0.56563 | train_auc: 0.78428 | train_balanced_accuracy: 0.70862 | train_accuracy: 0.70881 | valid_auc: 0.75644 | valid_balanced_accuracy: 0.69075 | valid_accuracy: 0.6909  |  0:10:00s
epoch 35 | loss: 0.56361 | train_auc: 0.78592 | train_balanced_accuracy: 0.71277 | train_accuracy: 0.71317 | valid_auc: 0.75764 | valid_balanced_accuracy: 0.69794 | valid_accuracy: 0.6983  |  0:10:19s
epoch 36 | loss: 0.56131 | train_auc: 0.79073 | train_balanced_accuracy: 0.71642 | train_accuracy: 0.71648 | valid_auc: 0.7625  | valid_balanced_accuracy: 0.69893 | valid_accuracy: 0.69893 |  0:10:36s
epoch 37 | loss: 0.56403 | train_auc: 0.78828 | train_balanced_accuracy: 0.71493 | train_accuracy: 0.71526 | valid_auc: 0.75742 | valid_balanced_accuracy: 0.69241 | valid_accuracy: 0.69263 |  0:10:53s
epoch 38 | loss: 0.56049 | train_auc: 0.79163 | train_balanced_accuracy: 0.71641 | train_accuracy: 0.71628 | valid_auc: 0.75835 | valid_balanced_accuracy: 0.68826 | valid_accuracy: 0.68807 |  0:11:12s
epoch 39 | loss: 0.55754 | train_auc: 0.78784 | train_balanced_accuracy: 0.71202 | train_accuracy: 0.71235 | valid_auc: 0.75833 | valid_balanced_accuracy: 0.69189 | valid_accuracy: 0.69216 |  0:11:30s
epoch 40 | loss: 0.5608  | train_auc: 0.79051 | train_balanced_accuracy: 0.71509 | train_accuracy: 0.7153  | valid_auc: 0.75928 | valid_balanced_accuracy: 0.69424 | valid_accuracy: 0.69437 |  0:11:48s
epoch 41 | loss: 0.56069 | train_auc: 0.7932  | train_balanced_accuracy: 0.71681 | train_accuracy: 0.71703 | valid_auc: 0.75835 | valid_balanced_accuracy: 0.69156 | valid_accuracy: 0.69169 |  0:12:07s
epoch 42 | loss: 0.55117 | train_auc: 0.79062 | train_balanced_accuracy: 0.71635 | train_accuracy: 0.71652 | valid_auc: 0.75497 | valid_balanced_accuracy: 0.68874 | valid_accuracy: 0.68886 |  0:12:24s
epoch 43 | loss: 0.56091 | train_auc: 0.79288 | train_balanced_accuracy: 0.7161  | train_accuracy: 0.71616 | valid_auc: 0.75582 | valid_balanced_accuracy: 0.6879  | valid_accuracy: 0.68791 |  0:12:41s
epoch 44 | loss: 0.56099 | train_auc: 0.79511 | train_balanced_accuracy: 0.71977 | train_accuracy: 0.71978 | valid_auc: 0.75566 | valid_balanced_accuracy: 0.68621 | valid_accuracy: 0.68618 |  0:12:57s
epoch 45 | loss: 0.55707 | train_auc: 0.79713 | train_balanced_accuracy: 0.72015 | train_accuracy: 0.72037 | valid_auc: 0.7602  | valid_balanced_accuracy: 0.69293 | valid_accuracy: 0.69311 |  0:13:13s
epoch 46 | loss: 0.55781 | train_auc: 0.79579 | train_balanced_accuracy: 0.71844 | train_accuracy: 0.71829 | valid_auc: 0.75673 | valid_balanced_accuracy: 0.6853  | valid_accuracy: 0.68508 |  0:13:31s
epoch 47 | loss: 0.55675 | train_auc: 0.79306 | train_balanced_accuracy: 0.71893 | train_accuracy: 0.71915 | valid_auc: 0.7568  | valid_balanced_accuracy: 0.68742 | valid_accuracy: 0.6876  |  0:13:48s
epoch 48 | loss: 0.55788 | train_auc: 0.79833 | train_balanced_accuracy: 0.72276 | train_accuracy: 0.72262 | valid_auc: 0.75708 | valid_balanced_accuracy: 0.68592 | valid_accuracy: 0.68571 |  0:14:04s
epoch 49 | loss: 0.55134 | train_auc: 0.79667 | train_balanced_accuracy: 0.72137 | train_accuracy: 0.72159 | valid_auc: 0.75762 | valid_balanced_accuracy: 0.69229 | valid_accuracy: 0.69248 |  0:14:22s
epoch 50 | loss: 0.55383 | train_auc: 0.79429 | train_balanced_accuracy: 0.71925 | train_accuracy: 0.71935 | valid_auc: 0.75551 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68854 |  0:14:41s
epoch 51 | loss: 0.5495  | train_auc: 0.80163 | train_balanced_accuracy: 0.72445 | train_accuracy: 0.7247  | valid_auc: 0.7611  | valid_balanced_accuracy: 0.69714 | valid_accuracy: 0.69736 |  0:14:59s
epoch 52 | loss: 0.54533 | train_auc: 0.80218 | train_balanced_accuracy: 0.72615 | train_accuracy: 0.7262  | valid_auc: 0.75618 | valid_balanced_accuracy: 0.68858 | valid_accuracy: 0.68854 |  0:15:15s
epoch 53 | loss: 0.54602 | train_auc: 0.80284 | train_balanced_accuracy: 0.72676 | train_accuracy: 0.72679 | valid_auc: 0.76087 | valid_balanced_accuracy: 0.6911  | valid_accuracy: 0.69106 |  0:15:31s
epoch 54 | loss: 0.55257 | train_auc: 0.80345 | train_balanced_accuracy: 0.72477 | train_accuracy: 0.72486 | valid_auc: 0.76159 | valid_balanced_accuracy: 0.69937 | valid_accuracy: 0.6994  |  0:15:48s
epoch 55 | loss: 0.54775 | train_auc: 0.803   | train_balanced_accuracy: 0.7257  | train_accuracy: 0.72557 | valid_auc: 0.75971 | valid_balanced_accuracy: 0.68604 | valid_accuracy: 0.68587 |  0:16:06s
epoch 56 | loss: 0.54546 | train_auc: 0.80166 | train_balanced_accuracy: 0.72553 | train_accuracy: 0.72541 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.69217 | valid_accuracy: 0.69201 |  0:16:24s
epoch 57 | loss: 0.54697 | train_auc: 0.80226 | train_balanced_accuracy: 0.72346 | train_accuracy: 0.72325 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.68771 | valid_accuracy: 0.68744 |  0:16:42s
epoch 58 | loss: 0.54702 | train_auc: 0.80382 | train_balanced_accuracy: 0.7279  | train_accuracy: 0.72789 | valid_auc: 0.75926 | valid_balanced_accuracy: 0.69189 | valid_accuracy: 0.69185 |  0:16:59s
epoch 59 | loss: 0.54217 | train_auc: 0.80274 | train_balanced_accuracy: 0.72481 | train_accuracy: 0.72478 | valid_auc: 0.75873 | valid_balanced_accuracy: 0.68766 | valid_accuracy: 0.6876  |  0:17:16s
epoch 60 | loss: 0.54835 | train_auc: 0.80663 | train_balanced_accuracy: 0.72446 | train_accuracy: 0.72427 | valid_auc: 0.75875 | valid_balanced_accuracy: 0.69273 | valid_accuracy: 0.69248 |  0:17:34s
epoch 61 | loss: 0.54628 | train_auc: 0.80823 | train_balanced_accuracy: 0.72937 | train_accuracy: 0.72958 | valid_auc: 0.7609  | valid_balanced_accuracy: 0.68918 | valid_accuracy: 0.68933 |  0:17:52s
epoch 62 | loss: 0.54192 | train_auc: 0.81193 | train_balanced_accuracy: 0.73309 | train_accuracy: 0.73296 | valid_auc: 0.76402 | valid_balanced_accuracy: 0.69376 | valid_accuracy: 0.69358 |  0:18:09s
epoch 63 | loss: 0.5418  | train_auc: 0.79928 | train_balanced_accuracy: 0.72321 | train_accuracy: 0.7234  | valid_auc: 0.75326 | valid_balanced_accuracy: 0.69014 | valid_accuracy: 0.69027 |  0:18:26s
epoch 64 | loss: 0.53998 | train_auc: 0.80771 | train_balanced_accuracy: 0.7285  | train_accuracy: 0.72864 | valid_auc: 0.75957 | valid_balanced_accuracy: 0.68811 | valid_accuracy: 0.68823 |  0:18:43s
epoch 65 | loss: 0.53677 | train_auc: 0.81143 | train_balanced_accuracy: 0.73431 | train_accuracy: 0.73434 | valid_auc: 0.75663 | valid_balanced_accuracy: 0.68967 | valid_accuracy: 0.68964 |  0:19:02s
epoch 66 | loss: 0.54547 | train_auc: 0.81287 | train_balanced_accuracy: 0.73272 | train_accuracy: 0.73277 | valid_auc: 0.76015 | valid_balanced_accuracy: 0.69121 | valid_accuracy: 0.69122 |  0:19:18s
epoch 67 | loss: 0.53556 | train_auc: 0.80758 | train_balanced_accuracy: 0.72862 | train_accuracy: 0.72875 | valid_auc: 0.75797 | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.6898  |  0:19:36s
epoch 68 | loss: 0.54248 | train_auc: 0.81424 | train_balanced_accuracy: 0.73474 | train_accuracy: 0.73481 | valid_auc: 0.76223 | valid_balanced_accuracy: 0.69361 | valid_accuracy: 0.69358 |  0:19:54s
epoch 69 | loss: 0.53912 | train_auc: 0.81473 | train_balanced_accuracy: 0.73392 | train_accuracy: 0.73379 | valid_auc: 0.75994 | valid_balanced_accuracy: 0.69141 | valid_accuracy: 0.69122 |  0:20:12s
epoch 70 | loss: 0.53332 | train_auc: 0.81604 | train_balanced_accuracy: 0.73636 | train_accuracy: 0.73627 | valid_auc: 0.76132 | valid_balanced_accuracy: 0.69122 | valid_accuracy: 0.69106 |  0:20:30s
epoch 71 | loss: 0.54172 | train_auc: 0.81437 | train_balanced_accuracy: 0.7343  | train_accuracy: 0.73438 | valid_auc: 0.76066 | valid_balanced_accuracy: 0.69135 | valid_accuracy: 0.69138 |  0:20:48s
epoch 72 | loss: 0.53931 | train_auc: 0.8183  | train_balanced_accuracy: 0.73762 | train_accuracy: 0.73765 | valid_auc: 0.76118 | valid_balanced_accuracy: 0.69219 | valid_accuracy: 0.69216 |  0:21:05s
epoch 73 | loss: 0.53239 | train_auc: 0.81886 | train_balanced_accuracy: 0.73824 | train_accuracy: 0.73835 | valid_auc: 0.76471 | valid_balanced_accuracy: 0.69474 | valid_accuracy: 0.69484 |  0:21:22s
epoch 74 | loss: 0.53693 | train_auc: 0.8185  | train_balanced_accuracy: 0.7341  | train_accuracy: 0.73446 | valid_auc: 0.76593 | valid_balanced_accuracy: 0.69532 | valid_accuracy: 0.69562 |  0:21:39s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.6994
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 65/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.696 total time=21.8min
[CV 4/5; 65/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71729 | train_auc: 0.58623 | train_balanced_accuracy: 0.53079 | train_accuracy: 0.52849 | valid_auc: 0.58654 | valid_balanced_accuracy: 0.5305  | valid_accuracy: 0.52817 |  0:00:16s
epoch 1  | loss: 0.6496  | train_auc: 0.68016 | train_balanced_accuracy: 0.63431 | train_accuracy: 0.63432 | valid_auc: 0.67232 | valid_balanced_accuracy: 0.6256  | valid_accuracy: 0.62559 |  0:00:31s
epoch 2  | loss: 0.62626 | train_auc: 0.69482 | train_balanced_accuracy: 0.63352 | train_accuracy: 0.63488 | valid_auc: 0.68854 | valid_balanced_accuracy: 0.63363 | valid_accuracy: 0.63503 |  0:00:48s
epoch 3  | loss: 0.6202  | train_auc: 0.70669 | train_balanced_accuracy: 0.64167 | train_accuracy: 0.64271 | valid_auc: 0.70356 | valid_balanced_accuracy: 0.64385 | valid_accuracy: 0.64495 |  0:01:03s
epoch 4  | loss: 0.61036 | train_auc: 0.70528 | train_balanced_accuracy: 0.63677 | train_accuracy: 0.63798 | valid_auc: 0.70297 | valid_balanced_accuracy: 0.63612 | valid_accuracy: 0.63739 |  0:01:20s
epoch 5  | loss: 0.6086  | train_auc: 0.71052 | train_balanced_accuracy: 0.64849 | train_accuracy: 0.64951 | valid_auc: 0.71219 | valid_balanced_accuracy: 0.64923 | valid_accuracy: 0.6503  |  0:01:37s
epoch 6  | loss: 0.60509 | train_auc: 0.70861 | train_balanced_accuracy: 0.65788 | train_accuracy: 0.6586  | valid_auc: 0.70977 | valid_balanced_accuracy: 0.65754 | valid_accuracy: 0.65833 |  0:01:56s
epoch 7  | loss: 0.60088 | train_auc: 0.71059 | train_balanced_accuracy: 0.64711 | train_accuracy: 0.64774 | valid_auc: 0.7124  | valid_balanced_accuracy: 0.64868 | valid_accuracy: 0.64935 |  0:02:13s
epoch 8  | loss: 0.59941 | train_auc: 0.71345 | train_balanced_accuracy: 0.65712 | train_accuracy: 0.65726 | valid_auc: 0.71308 | valid_balanced_accuracy: 0.65862 | valid_accuracy: 0.6588  |  0:02:30s
epoch 9  | loss: 0.59519 | train_auc: 0.72015 | train_balanced_accuracy: 0.65947 | train_accuracy: 0.65958 | valid_auc: 0.72008 | valid_balanced_accuracy: 0.66226 | valid_accuracy: 0.66242 |  0:02:46s
epoch 10 | loss: 0.58828 | train_auc: 0.71917 | train_balanced_accuracy: 0.65975 | train_accuracy: 0.6599  | valid_auc: 0.71494 | valid_balanced_accuracy: 0.65857 | valid_accuracy: 0.6588  |  0:03:03s
epoch 11 | loss: 0.58979 | train_auc: 0.72338 | train_balanced_accuracy: 0.66007 | train_accuracy: 0.66029 | valid_auc: 0.71701 | valid_balanced_accuracy: 0.65789 | valid_accuracy: 0.65817 |  0:03:22s
epoch 12 | loss: 0.58628 | train_auc: 0.72762 | train_balanced_accuracy: 0.66396 | train_accuracy: 0.6645  | valid_auc: 0.71967 | valid_balanced_accuracy: 0.65285 | valid_accuracy: 0.65345 |  0:03:38s
epoch 13 | loss: 0.58431 | train_auc: 0.73156 | train_balanced_accuracy: 0.66491 | train_accuracy: 0.66497 | valid_auc: 0.72523 | valid_balanced_accuracy: 0.66199 | valid_accuracy: 0.6621  |  0:03:56s
epoch 14 | loss: 0.58611 | train_auc: 0.73479 | train_balanced_accuracy: 0.67103 | train_accuracy: 0.67131 | valid_auc: 0.72843 | valid_balanced_accuracy: 0.66287 | valid_accuracy: 0.6632  |  0:04:13s
epoch 15 | loss: 0.58691 | train_auc: 0.73856 | train_balanced_accuracy: 0.67002 | train_accuracy: 0.67025 | valid_auc: 0.72787 | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.66336 |  0:04:30s
epoch 16 | loss: 0.57956 | train_auc: 0.73886 | train_balanced_accuracy: 0.67079 | train_accuracy: 0.67092 | valid_auc: 0.72972 | valid_balanced_accuracy: 0.65848 | valid_accuracy: 0.65864 |  0:04:47s
epoch 17 | loss: 0.57809 | train_auc: 0.7486  | train_balanced_accuracy: 0.67944 | train_accuracy: 0.67993 | valid_auc: 0.73765 | valid_balanced_accuracy: 0.67197 | valid_accuracy: 0.67249 |  0:05:06s
epoch 18 | loss: 0.58302 | train_auc: 0.75023 | train_balanced_accuracy: 0.68126 | train_accuracy: 0.68162 | valid_auc: 0.73208 | valid_balanced_accuracy: 0.66549 | valid_accuracy: 0.66588 |  0:05:24s
epoch 19 | loss: 0.57288 | train_auc: 0.74743 | train_balanced_accuracy: 0.68201 | train_accuracy: 0.68237 | valid_auc: 0.73535 | valid_balanced_accuracy: 0.67493 | valid_accuracy: 0.67532 |  0:05:41s
epoch 20 | loss: 0.57392 | train_auc: 0.75208 | train_balanced_accuracy: 0.68464 | train_accuracy: 0.68504 | valid_auc: 0.73714 | valid_balanced_accuracy: 0.66829 | valid_accuracy: 0.66871 |  0:06:01s
epoch 21 | loss: 0.57445 | train_auc: 0.76014 | train_balanced_accuracy: 0.68916 | train_accuracy: 0.6898  | valid_auc: 0.74425 | valid_balanced_accuracy: 0.67453 | valid_accuracy: 0.67517 |  0:06:18s
epoch 22 | loss: 0.57271 | train_auc: 0.76226 | train_balanced_accuracy: 0.68716 | train_accuracy: 0.6876  | valid_auc: 0.74268 | valid_balanced_accuracy: 0.66872 | valid_accuracy: 0.66918 |  0:06:35s
epoch 23 | loss: 0.57235 | train_auc: 0.76997 | train_balanced_accuracy: 0.69513 | train_accuracy: 0.69547 | valid_auc: 0.75115 | valid_balanced_accuracy: 0.68033 | valid_accuracy: 0.68067 |  0:06:52s
epoch 24 | loss: 0.57243 | train_auc: 0.76417 | train_balanced_accuracy: 0.6905  | train_accuracy: 0.69118 | valid_auc: 0.744   | valid_balanced_accuracy: 0.674   | valid_accuracy: 0.67469 |  0:07:10s
epoch 25 | loss: 0.5668  | train_auc: 0.75423 | train_balanced_accuracy: 0.68672 | train_accuracy: 0.68693 | valid_auc: 0.74288 | valid_balanced_accuracy: 0.67539 | valid_accuracy: 0.67564 |  0:07:26s
epoch 26 | loss: 0.56903 | train_auc: 0.76679 | train_balanced_accuracy: 0.6948  | train_accuracy: 0.69547 | valid_auc: 0.7492  | valid_balanced_accuracy: 0.67981 | valid_accuracy: 0.68052 |  0:07:43s
epoch 27 | loss: 0.56742 | train_auc: 0.77274 | train_balanced_accuracy: 0.69803 | train_accuracy: 0.6985  | valid_auc: 0.75293 | valid_balanced_accuracy: 0.68254 | valid_accuracy: 0.68303 |  0:08:01s
epoch 28 | loss: 0.56454 | train_auc: 0.77622 | train_balanced_accuracy: 0.70278 | train_accuracy: 0.70314 | valid_auc: 0.75549 | valid_balanced_accuracy: 0.68428 | valid_accuracy: 0.68461 |  0:08:17s
epoch 29 | loss: 0.56229 | train_auc: 0.77988 | train_balanced_accuracy: 0.70821 | train_accuracy: 0.70837 | valid_auc: 0.75523 | valid_balanced_accuracy: 0.68808 | valid_accuracy: 0.68823 |  0:08:34s
epoch 30 | loss: 0.55856 | train_auc: 0.78272 | train_balanced_accuracy: 0.70463 | train_accuracy: 0.70499 | valid_auc: 0.75873 | valid_balanced_accuracy: 0.68817 | valid_accuracy: 0.68854 |  0:08:51s
epoch 31 | loss: 0.56144 | train_auc: 0.787   | train_balanced_accuracy: 0.70863 | train_accuracy: 0.70908 | valid_auc: 0.75323 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.68571 |  0:09:08s
epoch 32 | loss: 0.55543 | train_auc: 0.78873 | train_balanced_accuracy: 0.70955 | train_accuracy: 0.70936 | valid_auc: 0.76057 | valid_balanced_accuracy: 0.68618 | valid_accuracy: 0.68602 |  0:09:24s
epoch 33 | loss: 0.55936 | train_auc: 0.78605 | train_balanced_accuracy: 0.70667 | train_accuracy: 0.70715 | valid_auc: 0.76063 | valid_balanced_accuracy: 0.68632 | valid_accuracy: 0.68681 |  0:09:42s
epoch 34 | loss: 0.5567  | train_auc: 0.79279 | train_balanced_accuracy: 0.71615 | train_accuracy: 0.7164  | valid_auc: 0.76389 | valid_balanced_accuracy: 0.6922  | valid_accuracy: 0.69248 |  0:09:59s
epoch 35 | loss: 0.55088 | train_auc: 0.7909  | train_balanced_accuracy: 0.71105 | train_accuracy: 0.71124 | valid_auc: 0.75882 | valid_balanced_accuracy: 0.68602 | valid_accuracy: 0.68618 |  0:10:15s
epoch 36 | loss: 0.55211 | train_auc: 0.7929  | train_balanced_accuracy: 0.71613 | train_accuracy: 0.71616 | valid_auc: 0.76211 | valid_balanced_accuracy: 0.69041 | valid_accuracy: 0.69043 |  0:10:34s
epoch 37 | loss: 0.55106 | train_auc: 0.79244 | train_balanced_accuracy: 0.70807 | train_accuracy: 0.70873 | valid_auc: 0.75827 | valid_balanced_accuracy: 0.68394 | valid_accuracy: 0.68461 |  0:10:52s
epoch 38 | loss: 0.55464 | train_auc: 0.78454 | train_balanced_accuracy: 0.70699 | train_accuracy: 0.70711 | valid_auc: 0.75877 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.6887  |  0:11:09s
epoch 39 | loss: 0.55154 | train_auc: 0.79348 | train_balanced_accuracy: 0.71502 | train_accuracy: 0.71506 | valid_auc: 0.75893 | valid_balanced_accuracy: 0.68545 | valid_accuracy: 0.68555 |  0:11:25s
epoch 40 | loss: 0.55196 | train_auc: 0.79488 | train_balanced_accuracy: 0.71479 | train_accuracy: 0.71475 | valid_auc: 0.76156 | valid_balanced_accuracy: 0.68564 | valid_accuracy: 0.68555 |  0:11:43s
epoch 41 | loss: 0.55444 | train_auc: 0.79734 | train_balanced_accuracy: 0.71735 | train_accuracy: 0.71758 | valid_auc: 0.76243 | valid_balanced_accuracy: 0.68956 | valid_accuracy: 0.6898  |  0:12:00s
epoch 42 | loss: 0.54608 | train_auc: 0.79668 | train_balanced_accuracy: 0.71872 | train_accuracy: 0.71892 | valid_auc: 0.76387 | valid_balanced_accuracy: 0.69324 | valid_accuracy: 0.69342 |  0:12:17s
epoch 43 | loss: 0.55164 | train_auc: 0.79717 | train_balanced_accuracy: 0.71854 | train_accuracy: 0.71845 | valid_auc: 0.76509 | valid_balanced_accuracy: 0.69431 | valid_accuracy: 0.69421 |  0:12:34s
epoch 44 | loss: 0.55097 | train_auc: 0.79118 | train_balanced_accuracy: 0.71349 | train_accuracy: 0.71361 | valid_auc: 0.76365 | valid_balanced_accuracy: 0.69283 | valid_accuracy: 0.69295 |  0:12:51s
epoch 45 | loss: 0.54625 | train_auc: 0.79667 | train_balanced_accuracy: 0.71611 | train_accuracy: 0.71612 | valid_auc: 0.76478 | valid_balanced_accuracy: 0.69247 | valid_accuracy: 0.69248 |  0:13:07s
epoch 46 | loss: 0.54977 | train_auc: 0.7813  | train_balanced_accuracy: 0.70665 | train_accuracy: 0.70648 | valid_auc: 0.75664 | valid_balanced_accuracy: 0.68573 | valid_accuracy: 0.68555 |  0:13:24s
epoch 47 | loss: 0.54169 | train_auc: 0.79142 | train_balanced_accuracy: 0.7141  | train_accuracy: 0.71424 | valid_auc: 0.76299 | valid_balanced_accuracy: 0.69585 | valid_accuracy: 0.69594 |  0:13:41s
epoch 48 | loss: 0.54363 | train_auc: 0.78607 | train_balanced_accuracy: 0.70919 | train_accuracy: 0.709   | valid_auc: 0.75984 | valid_balanced_accuracy: 0.68654 | valid_accuracy: 0.68634 |  0:13:59s
epoch 49 | loss: 0.54382 | train_auc: 0.8042  | train_balanced_accuracy: 0.72277 | train_accuracy: 0.72297 | valid_auc: 0.76275 | valid_balanced_accuracy: 0.69026 | valid_accuracy: 0.69043 |  0:14:17s
epoch 50 | loss: 0.54845 | train_auc: 0.80053 | train_balanced_accuracy: 0.71971 | train_accuracy: 0.7197  | valid_auc: 0.76555 | valid_balanced_accuracy: 0.69043 | valid_accuracy: 0.69043 |  0:14:34s
epoch 51 | loss: 0.54598 | train_auc: 0.80365 | train_balanced_accuracy: 0.72445 | train_accuracy: 0.72454 | valid_auc: 0.76403 | valid_balanced_accuracy: 0.69223 | valid_accuracy: 0.69232 |  0:14:50s
epoch 52 | loss: 0.54045 | train_auc: 0.79446 | train_balanced_accuracy: 0.71465 | train_accuracy: 0.71431 | valid_auc: 0.76133 | valid_balanced_accuracy: 0.68653 | valid_accuracy: 0.68618 |  0:15:07s
epoch 53 | loss: 0.54043 | train_auc: 0.80488 | train_balanced_accuracy: 0.72192 | train_accuracy: 0.72214 | valid_auc: 0.76396 | valid_balanced_accuracy: 0.69414 | valid_accuracy: 0.69437 |  0:15:25s
epoch 54 | loss: 0.54088 | train_auc: 0.81351 | train_balanced_accuracy: 0.7309  | train_accuracy: 0.73092 | valid_auc: 0.76934 | valid_balanced_accuracy: 0.69811 | valid_accuracy: 0.69814 |  0:15:42s
epoch 55 | loss: 0.53664 | train_auc: 0.81193 | train_balanced_accuracy: 0.72863 | train_accuracy: 0.72848 | valid_auc: 0.76316 | valid_balanced_accuracy: 0.6921  | valid_accuracy: 0.69201 |  0:15:58s
epoch 56 | loss: 0.53937 | train_auc: 0.80832 | train_balanced_accuracy: 0.72715 | train_accuracy: 0.72718 | valid_auc: 0.76517 | valid_balanced_accuracy: 0.69399 | valid_accuracy: 0.69405 |  0:16:14s
epoch 57 | loss: 0.54385 | train_auc: 0.80494 | train_balanced_accuracy: 0.72343 | train_accuracy: 0.72321 | valid_auc: 0.76217 | valid_balanced_accuracy: 0.68842 | valid_accuracy: 0.68823 |  0:16:33s
epoch 58 | loss: 0.54315 | train_auc: 0.80929 | train_balanced_accuracy: 0.72595 | train_accuracy: 0.72612 | valid_auc: 0.76572 | valid_balanced_accuracy: 0.69321 | valid_accuracy: 0.69342 |  0:16:50s
epoch 59 | loss: 0.53603 | train_auc: 0.7822  | train_balanced_accuracy: 0.70781 | train_accuracy: 0.70814 | valid_auc: 0.75406 | valid_balanced_accuracy: 0.68644 | valid_accuracy: 0.68681 |  0:17:06s
epoch 60 | loss: 0.53906 | train_auc: 0.79956 | train_balanced_accuracy: 0.71926 | train_accuracy: 0.71963 | valid_auc: 0.76424 | valid_balanced_accuracy: 0.69051 | valid_accuracy: 0.6909  |  0:17:23s
epoch 61 | loss: 0.53389 | train_auc: 0.81054 | train_balanced_accuracy: 0.72677 | train_accuracy: 0.72714 | valid_auc: 0.76499 | valid_balanced_accuracy: 0.68984 | valid_accuracy: 0.69027 |  0:17:40s
epoch 62 | loss: 0.53422 | train_auc: 0.81131 | train_balanced_accuracy: 0.72706 | train_accuracy: 0.72702 | valid_auc: 0.76896 | valid_balanced_accuracy: 0.68874 | valid_accuracy: 0.6887  |  0:17:56s
epoch 63 | loss: 0.53247 | train_auc: 0.77818 | train_balanced_accuracy: 0.70385 | train_accuracy: 0.70377 | valid_auc: 0.75035 | valid_balanced_accuracy: 0.67757 | valid_accuracy: 0.67753 |  0:18:15s
epoch 64 | loss: 0.5297  | train_auc: 0.80858 | train_balanced_accuracy: 0.72869 | train_accuracy: 0.72864 | valid_auc: 0.76388 | valid_balanced_accuracy: 0.69408 | valid_accuracy: 0.69405 |  0:18:31s
epoch 65 | loss: 0.53302 | train_auc: 0.78994 | train_balanced_accuracy: 0.71429 | train_accuracy: 0.71443 | valid_auc: 0.75427 | valid_balanced_accuracy: 0.68617 | valid_accuracy: 0.68634 |  0:18:49s
epoch 66 | loss: 0.53897 | train_auc: 0.80864 | train_balanced_accuracy: 0.72879 | train_accuracy: 0.72871 | valid_auc: 0.76664 | valid_balanced_accuracy: 0.69326 | valid_accuracy: 0.69326 |  0:19:05s
epoch 67 | loss: 0.53016 | train_auc: 0.77049 | train_balanced_accuracy: 0.69502 | train_accuracy: 0.6948  | valid_auc: 0.74818 | valid_balanced_accuracy: 0.68153 | valid_accuracy: 0.6813  |  0:19:22s
epoch 68 | loss: 0.53029 | train_auc: 0.81352 | train_balanced_accuracy: 0.73371 | train_accuracy: 0.73379 | valid_auc: 0.76484 | valid_balanced_accuracy: 0.69429 | valid_accuracy: 0.69437 |  0:19:38s
epoch 69 | loss: 0.53261 | train_auc: 0.78424 | train_balanced_accuracy: 0.70937 | train_accuracy: 0.70983 | valid_auc: 0.75024 | valid_balanced_accuracy: 0.67874 | valid_accuracy: 0.67926 |  0:19:54s
epoch 70 | loss: 0.52833 | train_auc: 0.80228 | train_balanced_accuracy: 0.7246  | train_accuracy: 0.72494 | valid_auc: 0.76019 | valid_balanced_accuracy: 0.68749 | valid_accuracy: 0.68791 |  0:20:11s
epoch 71 | loss: 0.53127 | train_auc: 0.80044 | train_balanced_accuracy: 0.72426 | train_accuracy: 0.72462 | valid_auc: 0.75671 | valid_balanced_accuracy: 0.68545 | valid_accuracy: 0.68587 |  0:20:30s
epoch 72 | loss: 0.53246 | train_auc: 0.82582 | train_balanced_accuracy: 0.74173 | train_accuracy: 0.74182 | valid_auc: 0.76654 | valid_balanced_accuracy: 0.69725 | valid_accuracy: 0.69736 |  0:20:47s
epoch 73 | loss: 0.52935 | train_auc: 0.8137  | train_balanced_accuracy: 0.73242 | train_accuracy: 0.73245 | valid_auc: 0.76746 | valid_balanced_accuracy: 0.69526 | valid_accuracy: 0.69531 |  0:21:03s
epoch 74 | loss: 0.53234 | train_auc: 0.79972 | train_balanced_accuracy: 0.71901 | train_accuracy: 0.71907 | valid_auc: 0.757   | valid_balanced_accuracy: 0.6834  | valid_accuracy: 0.68351 |  0:21:19s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69814
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 65/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.693 total time=21.5min
[CV 5/5; 65/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71523 | train_auc: 0.594   | train_balanced_accuracy: 0.56177 | train_accuracy: 0.56032 | valid_auc: 0.60058 | valid_balanced_accuracy: 0.56863 | valid_accuracy: 0.5672  |  0:00:17s
epoch 1  | loss: 0.65301 | train_auc: 0.61585 | train_balanced_accuracy: 0.58392 | train_accuracy: 0.58243 | valid_auc: 0.622   | valid_balanced_accuracy: 0.58762 | valid_accuracy: 0.58609 |  0:00:35s
epoch 2  | loss: 0.63668 | train_auc: 0.65805 | train_balanced_accuracy: 0.60803 | train_accuracy: 0.60726 | valid_auc: 0.65535 | valid_balanced_accuracy: 0.60707 | valid_accuracy: 0.60623 |  0:00:53s
epoch 3  | loss: 0.62487 | train_auc: 0.66788 | train_balanced_accuracy: 0.60367 | train_accuracy: 0.6021  | valid_auc: 0.6658  | valid_balanced_accuracy: 0.60282 | valid_accuracy: 0.6012  |  0:01:09s
epoch 4  | loss: 0.61231 | train_auc: 0.6686  | train_balanced_accuracy: 0.6066  | train_accuracy: 0.60521 | valid_auc: 0.66708 | valid_balanced_accuracy: 0.60452 | valid_accuracy: 0.60308 |  0:01:26s
epoch 5  | loss: 0.61071 | train_auc: 0.67044 | train_balanced_accuracy: 0.6138  | train_accuracy: 0.6128  | valid_auc: 0.66627 | valid_balanced_accuracy: 0.61149 | valid_accuracy: 0.61048 |  0:01:44s
epoch 6  | loss: 0.60883 | train_auc: 0.68017 | train_balanced_accuracy: 0.61965 | train_accuracy: 0.61894 | valid_auc: 0.67575 | valid_balanced_accuracy: 0.61697 | valid_accuracy: 0.6163  |  0:02:01s
epoch 7  | loss: 0.60745 | train_auc: 0.68324 | train_balanced_accuracy: 0.61852 | train_accuracy: 0.61784 | valid_auc: 0.67903 | valid_balanced_accuracy: 0.61399 | valid_accuracy: 0.61331 |  0:02:18s
epoch 8  | loss: 0.6071  | train_auc: 0.7     | train_balanced_accuracy: 0.62442 | train_accuracy: 0.62366 | valid_auc: 0.7004  | valid_balanced_accuracy: 0.62433 | valid_accuracy: 0.62354 |  0:02:35s
epoch 9  | loss: 0.60144 | train_auc: 0.69127 | train_balanced_accuracy: 0.62426 | train_accuracy: 0.62358 | valid_auc: 0.69027 | valid_balanced_accuracy: 0.62155 | valid_accuracy: 0.62087 |  0:02:52s
epoch 10 | loss: 0.60107 | train_auc: 0.70091 | train_balanced_accuracy: 0.63014 | train_accuracy: 0.62941 | valid_auc: 0.70027 | valid_balanced_accuracy: 0.632   | valid_accuracy: 0.63126 |  0:03:09s
epoch 11 | loss: 0.59588 | train_auc: 0.7132  | train_balanced_accuracy: 0.64362 | train_accuracy: 0.64318 | valid_auc: 0.71021 | valid_balanced_accuracy: 0.63781 | valid_accuracy: 0.63739 |  0:03:26s
epoch 12 | loss: 0.59576 | train_auc: 0.71611 | train_balanced_accuracy: 0.64366 | train_accuracy: 0.6433  | valid_auc: 0.71197 | valid_balanced_accuracy: 0.63964 | valid_accuracy: 0.63928 |  0:03:44s
epoch 13 | loss: 0.59704 | train_auc: 0.72168 | train_balanced_accuracy: 0.65342 | train_accuracy: 0.65313 | valid_auc: 0.71656 | valid_balanced_accuracy: 0.64352 | valid_accuracy: 0.64322 |  0:04:02s
epoch 14 | loss: 0.59092 | train_auc: 0.73344 | train_balanced_accuracy: 0.66835 | train_accuracy: 0.66859 | valid_auc: 0.72455 | valid_balanced_accuracy: 0.66359 | valid_accuracy: 0.66383 |  0:04:21s
epoch 15 | loss: 0.58826 | train_auc: 0.73775 | train_balanced_accuracy: 0.6703  | train_accuracy: 0.67052 | valid_auc: 0.73017 | valid_balanced_accuracy: 0.66553 | valid_accuracy: 0.66572 |  0:04:40s
epoch 16 | loss: 0.5907  | train_auc: 0.74512 | train_balanced_accuracy: 0.67649 | train_accuracy: 0.6765  | valid_auc: 0.73348 | valid_balanced_accuracy: 0.66795 | valid_accuracy: 0.66793 |  0:05:00s
epoch 17 | loss: 0.59029 | train_auc: 0.74837 | train_balanced_accuracy: 0.68363 | train_accuracy: 0.68378 | valid_auc: 0.73735 | valid_balanced_accuracy: 0.67204 | valid_accuracy: 0.67218 |  0:05:18s
epoch 18 | loss: 0.58469 | train_auc: 0.74889 | train_balanced_accuracy: 0.68225 | train_accuracy: 0.6826  | valid_auc: 0.73559 | valid_balanced_accuracy: 0.66775 | valid_accuracy: 0.66808 |  0:05:36s
epoch 19 | loss: 0.58578 | train_auc: 0.75378 | train_balanced_accuracy: 0.68404 | train_accuracy: 0.68414 | valid_auc: 0.73764 | valid_balanced_accuracy: 0.67475 | valid_accuracy: 0.67485 |  0:05:54s
epoch 20 | loss: 0.58168 | train_auc: 0.75598 | train_balanced_accuracy: 0.68761 | train_accuracy: 0.6878  | valid_auc: 0.73764 | valid_balanced_accuracy: 0.68004 | valid_accuracy: 0.6802  |  0:06:13s
epoch 21 | loss: 0.57967 | train_auc: 0.76302 | train_balanced_accuracy: 0.69731 | train_accuracy: 0.69775 | valid_auc: 0.73971 | valid_balanced_accuracy: 0.67992 | valid_accuracy: 0.68036 |  0:06:31s
epoch 22 | loss: 0.57984 | train_auc: 0.76106 | train_balanced_accuracy: 0.69403 | train_accuracy: 0.69448 | valid_auc: 0.74016 | valid_balanced_accuracy: 0.6802  | valid_accuracy: 0.68067 |  0:06:47s
epoch 23 | loss: 0.57562 | train_auc: 0.76115 | train_balanced_accuracy: 0.69193 | train_accuracy: 0.69236 | valid_auc: 0.7395  | valid_balanced_accuracy: 0.6752  | valid_accuracy: 0.67564 |  0:07:05s
epoch 24 | loss: 0.58321 | train_auc: 0.766   | train_balanced_accuracy: 0.69543 | train_accuracy: 0.69586 | valid_auc: 0.74069 | valid_balanced_accuracy: 0.67287 | valid_accuracy: 0.67328 |  0:07:24s
epoch 25 | loss: 0.57741 | train_auc: 0.77    | train_balanced_accuracy: 0.69918 | train_accuracy: 0.69928 | valid_auc: 0.74448 | valid_balanced_accuracy: 0.67902 | valid_accuracy: 0.6791  |  0:07:41s
epoch 26 | loss: 0.5752  | train_auc: 0.77307 | train_balanced_accuracy: 0.70424 | train_accuracy: 0.7046  | valid_auc: 0.74718 | valid_balanced_accuracy: 0.68331 | valid_accuracy: 0.68366 |  0:07:59s
epoch 27 | loss: 0.57384 | train_auc: 0.77536 | train_balanced_accuracy: 0.70252 | train_accuracy: 0.70251 | valid_auc: 0.75168 | valid_balanced_accuracy: 0.68795 | valid_accuracy: 0.68791 |  0:08:16s
epoch 28 | loss: 0.57387 | train_auc: 0.77326 | train_balanced_accuracy: 0.70381 | train_accuracy: 0.70393 | valid_auc: 0.74904 | valid_balanced_accuracy: 0.68767 | valid_accuracy: 0.68776 |  0:08:34s
epoch 29 | loss: 0.57407 | train_auc: 0.77848 | train_balanced_accuracy: 0.70736 | train_accuracy: 0.70747 | valid_auc: 0.74928 | valid_balanced_accuracy: 0.68685 | valid_accuracy: 0.68697 |  0:08:51s
epoch 30 | loss: 0.57315 | train_auc: 0.77681 | train_balanced_accuracy: 0.70546 | train_accuracy: 0.7057  | valid_auc: 0.74633 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.6813  |  0:09:08s
epoch 31 | loss: 0.57067 | train_auc: 0.76182 | train_balanced_accuracy: 0.69529 | train_accuracy: 0.69539 | valid_auc: 0.73967 | valid_balanced_accuracy: 0.68289 | valid_accuracy: 0.68303 |  0:09:27s
epoch 32 | loss: 0.56999 | train_auc: 0.74802 | train_balanced_accuracy: 0.6799  | train_accuracy: 0.67969 | valid_auc: 0.72961 | valid_balanced_accuracy: 0.66974 | valid_accuracy: 0.6695  |  0:09:45s
epoch 33 | loss: 0.57426 | train_auc: 0.75651 | train_balanced_accuracy: 0.69156 | train_accuracy: 0.69185 | valid_auc: 0.74144 | valid_balanced_accuracy: 0.67784 | valid_accuracy: 0.67816 |  0:10:02s
epoch 34 | loss: 0.5622  | train_auc: 0.75973 | train_balanced_accuracy: 0.69105 | train_accuracy: 0.69102 | valid_auc: 0.73818 | valid_balanced_accuracy: 0.67781 | valid_accuracy: 0.67784 |  0:10:20s
epoch 35 | loss: 0.56775 | train_auc: 0.75957 | train_balanced_accuracy: 0.69189 | train_accuracy: 0.69185 | valid_auc: 0.74043 | valid_balanced_accuracy: 0.68211 | valid_accuracy: 0.68209 |  0:10:38s
epoch 36 | loss: 0.56603 | train_auc: 0.75547 | train_balanced_accuracy: 0.68824 | train_accuracy: 0.68839 | valid_auc: 0.73706 | valid_balanced_accuracy: 0.67717 | valid_accuracy: 0.67737 |  0:10:55s
epoch 37 | loss: 0.56397 | train_auc: 0.76644 | train_balanced_accuracy: 0.70076 | train_accuracy: 0.70098 | valid_auc: 0.74392 | valid_balanced_accuracy: 0.67837 | valid_accuracy: 0.67863 |  0:11:13s
epoch 38 | loss: 0.56535 | train_auc: 0.76558 | train_balanced_accuracy: 0.69522 | train_accuracy: 0.69507 | valid_auc: 0.74356 | valid_balanced_accuracy: 0.67753 | valid_accuracy: 0.67737 |  0:11:32s
epoch 39 | loss: 0.56978 | train_auc: 0.77129 | train_balanced_accuracy: 0.70016 | train_accuracy: 0.70058 | valid_auc: 0.74518 | valid_balanced_accuracy: 0.68291 | valid_accuracy: 0.68335 |  0:11:51s
epoch 40 | loss: 0.56151 | train_auc: 0.7717  | train_balanced_accuracy: 0.70339 | train_accuracy: 0.70357 | valid_auc: 0.74865 | valid_balanced_accuracy: 0.68367 | valid_accuracy: 0.68382 |  0:12:07s
epoch 41 | loss: 0.55828 | train_auc: 0.77375 | train_balanced_accuracy: 0.70256 | train_accuracy: 0.70267 | valid_auc: 0.74867 | valid_balanced_accuracy: 0.68357 | valid_accuracy: 0.68366 |  0:12:25s
epoch 42 | loss: 0.55982 | train_auc: 0.78077 | train_balanced_accuracy: 0.70792 | train_accuracy: 0.70829 | valid_auc: 0.74765 | valid_balanced_accuracy: 0.68581 | valid_accuracy: 0.68618 |  0:12:43s
epoch 43 | loss: 0.55778 | train_auc: 0.77705 | train_balanced_accuracy: 0.70516 | train_accuracy: 0.70542 | valid_auc: 0.74984 | valid_balanced_accuracy: 0.69099 | valid_accuracy: 0.69122 |  0:13:00s
epoch 44 | loss: 0.55733 | train_auc: 0.79296 | train_balanced_accuracy: 0.71594 | train_accuracy: 0.71612 | valid_auc: 0.75959 | valid_balanced_accuracy: 0.69737 | valid_accuracy: 0.69751 |  0:13:17s
epoch 45 | loss: 0.55161 | train_auc: 0.78972 | train_balanced_accuracy: 0.71269 | train_accuracy: 0.71313 | valid_auc: 0.75124 | valid_balanced_accuracy: 0.68671 | valid_accuracy: 0.68713 |  0:13:34s
epoch 46 | loss: 0.55658 | train_auc: 0.7902  | train_balanced_accuracy: 0.71441 | train_accuracy: 0.71459 | valid_auc: 0.75392 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68477 |  0:13:53s
epoch 47 | loss: 0.55726 | train_auc: 0.78947 | train_balanced_accuracy: 0.7139  | train_accuracy: 0.71431 | valid_auc: 0.75586 | valid_balanced_accuracy: 0.68616 | valid_accuracy: 0.6865  |  0:14:10s
epoch 48 | loss: 0.55505 | train_auc: 0.79465 | train_balanced_accuracy: 0.71782 | train_accuracy: 0.71801 | valid_auc: 0.76091 | valid_balanced_accuracy: 0.69596 | valid_accuracy: 0.6961  |  0:14:29s
epoch 49 | loss: 0.55214 | train_auc: 0.79548 | train_balanced_accuracy: 0.72078 | train_accuracy: 0.72088 | valid_auc: 0.75618 | valid_balanced_accuracy: 0.6927  | valid_accuracy: 0.69279 |  0:14:47s
epoch 50 | loss: 0.5492  | train_auc: 0.79983 | train_balanced_accuracy: 0.72148 | train_accuracy: 0.72155 | valid_auc: 0.75251 | valid_balanced_accuracy: 0.68617 | valid_accuracy: 0.68618 |  0:15:05s
epoch 51 | loss: 0.55237 | train_auc: 0.79825 | train_balanced_accuracy: 0.71987 | train_accuracy: 0.72014 | valid_auc: 0.75657 | valid_balanced_accuracy: 0.69022 | valid_accuracy: 0.69043 |  0:15:25s
epoch 52 | loss: 0.55002 | train_auc: 0.80079 | train_balanced_accuracy: 0.72065 | train_accuracy: 0.72096 | valid_auc: 0.7556  | valid_balanced_accuracy: 0.69249 | valid_accuracy: 0.69279 |  0:15:42s
epoch 53 | loss: 0.55766 | train_auc: 0.80014 | train_balanced_accuracy: 0.72151 | train_accuracy: 0.72183 | valid_auc: 0.75569 | valid_balanced_accuracy: 0.68952 | valid_accuracy: 0.6898  |  0:16:01s
epoch 54 | loss: 0.55104 | train_auc: 0.80095 | train_balanced_accuracy: 0.72271 | train_accuracy: 0.72285 | valid_auc: 0.75683 | valid_balanced_accuracy: 0.68766 | valid_accuracy: 0.68776 |  0:16:20s
epoch 55 | loss: 0.55823 | train_auc: 0.80053 | train_balanced_accuracy: 0.72261 | train_accuracy: 0.72297 | valid_auc: 0.75702 | valid_balanced_accuracy: 0.69437 | valid_accuracy: 0.69468 |  0:16:38s
epoch 56 | loss: 0.55385 | train_auc: 0.79829 | train_balanced_accuracy: 0.71961 | train_accuracy: 0.71951 | valid_auc: 0.75328 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.68854 |  0:16:55s
epoch 57 | loss: 0.55045 | train_auc: 0.80169 | train_balanced_accuracy: 0.72326 | train_accuracy: 0.72348 | valid_auc: 0.75758 | valid_balanced_accuracy: 0.69354 | valid_accuracy: 0.69374 |  0:17:14s
epoch 58 | loss: 0.5463  | train_auc: 0.8022  | train_balanced_accuracy: 0.72272 | train_accuracy: 0.72262 | valid_auc: 0.75566 | valid_balanced_accuracy: 0.68888 | valid_accuracy: 0.6887  |  0:17:32s
epoch 59 | loss: 0.55252 | train_auc: 0.78953 | train_balanced_accuracy: 0.70794 | train_accuracy: 0.70837 | valid_auc: 0.75088 | valid_balanced_accuracy: 0.6839  | valid_accuracy: 0.68429 |  0:17:50s
epoch 60 | loss: 0.54739 | train_auc: 0.8047  | train_balanced_accuracy: 0.72502 | train_accuracy: 0.72517 | valid_auc: 0.7564  | valid_balanced_accuracy: 0.68916 | valid_accuracy: 0.68933 |  0:18:08s
epoch 61 | loss: 0.55102 | train_auc: 0.80173 | train_balanced_accuracy: 0.72266 | train_accuracy: 0.72289 | valid_auc: 0.75737 | valid_balanced_accuracy: 0.6893  | valid_accuracy: 0.68949 |  0:18:26s
epoch 62 | loss: 0.54343 | train_auc: 0.80201 | train_balanced_accuracy: 0.72317 | train_accuracy: 0.72321 | valid_auc: 0.75777 | valid_balanced_accuracy: 0.68913 | valid_accuracy: 0.68917 |  0:18:43s
epoch 63 | loss: 0.54509 | train_auc: 0.80309 | train_balanced_accuracy: 0.72366 | train_accuracy: 0.72391 | valid_auc: 0.75797 | valid_balanced_accuracy: 0.68815 | valid_accuracy: 0.68839 |  0:19:02s
epoch 64 | loss: 0.54058 | train_auc: 0.80867 | train_balanced_accuracy: 0.72704 | train_accuracy: 0.7273  | valid_auc: 0.75879 | valid_balanced_accuracy: 0.69519 | valid_accuracy: 0.69547 |  0:19:19s

Early stopping occurred at epoch 64 with best_epoch = 44 and best_valid_accuracy = 0.69751
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 65/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=19.5min
[CV 1/5; 66/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82139 | train_auc: 0.50569 | train_balanced_accuracy: 0.51426 | train_accuracy: 0.5119  | valid_auc: 0.49027 | valid_balanced_accuracy: 0.49975 | valid_accuracy: 0.49732 |  0:00:17s
epoch 1  | loss: 0.75373 | train_auc: 0.50508 | train_balanced_accuracy: 0.5182  | train_accuracy: 0.51564 | valid_auc: 0.49147 | valid_balanced_accuracy: 0.50908 | valid_accuracy: 0.50645 |  0:00:35s
epoch 2  | loss: 0.71183 | train_auc: 0.52602 | train_balanced_accuracy: 0.51761 | train_accuracy: 0.51481 | valid_auc: 0.51817 | valid_balanced_accuracy: 0.51012 | valid_accuracy: 0.50724 |  0:00:52s
epoch 3  | loss: 0.69021 | train_auc: 0.55137 | train_balanced_accuracy: 0.52437 | train_accuracy: 0.52178 | valid_auc: 0.54682 | valid_balanced_accuracy: 0.52107 | valid_accuracy: 0.51841 |  0:01:10s
epoch 4  | loss: 0.67191 | train_auc: 0.57171 | train_balanced_accuracy: 0.52908 | train_accuracy: 0.5263  | valid_auc: 0.56522 | valid_balanced_accuracy: 0.52553 | valid_accuracy: 0.52266 |  0:01:26s
epoch 5  | loss: 0.66748 | train_auc: 0.58616 | train_balanced_accuracy: 0.53596 | train_accuracy: 0.53331 | valid_auc: 0.57536 | valid_balanced_accuracy: 0.53217 | valid_accuracy: 0.52943 |  0:01:43s
epoch 6  | loss: 0.6654  | train_auc: 0.60227 | train_balanced_accuracy: 0.54925 | train_accuracy: 0.54684 | valid_auc: 0.59168 | valid_balanced_accuracy: 0.54514 | valid_accuracy: 0.54265 |  0:01:59s
epoch 7  | loss: 0.6591  | train_auc: 0.60981 | train_balanced_accuracy: 0.56086 | train_accuracy: 0.55865 | valid_auc: 0.59975 | valid_balanced_accuracy: 0.55391 | valid_accuracy: 0.55162 |  0:02:15s
epoch 8  | loss: 0.64933 | train_auc: 0.6187  | train_balanced_accuracy: 0.571   | train_accuracy: 0.56892 | valid_auc: 0.60947 | valid_balanced_accuracy: 0.56291 | valid_accuracy: 0.56075 |  0:02:34s
epoch 9  | loss: 0.65035 | train_auc: 0.62932 | train_balanced_accuracy: 0.58085 | train_accuracy: 0.57895 | valid_auc: 0.62052 | valid_balanced_accuracy: 0.57104 | valid_accuracy: 0.56909 |  0:02:51s
epoch 10 | loss: 0.64555 | train_auc: 0.64086 | train_balanced_accuracy: 0.59009 | train_accuracy: 0.58839 | valid_auc: 0.63348 | valid_balanced_accuracy: 0.5798  | valid_accuracy: 0.57806 |  0:03:10s
epoch 11 | loss: 0.64005 | train_auc: 0.65172 | train_balanced_accuracy: 0.6013  | train_accuracy: 0.59984 | valid_auc: 0.646   | valid_balanced_accuracy: 0.59265 | valid_accuracy: 0.59112 |  0:03:27s
epoch 12 | loss: 0.63904 | train_auc: 0.66077 | train_balanced_accuracy: 0.60392 | train_accuracy: 0.60244 | valid_auc: 0.65535 | valid_balanced_accuracy: 0.59407 | valid_accuracy: 0.59254 |  0:03:45s
epoch 13 | loss: 0.63969 | train_auc: 0.66821 | train_balanced_accuracy: 0.6101  | train_accuracy: 0.60881 | valid_auc: 0.66496 | valid_balanced_accuracy: 0.60395 | valid_accuracy: 0.60261 |  0:04:02s
epoch 14 | loss: 0.63419 | train_auc: 0.67694 | train_balanced_accuracy: 0.61764 | train_accuracy: 0.61653 | valid_auc: 0.67209 | valid_balanced_accuracy: 0.60723 | valid_accuracy: 0.60607 |  0:04:17s
epoch 15 | loss: 0.63006 | train_auc: 0.68182 | train_balanced_accuracy: 0.62417 | train_accuracy: 0.62325 | valid_auc: 0.67781 | valid_balanced_accuracy: 0.61897 | valid_accuracy: 0.61804 |  0:04:34s
epoch 16 | loss: 0.62818 | train_auc: 0.68546 | train_balanced_accuracy: 0.63024 | train_accuracy: 0.62947 | valid_auc: 0.68225 | valid_balanced_accuracy: 0.63283 | valid_accuracy: 0.63204 |  0:04:52s
epoch 17 | loss: 0.62826 | train_auc: 0.69098 | train_balanced_accuracy: 0.63408 | train_accuracy: 0.63337 | valid_auc: 0.68823 | valid_balanced_accuracy: 0.63719 | valid_accuracy: 0.63645 |  0:05:11s
epoch 18 | loss: 0.62286 | train_auc: 0.69731 | train_balanced_accuracy: 0.6413  | train_accuracy: 0.6408  | valid_auc: 0.69312 | valid_balanced_accuracy: 0.64012 | valid_accuracy: 0.6396  |  0:05:29s
epoch 19 | loss: 0.62282 | train_auc: 0.704   | train_balanced_accuracy: 0.64314 | train_accuracy: 0.64261 | valid_auc: 0.69771 | valid_balanced_accuracy: 0.64283 | valid_accuracy: 0.64227 |  0:05:45s
epoch 20 | loss: 0.6249  | train_auc: 0.70706 | train_balanced_accuracy: 0.64522 | train_accuracy: 0.64482 | valid_auc: 0.69943 | valid_balanced_accuracy: 0.64159 | valid_accuracy: 0.64117 |  0:06:04s
epoch 21 | loss: 0.61983 | train_auc: 0.70983 | train_balanced_accuracy: 0.64829 | train_accuracy: 0.648   | valid_auc: 0.70109 | valid_balanced_accuracy: 0.63864 | valid_accuracy: 0.63834 |  0:06:22s
epoch 22 | loss: 0.62183 | train_auc: 0.71341 | train_balanced_accuracy: 0.64918 | train_accuracy: 0.64899 | valid_auc: 0.70405 | valid_balanced_accuracy: 0.64137 | valid_accuracy: 0.64117 |  0:06:40s
epoch 23 | loss: 0.61746 | train_auc: 0.71701 | train_balanced_accuracy: 0.65291 | train_accuracy: 0.6528  | valid_auc: 0.70691 | valid_balanced_accuracy: 0.64711 | valid_accuracy: 0.64699 |  0:06:58s
epoch 24 | loss: 0.62304 | train_auc: 0.72065 | train_balanced_accuracy: 0.65973 | train_accuracy: 0.65985 | valid_auc: 0.7099  | valid_balanced_accuracy: 0.65725 | valid_accuracy: 0.65738 |  0:07:15s
epoch 25 | loss: 0.61673 | train_auc: 0.72106 | train_balanced_accuracy: 0.66058 | train_accuracy: 0.66079 | valid_auc: 0.7101  | valid_balanced_accuracy: 0.65007 | valid_accuracy: 0.6503  |  0:07:31s
epoch 26 | loss: 0.6175  | train_auc: 0.72334 | train_balanced_accuracy: 0.66309 | train_accuracy: 0.66319 | valid_auc: 0.71073 | valid_balanced_accuracy: 0.65412 | valid_accuracy: 0.65423 |  0:07:50s
epoch 27 | loss: 0.61395 | train_auc: 0.72522 | train_balanced_accuracy: 0.66466 | train_accuracy: 0.66488 | valid_auc: 0.71272 | valid_balanced_accuracy: 0.65555 | valid_accuracy: 0.65581 |  0:08:07s
epoch 28 | loss: 0.61409 | train_auc: 0.72808 | train_balanced_accuracy: 0.66666 | train_accuracy: 0.66693 | valid_auc: 0.71364 | valid_balanced_accuracy: 0.65743 | valid_accuracy: 0.6577  |  0:08:22s
epoch 29 | loss: 0.6126  | train_auc: 0.72928 | train_balanced_accuracy: 0.66811 | train_accuracy: 0.66835 | valid_auc: 0.71462 | valid_balanced_accuracy: 0.65855 | valid_accuracy: 0.6588  |  0:08:40s
epoch 30 | loss: 0.61045 | train_auc: 0.7313  | train_balanced_accuracy: 0.66903 | train_accuracy: 0.66937 | valid_auc: 0.7168  | valid_balanced_accuracy: 0.65574 | valid_accuracy: 0.65612 |  0:08:57s
epoch 31 | loss: 0.60973 | train_auc: 0.73187 | train_balanced_accuracy: 0.66886 | train_accuracy: 0.66921 | valid_auc: 0.71809 | valid_balanced_accuracy: 0.65685 | valid_accuracy: 0.65722 |  0:09:15s
epoch 32 | loss: 0.61254 | train_auc: 0.73569 | train_balanced_accuracy: 0.67243 | train_accuracy: 0.67279 | valid_auc: 0.71973 | valid_balanced_accuracy: 0.6603  | valid_accuracy: 0.66069 |  0:09:32s
epoch 33 | loss: 0.61076 | train_auc: 0.73487 | train_balanced_accuracy: 0.67111 | train_accuracy: 0.67138 | valid_auc: 0.71869 | valid_balanced_accuracy: 0.65792 | valid_accuracy: 0.65817 |  0:09:50s
epoch 34 | loss: 0.60739 | train_auc: 0.73508 | train_balanced_accuracy: 0.67177 | train_accuracy: 0.67204 | valid_auc: 0.71969 | valid_balanced_accuracy: 0.65711 | valid_accuracy: 0.65738 |  0:10:07s
epoch 35 | loss: 0.60903 | train_auc: 0.73585 | train_balanced_accuracy: 0.67054 | train_accuracy: 0.67106 | valid_auc: 0.72094 | valid_balanced_accuracy: 0.65641 | valid_accuracy: 0.65691 |  0:10:26s
epoch 36 | loss: 0.60941 | train_auc: 0.73499 | train_balanced_accuracy: 0.67142 | train_accuracy: 0.67169 | valid_auc: 0.72083 | valid_balanced_accuracy: 0.65775 | valid_accuracy: 0.65801 |  0:10:41s
epoch 37 | loss: 0.60448 | train_auc: 0.73455 | train_balanced_accuracy: 0.67006 | train_accuracy: 0.67051 | valid_auc: 0.7207  | valid_balanced_accuracy: 0.65598 | valid_accuracy: 0.65644 |  0:10:59s
epoch 38 | loss: 0.60604 | train_auc: 0.73168 | train_balanced_accuracy: 0.66932 | train_accuracy: 0.66949 | valid_auc: 0.71879 | valid_balanced_accuracy: 0.65379 | valid_accuracy: 0.65392 |  0:11:15s
epoch 39 | loss: 0.60785 | train_auc: 0.71415 | train_balanced_accuracy: 0.65638 | train_accuracy: 0.6567  | valid_auc: 0.70265 | valid_balanced_accuracy: 0.64844 | valid_accuracy: 0.64873 |  0:11:33s
epoch 40 | loss: 0.60595 | train_auc: 0.73316 | train_balanced_accuracy: 0.66812 | train_accuracy: 0.66846 | valid_auc: 0.71863 | valid_balanced_accuracy: 0.65748 | valid_accuracy: 0.65785 |  0:11:50s
epoch 41 | loss: 0.60478 | train_auc: 0.72337 | train_balanced_accuracy: 0.66027 | train_accuracy: 0.66055 | valid_auc: 0.70951 | valid_balanced_accuracy: 0.65174 | valid_accuracy: 0.65203 |  0:12:08s
epoch 42 | loss: 0.6023  | train_auc: 0.71703 | train_balanced_accuracy: 0.65678 | train_accuracy: 0.65701 | valid_auc: 0.70343 | valid_balanced_accuracy: 0.64785 | valid_accuracy: 0.6481  |  0:12:26s
epoch 43 | loss: 0.60617 | train_auc: 0.71159 | train_balanced_accuracy: 0.65266 | train_accuracy: 0.65284 | valid_auc: 0.69778 | valid_balanced_accuracy: 0.63911 | valid_accuracy: 0.63928 |  0:12:42s
epoch 44 | loss: 0.60365 | train_auc: 0.70935 | train_balanced_accuracy: 0.65145 | train_accuracy: 0.65178 | valid_auc: 0.69485 | valid_balanced_accuracy: 0.63424 | valid_accuracy: 0.63456 |  0:12:59s
epoch 45 | loss: 0.60432 | train_auc: 0.70917 | train_balanced_accuracy: 0.65165 | train_accuracy: 0.65182 | valid_auc: 0.6965  | valid_balanced_accuracy: 0.63864 | valid_accuracy: 0.63881 |  0:13:18s
epoch 46 | loss: 0.60324 | train_auc: 0.72034 | train_balanced_accuracy: 0.66039 | train_accuracy: 0.66052 | valid_auc: 0.7077  | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65502 |  0:13:35s
epoch 47 | loss: 0.60061 | train_auc: 0.70627 | train_balanced_accuracy: 0.65116 | train_accuracy: 0.65123 | valid_auc: 0.69402 | valid_balanced_accuracy: 0.63844 | valid_accuracy: 0.6385  |  0:13:53s
epoch 48 | loss: 0.597   | train_auc: 0.70528 | train_balanced_accuracy: 0.65355 | train_accuracy: 0.65383 | valid_auc: 0.69264 | valid_balanced_accuracy: 0.64103 | valid_accuracy: 0.64133 |  0:14:11s
epoch 49 | loss: 0.59991 | train_auc: 0.70188 | train_balanced_accuracy: 0.65135 | train_accuracy: 0.65154 | valid_auc: 0.6895  | valid_balanced_accuracy: 0.64223 | valid_accuracy: 0.64243 |  0:14:29s
epoch 50 | loss: 0.59832 | train_auc: 0.66651 | train_balanced_accuracy: 0.62672 | train_accuracy: 0.62727 | valid_auc: 0.66213 | valid_balanced_accuracy: 0.61874 | valid_accuracy: 0.61929 |  0:14:45s
epoch 51 | loss: 0.59697 | train_auc: 0.65439 | train_balanced_accuracy: 0.61615 | train_accuracy: 0.61668 | valid_auc: 0.65449 | valid_balanced_accuracy: 0.61015 | valid_accuracy: 0.61064 |  0:15:04s
epoch 52 | loss: 0.59671 | train_auc: 0.67617 | train_balanced_accuracy: 0.63297 | train_accuracy: 0.63352 | valid_auc: 0.66908 | valid_balanced_accuracy: 0.62375 | valid_accuracy: 0.62433 |  0:15:21s

Early stopping occurred at epoch 52 with best_epoch = 32 and best_valid_accuracy = 0.66069
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 66/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.669 total time=15.5min
[CV 2/5; 66/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82605 | train_auc: 0.52955 | train_balanced_accuracy: 0.52257 | train_accuracy: 0.5206  | valid_auc: 0.52978 | valid_balanced_accuracy: 0.52122 | valid_accuracy: 0.5192  |  0:00:16s
epoch 1  | loss: 0.73837 | train_auc: 0.51323 | train_balanced_accuracy: 0.51718 | train_accuracy: 0.51454 | valid_auc: 0.51641 | valid_balanced_accuracy: 0.50994 | valid_accuracy: 0.50724 |  0:00:34s
epoch 2  | loss: 0.70758 | train_auc: 0.52207 | train_balanced_accuracy: 0.51248 | train_accuracy: 0.50954 | valid_auc: 0.52698 | valid_balanced_accuracy: 0.50994 | valid_accuracy: 0.50692 |  0:00:50s
epoch 3  | loss: 0.69213 | train_auc: 0.54375 | train_balanced_accuracy: 0.51819 | train_accuracy: 0.51536 | valid_auc: 0.54679 | valid_balanced_accuracy: 0.5224  | valid_accuracy: 0.51952 |  0:01:06s
epoch 4  | loss: 0.67641 | train_auc: 0.5658  | train_balanced_accuracy: 0.52545 | train_accuracy: 0.52257 | valid_auc: 0.56449 | valid_balanced_accuracy: 0.52422 | valid_accuracy: 0.52125 |  0:01:24s
epoch 5  | loss: 0.67054 | train_auc: 0.58141 | train_balanced_accuracy: 0.52829 | train_accuracy: 0.52548 | valid_auc: 0.57675 | valid_balanced_accuracy: 0.52789 | valid_accuracy: 0.52502 |  0:01:43s
epoch 6  | loss: 0.66774 | train_auc: 0.5957  | train_balanced_accuracy: 0.54202 | train_accuracy: 0.53941 | valid_auc: 0.58965 | valid_balanced_accuracy: 0.54078 | valid_accuracy: 0.53809 |  0:02:00s
epoch 7  | loss: 0.66261 | train_auc: 0.6034  | train_balanced_accuracy: 0.54562 | train_accuracy: 0.54303 | valid_auc: 0.59521 | valid_balanced_accuracy: 0.54389 | valid_accuracy: 0.54123 |  0:02:17s
epoch 8  | loss: 0.65189 | train_auc: 0.61326 | train_balanced_accuracy: 0.55458 | train_accuracy: 0.55219 | valid_auc: 0.60538 | valid_balanced_accuracy: 0.55314 | valid_accuracy: 0.55068 |  0:02:35s
epoch 9  | loss: 0.65538 | train_auc: 0.62211 | train_balanced_accuracy: 0.56443 | train_accuracy: 0.56219 | valid_auc: 0.6126  | valid_balanced_accuracy: 0.56118 | valid_accuracy: 0.55886 |  0:02:50s
epoch 10 | loss: 0.64685 | train_auc: 0.63935 | train_balanced_accuracy: 0.5734  | train_accuracy: 0.57136 | valid_auc: 0.63039 | valid_balanced_accuracy: 0.5693  | valid_accuracy: 0.5672  |  0:03:08s
epoch 11 | loss: 0.64346 | train_auc: 0.6505  | train_balanced_accuracy: 0.58183 | train_accuracy: 0.57997 | valid_auc: 0.64181 | valid_balanced_accuracy: 0.57585 | valid_accuracy: 0.57397 |  0:03:23s
epoch 12 | loss: 0.64114 | train_auc: 0.65878 | train_balanced_accuracy: 0.59067 | train_accuracy: 0.58898 | valid_auc: 0.6514  | valid_balanced_accuracy: 0.58166 | valid_accuracy: 0.57995 |  0:03:39s
epoch 13 | loss: 0.63934 | train_auc: 0.66673 | train_balanced_accuracy: 0.59627 | train_accuracy: 0.59465 | valid_auc: 0.66113 | valid_balanced_accuracy: 0.58411 | valid_accuracy: 0.58247 |  0:03:56s
epoch 14 | loss: 0.63833 | train_auc: 0.67386 | train_balanced_accuracy: 0.60234 | train_accuracy: 0.60087 | valid_auc: 0.66888 | valid_balanced_accuracy: 0.58898 | valid_accuracy: 0.5875  |  0:04:12s
epoch 15 | loss: 0.63065 | train_auc: 0.67784 | train_balanced_accuracy: 0.60591 | train_accuracy: 0.60452 | valid_auc: 0.67269 | valid_balanced_accuracy: 0.59316 | valid_accuracy: 0.59175 |  0:04:31s
epoch 16 | loss: 0.63236 | train_auc: 0.68253 | train_balanced_accuracy: 0.61321 | train_accuracy: 0.612   | valid_auc: 0.67919 | valid_balanced_accuracy: 0.60384 | valid_accuracy: 0.60261 |  0:04:48s
epoch 17 | loss: 0.6306  | train_auc: 0.68815 | train_balanced_accuracy: 0.62599 | train_accuracy: 0.62495 | valid_auc: 0.68526 | valid_balanced_accuracy: 0.61676 | valid_accuracy: 0.61568 |  0:05:08s
epoch 18 | loss: 0.62835 | train_auc: 0.69273 | train_balanced_accuracy: 0.63707 | train_accuracy: 0.6364  | valid_auc: 0.68943 | valid_balanced_accuracy: 0.63405 | valid_accuracy: 0.6333  |  0:05:23s
epoch 19 | loss: 0.62492 | train_auc: 0.69668 | train_balanced_accuracy: 0.63835 | train_accuracy: 0.63762 | valid_auc: 0.69439 | valid_balanced_accuracy: 0.63469 | valid_accuracy: 0.63393 |  0:05:41s
epoch 20 | loss: 0.62465 | train_auc: 0.69963 | train_balanced_accuracy: 0.64297 | train_accuracy: 0.64249 | valid_auc: 0.6961  | valid_balanced_accuracy: 0.64292 | valid_accuracy: 0.64243 |  0:05:57s
epoch 21 | loss: 0.6225  | train_auc: 0.70194 | train_balanced_accuracy: 0.64497 | train_accuracy: 0.64462 | valid_auc: 0.69825 | valid_balanced_accuracy: 0.64233 | valid_accuracy: 0.64196 |  0:06:15s
epoch 22 | loss: 0.62592 | train_auc: 0.70453 | train_balanced_accuracy: 0.64364 | train_accuracy: 0.64332 | valid_auc: 0.7018  | valid_balanced_accuracy: 0.64134 | valid_accuracy: 0.64101 |  0:06:34s
epoch 23 | loss: 0.62148 | train_auc: 0.70969 | train_balanced_accuracy: 0.64677 | train_accuracy: 0.64647 | valid_auc: 0.70496 | valid_balanced_accuracy: 0.64355 | valid_accuracy: 0.64322 |  0:06:53s
epoch 24 | loss: 0.62075 | train_auc: 0.71295 | train_balanced_accuracy: 0.64855 | train_accuracy: 0.64832 | valid_auc: 0.70937 | valid_balanced_accuracy: 0.6471  | valid_accuracy: 0.64684 |  0:07:08s
epoch 25 | loss: 0.61744 | train_auc: 0.71365 | train_balanced_accuracy: 0.64951 | train_accuracy: 0.64934 | valid_auc: 0.71006 | valid_balanced_accuracy: 0.64925 | valid_accuracy: 0.64904 |  0:07:24s
epoch 26 | loss: 0.61615 | train_auc: 0.71712 | train_balanced_accuracy: 0.65251 | train_accuracy: 0.65233 | valid_auc: 0.71441 | valid_balanced_accuracy: 0.65083 | valid_accuracy: 0.65061 |  0:07:41s
epoch 27 | loss: 0.61561 | train_auc: 0.72154 | train_balanced_accuracy: 0.65576 | train_accuracy: 0.65564 | valid_auc: 0.71724 | valid_balanced_accuracy: 0.65409 | valid_accuracy: 0.65392 |  0:07:59s
epoch 28 | loss: 0.61406 | train_auc: 0.72268 | train_balanced_accuracy: 0.65502 | train_accuracy: 0.65493 | valid_auc: 0.71998 | valid_balanced_accuracy: 0.65656 | valid_accuracy: 0.65644 |  0:08:15s
epoch 29 | loss: 0.61256 | train_auc: 0.72694 | train_balanced_accuracy: 0.66176 | train_accuracy: 0.66158 | valid_auc: 0.72236 | valid_balanced_accuracy: 0.65665 | valid_accuracy: 0.65644 |  0:08:34s
epoch 30 | loss: 0.60954 | train_auc: 0.73181 | train_balanced_accuracy: 0.66867 | train_accuracy: 0.66874 | valid_auc: 0.7263  | valid_balanced_accuracy: 0.66347 | valid_accuracy: 0.66352 |  0:08:50s
epoch 31 | loss: 0.61107 | train_auc: 0.73468 | train_balanced_accuracy: 0.67244 | train_accuracy: 0.67259 | valid_auc: 0.72914 | valid_balanced_accuracy: 0.66875 | valid_accuracy: 0.66887 |  0:09:07s
epoch 32 | loss: 0.61285 | train_auc: 0.73779 | train_balanced_accuracy: 0.67737 | train_accuracy: 0.67755 | valid_auc: 0.73112 | valid_balanced_accuracy: 0.67471 | valid_accuracy: 0.67485 |  0:09:24s
epoch 33 | loss: 0.60861 | train_auc: 0.738   | train_balanced_accuracy: 0.67744 | train_accuracy: 0.67751 | valid_auc: 0.73173 | valid_balanced_accuracy: 0.67154 | valid_accuracy: 0.67155 |  0:09:41s
epoch 34 | loss: 0.60776 | train_auc: 0.73882 | train_balanced_accuracy: 0.67821 | train_accuracy: 0.67842 | valid_auc: 0.73085 | valid_balanced_accuracy: 0.67153 | valid_accuracy: 0.6717  |  0:10:00s
epoch 35 | loss: 0.60794 | train_auc: 0.74051 | train_balanced_accuracy: 0.67946 | train_accuracy: 0.67983 | valid_auc: 0.73247 | valid_balanced_accuracy: 0.67342 | valid_accuracy: 0.67375 |  0:10:18s
epoch 36 | loss: 0.60503 | train_auc: 0.73961 | train_balanced_accuracy: 0.678   | train_accuracy: 0.67826 | valid_auc: 0.73176 | valid_balanced_accuracy: 0.67086 | valid_accuracy: 0.67107 |  0:10:34s
epoch 37 | loss: 0.60283 | train_auc: 0.73769 | train_balanced_accuracy: 0.67655 | train_accuracy: 0.67696 | valid_auc: 0.7303  | valid_balanced_accuracy: 0.67557 | valid_accuracy: 0.67595 |  0:10:52s
epoch 38 | loss: 0.60461 | train_auc: 0.74469 | train_balanced_accuracy: 0.68051 | train_accuracy: 0.68066 | valid_auc: 0.73715 | valid_balanced_accuracy: 0.67634 | valid_accuracy: 0.67642 |  0:11:10s
epoch 39 | loss: 0.60319 | train_auc: 0.74196 | train_balanced_accuracy: 0.67826 | train_accuracy: 0.67854 | valid_auc: 0.73487 | valid_balanced_accuracy: 0.67256 | valid_accuracy: 0.6728  |  0:11:27s
epoch 40 | loss: 0.60492 | train_auc: 0.73636 | train_balanced_accuracy: 0.6775  | train_accuracy: 0.67779 | valid_auc: 0.73116 | valid_balanced_accuracy: 0.67238 | valid_accuracy: 0.67265 |  0:11:45s
epoch 41 | loss: 0.6049  | train_auc: 0.74074 | train_balanced_accuracy: 0.67771 | train_accuracy: 0.67802 | valid_auc: 0.73419 | valid_balanced_accuracy: 0.67155 | valid_accuracy: 0.67186 |  0:12:04s
epoch 42 | loss: 0.60013 | train_auc: 0.72975 | train_balanced_accuracy: 0.67198 | train_accuracy: 0.67236 | valid_auc: 0.72495 | valid_balanced_accuracy: 0.666   | valid_accuracy: 0.66635 |  0:12:21s
epoch 43 | loss: 0.60478 | train_auc: 0.71269 | train_balanced_accuracy: 0.65542 | train_accuracy: 0.65572 | valid_auc: 0.71086 | valid_balanced_accuracy: 0.65871 | valid_accuracy: 0.65895 |  0:12:39s
epoch 44 | loss: 0.59624 | train_auc: 0.71897 | train_balanced_accuracy: 0.66146 | train_accuracy: 0.66193 | valid_auc: 0.71559 | valid_balanced_accuracy: 0.65962 | valid_accuracy: 0.66006 |  0:12:57s
epoch 45 | loss: 0.5979  | train_auc: 0.70785 | train_balanced_accuracy: 0.6535  | train_accuracy: 0.65387 | valid_auc: 0.70835 | valid_balanced_accuracy: 0.65655 | valid_accuracy: 0.65691 |  0:13:15s
epoch 46 | loss: 0.59919 | train_auc: 0.70693 | train_balanced_accuracy: 0.65119 | train_accuracy: 0.65151 | valid_auc: 0.708   | valid_balanced_accuracy: 0.65424 | valid_accuracy: 0.65455 |  0:13:33s
epoch 47 | loss: 0.59916 | train_auc: 0.67822 | train_balanced_accuracy: 0.62744 | train_accuracy: 0.6277  | valid_auc: 0.67704 | valid_balanced_accuracy: 0.62454 | valid_accuracy: 0.6248  |  0:13:51s
epoch 48 | loss: 0.59662 | train_auc: 0.68051 | train_balanced_accuracy: 0.62578 | train_accuracy: 0.62628 | valid_auc: 0.682   | valid_balanced_accuracy: 0.63324 | valid_accuracy: 0.63377 |  0:14:07s
epoch 49 | loss: 0.59934 | train_auc: 0.67856 | train_balanced_accuracy: 0.62714 | train_accuracy: 0.62746 | valid_auc: 0.67907 | valid_balanced_accuracy: 0.62747 | valid_accuracy: 0.62779 |  0:14:25s
epoch 50 | loss: 0.59801 | train_auc: 0.69138 | train_balanced_accuracy: 0.63798 | train_accuracy: 0.63828 | valid_auc: 0.68971 | valid_balanced_accuracy: 0.63285 | valid_accuracy: 0.63314 |  0:14:45s
epoch 51 | loss: 0.59552 | train_auc: 0.71732 | train_balanced_accuracy: 0.65822 | train_accuracy: 0.65867 | valid_auc: 0.71339 | valid_balanced_accuracy: 0.65871 | valid_accuracy: 0.65911 |  0:15:01s
epoch 52 | loss: 0.59252 | train_auc: 0.70524 | train_balanced_accuracy: 0.64926 | train_accuracy: 0.64962 | valid_auc: 0.70331 | valid_balanced_accuracy: 0.64962 | valid_accuracy: 0.64998 |  0:15:19s
epoch 53 | loss: 0.5953  | train_auc: 0.73102 | train_balanced_accuracy: 0.66942 | train_accuracy: 0.66988 | valid_auc: 0.7264  | valid_balanced_accuracy: 0.66388 | valid_accuracy: 0.66431 |  0:15:37s
epoch 54 | loss: 0.59695 | train_auc: 0.72272 | train_balanced_accuracy: 0.66163 | train_accuracy: 0.66193 | valid_auc: 0.71862 | valid_balanced_accuracy: 0.65966 | valid_accuracy: 0.6599  |  0:15:55s
epoch 55 | loss: 0.59953 | train_auc: 0.73697 | train_balanced_accuracy: 0.67544 | train_accuracy: 0.6757  | valid_auc: 0.73118 | valid_balanced_accuracy: 0.67933 | valid_accuracy: 0.67957 |  0:16:12s
epoch 56 | loss: 0.59702 | train_auc: 0.75374 | train_balanced_accuracy: 0.68414 | train_accuracy: 0.68448 | valid_auc: 0.74519 | valid_balanced_accuracy: 0.68523 | valid_accuracy: 0.68555 |  0:16:31s
epoch 57 | loss: 0.59417 | train_auc: 0.75643 | train_balanced_accuracy: 0.68766 | train_accuracy: 0.68798 | valid_auc: 0.74508 | valid_balanced_accuracy: 0.68338 | valid_accuracy: 0.68366 |  0:16:49s
epoch 58 | loss: 0.59198 | train_auc: 0.75628 | train_balanced_accuracy: 0.68971 | train_accuracy: 0.68979 | valid_auc: 0.7444  | valid_balanced_accuracy: 0.68235 | valid_accuracy: 0.6824  |  0:17:08s
epoch 59 | loss: 0.59576 | train_auc: 0.75563 | train_balanced_accuracy: 0.6889  | train_accuracy: 0.68916 | valid_auc: 0.74348 | valid_balanced_accuracy: 0.68107 | valid_accuracy: 0.6813  |  0:17:26s
epoch 60 | loss: 0.59317 | train_auc: 0.74944 | train_balanced_accuracy: 0.68357 | train_accuracy: 0.68385 | valid_auc: 0.74072 | valid_balanced_accuracy: 0.67807 | valid_accuracy: 0.67831 |  0:17:44s
epoch 61 | loss: 0.59255 | train_auc: 0.72163 | train_balanced_accuracy: 0.65878 | train_accuracy: 0.65894 | valid_auc: 0.7158  | valid_balanced_accuracy: 0.65571 | valid_accuracy: 0.65581 |  0:18:00s
epoch 62 | loss: 0.59127 | train_auc: 0.73674 | train_balanced_accuracy: 0.67387 | train_accuracy: 0.67433 | valid_auc: 0.72978 | valid_balanced_accuracy: 0.67097 | valid_accuracy: 0.67139 |  0:18:16s
epoch 63 | loss: 0.59386 | train_auc: 0.75991 | train_balanced_accuracy: 0.69237 | train_accuracy: 0.69254 | valid_auc: 0.74712 | valid_balanced_accuracy: 0.68337 | valid_accuracy: 0.68351 |  0:18:33s
epoch 64 | loss: 0.5941  | train_auc: 0.69642 | train_balanced_accuracy: 0.63848 | train_accuracy: 0.63891 | valid_auc: 0.69367 | valid_balanced_accuracy: 0.63699 | valid_accuracy: 0.63739 |  0:18:51s
epoch 65 | loss: 0.59415 | train_auc: 0.65419 | train_balanced_accuracy: 0.61271 | train_accuracy: 0.6133  | valid_auc: 0.65126 | valid_balanced_accuracy: 0.61196 | valid_accuracy: 0.61253 |  0:19:10s
epoch 66 | loss: 0.59435 | train_auc: 0.65865 | train_balanced_accuracy: 0.61491 | train_accuracy: 0.61535 | valid_auc: 0.65502 | valid_balanced_accuracy: 0.61321 | valid_accuracy: 0.61363 |  0:19:27s
epoch 67 | loss: 0.58753 | train_auc: 0.71575 | train_balanced_accuracy: 0.65704 | train_accuracy: 0.65749 | valid_auc: 0.71034 | valid_balanced_accuracy: 0.65554 | valid_accuracy: 0.65596 |  0:19:44s
epoch 68 | loss: 0.59025 | train_auc: 0.7281  | train_balanced_accuracy: 0.66631 | train_accuracy: 0.66661 | valid_auc: 0.72015 | valid_balanced_accuracy: 0.65634 | valid_accuracy: 0.65659 |  0:19:59s
epoch 69 | loss: 0.59017 | train_auc: 0.72565 | train_balanced_accuracy: 0.66423 | train_accuracy: 0.66449 | valid_auc: 0.71861 | valid_balanced_accuracy: 0.65953 | valid_accuracy: 0.65974 |  0:20:17s
epoch 70 | loss: 0.59041 | train_auc: 0.74143 | train_balanced_accuracy: 0.67589 | train_accuracy: 0.67621 | valid_auc: 0.73232 | valid_balanced_accuracy: 0.67035 | valid_accuracy: 0.6706  |  0:20:33s
epoch 71 | loss: 0.59235 | train_auc: 0.736   | train_balanced_accuracy: 0.67276 | train_accuracy: 0.67299 | valid_auc: 0.72758 | valid_balanced_accuracy: 0.66037 | valid_accuracy: 0.66053 |  0:20:51s
epoch 72 | loss: 0.58619 | train_auc: 0.74867 | train_balanced_accuracy: 0.68357 | train_accuracy: 0.68377 | valid_auc: 0.73672 | valid_balanced_accuracy: 0.67186 | valid_accuracy: 0.67202 |  0:21:08s
epoch 73 | loss: 0.58866 | train_auc: 0.76379 | train_balanced_accuracy: 0.69364 | train_accuracy: 0.69392 | valid_auc: 0.74759 | valid_balanced_accuracy: 0.68278 | valid_accuracy: 0.68303 |  0:21:24s
epoch 74 | loss: 0.59029 | train_auc: 0.74735 | train_balanced_accuracy: 0.68046 | train_accuracy: 0.68082 | valid_auc: 0.73677 | valid_balanced_accuracy: 0.67062 | valid_accuracy: 0.67092 |  0:21:41s
epoch 75 | loss: 0.59051 | train_auc: 0.75901 | train_balanced_accuracy: 0.69203 | train_accuracy: 0.69219 | valid_auc: 0.74525 | valid_balanced_accuracy: 0.67865 | valid_accuracy: 0.67879 |  0:21:57s
epoch 76 | loss: 0.59159 | train_auc: 0.75699 | train_balanced_accuracy: 0.68966 | train_accuracy: 0.68987 | valid_auc: 0.74369 | valid_balanced_accuracy: 0.67846 | valid_accuracy: 0.67863 |  0:22:14s

Early stopping occurred at epoch 76 with best_epoch = 56 and best_valid_accuracy = 0.68555
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 66/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.674 total time=22.4min
[CV 3/5; 66/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82608 | train_auc: 0.52314 | train_balanced_accuracy: 0.51976 | train_accuracy: 0.51719 | valid_auc: 0.52826 | valid_balanced_accuracy: 0.51738 | valid_accuracy: 0.51479 |  0:00:19s
epoch 1  | loss: 0.73256 | train_auc: 0.51974 | train_balanced_accuracy: 0.51069 | train_accuracy: 0.50779 | valid_auc: 0.52679 | valid_balanced_accuracy: 0.51348 | valid_accuracy: 0.51054 |  0:00:36s
epoch 2  | loss: 0.7049  | train_auc: 0.52154 | train_balanced_accuracy: 0.50766 | train_accuracy: 0.50452 | valid_auc: 0.52886 | valid_balanced_accuracy: 0.51011 | valid_accuracy: 0.50692 |  0:00:54s
epoch 3  | loss: 0.69254 | train_auc: 0.54118 | train_balanced_accuracy: 0.51071 | train_accuracy: 0.50751 | valid_auc: 0.54759 | valid_balanced_accuracy: 0.51172 | valid_accuracy: 0.5085  |  0:01:11s
epoch 4  | loss: 0.68138 | train_auc: 0.55907 | train_balanced_accuracy: 0.51816 | train_accuracy: 0.51503 | valid_auc: 0.56123 | valid_balanced_accuracy: 0.5225  | valid_accuracy: 0.51936 |  0:01:26s
epoch 5  | loss: 0.67325 | train_auc: 0.57564 | train_balanced_accuracy: 0.52483 | train_accuracy: 0.52176 | valid_auc: 0.57417 | valid_balanced_accuracy: 0.52606 | valid_accuracy: 0.52298 |  0:01:44s
epoch 6  | loss: 0.66711 | train_auc: 0.59565 | train_balanced_accuracy: 0.5353  | train_accuracy: 0.53246 | valid_auc: 0.58988 | valid_balanced_accuracy: 0.53952 | valid_accuracy: 0.53667 |  0:02:01s
epoch 7  | loss: 0.66393 | train_auc: 0.60742 | train_balanced_accuracy: 0.54082 | train_accuracy: 0.53801 | valid_auc: 0.60079 | valid_balanced_accuracy: 0.54155 | valid_accuracy: 0.53872 |  0:02:19s
epoch 8  | loss: 0.65923 | train_auc: 0.61796 | train_balanced_accuracy: 0.54967 | train_accuracy: 0.5471  | valid_auc: 0.61129 | valid_balanced_accuracy: 0.54952 | valid_accuracy: 0.5469  |  0:02:34s
epoch 9  | loss: 0.65513 | train_auc: 0.62487 | train_balanced_accuracy: 0.56059 | train_accuracy: 0.55819 | valid_auc: 0.61734 | valid_balanced_accuracy: 0.55675 | valid_accuracy: 0.5543  |  0:02:53s
epoch 10 | loss: 0.64688 | train_auc: 0.63446 | train_balanced_accuracy: 0.57323 | train_accuracy: 0.57106 | valid_auc: 0.62555 | valid_balanced_accuracy: 0.5667  | valid_accuracy: 0.56453 |  0:03:10s
epoch 11 | loss: 0.64884 | train_auc: 0.64392 | train_balanced_accuracy: 0.58208 | train_accuracy: 0.58015 | valid_auc: 0.63361 | valid_balanced_accuracy: 0.57574 | valid_accuracy: 0.57381 |  0:03:27s
epoch 12 | loss: 0.64445 | train_auc: 0.65139 | train_balanced_accuracy: 0.59033 | train_accuracy: 0.58861 | valid_auc: 0.64249 | valid_balanced_accuracy: 0.58527 | valid_accuracy: 0.58357 |  0:03:46s
epoch 13 | loss: 0.6421  | train_auc: 0.66493 | train_balanced_accuracy: 0.59416 | train_accuracy: 0.59246 | valid_auc: 0.6553  | valid_balanced_accuracy: 0.59216 | valid_accuracy: 0.59049 |  0:04:03s
epoch 14 | loss: 0.63829 | train_auc: 0.67442 | train_balanced_accuracy: 0.6039  | train_accuracy: 0.60242 | valid_auc: 0.66384 | valid_balanced_accuracy: 0.6006  | valid_accuracy: 0.59915 |  0:04:20s
epoch 15 | loss: 0.63737 | train_auc: 0.68314 | train_balanced_accuracy: 0.60571 | train_accuracy: 0.60419 | valid_auc: 0.67271 | valid_balanced_accuracy: 0.60036 | valid_accuracy: 0.59884 |  0:04:37s
epoch 16 | loss: 0.63352 | train_auc: 0.68761 | train_balanced_accuracy: 0.61493 | train_accuracy: 0.61367 | valid_auc: 0.6787  | valid_balanced_accuracy: 0.60812 | valid_accuracy: 0.60686 |  0:04:55s
epoch 17 | loss: 0.63113 | train_auc: 0.69084 | train_balanced_accuracy: 0.62257 | train_accuracy: 0.62146 | valid_auc: 0.68327 | valid_balanced_accuracy: 0.61678 | valid_accuracy: 0.61568 |  0:05:13s
epoch 18 | loss: 0.6336  | train_auc: 0.69574 | train_balanced_accuracy: 0.6325  | train_accuracy: 0.63165 | valid_auc: 0.68765 | valid_balanced_accuracy: 0.62483 | valid_accuracy: 0.62402 |  0:05:30s
epoch 19 | loss: 0.63027 | train_auc: 0.69806 | train_balanced_accuracy: 0.63645 | train_accuracy: 0.63562 | valid_auc: 0.68948 | valid_balanced_accuracy: 0.62797 | valid_accuracy: 0.62716 |  0:05:48s
epoch 20 | loss: 0.63095 | train_auc: 0.70227 | train_balanced_accuracy: 0.6403  | train_accuracy: 0.6396  | valid_auc: 0.69312 | valid_balanced_accuracy: 0.63021 | valid_accuracy: 0.62952 |  0:06:05s
epoch 21 | loss: 0.62428 | train_auc: 0.70623 | train_balanced_accuracy: 0.64341 | train_accuracy: 0.64282 | valid_auc: 0.69425 | valid_balanced_accuracy: 0.63421 | valid_accuracy: 0.63362 |  0:06:22s
epoch 22 | loss: 0.62612 | train_auc: 0.70942 | train_balanced_accuracy: 0.65057 | train_accuracy: 0.65034 | valid_auc: 0.69808 | valid_balanced_accuracy: 0.64628 | valid_accuracy: 0.64605 |  0:06:41s
epoch 23 | loss: 0.6235  | train_auc: 0.71202 | train_balanced_accuracy: 0.65146 | train_accuracy: 0.65109 | valid_auc: 0.69826 | valid_balanced_accuracy: 0.64325 | valid_accuracy: 0.6429  |  0:07:02s
epoch 24 | loss: 0.62631 | train_auc: 0.71261 | train_balanced_accuracy: 0.65188 | train_accuracy: 0.6516  | valid_auc: 0.70041 | valid_balanced_accuracy: 0.64521 | valid_accuracy: 0.64495 |  0:07:19s
epoch 25 | loss: 0.62178 | train_auc: 0.71661 | train_balanced_accuracy: 0.65835 | train_accuracy: 0.65825 | valid_auc: 0.70275 | valid_balanced_accuracy: 0.6501  | valid_accuracy: 0.64998 |  0:07:37s
epoch 26 | loss: 0.62026 | train_auc: 0.71857 | train_balanced_accuracy: 0.66031 | train_accuracy: 0.66033 | valid_auc: 0.70353 | valid_balanced_accuracy: 0.65202 | valid_accuracy: 0.65203 |  0:07:55s
epoch 27 | loss: 0.6215  | train_auc: 0.71983 | train_balanced_accuracy: 0.66245 | train_accuracy: 0.66246 | valid_auc: 0.70517 | valid_balanced_accuracy: 0.65408 | valid_accuracy: 0.65408 |  0:08:12s
epoch 28 | loss: 0.61813 | train_auc: 0.72229 | train_balanced_accuracy: 0.66298 | train_accuracy: 0.66301 | valid_auc: 0.70584 | valid_balanced_accuracy: 0.6528  | valid_accuracy: 0.65282 |  0:08:29s
epoch 29 | loss: 0.62056 | train_auc: 0.72438 | train_balanced_accuracy: 0.66634 | train_accuracy: 0.66647 | valid_auc: 0.7097  | valid_balanced_accuracy: 0.65728 | valid_accuracy: 0.65738 |  0:08:47s
epoch 30 | loss: 0.61501 | train_auc: 0.72667 | train_balanced_accuracy: 0.66843 | train_accuracy: 0.66859 | valid_auc: 0.71206 | valid_balanced_accuracy: 0.6607  | valid_accuracy: 0.66084 |  0:09:05s
epoch 31 | loss: 0.61848 | train_auc: 0.72823 | train_balanced_accuracy: 0.66913 | train_accuracy: 0.6693  | valid_auc: 0.71484 | valid_balanced_accuracy: 0.66166 | valid_accuracy: 0.66179 |  0:09:21s
epoch 32 | loss: 0.61269 | train_auc: 0.73016 | train_balanced_accuracy: 0.67131 | train_accuracy: 0.67155 | valid_auc: 0.71531 | valid_balanced_accuracy: 0.65795 | valid_accuracy: 0.65817 |  0:09:39s
epoch 33 | loss: 0.61933 | train_auc: 0.7316  | train_balanced_accuracy: 0.67203 | train_accuracy: 0.67229 | valid_auc: 0.71627 | valid_balanced_accuracy: 0.65949 | valid_accuracy: 0.65974 |  0:09:59s
epoch 34 | loss: 0.61455 | train_auc: 0.73448 | train_balanced_accuracy: 0.67329 | train_accuracy: 0.67347 | valid_auc: 0.71838 | valid_balanced_accuracy: 0.661   | valid_accuracy: 0.66116 |  0:10:17s
epoch 35 | loss: 0.60793 | train_auc: 0.73606 | train_balanced_accuracy: 0.67666 | train_accuracy: 0.67698 | valid_auc: 0.71861 | valid_balanced_accuracy: 0.65803 | valid_accuracy: 0.65833 |  0:10:35s
epoch 36 | loss: 0.6128  | train_auc: 0.73658 | train_balanced_accuracy: 0.67715 | train_accuracy: 0.67745 | valid_auc: 0.71899 | valid_balanced_accuracy: 0.66103 | valid_accuracy: 0.66132 |  0:10:52s
epoch 37 | loss: 0.61189 | train_auc: 0.73545 | train_balanced_accuracy: 0.67456 | train_accuracy: 0.67493 | valid_auc: 0.71808 | valid_balanced_accuracy: 0.65938 | valid_accuracy: 0.65974 |  0:11:09s
epoch 38 | loss: 0.60976 | train_auc: 0.73856 | train_balanced_accuracy: 0.67622 | train_accuracy: 0.67635 | valid_auc: 0.72017 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.66305 |  0:11:27s
epoch 39 | loss: 0.60362 | train_auc: 0.7392  | train_balanced_accuracy: 0.67709 | train_accuracy: 0.67725 | valid_auc: 0.72146 | valid_balanced_accuracy: 0.66432 | valid_accuracy: 0.66446 |  0:11:44s
epoch 40 | loss: 0.60859 | train_auc: 0.73114 | train_balanced_accuracy: 0.6683  | train_accuracy: 0.66824 | valid_auc: 0.72003 | valid_balanced_accuracy: 0.66769 | valid_accuracy: 0.66761 |  0:12:02s
epoch 41 | loss: 0.60798 | train_auc: 0.74009 | train_balanced_accuracy: 0.67758 | train_accuracy: 0.67776 | valid_auc: 0.72436 | valid_balanced_accuracy: 0.66664 | valid_accuracy: 0.66682 |  0:12:18s
epoch 42 | loss: 0.60297 | train_auc: 0.7426  | train_balanced_accuracy: 0.6803  | train_accuracy: 0.68052 | valid_auc: 0.72312 | valid_balanced_accuracy: 0.66598 | valid_accuracy: 0.66619 |  0:12:35s
epoch 43 | loss: 0.60693 | train_auc: 0.74402 | train_balanced_accuracy: 0.68062 | train_accuracy: 0.68075 | valid_auc: 0.72426 | valid_balanced_accuracy: 0.66337 | valid_accuracy: 0.66352 |  0:12:54s
epoch 44 | loss: 0.60849 | train_auc: 0.74525 | train_balanced_accuracy: 0.68203 | train_accuracy: 0.68209 | valid_auc: 0.72357 | valid_balanced_accuracy: 0.66531 | valid_accuracy: 0.66541 |  0:13:10s
epoch 45 | loss: 0.60274 | train_auc: 0.74464 | train_balanced_accuracy: 0.68099 | train_accuracy: 0.68126 | valid_auc: 0.7257  | valid_balanced_accuracy: 0.66576 | valid_accuracy: 0.66604 |  0:13:28s
epoch 46 | loss: 0.60825 | train_auc: 0.7474  | train_balanced_accuracy: 0.68317 | train_accuracy: 0.68343 | valid_auc: 0.72493 | valid_balanced_accuracy: 0.66169 | valid_accuracy: 0.66195 |  0:13:47s
epoch 47 | loss: 0.60366 | train_auc: 0.7461  | train_balanced_accuracy: 0.6825  | train_accuracy: 0.6826  | valid_auc: 0.72547 | valid_balanced_accuracy: 0.66892 | valid_accuracy: 0.66903 |  0:14:03s
epoch 48 | loss: 0.60505 | train_auc: 0.74729 | train_balanced_accuracy: 0.68464 | train_accuracy: 0.68488 | valid_auc: 0.72598 | valid_balanced_accuracy: 0.6713  | valid_accuracy: 0.67155 |  0:14:22s
epoch 49 | loss: 0.59967 | train_auc: 0.74641 | train_balanced_accuracy: 0.6826  | train_accuracy: 0.68276 | valid_auc: 0.7264  | valid_balanced_accuracy: 0.67014 | valid_accuracy: 0.67029 |  0:14:40s
epoch 50 | loss: 0.60316 | train_auc: 0.73619 | train_balanced_accuracy: 0.67139 | train_accuracy: 0.67135 | valid_auc: 0.72226 | valid_balanced_accuracy: 0.66702 | valid_accuracy: 0.66698 |  0:14:59s
epoch 51 | loss: 0.59876 | train_auc: 0.71692 | train_balanced_accuracy: 0.65715 | train_accuracy: 0.65715 | valid_auc: 0.71245 | valid_balanced_accuracy: 0.65658 | valid_accuracy: 0.65659 |  0:15:16s
epoch 52 | loss: 0.59511 | train_auc: 0.71644 | train_balanced_accuracy: 0.6563  | train_accuracy: 0.65628 | valid_auc: 0.71233 | valid_balanced_accuracy: 0.65662 | valid_accuracy: 0.65659 |  0:15:34s
epoch 53 | loss: 0.59734 | train_auc: 0.68971 | train_balanced_accuracy: 0.63708 | train_accuracy: 0.63735 | valid_auc: 0.6898  | valid_balanced_accuracy: 0.6415  | valid_accuracy: 0.6418  |  0:15:53s
epoch 54 | loss: 0.60055 | train_auc: 0.67435 | train_balanced_accuracy: 0.62886 | train_accuracy: 0.6289  | valid_auc: 0.67539 | valid_balanced_accuracy: 0.62983 | valid_accuracy: 0.62984 |  0:16:11s
epoch 55 | loss: 0.5984  | train_auc: 0.66972 | train_balanced_accuracy: 0.6266  | train_accuracy: 0.62677 | valid_auc: 0.66749 | valid_balanced_accuracy: 0.62667 | valid_accuracy: 0.62685 |  0:16:28s
epoch 56 | loss: 0.59877 | train_auc: 0.65465 | train_balanced_accuracy: 0.60958 | train_accuracy: 0.60977 | valid_auc: 0.65003 | valid_balanced_accuracy: 0.60671 | valid_accuracy: 0.60686 |  0:16:45s
epoch 57 | loss: 0.60076 | train_auc: 0.65925 | train_balanced_accuracy: 0.6156  | train_accuracy: 0.61568 | valid_auc: 0.65617 | valid_balanced_accuracy: 0.61122 | valid_accuracy: 0.61127 |  0:17:03s
epoch 58 | loss: 0.6004  | train_auc: 0.68462 | train_balanced_accuracy: 0.6351  | train_accuracy: 0.63503 | valid_auc: 0.68657 | valid_balanced_accuracy: 0.63576 | valid_accuracy: 0.63566 |  0:17:21s
epoch 59 | loss: 0.59678 | train_auc: 0.7185  | train_balanced_accuracy: 0.65802 | train_accuracy: 0.65793 | valid_auc: 0.71235 | valid_balanced_accuracy: 0.65791 | valid_accuracy: 0.65785 |  0:17:39s
epoch 60 | loss: 0.59714 | train_auc: 0.7527  | train_balanced_accuracy: 0.68729 | train_accuracy: 0.6874  | valid_auc: 0.73497 | valid_balanced_accuracy: 0.67538 | valid_accuracy: 0.67548 |  0:17:56s
epoch 61 | loss: 0.59774 | train_auc: 0.75062 | train_balanced_accuracy: 0.68719 | train_accuracy: 0.68728 | valid_auc: 0.73543 | valid_balanced_accuracy: 0.67727 | valid_accuracy: 0.67737 |  0:18:13s
epoch 62 | loss: 0.59309 | train_auc: 0.74959 | train_balanced_accuracy: 0.68581 | train_accuracy: 0.6861  | valid_auc: 0.73339 | valid_balanced_accuracy: 0.67251 | valid_accuracy: 0.6728  |  0:18:29s
epoch 63 | loss: 0.59445 | train_auc: 0.73147 | train_balanced_accuracy: 0.67466 | train_accuracy: 0.67481 | valid_auc: 0.72222 | valid_balanced_accuracy: 0.66702 | valid_accuracy: 0.66714 |  0:18:47s
epoch 64 | loss: 0.59014 | train_auc: 0.73813 | train_balanced_accuracy: 0.67863 | train_accuracy: 0.67879 | valid_auc: 0.72519 | valid_balanced_accuracy: 0.66479 | valid_accuracy: 0.66494 |  0:19:06s
epoch 65 | loss: 0.59056 | train_auc: 0.75578 | train_balanced_accuracy: 0.69199 | train_accuracy: 0.69212 | valid_auc: 0.73633 | valid_balanced_accuracy: 0.67975 | valid_accuracy: 0.67989 |  0:19:22s
epoch 66 | loss: 0.59491 | train_auc: 0.75987 | train_balanced_accuracy: 0.69294 | train_accuracy: 0.69311 | valid_auc: 0.73543 | valid_balanced_accuracy: 0.67813 | valid_accuracy: 0.67831 |  0:19:40s
epoch 67 | loss: 0.59014 | train_auc: 0.75103 | train_balanced_accuracy: 0.68448 | train_accuracy: 0.68484 | valid_auc: 0.73004 | valid_balanced_accuracy: 0.67418 | valid_accuracy: 0.67454 |  0:19:58s
epoch 68 | loss: 0.59425 | train_auc: 0.75678 | train_balanced_accuracy: 0.69153 | train_accuracy: 0.69169 | valid_auc: 0.73773 | valid_balanced_accuracy: 0.67736 | valid_accuracy: 0.67753 |  0:20:14s
epoch 69 | loss: 0.59369 | train_auc: 0.75299 | train_balanced_accuracy: 0.68881 | train_accuracy: 0.68905 | valid_auc: 0.73456 | valid_balanced_accuracy: 0.67382 | valid_accuracy: 0.67406 |  0:20:32s
epoch 70 | loss: 0.59208 | train_auc: 0.75296 | train_balanced_accuracy: 0.68646 | train_accuracy: 0.68673 | valid_auc: 0.73517 | valid_balanced_accuracy: 0.67411 | valid_accuracy: 0.67438 |  0:20:50s
epoch 71 | loss: 0.59425 | train_auc: 0.76005 | train_balanced_accuracy: 0.69173 | train_accuracy: 0.69197 | valid_auc: 0.73722 | valid_balanced_accuracy: 0.67524 | valid_accuracy: 0.67548 |  0:21:09s
epoch 72 | loss: 0.5937  | train_auc: 0.75879 | train_balanced_accuracy: 0.6918  | train_accuracy: 0.69189 | valid_auc: 0.73718 | valid_balanced_accuracy: 0.67318 | valid_accuracy: 0.67328 |  0:21:26s
epoch 73 | loss: 0.58696 | train_auc: 0.76043 | train_balanced_accuracy: 0.69219 | train_accuracy: 0.69256 | valid_auc: 0.7355  | valid_balanced_accuracy: 0.67387 | valid_accuracy: 0.67422 |  0:21:44s
epoch 74 | loss: 0.59204 | train_auc: 0.75847 | train_balanced_accuracy: 0.69229 | train_accuracy: 0.69252 | valid_auc: 0.73556 | valid_balanced_accuracy: 0.67591 | valid_accuracy: 0.67611 |  0:22:01s
epoch 75 | loss: 0.59364 | train_auc: 0.75914 | train_balanced_accuracy: 0.69201 | train_accuracy: 0.69208 | valid_auc: 0.73535 | valid_balanced_accuracy: 0.67653 | valid_accuracy: 0.67658 |  0:22:17s
epoch 76 | loss: 0.59268 | train_auc: 0.75938 | train_balanced_accuracy: 0.69284 | train_accuracy: 0.69307 | valid_auc: 0.73544 | valid_balanced_accuracy: 0.67669 | valid_accuracy: 0.6769  |  0:22:36s
epoch 77 | loss: 0.58778 | train_auc: 0.75976 | train_balanced_accuracy: 0.69215 | train_accuracy: 0.69244 | valid_auc: 0.73481 | valid_balanced_accuracy: 0.67222 | valid_accuracy: 0.67249 |  0:22:53s
epoch 78 | loss: 0.58511 | train_auc: 0.74823 | train_balanced_accuracy: 0.68322 | train_accuracy: 0.68339 | valid_auc: 0.73037 | valid_balanced_accuracy: 0.67404 | valid_accuracy: 0.67422 |  0:23:10s
epoch 79 | loss: 0.58511 | train_auc: 0.74965 | train_balanced_accuracy: 0.6839  | train_accuracy: 0.68421 | valid_auc: 0.7307  | valid_balanced_accuracy: 0.67326 | valid_accuracy: 0.67359 |  0:23:27s
epoch 80 | loss: 0.59156 | train_auc: 0.71042 | train_balanced_accuracy: 0.65135 | train_accuracy: 0.6514  | valid_auc: 0.7059  | valid_balanced_accuracy: 0.6531  | valid_accuracy: 0.65313 |  0:23:44s
epoch 81 | loss: 0.59176 | train_auc: 0.69193 | train_balanced_accuracy: 0.64135 | train_accuracy: 0.64145 | valid_auc: 0.68961 | valid_balanced_accuracy: 0.63576 | valid_accuracy: 0.63582 |  0:24:01s
epoch 82 | loss: 0.58707 | train_auc: 0.7147  | train_balanced_accuracy: 0.65374 | train_accuracy: 0.65372 | valid_auc: 0.70737 | valid_balanced_accuracy: 0.64936 | valid_accuracy: 0.64935 |  0:24:16s
epoch 83 | loss: 0.58941 | train_auc: 0.74    | train_balanced_accuracy: 0.6743  | train_accuracy: 0.67454 | valid_auc: 0.72664 | valid_balanced_accuracy: 0.67021 | valid_accuracy: 0.67044 |  0:24:34s
epoch 84 | loss: 0.59407 | train_auc: 0.71751 | train_balanced_accuracy: 0.65784 | train_accuracy: 0.65781 | valid_auc: 0.71053 | valid_balanced_accuracy: 0.65787 | valid_accuracy: 0.65785 |  0:24:51s
epoch 85 | loss: 0.59133 | train_auc: 0.70566 | train_balanced_accuracy: 0.65021 | train_accuracy: 0.6503  | valid_auc: 0.70034 | valid_balanced_accuracy: 0.6485  | valid_accuracy: 0.64857 |  0:25:08s

Early stopping occurred at epoch 85 with best_epoch = 65 and best_valid_accuracy = 0.67989
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 66/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.684 total time=25.3min
[CV 4/5; 66/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82984 | train_auc: 0.51843 | train_balanced_accuracy: 0.51891 | train_accuracy: 0.51645 | valid_auc: 0.51799 | valid_balanced_accuracy: 0.5143  | valid_accuracy: 0.5118  |  0:00:16s
epoch 1  | loss: 0.73833 | train_auc: 0.52404 | train_balanced_accuracy: 0.51306 | train_accuracy: 0.51035 | valid_auc: 0.52466 | valid_balanced_accuracy: 0.51203 | valid_accuracy: 0.50929 |  0:00:33s
epoch 2  | loss: 0.70154 | train_auc: 0.53302 | train_balanced_accuracy: 0.51452 | train_accuracy: 0.51165 | valid_auc: 0.53539 | valid_balanced_accuracy: 0.51221 | valid_accuracy: 0.50929 |  0:00:49s
epoch 3  | loss: 0.69317 | train_auc: 0.55091 | train_balanced_accuracy: 0.51729 | train_accuracy: 0.51436 | valid_auc: 0.5525  | valid_balanced_accuracy: 0.51632 | valid_accuracy: 0.51338 |  0:01:07s
epoch 4  | loss: 0.68245 | train_auc: 0.56399 | train_balanced_accuracy: 0.5262  | train_accuracy: 0.52345 | valid_auc: 0.56662 | valid_balanced_accuracy: 0.52586 | valid_accuracy: 0.52314 |  0:01:25s
epoch 5  | loss: 0.67545 | train_auc: 0.58329 | train_balanced_accuracy: 0.5343  | train_accuracy: 0.53167 | valid_auc: 0.58107 | valid_balanced_accuracy: 0.53506 | valid_accuracy: 0.53242 |  0:01:42s
epoch 6  | loss: 0.66675 | train_auc: 0.60112 | train_balanced_accuracy: 0.54482 | train_accuracy: 0.54237 | valid_auc: 0.59396 | valid_balanced_accuracy: 0.54071 | valid_accuracy: 0.53824 |  0:01:59s
epoch 7  | loss: 0.66377 | train_auc: 0.61168 | train_balanced_accuracy: 0.54893 | train_accuracy: 0.54639 | valid_auc: 0.60231 | valid_balanced_accuracy: 0.5438  | valid_accuracy: 0.54123 |  0:02:15s
epoch 8  | loss: 0.65849 | train_auc: 0.62166 | train_balanced_accuracy: 0.56265 | train_accuracy: 0.56036 | valid_auc: 0.61093 | valid_balanced_accuracy: 0.55504 | valid_accuracy: 0.55272 |  0:02:33s
epoch 9  | loss: 0.6533  | train_auc: 0.63187 | train_balanced_accuracy: 0.56898 | train_accuracy: 0.56673 | valid_auc: 0.61991 | valid_balanced_accuracy: 0.56252 | valid_accuracy: 0.56028 |  0:02:52s
epoch 10 | loss: 0.64766 | train_auc: 0.64233 | train_balanced_accuracy: 0.58198 | train_accuracy: 0.58011 | valid_auc: 0.62915 | valid_balanced_accuracy: 0.56951 | valid_accuracy: 0.56767 |  0:03:07s
epoch 11 | loss: 0.64922 | train_auc: 0.65103 | train_balanced_accuracy: 0.58961 | train_accuracy: 0.5879  | valid_auc: 0.63649 | valid_balanced_accuracy: 0.57521 | valid_accuracy: 0.5735  |  0:03:23s
epoch 12 | loss: 0.64031 | train_auc: 0.66427 | train_balanced_accuracy: 0.59955 | train_accuracy: 0.59809 | valid_auc: 0.64925 | valid_balanced_accuracy: 0.58236 | valid_accuracy: 0.58089 |  0:03:41s
epoch 13 | loss: 0.64042 | train_auc: 0.66995 | train_balanced_accuracy: 0.60221 | train_accuracy: 0.60068 | valid_auc: 0.6555  | valid_balanced_accuracy: 0.58683 | valid_accuracy: 0.5853  |  0:04:00s
epoch 14 | loss: 0.63736 | train_auc: 0.6761  | train_balanced_accuracy: 0.61108 | train_accuracy: 0.60997 | valid_auc: 0.6608  | valid_balanced_accuracy: 0.59601 | valid_accuracy: 0.5949  |  0:04:18s
epoch 15 | loss: 0.63995 | train_auc: 0.68316 | train_balanced_accuracy: 0.6141  | train_accuracy: 0.61288 | valid_auc: 0.66757 | valid_balanced_accuracy: 0.59926 | valid_accuracy: 0.59805 |  0:04:35s
epoch 16 | loss: 0.63162 | train_auc: 0.68784 | train_balanced_accuracy: 0.62149 | train_accuracy: 0.62044 | valid_auc: 0.67197 | valid_balanced_accuracy: 0.60745 | valid_accuracy: 0.60639 |  0:04:53s
epoch 17 | loss: 0.6257  | train_auc: 0.6901  | train_balanced_accuracy: 0.62693 | train_accuracy: 0.62602 | valid_auc: 0.675   | valid_balanced_accuracy: 0.61325 | valid_accuracy: 0.61237 |  0:05:12s
epoch 18 | loss: 0.63454 | train_auc: 0.69644 | train_balanced_accuracy: 0.63581 | train_accuracy: 0.63511 | valid_auc: 0.68242 | valid_balanced_accuracy: 0.6225  | valid_accuracy: 0.62181 |  0:05:29s
epoch 19 | loss: 0.62411 | train_auc: 0.70095 | train_balanced_accuracy: 0.64052 | train_accuracy: 0.63999 | valid_auc: 0.6871  | valid_balanced_accuracy: 0.63051 | valid_accuracy: 0.63    |  0:05:45s
epoch 20 | loss: 0.62452 | train_auc: 0.70461 | train_balanced_accuracy: 0.64372 | train_accuracy: 0.6433  | valid_auc: 0.69136 | valid_balanced_accuracy: 0.63448 | valid_accuracy: 0.63409 |  0:06:01s
epoch 21 | loss: 0.62295 | train_auc: 0.7062  | train_balanced_accuracy: 0.64352 | train_accuracy: 0.64314 | valid_auc: 0.69299 | valid_balanced_accuracy: 0.63775 | valid_accuracy: 0.63739 |  0:06:18s
epoch 22 | loss: 0.62486 | train_auc: 0.7108  | train_balanced_accuracy: 0.65158 | train_accuracy: 0.65152 | valid_auc: 0.69674 | valid_balanced_accuracy: 0.64484 | valid_accuracy: 0.64479 |  0:06:36s
epoch 23 | loss: 0.62014 | train_auc: 0.71352 | train_balanced_accuracy: 0.65304 | train_accuracy: 0.65278 | valid_auc: 0.69844 | valid_balanced_accuracy: 0.64174 | valid_accuracy: 0.64149 |  0:06:51s
epoch 24 | loss: 0.62098 | train_auc: 0.71456 | train_balanced_accuracy: 0.65497 | train_accuracy: 0.65478 | valid_auc: 0.70009 | valid_balanced_accuracy: 0.64356 | valid_accuracy: 0.64337 |  0:07:10s
epoch 25 | loss: 0.61624 | train_auc: 0.71709 | train_balanced_accuracy: 0.65742 | train_accuracy: 0.65738 | valid_auc: 0.70155 | valid_balanced_accuracy: 0.64752 | valid_accuracy: 0.64747 |  0:07:26s
epoch 26 | loss: 0.61484 | train_auc: 0.71973 | train_balanced_accuracy: 0.66097 | train_accuracy: 0.66096 | valid_auc: 0.70425 | valid_balanced_accuracy: 0.64732 | valid_accuracy: 0.64731 |  0:07:42s
epoch 27 | loss: 0.61683 | train_auc: 0.72138 | train_balanced_accuracy: 0.66206 | train_accuracy: 0.66206 | valid_auc: 0.70542 | valid_balanced_accuracy: 0.64951 | valid_accuracy: 0.64951 |  0:07:58s
epoch 28 | loss: 0.61428 | train_auc: 0.72592 | train_balanced_accuracy: 0.66504 | train_accuracy: 0.66505 | valid_auc: 0.71022 | valid_balanced_accuracy: 0.65219 | valid_accuracy: 0.65219 |  0:08:15s
epoch 29 | loss: 0.61266 | train_auc: 0.72619 | train_balanced_accuracy: 0.66594 | train_accuracy: 0.66608 | valid_auc: 0.71109 | valid_balanced_accuracy: 0.65427 | valid_accuracy: 0.65439 |  0:08:35s
epoch 30 | loss: 0.60741 | train_auc: 0.73286 | train_balanced_accuracy: 0.67146 | train_accuracy: 0.67174 | valid_auc: 0.71765 | valid_balanced_accuracy: 0.66198 | valid_accuracy: 0.66226 |  0:08:52s
epoch 31 | loss: 0.60942 | train_auc: 0.73414 | train_balanced_accuracy: 0.67319 | train_accuracy: 0.67355 | valid_auc: 0.71785 | valid_balanced_accuracy: 0.66456 | valid_accuracy: 0.66494 |  0:09:10s
epoch 32 | loss: 0.60606 | train_auc: 0.73169 | train_balanced_accuracy: 0.67034 | train_accuracy: 0.67076 | valid_auc: 0.7184  | valid_balanced_accuracy: 0.66215 | valid_accuracy: 0.66257 |  0:09:26s
epoch 33 | loss: 0.6104  | train_auc: 0.72903 | train_balanced_accuracy: 0.66752 | train_accuracy: 0.66797 | valid_auc: 0.71643 | valid_balanced_accuracy: 0.65915 | valid_accuracy: 0.65958 |  0:09:43s
epoch 34 | loss: 0.60764 | train_auc: 0.74066 | train_balanced_accuracy: 0.67577 | train_accuracy: 0.67615 | valid_auc: 0.7242  | valid_balanced_accuracy: 0.66735 | valid_accuracy: 0.66777 |  0:10:00s
epoch 35 | loss: 0.60299 | train_auc: 0.74172 | train_balanced_accuracy: 0.67743 | train_accuracy: 0.6778  | valid_auc: 0.7246  | valid_balanced_accuracy: 0.66925 | valid_accuracy: 0.66966 |  0:10:17s
epoch 36 | loss: 0.60391 | train_auc: 0.74321 | train_balanced_accuracy: 0.67926 | train_accuracy: 0.67953 | valid_auc: 0.72506 | valid_balanced_accuracy: 0.67139 | valid_accuracy: 0.6717  |  0:10:34s
epoch 37 | loss: 0.6019  | train_auc: 0.74176 | train_balanced_accuracy: 0.67899 | train_accuracy: 0.67922 | valid_auc: 0.72436 | valid_balanced_accuracy: 0.6667  | valid_accuracy: 0.66698 |  0:10:52s
epoch 38 | loss: 0.60401 | train_auc: 0.7455  | train_balanced_accuracy: 0.68151 | train_accuracy: 0.68174 | valid_auc: 0.72665 | valid_balanced_accuracy: 0.67065 | valid_accuracy: 0.67092 |  0:11:09s
epoch 39 | loss: 0.60246 | train_auc: 0.74583 | train_balanced_accuracy: 0.68161 | train_accuracy: 0.68178 | valid_auc: 0.72806 | valid_balanced_accuracy: 0.66882 | valid_accuracy: 0.66903 |  0:11:27s
epoch 40 | loss: 0.60016 | train_auc: 0.74475 | train_balanced_accuracy: 0.68106 | train_accuracy: 0.68126 | valid_auc: 0.72744 | valid_balanced_accuracy: 0.67133 | valid_accuracy: 0.67155 |  0:11:46s
epoch 41 | loss: 0.60328 | train_auc: 0.74028 | train_balanced_accuracy: 0.67874 | train_accuracy: 0.67906 | valid_auc: 0.72258 | valid_balanced_accuracy: 0.66443 | valid_accuracy: 0.66478 |  0:12:02s
epoch 42 | loss: 0.5995  | train_auc: 0.73959 | train_balanced_accuracy: 0.67871 | train_accuracy: 0.6789  | valid_auc: 0.7227  | valid_balanced_accuracy: 0.66252 | valid_accuracy: 0.66273 |  0:12:20s
epoch 43 | loss: 0.60088 | train_auc: 0.74505 | train_balanced_accuracy: 0.68171 | train_accuracy: 0.68189 | valid_auc: 0.72781 | valid_balanced_accuracy: 0.66881 | valid_accuracy: 0.66903 |  0:12:37s
epoch 44 | loss: 0.60146 | train_auc: 0.74456 | train_balanced_accuracy: 0.68118 | train_accuracy: 0.6813  | valid_auc: 0.72749 | valid_balanced_accuracy: 0.66524 | valid_accuracy: 0.66541 |  0:12:53s
epoch 45 | loss: 0.59744 | train_auc: 0.73899 | train_balanced_accuracy: 0.67591 | train_accuracy: 0.67623 | valid_auc: 0.72241 | valid_balanced_accuracy: 0.66442 | valid_accuracy: 0.66478 |  0:13:09s
epoch 46 | loss: 0.60424 | train_auc: 0.74148 | train_balanced_accuracy: 0.67908 | train_accuracy: 0.67934 | valid_auc: 0.72413 | valid_balanced_accuracy: 0.66334 | valid_accuracy: 0.66368 |  0:13:25s
epoch 47 | loss: 0.59656 | train_auc: 0.73325 | train_balanced_accuracy: 0.67211 | train_accuracy: 0.67229 | valid_auc: 0.72136 | valid_balanced_accuracy: 0.66327 | valid_accuracy: 0.66352 |  0:13:42s
epoch 48 | loss: 0.5992  | train_auc: 0.74298 | train_balanced_accuracy: 0.67935 | train_accuracy: 0.67973 | valid_auc: 0.72573 | valid_balanced_accuracy: 0.66355 | valid_accuracy: 0.66399 |  0:13:59s
epoch 49 | loss: 0.59771 | train_auc: 0.74078 | train_balanced_accuracy: 0.67709 | train_accuracy: 0.67741 | valid_auc: 0.7234  | valid_balanced_accuracy: 0.66505 | valid_accuracy: 0.66541 |  0:14:17s
epoch 50 | loss: 0.59963 | train_auc: 0.72387 | train_balanced_accuracy: 0.6656  | train_accuracy: 0.66608 | valid_auc: 0.70838 | valid_balanced_accuracy: 0.65858 | valid_accuracy: 0.65911 |  0:14:34s
epoch 51 | loss: 0.59424 | train_auc: 0.68481 | train_balanced_accuracy: 0.62799 | train_accuracy: 0.6289  | valid_auc: 0.67793 | valid_balanced_accuracy: 0.62397 | valid_accuracy: 0.62496 |  0:14:50s
epoch 52 | loss: 0.59139 | train_auc: 0.6714  | train_balanced_accuracy: 0.62232 | train_accuracy: 0.62311 | valid_auc: 0.67061 | valid_balanced_accuracy: 0.62173 | valid_accuracy: 0.6226  |  0:15:06s
epoch 53 | loss: 0.59413 | train_auc: 0.68987 | train_balanced_accuracy: 0.63573 | train_accuracy: 0.63645 | valid_auc: 0.68282 | valid_balanced_accuracy: 0.63126 | valid_accuracy: 0.63204 |  0:15:25s
epoch 54 | loss: 0.59741 | train_auc: 0.65963 | train_balanced_accuracy: 0.6169  | train_accuracy: 0.61745 | valid_auc: 0.65925 | valid_balanced_accuracy: 0.61806 | valid_accuracy: 0.61867 |  0:15:40s
epoch 55 | loss: 0.59411 | train_auc: 0.64635 | train_balanced_accuracy: 0.6106  | train_accuracy: 0.61135 | valid_auc: 0.64187 | valid_balanced_accuracy: 0.6093  | valid_accuracy: 0.61017 |  0:15:57s
epoch 56 | loss: 0.59385 | train_auc: 0.62653 | train_balanced_accuracy: 0.59241 | train_accuracy: 0.59289 | valid_auc: 0.63296 | valid_balanced_accuracy: 0.60233 | valid_accuracy: 0.60293 |  0:16:14s

Early stopping occurred at epoch 56 with best_epoch = 36 and best_valid_accuracy = 0.6717
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 66/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.667 total time=16.4min
[CV 5/5; 66/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.84175 | train_auc: 0.50164 | train_balanced_accuracy: 0.51571 | train_accuracy: 0.51342 | valid_auc: 0.50723 | valid_balanced_accuracy: 0.5194  | valid_accuracy: 0.517   |  0:00:17s
epoch 1  | loss: 0.75409 | train_auc: 0.49436 | train_balanced_accuracy: 0.51554 | train_accuracy: 0.51302 | valid_auc: 0.49883 | valid_balanced_accuracy: 0.52117 | valid_accuracy: 0.51857 |  0:00:33s
epoch 2  | loss: 0.71658 | train_auc: 0.52186 | train_balanced_accuracy: 0.51359 | train_accuracy: 0.51078 | valid_auc: 0.52605 | valid_balanced_accuracy: 0.51846 | valid_accuracy: 0.51558 |  0:00:53s
epoch 3  | loss: 0.69343 | train_auc: 0.54415 | train_balanced_accuracy: 0.52122 | train_accuracy: 0.51841 | valid_auc: 0.5449  | valid_balanced_accuracy: 0.52523 | valid_accuracy: 0.52235 |  0:01:10s
epoch 4  | loss: 0.67584 | train_auc: 0.56877 | train_balanced_accuracy: 0.52926 | train_accuracy: 0.5266  | valid_auc: 0.56876 | valid_balanced_accuracy: 0.53374 | valid_accuracy: 0.531   |  0:01:27s
epoch 5  | loss: 0.67003 | train_auc: 0.5939  | train_balanced_accuracy: 0.53385 | train_accuracy: 0.53112 | valid_auc: 0.58988 | valid_balanced_accuracy: 0.53943 | valid_accuracy: 0.53667 |  0:01:46s
epoch 6  | loss: 0.66319 | train_auc: 0.61104 | train_balanced_accuracy: 0.5507  | train_accuracy: 0.54832 | valid_auc: 0.60722 | valid_balanced_accuracy: 0.55576 | valid_accuracy: 0.55335 |  0:02:05s
epoch 7  | loss: 0.65787 | train_auc: 0.62202 | train_balanced_accuracy: 0.56369 | train_accuracy: 0.56146 | valid_auc: 0.62    | valid_balanced_accuracy: 0.5684  | valid_accuracy: 0.5661  |  0:02:23s
epoch 8  | loss: 0.65265 | train_auc: 0.63368 | train_balanced_accuracy: 0.57592 | train_accuracy: 0.57389 | valid_auc: 0.62948 | valid_balanced_accuracy: 0.57559 | valid_accuracy: 0.5735  |  0:02:39s
epoch 9  | loss: 0.64783 | train_auc: 0.64456 | train_balanced_accuracy: 0.58599 | train_accuracy: 0.58416 | valid_auc: 0.64075 | valid_balanced_accuracy: 0.58276 | valid_accuracy: 0.58089 |  0:02:59s
epoch 10 | loss: 0.64691 | train_auc: 0.65448 | train_balanced_accuracy: 0.60088 | train_accuracy: 0.59935 | valid_auc: 0.65053 | valid_balanced_accuracy: 0.59535 | valid_accuracy: 0.5938  |  0:03:17s
epoch 11 | loss: 0.64133 | train_auc: 0.66124 | train_balanced_accuracy: 0.60656 | train_accuracy: 0.60513 | valid_auc: 0.65661 | valid_balanced_accuracy: 0.59873 | valid_accuracy: 0.59726 |  0:03:33s
epoch 12 | loss: 0.64145 | train_auc: 0.66936 | train_balanced_accuracy: 0.61088 | train_accuracy: 0.60962 | valid_auc: 0.66524 | valid_balanced_accuracy: 0.60598 | valid_accuracy: 0.60466 |  0:03:48s
epoch 13 | loss: 0.64305 | train_auc: 0.67948 | train_balanced_accuracy: 0.6142  | train_accuracy: 0.61304 | valid_auc: 0.67544 | valid_balanced_accuracy: 0.60961 | valid_accuracy: 0.60844 |  0:04:06s
epoch 14 | loss: 0.63297 | train_auc: 0.68836 | train_balanced_accuracy: 0.62484 | train_accuracy: 0.62394 | valid_auc: 0.68319 | valid_balanced_accuracy: 0.6174  | valid_accuracy: 0.61646 |  0:04:23s
epoch 15 | loss: 0.63127 | train_auc: 0.69516 | train_balanced_accuracy: 0.62691 | train_accuracy: 0.62594 | valid_auc: 0.68925 | valid_balanced_accuracy: 0.62013 | valid_accuracy: 0.61914 |  0:04:40s
epoch 16 | loss: 0.63071 | train_auc: 0.7013  | train_balanced_accuracy: 0.63741 | train_accuracy: 0.63676 | valid_auc: 0.69492 | valid_balanced_accuracy: 0.6296  | valid_accuracy: 0.6289  |  0:04:57s
epoch 17 | loss: 0.62982 | train_auc: 0.70341 | train_balanced_accuracy: 0.63871 | train_accuracy: 0.63814 | valid_auc: 0.69633 | valid_balanced_accuracy: 0.63531 | valid_accuracy: 0.63472 |  0:05:15s
epoch 18 | loss: 0.62997 | train_auc: 0.70708 | train_balanced_accuracy: 0.64545 | train_accuracy: 0.64503 | valid_auc: 0.69877 | valid_balanced_accuracy: 0.64223 | valid_accuracy: 0.6418  |  0:05:31s
epoch 19 | loss: 0.62511 | train_auc: 0.70963 | train_balanced_accuracy: 0.64745 | train_accuracy: 0.64711 | valid_auc: 0.70085 | valid_balanced_accuracy: 0.63741 | valid_accuracy: 0.63708 |  0:05:49s
epoch 20 | loss: 0.62183 | train_auc: 0.71235 | train_balanced_accuracy: 0.65636 | train_accuracy: 0.65628 | valid_auc: 0.7039  | valid_balanced_accuracy: 0.64582 | valid_accuracy: 0.64573 |  0:06:06s
epoch 21 | loss: 0.62056 | train_auc: 0.71548 | train_balanced_accuracy: 0.6586  | train_accuracy: 0.65856 | valid_auc: 0.70603 | valid_balanced_accuracy: 0.64765 | valid_accuracy: 0.64762 |  0:06:24s
epoch 22 | loss: 0.61793 | train_auc: 0.71789 | train_balanced_accuracy: 0.66127 | train_accuracy: 0.66147 | valid_auc: 0.70852 | valid_balanced_accuracy: 0.65104 | valid_accuracy: 0.65124 |  0:06:41s
epoch 23 | loss: 0.61695 | train_auc: 0.7202  | train_balanced_accuracy: 0.66216 | train_accuracy: 0.66234 | valid_auc: 0.71071 | valid_balanced_accuracy: 0.65261 | valid_accuracy: 0.65282 |  0:06:57s
epoch 24 | loss: 0.6202  | train_auc: 0.72242 | train_balanced_accuracy: 0.66438 | train_accuracy: 0.6647  | valid_auc: 0.71271 | valid_balanced_accuracy: 0.6561  | valid_accuracy: 0.65644 |  0:07:17s
epoch 25 | loss: 0.61676 | train_auc: 0.7251  | train_balanced_accuracy: 0.66516 | train_accuracy: 0.66541 | valid_auc: 0.71405 | valid_balanced_accuracy: 0.65508 | valid_accuracy: 0.65534 |  0:07:34s
epoch 26 | loss: 0.61597 | train_auc: 0.72667 | train_balanced_accuracy: 0.66632 | train_accuracy: 0.66667 | valid_auc: 0.71529 | valid_balanced_accuracy: 0.65466 | valid_accuracy: 0.65502 |  0:07:51s
epoch 27 | loss: 0.61304 | train_auc: 0.72917 | train_balanced_accuracy: 0.66761 | train_accuracy: 0.66793 | valid_auc: 0.71639 | valid_balanced_accuracy: 0.65817 | valid_accuracy: 0.65848 |  0:08:09s
epoch 28 | loss: 0.61439 | train_auc: 0.72896 | train_balanced_accuracy: 0.66697 | train_accuracy: 0.66718 | valid_auc: 0.71628 | valid_balanced_accuracy: 0.65575 | valid_accuracy: 0.65596 |  0:08:27s
epoch 29 | loss: 0.61424 | train_auc: 0.7286  | train_balanced_accuracy: 0.66654 | train_accuracy: 0.66686 | valid_auc: 0.71644 | valid_balanced_accuracy: 0.65312 | valid_accuracy: 0.65345 |  0:08:44s
epoch 30 | loss: 0.61384 | train_auc: 0.72636 | train_balanced_accuracy: 0.6653  | train_accuracy: 0.6656  | valid_auc: 0.71519 | valid_balanced_accuracy: 0.65563 | valid_accuracy: 0.65596 |  0:09:03s
epoch 31 | loss: 0.60972 | train_auc: 0.72406 | train_balanced_accuracy: 0.66378 | train_accuracy: 0.66395 | valid_auc: 0.71366 | valid_balanced_accuracy: 0.65281 | valid_accuracy: 0.65297 |  0:09:20s
epoch 32 | loss: 0.61348 | train_auc: 0.72135 | train_balanced_accuracy: 0.66189 | train_accuracy: 0.66206 | valid_auc: 0.71323 | valid_balanced_accuracy: 0.65328 | valid_accuracy: 0.65345 |  0:09:37s
epoch 33 | loss: 0.615   | train_auc: 0.72639 | train_balanced_accuracy: 0.66514 | train_accuracy: 0.66537 | valid_auc: 0.71548 | valid_balanced_accuracy: 0.65496 | valid_accuracy: 0.65518 |  0:09:51s
epoch 34 | loss: 0.60687 | train_auc: 0.71077 | train_balanced_accuracy: 0.65624 | train_accuracy: 0.65648 | valid_auc: 0.7082  | valid_balanced_accuracy: 0.65244 | valid_accuracy: 0.65266 |  0:10:09s
epoch 35 | loss: 0.61096 | train_auc: 0.71612 | train_balanced_accuracy: 0.66003 | train_accuracy: 0.66033 | valid_auc: 0.71086 | valid_balanced_accuracy: 0.65537 | valid_accuracy: 0.65565 |  0:10:27s
epoch 36 | loss: 0.60562 | train_auc: 0.718   | train_balanced_accuracy: 0.65989 | train_accuracy: 0.66017 | valid_auc: 0.71088 | valid_balanced_accuracy: 0.6532  | valid_accuracy: 0.65345 |  0:10:43s
epoch 37 | loss: 0.60712 | train_auc: 0.72496 | train_balanced_accuracy: 0.66671 | train_accuracy: 0.66694 | valid_auc: 0.71551 | valid_balanced_accuracy: 0.65809 | valid_accuracy: 0.65833 |  0:11:01s
epoch 38 | loss: 0.60802 | train_auc: 0.7216  | train_balanced_accuracy: 0.66207 | train_accuracy: 0.66226 | valid_auc: 0.71599 | valid_balanced_accuracy: 0.65547 | valid_accuracy: 0.65565 |  0:11:17s
epoch 39 | loss: 0.60718 | train_auc: 0.72065 | train_balanced_accuracy: 0.66354 | train_accuracy: 0.66368 | valid_auc: 0.71338 | valid_balanced_accuracy: 0.65491 | valid_accuracy: 0.65502 |  0:11:36s
epoch 40 | loss: 0.60614 | train_auc: 0.71979 | train_balanced_accuracy: 0.66305 | train_accuracy: 0.66328 | valid_auc: 0.7112  | valid_balanced_accuracy: 0.65008 | valid_accuracy: 0.6503  |  0:11:53s
epoch 41 | loss: 0.60611 | train_auc: 0.71989 | train_balanced_accuracy: 0.66386 | train_accuracy: 0.66411 | valid_auc: 0.71137 | valid_balanced_accuracy: 0.65067 | valid_accuracy: 0.65093 |  0:12:11s
epoch 42 | loss: 0.60757 | train_auc: 0.72113 | train_balanced_accuracy: 0.66142 | train_accuracy: 0.66155 | valid_auc: 0.71422 | valid_balanced_accuracy: 0.6522  | valid_accuracy: 0.65234 |  0:12:30s
epoch 43 | loss: 0.60273 | train_auc: 0.74462 | train_balanced_accuracy: 0.68065 | train_accuracy: 0.68099 | valid_auc: 0.72838 | valid_balanced_accuracy: 0.67013 | valid_accuracy: 0.67044 |  0:12:48s
epoch 44 | loss: 0.60249 | train_auc: 0.73801 | train_balanced_accuracy: 0.67697 | train_accuracy: 0.67733 | valid_auc: 0.72512 | valid_balanced_accuracy: 0.66335 | valid_accuracy: 0.66368 |  0:13:06s
epoch 45 | loss: 0.60226 | train_auc: 0.72882 | train_balanced_accuracy: 0.66897 | train_accuracy: 0.66946 | valid_auc: 0.71533 | valid_balanced_accuracy: 0.65692 | valid_accuracy: 0.65738 |  0:13:23s
epoch 46 | loss: 0.60561 | train_auc: 0.7289  | train_balanced_accuracy: 0.67066 | train_accuracy: 0.67107 | valid_auc: 0.71581 | valid_balanced_accuracy: 0.65857 | valid_accuracy: 0.65895 |  0:13:41s
epoch 47 | loss: 0.60543 | train_auc: 0.72876 | train_balanced_accuracy: 0.67064 | train_accuracy: 0.67099 | valid_auc: 0.71716 | valid_balanced_accuracy: 0.65891 | valid_accuracy: 0.65927 |  0:13:58s
epoch 48 | loss: 0.60319 | train_auc: 0.72851 | train_balanced_accuracy: 0.67036 | train_accuracy: 0.67088 | valid_auc: 0.71584 | valid_balanced_accuracy: 0.65736 | valid_accuracy: 0.65785 |  0:14:15s
epoch 49 | loss: 0.5999  | train_auc: 0.73921 | train_balanced_accuracy: 0.67836 | train_accuracy: 0.67863 | valid_auc: 0.72721 | valid_balanced_accuracy: 0.66277 | valid_accuracy: 0.66305 |  0:14:33s
epoch 50 | loss: 0.59878 | train_auc: 0.73323 | train_balanced_accuracy: 0.67259 | train_accuracy: 0.67292 | valid_auc: 0.72023 | valid_balanced_accuracy: 0.65895 | valid_accuracy: 0.65927 |  0:14:51s
epoch 51 | loss: 0.60235 | train_auc: 0.7222  | train_balanced_accuracy: 0.66451 | train_accuracy: 0.66497 | valid_auc: 0.7112  | valid_balanced_accuracy: 0.65081 | valid_accuracy: 0.65124 |  0:15:08s
epoch 52 | loss: 0.60056 | train_auc: 0.72319 | train_balanced_accuracy: 0.6646  | train_accuracy: 0.66509 | valid_auc: 0.71198 | valid_balanced_accuracy: 0.65408 | valid_accuracy: 0.65455 |  0:15:26s
epoch 53 | loss: 0.60444 | train_auc: 0.72648 | train_balanced_accuracy: 0.66926 | train_accuracy: 0.66974 | valid_auc: 0.71404 | valid_balanced_accuracy: 0.65569 | valid_accuracy: 0.65612 |  0:15:43s
epoch 54 | loss: 0.60548 | train_auc: 0.73129 | train_balanced_accuracy: 0.67202 | train_accuracy: 0.67241 | valid_auc: 0.71733 | valid_balanced_accuracy: 0.65842 | valid_accuracy: 0.6588  |  0:16:01s
epoch 55 | loss: 0.60436 | train_auc: 0.73826 | train_balanced_accuracy: 0.67712 | train_accuracy: 0.67745 | valid_auc: 0.72416 | valid_balanced_accuracy: 0.66131 | valid_accuracy: 0.66163 |  0:16:17s
epoch 56 | loss: 0.6034  | train_auc: 0.74565 | train_balanced_accuracy: 0.68315 | train_accuracy: 0.68355 | valid_auc: 0.73129 | valid_balanced_accuracy: 0.66896 | valid_accuracy: 0.66934 |  0:16:34s
epoch 57 | loss: 0.5973  | train_auc: 0.75169 | train_balanced_accuracy: 0.68685 | train_accuracy: 0.68713 | valid_auc: 0.7353  | valid_balanced_accuracy: 0.676   | valid_accuracy: 0.67627 |  0:16:52s
epoch 58 | loss: 0.59796 | train_auc: 0.74944 | train_balanced_accuracy: 0.68541 | train_accuracy: 0.68559 | valid_auc: 0.73388 | valid_balanced_accuracy: 0.67    | valid_accuracy: 0.67013 |  0:17:10s
epoch 59 | loss: 0.60234 | train_auc: 0.75287 | train_balanced_accuracy: 0.68599 | train_accuracy: 0.68626 | valid_auc: 0.73565 | valid_balanced_accuracy: 0.67083 | valid_accuracy: 0.67107 |  0:17:27s
epoch 60 | loss: 0.6003  | train_auc: 0.75307 | train_balanced_accuracy: 0.68657 | train_accuracy: 0.68677 | valid_auc: 0.73718 | valid_balanced_accuracy: 0.67076 | valid_accuracy: 0.67092 |  0:17:44s
epoch 61 | loss: 0.6044  | train_auc: 0.75308 | train_balanced_accuracy: 0.68741 | train_accuracy: 0.68752 | valid_auc: 0.73749 | valid_balanced_accuracy: 0.67143 | valid_accuracy: 0.67155 |  0:18:02s
epoch 62 | loss: 0.59423 | train_auc: 0.74284 | train_balanced_accuracy: 0.67797 | train_accuracy: 0.67831 | valid_auc: 0.73073 | valid_balanced_accuracy: 0.6662  | valid_accuracy: 0.66651 |  0:18:20s
epoch 63 | loss: 0.59783 | train_auc: 0.74286 | train_balanced_accuracy: 0.67876 | train_accuracy: 0.67906 | valid_auc: 0.7304  | valid_balanced_accuracy: 0.66434 | valid_accuracy: 0.66462 |  0:18:39s
epoch 64 | loss: 0.59452 | train_auc: 0.74603 | train_balanced_accuracy: 0.68108 | train_accuracy: 0.68138 | valid_auc: 0.73303 | valid_balanced_accuracy: 0.66752 | valid_accuracy: 0.66777 |  0:18:56s
epoch 65 | loss: 0.60463 | train_auc: 0.74715 | train_balanced_accuracy: 0.68418 | train_accuracy: 0.68429 | valid_auc: 0.73292 | valid_balanced_accuracy: 0.66829 | valid_accuracy: 0.6684  |  0:19:14s
epoch 66 | loss: 0.59613 | train_auc: 0.75065 | train_balanced_accuracy: 0.6874  | train_accuracy: 0.68764 | valid_auc: 0.73362 | valid_balanced_accuracy: 0.67021 | valid_accuracy: 0.67044 |  0:19:32s
epoch 67 | loss: 0.59702 | train_auc: 0.74862 | train_balanced_accuracy: 0.68425 | train_accuracy: 0.68469 | valid_auc: 0.73373 | valid_balanced_accuracy: 0.66957 | valid_accuracy: 0.66997 |  0:19:49s
epoch 68 | loss: 0.59631 | train_auc: 0.74193 | train_balanced_accuracy: 0.67873 | train_accuracy: 0.67898 | valid_auc: 0.72778 | valid_balanced_accuracy: 0.66296 | valid_accuracy: 0.6632  |  0:20:07s
epoch 69 | loss: 0.59611 | train_auc: 0.75662 | train_balanced_accuracy: 0.69087 | train_accuracy: 0.69122 | valid_auc: 0.73909 | valid_balanced_accuracy: 0.6739  | valid_accuracy: 0.67422 |  0:20:22s
epoch 70 | loss: 0.59546 | train_auc: 0.75694 | train_balanced_accuracy: 0.69261 | train_accuracy: 0.69287 | valid_auc: 0.73818 | valid_balanced_accuracy: 0.67385 | valid_accuracy: 0.67406 |  0:20:41s
epoch 71 | loss: 0.59723 | train_auc: 0.75567 | train_balanced_accuracy: 0.69039 | train_accuracy: 0.69075 | valid_auc: 0.73698 | valid_balanced_accuracy: 0.66887 | valid_accuracy: 0.66918 |  0:20:59s
epoch 72 | loss: 0.59299 | train_auc: 0.75833 | train_balanced_accuracy: 0.69292 | train_accuracy: 0.69315 | valid_auc: 0.73715 | valid_balanced_accuracy: 0.67246 | valid_accuracy: 0.67265 |  0:21:15s
epoch 73 | loss: 0.59217 | train_auc: 0.7573  | train_balanced_accuracy: 0.69123 | train_accuracy: 0.69153 | valid_auc: 0.73693 | valid_balanced_accuracy: 0.67254 | valid_accuracy: 0.6728  |  0:21:34s
epoch 74 | loss: 0.59302 | train_auc: 0.75884 | train_balanced_accuracy: 0.69202 | train_accuracy: 0.6922  | valid_auc: 0.73901 | valid_balanced_accuracy: 0.67627 | valid_accuracy: 0.67642 |  0:21:52s
epoch 75 | loss: 0.59123 | train_auc: 0.75972 | train_balanced_accuracy: 0.69162 | train_accuracy: 0.69177 | valid_auc: 0.74098 | valid_balanced_accuracy: 0.67598 | valid_accuracy: 0.67611 |  0:22:11s
epoch 76 | loss: 0.59155 | train_auc: 0.75809 | train_balanced_accuracy: 0.69082 | train_accuracy: 0.6911  | valid_auc: 0.74    | valid_balanced_accuracy: 0.676   | valid_accuracy: 0.67627 |  0:22:29s
epoch 77 | loss: 0.59079 | train_auc: 0.74681 | train_balanced_accuracy: 0.68383 | train_accuracy: 0.68414 | valid_auc: 0.73229 | valid_balanced_accuracy: 0.66917 | valid_accuracy: 0.6695  |  0:22:46s
epoch 78 | loss: 0.58992 | train_auc: 0.73382 | train_balanced_accuracy: 0.6711  | train_accuracy: 0.67135 | valid_auc: 0.72335 | valid_balanced_accuracy: 0.66279 | valid_accuracy: 0.66305 |  0:23:03s
epoch 79 | loss: 0.59063 | train_auc: 0.7557  | train_balanced_accuracy: 0.69005 | train_accuracy: 0.69035 | valid_auc: 0.73858 | valid_balanced_accuracy: 0.6738  | valid_accuracy: 0.67406 |  0:23:18s
epoch 80 | loss: 0.59382 | train_auc: 0.75019 | train_balanced_accuracy: 0.68429 | train_accuracy: 0.68477 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.66765 | valid_accuracy: 0.66808 |  0:23:36s
epoch 81 | loss: 0.58793 | train_auc: 0.75498 | train_balanced_accuracy: 0.68877 | train_accuracy: 0.68894 | valid_auc: 0.73609 | valid_balanced_accuracy: 0.67359 | valid_accuracy: 0.67375 |  0:23:53s
epoch 82 | loss: 0.59098 | train_auc: 0.76187 | train_balanced_accuracy: 0.69426 | train_accuracy: 0.69448 | valid_auc: 0.73967 | valid_balanced_accuracy: 0.67796 | valid_accuracy: 0.67816 |  0:24:13s
epoch 83 | loss: 0.58836 | train_auc: 0.76272 | train_balanced_accuracy: 0.69559 | train_accuracy: 0.6959  | valid_auc: 0.73996 | valid_balanced_accuracy: 0.6785  | valid_accuracy: 0.67879 |  0:24:31s
epoch 84 | loss: 0.59088 | train_auc: 0.75402 | train_balanced_accuracy: 0.68782 | train_accuracy: 0.68819 | valid_auc: 0.73415 | valid_balanced_accuracy: 0.67089 | valid_accuracy: 0.67123 |  0:24:50s
epoch 85 | loss: 0.59436 | train_auc: 0.76166 | train_balanced_accuracy: 0.6943  | train_accuracy: 0.69464 | valid_auc: 0.73837 | valid_balanced_accuracy: 0.67579 | valid_accuracy: 0.67611 |  0:25:05s
epoch 86 | loss: 0.58835 | train_auc: 0.75976 | train_balanced_accuracy: 0.69285 | train_accuracy: 0.69326 | valid_auc: 0.73734 | valid_balanced_accuracy: 0.67337 | valid_accuracy: 0.67375 |  0:25:22s
epoch 87 | loss: 0.58709 | train_auc: 0.76269 | train_balanced_accuracy: 0.69657 | train_accuracy: 0.69684 | valid_auc: 0.73933 | valid_balanced_accuracy: 0.6751  | valid_accuracy: 0.67532 |  0:25:40s
epoch 88 | loss: 0.59013 | train_auc: 0.76042 | train_balanced_accuracy: 0.69286 | train_accuracy: 0.69326 | valid_auc: 0.73663 | valid_balanced_accuracy: 0.6756  | valid_accuracy: 0.67595 |  0:25:58s
epoch 89 | loss: 0.58878 | train_auc: 0.75088 | train_balanced_accuracy: 0.68309 | train_accuracy: 0.68362 | valid_auc: 0.73123 | valid_balanced_accuracy: 0.66949 | valid_accuracy: 0.66997 |  0:26:15s
epoch 90 | loss: 0.58553 | train_auc: 0.75996 | train_balanced_accuracy: 0.69177 | train_accuracy: 0.6922  | valid_auc: 0.73866 | valid_balanced_accuracy: 0.67332 | valid_accuracy: 0.67375 |  0:26:32s
epoch 91 | loss: 0.58829 | train_auc: 0.75972 | train_balanced_accuracy: 0.69261 | train_accuracy: 0.69271 | valid_auc: 0.74247 | valid_balanced_accuracy: 0.67585 | valid_accuracy: 0.67595 |  0:26:48s
epoch 92 | loss: 0.58346 | train_auc: 0.75606 | train_balanced_accuracy: 0.68898 | train_accuracy: 0.68905 | valid_auc: 0.74027 | valid_balanced_accuracy: 0.67305 | valid_accuracy: 0.67312 |  0:27:06s
epoch 93 | loss: 0.58979 | train_auc: 0.74475 | train_balanced_accuracy: 0.67832 | train_accuracy: 0.67847 | valid_auc: 0.7324  | valid_balanced_accuracy: 0.66307 | valid_accuracy: 0.6632  |  0:27:24s
epoch 94 | loss: 0.58901 | train_auc: 0.73905 | train_balanced_accuracy: 0.67355 | train_accuracy: 0.67371 | valid_auc: 0.72616 | valid_balanced_accuracy: 0.66178 | valid_accuracy: 0.66195 |  0:27:42s
epoch 95 | loss: 0.58258 | train_auc: 0.76157 | train_balanced_accuracy: 0.69415 | train_accuracy: 0.69425 | valid_auc: 0.74021 | valid_balanced_accuracy: 0.67257 | valid_accuracy: 0.67265 |  0:28:00s
epoch 96 | loss: 0.58588 | train_auc: 0.76722 | train_balanced_accuracy: 0.69975 | train_accuracy: 0.69987 | valid_auc: 0.74273 | valid_balanced_accuracy: 0.67853 | valid_accuracy: 0.67863 |  0:28:17s
epoch 97 | loss: 0.58735 | train_auc: 0.7646  | train_balanced_accuracy: 0.6968  | train_accuracy: 0.69692 | valid_auc: 0.74137 | valid_balanced_accuracy: 0.67789 | valid_accuracy: 0.678   |  0:28:35s
epoch 98 | loss: 0.58816 | train_auc: 0.76372 | train_balanced_accuracy: 0.69514 | train_accuracy: 0.69523 | valid_auc: 0.74041 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.67879 |  0:28:52s
epoch 99 | loss: 0.58694 | train_auc: 0.74999 | train_balanced_accuracy: 0.68488 | train_accuracy: 0.68524 | valid_auc: 0.7309  | valid_balanced_accuracy: 0.66778 | valid_accuracy: 0.66808 |  0:29:08s
epoch 100| loss: 0.58377 | train_auc: 0.74952 | train_balanced_accuracy: 0.68375 | train_accuracy: 0.68398 | valid_auc: 0.73115 | valid_balanced_accuracy: 0.67056 | valid_accuracy: 0.67076 |  0:29:24s
epoch 101| loss: 0.59128 | train_auc: 0.76025 | train_balanced_accuracy: 0.69382 | train_accuracy: 0.69405 | valid_auc: 0.73873 | valid_balanced_accuracy: 0.67655 | valid_accuracy: 0.67674 |  0:29:41s
epoch 102| loss: 0.58438 | train_auc: 0.76319 | train_balanced_accuracy: 0.69466 | train_accuracy: 0.69496 | valid_auc: 0.74051 | valid_balanced_accuracy: 0.67776 | valid_accuracy: 0.678   |  0:29:58s
epoch 103| loss: 0.58351 | train_auc: 0.76035 | train_balanced_accuracy: 0.69213 | train_accuracy: 0.69248 | valid_auc: 0.73996 | valid_balanced_accuracy: 0.67862 | valid_accuracy: 0.67894 |  0:30:16s
epoch 104| loss: 0.58125 | train_auc: 0.77043 | train_balanced_accuracy: 0.70277 | train_accuracy: 0.7029  | valid_auc: 0.74294 | valid_balanced_accuracy: 0.68042 | valid_accuracy: 0.68052 |  0:30:35s
epoch 105| loss: 0.58679 | train_auc: 0.77062 | train_balanced_accuracy: 0.70289 | train_accuracy: 0.70314 | valid_auc: 0.74281 | valid_balanced_accuracy: 0.68235 | valid_accuracy: 0.68256 |  0:30:50s
epoch 106| loss: 0.58201 | train_auc: 0.77052 | train_balanced_accuracy: 0.7022  | train_accuracy: 0.70243 | valid_auc: 0.74334 | valid_balanced_accuracy: 0.68363 | valid_accuracy: 0.68382 |  0:31:08s
epoch 107| loss: 0.5824  | train_auc: 0.77112 | train_balanced_accuracy: 0.70181 | train_accuracy: 0.70204 | valid_auc: 0.74452 | valid_balanced_accuracy: 0.6838  | valid_accuracy: 0.68398 |  0:31:25s
epoch 108| loss: 0.58543 | train_auc: 0.77081 | train_balanced_accuracy: 0.70115 | train_accuracy: 0.70125 | valid_auc: 0.74321 | valid_balanced_accuracy: 0.68092 | valid_accuracy: 0.68099 |  0:31:41s
epoch 109| loss: 0.582   | train_auc: 0.76747 | train_balanced_accuracy: 0.69922 | train_accuracy: 0.69924 | valid_auc: 0.74281 | valid_balanced_accuracy: 0.67924 | valid_accuracy: 0.67926 |  0:31:58s
epoch 110| loss: 0.58421 | train_auc: 0.76443 | train_balanced_accuracy: 0.69472 | train_accuracy: 0.69488 | valid_auc: 0.74286 | valid_balanced_accuracy: 0.67879 | valid_accuracy: 0.67894 |  0:32:16s
epoch 111| loss: 0.57777 | train_auc: 0.76224 | train_balanced_accuracy: 0.69395 | train_accuracy: 0.69405 | valid_auc: 0.74107 | valid_balanced_accuracy: 0.67837 | valid_accuracy: 0.67847 |  0:32:34s
epoch 112| loss: 0.58344 | train_auc: 0.76627 | train_balanced_accuracy: 0.69864 | train_accuracy: 0.69881 | valid_auc: 0.74191 | valid_balanced_accuracy: 0.675   | valid_accuracy: 0.67517 |  0:32:52s
epoch 113| loss: 0.58702 | train_auc: 0.76567 | train_balanced_accuracy: 0.69663 | train_accuracy: 0.69677 | valid_auc: 0.74274 | valid_balanced_accuracy: 0.67647 | valid_accuracy: 0.67658 |  0:33:11s
epoch 114| loss: 0.57987 | train_auc: 0.75933 | train_balanced_accuracy: 0.69076 | train_accuracy: 0.69094 | valid_auc: 0.74145 | valid_balanced_accuracy: 0.6723  | valid_accuracy: 0.67249 |  0:33:28s
epoch 115| loss: 0.58159 | train_auc: 0.77402 | train_balanced_accuracy: 0.70391 | train_accuracy: 0.70412 | valid_auc: 0.74328 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.67894 |  0:33:45s
epoch 116| loss: 0.58122 | train_auc: 0.76506 | train_balanced_accuracy: 0.6974  | train_accuracy: 0.69775 | valid_auc: 0.73788 | valid_balanced_accuracy: 0.67188 | valid_accuracy: 0.67218 |  0:34:01s
epoch 117| loss: 0.58252 | train_auc: 0.7758  | train_balanced_accuracy: 0.70563 | train_accuracy: 0.70582 | valid_auc: 0.74523 | valid_balanced_accuracy: 0.68147 | valid_accuracy: 0.68162 |  0:34:20s
epoch 118| loss: 0.58307 | train_auc: 0.77329 | train_balanced_accuracy: 0.70501 | train_accuracy: 0.70519 | valid_auc: 0.74399 | valid_balanced_accuracy: 0.67722 | valid_accuracy: 0.67737 |  0:34:38s
epoch 119| loss: 0.58509 | train_auc: 0.7651  | train_balanced_accuracy: 0.69658 | train_accuracy: 0.69684 | valid_auc: 0.74022 | valid_balanced_accuracy: 0.67478 | valid_accuracy: 0.67501 |  0:34:57s
epoch 120| loss: 0.57681 | train_auc: 0.76694 | train_balanced_accuracy: 0.69971 | train_accuracy: 0.69995 | valid_auc: 0.74208 | valid_balanced_accuracy: 0.67543 | valid_accuracy: 0.67564 |  0:35:15s
epoch 121| loss: 0.58375 | train_auc: 0.77522 | train_balanced_accuracy: 0.70473 | train_accuracy: 0.70499 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.68092 | valid_accuracy: 0.68115 |  0:35:33s
epoch 122| loss: 0.57191 | train_auc: 0.7641  | train_balanced_accuracy: 0.695   | train_accuracy: 0.69539 | valid_auc: 0.73885 | valid_balanced_accuracy: 0.67875 | valid_accuracy: 0.6791  |  0:35:52s
epoch 123| loss: 0.58158 | train_auc: 0.76973 | train_balanced_accuracy: 0.70183 | train_accuracy: 0.70216 | valid_auc: 0.74094 | valid_balanced_accuracy: 0.67836 | valid_accuracy: 0.67863 |  0:36:07s
epoch 124| loss: 0.57869 | train_auc: 0.77362 | train_balanced_accuracy: 0.70445 | train_accuracy: 0.70467 | valid_auc: 0.74497 | valid_balanced_accuracy: 0.68225 | valid_accuracy: 0.6824  |  0:36:25s
epoch 125| loss: 0.58091 | train_auc: 0.77712 | train_balanced_accuracy: 0.70803 | train_accuracy: 0.70818 | valid_auc: 0.7469  | valid_balanced_accuracy: 0.68466 | valid_accuracy: 0.68477 |  0:36:43s
epoch 126| loss: 0.5831  | train_auc: 0.77664 | train_balanced_accuracy: 0.70729 | train_accuracy: 0.70755 | valid_auc: 0.74472 | valid_balanced_accuracy: 0.67967 | valid_accuracy: 0.67989 |  0:37:01s
epoch 127| loss: 0.57807 | train_auc: 0.7675  | train_balanced_accuracy: 0.69765 | train_accuracy: 0.69802 | valid_auc: 0.74075 | valid_balanced_accuracy: 0.67179 | valid_accuracy: 0.67218 |  0:37:18s
epoch 128| loss: 0.57718 | train_auc: 0.75341 | train_balanced_accuracy: 0.68554 | train_accuracy: 0.68602 | valid_auc: 0.73277 | valid_balanced_accuracy: 0.66933 | valid_accuracy: 0.66981 |  0:37:35s
epoch 129| loss: 0.58017 | train_auc: 0.75541 | train_balanced_accuracy: 0.68823 | train_accuracy: 0.68854 | valid_auc: 0.73489 | valid_balanced_accuracy: 0.66779 | valid_accuracy: 0.66808 |  0:37:51s
epoch 130| loss: 0.58112 | train_auc: 0.75379 | train_balanced_accuracy: 0.6867  | train_accuracy: 0.68693 | valid_auc: 0.73407 | valid_balanced_accuracy: 0.6674  | valid_accuracy: 0.66761 |  0:38:08s
epoch 131| loss: 0.58048 | train_auc: 0.75785 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.6885  | valid_auc: 0.73776 | valid_balanced_accuracy: 0.66737 | valid_accuracy: 0.66745 |  0:38:24s
epoch 132| loss: 0.57611 | train_auc: 0.75928 | train_balanced_accuracy: 0.69009 | train_accuracy: 0.69027 | valid_auc: 0.73881 | valid_balanced_accuracy: 0.67294 | valid_accuracy: 0.67312 |  0:38:41s
epoch 133| loss: 0.57821 | train_auc: 0.76866 | train_balanced_accuracy: 0.70011 | train_accuracy: 0.70019 | valid_auc: 0.74125 | valid_balanced_accuracy: 0.6811  | valid_accuracy: 0.68115 |  0:38:59s
epoch 134| loss: 0.57533 | train_auc: 0.76161 | train_balanced_accuracy: 0.69521 | train_accuracy: 0.69527 | valid_auc: 0.7389  | valid_balanced_accuracy: 0.68177 | valid_accuracy: 0.68178 |  0:39:18s
epoch 135| loss: 0.58055 | train_auc: 0.76976 | train_balanced_accuracy: 0.70147 | train_accuracy: 0.70153 | valid_auc: 0.74365 | valid_balanced_accuracy: 0.68349 | valid_accuracy: 0.68351 |  0:39:34s
epoch 136| loss: 0.57605 | train_auc: 0.77551 | train_balanced_accuracy: 0.70552 | train_accuracy: 0.70554 | valid_auc: 0.74554 | valid_balanced_accuracy: 0.68195 | valid_accuracy: 0.68193 |  0:39:52s
epoch 137| loss: 0.57331 | train_auc: 0.77555 | train_balanced_accuracy: 0.70463 | train_accuracy: 0.70471 | valid_auc: 0.74481 | valid_balanced_accuracy: 0.6816  | valid_accuracy: 0.68162 |  0:40:08s
epoch 138| loss: 0.57645 | train_auc: 0.7786  | train_balanced_accuracy: 0.70774 | train_accuracy: 0.70798 | valid_auc: 0.74707 | valid_balanced_accuracy: 0.67811 | valid_accuracy: 0.67831 |  0:40:26s
epoch 139| loss: 0.57608 | train_auc: 0.77794 | train_balanced_accuracy: 0.70797 | train_accuracy: 0.70818 | valid_auc: 0.74605 | valid_balanced_accuracy: 0.67909 | valid_accuracy: 0.67926 |  0:40:44s
epoch 140| loss: 0.57735 | train_auc: 0.77657 | train_balanced_accuracy: 0.70647 | train_accuracy: 0.7068  | valid_auc: 0.74485 | valid_balanced_accuracy: 0.67848 | valid_accuracy: 0.67879 |  0:41:02s
epoch 141| loss: 0.57798 | train_auc: 0.77956 | train_balanced_accuracy: 0.70849 | train_accuracy: 0.70869 | valid_auc: 0.74541 | valid_balanced_accuracy: 0.67924 | valid_accuracy: 0.67941 |  0:41:20s
epoch 142| loss: 0.57419 | train_auc: 0.78142 | train_balanced_accuracy: 0.70999 | train_accuracy: 0.71006 | valid_auc: 0.74704 | valid_balanced_accuracy: 0.68125 | valid_accuracy: 0.6813  |  0:41:37s
epoch 143| loss: 0.56768 | train_auc: 0.7813  | train_balanced_accuracy: 0.7103  | train_accuracy: 0.71058 | valid_auc: 0.74646 | valid_balanced_accuracy: 0.68217 | valid_accuracy: 0.6824  |  0:41:55s
epoch 144| loss: 0.57355 | train_auc: 0.7791  | train_balanced_accuracy: 0.70858 | train_accuracy: 0.70892 | valid_auc: 0.74372 | valid_balanced_accuracy: 0.67865 | valid_accuracy: 0.67894 |  0:42:12s
epoch 145| loss: 0.57305 | train_auc: 0.77823 | train_balanced_accuracy: 0.708   | train_accuracy: 0.70814 | valid_auc: 0.74362 | valid_balanced_accuracy: 0.6771  | valid_accuracy: 0.67721 |  0:42:31s

Early stopping occurred at epoch 145 with best_epoch = 125 and best_valid_accuracy = 0.68477
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 66/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.02, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.684 total time=42.7min
[CV 1/5; 67/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68567 | train_auc: 0.63007 | train_balanced_accuracy: 0.60468 | train_accuracy: 0.60421 | valid_auc: 0.63404 | valid_balanced_accuracy: 0.60185 | valid_accuracy: 0.60135 |  0:00:15s
epoch 1  | loss: 0.63153 | train_auc: 0.653   | train_balanced_accuracy: 0.60921 | train_accuracy: 0.60775 | valid_auc: 0.65343 | valid_balanced_accuracy: 0.60413 | valid_accuracy: 0.60261 |  0:00:34s
epoch 2  | loss: 0.6147  | train_auc: 0.68627 | train_balanced_accuracy: 0.61901 | train_accuracy: 0.61794 | valid_auc: 0.67925 | valid_balanced_accuracy: 0.61552 | valid_accuracy: 0.61442 |  0:00:52s
epoch 3  | loss: 0.61137 | train_auc: 0.68621 | train_balanced_accuracy: 0.6256  | train_accuracy: 0.62479 | valid_auc: 0.68117 | valid_balanced_accuracy: 0.62171 | valid_accuracy: 0.62087 |  0:01:08s
epoch 4  | loss: 0.60147 | train_auc: 0.6968  | train_balanced_accuracy: 0.6244  | train_accuracy: 0.62341 | valid_auc: 0.68844 | valid_balanced_accuracy: 0.61998 | valid_accuracy: 0.61898 |  0:01:25s
epoch 5  | loss: 0.60113 | train_auc: 0.69704 | train_balanced_accuracy: 0.63135 | train_accuracy: 0.63065 | valid_auc: 0.69295 | valid_balanced_accuracy: 0.62885 | valid_accuracy: 0.62811 |  0:01:42s
epoch 6  | loss: 0.60199 | train_auc: 0.71034 | train_balanced_accuracy: 0.62149 | train_accuracy: 0.62022 | valid_auc: 0.70397 | valid_balanced_accuracy: 0.61716 | valid_accuracy: 0.61583 |  0:02:00s
epoch 7  | loss: 0.59758 | train_auc: 0.71405 | train_balanced_accuracy: 0.63518 | train_accuracy: 0.63419 | valid_auc: 0.70394 | valid_balanced_accuracy: 0.62821 | valid_accuracy: 0.62716 |  0:02:18s
epoch 8  | loss: 0.58935 | train_auc: 0.70809 | train_balanced_accuracy: 0.64048 | train_accuracy: 0.64006 | valid_auc: 0.7019  | valid_balanced_accuracy: 0.64104 | valid_accuracy: 0.64054 |  0:02:35s
epoch 9  | loss: 0.59294 | train_auc: 0.72518 | train_balanced_accuracy: 0.65893 | train_accuracy: 0.65847 | valid_auc: 0.71726 | valid_balanced_accuracy: 0.65489 | valid_accuracy: 0.65439 |  0:02:52s
epoch 10 | loss: 0.58624 | train_auc: 0.7215  | train_balanced_accuracy: 0.65857 | train_accuracy: 0.65827 | valid_auc: 0.71343 | valid_balanced_accuracy: 0.65236 | valid_accuracy: 0.65203 |  0:03:09s
epoch 11 | loss: 0.58824 | train_auc: 0.73059 | train_balanced_accuracy: 0.66658 | train_accuracy: 0.66697 | valid_auc: 0.72119 | valid_balanced_accuracy: 0.6592  | valid_accuracy: 0.65958 |  0:03:26s
epoch 12 | loss: 0.58637 | train_auc: 0.73308 | train_balanced_accuracy: 0.66798 | train_accuracy: 0.66866 | valid_auc: 0.71908 | valid_balanced_accuracy: 0.65338 | valid_accuracy: 0.65408 |  0:03:43s
epoch 13 | loss: 0.58462 | train_auc: 0.73832 | train_balanced_accuracy: 0.67158 | train_accuracy: 0.672   | valid_auc: 0.72583 | valid_balanced_accuracy: 0.6573  | valid_accuracy: 0.6577  |  0:04:02s
epoch 14 | loss: 0.58375 | train_auc: 0.7399  | train_balanced_accuracy: 0.67636 | train_accuracy: 0.67681 | valid_auc: 0.72845 | valid_balanced_accuracy: 0.66262 | valid_accuracy: 0.66305 |  0:04:18s
epoch 15 | loss: 0.58188 | train_auc: 0.74219 | train_balanced_accuracy: 0.67654 | train_accuracy: 0.67677 | valid_auc: 0.73087 | valid_balanced_accuracy: 0.66659 | valid_accuracy: 0.66682 |  0:04:36s
epoch 16 | loss: 0.57797 | train_auc: 0.74182 | train_balanced_accuracy: 0.6743  | train_accuracy: 0.67452 | valid_auc: 0.72729 | valid_balanced_accuracy: 0.66568 | valid_accuracy: 0.66588 |  0:04:53s
epoch 17 | loss: 0.57472 | train_auc: 0.74297 | train_balanced_accuracy: 0.67898 | train_accuracy: 0.6794  | valid_auc: 0.72849 | valid_balanced_accuracy: 0.65921 | valid_accuracy: 0.65958 |  0:05:11s
epoch 18 | loss: 0.57465 | train_auc: 0.74792 | train_balanced_accuracy: 0.68275 | train_accuracy: 0.68338 | valid_auc: 0.733   | valid_balanced_accuracy: 0.66653 | valid_accuracy: 0.66714 |  0:05:29s
epoch 19 | loss: 0.57862 | train_auc: 0.75425 | train_balanced_accuracy: 0.68381 | train_accuracy: 0.68416 | valid_auc: 0.73902 | valid_balanced_accuracy: 0.66823 | valid_accuracy: 0.66856 |  0:05:46s
epoch 20 | loss: 0.57397 | train_auc: 0.75411 | train_balanced_accuracy: 0.6864  | train_accuracy: 0.68656 | valid_auc: 0.73705 | valid_balanced_accuracy: 0.6698  | valid_accuracy: 0.66997 |  0:06:04s
epoch 21 | loss: 0.57301 | train_auc: 0.76413 | train_balanced_accuracy: 0.69443 | train_accuracy: 0.69487 | valid_auc: 0.74666 | valid_balanced_accuracy: 0.68279 | valid_accuracy: 0.68319 |  0:06:21s
epoch 22 | loss: 0.579   | train_auc: 0.76002 | train_balanced_accuracy: 0.68606 | train_accuracy: 0.68664 | valid_auc: 0.74409 | valid_balanced_accuracy: 0.67645 | valid_accuracy: 0.67705 |  0:06:36s
epoch 23 | loss: 0.57174 | train_auc: 0.76668 | train_balanced_accuracy: 0.6947  | train_accuracy: 0.69538 | valid_auc: 0.74853 | valid_balanced_accuracy: 0.67955 | valid_accuracy: 0.6802  |  0:06:54s
epoch 24 | loss: 0.57419 | train_auc: 0.75738 | train_balanced_accuracy: 0.68787 | train_accuracy: 0.68818 | valid_auc: 0.7379  | valid_balanced_accuracy: 0.67379 | valid_accuracy: 0.67406 |  0:07:11s
epoch 25 | loss: 0.56859 | train_auc: 0.76458 | train_balanced_accuracy: 0.69844 | train_accuracy: 0.69845 | valid_auc: 0.74355 | valid_balanced_accuracy: 0.68146 | valid_accuracy: 0.68146 |  0:07:27s
epoch 26 | loss: 0.57426 | train_auc: 0.76747 | train_balanced_accuracy: 0.69832 | train_accuracy: 0.69876 | valid_auc: 0.7455  | valid_balanced_accuracy: 0.68305 | valid_accuracy: 0.68351 |  0:07:43s
epoch 27 | loss: 0.57148 | train_auc: 0.77279 | train_balanced_accuracy: 0.70436 | train_accuracy: 0.70443 | valid_auc: 0.74613 | valid_balanced_accuracy: 0.68533 | valid_accuracy: 0.6854  |  0:08:01s
epoch 28 | loss: 0.5706  | train_auc: 0.77636 | train_balanced_accuracy: 0.70465 | train_accuracy: 0.70482 | valid_auc: 0.74789 | valid_balanced_accuracy: 0.68368 | valid_accuracy: 0.68382 |  0:08:18s
epoch 29 | loss: 0.56354 | train_auc: 0.78254 | train_balanced_accuracy: 0.71103 | train_accuracy: 0.71123 | valid_auc: 0.75879 | valid_balanced_accuracy: 0.69087 | valid_accuracy: 0.69106 |  0:08:33s
epoch 30 | loss: 0.56471 | train_auc: 0.76953 | train_balanced_accuracy: 0.70053 | train_accuracy: 0.70104 | valid_auc: 0.74665 | valid_balanced_accuracy: 0.68032 | valid_accuracy: 0.68083 |  0:08:49s
epoch 31 | loss: 0.56912 | train_auc: 0.76095 | train_balanced_accuracy: 0.69414 | train_accuracy: 0.69455 | valid_auc: 0.74287 | valid_balanced_accuracy: 0.68104 | valid_accuracy: 0.68146 |  0:09:05s
epoch 32 | loss: 0.56416 | train_auc: 0.77266 | train_balanced_accuracy: 0.70114 | train_accuracy: 0.70136 | valid_auc: 0.75132 | valid_balanced_accuracy: 0.68738 | valid_accuracy: 0.6876  |  0:09:23s
epoch 33 | loss: 0.56575 | train_auc: 0.76638 | train_balanced_accuracy: 0.69146 | train_accuracy: 0.69235 | valid_auc: 0.74477 | valid_balanced_accuracy: 0.67518 | valid_accuracy: 0.67611 |  0:09:41s
epoch 34 | loss: 0.55783 | train_auc: 0.76203 | train_balanced_accuracy: 0.69272 | train_accuracy: 0.69313 | valid_auc: 0.74071 | valid_balanced_accuracy: 0.6832  | valid_accuracy: 0.68366 |  0:09:59s
epoch 35 | loss: 0.56418 | train_auc: 0.77511 | train_balanced_accuracy: 0.70655 | train_accuracy: 0.70687 | valid_auc: 0.75323 | valid_balanced_accuracy: 0.68713 | valid_accuracy: 0.68744 |  0:10:16s
epoch 36 | loss: 0.56241 | train_auc: 0.78319 | train_balanced_accuracy: 0.70926 | train_accuracy: 0.70962 | valid_auc: 0.7542  | valid_balanced_accuracy: 0.68675 | valid_accuracy: 0.68713 |  0:10:33s
epoch 37 | loss: 0.55882 | train_auc: 0.78342 | train_balanced_accuracy: 0.70993 | train_accuracy: 0.71033 | valid_auc: 0.75347 | valid_balanced_accuracy: 0.69101 | valid_accuracy: 0.69138 |  0:10:51s
epoch 38 | loss: 0.55578 | train_auc: 0.77905 | train_balanced_accuracy: 0.70551 | train_accuracy: 0.70545 | valid_auc: 0.74997 | valid_balanced_accuracy: 0.68953 | valid_accuracy: 0.68949 |  0:11:07s
epoch 39 | loss: 0.55869 | train_auc: 0.79059 | train_balanced_accuracy: 0.71697 | train_accuracy: 0.71729 | valid_auc: 0.75458 | valid_balanced_accuracy: 0.69296 | valid_accuracy: 0.69326 |  0:11:27s
epoch 40 | loss: 0.55677 | train_auc: 0.79065 | train_balanced_accuracy: 0.71843 | train_accuracy: 0.71859 | valid_auc: 0.75402 | valid_balanced_accuracy: 0.68667 | valid_accuracy: 0.68681 |  0:11:43s
epoch 41 | loss: 0.55298 | train_auc: 0.79046 | train_balanced_accuracy: 0.71623 | train_accuracy: 0.71619 | valid_auc: 0.75011 | valid_balanced_accuracy: 0.68085 | valid_accuracy: 0.68083 |  0:12:01s
epoch 42 | loss: 0.55152 | train_auc: 0.79335 | train_balanced_accuracy: 0.71472 | train_accuracy: 0.71493 | valid_auc: 0.75662 | valid_balanced_accuracy: 0.68952 | valid_accuracy: 0.6898  |  0:12:18s
epoch 43 | loss: 0.55623 | train_auc: 0.79723 | train_balanced_accuracy: 0.72021 | train_accuracy: 0.7204  | valid_auc: 0.75867 | valid_balanced_accuracy: 0.69149 | valid_accuracy: 0.69169 |  0:12:35s
epoch 44 | loss: 0.55172 | train_auc: 0.79952 | train_balanced_accuracy: 0.72351 | train_accuracy: 0.72367 | valid_auc: 0.75962 | valid_balanced_accuracy: 0.69799 | valid_accuracy: 0.69814 |  0:12:52s
epoch 45 | loss: 0.55004 | train_auc: 0.79466 | train_balanced_accuracy: 0.71638 | train_accuracy: 0.71686 | valid_auc: 0.75459 | valid_balanced_accuracy: 0.68629 | valid_accuracy: 0.68681 |  0:13:08s
epoch 46 | loss: 0.54899 | train_auc: 0.79953 | train_balanced_accuracy: 0.72541 | train_accuracy: 0.72556 | valid_auc: 0.75779 | valid_balanced_accuracy: 0.69315 | valid_accuracy: 0.69326 |  0:13:25s
epoch 47 | loss: 0.54942 | train_auc: 0.7943  | train_balanced_accuracy: 0.71413 | train_accuracy: 0.71458 | valid_auc: 0.74869 | valid_balanced_accuracy: 0.68274 | valid_accuracy: 0.68319 |  0:13:40s
epoch 48 | loss: 0.54749 | train_auc: 0.80002 | train_balanced_accuracy: 0.72216 | train_accuracy: 0.72213 | valid_auc: 0.75592 | valid_balanced_accuracy: 0.69106 | valid_accuracy: 0.69106 |  0:13:56s
epoch 49 | loss: 0.54519 | train_auc: 0.80047 | train_balanced_accuracy: 0.72346 | train_accuracy: 0.72363 | valid_auc: 0.755   | valid_balanced_accuracy: 0.69247 | valid_accuracy: 0.69263 |  0:14:15s
epoch 50 | loss: 0.5449  | train_auc: 0.80187 | train_balanced_accuracy: 0.72401 | train_accuracy: 0.72406 | valid_auc: 0.76066 | valid_balanced_accuracy: 0.69366 | valid_accuracy: 0.69374 |  0:14:30s
epoch 51 | loss: 0.54598 | train_auc: 0.80462 | train_balanced_accuracy: 0.72496 | train_accuracy: 0.7254  | valid_auc: 0.76134 | valid_balanced_accuracy: 0.69152 | valid_accuracy: 0.69201 |  0:14:47s
epoch 52 | loss: 0.54236 | train_auc: 0.80559 | train_balanced_accuracy: 0.72856 | train_accuracy: 0.72862 | valid_auc: 0.76553 | valid_balanced_accuracy: 0.69915 | valid_accuracy: 0.69924 |  0:15:03s
epoch 53 | loss: 0.54366 | train_auc: 0.80162 | train_balanced_accuracy: 0.72269 | train_accuracy: 0.72308 | valid_auc: 0.76005 | valid_balanced_accuracy: 0.69239 | valid_accuracy: 0.69279 |  0:15:20s
epoch 54 | loss: 0.54304 | train_auc: 0.80756 | train_balanced_accuracy: 0.72695 | train_accuracy: 0.72721 | valid_auc: 0.76317 | valid_balanced_accuracy: 0.69299 | valid_accuracy: 0.69326 |  0:15:37s
epoch 55 | loss: 0.54492 | train_auc: 0.80336 | train_balanced_accuracy: 0.72509 | train_accuracy: 0.72544 | valid_auc: 0.7564  | valid_balanced_accuracy: 0.68833 | valid_accuracy: 0.6887  |  0:15:54s
epoch 56 | loss: 0.5433  | train_auc: 0.80828 | train_balanced_accuracy: 0.72826 | train_accuracy: 0.72855 | valid_auc: 0.7613  | valid_balanced_accuracy: 0.69615 | valid_accuracy: 0.69641 |  0:16:12s
epoch 57 | loss: 0.54225 | train_auc: 0.80731 | train_balanced_accuracy: 0.72803 | train_accuracy: 0.72831 | valid_auc: 0.75862 | valid_balanced_accuracy: 0.6913  | valid_accuracy: 0.69153 |  0:16:31s
epoch 58 | loss: 0.54301 | train_auc: 0.80705 | train_balanced_accuracy: 0.72558 | train_accuracy: 0.72587 | valid_auc: 0.76202 | valid_balanced_accuracy: 0.69409 | valid_accuracy: 0.69437 |  0:16:48s
epoch 59 | loss: 0.53958 | train_auc: 0.80865 | train_balanced_accuracy: 0.72479 | train_accuracy: 0.72512 | valid_auc: 0.76125 | valid_balanced_accuracy: 0.69086 | valid_accuracy: 0.69122 |  0:17:06s
epoch 60 | loss: 0.53993 | train_auc: 0.80909 | train_balanced_accuracy: 0.72937 | train_accuracy: 0.72957 | valid_auc: 0.7634  | valid_balanced_accuracy: 0.69948 | valid_accuracy: 0.69972 |  0:17:23s
epoch 61 | loss: 0.53743 | train_auc: 0.81001 | train_balanced_accuracy: 0.72977 | train_accuracy: 0.73016 | valid_auc: 0.7603  | valid_balanced_accuracy: 0.68991 | valid_accuracy: 0.69027 |  0:17:41s
epoch 62 | loss: 0.53492 | train_auc: 0.8102  | train_balanced_accuracy: 0.72889 | train_accuracy: 0.7289  | valid_auc: 0.76356 | valid_balanced_accuracy: 0.69169 | valid_accuracy: 0.69169 |  0:17:59s
epoch 63 | loss: 0.53608 | train_auc: 0.8111  | train_balanced_accuracy: 0.73073 | train_accuracy: 0.73095 | valid_auc: 0.75901 | valid_balanced_accuracy: 0.6927  | valid_accuracy: 0.69295 |  0:18:17s
epoch 64 | loss: 0.53766 | train_auc: 0.81424 | train_balanced_accuracy: 0.73234 | train_accuracy: 0.73232 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.68791 | valid_accuracy: 0.68791 |  0:18:34s
epoch 65 | loss: 0.5336  | train_auc: 0.81074 | train_balanced_accuracy: 0.73008 | train_accuracy: 0.73043 | valid_auc: 0.76068 | valid_balanced_accuracy: 0.69794 | valid_accuracy: 0.6983  |  0:18:52s
epoch 66 | loss: 0.53541 | train_auc: 0.8133  | train_balanced_accuracy: 0.73149 | train_accuracy: 0.73165 | valid_auc: 0.7597  | valid_balanced_accuracy: 0.68555 | valid_accuracy: 0.68571 |  0:19:10s
epoch 67 | loss: 0.53664 | train_auc: 0.80719 | train_balanced_accuracy: 0.7249  | train_accuracy: 0.7252  | valid_auc: 0.76065 | valid_balanced_accuracy: 0.68904 | valid_accuracy: 0.68933 |  0:19:27s
epoch 68 | loss: 0.53749 | train_auc: 0.81387 | train_balanced_accuracy: 0.72976 | train_accuracy: 0.7302  | valid_auc: 0.76044 | valid_balanced_accuracy: 0.69044 | valid_accuracy: 0.6909  |  0:19:44s
epoch 69 | loss: 0.53467 | train_auc: 0.80602 | train_balanced_accuracy: 0.72653 | train_accuracy: 0.72674 | valid_auc: 0.75695 | valid_balanced_accuracy: 0.69005 | valid_accuracy: 0.69027 |  0:20:00s
epoch 70 | loss: 0.53158 | train_auc: 0.81514 | train_balanced_accuracy: 0.73202 | train_accuracy: 0.73221 | valid_auc: 0.7607  | valid_balanced_accuracy: 0.69309 | valid_accuracy: 0.69326 |  0:20:17s
epoch 71 | loss: 0.53378 | train_auc: 0.81674 | train_balanced_accuracy: 0.73389 | train_accuracy: 0.73417 | valid_auc: 0.75875 | valid_balanced_accuracy: 0.69081 | valid_accuracy: 0.69106 |  0:20:35s
epoch 72 | loss: 0.53098 | train_auc: 0.82093 | train_balanced_accuracy: 0.73678 | train_accuracy: 0.73712 | valid_auc: 0.76417 | valid_balanced_accuracy: 0.69624 | valid_accuracy: 0.69657 |  0:20:52s
epoch 73 | loss: 0.52767 | train_auc: 0.81561 | train_balanced_accuracy: 0.73385 | train_accuracy: 0.7339  | valid_auc: 0.76395 | valid_balanced_accuracy: 0.69478 | valid_accuracy: 0.69484 |  0:21:08s
epoch 74 | loss: 0.52957 | train_auc: 0.81986 | train_balanced_accuracy: 0.736   | train_accuracy: 0.73645 | valid_auc: 0.76359 | valid_balanced_accuracy: 0.69453 | valid_accuracy: 0.695   |  0:21:27s
epoch 75 | loss: 0.53158 | train_auc: 0.81506 | train_balanced_accuracy: 0.73352 | train_accuracy: 0.7339  | valid_auc: 0.76011 | valid_balanced_accuracy: 0.69131 | valid_accuracy: 0.69169 |  0:21:44s
epoch 76 | loss: 0.53729 | train_auc: 0.81989 | train_balanced_accuracy: 0.73497 | train_accuracy: 0.73492 | valid_auc: 0.7678  | valid_balanced_accuracy: 0.69159 | valid_accuracy: 0.69153 |  0:22:04s
epoch 77 | loss: 0.52779 | train_auc: 0.81605 | train_balanced_accuracy: 0.73417 | train_accuracy: 0.73433 | valid_auc: 0.758   | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69043 |  0:22:21s
epoch 78 | loss: 0.52273 | train_auc: 0.8174  | train_balanced_accuracy: 0.73429 | train_accuracy: 0.73441 | valid_auc: 0.75997 | valid_balanced_accuracy: 0.69004 | valid_accuracy: 0.69012 |  0:22:39s
epoch 79 | loss: 0.52925 | train_auc: 0.82034 | train_balanced_accuracy: 0.7388  | train_accuracy: 0.73921 | valid_auc: 0.76559 | valid_balanced_accuracy: 0.69368 | valid_accuracy: 0.69405 |  0:22:57s
epoch 80 | loss: 0.53234 | train_auc: 0.82151 | train_balanced_accuracy: 0.73656 | train_accuracy: 0.73661 | valid_auc: 0.76101 | valid_balanced_accuracy: 0.69049 | valid_accuracy: 0.69059 |  0:23:15s

Early stopping occurred at epoch 80 with best_epoch = 60 and best_valid_accuracy = 0.69972
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 67/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.697 total time=23.4min
[CV 2/5; 67/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.6972  | train_auc: 0.59413 | train_balanced_accuracy: 0.55465 | train_accuracy: 0.55314 | valid_auc: 0.59104 | valid_balanced_accuracy: 0.55382 | valid_accuracy: 0.55225 |  0:00:17s
epoch 1  | loss: 0.63972 | train_auc: 0.65769 | train_balanced_accuracy: 0.60367 | train_accuracy: 0.60449 | valid_auc: 0.65786 | valid_balanced_accuracy: 0.60207 | valid_accuracy: 0.60293 |  0:00:35s
epoch 2  | loss: 0.62886 | train_auc: 0.68091 | train_balanced_accuracy: 0.62977 | train_accuracy: 0.63116 | valid_auc: 0.67819 | valid_balanced_accuracy: 0.63125 | valid_accuracy: 0.63267 |  0:00:50s
epoch 3  | loss: 0.61948 | train_auc: 0.68909 | train_balanced_accuracy: 0.65195 | train_accuracy: 0.65229 | valid_auc: 0.68715 | valid_balanced_accuracy: 0.64463 | valid_accuracy: 0.64495 |  0:01:09s
epoch 4  | loss: 0.60633 | train_auc: 0.69586 | train_balanced_accuracy: 0.63935 | train_accuracy: 0.64041 | valid_auc: 0.69427 | valid_balanced_accuracy: 0.64107 | valid_accuracy: 0.64212 |  0:01:24s
epoch 5  | loss: 0.6042  | train_auc: 0.69743 | train_balanced_accuracy: 0.63744 | train_accuracy: 0.63848 | valid_auc: 0.69627 | valid_balanced_accuracy: 0.64139 | valid_accuracy: 0.64243 |  0:01:42s
epoch 6  | loss: 0.60425 | train_auc: 0.70161 | train_balanced_accuracy: 0.6312  | train_accuracy: 0.63219 | valid_auc: 0.69499 | valid_balanced_accuracy: 0.62571 | valid_accuracy: 0.62669 |  0:02:00s
epoch 7  | loss: 0.60424 | train_auc: 0.69905 | train_balanced_accuracy: 0.62055 | train_accuracy: 0.62164 | valid_auc: 0.69355 | valid_balanced_accuracy: 0.61362 | valid_accuracy: 0.61473 |  0:02:16s
epoch 8  | loss: 0.59447 | train_auc: 0.70807 | train_balanced_accuracy: 0.63018 | train_accuracy: 0.6314  | valid_auc: 0.70159 | valid_balanced_accuracy: 0.62561 | valid_accuracy: 0.62685 |  0:02:34s
epoch 9  | loss: 0.60037 | train_auc: 0.70874 | train_balanced_accuracy: 0.65157 | train_accuracy: 0.65225 | valid_auc: 0.70516 | valid_balanced_accuracy: 0.6514  | valid_accuracy: 0.65203 |  0:02:52s
epoch 10 | loss: 0.5917  | train_auc: 0.7187  | train_balanced_accuracy: 0.66522 | train_accuracy: 0.66563 | valid_auc: 0.71436 | valid_balanced_accuracy: 0.66504 | valid_accuracy: 0.66541 |  0:03:09s
epoch 11 | loss: 0.59415 | train_auc: 0.71205 | train_balanced_accuracy: 0.65403 | train_accuracy: 0.65481 | valid_auc: 0.70716 | valid_balanced_accuracy: 0.65299 | valid_accuracy: 0.65376 |  0:03:26s
epoch 12 | loss: 0.59173 | train_auc: 0.72433 | train_balanced_accuracy: 0.66418 | train_accuracy: 0.66473 | valid_auc: 0.72226 | valid_balanced_accuracy: 0.66315 | valid_accuracy: 0.66368 |  0:03:43s
epoch 13 | loss: 0.58852 | train_auc: 0.72544 | train_balanced_accuracy: 0.66757 | train_accuracy: 0.66803 | valid_auc: 0.72053 | valid_balanced_accuracy: 0.66703 | valid_accuracy: 0.66745 |  0:04:01s
epoch 14 | loss: 0.58895 | train_auc: 0.73533 | train_balanced_accuracy: 0.66718 | train_accuracy: 0.66795 | valid_auc: 0.7305  | valid_balanced_accuracy: 0.66965 | valid_accuracy: 0.67044 |  0:04:20s
epoch 15 | loss: 0.58656 | train_auc: 0.73595 | train_balanced_accuracy: 0.67053 | train_accuracy: 0.67059 | valid_auc: 0.7328  | valid_balanced_accuracy: 0.67166 | valid_accuracy: 0.6717  |  0:04:38s
epoch 16 | loss: 0.58676 | train_auc: 0.74205 | train_balanced_accuracy: 0.67452 | train_accuracy: 0.6746  | valid_auc: 0.73489 | valid_balanced_accuracy: 0.67463 | valid_accuracy: 0.67469 |  0:04:57s
epoch 17 | loss: 0.58057 | train_auc: 0.74291 | train_balanced_accuracy: 0.67535 | train_accuracy: 0.67531 | valid_auc: 0.73833 | valid_balanced_accuracy: 0.67475 | valid_accuracy: 0.67469 |  0:05:16s
epoch 18 | loss: 0.58172 | train_auc: 0.74927 | train_balanced_accuracy: 0.68382 | train_accuracy: 0.68432 | valid_auc: 0.74058 | valid_balanced_accuracy: 0.67761 | valid_accuracy: 0.67816 |  0:05:35s
epoch 19 | loss: 0.58297 | train_auc: 0.75545 | train_balanced_accuracy: 0.6852  | train_accuracy: 0.68542 | valid_auc: 0.74424 | valid_balanced_accuracy: 0.67869 | valid_accuracy: 0.67894 |  0:05:53s
epoch 20 | loss: 0.57916 | train_auc: 0.7585  | train_balanced_accuracy: 0.69024 | train_accuracy: 0.69034 | valid_auc: 0.74525 | valid_balanced_accuracy: 0.68434 | valid_accuracy: 0.68445 |  0:06:10s
epoch 21 | loss: 0.57796 | train_auc: 0.75556 | train_balanced_accuracy: 0.68817 | train_accuracy: 0.68822 | valid_auc: 0.74363 | valid_balanced_accuracy: 0.6813  | valid_accuracy: 0.6813  |  0:06:30s
epoch 22 | loss: 0.58607 | train_auc: 0.76534 | train_balanced_accuracy: 0.69877 | train_accuracy: 0.69919 | valid_auc: 0.74981 | valid_balanced_accuracy: 0.68493 | valid_accuracy: 0.6854  |  0:06:46s
epoch 23 | loss: 0.57763 | train_auc: 0.7684  | train_balanced_accuracy: 0.69473 | train_accuracy: 0.69518 | valid_auc: 0.75225 | valid_balanced_accuracy: 0.68667 | valid_accuracy: 0.68713 |  0:07:03s
epoch 24 | loss: 0.57882 | train_auc: 0.77075 | train_balanced_accuracy: 0.70207 | train_accuracy: 0.70254 | valid_auc: 0.75207 | valid_balanced_accuracy: 0.68977 | valid_accuracy: 0.69027 |  0:07:21s
epoch 25 | loss: 0.57204 | train_auc: 0.76856 | train_balanced_accuracy: 0.69997 | train_accuracy: 0.70002 | valid_auc: 0.75086 | valid_balanced_accuracy: 0.68261 | valid_accuracy: 0.68272 |  0:07:39s
epoch 26 | loss: 0.57545 | train_auc: 0.77056 | train_balanced_accuracy: 0.697   | train_accuracy: 0.69738 | valid_auc: 0.75328 | valid_balanced_accuracy: 0.68486 | valid_accuracy: 0.68524 |  0:07:56s
epoch 27 | loss: 0.57076 | train_auc: 0.77522 | train_balanced_accuracy: 0.70491 | train_accuracy: 0.7049  | valid_auc: 0.75535 | valid_balanced_accuracy: 0.68744 | valid_accuracy: 0.68744 |  0:08:14s
epoch 28 | loss: 0.56629 | train_auc: 0.77975 | train_balanced_accuracy: 0.70724 | train_accuracy: 0.70738 | valid_auc: 0.76132 | valid_balanced_accuracy: 0.69703 | valid_accuracy: 0.6972  |  0:08:31s
epoch 29 | loss: 0.56981 | train_auc: 0.78034 | train_balanced_accuracy: 0.70584 | train_accuracy: 0.70584 | valid_auc: 0.75954 | valid_balanced_accuracy: 0.69957 | valid_accuracy: 0.69956 |  0:08:49s
epoch 30 | loss: 0.56638 | train_auc: 0.77575 | train_balanced_accuracy: 0.70402 | train_accuracy: 0.70411 | valid_auc: 0.75349 | valid_balanced_accuracy: 0.6905  | valid_accuracy: 0.69059 |  0:09:07s
epoch 31 | loss: 0.56521 | train_auc: 0.78633 | train_balanced_accuracy: 0.71096 | train_accuracy: 0.71119 | valid_auc: 0.75675 | valid_balanced_accuracy: 0.68674 | valid_accuracy: 0.68697 |  0:09:25s
epoch 32 | loss: 0.56481 | train_auc: 0.78762 | train_balanced_accuracy: 0.71312 | train_accuracy: 0.71328 | valid_auc: 0.76256 | valid_balanced_accuracy: 0.69592 | valid_accuracy: 0.6961  |  0:09:42s
epoch 33 | loss: 0.56538 | train_auc: 0.78075 | train_balanced_accuracy: 0.70537 | train_accuracy: 0.70576 | valid_auc: 0.75784 | valid_balanced_accuracy: 0.69204 | valid_accuracy: 0.69248 |  0:10:00s
epoch 34 | loss: 0.56355 | train_auc: 0.78246 | train_balanced_accuracy: 0.7123  | train_accuracy: 0.71245 | valid_auc: 0.75449 | valid_balanced_accuracy: 0.69278 | valid_accuracy: 0.69295 |  0:10:17s
epoch 35 | loss: 0.56055 | train_auc: 0.788   | train_balanced_accuracy: 0.71291 | train_accuracy: 0.71324 | valid_auc: 0.7577  | valid_balanced_accuracy: 0.6947  | valid_accuracy: 0.695   |  0:10:34s
epoch 36 | loss: 0.55928 | train_auc: 0.79157 | train_balanced_accuracy: 0.71686 | train_accuracy: 0.71702 | valid_auc: 0.76488 | valid_balanced_accuracy: 0.69404 | valid_accuracy: 0.69421 |  0:10:49s
epoch 37 | loss: 0.56109 | train_auc: 0.79057 | train_balanced_accuracy: 0.71438 | train_accuracy: 0.71477 | valid_auc: 0.75927 | valid_balanced_accuracy: 0.69142 | valid_accuracy: 0.69185 |  0:11:08s
epoch 38 | loss: 0.55565 | train_auc: 0.78801 | train_balanced_accuracy: 0.71121 | train_accuracy: 0.71108 | valid_auc: 0.75662 | valid_balanced_accuracy: 0.68644 | valid_accuracy: 0.68634 |  0:11:25s
epoch 39 | loss: 0.56061 | train_auc: 0.7934  | train_balanced_accuracy: 0.71971 | train_accuracy: 0.71969 | valid_auc: 0.76256 | valid_balanced_accuracy: 0.69901 | valid_accuracy: 0.69893 |  0:11:43s
epoch 40 | loss: 0.55874 | train_auc: 0.79377 | train_balanced_accuracy: 0.71958 | train_accuracy: 0.71973 | valid_auc: 0.76246 | valid_balanced_accuracy: 0.698   | valid_accuracy: 0.69814 |  0:12:00s
epoch 41 | loss: 0.55581 | train_auc: 0.79521 | train_balanced_accuracy: 0.71961 | train_accuracy: 0.71961 | valid_auc: 0.76343 | valid_balanced_accuracy: 0.69387 | valid_accuracy: 0.69389 |  0:12:19s
epoch 42 | loss: 0.55036 | train_auc: 0.79188 | train_balanced_accuracy: 0.71623 | train_accuracy: 0.71658 | valid_auc: 0.76081 | valid_balanced_accuracy: 0.69229 | valid_accuracy: 0.69263 |  0:12:37s
epoch 43 | loss: 0.56147 | train_auc: 0.79577 | train_balanced_accuracy: 0.71953 | train_accuracy: 0.7195  | valid_auc: 0.76464 | valid_balanced_accuracy: 0.69756 | valid_accuracy: 0.69751 |  0:12:55s
epoch 44 | loss: 0.55121 | train_auc: 0.79665 | train_balanced_accuracy: 0.7214  | train_accuracy: 0.72139 | valid_auc: 0.76277 | valid_balanced_accuracy: 0.69499 | valid_accuracy: 0.695   |  0:13:14s
epoch 45 | loss: 0.54878 | train_auc: 0.79462 | train_balanced_accuracy: 0.71347 | train_accuracy: 0.71415 | valid_auc: 0.75805 | valid_balanced_accuracy: 0.694   | valid_accuracy: 0.69468 |  0:13:33s
epoch 46 | loss: 0.54974 | train_auc: 0.79546 | train_balanced_accuracy: 0.7174  | train_accuracy: 0.71737 | valid_auc: 0.76443 | valid_balanced_accuracy: 0.69312 | valid_accuracy: 0.69311 |  0:13:51s
epoch 47 | loss: 0.54869 | train_auc: 0.78788 | train_balanced_accuracy: 0.70732 | train_accuracy: 0.70781 | valid_auc: 0.75304 | valid_balanced_accuracy: 0.68773 | valid_accuracy: 0.68823 |  0:14:08s
epoch 48 | loss: 0.54496 | train_auc: 0.78997 | train_balanced_accuracy: 0.71242 | train_accuracy: 0.71257 | valid_auc: 0.75976 | valid_balanced_accuracy: 0.6947  | valid_accuracy: 0.69484 |  0:14:27s
epoch 49 | loss: 0.54605 | train_auc: 0.79284 | train_balanced_accuracy: 0.71762 | train_accuracy: 0.71777 | valid_auc: 0.75519 | valid_balanced_accuracy: 0.69124 | valid_accuracy: 0.69138 |  0:14:45s

Early stopping occurred at epoch 49 with best_epoch = 29 and best_valid_accuracy = 0.69956
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 67/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.683 total time=14.9min
[CV 3/5; 67/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.69306 | train_auc: 0.60692 | train_balanced_accuracy: 0.55028 | train_accuracy: 0.54804 | valid_auc: 0.60265 | valid_balanced_accuracy: 0.54062 | valid_accuracy: 0.5384  |  0:00:16s
epoch 1  | loss: 0.63907 | train_auc: 0.65257 | train_balanced_accuracy: 0.53256 | train_accuracy: 0.52943 | valid_auc: 0.6453  | valid_balanced_accuracy: 0.53289 | valid_accuracy: 0.52975 |  0:00:34s
epoch 2  | loss: 0.62433 | train_auc: 0.67651 | train_balanced_accuracy: 0.54429 | train_accuracy: 0.54131 | valid_auc: 0.67261 | valid_balanced_accuracy: 0.54173 | valid_accuracy: 0.53872 |  0:00:50s
epoch 3  | loss: 0.61702 | train_auc: 0.69127 | train_balanced_accuracy: 0.57434 | train_accuracy: 0.57181 | valid_auc: 0.6868  | valid_balanced_accuracy: 0.57302 | valid_accuracy: 0.57051 |  0:01:08s
epoch 4  | loss: 0.60732 | train_auc: 0.70199 | train_balanced_accuracy: 0.61276 | train_accuracy: 0.61111 | valid_auc: 0.69711 | valid_balanced_accuracy: 0.60425 | valid_accuracy: 0.60261 |  0:01:25s
epoch 5  | loss: 0.60403 | train_auc: 0.70617 | train_balanced_accuracy: 0.61953 | train_accuracy: 0.61808 | valid_auc: 0.69985 | valid_balanced_accuracy: 0.61225 | valid_accuracy: 0.6108  |  0:01:42s
epoch 6  | loss: 0.60231 | train_auc: 0.71643 | train_balanced_accuracy: 0.62955 | train_accuracy: 0.62834 | valid_auc: 0.70947 | valid_balanced_accuracy: 0.62461 | valid_accuracy: 0.62339 |  0:01:58s
epoch 7  | loss: 0.6044  | train_auc: 0.71338 | train_balanced_accuracy: 0.64248 | train_accuracy: 0.64164 | valid_auc: 0.70645 | valid_balanced_accuracy: 0.64154 | valid_accuracy: 0.6407  |  0:02:15s
epoch 8  | loss: 0.59627 | train_auc: 0.71094 | train_balanced_accuracy: 0.65638 | train_accuracy: 0.65632 | valid_auc: 0.70153 | valid_balanced_accuracy: 0.65728 | valid_accuracy: 0.65722 |  0:02:32s
epoch 9  | loss: 0.59234 | train_auc: 0.71487 | train_balanced_accuracy: 0.65639 | train_accuracy: 0.65624 | valid_auc: 0.70854 | valid_balanced_accuracy: 0.65659 | valid_accuracy: 0.65644 |  0:02:48s
epoch 10 | loss: 0.58123 | train_auc: 0.73282 | train_balanced_accuracy: 0.67179 | train_accuracy: 0.67186 | valid_auc: 0.72557 | valid_balanced_accuracy: 0.66846 | valid_accuracy: 0.66856 |  0:03:06s
epoch 11 | loss: 0.58699 | train_auc: 0.73534 | train_balanced_accuracy: 0.67526 | train_accuracy: 0.67564 | valid_auc: 0.72673 | valid_balanced_accuracy: 0.67183 | valid_accuracy: 0.67218 |  0:03:23s
epoch 12 | loss: 0.58721 | train_auc: 0.73861 | train_balanced_accuracy: 0.67137 | train_accuracy: 0.67229 | valid_auc: 0.7244  | valid_balanced_accuracy: 0.66229 | valid_accuracy: 0.6632  |  0:03:40s
epoch 13 | loss: 0.58335 | train_auc: 0.74001 | train_balanced_accuracy: 0.67833 | train_accuracy: 0.67879 | valid_auc: 0.72685 | valid_balanced_accuracy: 0.66649 | valid_accuracy: 0.66698 |  0:03:58s
epoch 14 | loss: 0.5823  | train_auc: 0.74299 | train_balanced_accuracy: 0.68002 | train_accuracy: 0.68044 | valid_auc: 0.72783 | valid_balanced_accuracy: 0.67383 | valid_accuracy: 0.67422 |  0:04:16s
epoch 15 | loss: 0.58459 | train_auc: 0.74633 | train_balanced_accuracy: 0.68219 | train_accuracy: 0.68256 | valid_auc: 0.73453 | valid_balanced_accuracy: 0.67482 | valid_accuracy: 0.67517 |  0:04:33s
epoch 16 | loss: 0.57905 | train_auc: 0.74768 | train_balanced_accuracy: 0.67987 | train_accuracy: 0.6802  | valid_auc: 0.73148 | valid_balanced_accuracy: 0.66951 | valid_accuracy: 0.66981 |  0:04:51s
epoch 17 | loss: 0.57749 | train_auc: 0.74936 | train_balanced_accuracy: 0.68391 | train_accuracy: 0.68429 | valid_auc: 0.73237 | valid_balanced_accuracy: 0.67587 | valid_accuracy: 0.67627 |  0:05:11s
epoch 18 | loss: 0.58132 | train_auc: 0.75734 | train_balanced_accuracy: 0.68702 | train_accuracy: 0.6878  | valid_auc: 0.73657 | valid_balanced_accuracy: 0.67614 | valid_accuracy: 0.6769  |  0:05:29s
epoch 19 | loss: 0.57645 | train_auc: 0.7552  | train_balanced_accuracy: 0.68592 | train_accuracy: 0.68642 | valid_auc: 0.73637 | valid_balanced_accuracy: 0.67926 | valid_accuracy: 0.67973 |  0:05:47s
epoch 20 | loss: 0.57561 | train_auc: 0.75923 | train_balanced_accuracy: 0.68405 | train_accuracy: 0.68469 | valid_auc: 0.73579 | valid_balanced_accuracy: 0.67094 | valid_accuracy: 0.67155 |  0:06:05s
epoch 21 | loss: 0.56961 | train_auc: 0.76544 | train_balanced_accuracy: 0.6948  | train_accuracy: 0.69531 | valid_auc: 0.7389  | valid_balanced_accuracy: 0.68046 | valid_accuracy: 0.68099 |  0:06:22s
epoch 22 | loss: 0.57213 | train_auc: 0.77191 | train_balanced_accuracy: 0.69892 | train_accuracy: 0.69948 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.68362 | valid_accuracy: 0.68414 |  0:06:39s
epoch 23 | loss: 0.5703  | train_auc: 0.77241 | train_balanced_accuracy: 0.70353 | train_accuracy: 0.70393 | valid_auc: 0.74428 | valid_balanced_accuracy: 0.68455 | valid_accuracy: 0.68492 |  0:06:58s
epoch 24 | loss: 0.57095 | train_auc: 0.77607 | train_balanced_accuracy: 0.7036  | train_accuracy: 0.70385 | valid_auc: 0.74493 | valid_balanced_accuracy: 0.68261 | valid_accuracy: 0.68288 |  0:07:15s
epoch 25 | loss: 0.56574 | train_auc: 0.78134 | train_balanced_accuracy: 0.70731 | train_accuracy: 0.70759 | valid_auc: 0.75044 | valid_balanced_accuracy: 0.68841 | valid_accuracy: 0.6887  |  0:07:32s
epoch 26 | loss: 0.56498 | train_auc: 0.77948 | train_balanced_accuracy: 0.70615 | train_accuracy: 0.70656 | valid_auc: 0.74695 | valid_balanced_accuracy: 0.68789 | valid_accuracy: 0.68823 |  0:07:49s
epoch 27 | loss: 0.56728 | train_auc: 0.78581 | train_balanced_accuracy: 0.71117 | train_accuracy: 0.71128 | valid_auc: 0.75582 | valid_balanced_accuracy: 0.69221 | valid_accuracy: 0.69232 |  0:08:06s
epoch 28 | loss: 0.56156 | train_auc: 0.7843  | train_balanced_accuracy: 0.71068 | train_accuracy: 0.71077 | valid_auc: 0.75188 | valid_balanced_accuracy: 0.68613 | valid_accuracy: 0.68618 |  0:08:23s
epoch 29 | loss: 0.5604  | train_auc: 0.78358 | train_balanced_accuracy: 0.70932 | train_accuracy: 0.70928 | valid_auc: 0.75118 | valid_balanced_accuracy: 0.68798 | valid_accuracy: 0.68791 |  0:08:41s
epoch 30 | loss: 0.56326 | train_auc: 0.7871  | train_balanced_accuracy: 0.7139  | train_accuracy: 0.71424 | valid_auc: 0.75181 | valid_balanced_accuracy: 0.68748 | valid_accuracy: 0.68776 |  0:08:56s
epoch 31 | loss: 0.56111 | train_auc: 0.78846 | train_balanced_accuracy: 0.7142  | train_accuracy: 0.71439 | valid_auc: 0.75169 | valid_balanced_accuracy: 0.68666 | valid_accuracy: 0.68681 |  0:09:12s
epoch 32 | loss: 0.552   | train_auc: 0.78912 | train_balanced_accuracy: 0.71274 | train_accuracy: 0.71278 | valid_auc: 0.75075 | valid_balanced_accuracy: 0.68206 | valid_accuracy: 0.68209 |  0:09:28s
epoch 33 | loss: 0.55838 | train_auc: 0.79093 | train_balanced_accuracy: 0.71386 | train_accuracy: 0.71424 | valid_auc: 0.75251 | valid_balanced_accuracy: 0.68754 | valid_accuracy: 0.68791 |  0:09:45s
epoch 34 | loss: 0.55864 | train_auc: 0.78871 | train_balanced_accuracy: 0.71533 | train_accuracy: 0.71538 | valid_auc: 0.75113 | valid_balanced_accuracy: 0.68148 | valid_accuracy: 0.68146 |  0:10:02s
epoch 35 | loss: 0.5521  | train_auc: 0.79299 | train_balanced_accuracy: 0.71663 | train_accuracy: 0.71691 | valid_auc: 0.75225 | valid_balanced_accuracy: 0.68389 | valid_accuracy: 0.68414 |  0:10:18s
epoch 36 | loss: 0.55372 | train_auc: 0.78872 | train_balanced_accuracy: 0.71257 | train_accuracy: 0.71266 | valid_auc: 0.75211 | valid_balanced_accuracy: 0.68561 | valid_accuracy: 0.68571 |  0:10:34s
epoch 37 | loss: 0.55962 | train_auc: 0.7935  | train_balanced_accuracy: 0.71881 | train_accuracy: 0.71907 | valid_auc: 0.75354 | valid_balanced_accuracy: 0.69035 | valid_accuracy: 0.69059 |  0:10:52s
epoch 38 | loss: 0.55142 | train_auc: 0.7945  | train_balanced_accuracy: 0.71888 | train_accuracy: 0.71896 | valid_auc: 0.75557 | valid_balanced_accuracy: 0.68877 | valid_accuracy: 0.68886 |  0:11:10s
epoch 39 | loss: 0.54924 | train_auc: 0.79401 | train_balanced_accuracy: 0.71604 | train_accuracy: 0.71612 | valid_auc: 0.75372 | valid_balanced_accuracy: 0.68624 | valid_accuracy: 0.68634 |  0:11:26s
epoch 40 | loss: 0.55518 | train_auc: 0.79293 | train_balanced_accuracy: 0.71435 | train_accuracy: 0.71459 | valid_auc: 0.74725 | valid_balanced_accuracy: 0.6803  | valid_accuracy: 0.68052 |  0:11:44s
epoch 41 | loss: 0.55114 | train_auc: 0.79975 | train_balanced_accuracy: 0.72173 | train_accuracy: 0.72199 | valid_auc: 0.75279 | valid_balanced_accuracy: 0.68706 | valid_accuracy: 0.68728 |  0:12:01s
epoch 42 | loss: 0.54741 | train_auc: 0.79628 | train_balanced_accuracy: 0.71876 | train_accuracy: 0.71923 | valid_auc: 0.75343 | valid_balanced_accuracy: 0.68967 | valid_accuracy: 0.69012 |  0:12:17s
epoch 43 | loss: 0.55102 | train_auc: 0.79753 | train_balanced_accuracy: 0.7162  | train_accuracy: 0.7162  | valid_auc: 0.75071 | valid_balanced_accuracy: 0.68258 | valid_accuracy: 0.68256 |  0:12:35s
epoch 44 | loss: 0.55444 | train_auc: 0.79833 | train_balanced_accuracy: 0.72178 | train_accuracy: 0.72187 | valid_auc: 0.75338 | valid_balanced_accuracy: 0.68631 | valid_accuracy: 0.68634 |  0:12:50s
epoch 45 | loss: 0.54833 | train_auc: 0.80077 | train_balanced_accuracy: 0.72346 | train_accuracy: 0.72387 | valid_auc: 0.75213 | valid_balanced_accuracy: 0.68641 | valid_accuracy: 0.68681 |  0:13:07s
epoch 46 | loss: 0.54845 | train_auc: 0.80011 | train_balanced_accuracy: 0.72522 | train_accuracy: 0.72521 | valid_auc: 0.75596 | valid_balanced_accuracy: 0.69095 | valid_accuracy: 0.6909  |  0:13:24s
epoch 47 | loss: 0.54618 | train_auc: 0.80306 | train_balanced_accuracy: 0.72564 | train_accuracy: 0.72608 | valid_auc: 0.75606 | valid_balanced_accuracy: 0.68786 | valid_accuracy: 0.68823 |  0:13:39s

Early stopping occurred at epoch 47 with best_epoch = 27 and best_valid_accuracy = 0.69232
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 67/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.696 total time=13.8min
[CV 4/5; 67/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.70074 | train_auc: 0.60205 | train_balanced_accuracy: 0.51382 | train_accuracy: 0.51043 | valid_auc: 0.61438 | valid_balanced_accuracy: 0.51148 | valid_accuracy: 0.50803 |  0:00:17s
epoch 1  | loss: 0.65233 | train_auc: 0.66113 | train_balanced_accuracy: 0.59215 | train_accuracy: 0.59057 | valid_auc: 0.65187 | valid_balanced_accuracy: 0.58531 | valid_accuracy: 0.58373 |  0:00:35s
epoch 2  | loss: 0.62247 | train_auc: 0.69485 | train_balanced_accuracy: 0.61373 | train_accuracy: 0.61568 | valid_auc: 0.69903 | valid_balanced_accuracy: 0.61972 | valid_accuracy: 0.62166 |  0:00:52s
epoch 3  | loss: 0.61469 | train_auc: 0.68956 | train_balanced_accuracy: 0.6294  | train_accuracy: 0.63102 | valid_auc: 0.69432 | valid_balanced_accuracy: 0.63357 | valid_accuracy: 0.63519 |  0:01:09s
epoch 4  | loss: 0.60815 | train_auc: 0.69955 | train_balanced_accuracy: 0.6186  | train_accuracy: 0.62048 | valid_auc: 0.70553 | valid_balanced_accuracy: 0.62447 | valid_accuracy: 0.62638 |  0:01:25s
epoch 5  | loss: 0.60365 | train_auc: 0.70011 | train_balanced_accuracy: 0.63728 | train_accuracy: 0.63869 | valid_auc: 0.70448 | valid_balanced_accuracy: 0.64385 | valid_accuracy: 0.64526 |  0:01:42s
epoch 6  | loss: 0.59916 | train_auc: 0.70776 | train_balanced_accuracy: 0.64228 | train_accuracy: 0.64365 | valid_auc: 0.71235 | valid_balanced_accuracy: 0.64688 | valid_accuracy: 0.64825 |  0:02:00s
epoch 7  | loss: 0.59243 | train_auc: 0.71234 | train_balanced_accuracy: 0.64918 | train_accuracy: 0.65034 | valid_auc: 0.7142  | valid_balanced_accuracy: 0.6532  | valid_accuracy: 0.65439 |  0:02:19s
epoch 8  | loss: 0.58852 | train_auc: 0.71574 | train_balanced_accuracy: 0.64499 | train_accuracy: 0.64644 | valid_auc: 0.71304 | valid_balanced_accuracy: 0.64347 | valid_accuracy: 0.64495 |  0:02:38s
epoch 9  | loss: 0.58724 | train_auc: 0.72496 | train_balanced_accuracy: 0.64491 | train_accuracy: 0.64648 | valid_auc: 0.72052 | valid_balanced_accuracy: 0.64145 | valid_accuracy: 0.64306 |  0:02:56s
epoch 10 | loss: 0.57994 | train_auc: 0.73174 | train_balanced_accuracy: 0.6681  | train_accuracy: 0.66891 | valid_auc: 0.72298 | valid_balanced_accuracy: 0.66113 | valid_accuracy: 0.66195 |  0:03:13s
epoch 11 | loss: 0.58239 | train_auc: 0.72952 | train_balanced_accuracy: 0.66784 | train_accuracy: 0.66863 | valid_auc: 0.72093 | valid_balanced_accuracy: 0.65751 | valid_accuracy: 0.65833 |  0:03:31s
epoch 12 | loss: 0.58219 | train_auc: 0.73241 | train_balanced_accuracy: 0.67186 | train_accuracy: 0.67261 | valid_auc: 0.72263 | valid_balanced_accuracy: 0.66433 | valid_accuracy: 0.66509 |  0:03:50s
epoch 13 | loss: 0.57949 | train_auc: 0.7407  | train_balanced_accuracy: 0.67359 | train_accuracy: 0.67418 | valid_auc: 0.72925 | valid_balanced_accuracy: 0.66779 | valid_accuracy: 0.6684  |  0:04:08s
epoch 14 | loss: 0.5794  | train_auc: 0.73935 | train_balanced_accuracy: 0.682   | train_accuracy: 0.68248 | valid_auc: 0.72907 | valid_balanced_accuracy: 0.66678 | valid_accuracy: 0.6673  |  0:04:24s
epoch 15 | loss: 0.58091 | train_auc: 0.74701 | train_balanced_accuracy: 0.67589 | train_accuracy: 0.6767  | valid_auc: 0.73333 | valid_balanced_accuracy: 0.66303 | valid_accuracy: 0.66383 |  0:04:41s
epoch 16 | loss: 0.57056 | train_auc: 0.75034 | train_balanced_accuracy: 0.67787 | train_accuracy: 0.67859 | valid_auc: 0.736   | valid_balanced_accuracy: 0.67096 | valid_accuracy: 0.6717  |  0:05:00s
epoch 17 | loss: 0.57293 | train_auc: 0.75007 | train_balanced_accuracy: 0.68013 | train_accuracy: 0.68095 | valid_auc: 0.73486 | valid_balanced_accuracy: 0.66615 | valid_accuracy: 0.66698 |  0:05:18s
epoch 18 | loss: 0.57568 | train_auc: 0.75711 | train_balanced_accuracy: 0.68111 | train_accuracy: 0.6817  | valid_auc: 0.73721 | valid_balanced_accuracy: 0.67017 | valid_accuracy: 0.67076 |  0:05:36s
epoch 19 | loss: 0.57004 | train_auc: 0.75494 | train_balanced_accuracy: 0.68362 | train_accuracy: 0.68421 | valid_auc: 0.73856 | valid_balanced_accuracy: 0.66903 | valid_accuracy: 0.66966 |  0:05:53s
epoch 20 | loss: 0.56954 | train_auc: 0.75578 | train_balanced_accuracy: 0.68338 | train_accuracy: 0.68398 | valid_auc: 0.7384  | valid_balanced_accuracy: 0.66968 | valid_accuracy: 0.67029 |  0:06:10s
epoch 21 | loss: 0.56811 | train_auc: 0.76467 | train_balanced_accuracy: 0.68943 | train_accuracy: 0.68992 | valid_auc: 0.74249 | valid_balanced_accuracy: 0.67403 | valid_accuracy: 0.67454 |  0:06:26s
epoch 22 | loss: 0.56797 | train_auc: 0.76652 | train_balanced_accuracy: 0.69003 | train_accuracy: 0.69027 | valid_auc: 0.7384  | valid_balanced_accuracy: 0.6716  | valid_accuracy: 0.67186 |  0:06:43s
epoch 23 | loss: 0.56678 | train_auc: 0.77213 | train_balanced_accuracy: 0.69827 | train_accuracy: 0.69838 | valid_auc: 0.74492 | valid_balanced_accuracy: 0.67344 | valid_accuracy: 0.67359 |  0:06:59s
epoch 24 | loss: 0.56704 | train_auc: 0.76547 | train_balanced_accuracy: 0.69121 | train_accuracy: 0.69177 | valid_auc: 0.73557 | valid_balanced_accuracy: 0.66846 | valid_accuracy: 0.66903 |  0:07:18s
epoch 25 | loss: 0.56393 | train_auc: 0.77826 | train_balanced_accuracy: 0.70443 | train_accuracy: 0.70444 | valid_auc: 0.74418 | valid_balanced_accuracy: 0.67723 | valid_accuracy: 0.67721 |  0:07:33s
epoch 26 | loss: 0.55993 | train_auc: 0.77397 | train_balanced_accuracy: 0.69907 | train_accuracy: 0.69932 | valid_auc: 0.74798 | valid_balanced_accuracy: 0.68343 | valid_accuracy: 0.68366 |  0:07:50s
epoch 27 | loss: 0.56209 | train_auc: 0.7865  | train_balanced_accuracy: 0.71003 | train_accuracy: 0.71038 | valid_auc: 0.76071 | valid_balanced_accuracy: 0.69149 | valid_accuracy: 0.69185 |  0:08:08s
epoch 28 | loss: 0.55955 | train_auc: 0.78353 | train_balanced_accuracy: 0.70899 | train_accuracy: 0.70912 | valid_auc: 0.7508  | valid_balanced_accuracy: 0.68354 | valid_accuracy: 0.68366 |  0:08:25s
epoch 29 | loss: 0.55981 | train_auc: 0.78503 | train_balanced_accuracy: 0.70745 | train_accuracy: 0.70755 | valid_auc: 0.75205 | valid_balanced_accuracy: 0.68214 | valid_accuracy: 0.68225 |  0:08:42s
epoch 30 | loss: 0.55551 | train_auc: 0.78692 | train_balanced_accuracy: 0.71136 | train_accuracy: 0.71132 | valid_auc: 0.75448 | valid_balanced_accuracy: 0.69107 | valid_accuracy: 0.69106 |  0:08:58s
epoch 31 | loss: 0.55825 | train_auc: 0.78445 | train_balanced_accuracy: 0.70889 | train_accuracy: 0.70877 | valid_auc: 0.7473  | valid_balanced_accuracy: 0.67964 | valid_accuracy: 0.67957 |  0:09:15s
epoch 32 | loss: 0.55255 | train_auc: 0.78369 | train_balanced_accuracy: 0.7051  | train_accuracy: 0.70463 | valid_auc: 0.74259 | valid_balanced_accuracy: 0.67436 | valid_accuracy: 0.67391 |  0:09:31s
epoch 33 | loss: 0.55532 | train_auc: 0.78667 | train_balanced_accuracy: 0.71162 | train_accuracy: 0.71152 | valid_auc: 0.7468  | valid_balanced_accuracy: 0.67899 | valid_accuracy: 0.67894 |  0:09:49s
epoch 34 | loss: 0.5563  | train_auc: 0.7891  | train_balanced_accuracy: 0.71612 | train_accuracy: 0.71605 | valid_auc: 0.75434 | valid_balanced_accuracy: 0.68985 | valid_accuracy: 0.6898  |  0:10:06s
epoch 35 | loss: 0.54649 | train_auc: 0.79003 | train_balanced_accuracy: 0.71321 | train_accuracy: 0.71353 | valid_auc: 0.74935 | valid_balanced_accuracy: 0.68285 | valid_accuracy: 0.68319 |  0:10:22s
epoch 36 | loss: 0.54635 | train_auc: 0.79209 | train_balanced_accuracy: 0.71238 | train_accuracy: 0.71302 | valid_auc: 0.75677 | valid_balanced_accuracy: 0.68758 | valid_accuracy: 0.68823 |  0:10:42s
epoch 37 | loss: 0.55071 | train_auc: 0.79836 | train_balanced_accuracy: 0.71637 | train_accuracy: 0.71683 | valid_auc: 0.75617 | valid_balanced_accuracy: 0.69091 | valid_accuracy: 0.69138 |  0:11:00s
epoch 38 | loss: 0.55334 | train_auc: 0.7779  | train_balanced_accuracy: 0.69923 | train_accuracy: 0.69999 | valid_auc: 0.74559 | valid_balanced_accuracy: 0.6747  | valid_accuracy: 0.67548 |  0:11:17s
epoch 39 | loss: 0.54854 | train_auc: 0.79218 | train_balanced_accuracy: 0.71053 | train_accuracy: 0.71121 | valid_auc: 0.75093 | valid_balanced_accuracy: 0.68265 | valid_accuracy: 0.68335 |  0:11:34s
epoch 40 | loss: 0.54657 | train_auc: 0.79681 | train_balanced_accuracy: 0.71898 | train_accuracy: 0.71939 | valid_auc: 0.75952 | valid_balanced_accuracy: 0.69379 | valid_accuracy: 0.69421 |  0:11:50s
epoch 41 | loss: 0.5473  | train_auc: 0.80467 | train_balanced_accuracy: 0.72422 | train_accuracy: 0.7245  | valid_auc: 0.75504 | valid_balanced_accuracy: 0.68809 | valid_accuracy: 0.68839 |  0:12:06s
epoch 42 | loss: 0.5456  | train_auc: 0.79899 | train_balanced_accuracy: 0.71885 | train_accuracy: 0.71911 | valid_auc: 0.75704 | valid_balanced_accuracy: 0.68539 | valid_accuracy: 0.68571 |  0:12:23s
epoch 43 | loss: 0.54813 | train_auc: 0.7938  | train_balanced_accuracy: 0.71375 | train_accuracy: 0.71353 | valid_auc: 0.74962 | valid_balanced_accuracy: 0.67981 | valid_accuracy: 0.67957 |  0:12:40s
epoch 44 | loss: 0.55072 | train_auc: 0.77788 | train_balanced_accuracy: 0.69924 | train_accuracy: 0.69877 | valid_auc: 0.74248 | valid_balanced_accuracy: 0.67277 | valid_accuracy: 0.67233 |  0:12:57s
epoch 45 | loss: 0.54438 | train_auc: 0.79852 | train_balanced_accuracy: 0.7193  | train_accuracy: 0.71939 | valid_auc: 0.75493 | valid_balanced_accuracy: 0.68904 | valid_accuracy: 0.68917 |  0:13:15s
epoch 46 | loss: 0.54674 | train_auc: 0.78245 | train_balanced_accuracy: 0.70268 | train_accuracy: 0.70223 | valid_auc: 0.74202 | valid_balanced_accuracy: 0.67668 | valid_accuracy: 0.67627 |  0:13:31s
epoch 47 | loss: 0.54834 | train_auc: 0.79652 | train_balanced_accuracy: 0.7131  | train_accuracy: 0.71392 | valid_auc: 0.75669 | valid_balanced_accuracy: 0.68218 | valid_accuracy: 0.68303 |  0:13:48s
epoch 48 | loss: 0.54465 | train_auc: 0.80237 | train_balanced_accuracy: 0.72142 | train_accuracy: 0.72144 | valid_auc: 0.75917 | valid_balanced_accuracy: 0.69461 | valid_accuracy: 0.69468 |  0:14:04s
epoch 49 | loss: 0.54125 | train_auc: 0.80821 | train_balanced_accuracy: 0.72461 | train_accuracy: 0.72498 | valid_auc: 0.7605  | valid_balanced_accuracy: 0.68687 | valid_accuracy: 0.68728 |  0:14:21s
epoch 50 | loss: 0.54467 | train_auc: 0.80826 | train_balanced_accuracy: 0.72523 | train_accuracy: 0.72525 | valid_auc: 0.76147 | valid_balanced_accuracy: 0.69148 | valid_accuracy: 0.69153 |  0:14:37s
epoch 51 | loss: 0.5375  | train_auc: 0.76769 | train_balanced_accuracy: 0.68843 | train_accuracy: 0.68953 | valid_auc: 0.73668 | valid_balanced_accuracy: 0.66715 | valid_accuracy: 0.66824 |  0:14:55s
epoch 52 | loss: 0.53519 | train_auc: 0.81148 | train_balanced_accuracy: 0.72789 | train_accuracy: 0.72777 | valid_auc: 0.76095 | valid_balanced_accuracy: 0.69193 | valid_accuracy: 0.69185 |  0:15:13s
epoch 53 | loss: 0.5392  | train_auc: 0.80623 | train_balanced_accuracy: 0.72216 | train_accuracy: 0.72226 | valid_auc: 0.76414 | valid_balanced_accuracy: 0.69679 | valid_accuracy: 0.69688 |  0:15:30s
epoch 54 | loss: 0.54573 | train_auc: 0.80847 | train_balanced_accuracy: 0.72578 | train_accuracy: 0.72588 | valid_auc: 0.7657  | valid_balanced_accuracy: 0.69158 | valid_accuracy: 0.69169 |  0:15:46s
epoch 55 | loss: 0.5386  | train_auc: 0.80469 | train_balanced_accuracy: 0.72461 | train_accuracy: 0.7249  | valid_auc: 0.75876 | valid_balanced_accuracy: 0.68635 | valid_accuracy: 0.68665 |  0:16:04s
epoch 56 | loss: 0.53888 | train_auc: 0.7864  | train_balanced_accuracy: 0.70696 | train_accuracy: 0.70755 | valid_auc: 0.74768 | valid_balanced_accuracy: 0.67772 | valid_accuracy: 0.67831 |  0:16:23s
epoch 57 | loss: 0.54148 | train_auc: 0.81374 | train_balanced_accuracy: 0.73173 | train_accuracy: 0.7319  | valid_auc: 0.76321 | valid_balanced_accuracy: 0.68854 | valid_accuracy: 0.6887  |  0:16:40s
epoch 58 | loss: 0.53844 | train_auc: 0.81233 | train_balanced_accuracy: 0.73047 | train_accuracy: 0.7306  | valid_auc: 0.76047 | valid_balanced_accuracy: 0.69231 | valid_accuracy: 0.69248 |  0:16:57s
epoch 59 | loss: 0.53636 | train_auc: 0.80947 | train_balanced_accuracy: 0.72686 | train_accuracy: 0.72698 | valid_auc: 0.76238 | valid_balanced_accuracy: 0.6922  | valid_accuracy: 0.69232 |  0:17:11s
epoch 60 | loss: 0.53559 | train_auc: 0.81383 | train_balanced_accuracy: 0.73051 | train_accuracy: 0.73041 | valid_auc: 0.76345 | valid_balanced_accuracy: 0.69195 | valid_accuracy: 0.69185 |  0:17:30s
epoch 61 | loss: 0.52832 | train_auc: 0.81639 | train_balanced_accuracy: 0.73391 | train_accuracy: 0.73399 | valid_auc: 0.76293 | valid_balanced_accuracy: 0.69346 | valid_accuracy: 0.69358 |  0:17:48s
epoch 62 | loss: 0.53137 | train_auc: 0.8127  | train_balanced_accuracy: 0.72842 | train_accuracy: 0.72832 | valid_auc: 0.76197 | valid_balanced_accuracy: 0.68878 | valid_accuracy: 0.6887  |  0:18:04s
epoch 63 | loss: 0.53191 | train_auc: 0.8155  | train_balanced_accuracy: 0.73046 | train_accuracy: 0.73076 | valid_auc: 0.76689 | valid_balanced_accuracy: 0.69196 | valid_accuracy: 0.69232 |  0:18:21s
epoch 64 | loss: 0.52602 | train_auc: 0.81867 | train_balanced_accuracy: 0.73414 | train_accuracy: 0.73399 | valid_auc: 0.76685 | valid_balanced_accuracy: 0.69325 | valid_accuracy: 0.69311 |  0:18:38s
epoch 65 | loss: 0.5273  | train_auc: 0.80803 | train_balanced_accuracy: 0.72615 | train_accuracy: 0.726   | valid_auc: 0.75346 | valid_balanced_accuracy: 0.68661 | valid_accuracy: 0.6865  |  0:18:54s
epoch 66 | loss: 0.53207 | train_auc: 0.8161  | train_balanced_accuracy: 0.7311  | train_accuracy: 0.73107 | valid_auc: 0.76131 | valid_balanced_accuracy: 0.68951 | valid_accuracy: 0.68949 |  0:19:14s
epoch 67 | loss: 0.52731 | train_auc: 0.7497  | train_balanced_accuracy: 0.67458 | train_accuracy: 0.6754  | valid_auc: 0.71977 | valid_balanced_accuracy: 0.65199 | valid_accuracy: 0.65282 |  0:19:31s
epoch 68 | loss: 0.52875 | train_auc: 0.77221 | train_balanced_accuracy: 0.68771 | train_accuracy: 0.68878 | valid_auc: 0.73536 | valid_balanced_accuracy: 0.66075 | valid_accuracy: 0.66179 |  0:19:49s
epoch 69 | loss: 0.53173 | train_auc: 0.78403 | train_balanced_accuracy: 0.70286 | train_accuracy: 0.70361 | valid_auc: 0.74828 | valid_balanced_accuracy: 0.67613 | valid_accuracy: 0.6769  |  0:20:07s
epoch 70 | loss: 0.52547 | train_auc: 0.80643 | train_balanced_accuracy: 0.72374 | train_accuracy: 0.72395 | valid_auc: 0.76227 | valid_balanced_accuracy: 0.69224 | valid_accuracy: 0.69248 |  0:20:25s
epoch 71 | loss: 0.52607 | train_auc: 0.79363 | train_balanced_accuracy: 0.70876 | train_accuracy: 0.70932 | valid_auc: 0.75542 | valid_balanced_accuracy: 0.68197 | valid_accuracy: 0.68256 |  0:20:41s
epoch 72 | loss: 0.53101 | train_auc: 0.64585 | train_balanced_accuracy: 0.61413 | train_accuracy: 0.61552 | valid_auc: 0.63743 | valid_balanced_accuracy: 0.60673 | valid_accuracy: 0.60812 |  0:20:58s
epoch 73 | loss: 0.52748 | train_auc: 0.69606 | train_balanced_accuracy: 0.64821 | train_accuracy: 0.64896 | valid_auc: 0.68259 | valid_balanced_accuracy: 0.64026 | valid_accuracy: 0.64101 |  0:21:14s

Early stopping occurred at epoch 73 with best_epoch = 53 and best_valid_accuracy = 0.69688
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 67/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.689 total time=21.4min
[CV 5/5; 67/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.68515 | train_auc: 0.60653 | train_balanced_accuracy: 0.54419 | train_accuracy: 0.54214 | valid_auc: 0.60346 | valid_balanced_accuracy: 0.54912 | valid_accuracy: 0.54706 |  0:00:16s
epoch 1  | loss: 0.62944 | train_auc: 0.6676  | train_balanced_accuracy: 0.58601 | train_accuracy: 0.58392 | valid_auc: 0.67088 | valid_balanced_accuracy: 0.58362 | valid_accuracy: 0.58152 |  0:00:33s
epoch 2  | loss: 0.62171 | train_auc: 0.68558 | train_balanced_accuracy: 0.57552 | train_accuracy: 0.57306 | valid_auc: 0.68504 | valid_balanced_accuracy: 0.57821 | valid_accuracy: 0.5757  |  0:00:51s
epoch 3  | loss: 0.61407 | train_auc: 0.69494 | train_balanced_accuracy: 0.60147 | train_accuracy: 0.59958 | valid_auc: 0.69358 | valid_balanced_accuracy: 0.60449 | valid_accuracy: 0.60261 |  0:01:09s
epoch 4  | loss: 0.60511 | train_auc: 0.68364 | train_balanced_accuracy: 0.62211 | train_accuracy: 0.62095 | valid_auc: 0.68289 | valid_balanced_accuracy: 0.62048 | valid_accuracy: 0.61929 |  0:01:26s
epoch 5  | loss: 0.60134 | train_auc: 0.69814 | train_balanced_accuracy: 0.63165 | train_accuracy: 0.63098 | valid_auc: 0.69566 | valid_balanced_accuracy: 0.62928 | valid_accuracy: 0.62858 |  0:01:45s
epoch 6  | loss: 0.60124 | train_auc: 0.70689 | train_balanced_accuracy: 0.64285 | train_accuracy: 0.64235 | valid_auc: 0.70092 | valid_balanced_accuracy: 0.63556 | valid_accuracy: 0.63503 |  0:02:04s
epoch 7  | loss: 0.59954 | train_auc: 0.7074  | train_balanced_accuracy: 0.65318 | train_accuracy: 0.65376 | valid_auc: 0.70155 | valid_balanced_accuracy: 0.64539 | valid_accuracy: 0.64589 |  0:02:22s
epoch 8  | loss: 0.59939 | train_auc: 0.71487 | train_balanced_accuracy: 0.66268 | train_accuracy: 0.66376 | valid_auc: 0.71128 | valid_balanced_accuracy: 0.66026 | valid_accuracy: 0.66132 |  0:02:39s
epoch 9  | loss: 0.59737 | train_auc: 0.72061 | train_balanced_accuracy: 0.66253 | train_accuracy: 0.66316 | valid_auc: 0.71306 | valid_balanced_accuracy: 0.65695 | valid_accuracy: 0.65754 |  0:02:57s
epoch 10 | loss: 0.59459 | train_auc: 0.72742 | train_balanced_accuracy: 0.66361 | train_accuracy: 0.66415 | valid_auc: 0.7241  | valid_balanced_accuracy: 0.66174 | valid_accuracy: 0.66226 |  0:03:15s
epoch 11 | loss: 0.59239 | train_auc: 0.73066 | train_balanced_accuracy: 0.66962 | train_accuracy: 0.67029 | valid_auc: 0.72169 | valid_balanced_accuracy: 0.66228 | valid_accuracy: 0.66289 |  0:03:34s
epoch 12 | loss: 0.58621 | train_auc: 0.73506 | train_balanced_accuracy: 0.66825 | train_accuracy: 0.6684  | valid_auc: 0.72644 | valid_balanced_accuracy: 0.66168 | valid_accuracy: 0.66179 |  0:03:52s
epoch 13 | loss: 0.59414 | train_auc: 0.73796 | train_balanced_accuracy: 0.67236 | train_accuracy: 0.67304 | valid_auc: 0.72858 | valid_balanced_accuracy: 0.66619 | valid_accuracy: 0.66682 |  0:04:09s
epoch 14 | loss: 0.58397 | train_auc: 0.74005 | train_balanced_accuracy: 0.67247 | train_accuracy: 0.67288 | valid_auc: 0.7333  | valid_balanced_accuracy: 0.6644  | valid_accuracy: 0.66478 |  0:04:26s
epoch 15 | loss: 0.58255 | train_auc: 0.74331 | train_balanced_accuracy: 0.67586 | train_accuracy: 0.67662 | valid_auc: 0.73692 | valid_balanced_accuracy: 0.66263 | valid_accuracy: 0.66336 |  0:04:41s
epoch 16 | loss: 0.582   | train_auc: 0.74696 | train_balanced_accuracy: 0.67456 | train_accuracy: 0.67489 | valid_auc: 0.74099 | valid_balanced_accuracy: 0.66861 | valid_accuracy: 0.66887 |  0:05:01s
epoch 17 | loss: 0.5811  | train_auc: 0.75206 | train_balanced_accuracy: 0.67867 | train_accuracy: 0.67922 | valid_auc: 0.74151 | valid_balanced_accuracy: 0.66963 | valid_accuracy: 0.67013 |  0:05:17s
epoch 18 | loss: 0.57749 | train_auc: 0.75654 | train_balanced_accuracy: 0.68428 | train_accuracy: 0.6848  | valid_auc: 0.745   | valid_balanced_accuracy: 0.67641 | valid_accuracy: 0.6769  |  0:05:35s
epoch 19 | loss: 0.57674 | train_auc: 0.75883 | train_balanced_accuracy: 0.68477 | train_accuracy: 0.68551 | valid_auc: 0.74663 | valid_balanced_accuracy: 0.67304 | valid_accuracy: 0.67375 |  0:05:53s
epoch 20 | loss: 0.57853 | train_auc: 0.76256 | train_balanced_accuracy: 0.69213 | train_accuracy: 0.69244 | valid_auc: 0.74469 | valid_balanced_accuracy: 0.67741 | valid_accuracy: 0.67768 |  0:06:11s
epoch 21 | loss: 0.57438 | train_auc: 0.75672 | train_balanced_accuracy: 0.68816 | train_accuracy: 0.68858 | valid_auc: 0.74051 | valid_balanced_accuracy: 0.6773  | valid_accuracy: 0.67768 |  0:06:28s
epoch 22 | loss: 0.57108 | train_auc: 0.76808 | train_balanced_accuracy: 0.69425 | train_accuracy: 0.69456 | valid_auc: 0.74915 | valid_balanced_accuracy: 0.68039 | valid_accuracy: 0.68067 |  0:06:47s
epoch 23 | loss: 0.57156 | train_auc: 0.75793 | train_balanced_accuracy: 0.69028 | train_accuracy: 0.69079 | valid_auc: 0.74322 | valid_balanced_accuracy: 0.67577 | valid_accuracy: 0.67627 |  0:07:06s
epoch 24 | loss: 0.57529 | train_auc: 0.77009 | train_balanced_accuracy: 0.69856 | train_accuracy: 0.69901 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.68274 | valid_accuracy: 0.68319 |  0:07:23s
epoch 25 | loss: 0.57126 | train_auc: 0.75127 | train_balanced_accuracy: 0.6807  | train_accuracy: 0.68059 | valid_auc: 0.73353 | valid_balanced_accuracy: 0.66443 | valid_accuracy: 0.66431 |  0:07:39s
epoch 26 | loss: 0.57192 | train_auc: 0.7657  | train_balanced_accuracy: 0.69998 | train_accuracy: 0.70027 | valid_auc: 0.74385 | valid_balanced_accuracy: 0.68262 | valid_accuracy: 0.68288 |  0:07:57s
epoch 27 | loss: 0.57023 | train_auc: 0.7633  | train_balanced_accuracy: 0.69836 | train_accuracy: 0.69858 | valid_auc: 0.74435 | valid_balanced_accuracy: 0.68405 | valid_accuracy: 0.68429 |  0:08:16s
epoch 28 | loss: 0.56678 | train_auc: 0.76567 | train_balanced_accuracy: 0.69998 | train_accuracy: 0.70003 | valid_auc: 0.75229 | valid_balanced_accuracy: 0.68739 | valid_accuracy: 0.68744 |  0:08:32s
epoch 29 | loss: 0.56981 | train_auc: 0.77607 | train_balanced_accuracy: 0.70355 | train_accuracy: 0.70353 | valid_auc: 0.75114 | valid_balanced_accuracy: 0.69045 | valid_accuracy: 0.69043 |  0:08:50s
epoch 30 | loss: 0.56883 | train_auc: 0.76719 | train_balanced_accuracy: 0.69745 | train_accuracy: 0.69763 | valid_auc: 0.74025 | valid_balanced_accuracy: 0.67562 | valid_accuracy: 0.67579 |  0:09:08s
epoch 31 | loss: 0.56601 | train_auc: 0.71102 | train_balanced_accuracy: 0.64997 | train_accuracy: 0.65006 | valid_auc: 0.7024  | valid_balanced_accuracy: 0.64199 | valid_accuracy: 0.64212 |  0:09:24s
epoch 32 | loss: 0.56447 | train_auc: 0.75483 | train_balanced_accuracy: 0.68324 | train_accuracy: 0.68327 | valid_auc: 0.73194 | valid_balanced_accuracy: 0.67046 | valid_accuracy: 0.67044 |  0:09:41s
epoch 33 | loss: 0.56951 | train_auc: 0.76947 | train_balanced_accuracy: 0.69868 | train_accuracy: 0.69921 | valid_auc: 0.7462  | valid_balanced_accuracy: 0.6808  | valid_accuracy: 0.6813  |  0:09:59s
epoch 34 | loss: 0.56149 | train_auc: 0.74373 | train_balanced_accuracy: 0.67394 | train_accuracy: 0.6741  | valid_auc: 0.72435 | valid_balanced_accuracy: 0.65599 | valid_accuracy: 0.65612 |  0:10:17s
epoch 35 | loss: 0.56133 | train_auc: 0.74348 | train_balanced_accuracy: 0.67201 | train_accuracy: 0.67182 | valid_auc: 0.72958 | valid_balanced_accuracy: 0.66595 | valid_accuracy: 0.66572 |  0:10:35s
epoch 36 | loss: 0.55773 | train_auc: 0.76289 | train_balanced_accuracy: 0.69026 | train_accuracy: 0.6902  | valid_auc: 0.73899 | valid_balanced_accuracy: 0.66971 | valid_accuracy: 0.66966 |  0:10:52s
epoch 37 | loss: 0.55876 | train_auc: 0.78364 | train_balanced_accuracy: 0.70908 | train_accuracy: 0.7092  | valid_auc: 0.75031 | valid_balanced_accuracy: 0.68323 | valid_accuracy: 0.68335 |  0:11:10s
epoch 38 | loss: 0.55815 | train_auc: 0.78962 | train_balanced_accuracy: 0.71209 | train_accuracy: 0.71184 | valid_auc: 0.75487 | valid_balanced_accuracy: 0.68725 | valid_accuracy: 0.68697 |  0:11:28s
epoch 39 | loss: 0.55642 | train_auc: 0.7894  | train_balanced_accuracy: 0.7111  | train_accuracy: 0.71132 | valid_auc: 0.75152 | valid_balanced_accuracy: 0.68113 | valid_accuracy: 0.6813  |  0:11:46s
epoch 40 | loss: 0.55595 | train_auc: 0.79158 | train_balanced_accuracy: 0.71431 | train_accuracy: 0.71479 | valid_auc: 0.76209 | valid_balanced_accuracy: 0.6887  | valid_accuracy: 0.68917 |  0:12:03s
epoch 41 | loss: 0.55334 | train_auc: 0.78882 | train_balanced_accuracy: 0.71508 | train_accuracy: 0.71526 | valid_auc: 0.75429 | valid_balanced_accuracy: 0.68522 | valid_accuracy: 0.6854  |  0:12:21s
epoch 42 | loss: 0.55606 | train_auc: 0.79258 | train_balanced_accuracy: 0.71651 | train_accuracy: 0.71691 | valid_auc: 0.7576  | valid_balanced_accuracy: 0.69004 | valid_accuracy: 0.69043 |  0:12:38s
epoch 43 | loss: 0.55208 | train_auc: 0.79771 | train_balanced_accuracy: 0.72101 | train_accuracy: 0.72108 | valid_auc: 0.76254 | valid_balanced_accuracy: 0.69496 | valid_accuracy: 0.695   |  0:12:57s
epoch 44 | loss: 0.55084 | train_auc: 0.7976  | train_balanced_accuracy: 0.72068 | train_accuracy: 0.72096 | valid_auc: 0.76095 | valid_balanced_accuracy: 0.69192 | valid_accuracy: 0.69216 |  0:13:14s
epoch 45 | loss: 0.55075 | train_auc: 0.79586 | train_balanced_accuracy: 0.71681 | train_accuracy: 0.71734 | valid_auc: 0.75819 | valid_balanced_accuracy: 0.68424 | valid_accuracy: 0.68477 |  0:13:32s
epoch 46 | loss: 0.55159 | train_auc: 0.80066 | train_balanced_accuracy: 0.72345 | train_accuracy: 0.72368 | valid_auc: 0.76233 | valid_balanced_accuracy: 0.69492 | valid_accuracy: 0.69515 |  0:13:48s
epoch 47 | loss: 0.55349 | train_auc: 0.79716 | train_balanced_accuracy: 0.71968 | train_accuracy: 0.71986 | valid_auc: 0.75829 | valid_balanced_accuracy: 0.6909  | valid_accuracy: 0.69106 |  0:14:06s
epoch 48 | loss: 0.55118 | train_auc: 0.79903 | train_balanced_accuracy: 0.72141 | train_accuracy: 0.72147 | valid_auc: 0.76447 | valid_balanced_accuracy: 0.69892 | valid_accuracy: 0.69893 |  0:14:24s
epoch 49 | loss: 0.54385 | train_auc: 0.79926 | train_balanced_accuracy: 0.72246 | train_accuracy: 0.72277 | valid_auc: 0.75155 | valid_balanced_accuracy: 0.68463 | valid_accuracy: 0.68492 |  0:14:42s
epoch 50 | loss: 0.54675 | train_auc: 0.8026  | train_balanced_accuracy: 0.72479 | train_accuracy: 0.7249  | valid_auc: 0.76449 | valid_balanced_accuracy: 0.69916 | valid_accuracy: 0.69924 |  0:15:01s
epoch 51 | loss: 0.54729 | train_auc: 0.80501 | train_balanced_accuracy: 0.72575 | train_accuracy: 0.72616 | valid_auc: 0.76104 | valid_balanced_accuracy: 0.69038 | valid_accuracy: 0.69075 |  0:15:18s
epoch 52 | loss: 0.54372 | train_auc: 0.80679 | train_balanced_accuracy: 0.72693 | train_accuracy: 0.72718 | valid_auc: 0.76572 | valid_balanced_accuracy: 0.69388 | valid_accuracy: 0.69405 |  0:15:36s
epoch 53 | loss: 0.54739 | train_auc: 0.80543 | train_balanced_accuracy: 0.72473 | train_accuracy: 0.72517 | valid_auc: 0.75944 | valid_balanced_accuracy: 0.69    | valid_accuracy: 0.69043 |  0:15:54s
epoch 54 | loss: 0.54886 | train_auc: 0.80304 | train_balanced_accuracy: 0.72309 | train_accuracy: 0.72317 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.68824 | valid_accuracy: 0.68823 |  0:16:12s
epoch 55 | loss: 0.54772 | train_auc: 0.80528 | train_balanced_accuracy: 0.72471 | train_accuracy: 0.72482 | valid_auc: 0.76402 | valid_balanced_accuracy: 0.69508 | valid_accuracy: 0.69515 |  0:16:31s
epoch 56 | loss: 0.54357 | train_auc: 0.80791 | train_balanced_accuracy: 0.72622 | train_accuracy: 0.72627 | valid_auc: 0.76077 | valid_balanced_accuracy: 0.69009 | valid_accuracy: 0.69012 |  0:16:48s
epoch 57 | loss: 0.54146 | train_auc: 0.80051 | train_balanced_accuracy: 0.72073 | train_accuracy: 0.72092 | valid_auc: 0.75718 | valid_balanced_accuracy: 0.68459 | valid_accuracy: 0.68477 |  0:17:05s
epoch 58 | loss: 0.54081 | train_auc: 0.80615 | train_balanced_accuracy: 0.72358 | train_accuracy: 0.72356 | valid_auc: 0.75853 | valid_balanced_accuracy: 0.68908 | valid_accuracy: 0.68901 |  0:17:23s
epoch 59 | loss: 0.5464  | train_auc: 0.80606 | train_balanced_accuracy: 0.72529 | train_accuracy: 0.7258  | valid_auc: 0.75755 | valid_balanced_accuracy: 0.6841  | valid_accuracy: 0.68461 |  0:17:42s
epoch 60 | loss: 0.54391 | train_auc: 0.80998 | train_balanced_accuracy: 0.72862 | train_accuracy: 0.72867 | valid_auc: 0.76578 | valid_balanced_accuracy: 0.69592 | valid_accuracy: 0.69594 |  0:17:58s
epoch 61 | loss: 0.5445  | train_auc: 0.8042  | train_balanced_accuracy: 0.7252  | train_accuracy: 0.72533 | valid_auc: 0.75962 | valid_balanced_accuracy: 0.68843 | valid_accuracy: 0.68854 |  0:18:15s
epoch 62 | loss: 0.53796 | train_auc: 0.81005 | train_balanced_accuracy: 0.72948 | train_accuracy: 0.72958 | valid_auc: 0.75964 | valid_balanced_accuracy: 0.69104 | valid_accuracy: 0.69106 |  0:18:32s
epoch 63 | loss: 0.53598 | train_auc: 0.81313 | train_balanced_accuracy: 0.72863 | train_accuracy: 0.72919 | valid_auc: 0.76725 | valid_balanced_accuracy: 0.69056 | valid_accuracy: 0.69106 |  0:18:49s
epoch 64 | loss: 0.53874 | train_auc: 0.81182 | train_balanced_accuracy: 0.73089 | train_accuracy: 0.731   | valid_auc: 0.76522 | valid_balanced_accuracy: 0.69365 | valid_accuracy: 0.69374 |  0:19:09s
epoch 65 | loss: 0.54479 | train_auc: 0.80797 | train_balanced_accuracy: 0.72866 | train_accuracy: 0.72879 | valid_auc: 0.75532 | valid_balanced_accuracy: 0.68778 | valid_accuracy: 0.68791 |  0:19:27s
epoch 66 | loss: 0.54062 | train_auc: 0.81174 | train_balanced_accuracy: 0.72949 | train_accuracy: 0.7297  | valid_auc: 0.76883 | valid_balanced_accuracy: 0.69701 | valid_accuracy: 0.6972  |  0:19:44s
epoch 67 | loss: 0.53912 | train_auc: 0.81246 | train_balanced_accuracy: 0.72797 | train_accuracy: 0.72832 | valid_auc: 0.76302 | valid_balanced_accuracy: 0.68684 | valid_accuracy: 0.68713 |  0:20:03s
epoch 68 | loss: 0.53088 | train_auc: 0.80992 | train_balanced_accuracy: 0.72777 | train_accuracy: 0.72808 | valid_auc: 0.76149 | valid_balanced_accuracy: 0.69075 | valid_accuracy: 0.69106 |  0:20:21s
epoch 69 | loss: 0.53989 | train_auc: 0.80824 | train_balanced_accuracy: 0.72836 | train_accuracy: 0.72887 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.68886 | valid_accuracy: 0.68933 |  0:20:39s
epoch 70 | loss: 0.53462 | train_auc: 0.81483 | train_balanced_accuracy: 0.73496 | train_accuracy: 0.73525 | valid_auc: 0.76868 | valid_balanced_accuracy: 0.69709 | valid_accuracy: 0.69736 |  0:20:59s

Early stopping occurred at epoch 70 with best_epoch = 50 and best_valid_accuracy = 0.69924
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 67/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.02}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.698 total time=21.1min
[CV 1/5; 68/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.7055  | train_auc: 0.5986  | train_balanced_accuracy: 0.52791 | train_accuracy: 0.52493 | valid_auc: 0.59284 | valid_balanced_accuracy: 0.52962 | valid_accuracy: 0.5266  |  0:00:17s
epoch 1  | loss: 0.64808 | train_auc: 0.62811 | train_balanced_accuracy: 0.57008 | train_accuracy: 0.56797 | valid_auc: 0.62852 | valid_balanced_accuracy: 0.57311 | valid_accuracy: 0.57098 |  0:00:33s
epoch 2  | loss: 0.63515 | train_auc: 0.64618 | train_balanced_accuracy: 0.58982 | train_accuracy: 0.58824 | valid_auc: 0.64775 | valid_balanced_accuracy: 0.59227 | valid_accuracy: 0.59065 |  0:00:51s
epoch 3  | loss: 0.62546 | train_auc: 0.66082 | train_balanced_accuracy: 0.5986  | train_accuracy: 0.59693 | valid_auc: 0.65956 | valid_balanced_accuracy: 0.59505 | valid_accuracy: 0.59333 |  0:01:08s
epoch 4  | loss: 0.61186 | train_auc: 0.66199 | train_balanced_accuracy: 0.60478 | train_accuracy: 0.60342 | valid_auc: 0.65961 | valid_balanced_accuracy: 0.59567 | valid_accuracy: 0.59427 |  0:01:27s
epoch 5  | loss: 0.6098  | train_auc: 0.66459 | train_balanced_accuracy: 0.61237 | train_accuracy: 0.61161 | valid_auc: 0.66546 | valid_balanced_accuracy: 0.61378 | valid_accuracy: 0.613   |  0:01:43s
epoch 6  | loss: 0.6095  | train_auc: 0.66123 | train_balanced_accuracy: 0.61504 | train_accuracy: 0.61424 | valid_auc: 0.66251 | valid_balanced_accuracy: 0.6157  | valid_accuracy: 0.61489 |  0:02:01s
epoch 7  | loss: 0.6072  | train_auc: 0.67989 | train_balanced_accuracy: 0.61397 | train_accuracy: 0.61287 | valid_auc: 0.67697 | valid_balanced_accuracy: 0.61379 | valid_accuracy: 0.61268 |  0:02:17s
epoch 8  | loss: 0.59878 | train_auc: 0.68322 | train_balanced_accuracy: 0.63226 | train_accuracy: 0.63183 | valid_auc: 0.68138 | valid_balanced_accuracy: 0.6345  | valid_accuracy: 0.63409 |  0:02:33s
epoch 9  | loss: 0.6027  | train_auc: 0.68986 | train_balanced_accuracy: 0.62015 | train_accuracy: 0.619   | valid_auc: 0.68982 | valid_balanced_accuracy: 0.62564 | valid_accuracy: 0.62449 |  0:02:52s
epoch 10 | loss: 0.59316 | train_auc: 0.69476 | train_balanced_accuracy: 0.63185 | train_accuracy: 0.63116 | valid_auc: 0.69228 | valid_balanced_accuracy: 0.63747 | valid_accuracy: 0.63676 |  0:03:10s
epoch 11 | loss: 0.59473 | train_auc: 0.70698 | train_balanced_accuracy: 0.6428  | train_accuracy: 0.64253 | valid_auc: 0.704   | valid_balanced_accuracy: 0.64744 | valid_accuracy: 0.64715 |  0:03:28s
epoch 12 | loss: 0.59673 | train_auc: 0.71301 | train_balanced_accuracy: 0.64714 | train_accuracy: 0.64682 | valid_auc: 0.70475 | valid_balanced_accuracy: 0.63729 | valid_accuracy: 0.63692 |  0:03:46s
epoch 13 | loss: 0.59367 | train_auc: 0.71478 | train_balanced_accuracy: 0.64844 | train_accuracy: 0.64851 | valid_auc: 0.70711 | valid_balanced_accuracy: 0.63762 | valid_accuracy: 0.63771 |  0:04:03s
epoch 14 | loss: 0.58949 | train_auc: 0.71709 | train_balanced_accuracy: 0.65341 | train_accuracy: 0.6532  | valid_auc: 0.70879 | valid_balanced_accuracy: 0.64204 | valid_accuracy: 0.6418  |  0:04:20s
epoch 15 | loss: 0.58903 | train_auc: 0.7222  | train_balanced_accuracy: 0.65444 | train_accuracy: 0.65453 | valid_auc: 0.71513 | valid_balanced_accuracy: 0.64312 | valid_accuracy: 0.64322 |  0:04:37s
epoch 16 | loss: 0.58456 | train_auc: 0.72063 | train_balanced_accuracy: 0.65915 | train_accuracy: 0.65898 | valid_auc: 0.70949 | valid_balanced_accuracy: 0.6475  | valid_accuracy: 0.64731 |  0:04:56s
epoch 17 | loss: 0.58276 | train_auc: 0.73338 | train_balanced_accuracy: 0.66736 | train_accuracy: 0.6676  | valid_auc: 0.72169 | valid_balanced_accuracy: 0.65855 | valid_accuracy: 0.6588  |  0:05:15s
epoch 18 | loss: 0.58371 | train_auc: 0.73759 | train_balanced_accuracy: 0.67185 | train_accuracy: 0.67252 | valid_auc: 0.72406 | valid_balanced_accuracy: 0.66172 | valid_accuracy: 0.66242 |  0:05:31s
epoch 19 | loss: 0.58284 | train_auc: 0.74565 | train_balanced_accuracy: 0.67718 | train_accuracy: 0.67779 | valid_auc: 0.73098 | valid_balanced_accuracy: 0.66876 | valid_accuracy: 0.66934 |  0:05:47s
epoch 20 | loss: 0.5833  | train_auc: 0.7506  | train_balanced_accuracy: 0.68244 | train_accuracy: 0.68279 | valid_auc: 0.7305  | valid_balanced_accuracy: 0.66429 | valid_accuracy: 0.66462 |  0:06:05s
epoch 21 | loss: 0.57726 | train_auc: 0.75536 | train_balanced_accuracy: 0.68655 | train_accuracy: 0.68707 | valid_auc: 0.73222 | valid_balanced_accuracy: 0.66645 | valid_accuracy: 0.66698 |  0:06:24s
epoch 22 | loss: 0.58121 | train_auc: 0.74994 | train_balanced_accuracy: 0.68438 | train_accuracy: 0.68503 | valid_auc: 0.73305 | valid_balanced_accuracy: 0.6722  | valid_accuracy: 0.6728  |  0:06:42s
epoch 23 | loss: 0.57564 | train_auc: 0.75444 | train_balanced_accuracy: 0.68655 | train_accuracy: 0.68727 | valid_auc: 0.73779 | valid_balanced_accuracy: 0.66863 | valid_accuracy: 0.66934 |  0:06:59s
epoch 24 | loss: 0.58181 | train_auc: 0.76111 | train_balanced_accuracy: 0.69506 | train_accuracy: 0.69553 | valid_auc: 0.73532 | valid_balanced_accuracy: 0.67279 | valid_accuracy: 0.67328 |  0:07:17s
epoch 25 | loss: 0.57347 | train_auc: 0.76627 | train_balanced_accuracy: 0.69638 | train_accuracy: 0.69632 | valid_auc: 0.74016 | valid_balanced_accuracy: 0.67523 | valid_accuracy: 0.67517 |  0:07:34s
epoch 26 | loss: 0.57244 | train_auc: 0.76698 | train_balanced_accuracy: 0.69324 | train_accuracy: 0.6938  | valid_auc: 0.73627 | valid_balanced_accuracy: 0.67224 | valid_accuracy: 0.6728  |  0:07:52s
epoch 27 | loss: 0.57422 | train_auc: 0.76613 | train_balanced_accuracy: 0.6981  | train_accuracy: 0.69837 | valid_auc: 0.73908 | valid_balanced_accuracy: 0.67927 | valid_accuracy: 0.67957 |  0:08:08s
epoch 28 | loss: 0.57517 | train_auc: 0.7684  | train_balanced_accuracy: 0.69785 | train_accuracy: 0.69813 | valid_auc: 0.74039 | valid_balanced_accuracy: 0.67443 | valid_accuracy: 0.67469 |  0:08:26s
epoch 29 | loss: 0.56857 | train_auc: 0.77865 | train_balanced_accuracy: 0.70574 | train_accuracy: 0.70596 | valid_auc: 0.74551 | valid_balanced_accuracy: 0.67778 | valid_accuracy: 0.678   |  0:08:43s
epoch 30 | loss: 0.56888 | train_auc: 0.77146 | train_balanced_accuracy: 0.69977 | train_accuracy: 0.69998 | valid_auc: 0.73955 | valid_balanced_accuracy: 0.67464 | valid_accuracy: 0.67485 |  0:09:01s
epoch 31 | loss: 0.56707 | train_auc: 0.77954 | train_balanced_accuracy: 0.70918 | train_accuracy: 0.70915 | valid_auc: 0.74753 | valid_balanced_accuracy: 0.68182 | valid_accuracy: 0.68178 |  0:09:19s
epoch 32 | loss: 0.57148 | train_auc: 0.7776  | train_balanced_accuracy: 0.70244 | train_accuracy: 0.70281 | valid_auc: 0.74274 | valid_balanced_accuracy: 0.67935 | valid_accuracy: 0.67973 |  0:09:37s
epoch 33 | loss: 0.56894 | train_auc: 0.783   | train_balanced_accuracy: 0.70621 | train_accuracy: 0.70651 | valid_auc: 0.74806 | valid_balanced_accuracy: 0.678   | valid_accuracy: 0.67831 |  0:09:56s
epoch 34 | loss: 0.56846 | train_auc: 0.78291 | train_balanced_accuracy: 0.70881 | train_accuracy: 0.70915 | valid_auc: 0.75139 | valid_balanced_accuracy: 0.68535 | valid_accuracy: 0.68571 |  0:10:13s
epoch 35 | loss: 0.56803 | train_auc: 0.78257 | train_balanced_accuracy: 0.70757 | train_accuracy: 0.70793 | valid_auc: 0.74919 | valid_balanced_accuracy: 0.68391 | valid_accuracy: 0.68429 |  0:10:30s
epoch 36 | loss: 0.56884 | train_auc: 0.78597 | train_balanced_accuracy: 0.70975 | train_accuracy: 0.70978 | valid_auc: 0.74894 | valid_balanced_accuracy: 0.68349 | valid_accuracy: 0.68351 |  0:10:48s
epoch 37 | loss: 0.56439 | train_auc: 0.7822  | train_balanced_accuracy: 0.7049  | train_accuracy: 0.70545 | valid_auc: 0.74731 | valid_balanced_accuracy: 0.68077 | valid_accuracy: 0.6813  |  0:11:06s
epoch 38 | loss: 0.56511 | train_auc: 0.77175 | train_balanced_accuracy: 0.69782 | train_accuracy: 0.69782 | valid_auc: 0.7351  | valid_balanced_accuracy: 0.66681 | valid_accuracy: 0.66682 |  0:11:23s
epoch 39 | loss: 0.5627  | train_auc: 0.78654 | train_balanced_accuracy: 0.7104  | train_accuracy: 0.71072 | valid_auc: 0.74623 | valid_balanced_accuracy: 0.68381 | valid_accuracy: 0.68414 |  0:11:40s
epoch 40 | loss: 0.56191 | train_auc: 0.78585 | train_balanced_accuracy: 0.71073 | train_accuracy: 0.71112 | valid_auc: 0.74651 | valid_balanced_accuracy: 0.6798  | valid_accuracy: 0.6802  |  0:11:57s
epoch 41 | loss: 0.56372 | train_auc: 0.78429 | train_balanced_accuracy: 0.7076  | train_accuracy: 0.70753 | valid_auc: 0.73993 | valid_balanced_accuracy: 0.67666 | valid_accuracy: 0.67658 |  0:12:15s
epoch 42 | loss: 0.554   | train_auc: 0.78931 | train_balanced_accuracy: 0.71389 | train_accuracy: 0.71411 | valid_auc: 0.74283 | valid_balanced_accuracy: 0.67588 | valid_accuracy: 0.67611 |  0:12:32s
epoch 43 | loss: 0.56356 | train_auc: 0.7925  | train_balanced_accuracy: 0.7146  | train_accuracy: 0.7147  | valid_auc: 0.74901 | valid_balanced_accuracy: 0.68247 | valid_accuracy: 0.68256 |  0:12:50s
epoch 44 | loss: 0.55745 | train_auc: 0.78848 | train_balanced_accuracy: 0.71228 | train_accuracy: 0.7123  | valid_auc: 0.74562 | valid_balanced_accuracy: 0.68081 | valid_accuracy: 0.68083 |  0:13:08s
epoch 45 | loss: 0.55763 | train_auc: 0.79241 | train_balanced_accuracy: 0.71384 | train_accuracy: 0.71422 | valid_auc: 0.74619 | valid_balanced_accuracy: 0.68044 | valid_accuracy: 0.68083 |  0:13:27s
epoch 46 | loss: 0.55573 | train_auc: 0.7895  | train_balanced_accuracy: 0.71182 | train_accuracy: 0.71171 | valid_auc: 0.74587 | valid_balanced_accuracy: 0.6835  | valid_accuracy: 0.68335 |  0:13:46s
epoch 47 | loss: 0.55823 | train_auc: 0.78607 | train_balanced_accuracy: 0.71156 | train_accuracy: 0.7119  | valid_auc: 0.74488 | valid_balanced_accuracy: 0.67735 | valid_accuracy: 0.67768 |  0:14:03s
epoch 48 | loss: 0.55151 | train_auc: 0.79717 | train_balanced_accuracy: 0.71516 | train_accuracy: 0.71489 | valid_auc: 0.74791 | valid_balanced_accuracy: 0.68061 | valid_accuracy: 0.68036 |  0:14:18s
epoch 49 | loss: 0.55439 | train_auc: 0.79358 | train_balanced_accuracy: 0.7164  | train_accuracy: 0.71635 | valid_auc: 0.7517  | valid_balanced_accuracy: 0.68584 | valid_accuracy: 0.68571 |  0:14:35s
epoch 50 | loss: 0.55145 | train_auc: 0.79216 | train_balanced_accuracy: 0.7144  | train_accuracy: 0.7145  | valid_auc: 0.75163 | valid_balanced_accuracy: 0.68262 | valid_accuracy: 0.68272 |  0:14:53s
epoch 51 | loss: 0.55281 | train_auc: 0.7913  | train_balanced_accuracy: 0.7142  | train_accuracy: 0.71418 | valid_auc: 0.75296 | valid_balanced_accuracy: 0.68668 | valid_accuracy: 0.68665 |  0:15:11s
epoch 52 | loss: 0.55127 | train_auc: 0.79733 | train_balanced_accuracy: 0.71971 | train_accuracy: 0.71973 | valid_auc: 0.75325 | valid_balanced_accuracy: 0.68849 | valid_accuracy: 0.68854 |  0:15:28s
epoch 53 | loss: 0.55062 | train_auc: 0.79571 | train_balanced_accuracy: 0.71858 | train_accuracy: 0.71875 | valid_auc: 0.75162 | valid_balanced_accuracy: 0.69104 | valid_accuracy: 0.69122 |  0:15:46s
epoch 54 | loss: 0.54688 | train_auc: 0.7967  | train_balanced_accuracy: 0.71873 | train_accuracy: 0.71883 | valid_auc: 0.75237 | valid_balanced_accuracy: 0.68681 | valid_accuracy: 0.68697 |  0:16:04s
epoch 55 | loss: 0.55525 | train_auc: 0.79798 | train_balanced_accuracy: 0.71843 | train_accuracy: 0.71883 | valid_auc: 0.74841 | valid_balanced_accuracy: 0.67883 | valid_accuracy: 0.67926 |  0:16:22s
epoch 56 | loss: 0.55042 | train_auc: 0.80372 | train_balanced_accuracy: 0.72527 | train_accuracy: 0.72536 | valid_auc: 0.75402 | valid_balanced_accuracy: 0.68484 | valid_accuracy: 0.68492 |  0:16:39s
epoch 57 | loss: 0.54548 | train_auc: 0.80001 | train_balanced_accuracy: 0.72172 | train_accuracy: 0.72174 | valid_auc: 0.75161 | valid_balanced_accuracy: 0.68698 | valid_accuracy: 0.68697 |  0:16:57s
epoch 58 | loss: 0.54738 | train_auc: 0.8011  | train_balanced_accuracy: 0.72411 | train_accuracy: 0.72434 | valid_auc: 0.74966 | valid_balanced_accuracy: 0.68142 | valid_accuracy: 0.68162 |  0:17:14s
epoch 59 | loss: 0.54785 | train_auc: 0.79676 | train_balanced_accuracy: 0.71794 | train_accuracy: 0.718   | valid_auc: 0.74525 | valid_balanced_accuracy: 0.6778  | valid_accuracy: 0.67784 |  0:17:32s
epoch 60 | loss: 0.55015 | train_auc: 0.80383 | train_balanced_accuracy: 0.72635 | train_accuracy: 0.7265  | valid_auc: 0.75109 | valid_balanced_accuracy: 0.68614 | valid_accuracy: 0.68634 |  0:17:51s
epoch 61 | loss: 0.54763 | train_auc: 0.80508 | train_balanced_accuracy: 0.72364 | train_accuracy: 0.7239  | valid_auc: 0.7525  | valid_balanced_accuracy: 0.6879  | valid_accuracy: 0.68823 |  0:18:10s
epoch 62 | loss: 0.54548 | train_auc: 0.80559 | train_balanced_accuracy: 0.72287 | train_accuracy: 0.72296 | valid_auc: 0.75578 | valid_balanced_accuracy: 0.68762 | valid_accuracy: 0.68776 |  0:18:28s
epoch 63 | loss: 0.54606 | train_auc: 0.80605 | train_balanced_accuracy: 0.72417 | train_accuracy: 0.72453 | valid_auc: 0.75099 | valid_balanced_accuracy: 0.68356 | valid_accuracy: 0.68398 |  0:18:44s
epoch 64 | loss: 0.54021 | train_auc: 0.80809 | train_balanced_accuracy: 0.72683 | train_accuracy: 0.72689 | valid_auc: 0.7521  | valid_balanced_accuracy: 0.68498 | valid_accuracy: 0.68508 |  0:19:03s
epoch 65 | loss: 0.54208 | train_auc: 0.80519 | train_balanced_accuracy: 0.72449 | train_accuracy: 0.72469 | valid_auc: 0.75047 | valid_balanced_accuracy: 0.68487 | valid_accuracy: 0.68508 |  0:19:19s
epoch 66 | loss: 0.53909 | train_auc: 0.80917 | train_balanced_accuracy: 0.72764 | train_accuracy: 0.7276  | valid_auc: 0.75296 | valid_balanced_accuracy: 0.68371 | valid_accuracy: 0.68366 |  0:19:36s
epoch 67 | loss: 0.54053 | train_auc: 0.80428 | train_balanced_accuracy: 0.72252 | train_accuracy: 0.723   | valid_auc: 0.74602 | valid_balanced_accuracy: 0.67864 | valid_accuracy: 0.6791  |  0:19:52s
epoch 68 | loss: 0.54724 | train_auc: 0.7988  | train_balanced_accuracy: 0.72157 | train_accuracy: 0.7219  | valid_auc: 0.74778 | valid_balanced_accuracy: 0.689   | valid_accuracy: 0.68933 |  0:20:09s
epoch 69 | loss: 0.54471 | train_auc: 0.80649 | train_balanced_accuracy: 0.72451 | train_accuracy: 0.72453 | valid_auc: 0.74694 | valid_balanced_accuracy: 0.68555 | valid_accuracy: 0.68555 |  0:20:26s
epoch 70 | loss: 0.53675 | train_auc: 0.80547 | train_balanced_accuracy: 0.72405 | train_accuracy: 0.72414 | valid_auc: 0.74796 | valid_balanced_accuracy: 0.67919 | valid_accuracy: 0.67926 |  0:20:42s
epoch 71 | loss: 0.54214 | train_auc: 0.8067  | train_balanced_accuracy: 0.7292  | train_accuracy: 0.72937 | valid_auc: 0.75155 | valid_balanced_accuracy: 0.68413 | valid_accuracy: 0.68429 |  0:20:58s
epoch 72 | loss: 0.5403  | train_auc: 0.81123 | train_balanced_accuracy: 0.7305  | train_accuracy: 0.73071 | valid_auc: 0.75609 | valid_balanced_accuracy: 0.69101 | valid_accuracy: 0.69122 |  0:21:16s
epoch 73 | loss: 0.53644 | train_auc: 0.81332 | train_balanced_accuracy: 0.73002 | train_accuracy: 0.72992 | valid_auc: 0.75164 | valid_balanced_accuracy: 0.6857  | valid_accuracy: 0.68555 |  0:21:34s

Early stopping occurred at epoch 73 with best_epoch = 53 and best_valid_accuracy = 0.69122
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 68/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.701 total time=21.7min
[CV 2/5; 68/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71534 | train_auc: 0.58599 | train_balanced_accuracy: 0.55422 | train_accuracy: 0.55267 | valid_auc: 0.59088 | valid_balanced_accuracy: 0.55535 | valid_accuracy: 0.55382 |  0:00:16s
epoch 1  | loss: 0.65461 | train_auc: 0.62322 | train_balanced_accuracy: 0.56718 | train_accuracy: 0.56494 | valid_auc: 0.62211 | valid_balanced_accuracy: 0.56116 | valid_accuracy: 0.55886 |  0:00:34s
epoch 2  | loss: 0.63874 | train_auc: 0.64348 | train_balanced_accuracy: 0.53412 | train_accuracy: 0.5311  | valid_auc: 0.63653 | valid_balanced_accuracy: 0.5344  | valid_accuracy: 0.53132 |  0:00:51s
epoch 3  | loss: 0.62366 | train_auc: 0.67087 | train_balanced_accuracy: 0.57163 | train_accuracy: 0.56915 | valid_auc: 0.66551 | valid_balanced_accuracy: 0.56709 | valid_accuracy: 0.56453 |  0:01:07s
epoch 4  | loss: 0.61152 | train_auc: 0.67048 | train_balanced_accuracy: 0.55447 | train_accuracy: 0.55184 | valid_auc: 0.66233 | valid_balanced_accuracy: 0.54801 | valid_accuracy: 0.54533 |  0:01:24s
epoch 5  | loss: 0.61259 | train_auc: 0.6834  | train_balanced_accuracy: 0.60678 | train_accuracy: 0.60512 | valid_auc: 0.67573 | valid_balanced_accuracy: 0.5973  | valid_accuracy: 0.59553 |  0:01:43s
epoch 6  | loss: 0.60811 | train_auc: 0.69534 | train_balanced_accuracy: 0.59014 | train_accuracy: 0.58808 | valid_auc: 0.68815 | valid_balanced_accuracy: 0.58182 | valid_accuracy: 0.57963 |  0:02:00s
epoch 7  | loss: 0.60384 | train_auc: 0.69022 | train_balanced_accuracy: 0.61748 | train_accuracy: 0.61613 | valid_auc: 0.68488 | valid_balanced_accuracy: 0.61253 | valid_accuracy: 0.61111 |  0:02:17s
epoch 8  | loss: 0.59463 | train_auc: 0.69667 | train_balanced_accuracy: 0.6397  | train_accuracy: 0.63919 | valid_auc: 0.68807 | valid_balanced_accuracy: 0.63227 | valid_accuracy: 0.63173 |  0:02:33s
epoch 9  | loss: 0.59906 | train_auc: 0.70908 | train_balanced_accuracy: 0.62138 | train_accuracy: 0.61987 | valid_auc: 0.69792 | valid_balanced_accuracy: 0.60626 | valid_accuracy: 0.60466 |  0:02:50s
epoch 10 | loss: 0.58637 | train_auc: 0.71326 | train_balanced_accuracy: 0.64915 | train_accuracy: 0.64844 | valid_auc: 0.70153 | valid_balanced_accuracy: 0.63704 | valid_accuracy: 0.63629 |  0:03:06s
epoch 11 | loss: 0.59098 | train_auc: 0.71857 | train_balanced_accuracy: 0.64601 | train_accuracy: 0.64517 | valid_auc: 0.70751 | valid_balanced_accuracy: 0.63419 | valid_accuracy: 0.6333  |  0:03:23s
epoch 12 | loss: 0.58974 | train_auc: 0.71611 | train_balanced_accuracy: 0.6369  | train_accuracy: 0.63592 | valid_auc: 0.70155 | valid_balanced_accuracy: 0.62064 | valid_accuracy: 0.61961 |  0:03:40s
epoch 13 | loss: 0.5858  | train_auc: 0.73023 | train_balanced_accuracy: 0.66177 | train_accuracy: 0.66114 | valid_auc: 0.71877 | valid_balanced_accuracy: 0.64878 | valid_accuracy: 0.6481  |  0:03:58s
epoch 14 | loss: 0.58641 | train_auc: 0.72862 | train_balanced_accuracy: 0.6504  | train_accuracy: 0.6495  | valid_auc: 0.71272 | valid_balanced_accuracy: 0.63472 | valid_accuracy: 0.63377 |  0:04:16s
epoch 15 | loss: 0.58421 | train_auc: 0.73642 | train_balanced_accuracy: 0.66855 | train_accuracy: 0.66815 | valid_auc: 0.72099 | valid_balanced_accuracy: 0.65471 | valid_accuracy: 0.65423 |  0:04:35s
epoch 16 | loss: 0.58193 | train_auc: 0.74527 | train_balanced_accuracy: 0.67273 | train_accuracy: 0.67224 | valid_auc: 0.72897 | valid_balanced_accuracy: 0.65759 | valid_accuracy: 0.65707 |  0:04:52s
epoch 17 | loss: 0.5802  | train_auc: 0.74797 | train_balanced_accuracy: 0.68281 | train_accuracy: 0.6829  | valid_auc: 0.73001 | valid_balanced_accuracy: 0.67113 | valid_accuracy: 0.67123 |  0:05:10s
epoch 18 | loss: 0.57903 | train_auc: 0.75308 | train_balanced_accuracy: 0.6955  | train_accuracy: 0.69577 | valid_auc: 0.73687 | valid_balanced_accuracy: 0.67923 | valid_accuracy: 0.67941 |  0:05:29s
epoch 19 | loss: 0.57942 | train_auc: 0.76254 | train_balanced_accuracy: 0.69665 | train_accuracy: 0.69679 | valid_auc: 0.74131 | valid_balanced_accuracy: 0.68025 | valid_accuracy: 0.68036 |  0:05:47s
epoch 20 | loss: 0.57727 | train_auc: 0.76364 | train_balanced_accuracy: 0.69966 | train_accuracy: 0.70006 | valid_auc: 0.74603 | valid_balanced_accuracy: 0.69055 | valid_accuracy: 0.6909  |  0:06:04s
epoch 21 | loss: 0.57531 | train_auc: 0.76862 | train_balanced_accuracy: 0.70121 | train_accuracy: 0.70128 | valid_auc: 0.74836 | valid_balanced_accuracy: 0.68082 | valid_accuracy: 0.68083 |  0:06:21s
epoch 22 | loss: 0.58035 | train_auc: 0.76738 | train_balanced_accuracy: 0.6974  | train_accuracy: 0.69758 | valid_auc: 0.74185 | valid_balanced_accuracy: 0.68042 | valid_accuracy: 0.68052 |  0:06:38s
epoch 23 | loss: 0.5768  | train_auc: 0.77219 | train_balanced_accuracy: 0.70328 | train_accuracy: 0.70376 | valid_auc: 0.74983 | valid_balanced_accuracy: 0.68416 | valid_accuracy: 0.68461 |  0:06:57s
epoch 24 | loss: 0.57707 | train_auc: 0.77722 | train_balanced_accuracy: 0.70872 | train_accuracy: 0.70903 | valid_auc: 0.75248 | valid_balanced_accuracy: 0.68607 | valid_accuracy: 0.68634 |  0:07:12s
epoch 25 | loss: 0.56803 | train_auc: 0.77828 | train_balanced_accuracy: 0.70726 | train_accuracy: 0.70722 | valid_auc: 0.75276 | valid_balanced_accuracy: 0.68898 | valid_accuracy: 0.68886 |  0:07:31s
epoch 26 | loss: 0.56994 | train_auc: 0.77662 | train_balanced_accuracy: 0.70787 | train_accuracy: 0.70801 | valid_auc: 0.75206 | valid_balanced_accuracy: 0.68546 | valid_accuracy: 0.68555 |  0:07:47s
epoch 27 | loss: 0.57244 | train_auc: 0.78031 | train_balanced_accuracy: 0.70987 | train_accuracy: 0.71017 | valid_auc: 0.75235 | valid_balanced_accuracy: 0.68642 | valid_accuracy: 0.68665 |  0:08:03s
epoch 28 | loss: 0.56764 | train_auc: 0.78155 | train_balanced_accuracy: 0.71151 | train_accuracy: 0.71159 | valid_auc: 0.75708 | valid_balanced_accuracy: 0.69219 | valid_accuracy: 0.69216 |  0:08:20s
epoch 29 | loss: 0.56613 | train_auc: 0.78108 | train_balanced_accuracy: 0.71089 | train_accuracy: 0.71115 | valid_auc: 0.75371 | valid_balanced_accuracy: 0.6885  | valid_accuracy: 0.6887  |  0:08:37s
epoch 30 | loss: 0.56344 | train_auc: 0.78561 | train_balanced_accuracy: 0.71367 | train_accuracy: 0.71399 | valid_auc: 0.76011 | valid_balanced_accuracy: 0.6933  | valid_accuracy: 0.69358 |  0:08:53s
epoch 31 | loss: 0.56735 | train_auc: 0.75259 | train_balanced_accuracy: 0.69228 | train_accuracy: 0.69235 | valid_auc: 0.73184 | valid_balanced_accuracy: 0.67186 | valid_accuracy: 0.67186 |  0:09:10s
epoch 32 | loss: 0.56581 | train_auc: 0.73285 | train_balanced_accuracy: 0.6812  | train_accuracy: 0.68137 | valid_auc: 0.71859 | valid_balanced_accuracy: 0.67285 | valid_accuracy: 0.67296 |  0:09:28s
epoch 33 | loss: 0.5625  | train_auc: 0.74643 | train_balanced_accuracy: 0.68795 | train_accuracy: 0.68806 | valid_auc: 0.72695 | valid_balanced_accuracy: 0.67308 | valid_accuracy: 0.67312 |  0:09:46s
epoch 34 | loss: 0.56187 | train_auc: 0.75902 | train_balanced_accuracy: 0.69831 | train_accuracy: 0.69821 | valid_auc: 0.72828 | valid_balanced_accuracy: 0.66994 | valid_accuracy: 0.66981 |  0:10:04s
epoch 35 | loss: 0.56252 | train_auc: 0.7656  | train_balanced_accuracy: 0.70034 | train_accuracy: 0.70069 | valid_auc: 0.73943 | valid_balanced_accuracy: 0.68351 | valid_accuracy: 0.68382 |  0:10:21s
epoch 36 | loss: 0.56004 | train_auc: 0.77987 | train_balanced_accuracy: 0.70951 | train_accuracy: 0.70962 | valid_auc: 0.75126 | valid_balanced_accuracy: 0.6858  | valid_accuracy: 0.68587 |  0:10:38s
epoch 37 | loss: 0.56501 | train_auc: 0.78883 | train_balanced_accuracy: 0.71623 | train_accuracy: 0.71647 | valid_auc: 0.75573 | valid_balanced_accuracy: 0.69339 | valid_accuracy: 0.69358 |  0:10:56s
epoch 38 | loss: 0.55846 | train_auc: 0.78398 | train_balanced_accuracy: 0.71182 | train_accuracy: 0.71175 | valid_auc: 0.75038 | valid_balanced_accuracy: 0.68865 | valid_accuracy: 0.68854 |  0:11:13s
epoch 39 | loss: 0.56005 | train_auc: 0.77872 | train_balanced_accuracy: 0.71021 | train_accuracy: 0.71045 | valid_auc: 0.74539 | valid_balanced_accuracy: 0.68443 | valid_accuracy: 0.68461 |  0:11:31s
epoch 40 | loss: 0.56185 | train_auc: 0.78177 | train_balanced_accuracy: 0.71195 | train_accuracy: 0.7121  | valid_auc: 0.74785 | valid_balanced_accuracy: 0.68517 | valid_accuracy: 0.68524 |  0:11:49s
epoch 41 | loss: 0.55678 | train_auc: 0.7735  | train_balanced_accuracy: 0.70404 | train_accuracy: 0.70407 | valid_auc: 0.7446  | valid_balanced_accuracy: 0.68353 | valid_accuracy: 0.68351 |  0:12:06s
epoch 42 | loss: 0.553   | train_auc: 0.76643 | train_balanced_accuracy: 0.70249 | train_accuracy: 0.70273 | valid_auc: 0.73837 | valid_balanced_accuracy: 0.67939 | valid_accuracy: 0.67957 |  0:12:23s
epoch 43 | loss: 0.56135 | train_auc: 0.78268 | train_balanced_accuracy: 0.71329 | train_accuracy: 0.71355 | valid_auc: 0.75253 | valid_balanced_accuracy: 0.69162 | valid_accuracy: 0.69185 |  0:12:39s
epoch 44 | loss: 0.55621 | train_auc: 0.78004 | train_balanced_accuracy: 0.70982 | train_accuracy: 0.70982 | valid_auc: 0.74779 | valid_balanced_accuracy: 0.68119 | valid_accuracy: 0.68115 |  0:12:57s
epoch 45 | loss: 0.55079 | train_auc: 0.78794 | train_balanced_accuracy: 0.71613 | train_accuracy: 0.71643 | valid_auc: 0.75103 | valid_balanced_accuracy: 0.69079 | valid_accuracy: 0.69106 |  0:13:14s
epoch 46 | loss: 0.55358 | train_auc: 0.79506 | train_balanced_accuracy: 0.71926 | train_accuracy: 0.7193  | valid_auc: 0.75435 | valid_balanced_accuracy: 0.69094 | valid_accuracy: 0.6909  |  0:13:31s
epoch 47 | loss: 0.55479 | train_auc: 0.79373 | train_balanced_accuracy: 0.71832 | train_accuracy: 0.71871 | valid_auc: 0.75899 | valid_balanced_accuracy: 0.69339 | valid_accuracy: 0.69374 |  0:13:46s
epoch 48 | loss: 0.54904 | train_auc: 0.79576 | train_balanced_accuracy: 0.72003 | train_accuracy: 0.72005 | valid_auc: 0.75201 | valid_balanced_accuracy: 0.6886  | valid_accuracy: 0.68854 |  0:14:03s
epoch 49 | loss: 0.55032 | train_auc: 0.79315 | train_balanced_accuracy: 0.71808 | train_accuracy: 0.7182  | valid_auc: 0.75103 | valid_balanced_accuracy: 0.6861  | valid_accuracy: 0.68618 |  0:14:21s
epoch 50 | loss: 0.54979 | train_auc: 0.79687 | train_balanced_accuracy: 0.72284 | train_accuracy: 0.72296 | valid_auc: 0.7569  | valid_balanced_accuracy: 0.69473 | valid_accuracy: 0.69484 |  0:14:39s
epoch 51 | loss: 0.55331 | train_auc: 0.78898 | train_balanced_accuracy: 0.71655 | train_accuracy: 0.71678 | valid_auc: 0.75817 | valid_balanced_accuracy: 0.69371 | valid_accuracy: 0.69389 |  0:14:56s
epoch 52 | loss: 0.54773 | train_auc: 0.80268 | train_balanced_accuracy: 0.72588 | train_accuracy: 0.72595 | valid_auc: 0.75722 | valid_balanced_accuracy: 0.69153 | valid_accuracy: 0.69153 |  0:15:13s
epoch 53 | loss: 0.54878 | train_auc: 0.80021 | train_balanced_accuracy: 0.72449 | train_accuracy: 0.72469 | valid_auc: 0.75524 | valid_balanced_accuracy: 0.69121 | valid_accuracy: 0.69138 |  0:15:30s
epoch 54 | loss: 0.55097 | train_auc: 0.79299 | train_balanced_accuracy: 0.71718 | train_accuracy: 0.71745 | valid_auc: 0.75976 | valid_balanced_accuracy: 0.69255 | valid_accuracy: 0.69279 |  0:15:48s
epoch 55 | loss: 0.55311 | train_auc: 0.79748 | train_balanced_accuracy: 0.72347 | train_accuracy: 0.72379 | valid_auc: 0.75626 | valid_balanced_accuracy: 0.69422 | valid_accuracy: 0.69452 |  0:16:05s
epoch 56 | loss: 0.54549 | train_auc: 0.77999 | train_balanced_accuracy: 0.70398 | train_accuracy: 0.70451 | valid_auc: 0.75064 | valid_balanced_accuracy: 0.67953 | valid_accuracy: 0.68004 |  0:16:22s
epoch 57 | loss: 0.54712 | train_auc: 0.77753 | train_balanced_accuracy: 0.70341 | train_accuracy: 0.70348 | valid_auc: 0.73697 | valid_balanced_accuracy: 0.67135 | valid_accuracy: 0.67139 |  0:16:39s
epoch 58 | loss: 0.54414 | train_auc: 0.76379 | train_balanced_accuracy: 0.68994 | train_accuracy: 0.69038 | valid_auc: 0.73858 | valid_balanced_accuracy: 0.67034 | valid_accuracy: 0.67076 |  0:16:56s
epoch 59 | loss: 0.54437 | train_auc: 0.79877 | train_balanced_accuracy: 0.72479 | train_accuracy: 0.72497 | valid_auc: 0.74968 | valid_balanced_accuracy: 0.68529 | valid_accuracy: 0.6854  |  0:17:14s
epoch 60 | loss: 0.5422  | train_auc: 0.74442 | train_balanced_accuracy: 0.68358 | train_accuracy: 0.68389 | valid_auc: 0.7202  | valid_balanced_accuracy: 0.66937 | valid_accuracy: 0.66966 |  0:17:31s
epoch 61 | loss: 0.54047 | train_auc: 0.72852 | train_balanced_accuracy: 0.67519 | train_accuracy: 0.67562 | valid_auc: 0.71333 | valid_balanced_accuracy: 0.65777 | valid_accuracy: 0.65817 |  0:17:49s
epoch 62 | loss: 0.54301 | train_auc: 0.74038 | train_balanced_accuracy: 0.68298 | train_accuracy: 0.68283 | valid_auc: 0.71222 | valid_balanced_accuracy: 0.66446 | valid_accuracy: 0.66431 |  0:18:07s
epoch 63 | loss: 0.54748 | train_auc: 0.77522 | train_balanced_accuracy: 0.70546 | train_accuracy: 0.70561 | valid_auc: 0.73848 | valid_balanced_accuracy: 0.68003 | valid_accuracy: 0.6802  |  0:18:24s
epoch 64 | loss: 0.54127 | train_auc: 0.78091 | train_balanced_accuracy: 0.70893 | train_accuracy: 0.70891 | valid_auc: 0.73952 | valid_balanced_accuracy: 0.6796  | valid_accuracy: 0.67957 |  0:18:42s
epoch 65 | loss: 0.53781 | train_auc: 0.80206 | train_balanced_accuracy: 0.72728 | train_accuracy: 0.72748 | valid_auc: 0.7533  | valid_balanced_accuracy: 0.69075 | valid_accuracy: 0.6909  |  0:18:59s
epoch 66 | loss: 0.54198 | train_auc: 0.80142 | train_balanced_accuracy: 0.72586 | train_accuracy: 0.72587 | valid_auc: 0.75603 | valid_balanced_accuracy: 0.68857 | valid_accuracy: 0.68854 |  0:19:16s
epoch 67 | loss: 0.5394  | train_auc: 0.80357 | train_balanced_accuracy: 0.72706 | train_accuracy: 0.72741 | valid_auc: 0.75609 | valid_balanced_accuracy: 0.68933 | valid_accuracy: 0.68964 |  0:19:33s
epoch 68 | loss: 0.54278 | train_auc: 0.80625 | train_balanced_accuracy: 0.73055 | train_accuracy: 0.73087 | valid_auc: 0.76281 | valid_balanced_accuracy: 0.69629 | valid_accuracy: 0.69657 |  0:19:51s
epoch 69 | loss: 0.53907 | train_auc: 0.80923 | train_balanced_accuracy: 0.73148 | train_accuracy: 0.73158 | valid_auc: 0.76107 | valid_balanced_accuracy: 0.69333 | valid_accuracy: 0.69342 |  0:20:08s
epoch 70 | loss: 0.53772 | train_auc: 0.80293 | train_balanced_accuracy: 0.72523 | train_accuracy: 0.72552 | valid_auc: 0.75694 | valid_balanced_accuracy: 0.68716 | valid_accuracy: 0.68744 |  0:20:25s
epoch 71 | loss: 0.54274 | train_auc: 0.80167 | train_balanced_accuracy: 0.72403 | train_accuracy: 0.7241  | valid_auc: 0.75542 | valid_balanced_accuracy: 0.69072 | valid_accuracy: 0.69075 |  0:20:43s
epoch 72 | loss: 0.53613 | train_auc: 0.80632 | train_balanced_accuracy: 0.72602 | train_accuracy: 0.72638 | valid_auc: 0.7622  | valid_balanced_accuracy: 0.69248 | valid_accuracy: 0.69279 |  0:21:00s
epoch 73 | loss: 0.5349  | train_auc: 0.80785 | train_balanced_accuracy: 0.7286  | train_accuracy: 0.72874 | valid_auc: 0.75978 | valid_balanced_accuracy: 0.68703 | valid_accuracy: 0.68713 |  0:21:18s
epoch 74 | loss: 0.53771 | train_auc: 0.80975 | train_balanced_accuracy: 0.73037 | train_accuracy: 0.73087 | valid_auc: 0.75743 | valid_balanced_accuracy: 0.6854  | valid_accuracy: 0.68587 |  0:21:33s
epoch 75 | loss: 0.53432 | train_auc: 0.81737 | train_balanced_accuracy: 0.73655 | train_accuracy: 0.73673 | valid_auc: 0.76256 | valid_balanced_accuracy: 0.69373 | valid_accuracy: 0.69389 |  0:21:50s
epoch 76 | loss: 0.53938 | train_auc: 0.8068  | train_balanced_accuracy: 0.72816 | train_accuracy: 0.72819 | valid_auc: 0.75814 | valid_balanced_accuracy: 0.68983 | valid_accuracy: 0.6898  |  0:22:07s
epoch 77 | loss: 0.53316 | train_auc: 0.81065 | train_balanced_accuracy: 0.73141 | train_accuracy: 0.73142 | valid_auc: 0.76318 | valid_balanced_accuracy: 0.69046 | valid_accuracy: 0.69043 |  0:22:23s
epoch 78 | loss: 0.5316  | train_auc: 0.81565 | train_balanced_accuracy: 0.73705 | train_accuracy: 0.73708 | valid_auc: 0.75889 | valid_balanced_accuracy: 0.6898  | valid_accuracy: 0.6898  |  0:22:41s
epoch 79 | loss: 0.53404 | train_auc: 0.81147 | train_balanced_accuracy: 0.72991 | train_accuracy: 0.72996 | valid_auc: 0.76032 | valid_balanced_accuracy: 0.69247 | valid_accuracy: 0.69248 |  0:22:57s
epoch 80 | loss: 0.53461 | train_auc: 0.81143 | train_balanced_accuracy: 0.73167 | train_accuracy: 0.73177 | valid_auc: 0.75547 | valid_balanced_accuracy: 0.68355 | valid_accuracy: 0.68366 |  0:23:13s
epoch 81 | loss: 0.53088 | train_auc: 0.81642 | train_balanced_accuracy: 0.73748 | train_accuracy: 0.73764 | valid_auc: 0.75623 | valid_balanced_accuracy: 0.68369 | valid_accuracy: 0.68382 |  0:23:32s
epoch 82 | loss: 0.5343  | train_auc: 0.81165 | train_balanced_accuracy: 0.73124 | train_accuracy: 0.7315  | valid_auc: 0.75409 | valid_balanced_accuracy: 0.68231 | valid_accuracy: 0.68256 |  0:23:50s
epoch 83 | loss: 0.53124 | train_auc: 0.8193  | train_balanced_accuracy: 0.739   | train_accuracy: 0.73917 | valid_auc: 0.75958 | valid_balanced_accuracy: 0.69262 | valid_accuracy: 0.69279 |  0:24:08s
epoch 84 | loss: 0.53419 | train_auc: 0.81758 | train_balanced_accuracy: 0.73673 | train_accuracy: 0.73701 | valid_auc: 0.76518 | valid_balanced_accuracy: 0.69657 | valid_accuracy: 0.69688 |  0:24:26s
epoch 85 | loss: 0.52749 | train_auc: 0.81079 | train_balanced_accuracy: 0.73169 | train_accuracy: 0.73197 | valid_auc: 0.75459 | valid_balanced_accuracy: 0.68715 | valid_accuracy: 0.68744 |  0:24:43s
epoch 86 | loss: 0.53418 | train_auc: 0.81525 | train_balanced_accuracy: 0.73527 | train_accuracy: 0.73535 | valid_auc: 0.75766 | valid_balanced_accuracy: 0.68912 | valid_accuracy: 0.68917 |  0:25:00s
epoch 87 | loss: 0.52893 | train_auc: 0.82264 | train_balanced_accuracy: 0.74168 | train_accuracy: 0.74181 | valid_auc: 0.76373 | valid_balanced_accuracy: 0.6941  | valid_accuracy: 0.69421 |  0:25:18s
epoch 88 | loss: 0.53114 | train_auc: 0.81973 | train_balanced_accuracy: 0.73807 | train_accuracy: 0.73811 | valid_auc: 0.7613  | valid_balanced_accuracy: 0.69116 | valid_accuracy: 0.69122 |  0:25:35s
epoch 89 | loss: 0.53558 | train_auc: 0.8158  | train_balanced_accuracy: 0.73619 | train_accuracy: 0.73642 | valid_auc: 0.75732 | valid_balanced_accuracy: 0.69054 | valid_accuracy: 0.69075 |  0:25:52s
epoch 90 | loss: 0.53014 | train_auc: 0.81924 | train_balanced_accuracy: 0.73905 | train_accuracy: 0.73917 | valid_auc: 0.76328 | valid_balanced_accuracy: 0.69349 | valid_accuracy: 0.69358 |  0:26:09s
epoch 91 | loss: 0.52352 | train_auc: 0.82338 | train_balanced_accuracy: 0.7438  | train_accuracy: 0.74389 | valid_auc: 0.76116 | valid_balanced_accuracy: 0.69558 | valid_accuracy: 0.69562 |  0:26:26s
epoch 92 | loss: 0.52586 | train_auc: 0.81743 | train_balanced_accuracy: 0.73714 | train_accuracy: 0.7372  | valid_auc: 0.75547 | valid_balanced_accuracy: 0.68767 | valid_accuracy: 0.68776 |  0:26:46s
epoch 93 | loss: 0.52329 | train_auc: 0.76119 | train_balanced_accuracy: 0.69295 | train_accuracy: 0.69321 | valid_auc: 0.7227  | valid_balanced_accuracy: 0.67034 | valid_accuracy: 0.6706  |  0:27:03s
epoch 94 | loss: 0.52419 | train_auc: 0.79447 | train_balanced_accuracy: 0.71718 | train_accuracy: 0.71729 | valid_auc: 0.7409  | valid_balanced_accuracy: 0.67678 | valid_accuracy: 0.6769  |  0:27:21s
epoch 95 | loss: 0.52481 | train_auc: 0.80862 | train_balanced_accuracy: 0.72918 | train_accuracy: 0.72933 | valid_auc: 0.74716 | valid_balanced_accuracy: 0.68255 | valid_accuracy: 0.68272 |  0:27:40s
epoch 96 | loss: 0.52317 | train_auc: 0.81663 | train_balanced_accuracy: 0.73426 | train_accuracy: 0.73445 | valid_auc: 0.7573  | valid_balanced_accuracy: 0.69164 | valid_accuracy: 0.69185 |  0:27:58s
epoch 97 | loss: 0.52042 | train_auc: 0.82269 | train_balanced_accuracy: 0.74045 | train_accuracy: 0.74074 | valid_auc: 0.76404 | valid_balanced_accuracy: 0.6925  | valid_accuracy: 0.69279 |  0:28:14s
epoch 98 | loss: 0.5206  | train_auc: 0.81652 | train_balanced_accuracy: 0.73514 | train_accuracy: 0.73535 | valid_auc: 0.76122 | valid_balanced_accuracy: 0.69292 | valid_accuracy: 0.69311 |  0:28:32s
epoch 99 | loss: 0.52544 | train_auc: 0.81782 | train_balanced_accuracy: 0.73711 | train_accuracy: 0.73705 | valid_auc: 0.76089 | valid_balanced_accuracy: 0.69053 | valid_accuracy: 0.69043 |  0:28:50s
epoch 100| loss: 0.52451 | train_auc: 0.81381 | train_balanced_accuracy: 0.73283 | train_accuracy: 0.73307 | valid_auc: 0.7546  | valid_balanced_accuracy: 0.68685 | valid_accuracy: 0.68713 |  0:29:07s
epoch 101| loss: 0.51919 | train_auc: 0.8096  | train_balanced_accuracy: 0.72776 | train_accuracy: 0.72788 | valid_auc: 0.75593 | valid_balanced_accuracy: 0.68085 | valid_accuracy: 0.68099 |  0:29:23s
epoch 102| loss: 0.51945 | train_auc: 0.82218 | train_balanced_accuracy: 0.74144 | train_accuracy: 0.74149 | valid_auc: 0.75747 | valid_balanced_accuracy: 0.69135 | valid_accuracy: 0.69138 |  0:29:40s
epoch 103| loss: 0.52496 | train_auc: 0.8244  | train_balanced_accuracy: 0.74342 | train_accuracy: 0.74362 | valid_auc: 0.75376 | valid_balanced_accuracy: 0.68897 | valid_accuracy: 0.68917 |  0:29:57s
epoch 104| loss: 0.52964 | train_auc: 0.81417 | train_balanced_accuracy: 0.73551 | train_accuracy: 0.73551 | valid_auc: 0.74929 | valid_balanced_accuracy: 0.68461 | valid_accuracy: 0.68461 |  0:30:15s

Early stopping occurred at epoch 104 with best_epoch = 84 and best_valid_accuracy = 0.69688
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 68/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.685 total time=30.4min
[CV 3/5; 68/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71098 | train_auc: 0.60182 | train_balanced_accuracy: 0.49992 | train_accuracy: 0.49634 | valid_auc: 0.60844 | valid_balanced_accuracy: 0.50047 | valid_accuracy: 0.49685 |  0:00:17s
epoch 1  | loss: 0.64651 | train_auc: 0.63597 | train_balanced_accuracy: 0.51396 | train_accuracy: 0.51054 | valid_auc: 0.63627 | valid_balanced_accuracy: 0.51556 | valid_accuracy: 0.51212 |  0:00:33s
epoch 2  | loss: 0.62747 | train_auc: 0.65055 | train_balanced_accuracy: 0.56549 | train_accuracy: 0.56287 | valid_auc: 0.64916 | valid_balanced_accuracy: 0.56102 | valid_accuracy: 0.55839 |  0:00:52s
epoch 3  | loss: 0.621   | train_auc: 0.66487 | train_balanced_accuracy: 0.57652 | train_accuracy: 0.57405 | valid_auc: 0.66513 | valid_balanced_accuracy: 0.57332 | valid_accuracy: 0.57082 |  0:01:11s
epoch 4  | loss: 0.61275 | train_auc: 0.67095 | train_balanced_accuracy: 0.58597 | train_accuracy: 0.58369 | valid_auc: 0.66713 | valid_balanced_accuracy: 0.58067 | valid_accuracy: 0.57838 |  0:01:30s
epoch 5  | loss: 0.60998 | train_auc: 0.67976 | train_balanced_accuracy: 0.59134 | train_accuracy: 0.58916 | valid_auc: 0.66997 | valid_balanced_accuracy: 0.58402 | valid_accuracy: 0.58184 |  0:01:47s
epoch 6  | loss: 0.60688 | train_auc: 0.69207 | train_balanced_accuracy: 0.61984 | train_accuracy: 0.61851 | valid_auc: 0.68678 | valid_balanced_accuracy: 0.61482 | valid_accuracy: 0.61347 |  0:02:05s
epoch 7  | loss: 0.60868 | train_auc: 0.69368 | train_balanced_accuracy: 0.61712 | train_accuracy: 0.6156  | valid_auc: 0.6873  | valid_balanced_accuracy: 0.61138 | valid_accuracy: 0.60985 |  0:02:22s
epoch 8  | loss: 0.59802 | train_auc: 0.70443 | train_balanced_accuracy: 0.64468 | train_accuracy: 0.644   | valid_auc: 0.70022 | valid_balanced_accuracy: 0.63952 | valid_accuracy: 0.63881 |  0:02:38s
epoch 9  | loss: 0.59662 | train_auc: 0.70434 | train_balanced_accuracy: 0.64197 | train_accuracy: 0.64125 | valid_auc: 0.69878 | valid_balanced_accuracy: 0.63421 | valid_accuracy: 0.63346 |  0:02:55s
epoch 10 | loss: 0.58732 | train_auc: 0.71311 | train_balanced_accuracy: 0.64316 | train_accuracy: 0.64227 | valid_auc: 0.70583 | valid_balanced_accuracy: 0.64002 | valid_accuracy: 0.63912 |  0:03:12s
epoch 11 | loss: 0.59128 | train_auc: 0.72174 | train_balanced_accuracy: 0.65445 | train_accuracy: 0.654   | valid_auc: 0.71671 | valid_balanced_accuracy: 0.64932 | valid_accuracy: 0.64888 |  0:03:30s
epoch 12 | loss: 0.59102 | train_auc: 0.72939 | train_balanced_accuracy: 0.66643 | train_accuracy: 0.66651 | valid_auc: 0.72409 | valid_balanced_accuracy: 0.6671  | valid_accuracy: 0.66714 |  0:03:44s
epoch 13 | loss: 0.58692 | train_auc: 0.73205 | train_balanced_accuracy: 0.66747 | train_accuracy: 0.66726 | valid_auc: 0.7276  | valid_balanced_accuracy: 0.66362 | valid_accuracy: 0.66336 |  0:04:01s
epoch 14 | loss: 0.58478 | train_auc: 0.73753 | train_balanced_accuracy: 0.67316 | train_accuracy: 0.67312 | valid_auc: 0.73323 | valid_balanced_accuracy: 0.67552 | valid_accuracy: 0.67548 |  0:04:18s
epoch 15 | loss: 0.58642 | train_auc: 0.74252 | train_balanced_accuracy: 0.67551 | train_accuracy: 0.6754  | valid_auc: 0.73668 | valid_balanced_accuracy: 0.67248 | valid_accuracy: 0.67233 |  0:04:36s
epoch 16 | loss: 0.57944 | train_auc: 0.74505 | train_balanced_accuracy: 0.67755 | train_accuracy: 0.67745 | valid_auc: 0.73967 | valid_balanced_accuracy: 0.67671 | valid_accuracy: 0.67658 |  0:04:52s
epoch 17 | loss: 0.5769  | train_auc: 0.74683 | train_balanced_accuracy: 0.68158 | train_accuracy: 0.68158 | valid_auc: 0.74021 | valid_balanced_accuracy: 0.6766  | valid_accuracy: 0.67658 |  0:05:13s
epoch 18 | loss: 0.58381 | train_auc: 0.7522  | train_balanced_accuracy: 0.68173 | train_accuracy: 0.6824  | valid_auc: 0.74294 | valid_balanced_accuracy: 0.67939 | valid_accuracy: 0.68004 |  0:05:30s
epoch 19 | loss: 0.57961 | train_auc: 0.75508 | train_balanced_accuracy: 0.68732 | train_accuracy: 0.68768 | valid_auc: 0.74415 | valid_balanced_accuracy: 0.68096 | valid_accuracy: 0.6813  |  0:05:48s
epoch 20 | loss: 0.58097 | train_auc: 0.75877 | train_balanced_accuracy: 0.68717 | train_accuracy: 0.68756 | valid_auc: 0.74741 | valid_balanced_accuracy: 0.68475 | valid_accuracy: 0.68508 |  0:06:05s
epoch 21 | loss: 0.57412 | train_auc: 0.76269 | train_balanced_accuracy: 0.69425 | train_accuracy: 0.69468 | valid_auc: 0.7516  | valid_balanced_accuracy: 0.68862 | valid_accuracy: 0.68901 |  0:06:22s
epoch 22 | loss: 0.58107 | train_auc: 0.76276 | train_balanced_accuracy: 0.69511 | train_accuracy: 0.69559 | valid_auc: 0.74999 | valid_balanced_accuracy: 0.68766 | valid_accuracy: 0.68807 |  0:06:39s
epoch 23 | loss: 0.57866 | train_auc: 0.76327 | train_balanced_accuracy: 0.69632 | train_accuracy: 0.69657 | valid_auc: 0.75286 | valid_balanced_accuracy: 0.68896 | valid_accuracy: 0.68917 |  0:06:58s
epoch 24 | loss: 0.57942 | train_auc: 0.76453 | train_balanced_accuracy: 0.69444 | train_accuracy: 0.6948  | valid_auc: 0.74817 | valid_balanced_accuracy: 0.68694 | valid_accuracy: 0.68728 |  0:07:15s
epoch 25 | loss: 0.57317 | train_auc: 0.76485 | train_balanced_accuracy: 0.69706 | train_accuracy: 0.69724 | valid_auc: 0.751   | valid_balanced_accuracy: 0.68417 | valid_accuracy: 0.68429 |  0:07:32s
epoch 26 | loss: 0.5737  | train_auc: 0.7563  | train_balanced_accuracy: 0.68811 | train_accuracy: 0.68862 | valid_auc: 0.74453 | valid_balanced_accuracy: 0.68256 | valid_accuracy: 0.68303 |  0:07:48s
epoch 27 | loss: 0.57197 | train_auc: 0.75961 | train_balanced_accuracy: 0.69668 | train_accuracy: 0.69688 | valid_auc: 0.74545 | valid_balanced_accuracy: 0.6852  | valid_accuracy: 0.6854  |  0:08:05s
epoch 28 | loss: 0.56817 | train_auc: 0.76756 | train_balanced_accuracy: 0.70081 | train_accuracy: 0.70102 | valid_auc: 0.74885 | valid_balanced_accuracy: 0.68158 | valid_accuracy: 0.68178 |  0:08:22s
epoch 29 | loss: 0.56809 | train_auc: 0.77388 | train_balanced_accuracy: 0.70299 | train_accuracy: 0.7033  | valid_auc: 0.7562  | valid_balanced_accuracy: 0.69269 | valid_accuracy: 0.69295 |  0:08:38s
epoch 30 | loss: 0.56786 | train_auc: 0.77725 | train_balanced_accuracy: 0.70598 | train_accuracy: 0.70633 | valid_auc: 0.75359 | valid_balanced_accuracy: 0.68715 | valid_accuracy: 0.68744 |  0:08:55s
epoch 31 | loss: 0.57039 | train_auc: 0.77361 | train_balanced_accuracy: 0.70166 | train_accuracy: 0.70212 | valid_auc: 0.75183 | valid_balanced_accuracy: 0.68848 | valid_accuracy: 0.68886 |  0:09:12s
epoch 32 | loss: 0.5636  | train_auc: 0.78103 | train_balanced_accuracy: 0.709   | train_accuracy: 0.70912 | valid_auc: 0.75484 | valid_balanced_accuracy: 0.69055 | valid_accuracy: 0.69059 |  0:09:29s
epoch 33 | loss: 0.56607 | train_auc: 0.78098 | train_balanced_accuracy: 0.70981 | train_accuracy: 0.71003 | valid_auc: 0.75626 | valid_balanced_accuracy: 0.69156 | valid_accuracy: 0.69169 |  0:09:46s
epoch 34 | loss: 0.56563 | train_auc: 0.78543 | train_balanced_accuracy: 0.70983 | train_accuracy: 0.70999 | valid_auc: 0.75688 | valid_balanced_accuracy: 0.69128 | valid_accuracy: 0.69138 |  0:10:05s
epoch 35 | loss: 0.56361 | train_auc: 0.78503 | train_balanced_accuracy: 0.71227 | train_accuracy: 0.71266 | valid_auc: 0.75639 | valid_balanced_accuracy: 0.69466 | valid_accuracy: 0.695   |  0:10:23s
epoch 36 | loss: 0.56131 | train_auc: 0.78853 | train_balanced_accuracy: 0.71294 | train_accuracy: 0.71305 | valid_auc: 0.76074 | valid_balanced_accuracy: 0.69841 | valid_accuracy: 0.69846 |  0:10:40s
epoch 37 | loss: 0.56403 | train_auc: 0.78832 | train_balanced_accuracy: 0.71614 | train_accuracy: 0.71644 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.69241 | valid_accuracy: 0.69263 |  0:10:56s
epoch 38 | loss: 0.56049 | train_auc: 0.7914  | train_balanced_accuracy: 0.71805 | train_accuracy: 0.71809 | valid_auc: 0.75896 | valid_balanced_accuracy: 0.69265 | valid_accuracy: 0.69263 |  0:11:15s
epoch 39 | loss: 0.55754 | train_auc: 0.78426 | train_balanced_accuracy: 0.70966 | train_accuracy: 0.70987 | valid_auc: 0.75669 | valid_balanced_accuracy: 0.69299 | valid_accuracy: 0.69311 |  0:11:33s
epoch 40 | loss: 0.5608  | train_auc: 0.79014 | train_balanced_accuracy: 0.7164  | train_accuracy: 0.7166  | valid_auc: 0.75991 | valid_balanced_accuracy: 0.69408 | valid_accuracy: 0.69421 |  0:11:49s
epoch 41 | loss: 0.56069 | train_auc: 0.79171 | train_balanced_accuracy: 0.71764 | train_accuracy: 0.71793 | valid_auc: 0.75842 | valid_balanced_accuracy: 0.69461 | valid_accuracy: 0.69484 |  0:12:07s
epoch 42 | loss: 0.55117 | train_auc: 0.79021 | train_balanced_accuracy: 0.71714 | train_accuracy: 0.71734 | valid_auc: 0.75638 | valid_balanced_accuracy: 0.69167 | valid_accuracy: 0.69185 |  0:12:24s
epoch 43 | loss: 0.56091 | train_auc: 0.79342 | train_balanced_accuracy: 0.71717 | train_accuracy: 0.7173  | valid_auc: 0.75714 | valid_balanced_accuracy: 0.68924 | valid_accuracy: 0.68933 |  0:12:44s
epoch 44 | loss: 0.56099 | train_auc: 0.79261 | train_balanced_accuracy: 0.71575 | train_accuracy: 0.71569 | valid_auc: 0.75493 | valid_balanced_accuracy: 0.68519 | valid_accuracy: 0.68508 |  0:13:00s
epoch 45 | loss: 0.55707 | train_auc: 0.794   | train_balanced_accuracy: 0.71854 | train_accuracy: 0.71856 | valid_auc: 0.75688 | valid_balanced_accuracy: 0.69077 | valid_accuracy: 0.69075 |  0:13:19s
epoch 46 | loss: 0.55781 | train_auc: 0.79348 | train_balanced_accuracy: 0.7173  | train_accuracy: 0.71715 | valid_auc: 0.75631 | valid_balanced_accuracy: 0.6883  | valid_accuracy: 0.68807 |  0:13:38s
epoch 47 | loss: 0.55675 | train_auc: 0.79376 | train_balanced_accuracy: 0.7187  | train_accuracy: 0.71915 | valid_auc: 0.75729 | valid_balanced_accuracy: 0.69285 | valid_accuracy: 0.69326 |  0:13:56s
epoch 48 | loss: 0.55788 | train_auc: 0.79759 | train_balanced_accuracy: 0.72423 | train_accuracy: 0.72415 | valid_auc: 0.75751 | valid_balanced_accuracy: 0.68822 | valid_accuracy: 0.68807 |  0:14:15s
epoch 49 | loss: 0.55134 | train_auc: 0.79433 | train_balanced_accuracy: 0.71771 | train_accuracy: 0.71805 | valid_auc: 0.75541 | valid_balanced_accuracy: 0.6881  | valid_accuracy: 0.68839 |  0:14:33s
epoch 50 | loss: 0.55383 | train_auc: 0.79349 | train_balanced_accuracy: 0.71684 | train_accuracy: 0.71703 | valid_auc: 0.75477 | valid_balanced_accuracy: 0.69122 | valid_accuracy: 0.69138 |  0:14:48s
epoch 51 | loss: 0.5495  | train_auc: 0.79947 | train_balanced_accuracy: 0.72265 | train_accuracy: 0.72297 | valid_auc: 0.75922 | valid_balanced_accuracy: 0.69535 | valid_accuracy: 0.69562 |  0:15:05s
epoch 52 | loss: 0.54533 | train_auc: 0.79901 | train_balanced_accuracy: 0.72193 | train_accuracy: 0.72187 | valid_auc: 0.75384 | valid_balanced_accuracy: 0.68649 | valid_accuracy: 0.68634 |  0:15:22s
epoch 53 | loss: 0.54602 | train_auc: 0.79603 | train_balanced_accuracy: 0.71828 | train_accuracy: 0.71821 | valid_auc: 0.7582  | valid_balanced_accuracy: 0.69069 | valid_accuracy: 0.69059 |  0:15:40s
epoch 54 | loss: 0.55257 | train_auc: 0.79975 | train_balanced_accuracy: 0.72434 | train_accuracy: 0.72443 | valid_auc: 0.7598  | valid_balanced_accuracy: 0.69735 | valid_accuracy: 0.69736 |  0:15:57s
epoch 55 | loss: 0.54775 | train_auc: 0.80057 | train_balanced_accuracy: 0.72069 | train_accuracy: 0.72045 | valid_auc: 0.75562 | valid_balanced_accuracy: 0.68549 | valid_accuracy: 0.68524 |  0:16:15s
epoch 56 | loss: 0.54546 | train_auc: 0.80255 | train_balanced_accuracy: 0.72559 | train_accuracy: 0.72549 | valid_auc: 0.76119 | valid_balanced_accuracy: 0.68869 | valid_accuracy: 0.68854 |  0:16:32s

Early stopping occurred at epoch 56 with best_epoch = 36 and best_valid_accuracy = 0.69846
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 68/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.698 total time=16.7min
[CV 4/5; 68/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71729 | train_auc: 0.57104 | train_balanced_accuracy: 0.55132 | train_accuracy: 0.5504  | valid_auc: 0.57187 | valid_balanced_accuracy: 0.55171 | valid_accuracy: 0.55083 |  0:00:17s
epoch 1  | loss: 0.6496  | train_auc: 0.6704  | train_balanced_accuracy: 0.62953 | train_accuracy: 0.63019 | valid_auc: 0.66211 | valid_balanced_accuracy: 0.6205  | valid_accuracy: 0.62118 |  0:00:32s
epoch 2  | loss: 0.62626 | train_auc: 0.69606 | train_balanced_accuracy: 0.63852 | train_accuracy: 0.63944 | valid_auc: 0.69102 | valid_balanced_accuracy: 0.63849 | valid_accuracy: 0.63944 |  0:00:49s
epoch 3  | loss: 0.6202  | train_auc: 0.7089  | train_balanced_accuracy: 0.64494 | train_accuracy: 0.64593 | valid_auc: 0.70624 | valid_balanced_accuracy: 0.64578 | valid_accuracy: 0.64684 |  0:01:06s
epoch 4  | loss: 0.61036 | train_auc: 0.70457 | train_balanced_accuracy: 0.63873 | train_accuracy: 0.63995 | valid_auc: 0.70136 | valid_balanced_accuracy: 0.63674 | valid_accuracy: 0.63802 |  0:01:25s
epoch 5  | loss: 0.6086  | train_auc: 0.70945 | train_balanced_accuracy: 0.64809 | train_accuracy: 0.64916 | valid_auc: 0.70952 | valid_balanced_accuracy: 0.64808 | valid_accuracy: 0.6492  |  0:01:43s
epoch 6  | loss: 0.60509 | train_auc: 0.71051 | train_balanced_accuracy: 0.66015 | train_accuracy: 0.66076 | valid_auc: 0.71172 | valid_balanced_accuracy: 0.65984 | valid_accuracy: 0.66053 |  0:01:59s
epoch 7  | loss: 0.60088 | train_auc: 0.70909 | train_balanced_accuracy: 0.65126 | train_accuracy: 0.65179 | valid_auc: 0.71058 | valid_balanced_accuracy: 0.65257 | valid_accuracy: 0.65313 |  0:02:17s
epoch 8  | loss: 0.59941 | train_auc: 0.71414 | train_balanced_accuracy: 0.65638 | train_accuracy: 0.65659 | valid_auc: 0.71434 | valid_balanced_accuracy: 0.65698 | valid_accuracy: 0.65722 |  0:02:33s
epoch 9  | loss: 0.59519 | train_auc: 0.72002 | train_balanced_accuracy: 0.66075 | train_accuracy: 0.66084 | valid_auc: 0.72021 | valid_balanced_accuracy: 0.66115 | valid_accuracy: 0.66132 |  0:02:49s
epoch 10 | loss: 0.58828 | train_auc: 0.71803 | train_balanced_accuracy: 0.66057 | train_accuracy: 0.66053 | valid_auc: 0.71357 | valid_balanced_accuracy: 0.65829 | valid_accuracy: 0.65833 |  0:03:06s
epoch 11 | loss: 0.58979 | train_auc: 0.72376 | train_balanced_accuracy: 0.6608  | train_accuracy: 0.66108 | valid_auc: 0.71758 | valid_balanced_accuracy: 0.65861 | valid_accuracy: 0.65895 |  0:03:23s
epoch 12 | loss: 0.58628 | train_auc: 0.72692 | train_balanced_accuracy: 0.66441 | train_accuracy: 0.66494 | valid_auc: 0.71924 | valid_balanced_accuracy: 0.6557  | valid_accuracy: 0.65628 |  0:03:40s
epoch 13 | loss: 0.58431 | train_auc: 0.73286 | train_balanced_accuracy: 0.66673 | train_accuracy: 0.66682 | valid_auc: 0.72616 | valid_balanced_accuracy: 0.6645  | valid_accuracy: 0.66462 |  0:03:57s
epoch 14 | loss: 0.58611 | train_auc: 0.73596 | train_balanced_accuracy: 0.67102 | train_accuracy: 0.67139 | valid_auc: 0.72902 | valid_balanced_accuracy: 0.66407 | valid_accuracy: 0.66446 |  0:04:14s
epoch 15 | loss: 0.58691 | train_auc: 0.73952 | train_balanced_accuracy: 0.6722  | train_accuracy: 0.67253 | valid_auc: 0.72843 | valid_balanced_accuracy: 0.66269 | valid_accuracy: 0.66305 |  0:04:31s
epoch 16 | loss: 0.57956 | train_auc: 0.73902 | train_balanced_accuracy: 0.6722  | train_accuracy: 0.67253 | valid_auc: 0.72982 | valid_balanced_accuracy: 0.65952 | valid_accuracy: 0.6599  |  0:04:49s
epoch 17 | loss: 0.57809 | train_auc: 0.74897 | train_balanced_accuracy: 0.67987 | train_accuracy: 0.6804  | valid_auc: 0.73716 | valid_balanced_accuracy: 0.67162 | valid_accuracy: 0.67218 |  0:05:09s
epoch 18 | loss: 0.58302 | train_auc: 0.74953 | train_balanced_accuracy: 0.68127 | train_accuracy: 0.68158 | valid_auc: 0.73153 | valid_balanced_accuracy: 0.66788 | valid_accuracy: 0.66824 |  0:05:27s
epoch 19 | loss: 0.57288 | train_auc: 0.74756 | train_balanced_accuracy: 0.67965 | train_accuracy: 0.68    | valid_auc: 0.7351  | valid_balanced_accuracy: 0.67368 | valid_accuracy: 0.67406 |  0:05:43s
epoch 20 | loss: 0.57392 | train_auc: 0.75106 | train_balanced_accuracy: 0.68067 | train_accuracy: 0.68122 | valid_auc: 0.73692 | valid_balanced_accuracy: 0.6697  | valid_accuracy: 0.67029 |  0:05:59s
epoch 21 | loss: 0.57445 | train_auc: 0.75926 | train_balanced_accuracy: 0.68877 | train_accuracy: 0.68929 | valid_auc: 0.74412 | valid_balanced_accuracy: 0.67387 | valid_accuracy: 0.67438 |  0:06:16s
epoch 22 | loss: 0.57271 | train_auc: 0.76363 | train_balanced_accuracy: 0.69038 | train_accuracy: 0.69071 | valid_auc: 0.74473 | valid_balanced_accuracy: 0.67452 | valid_accuracy: 0.67485 |  0:06:34s
epoch 23 | loss: 0.57235 | train_auc: 0.7729  | train_balanced_accuracy: 0.69801 | train_accuracy: 0.6983  | valid_auc: 0.75333 | valid_balanced_accuracy: 0.68241 | valid_accuracy: 0.68272 |  0:06:51s
epoch 24 | loss: 0.57243 | train_auc: 0.76244 | train_balanced_accuracy: 0.69018 | train_accuracy: 0.69086 | valid_auc: 0.74066 | valid_balanced_accuracy: 0.67148 | valid_accuracy: 0.67218 |  0:07:08s
epoch 25 | loss: 0.5668  | train_auc: 0.75506 | train_balanced_accuracy: 0.68837 | train_accuracy: 0.6887  | valid_auc: 0.74446 | valid_balanced_accuracy: 0.6756  | valid_accuracy: 0.67595 |  0:07:24s
epoch 26 | loss: 0.56903 | train_auc: 0.7665  | train_balanced_accuracy: 0.69401 | train_accuracy: 0.69456 | valid_auc: 0.74802 | valid_balanced_accuracy: 0.68104 | valid_accuracy: 0.68162 |  0:07:41s
epoch 27 | loss: 0.56742 | train_auc: 0.77265 | train_balanced_accuracy: 0.69913 | train_accuracy: 0.6994  | valid_auc: 0.75337 | valid_balanced_accuracy: 0.68353 | valid_accuracy: 0.68382 |  0:07:58s
epoch 28 | loss: 0.56454 | train_auc: 0.77589 | train_balanced_accuracy: 0.70138 | train_accuracy: 0.70176 | valid_auc: 0.75483 | valid_balanced_accuracy: 0.68378 | valid_accuracy: 0.68414 |  0:08:14s
epoch 29 | loss: 0.56229 | train_auc: 0.77769 | train_balanced_accuracy: 0.70617 | train_accuracy: 0.70641 | valid_auc: 0.75406 | valid_balanced_accuracy: 0.68657 | valid_accuracy: 0.68681 |  0:08:31s
epoch 30 | loss: 0.55856 | train_auc: 0.78239 | train_balanced_accuracy: 0.70496 | train_accuracy: 0.70523 | valid_auc: 0.75813 | valid_balanced_accuracy: 0.69189 | valid_accuracy: 0.69216 |  0:08:49s
epoch 31 | loss: 0.56144 | train_auc: 0.78643 | train_balanced_accuracy: 0.70882 | train_accuracy: 0.7092  | valid_auc: 0.7528  | valid_balanced_accuracy: 0.68671 | valid_accuracy: 0.68713 |  0:09:07s
epoch 32 | loss: 0.55543 | train_auc: 0.78655 | train_balanced_accuracy: 0.70642 | train_accuracy: 0.70637 | valid_auc: 0.75804 | valid_balanced_accuracy: 0.68478 | valid_accuracy: 0.68477 |  0:09:24s
epoch 33 | loss: 0.55936 | train_auc: 0.7846  | train_balanced_accuracy: 0.70623 | train_accuracy: 0.70668 | valid_auc: 0.75864 | valid_balanced_accuracy: 0.6868  | valid_accuracy: 0.68728 |  0:09:40s
epoch 34 | loss: 0.5567  | train_auc: 0.79178 | train_balanced_accuracy: 0.71529 | train_accuracy: 0.71553 | valid_auc: 0.76249 | valid_balanced_accuracy: 0.68879 | valid_accuracy: 0.68901 |  0:09:56s
epoch 35 | loss: 0.55088 | train_auc: 0.78823 | train_balanced_accuracy: 0.70998 | train_accuracy: 0.71034 | valid_auc: 0.75797 | valid_balanced_accuracy: 0.6816  | valid_accuracy: 0.68193 |  0:10:12s
epoch 36 | loss: 0.55211 | train_auc: 0.7919  | train_balanced_accuracy: 0.71474 | train_accuracy: 0.71486 | valid_auc: 0.76114 | valid_balanced_accuracy: 0.68656 | valid_accuracy: 0.68665 |  0:10:30s
epoch 37 | loss: 0.55106 | train_auc: 0.79012 | train_balanced_accuracy: 0.70693 | train_accuracy: 0.70755 | valid_auc: 0.75658 | valid_balanced_accuracy: 0.68145 | valid_accuracy: 0.68209 |  0:10:47s
epoch 38 | loss: 0.55464 | train_auc: 0.7853  | train_balanced_accuracy: 0.70554 | train_accuracy: 0.70597 | valid_auc: 0.75815 | valid_balanced_accuracy: 0.68838 | valid_accuracy: 0.68886 |  0:11:06s
epoch 39 | loss: 0.55154 | train_auc: 0.78827 | train_balanced_accuracy: 0.71186 | train_accuracy: 0.71187 | valid_auc: 0.75644 | valid_balanced_accuracy: 0.68708 | valid_accuracy: 0.68713 |  0:11:24s
epoch 40 | loss: 0.55196 | train_auc: 0.79629 | train_balanced_accuracy: 0.71653 | train_accuracy: 0.71644 | valid_auc: 0.76503 | valid_balanced_accuracy: 0.68944 | valid_accuracy: 0.68933 |  0:11:41s
epoch 41 | loss: 0.55444 | train_auc: 0.79836 | train_balanced_accuracy: 0.71837 | train_accuracy: 0.71852 | valid_auc: 0.76223 | valid_balanced_accuracy: 0.68868 | valid_accuracy: 0.68886 |  0:11:57s
epoch 42 | loss: 0.54608 | train_auc: 0.79678 | train_balanced_accuracy: 0.71756 | train_accuracy: 0.71782 | valid_auc: 0.76353 | valid_balanced_accuracy: 0.68925 | valid_accuracy: 0.68949 |  0:12:15s
epoch 43 | loss: 0.55164 | train_auc: 0.79592 | train_balanced_accuracy: 0.71698 | train_accuracy: 0.71695 | valid_auc: 0.76449 | valid_balanced_accuracy: 0.69375 | valid_accuracy: 0.69374 |  0:12:33s
epoch 44 | loss: 0.55097 | train_auc: 0.78736 | train_balanced_accuracy: 0.70824 | train_accuracy: 0.70822 | valid_auc: 0.76159 | valid_balanced_accuracy: 0.69063 | valid_accuracy: 0.69059 |  0:12:51s
epoch 45 | loss: 0.54625 | train_auc: 0.79441 | train_balanced_accuracy: 0.71515 | train_accuracy: 0.7153  | valid_auc: 0.76224 | valid_balanced_accuracy: 0.69075 | valid_accuracy: 0.6909  |  0:13:08s
epoch 46 | loss: 0.54977 | train_auc: 0.77988 | train_balanced_accuracy: 0.70332 | train_accuracy: 0.7031  | valid_auc: 0.75615 | valid_balanced_accuracy: 0.68374 | valid_accuracy: 0.68351 |  0:13:25s
epoch 47 | loss: 0.54169 | train_auc: 0.7895  | train_balanced_accuracy: 0.71459 | train_accuracy: 0.71475 | valid_auc: 0.76222 | valid_balanced_accuracy: 0.69551 | valid_accuracy: 0.69562 |  0:13:42s
epoch 48 | loss: 0.54363 | train_auc: 0.78449 | train_balanced_accuracy: 0.70936 | train_accuracy: 0.70924 | valid_auc: 0.75743 | valid_balanced_accuracy: 0.68521 | valid_accuracy: 0.68508 |  0:14:01s
epoch 49 | loss: 0.54382 | train_auc: 0.80523 | train_balanced_accuracy: 0.72427 | train_accuracy: 0.72439 | valid_auc: 0.76355 | valid_balanced_accuracy: 0.68972 | valid_accuracy: 0.6898  |  0:14:19s
epoch 50 | loss: 0.54845 | train_auc: 0.7985  | train_balanced_accuracy: 0.71919 | train_accuracy: 0.71911 | valid_auc: 0.76281 | valid_balanced_accuracy: 0.68954 | valid_accuracy: 0.68949 |  0:14:37s
epoch 51 | loss: 0.54598 | train_auc: 0.80429 | train_balanced_accuracy: 0.72658 | train_accuracy: 0.72671 | valid_auc: 0.76436 | valid_balanced_accuracy: 0.6935  | valid_accuracy: 0.69358 |  0:14:53s
epoch 52 | loss: 0.54045 | train_auc: 0.79527 | train_balanced_accuracy: 0.71739 | train_accuracy: 0.71711 | valid_auc: 0.76204 | valid_balanced_accuracy: 0.6868  | valid_accuracy: 0.6865  |  0:15:10s
epoch 53 | loss: 0.54043 | train_auc: 0.80258 | train_balanced_accuracy: 0.72054 | train_accuracy: 0.72073 | valid_auc: 0.76266 | valid_balanced_accuracy: 0.69731 | valid_accuracy: 0.69751 |  0:15:27s
epoch 54 | loss: 0.54088 | train_auc: 0.81119 | train_balanced_accuracy: 0.72619 | train_accuracy: 0.72624 | valid_auc: 0.76869 | valid_balanced_accuracy: 0.69918 | valid_accuracy: 0.69924 |  0:15:44s
epoch 55 | loss: 0.53664 | train_auc: 0.8091  | train_balanced_accuracy: 0.72576 | train_accuracy: 0.72568 | valid_auc: 0.76028 | valid_balanced_accuracy: 0.68499 | valid_accuracy: 0.68492 |  0:16:01s
epoch 56 | loss: 0.53937 | train_auc: 0.80466 | train_balanced_accuracy: 0.72356 | train_accuracy: 0.7236  | valid_auc: 0.76384 | valid_balanced_accuracy: 0.69102 | valid_accuracy: 0.69106 |  0:16:19s
epoch 57 | loss: 0.54385 | train_auc: 0.79719 | train_balanced_accuracy: 0.71882 | train_accuracy: 0.7186  | valid_auc: 0.75532 | valid_balanced_accuracy: 0.68734 | valid_accuracy: 0.68713 |  0:16:36s
epoch 58 | loss: 0.54315 | train_auc: 0.80791 | train_balanced_accuracy: 0.72547 | train_accuracy: 0.72549 | valid_auc: 0.76489 | valid_balanced_accuracy: 0.69213 | valid_accuracy: 0.69216 |  0:16:52s
epoch 59 | loss: 0.53603 | train_auc: 0.77945 | train_balanced_accuracy: 0.70494 | train_accuracy: 0.70515 | valid_auc: 0.75257 | valid_balanced_accuracy: 0.68735 | valid_accuracy: 0.6876  |  0:17:09s
epoch 60 | loss: 0.53906 | train_auc: 0.79933 | train_balanced_accuracy: 0.71922 | train_accuracy: 0.71935 | valid_auc: 0.76363 | valid_balanced_accuracy: 0.69077 | valid_accuracy: 0.6909  |  0:17:27s
epoch 61 | loss: 0.53389 | train_auc: 0.81182 | train_balanced_accuracy: 0.72926 | train_accuracy: 0.72962 | valid_auc: 0.76525 | valid_balanced_accuracy: 0.69186 | valid_accuracy: 0.69232 |  0:17:44s
epoch 62 | loss: 0.53422 | train_auc: 0.80515 | train_balanced_accuracy: 0.7232  | train_accuracy: 0.72321 | valid_auc: 0.76448 | valid_balanced_accuracy: 0.68727 | valid_accuracy: 0.68728 |  0:18:00s
epoch 63 | loss: 0.53247 | train_auc: 0.7738  | train_balanced_accuracy: 0.70004 | train_accuracy: 0.70003 | valid_auc: 0.7467  | valid_balanced_accuracy: 0.6769  | valid_accuracy: 0.6769  |  0:18:17s
epoch 64 | loss: 0.5297  | train_auc: 0.8036  | train_balanced_accuracy: 0.72207 | train_accuracy: 0.72191 | valid_auc: 0.76224 | valid_balanced_accuracy: 0.69247 | valid_accuracy: 0.69232 |  0:18:34s
epoch 65 | loss: 0.53302 | train_auc: 0.78641 | train_balanced_accuracy: 0.70958 | train_accuracy: 0.70971 | valid_auc: 0.75245 | valid_balanced_accuracy: 0.68228 | valid_accuracy: 0.6824  |  0:18:52s
epoch 66 | loss: 0.53897 | train_auc: 0.8049  | train_balanced_accuracy: 0.72464 | train_accuracy: 0.72462 | valid_auc: 0.76512 | valid_balanced_accuracy: 0.69686 | valid_accuracy: 0.69688 |  0:19:09s
epoch 67 | loss: 0.53016 | train_auc: 0.76587 | train_balanced_accuracy: 0.69299 | train_accuracy: 0.69283 | valid_auc: 0.74229 | valid_balanced_accuracy: 0.6739  | valid_accuracy: 0.67375 |  0:19:27s
epoch 68 | loss: 0.53029 | train_auc: 0.81248 | train_balanced_accuracy: 0.73086 | train_accuracy: 0.73115 | valid_auc: 0.76345 | valid_balanced_accuracy: 0.69389 | valid_accuracy: 0.69421 |  0:19:42s
epoch 69 | loss: 0.53261 | train_auc: 0.78495 | train_balanced_accuracy: 0.71006 | train_accuracy: 0.7105  | valid_auc: 0.75129 | valid_balanced_accuracy: 0.68206 | valid_accuracy: 0.68256 |  0:20:00s
epoch 70 | loss: 0.52833 | train_auc: 0.79995 | train_balanced_accuracy: 0.7214  | train_accuracy: 0.72155 | valid_auc: 0.75796 | valid_balanced_accuracy: 0.68974 | valid_accuracy: 0.68996 |  0:20:16s
epoch 71 | loss: 0.53127 | train_auc: 0.79708 | train_balanced_accuracy: 0.72101 | train_accuracy: 0.7214  | valid_auc: 0.75534 | valid_balanced_accuracy: 0.68464 | valid_accuracy: 0.68508 |  0:20:35s
epoch 72 | loss: 0.53246 | train_auc: 0.821   | train_balanced_accuracy: 0.73834 | train_accuracy: 0.73843 | valid_auc: 0.76381 | valid_balanced_accuracy: 0.69286 | valid_accuracy: 0.69295 |  0:20:53s
epoch 73 | loss: 0.52935 | train_auc: 0.81369 | train_balanced_accuracy: 0.73108 | train_accuracy: 0.73107 | valid_auc: 0.76684 | valid_balanced_accuracy: 0.69011 | valid_accuracy: 0.69012 |  0:21:11s
epoch 74 | loss: 0.53234 | train_auc: 0.79504 | train_balanced_accuracy: 0.71565 | train_accuracy: 0.71577 | valid_auc: 0.75585 | valid_balanced_accuracy: 0.68574 | valid_accuracy: 0.68587 |  0:21:30s

Early stopping occurred at epoch 74 with best_epoch = 54 and best_valid_accuracy = 0.69924
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 68/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.696 total time=21.6min
[CV 5/5; 68/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.71523 | train_auc: 0.5955  | train_balanced_accuracy: 0.56772 | train_accuracy: 0.56634 | valid_auc: 0.6005  | valid_balanced_accuracy: 0.57678 | valid_accuracy: 0.57539 |  0:00:18s
epoch 1  | loss: 0.65301 | train_auc: 0.61935 | train_balanced_accuracy: 0.58648 | train_accuracy: 0.58503 | valid_auc: 0.62495 | valid_balanced_accuracy: 0.58977 | valid_accuracy: 0.58829 |  0:00:35s
epoch 2  | loss: 0.63668 | train_auc: 0.65044 | train_balanced_accuracy: 0.60675 | train_accuracy: 0.60588 | valid_auc: 0.64904 | valid_balanced_accuracy: 0.60479 | valid_accuracy: 0.60387 |  0:00:54s
epoch 3  | loss: 0.62487 | train_auc: 0.66262 | train_balanced_accuracy: 0.60317 | train_accuracy: 0.60151 | valid_auc: 0.6592  | valid_balanced_accuracy: 0.60026 | valid_accuracy: 0.59852 |  0:01:10s
epoch 4  | loss: 0.61231 | train_auc: 0.66602 | train_balanced_accuracy: 0.60422 | train_accuracy: 0.60277 | valid_auc: 0.66488 | valid_balanced_accuracy: 0.59923 | valid_accuracy: 0.59773 |  0:01:27s
epoch 5  | loss: 0.61071 | train_auc: 0.66869 | train_balanced_accuracy: 0.61471 | train_accuracy: 0.61379 | valid_auc: 0.6651  | valid_balanced_accuracy: 0.6119  | valid_accuracy: 0.61095 |  0:01:44s
epoch 6  | loss: 0.60883 | train_auc: 0.67595 | train_balanced_accuracy: 0.62014 | train_accuracy: 0.61961 | valid_auc: 0.67078 | valid_balanced_accuracy: 0.61667 | valid_accuracy: 0.61615 |  0:02:02s
epoch 7  | loss: 0.60745 | train_auc: 0.67855 | train_balanced_accuracy: 0.61906 | train_accuracy: 0.61859 | valid_auc: 0.67484 | valid_balanced_accuracy: 0.61536 | valid_accuracy: 0.61489 |  0:02:20s
epoch 8  | loss: 0.6071  | train_auc: 0.6993  | train_balanced_accuracy: 0.62934 | train_accuracy: 0.62901 | valid_auc: 0.69907 | valid_balanced_accuracy: 0.63271 | valid_accuracy: 0.63236 |  0:02:37s
epoch 9  | loss: 0.60144 | train_auc: 0.69464 | train_balanced_accuracy: 0.62731 | train_accuracy: 0.62677 | valid_auc: 0.69368 | valid_balanced_accuracy: 0.62614 | valid_accuracy: 0.62559 |  0:02:54s
epoch 10 | loss: 0.60107 | train_auc: 0.70491 | train_balanced_accuracy: 0.63073 | train_accuracy: 0.62996 | valid_auc: 0.70432 | valid_balanced_accuracy: 0.63771 | valid_accuracy: 0.63692 |  0:03:10s
epoch 11 | loss: 0.59588 | train_auc: 0.70962 | train_balanced_accuracy: 0.64204 | train_accuracy: 0.64164 | valid_auc: 0.70667 | valid_balanced_accuracy: 0.63701 | valid_accuracy: 0.63661 |  0:03:29s
epoch 12 | loss: 0.59576 | train_auc: 0.71466 | train_balanced_accuracy: 0.64302 | train_accuracy: 0.64255 | valid_auc: 0.71082 | valid_balanced_accuracy: 0.64115 | valid_accuracy: 0.6407  |  0:03:46s
epoch 13 | loss: 0.59704 | train_auc: 0.71756 | train_balanced_accuracy: 0.64694 | train_accuracy: 0.64656 | valid_auc: 0.7129  | valid_balanced_accuracy: 0.64091 | valid_accuracy: 0.64054 |  0:04:02s
epoch 14 | loss: 0.59092 | train_auc: 0.734   | train_balanced_accuracy: 0.66932 | train_accuracy: 0.66962 | valid_auc: 0.72471 | valid_balanced_accuracy: 0.66105 | valid_accuracy: 0.66132 |  0:04:20s
epoch 15 | loss: 0.58826 | train_auc: 0.73629 | train_balanced_accuracy: 0.66862 | train_accuracy: 0.66899 | valid_auc: 0.73037 | valid_balanced_accuracy: 0.66886 | valid_accuracy: 0.66918 |  0:04:37s
epoch 16 | loss: 0.5907  | train_auc: 0.74438 | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67674 | valid_auc: 0.73308 | valid_balanced_accuracy: 0.66821 | valid_accuracy: 0.66824 |  0:04:54s
epoch 17 | loss: 0.59029 | train_auc: 0.74829 | train_balanced_accuracy: 0.68203 | train_accuracy: 0.68193 | valid_auc: 0.7375  | valid_balanced_accuracy: 0.67355 | valid_accuracy: 0.67343 |  0:05:14s
epoch 18 | loss: 0.58469 | train_auc: 0.74745 | train_balanced_accuracy: 0.67997 | train_accuracy: 0.68036 | valid_auc: 0.73508 | valid_balanced_accuracy: 0.67146 | valid_accuracy: 0.67186 |  0:05:33s
epoch 19 | loss: 0.58578 | train_auc: 0.75163 | train_balanced_accuracy: 0.68443 | train_accuracy: 0.68473 | valid_auc: 0.73584 | valid_balanced_accuracy: 0.67437 | valid_accuracy: 0.67469 |  0:05:51s
epoch 20 | loss: 0.58168 | train_auc: 0.75615 | train_balanced_accuracy: 0.69123 | train_accuracy: 0.69134 | valid_auc: 0.73805 | valid_balanced_accuracy: 0.68328 | valid_accuracy: 0.68335 |  0:06:08s
epoch 21 | loss: 0.57967 | train_auc: 0.76019 | train_balanced_accuracy: 0.69225 | train_accuracy: 0.69279 | valid_auc: 0.73652 | valid_balanced_accuracy: 0.67241 | valid_accuracy: 0.67296 |  0:06:26s
epoch 22 | loss: 0.57984 | train_auc: 0.75962 | train_balanced_accuracy: 0.69191 | train_accuracy: 0.6924  | valid_auc: 0.73881 | valid_balanced_accuracy: 0.67607 | valid_accuracy: 0.67658 |  0:06:41s
epoch 23 | loss: 0.57562 | train_auc: 0.76005 | train_balanced_accuracy: 0.69107 | train_accuracy: 0.69153 | valid_auc: 0.73853 | valid_balanced_accuracy: 0.67658 | valid_accuracy: 0.67705 |  0:06:58s
epoch 24 | loss: 0.58321 | train_auc: 0.76406 | train_balanced_accuracy: 0.69396 | train_accuracy: 0.69425 | valid_auc: 0.73936 | valid_balanced_accuracy: 0.67112 | valid_accuracy: 0.67139 |  0:07:16s
epoch 25 | loss: 0.57741 | train_auc: 0.76722 | train_balanced_accuracy: 0.69542 | train_accuracy: 0.69551 | valid_auc: 0.741   | valid_balanced_accuracy: 0.67287 | valid_accuracy: 0.67296 |  0:07:32s
epoch 26 | loss: 0.5752  | train_auc: 0.77117 | train_balanced_accuracy: 0.70104 | train_accuracy: 0.70137 | valid_auc: 0.74624 | valid_balanced_accuracy: 0.68397 | valid_accuracy: 0.68429 |  0:07:50s
epoch 27 | loss: 0.57384 | train_auc: 0.77452 | train_balanced_accuracy: 0.70324 | train_accuracy: 0.70338 | valid_auc: 0.75184 | valid_balanced_accuracy: 0.69031 | valid_accuracy: 0.69043 |  0:08:08s
epoch 28 | loss: 0.57387 | train_auc: 0.77145 | train_balanced_accuracy: 0.70136 | train_accuracy: 0.70141 | valid_auc: 0.74772 | valid_balanced_accuracy: 0.68602 | valid_accuracy: 0.68602 |  0:08:28s
epoch 29 | loss: 0.57407 | train_auc: 0.77782 | train_balanced_accuracy: 0.70497 | train_accuracy: 0.70495 | valid_auc: 0.74788 | valid_balanced_accuracy: 0.68499 | valid_accuracy: 0.68492 |  0:08:44s
epoch 30 | loss: 0.57315 | train_auc: 0.77601 | train_balanced_accuracy: 0.70334 | train_accuracy: 0.70357 | valid_auc: 0.74636 | valid_balanced_accuracy: 0.67946 | valid_accuracy: 0.67973 |  0:09:00s
epoch 31 | loss: 0.57067 | train_auc: 0.76191 | train_balanced_accuracy: 0.6963  | train_accuracy: 0.69645 | valid_auc: 0.73933 | valid_balanced_accuracy: 0.68315 | valid_accuracy: 0.68335 |  0:09:17s
epoch 32 | loss: 0.56999 | train_auc: 0.74901 | train_balanced_accuracy: 0.6786  | train_accuracy: 0.67839 | valid_auc: 0.73105 | valid_balanced_accuracy: 0.66797 | valid_accuracy: 0.66777 |  0:09:34s
epoch 33 | loss: 0.57426 | train_auc: 0.75321 | train_balanced_accuracy: 0.68927 | train_accuracy: 0.68949 | valid_auc: 0.73813 | valid_balanced_accuracy: 0.67634 | valid_accuracy: 0.67658 |  0:09:51s
epoch 34 | loss: 0.5622  | train_auc: 0.75952 | train_balanced_accuracy: 0.69143 | train_accuracy: 0.69145 | valid_auc: 0.73792 | valid_balanced_accuracy: 0.68138 | valid_accuracy: 0.68146 |  0:10:11s
epoch 35 | loss: 0.56775 | train_auc: 0.75288 | train_balanced_accuracy: 0.68761 | train_accuracy: 0.68748 | valid_auc: 0.73167 | valid_balanced_accuracy: 0.67622 | valid_accuracy: 0.67611 |  0:10:28s
epoch 36 | loss: 0.56603 | train_auc: 0.75052 | train_balanced_accuracy: 0.68493 | train_accuracy: 0.68504 | valid_auc: 0.7323  | valid_balanced_accuracy: 0.67517 | valid_accuracy: 0.67532 |  0:10:47s
epoch 37 | loss: 0.56397 | train_auc: 0.76496 | train_balanced_accuracy: 0.69868 | train_accuracy: 0.69881 | valid_auc: 0.74205 | valid_balanced_accuracy: 0.68161 | valid_accuracy: 0.68178 |  0:11:04s
epoch 38 | loss: 0.56535 | train_auc: 0.76749 | train_balanced_accuracy: 0.69681 | train_accuracy: 0.69677 | valid_auc: 0.74369 | valid_balanced_accuracy: 0.6796  | valid_accuracy: 0.67957 |  0:11:21s
epoch 39 | loss: 0.56978 | train_auc: 0.76991 | train_balanced_accuracy: 0.69757 | train_accuracy: 0.69799 | valid_auc: 0.74531 | valid_balanced_accuracy: 0.68183 | valid_accuracy: 0.68225 |  0:11:37s
epoch 40 | loss: 0.56151 | train_auc: 0.77132 | train_balanced_accuracy: 0.70148 | train_accuracy: 0.70176 | valid_auc: 0.74871 | valid_balanced_accuracy: 0.6845  | valid_accuracy: 0.68477 |  0:11:56s
epoch 41 | loss: 0.55828 | train_auc: 0.77187 | train_balanced_accuracy: 0.70106 | train_accuracy: 0.70117 | valid_auc: 0.74775 | valid_balanced_accuracy: 0.68359 | valid_accuracy: 0.68366 |  0:12:13s
epoch 42 | loss: 0.55982 | train_auc: 0.78    | train_balanced_accuracy: 0.70583 | train_accuracy: 0.70629 | valid_auc: 0.74815 | valid_balanced_accuracy: 0.68476 | valid_accuracy: 0.68524 |  0:12:32s
epoch 43 | loss: 0.55778 | train_auc: 0.77675 | train_balanced_accuracy: 0.70414 | train_accuracy: 0.70448 | valid_auc: 0.75001 | valid_balanced_accuracy: 0.68555 | valid_accuracy: 0.68587 |  0:12:49s
epoch 44 | loss: 0.55733 | train_auc: 0.79232 | train_balanced_accuracy: 0.71504 | train_accuracy: 0.71522 | valid_auc: 0.759   | valid_balanced_accuracy: 0.69581 | valid_accuracy: 0.69594 |  0:13:06s
epoch 45 | loss: 0.55161 | train_auc: 0.78852 | train_balanced_accuracy: 0.71102 | train_accuracy: 0.71152 | valid_auc: 0.7512  | valid_balanced_accuracy: 0.68448 | valid_accuracy: 0.68492 |  0:13:22s
epoch 46 | loss: 0.55658 | train_auc: 0.78909 | train_balanced_accuracy: 0.71304 | train_accuracy: 0.71329 | valid_auc: 0.75278 | valid_balanced_accuracy: 0.68553 | valid_accuracy: 0.68571 |  0:13:42s
epoch 47 | loss: 0.55726 | train_auc: 0.78969 | train_balanced_accuracy: 0.71141 | train_accuracy: 0.71176 | valid_auc: 0.75475 | valid_balanced_accuracy: 0.68796 | valid_accuracy: 0.68823 |  0:13:59s
epoch 48 | loss: 0.55505 | train_auc: 0.79241 | train_balanced_accuracy: 0.71789 | train_accuracy: 0.71793 | valid_auc: 0.76024 | valid_balanced_accuracy: 0.6966  | valid_accuracy: 0.69657 |  0:14:17s
epoch 49 | loss: 0.55214 | train_auc: 0.79527 | train_balanced_accuracy: 0.71954 | train_accuracy: 0.7197  | valid_auc: 0.7559  | valid_balanced_accuracy: 0.69045 | valid_accuracy: 0.69059 |  0:14:35s
epoch 50 | loss: 0.5492  | train_auc: 0.79785 | train_balanced_accuracy: 0.7188  | train_accuracy: 0.7188  | valid_auc: 0.75137 | valid_balanced_accuracy: 0.68937 | valid_accuracy: 0.68933 |  0:14:54s
epoch 51 | loss: 0.55237 | train_auc: 0.79836 | train_balanced_accuracy: 0.71996 | train_accuracy: 0.72025 | valid_auc: 0.75584 | valid_balanced_accuracy: 0.6872  | valid_accuracy: 0.68744 |  0:15:10s
epoch 52 | loss: 0.55002 | train_auc: 0.79883 | train_balanced_accuracy: 0.71897 | train_accuracy: 0.71931 | valid_auc: 0.75296 | valid_balanced_accuracy: 0.68873 | valid_accuracy: 0.68901 |  0:15:27s
epoch 53 | loss: 0.55766 | train_auc: 0.79528 | train_balanced_accuracy: 0.71868 | train_accuracy: 0.71907 | valid_auc: 0.75417 | valid_balanced_accuracy: 0.69133 | valid_accuracy: 0.69169 |  0:15:43s
epoch 54 | loss: 0.55104 | train_auc: 0.79896 | train_balanced_accuracy: 0.72114 | train_accuracy: 0.7212  | valid_auc: 0.75435 | valid_balanced_accuracy: 0.68633 | valid_accuracy: 0.68634 |  0:16:02s
epoch 55 | loss: 0.55823 | train_auc: 0.7982  | train_balanced_accuracy: 0.72122 | train_accuracy: 0.72155 | valid_auc: 0.75534 | valid_balanced_accuracy: 0.69312 | valid_accuracy: 0.69342 |  0:16:18s
epoch 56 | loss: 0.55385 | train_auc: 0.79728 | train_balanced_accuracy: 0.71913 | train_accuracy: 0.71904 | valid_auc: 0.75334 | valid_balanced_accuracy: 0.68803 | valid_accuracy: 0.68791 |  0:16:35s
epoch 57 | loss: 0.55045 | train_auc: 0.8002  | train_balanced_accuracy: 0.72222 | train_accuracy: 0.72242 | valid_auc: 0.75799 | valid_balanced_accuracy: 0.69039 | valid_accuracy: 0.69059 |  0:16:50s
epoch 58 | loss: 0.5463  | train_auc: 0.80216 | train_balanced_accuracy: 0.72155 | train_accuracy: 0.72144 | valid_auc: 0.75676 | valid_balanced_accuracy: 0.69138 | valid_accuracy: 0.69122 |  0:17:09s
epoch 59 | loss: 0.55252 | train_auc: 0.78537 | train_balanced_accuracy: 0.70539 | train_accuracy: 0.70589 | valid_auc: 0.74674 | valid_balanced_accuracy: 0.67831 | valid_accuracy: 0.67879 |  0:17:27s
epoch 60 | loss: 0.54739 | train_auc: 0.8053  | train_balanced_accuracy: 0.72466 | train_accuracy: 0.7247  | valid_auc: 0.75681 | valid_balanced_accuracy: 0.68977 | valid_accuracy: 0.6898  |  0:17:45s
epoch 61 | loss: 0.55102 | train_auc: 0.7961  | train_balanced_accuracy: 0.71805 | train_accuracy: 0.71825 | valid_auc: 0.75583 | valid_balanced_accuracy: 0.68606 | valid_accuracy: 0.68618 |  0:18:03s
epoch 62 | loss: 0.54343 | train_auc: 0.79891 | train_balanced_accuracy: 0.72043 | train_accuracy: 0.72045 | valid_auc: 0.75467 | valid_balanced_accuracy: 0.68946 | valid_accuracy: 0.68949 |  0:18:22s
epoch 63 | loss: 0.54509 | train_auc: 0.79735 | train_balanced_accuracy: 0.7178  | train_accuracy: 0.71809 | valid_auc: 0.75335 | valid_balanced_accuracy: 0.68544 | valid_accuracy: 0.68571 |  0:18:39s
epoch 64 | loss: 0.54058 | train_auc: 0.80692 | train_balanced_accuracy: 0.72795 | train_accuracy: 0.72812 | valid_auc: 0.75853 | valid_balanced_accuracy: 0.69086 | valid_accuracy: 0.69106 |  0:18:58s
epoch 65 | loss: 0.54847 | train_auc: 0.80715 | train_balanced_accuracy: 0.72363 | train_accuracy: 0.72376 | valid_auc: 0.75953 | valid_balanced_accuracy: 0.6903  | valid_accuracy: 0.69043 |  0:19:16s
epoch 66 | loss: 0.54339 | train_auc: 0.80895 | train_balanced_accuracy: 0.72754 | train_accuracy: 0.72773 | valid_auc: 0.75902 | valid_balanced_accuracy: 0.68713 | valid_accuracy: 0.68728 |  0:19:33s
epoch 67 | loss: 0.54228 | train_auc: 0.81133 | train_balanced_accuracy: 0.72956 | train_accuracy: 0.72974 | valid_auc: 0.76007 | valid_balanced_accuracy: 0.69359 | valid_accuracy: 0.69374 |  0:19:52s
epoch 68 | loss: 0.54082 | train_auc: 0.80785 | train_balanced_accuracy: 0.72616 | train_accuracy: 0.72659 | valid_auc: 0.75657 | valid_balanced_accuracy: 0.68718 | valid_accuracy: 0.6876  |  0:20:10s

Early stopping occurred at epoch 68 with best_epoch = 48 and best_valid_accuracy = 0.69657
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 68/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.01}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.688 total time=20.3min
[CV 1/5; 69/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82139 | train_auc: 0.51543 | train_balanced_accuracy: 0.51316 | train_accuracy: 0.5108  | valid_auc: 0.50068 | valid_balanced_accuracy: 0.50039 | valid_accuracy: 0.49795 |  0:00:18s
epoch 1  | loss: 0.75373 | train_auc: 0.49575 | train_balanced_accuracy: 0.51236 | train_accuracy: 0.50962 | valid_auc: 0.48085 | valid_balanced_accuracy: 0.5025  | valid_accuracy: 0.49969 |  0:00:36s
epoch 2  | loss: 0.71183 | train_auc: 0.5467  | train_balanced_accuracy: 0.52614 | train_accuracy: 0.52339 | valid_auc: 0.53479 | valid_balanced_accuracy: 0.51779 | valid_accuracy: 0.51495 |  0:00:54s
epoch 3  | loss: 0.69021 | train_auc: 0.5563  | train_balanced_accuracy: 0.5252  | train_accuracy: 0.52253 | valid_auc: 0.55311 | valid_balanced_accuracy: 0.52586 | valid_accuracy: 0.52314 |  0:01:12s
epoch 4  | loss: 0.67191 | train_auc: 0.57298 | train_balanced_accuracy: 0.52459 | train_accuracy: 0.52166 | valid_auc: 0.56497 | valid_balanced_accuracy: 0.52127 | valid_accuracy: 0.51826 |  0:01:30s
epoch 5  | loss: 0.66748 | train_auc: 0.59203 | train_balanced_accuracy: 0.53303 | train_accuracy: 0.53032 | valid_auc: 0.58133 | valid_balanced_accuracy: 0.52924 | valid_accuracy: 0.52644 |  0:01:47s
epoch 6  | loss: 0.6654  | train_auc: 0.60361 | train_balanced_accuracy: 0.55242 | train_accuracy: 0.55011 | valid_auc: 0.59233 | valid_balanced_accuracy: 0.54538 | valid_accuracy: 0.54297 |  0:02:04s
epoch 7  | loss: 0.6591  | train_auc: 0.60766 | train_balanced_accuracy: 0.56672 | train_accuracy: 0.56471 | valid_auc: 0.59661 | valid_balanced_accuracy: 0.55624 | valid_accuracy: 0.55414 |  0:02:21s
epoch 8  | loss: 0.64933 | train_auc: 0.61509 | train_balanced_accuracy: 0.57326 | train_accuracy: 0.57128 | valid_auc: 0.60708 | valid_balanced_accuracy: 0.56484 | valid_accuracy: 0.5628  |  0:02:40s
epoch 9  | loss: 0.65035 | train_auc: 0.61704 | train_balanced_accuracy: 0.56906 | train_accuracy: 0.56687 | valid_auc: 0.6089  | valid_balanced_accuracy: 0.56379 | valid_accuracy: 0.56154 |  0:02:55s
epoch 10 | loss: 0.64555 | train_auc: 0.64014 | train_balanced_accuracy: 0.58115 | train_accuracy: 0.5793  | valid_auc: 0.6314  | valid_balanced_accuracy: 0.57481 | valid_accuracy: 0.57287 |  0:03:11s
epoch 11 | loss: 0.64005 | train_auc: 0.65319 | train_balanced_accuracy: 0.59888 | train_accuracy: 0.5974  | valid_auc: 0.64821 | valid_balanced_accuracy: 0.59171 | valid_accuracy: 0.59018 |  0:03:29s
epoch 12 | loss: 0.63904 | train_auc: 0.66516 | train_balanced_accuracy: 0.60376 | train_accuracy: 0.60228 | valid_auc: 0.66053 | valid_balanced_accuracy: 0.5925  | valid_accuracy: 0.59097 |  0:03:49s
epoch 13 | loss: 0.63969 | train_auc: 0.66367 | train_balanced_accuracy: 0.60967 | train_accuracy: 0.60846 | valid_auc: 0.66159 | valid_balanced_accuracy: 0.60263 | valid_accuracy: 0.60135 |  0:04:06s
epoch 14 | loss: 0.63419 | train_auc: 0.6791  | train_balanced_accuracy: 0.61828 | train_accuracy: 0.61719 | valid_auc: 0.67283 | valid_balanced_accuracy: 0.60956 | valid_accuracy: 0.60844 |  0:04:23s
epoch 15 | loss: 0.63006 | train_auc: 0.67988 | train_balanced_accuracy: 0.61776 | train_accuracy: 0.6166  | valid_auc: 0.6765  | valid_balanced_accuracy: 0.60915 | valid_accuracy: 0.60796 |  0:04:39s
epoch 16 | loss: 0.62818 | train_auc: 0.6863  | train_balanced_accuracy: 0.63216 | train_accuracy: 0.63136 | valid_auc: 0.68271 | valid_balanced_accuracy: 0.63083 | valid_accuracy: 0.63    |  0:04:56s
epoch 17 | loss: 0.62826 | train_auc: 0.68717 | train_balanced_accuracy: 0.63191 | train_accuracy: 0.63112 | valid_auc: 0.68561 | valid_balanced_accuracy: 0.63161 | valid_accuracy: 0.63078 |  0:05:16s
epoch 18 | loss: 0.62286 | train_auc: 0.69622 | train_balanced_accuracy: 0.63484 | train_accuracy: 0.63407 | valid_auc: 0.69539 | valid_balanced_accuracy: 0.63726 | valid_accuracy: 0.63645 |  0:05:33s
epoch 19 | loss: 0.62282 | train_auc: 0.70294 | train_balanced_accuracy: 0.6418  | train_accuracy: 0.64127 | valid_auc: 0.69618 | valid_balanced_accuracy: 0.63761 | valid_accuracy: 0.63708 |  0:05:51s
epoch 20 | loss: 0.6249  | train_auc: 0.70548 | train_balanced_accuracy: 0.6449  | train_accuracy: 0.64434 | valid_auc: 0.69837 | valid_balanced_accuracy: 0.63938 | valid_accuracy: 0.63881 |  0:06:09s
epoch 21 | loss: 0.61983 | train_auc: 0.70597 | train_balanced_accuracy: 0.64396 | train_accuracy: 0.64356 | valid_auc: 0.69548 | valid_balanced_accuracy: 0.63513 | valid_accuracy: 0.63472 |  0:06:27s
epoch 22 | loss: 0.62183 | train_auc: 0.71077 | train_balanced_accuracy: 0.64729 | train_accuracy: 0.64714 | valid_auc: 0.70209 | valid_balanced_accuracy: 0.64366 | valid_accuracy: 0.64353 |  0:06:46s
epoch 23 | loss: 0.61746 | train_auc: 0.71405 | train_balanced_accuracy: 0.65384 | train_accuracy: 0.65383 | valid_auc: 0.70439 | valid_balanced_accuracy: 0.64542 | valid_accuracy: 0.64542 |  0:07:04s
epoch 24 | loss: 0.62304 | train_auc: 0.71727 | train_balanced_accuracy: 0.65975 | train_accuracy: 0.66008 | valid_auc: 0.70676 | valid_balanced_accuracy: 0.65392 | valid_accuracy: 0.65423 |  0:07:20s
epoch 25 | loss: 0.61673 | train_auc: 0.71949 | train_balanced_accuracy: 0.65816 | train_accuracy: 0.65827 | valid_auc: 0.70855 | valid_balanced_accuracy: 0.6516  | valid_accuracy: 0.65172 |  0:07:39s
epoch 26 | loss: 0.6175  | train_auc: 0.72209 | train_balanced_accuracy: 0.66148 | train_accuracy: 0.66158 | valid_auc: 0.70851 | valid_balanced_accuracy: 0.65019 | valid_accuracy: 0.6503  |  0:07:56s
epoch 27 | loss: 0.61395 | train_auc: 0.72224 | train_balanced_accuracy: 0.66226 | train_accuracy: 0.66256 | valid_auc: 0.70961 | valid_balanced_accuracy: 0.6517  | valid_accuracy: 0.65203 |  0:08:15s
epoch 28 | loss: 0.61409 | train_auc: 0.72596 | train_balanced_accuracy: 0.66441 | train_accuracy: 0.66465 | valid_auc: 0.71248 | valid_balanced_accuracy: 0.65317 | valid_accuracy: 0.65345 |  0:08:33s
epoch 29 | loss: 0.6126  | train_auc: 0.72872 | train_balanced_accuracy: 0.66655 | train_accuracy: 0.66669 | valid_auc: 0.71425 | valid_balanced_accuracy: 0.65267 | valid_accuracy: 0.65282 |  0:08:50s
epoch 30 | loss: 0.61045 | train_auc: 0.73098 | train_balanced_accuracy: 0.66875 | train_accuracy: 0.66894 | valid_auc: 0.71574 | valid_balanced_accuracy: 0.65763 | valid_accuracy: 0.65785 |  0:09:07s
epoch 31 | loss: 0.60973 | train_auc: 0.72434 | train_balanced_accuracy: 0.66372 | train_accuracy: 0.66394 | valid_auc: 0.71119 | valid_balanced_accuracy: 0.65255 | valid_accuracy: 0.65282 |  0:09:24s
epoch 32 | loss: 0.61254 | train_auc: 0.73171 | train_balanced_accuracy: 0.66858 | train_accuracy: 0.66886 | valid_auc: 0.7145  | valid_balanced_accuracy: 0.65377 | valid_accuracy: 0.65408 |  0:09:42s
epoch 33 | loss: 0.61076 | train_auc: 0.73421 | train_balanced_accuracy: 0.67047 | train_accuracy: 0.6709  | valid_auc: 0.71697 | valid_balanced_accuracy: 0.65646 | valid_accuracy: 0.65691 |  0:10:01s
epoch 34 | loss: 0.60739 | train_auc: 0.7322  | train_balanced_accuracy: 0.66609 | train_accuracy: 0.66646 | valid_auc: 0.72099 | valid_balanced_accuracy: 0.66189 | valid_accuracy: 0.66226 |  0:10:19s
epoch 35 | loss: 0.60903 | train_auc: 0.72899 | train_balanced_accuracy: 0.66662 | train_accuracy: 0.66685 | valid_auc: 0.71639 | valid_balanced_accuracy: 0.65685 | valid_accuracy: 0.65707 |  0:10:35s
epoch 36 | loss: 0.60941 | train_auc: 0.72415 | train_balanced_accuracy: 0.66331 | train_accuracy: 0.66343 | valid_auc: 0.71088 | valid_balanced_accuracy: 0.64654 | valid_accuracy: 0.64668 |  0:10:54s
epoch 37 | loss: 0.60448 | train_auc: 0.72977 | train_balanced_accuracy: 0.66382 | train_accuracy: 0.66429 | valid_auc: 0.7174  | valid_balanced_accuracy: 0.65267 | valid_accuracy: 0.65313 |  0:11:11s
epoch 38 | loss: 0.60604 | train_auc: 0.73155 | train_balanced_accuracy: 0.6678  | train_accuracy: 0.66815 | valid_auc: 0.72065 | valid_balanced_accuracy: 0.65826 | valid_accuracy: 0.65864 |  0:11:29s
epoch 39 | loss: 0.60785 | train_auc: 0.71187 | train_balanced_accuracy: 0.65358 | train_accuracy: 0.65391 | valid_auc: 0.70131 | valid_balanced_accuracy: 0.64277 | valid_accuracy: 0.64306 |  0:11:46s
epoch 40 | loss: 0.60595 | train_auc: 0.72631 | train_balanced_accuracy: 0.66265 | train_accuracy: 0.66299 | valid_auc: 0.71436 | valid_balanced_accuracy: 0.65877 | valid_accuracy: 0.65911 |  0:12:03s
epoch 41 | loss: 0.60478 | train_auc: 0.72252 | train_balanced_accuracy: 0.66041 | train_accuracy: 0.66052 | valid_auc: 0.70866 | valid_balanced_accuracy: 0.64798 | valid_accuracy: 0.6481  |  0:12:21s
epoch 42 | loss: 0.6023  | train_auc: 0.71853 | train_balanced_accuracy: 0.65916 | train_accuracy: 0.65934 | valid_auc: 0.70571 | valid_balanced_accuracy: 0.64711 | valid_accuracy: 0.64731 |  0:12:37s
epoch 43 | loss: 0.60617 | train_auc: 0.70937 | train_balanced_accuracy: 0.65244 | train_accuracy: 0.65265 | valid_auc: 0.69583 | valid_balanced_accuracy: 0.63796 | valid_accuracy: 0.63818 |  0:12:55s
epoch 44 | loss: 0.60365 | train_auc: 0.69924 | train_balanced_accuracy: 0.64332 | train_accuracy: 0.64344 | valid_auc: 0.68547 | valid_balanced_accuracy: 0.62799 | valid_accuracy: 0.62811 |  0:13:14s
epoch 45 | loss: 0.60432 | train_auc: 0.70872 | train_balanced_accuracy: 0.65043 | train_accuracy: 0.65064 | valid_auc: 0.69666 | valid_balanced_accuracy: 0.63813 | valid_accuracy: 0.63834 |  0:13:32s
epoch 46 | loss: 0.60324 | train_auc: 0.71847 | train_balanced_accuracy: 0.65724 | train_accuracy: 0.65741 | valid_auc: 0.70451 | valid_balanced_accuracy: 0.65215 | valid_accuracy: 0.65234 |  0:13:50s
epoch 47 | loss: 0.60061 | train_auc: 0.7013  | train_balanced_accuracy: 0.64807 | train_accuracy: 0.6484  | valid_auc: 0.6878  | valid_balanced_accuracy: 0.63753 | valid_accuracy: 0.63787 |  0:14:08s
epoch 48 | loss: 0.597   | train_auc: 0.7017  | train_balanced_accuracy: 0.65061 | train_accuracy: 0.65095 | valid_auc: 0.68845 | valid_balanced_accuracy: 0.63972 | valid_accuracy: 0.64007 |  0:14:23s
epoch 49 | loss: 0.59991 | train_auc: 0.68835 | train_balanced_accuracy: 0.63756 | train_accuracy: 0.63813 | valid_auc: 0.67677 | valid_balanced_accuracy: 0.63225 | valid_accuracy: 0.63283 |  0:14:41s
epoch 50 | loss: 0.59832 | train_auc: 0.6539  | train_balanced_accuracy: 0.61589 | train_accuracy: 0.61621 | valid_auc: 0.64961 | valid_balanced_accuracy: 0.61242 | valid_accuracy: 0.61268 |  0:14:58s
epoch 51 | loss: 0.59697 | train_auc: 0.65315 | train_balanced_accuracy: 0.61316 | train_accuracy: 0.61365 | valid_auc: 0.65437 | valid_balanced_accuracy: 0.61096 | valid_accuracy: 0.61143 |  0:15:15s
epoch 52 | loss: 0.59671 | train_auc: 0.67709 | train_balanced_accuracy: 0.62863 | train_accuracy: 0.62935 | valid_auc: 0.67349 | valid_balanced_accuracy: 0.62345 | valid_accuracy: 0.62417 |  0:15:32s
epoch 53 | loss: 0.60016 | train_auc: 0.63344 | train_balanced_accuracy: 0.60152 | train_accuracy: 0.60224 | valid_auc: 0.63262 | valid_balanced_accuracy: 0.59986 | valid_accuracy: 0.60057 |  0:15:49s
epoch 54 | loss: 0.59793 | train_auc: 0.63435 | train_balanced_accuracy: 0.60297 | train_accuracy: 0.60342 | valid_auc: 0.63643 | valid_balanced_accuracy: 0.60376 | valid_accuracy: 0.60419 |  0:16:04s

Early stopping occurred at epoch 54 with best_epoch = 34 and best_valid_accuracy = 0.66226
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 1/5; 69/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.666 total time=16.2min
[CV 2/5; 69/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82605 | train_auc: 0.53612 | train_balanced_accuracy: 0.52844 | train_accuracy: 0.52737 | valid_auc: 0.53849 | valid_balanced_accuracy: 0.52815 | valid_accuracy: 0.52707 |  0:00:15s
epoch 1  | loss: 0.73837 | train_auc: 0.50034 | train_balanced_accuracy: 0.50831 | train_accuracy: 0.50533 | valid_auc: 0.50211 | valid_balanced_accuracy: 0.50447 | valid_accuracy: 0.50142 |  0:00:33s
epoch 2  | loss: 0.70758 | train_auc: 0.53444 | train_balanced_accuracy: 0.51646 | train_accuracy: 0.51375 | valid_auc: 0.5319  | valid_balanced_accuracy: 0.5072  | valid_accuracy: 0.50441 |  0:00:51s
epoch 3  | loss: 0.69213 | train_auc: 0.54115 | train_balanced_accuracy: 0.51376 | train_accuracy: 0.51076 | valid_auc: 0.54467 | valid_balanced_accuracy: 0.51866 | valid_accuracy: 0.51558 |  0:01:07s
epoch 4  | loss: 0.67641 | train_auc: 0.55989 | train_balanced_accuracy: 0.52181 | train_accuracy: 0.51883 | valid_auc: 0.55403 | valid_balanced_accuracy: 0.51976 | valid_accuracy: 0.51668 |  0:01:23s
epoch 5  | loss: 0.67054 | train_auc: 0.5813  | train_balanced_accuracy: 0.52674 | train_accuracy: 0.52382 | valid_auc: 0.57439 | valid_balanced_accuracy: 0.52536 | valid_accuracy: 0.52235 |  0:01:40s
epoch 6  | loss: 0.66774 | train_auc: 0.5985  | train_balanced_accuracy: 0.53991 | train_accuracy: 0.53732 | valid_auc: 0.59102 | valid_balanced_accuracy: 0.53716 | valid_accuracy: 0.53447 |  0:01:59s
epoch 7  | loss: 0.66261 | train_auc: 0.60639 | train_balanced_accuracy: 0.54856 | train_accuracy: 0.54609 | valid_auc: 0.5969  | valid_balanced_accuracy: 0.54377 | valid_accuracy: 0.54123 |  0:02:16s
epoch 8  | loss: 0.65189 | train_auc: 0.61738 | train_balanced_accuracy: 0.5645  | train_accuracy: 0.56227 | valid_auc: 0.61036 | valid_balanced_accuracy: 0.56555 | valid_accuracy: 0.56327 |  0:02:33s
epoch 9  | loss: 0.65538 | train_auc: 0.61273 | train_balanced_accuracy: 0.55486 | train_accuracy: 0.55239 | valid_auc: 0.60201 | valid_balanced_accuracy: 0.5512  | valid_accuracy: 0.54863 |  0:02:51s
epoch 10 | loss: 0.64685 | train_auc: 0.63695 | train_balanced_accuracy: 0.56913 | train_accuracy: 0.56691 | valid_auc: 0.62769 | valid_balanced_accuracy: 0.56463 | valid_accuracy: 0.56232 |  0:03:09s
epoch 11 | loss: 0.64346 | train_auc: 0.64856 | train_balanced_accuracy: 0.57989 | train_accuracy: 0.57789 | valid_auc: 0.64182 | valid_balanced_accuracy: 0.57315 | valid_accuracy: 0.57114 |  0:03:26s
epoch 12 | loss: 0.64114 | train_auc: 0.65762 | train_balanced_accuracy: 0.5899  | train_accuracy: 0.58824 | valid_auc: 0.65111 | valid_balanced_accuracy: 0.58148 | valid_accuracy: 0.57979 |  0:03:44s
epoch 13 | loss: 0.63934 | train_auc: 0.66446 | train_balanced_accuracy: 0.5972  | train_accuracy: 0.59563 | valid_auc: 0.65828 | valid_balanced_accuracy: 0.5891  | valid_accuracy: 0.5875  |  0:04:02s
epoch 14 | loss: 0.63833 | train_auc: 0.67568 | train_balanced_accuracy: 0.60543 | train_accuracy: 0.60397 | valid_auc: 0.67246 | valid_balanced_accuracy: 0.59512 | valid_accuracy: 0.59364 |  0:04:20s
epoch 15 | loss: 0.63065 | train_auc: 0.6775  | train_balanced_accuracy: 0.60321 | train_accuracy: 0.60169 | valid_auc: 0.67205 | valid_balanced_accuracy: 0.59374 | valid_accuracy: 0.59223 |  0:04:38s
epoch 16 | loss: 0.63236 | train_auc: 0.67903 | train_balanced_accuracy: 0.61029 | train_accuracy: 0.60905 | valid_auc: 0.6745  | valid_balanced_accuracy: 0.60009 | valid_accuracy: 0.59884 |  0:04:58s
epoch 17 | loss: 0.6306  | train_auc: 0.682   | train_balanced_accuracy: 0.61476 | train_accuracy: 0.6135  | valid_auc: 0.6791  | valid_balanced_accuracy: 0.60136 | valid_accuracy: 0.60009 |  0:05:18s
epoch 18 | loss: 0.62835 | train_auc: 0.69379 | train_balanced_accuracy: 0.63664 | train_accuracy: 0.63596 | valid_auc: 0.6932  | valid_balanced_accuracy: 0.63168 | valid_accuracy: 0.63094 |  0:05:35s
epoch 19 | loss: 0.62492 | train_auc: 0.6924  | train_balanced_accuracy: 0.63612 | train_accuracy: 0.63537 | valid_auc: 0.69135 | valid_balanced_accuracy: 0.63501 | valid_accuracy: 0.63425 |  0:05:52s
epoch 20 | loss: 0.62465 | train_auc: 0.69624 | train_balanced_accuracy: 0.64033 | train_accuracy: 0.64002 | valid_auc: 0.69115 | valid_balanced_accuracy: 0.64183 | valid_accuracy: 0.64149 |  0:06:10s
epoch 21 | loss: 0.6225  | train_auc: 0.70161 | train_balanced_accuracy: 0.64243 | train_accuracy: 0.64179 | valid_auc: 0.69815 | valid_balanced_accuracy: 0.64233 | valid_accuracy: 0.64164 |  0:06:28s
epoch 22 | loss: 0.62592 | train_auc: 0.703   | train_balanced_accuracy: 0.64341 | train_accuracy: 0.64324 | valid_auc: 0.69909 | valid_balanced_accuracy: 0.64512 | valid_accuracy: 0.64495 |  0:06:46s
epoch 23 | loss: 0.62148 | train_auc: 0.7043  | train_balanced_accuracy: 0.64424 | train_accuracy: 0.64407 | valid_auc: 0.69959 | valid_balanced_accuracy: 0.64246 | valid_accuracy: 0.64227 |  0:07:03s
epoch 24 | loss: 0.62075 | train_auc: 0.7088  | train_balanced_accuracy: 0.64488 | train_accuracy: 0.64458 | valid_auc: 0.7031  | valid_balanced_accuracy: 0.64226 | valid_accuracy: 0.64196 |  0:07:21s
epoch 25 | loss: 0.61744 | train_auc: 0.71192 | train_balanced_accuracy: 0.6452  | train_accuracy: 0.64486 | valid_auc: 0.70836 | valid_balanced_accuracy: 0.64498 | valid_accuracy: 0.64463 |  0:07:40s
epoch 26 | loss: 0.61615 | train_auc: 0.71823 | train_balanced_accuracy: 0.65441 | train_accuracy: 0.65422 | valid_auc: 0.71516 | valid_balanced_accuracy: 0.65584 | valid_accuracy: 0.65565 |  0:07:56s
epoch 27 | loss: 0.61561 | train_auc: 0.72202 | train_balanced_accuracy: 0.65909 | train_accuracy: 0.65926 | valid_auc: 0.71818 | valid_balanced_accuracy: 0.65866 | valid_accuracy: 0.6588  |  0:08:13s
epoch 28 | loss: 0.61406 | train_auc: 0.72039 | train_balanced_accuracy: 0.65454 | train_accuracy: 0.65446 | valid_auc: 0.7186  | valid_balanced_accuracy: 0.65418 | valid_accuracy: 0.65408 |  0:08:31s
epoch 29 | loss: 0.61256 | train_auc: 0.72328 | train_balanced_accuracy: 0.65611 | train_accuracy: 0.65587 | valid_auc: 0.71956 | valid_balanced_accuracy: 0.65543 | valid_accuracy: 0.65518 |  0:08:50s
epoch 30 | loss: 0.60954 | train_auc: 0.73201 | train_balanced_accuracy: 0.6694  | train_accuracy: 0.66921 | valid_auc: 0.72614 | valid_balanced_accuracy: 0.6636  | valid_accuracy: 0.66336 |  0:09:09s
epoch 31 | loss: 0.61107 | train_auc: 0.73271 | train_balanced_accuracy: 0.67054 | train_accuracy: 0.67067 | valid_auc: 0.72568 | valid_balanced_accuracy: 0.66656 | valid_accuracy: 0.66667 |  0:09:27s
epoch 32 | loss: 0.61285 | train_auc: 0.73543 | train_balanced_accuracy: 0.67311 | train_accuracy: 0.67315 | valid_auc: 0.72661 | valid_balanced_accuracy: 0.66588 | valid_accuracy: 0.66588 |  0:09:45s
epoch 33 | loss: 0.60861 | train_auc: 0.73604 | train_balanced_accuracy: 0.67594 | train_accuracy: 0.6761  | valid_auc: 0.73068 | valid_balanced_accuracy: 0.67238 | valid_accuracy: 0.67249 |  0:10:04s
epoch 34 | loss: 0.60776 | train_auc: 0.73686 | train_balanced_accuracy: 0.67662 | train_accuracy: 0.67684 | valid_auc: 0.73031 | valid_balanced_accuracy: 0.67043 | valid_accuracy: 0.6706  |  0:10:22s
epoch 35 | loss: 0.60794 | train_auc: 0.73919 | train_balanced_accuracy: 0.6785  | train_accuracy: 0.67877 | valid_auc: 0.73126 | valid_balanced_accuracy: 0.67619 | valid_accuracy: 0.67642 |  0:10:40s
epoch 36 | loss: 0.60503 | train_auc: 0.73518 | train_balanced_accuracy: 0.67391 | train_accuracy: 0.67405 | valid_auc: 0.72592 | valid_balanced_accuracy: 0.6631  | valid_accuracy: 0.6632  |  0:10:57s
epoch 37 | loss: 0.60283 | train_auc: 0.73676 | train_balanced_accuracy: 0.67617 | train_accuracy: 0.67657 | valid_auc: 0.73061 | valid_balanced_accuracy: 0.67287 | valid_accuracy: 0.67328 |  0:11:15s
epoch 38 | loss: 0.60461 | train_auc: 0.74404 | train_balanced_accuracy: 0.67954 | train_accuracy: 0.6798  | valid_auc: 0.73532 | valid_balanced_accuracy: 0.67778 | valid_accuracy: 0.678   |  0:11:34s
epoch 39 | loss: 0.60319 | train_auc: 0.74044 | train_balanced_accuracy: 0.67669 | train_accuracy: 0.67684 | valid_auc: 0.73306 | valid_balanced_accuracy: 0.67351 | valid_accuracy: 0.67359 |  0:11:52s
epoch 40 | loss: 0.60492 | train_auc: 0.73491 | train_balanced_accuracy: 0.6762  | train_accuracy: 0.67653 | valid_auc: 0.72946 | valid_balanced_accuracy: 0.67011 | valid_accuracy: 0.67044 |  0:12:08s
epoch 41 | loss: 0.6049  | train_auc: 0.73995 | train_balanced_accuracy: 0.67712 | train_accuracy: 0.67736 | valid_auc: 0.7343  | valid_balanced_accuracy: 0.6734  | valid_accuracy: 0.67359 |  0:12:26s
epoch 42 | loss: 0.60013 | train_auc: 0.72989 | train_balanced_accuracy: 0.67262 | train_accuracy: 0.67295 | valid_auc: 0.72596 | valid_balanced_accuracy: 0.66779 | valid_accuracy: 0.66808 |  0:12:43s
epoch 43 | loss: 0.60478 | train_auc: 0.71359 | train_balanced_accuracy: 0.65803 | train_accuracy: 0.65843 | valid_auc: 0.71088 | valid_balanced_accuracy: 0.65939 | valid_accuracy: 0.65974 |  0:13:01s
epoch 44 | loss: 0.59624 | train_auc: 0.71471 | train_balanced_accuracy: 0.65588 | train_accuracy: 0.65599 | valid_auc: 0.71133 | valid_balanced_accuracy: 0.65132 | valid_accuracy: 0.6514  |  0:13:18s
epoch 45 | loss: 0.5979  | train_auc: 0.70781 | train_balanced_accuracy: 0.65304 | train_accuracy: 0.65335 | valid_auc: 0.70831 | valid_balanced_accuracy: 0.65331 | valid_accuracy: 0.6536  |  0:13:37s
epoch 46 | loss: 0.59919 | train_auc: 0.70714 | train_balanced_accuracy: 0.6505  | train_accuracy: 0.65072 | valid_auc: 0.70584 | valid_balanced_accuracy: 0.6487  | valid_accuracy: 0.64888 |  0:13:54s
epoch 47 | loss: 0.59916 | train_auc: 0.67851 | train_balanced_accuracy: 0.63286 | train_accuracy: 0.63317 | valid_auc: 0.67656 | valid_balanced_accuracy: 0.62698 | valid_accuracy: 0.62732 |  0:14:12s
epoch 48 | loss: 0.59662 | train_auc: 0.68223 | train_balanced_accuracy: 0.62891 | train_accuracy: 0.62959 | valid_auc: 0.68111 | valid_balanced_accuracy: 0.63138 | valid_accuracy: 0.63204 |  0:14:30s
epoch 49 | loss: 0.59934 | train_auc: 0.67331 | train_balanced_accuracy: 0.62349 | train_accuracy: 0.62396 | valid_auc: 0.67555 | valid_balanced_accuracy: 0.62529 | valid_accuracy: 0.62575 |  0:14:46s
epoch 50 | loss: 0.59801 | train_auc: 0.68781 | train_balanced_accuracy: 0.63391 | train_accuracy: 0.63411 | valid_auc: 0.68695 | valid_balanced_accuracy: 0.63501 | valid_accuracy: 0.63519 |  0:15:05s
epoch 51 | loss: 0.59552 | train_auc: 0.71589 | train_balanced_accuracy: 0.65978 | train_accuracy: 0.66016 | valid_auc: 0.71396 | valid_balanced_accuracy: 0.65768 | valid_accuracy: 0.65801 |  0:15:23s
epoch 52 | loss: 0.59252 | train_auc: 0.70314 | train_balanced_accuracy: 0.64519 | train_accuracy: 0.64572 | valid_auc: 0.7018  | valid_balanced_accuracy: 0.64753 | valid_accuracy: 0.6481  |  0:15:41s
epoch 53 | loss: 0.5953  | train_auc: 0.72692 | train_balanced_accuracy: 0.66772 | train_accuracy: 0.66815 | valid_auc: 0.72247 | valid_balanced_accuracy: 0.66358 | valid_accuracy: 0.66399 |  0:15:58s
epoch 54 | loss: 0.59695 | train_auc: 0.72228 | train_balanced_accuracy: 0.66211 | train_accuracy: 0.66221 | valid_auc: 0.71691 | valid_balanced_accuracy: 0.65544 | valid_accuracy: 0.65549 |  0:16:14s
epoch 55 | loss: 0.59953 | train_auc: 0.73636 | train_balanced_accuracy: 0.67374 | train_accuracy: 0.67389 | valid_auc: 0.73176 | valid_balanced_accuracy: 0.68258 | valid_accuracy: 0.68272 |  0:16:32s
epoch 56 | loss: 0.59702 | train_auc: 0.75128 | train_balanced_accuracy: 0.6857  | train_accuracy: 0.68609 | valid_auc: 0.74225 | valid_balanced_accuracy: 0.67952 | valid_accuracy: 0.67989 |  0:16:50s
epoch 57 | loss: 0.59417 | train_auc: 0.75319 | train_balanced_accuracy: 0.68723 | train_accuracy: 0.68747 | valid_auc: 0.74244 | valid_balanced_accuracy: 0.67966 | valid_accuracy: 0.67989 |  0:17:07s
epoch 58 | loss: 0.59198 | train_auc: 0.75403 | train_balanced_accuracy: 0.68851 | train_accuracy: 0.68865 | valid_auc: 0.74395 | valid_balanced_accuracy: 0.68168 | valid_accuracy: 0.68178 |  0:17:24s
epoch 59 | loss: 0.59576 | train_auc: 0.74798 | train_balanced_accuracy: 0.68365 | train_accuracy: 0.68381 | valid_auc: 0.73646 | valid_balanced_accuracy: 0.67438 | valid_accuracy: 0.67454 |  0:17:42s
epoch 60 | loss: 0.59317 | train_auc: 0.7473  | train_balanced_accuracy: 0.68064 | train_accuracy: 0.6809  | valid_auc: 0.73837 | valid_balanced_accuracy: 0.67838 | valid_accuracy: 0.67863 |  0:17:59s
epoch 61 | loss: 0.59255 | train_auc: 0.72122 | train_balanced_accuracy: 0.66083 | train_accuracy: 0.66095 | valid_auc: 0.7177  | valid_balanced_accuracy: 0.65952 | valid_accuracy: 0.65958 |  0:18:18s
epoch 62 | loss: 0.59127 | train_auc: 0.73514 | train_balanced_accuracy: 0.67078 | train_accuracy: 0.67114 | valid_auc: 0.72785 | valid_balanced_accuracy: 0.66559 | valid_accuracy: 0.66588 |  0:18:35s
epoch 63 | loss: 0.59386 | train_auc: 0.75332 | train_balanced_accuracy: 0.68745 | train_accuracy: 0.68774 | valid_auc: 0.74178 | valid_balanced_accuracy: 0.68102 | valid_accuracy: 0.6813  |  0:18:51s
epoch 64 | loss: 0.5941  | train_auc: 0.69735 | train_balanced_accuracy: 0.63875 | train_accuracy: 0.63915 | valid_auc: 0.69415 | valid_balanced_accuracy: 0.63984 | valid_accuracy: 0.64023 |  0:19:07s
epoch 65 | loss: 0.59415 | train_auc: 0.64641 | train_balanced_accuracy: 0.60452 | train_accuracy: 0.60496 | valid_auc: 0.64453 | valid_balanced_accuracy: 0.60137 | valid_accuracy: 0.60183 |  0:19:24s
epoch 66 | loss: 0.59435 | train_auc: 0.6611  | train_balanced_accuracy: 0.61452 | train_accuracy: 0.61487 | valid_auc: 0.65991 | valid_balanced_accuracy: 0.60954 | valid_accuracy: 0.60985 |  0:19:42s
epoch 67 | loss: 0.58753 | train_auc: 0.71096 | train_balanced_accuracy: 0.65131 | train_accuracy: 0.65198 | valid_auc: 0.70357 | valid_balanced_accuracy: 0.64873 | valid_accuracy: 0.64935 |  0:20:00s
epoch 68 | loss: 0.59025 | train_auc: 0.72764 | train_balanced_accuracy: 0.66354 | train_accuracy: 0.66382 | valid_auc: 0.71976 | valid_balanced_accuracy: 0.6559  | valid_accuracy: 0.65612 |  0:20:17s
epoch 69 | loss: 0.59017 | train_auc: 0.7262  | train_balanced_accuracy: 0.66442 | train_accuracy: 0.66469 | valid_auc: 0.71914 | valid_balanced_accuracy: 0.65717 | valid_accuracy: 0.65738 |  0:20:35s
epoch 70 | loss: 0.59041 | train_auc: 0.73905 | train_balanced_accuracy: 0.67404 | train_accuracy: 0.67448 | valid_auc: 0.72902 | valid_balanced_accuracy: 0.668   | valid_accuracy: 0.6684  |  0:20:54s
epoch 71 | loss: 0.59235 | train_auc: 0.73799 | train_balanced_accuracy: 0.67298 | train_accuracy: 0.67326 | valid_auc: 0.72984 | valid_balanced_accuracy: 0.66551 | valid_accuracy: 0.66572 |  0:21:11s
epoch 72 | loss: 0.58619 | train_auc: 0.74837 | train_balanced_accuracy: 0.68298 | train_accuracy: 0.68318 | valid_auc: 0.73685 | valid_balanced_accuracy: 0.67234 | valid_accuracy: 0.67249 |  0:21:28s
epoch 73 | loss: 0.58866 | train_auc: 0.76283 | train_balanced_accuracy: 0.69295 | train_accuracy: 0.69325 | valid_auc: 0.74697 | valid_balanced_accuracy: 0.68182 | valid_accuracy: 0.68209 |  0:21:44s
epoch 74 | loss: 0.59029 | train_auc: 0.74611 | train_balanced_accuracy: 0.67778 | train_accuracy: 0.67822 | valid_auc: 0.73565 | valid_balanced_accuracy: 0.67289 | valid_accuracy: 0.67328 |  0:22:00s
epoch 75 | loss: 0.59051 | train_auc: 0.75585 | train_balanced_accuracy: 0.68994 | train_accuracy: 0.69022 | valid_auc: 0.74256 | valid_balanced_accuracy: 0.68011 | valid_accuracy: 0.68036 |  0:22:16s

Early stopping occurred at epoch 75 with best_epoch = 55 and best_valid_accuracy = 0.68272
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 2/5; 69/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=22.4min
[CV 3/5; 69/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82608 | train_auc: 0.5376  | train_balanced_accuracy: 0.52185 | train_accuracy: 0.51967 | valid_auc: 0.54583 | valid_balanced_accuracy: 0.52502 | valid_accuracy: 0.52282 |  0:00:17s
epoch 1  | loss: 0.73256 | train_auc: 0.50049 | train_balanced_accuracy: 0.50439 | train_accuracy: 0.50122 | valid_auc: 0.5037  | valid_balanced_accuracy: 0.50619 | valid_accuracy: 0.50299 |  0:00:34s
epoch 2  | loss: 0.7049  | train_auc: 0.51777 | train_balanced_accuracy: 0.50757 | train_accuracy: 0.50441 | valid_auc: 0.52467 | valid_balanced_accuracy: 0.50965 | valid_accuracy: 0.50645 |  0:00:53s
epoch 3  | loss: 0.69254 | train_auc: 0.53814 | train_balanced_accuracy: 0.50985 | train_accuracy: 0.50673 | valid_auc: 0.54524 | valid_balanced_accuracy: 0.5126  | valid_accuracy: 0.50944 |  0:01:10s
epoch 4  | loss: 0.68138 | train_auc: 0.56505 | train_balanced_accuracy: 0.5195  | train_accuracy: 0.51637 | valid_auc: 0.56402 | valid_balanced_accuracy: 0.52079 | valid_accuracy: 0.51763 |  0:01:28s
epoch 5  | loss: 0.67325 | train_auc: 0.57693 | train_balanced_accuracy: 0.5329  | train_accuracy: 0.53026 | valid_auc: 0.58265 | valid_balanced_accuracy: 0.54183 | valid_accuracy: 0.53919 |  0:01:45s
epoch 6  | loss: 0.66711 | train_auc: 0.59468 | train_balanced_accuracy: 0.53877 | train_accuracy: 0.536   | valid_auc: 0.59129 | valid_balanced_accuracy: 0.54214 | valid_accuracy: 0.53935 |  0:02:03s
epoch 7  | loss: 0.66393 | train_auc: 0.60412 | train_balanced_accuracy: 0.53975 | train_accuracy: 0.53691 | valid_auc: 0.59682 | valid_balanced_accuracy: 0.53907 | valid_accuracy: 0.5362  |  0:02:19s
epoch 8  | loss: 0.65923 | train_auc: 0.61585 | train_balanced_accuracy: 0.54487 | train_accuracy: 0.54218 | valid_auc: 0.61053 | valid_balanced_accuracy: 0.54679 | valid_accuracy: 0.54407 |  0:02:36s
epoch 9  | loss: 0.65513 | train_auc: 0.62612 | train_balanced_accuracy: 0.56117 | train_accuracy: 0.5587  | valid_auc: 0.61604 | valid_balanced_accuracy: 0.55836 | valid_accuracy: 0.55587 |  0:02:52s
epoch 10 | loss: 0.64688 | train_auc: 0.62693 | train_balanced_accuracy: 0.56801 | train_accuracy: 0.56579 | valid_auc: 0.62005 | valid_balanced_accuracy: 0.56471 | valid_accuracy: 0.56248 |  0:03:10s
epoch 11 | loss: 0.64884 | train_auc: 0.64212 | train_balanced_accuracy: 0.58002 | train_accuracy: 0.57818 | valid_auc: 0.6338  | valid_balanced_accuracy: 0.57469 | valid_accuracy: 0.57287 |  0:03:27s
epoch 12 | loss: 0.64445 | train_auc: 0.65649 | train_balanced_accuracy: 0.58836 | train_accuracy: 0.58656 | valid_auc: 0.64883 | valid_balanced_accuracy: 0.58502 | valid_accuracy: 0.58325 |  0:03:45s
epoch 13 | loss: 0.6421  | train_auc: 0.66423 | train_balanced_accuracy: 0.59199 | train_accuracy: 0.59026 | valid_auc: 0.65382 | valid_balanced_accuracy: 0.59158 | valid_accuracy: 0.58986 |  0:04:02s
epoch 14 | loss: 0.63829 | train_auc: 0.67473 | train_balanced_accuracy: 0.59504 | train_accuracy: 0.59333 | valid_auc: 0.66277 | valid_balanced_accuracy: 0.59015 | valid_accuracy: 0.58845 |  0:04:18s
epoch 15 | loss: 0.63737 | train_auc: 0.67762 | train_balanced_accuracy: 0.60793 | train_accuracy: 0.60651 | valid_auc: 0.66732 | valid_balanced_accuracy: 0.60559 | valid_accuracy: 0.60419 |  0:04:35s
epoch 16 | loss: 0.63352 | train_auc: 0.68381 | train_balanced_accuracy: 0.61981 | train_accuracy: 0.61874 | valid_auc: 0.67566 | valid_balanced_accuracy: 0.61471 | valid_accuracy: 0.61363 |  0:04:52s
epoch 17 | loss: 0.63113 | train_auc: 0.68943 | train_balanced_accuracy: 0.61363 | train_accuracy: 0.61229 | valid_auc: 0.68245 | valid_balanced_accuracy: 0.60914 | valid_accuracy: 0.60781 |  0:05:11s
epoch 18 | loss: 0.6336  | train_auc: 0.69392 | train_balanced_accuracy: 0.63857 | train_accuracy: 0.63802 | valid_auc: 0.68763 | valid_balanced_accuracy: 0.62865 | valid_accuracy: 0.62811 |  0:05:29s
epoch 19 | loss: 0.63027 | train_auc: 0.69277 | train_balanced_accuracy: 0.63477 | train_accuracy: 0.63405 | valid_auc: 0.68528 | valid_balanced_accuracy: 0.62583 | valid_accuracy: 0.62512 |  0:05:47s
epoch 20 | loss: 0.63095 | train_auc: 0.69982 | train_balanced_accuracy: 0.64063 | train_accuracy: 0.64027 | valid_auc: 0.68994 | valid_balanced_accuracy: 0.6354  | valid_accuracy: 0.63503 |  0:06:05s
epoch 21 | loss: 0.62428 | train_auc: 0.70599 | train_balanced_accuracy: 0.6429  | train_accuracy: 0.64231 | valid_auc: 0.69276 | valid_balanced_accuracy: 0.63309 | valid_accuracy: 0.63251 |  0:06:22s
epoch 22 | loss: 0.62612 | train_auc: 0.70652 | train_balanced_accuracy: 0.64765 | train_accuracy: 0.64735 | valid_auc: 0.69334 | valid_balanced_accuracy: 0.6401  | valid_accuracy: 0.63975 |  0:06:39s
epoch 23 | loss: 0.6235  | train_auc: 0.70944 | train_balanced_accuracy: 0.64962 | train_accuracy: 0.64924 | valid_auc: 0.69706 | valid_balanced_accuracy: 0.6409  | valid_accuracy: 0.64054 |  0:06:55s
epoch 24 | loss: 0.62631 | train_auc: 0.70999 | train_balanced_accuracy: 0.64829 | train_accuracy: 0.64786 | valid_auc: 0.70001 | valid_balanced_accuracy: 0.64002 | valid_accuracy: 0.6396  |  0:07:14s
epoch 25 | loss: 0.62178 | train_auc: 0.71314 | train_balanced_accuracy: 0.65265 | train_accuracy: 0.6525  | valid_auc: 0.70043 | valid_balanced_accuracy: 0.64529 | valid_accuracy: 0.64511 |  0:07:30s
epoch 26 | loss: 0.62026 | train_auc: 0.71808 | train_balanced_accuracy: 0.66117 | train_accuracy: 0.66108 | valid_auc: 0.70531 | valid_balanced_accuracy: 0.65605 | valid_accuracy: 0.65596 |  0:07:48s
epoch 27 | loss: 0.6215  | train_auc: 0.71852 | train_balanced_accuracy: 0.66077 | train_accuracy: 0.66061 | valid_auc: 0.70246 | valid_balanced_accuracy: 0.64857 | valid_accuracy: 0.64841 |  0:08:05s
epoch 28 | loss: 0.61813 | train_auc: 0.72344 | train_balanced_accuracy: 0.66393 | train_accuracy: 0.66399 | valid_auc: 0.70534 | valid_balanced_accuracy: 0.65011 | valid_accuracy: 0.65014 |  0:08:21s
epoch 29 | loss: 0.62056 | train_auc: 0.72514 | train_balanced_accuracy: 0.66534 | train_accuracy: 0.66545 | valid_auc: 0.7075  | valid_balanced_accuracy: 0.65148 | valid_accuracy: 0.65156 |  0:08:37s
epoch 30 | loss: 0.61501 | train_auc: 0.72625 | train_balanced_accuracy: 0.66576 | train_accuracy: 0.66572 | valid_auc: 0.70969 | valid_balanced_accuracy: 0.65589 | valid_accuracy: 0.65581 |  0:08:55s
epoch 31 | loss: 0.61848 | train_auc: 0.72365 | train_balanced_accuracy: 0.66477 | train_accuracy: 0.66497 | valid_auc: 0.71094 | valid_balanced_accuracy: 0.65865 | valid_accuracy: 0.6588  |  0:09:13s
epoch 32 | loss: 0.61269 | train_auc: 0.72799 | train_balanced_accuracy: 0.67089 | train_accuracy: 0.67119 | valid_auc: 0.71445 | valid_balanced_accuracy: 0.66025 | valid_accuracy: 0.66053 |  0:09:29s
epoch 33 | loss: 0.61933 | train_auc: 0.73122 | train_balanced_accuracy: 0.67098 | train_accuracy: 0.67123 | valid_auc: 0.71562 | valid_balanced_accuracy: 0.65839 | valid_accuracy: 0.65864 |  0:09:46s
epoch 34 | loss: 0.61455 | train_auc: 0.73465 | train_balanced_accuracy: 0.673   | train_accuracy: 0.67332 | valid_auc: 0.71726 | valid_balanced_accuracy: 0.65817 | valid_accuracy: 0.65848 |  0:10:04s
epoch 35 | loss: 0.60793 | train_auc: 0.73573 | train_balanced_accuracy: 0.67464 | train_accuracy: 0.67489 | valid_auc: 0.71831 | valid_balanced_accuracy: 0.66252 | valid_accuracy: 0.66273 |  0:10:22s
epoch 36 | loss: 0.6128  | train_auc: 0.73597 | train_balanced_accuracy: 0.6765  | train_accuracy: 0.67682 | valid_auc: 0.7183  | valid_balanced_accuracy: 0.65644 | valid_accuracy: 0.65675 |  0:10:39s
epoch 37 | loss: 0.61189 | train_auc: 0.73387 | train_balanced_accuracy: 0.67245 | train_accuracy: 0.67277 | valid_auc: 0.71765 | valid_balanced_accuracy: 0.66039 | valid_accuracy: 0.66069 |  0:10:55s
epoch 38 | loss: 0.60976 | train_auc: 0.73787 | train_balanced_accuracy: 0.6758  | train_accuracy: 0.67587 | valid_auc: 0.71756 | valid_balanced_accuracy: 0.6578  | valid_accuracy: 0.65785 |  0:11:13s
epoch 39 | loss: 0.60362 | train_auc: 0.73756 | train_balanced_accuracy: 0.67659 | train_accuracy: 0.67674 | valid_auc: 0.71982 | valid_balanced_accuracy: 0.66261 | valid_accuracy: 0.66273 |  0:11:29s
epoch 40 | loss: 0.60859 | train_auc: 0.73033 | train_balanced_accuracy: 0.67116 | train_accuracy: 0.67119 | valid_auc: 0.71803 | valid_balanced_accuracy: 0.66411 | valid_accuracy: 0.66415 |  0:11:47s
epoch 41 | loss: 0.60798 | train_auc: 0.74056 | train_balanced_accuracy: 0.67766 | train_accuracy: 0.67788 | valid_auc: 0.72243 | valid_balanced_accuracy: 0.66316 | valid_accuracy: 0.66336 |  0:12:05s
epoch 42 | loss: 0.60297 | train_auc: 0.74137 | train_balanced_accuracy: 0.67771 | train_accuracy: 0.67792 | valid_auc: 0.72326 | valid_balanced_accuracy: 0.66727 | valid_accuracy: 0.66745 |  0:12:22s
epoch 43 | loss: 0.60693 | train_auc: 0.74098 | train_balanced_accuracy: 0.67865 | train_accuracy: 0.67886 | valid_auc: 0.72442 | valid_balanced_accuracy: 0.66347 | valid_accuracy: 0.66368 |  0:12:39s
epoch 44 | loss: 0.60849 | train_auc: 0.74286 | train_balanced_accuracy: 0.67905 | train_accuracy: 0.6789  | valid_auc: 0.72101 | valid_balanced_accuracy: 0.66022 | valid_accuracy: 0.66006 |  0:12:57s
epoch 45 | loss: 0.60274 | train_auc: 0.74327 | train_balanced_accuracy: 0.68078 | train_accuracy: 0.68095 | valid_auc: 0.72444 | valid_balanced_accuracy: 0.66745 | valid_accuracy: 0.66761 |  0:13:14s
epoch 46 | loss: 0.60825 | train_auc: 0.74621 | train_balanced_accuracy: 0.68294 | train_accuracy: 0.68303 | valid_auc: 0.72497 | valid_balanced_accuracy: 0.66563 | valid_accuracy: 0.66572 |  0:13:33s
epoch 47 | loss: 0.60366 | train_auc: 0.74396 | train_balanced_accuracy: 0.6809  | train_accuracy: 0.68119 | valid_auc: 0.72393 | valid_balanced_accuracy: 0.66829 | valid_accuracy: 0.66856 |  0:13:50s
epoch 48 | loss: 0.60505 | train_auc: 0.74473 | train_balanced_accuracy: 0.68281 | train_accuracy: 0.68296 | valid_auc: 0.72569 | valid_balanced_accuracy: 0.67221 | valid_accuracy: 0.67233 |  0:14:06s
epoch 49 | loss: 0.59967 | train_auc: 0.74553 | train_balanced_accuracy: 0.68207 | train_accuracy: 0.68229 | valid_auc: 0.72664 | valid_balanced_accuracy: 0.66677 | valid_accuracy: 0.66698 |  0:14:23s
epoch 50 | loss: 0.60316 | train_auc: 0.73348 | train_balanced_accuracy: 0.67015 | train_accuracy: 0.66993 | valid_auc: 0.72068 | valid_balanced_accuracy: 0.6623  | valid_accuracy: 0.6621  |  0:14:41s
epoch 51 | loss: 0.59876 | train_auc: 0.71675 | train_balanced_accuracy: 0.65795 | train_accuracy: 0.65801 | valid_auc: 0.71243 | valid_balanced_accuracy: 0.65872 | valid_accuracy: 0.6588  |  0:14:58s
epoch 52 | loss: 0.59511 | train_auc: 0.7116  | train_balanced_accuracy: 0.65229 | train_accuracy: 0.65219 | valid_auc: 0.70857 | valid_balanced_accuracy: 0.65151 | valid_accuracy: 0.6514  |  0:15:16s
epoch 53 | loss: 0.59734 | train_auc: 0.68703 | train_balanced_accuracy: 0.63652 | train_accuracy: 0.63684 | valid_auc: 0.68704 | valid_balanced_accuracy: 0.6383  | valid_accuracy: 0.63865 |  0:15:33s
epoch 54 | loss: 0.60055 | train_auc: 0.66959 | train_balanced_accuracy: 0.62613 | train_accuracy: 0.62606 | valid_auc: 0.67238 | valid_balanced_accuracy: 0.62629 | valid_accuracy: 0.62622 |  0:15:51s
epoch 55 | loss: 0.5984  | train_auc: 0.66146 | train_balanced_accuracy: 0.62199 | train_accuracy: 0.62193 | valid_auc: 0.65667 | valid_balanced_accuracy: 0.61751 | valid_accuracy: 0.61741 |  0:16:09s
epoch 56 | loss: 0.59877 | train_auc: 0.65213 | train_balanced_accuracy: 0.60545 | train_accuracy: 0.60564 | valid_auc: 0.65178 | valid_balanced_accuracy: 0.60499 | valid_accuracy: 0.60513 |  0:16:27s
epoch 57 | loss: 0.60076 | train_auc: 0.64891 | train_balanced_accuracy: 0.61649 | train_accuracy: 0.61674 | valid_auc: 0.64676 | valid_balanced_accuracy: 0.60953 | valid_accuracy: 0.60969 |  0:16:44s
epoch 58 | loss: 0.6004  | train_auc: 0.68795 | train_balanced_accuracy: 0.63956 | train_accuracy: 0.63964 | valid_auc: 0.68277 | valid_balanced_accuracy: 0.634   | valid_accuracy: 0.63409 |  0:17:00s
epoch 59 | loss: 0.59678 | train_auc: 0.71105 | train_balanced_accuracy: 0.6517  | train_accuracy: 0.65144 | valid_auc: 0.7039  | valid_balanced_accuracy: 0.65242 | valid_accuracy: 0.65219 |  0:17:17s
epoch 60 | loss: 0.59714 | train_auc: 0.7517  | train_balanced_accuracy: 0.68618 | train_accuracy: 0.68622 | valid_auc: 0.73215 | valid_balanced_accuracy: 0.67105 | valid_accuracy: 0.67107 |  0:17:34s
epoch 61 | loss: 0.59774 | train_auc: 0.74832 | train_balanced_accuracy: 0.68666 | train_accuracy: 0.68677 | valid_auc: 0.73464 | valid_balanced_accuracy: 0.67376 | valid_accuracy: 0.67391 |  0:17:52s
epoch 62 | loss: 0.59309 | train_auc: 0.7456  | train_balanced_accuracy: 0.68397 | train_accuracy: 0.68449 | valid_auc: 0.73235 | valid_balanced_accuracy: 0.67007 | valid_accuracy: 0.6706  |  0:18:09s
epoch 63 | loss: 0.59445 | train_auc: 0.72399 | train_balanced_accuracy: 0.66911 | train_accuracy: 0.66911 | valid_auc: 0.71445 | valid_balanced_accuracy: 0.6593  | valid_accuracy: 0.65927 |  0:18:28s
epoch 64 | loss: 0.59014 | train_auc: 0.736   | train_balanced_accuracy: 0.67476 | train_accuracy: 0.67461 | valid_auc: 0.72123 | valid_balanced_accuracy: 0.65848 | valid_accuracy: 0.65833 |  0:18:46s
epoch 65 | loss: 0.59056 | train_auc: 0.75276 | train_balanced_accuracy: 0.6898  | train_accuracy: 0.68988 | valid_auc: 0.73582 | valid_balanced_accuracy: 0.68075 | valid_accuracy: 0.68083 |  0:19:04s
epoch 66 | loss: 0.59491 | train_auc: 0.75865 | train_balanced_accuracy: 0.69206 | train_accuracy: 0.69216 | valid_auc: 0.73605 | valid_balanced_accuracy: 0.67852 | valid_accuracy: 0.67863 |  0:19:22s
epoch 67 | loss: 0.59014 | train_auc: 0.74511 | train_balanced_accuracy: 0.6801  | train_accuracy: 0.68059 | valid_auc: 0.72814 | valid_balanced_accuracy: 0.67057 | valid_accuracy: 0.67107 |  0:19:39s
epoch 68 | loss: 0.59425 | train_auc: 0.75579 | train_balanced_accuracy: 0.68917 | train_accuracy: 0.6896  | valid_auc: 0.73684 | valid_balanced_accuracy: 0.67098 | valid_accuracy: 0.67139 |  0:19:58s
epoch 69 | loss: 0.59369 | train_auc: 0.75184 | train_balanced_accuracy: 0.68691 | train_accuracy: 0.68724 | valid_auc: 0.73179 | valid_balanced_accuracy: 0.67312 | valid_accuracy: 0.67343 |  0:20:15s
epoch 70 | loss: 0.59208 | train_auc: 0.752   | train_balanced_accuracy: 0.68734 | train_accuracy: 0.68736 | valid_auc: 0.73246 | valid_balanced_accuracy: 0.67277 | valid_accuracy: 0.6728  |  0:20:31s
epoch 71 | loss: 0.59425 | train_auc: 0.75857 | train_balanced_accuracy: 0.69319 | train_accuracy: 0.69346 | valid_auc: 0.73539 | valid_balanced_accuracy: 0.67489 | valid_accuracy: 0.67517 |  0:20:47s
epoch 72 | loss: 0.5937  | train_auc: 0.7581  | train_balanced_accuracy: 0.69074 | train_accuracy: 0.69075 | valid_auc: 0.73461 | valid_balanced_accuracy: 0.67265 | valid_accuracy: 0.67265 |  0:21:05s
epoch 73 | loss: 0.58696 | train_auc: 0.75925 | train_balanced_accuracy: 0.69421 | train_accuracy: 0.69444 | valid_auc: 0.73601 | valid_balanced_accuracy: 0.67764 | valid_accuracy: 0.67784 |  0:21:23s
epoch 74 | loss: 0.59204 | train_auc: 0.75704 | train_balanced_accuracy: 0.69148 | train_accuracy: 0.69165 | valid_auc: 0.73348 | valid_balanced_accuracy: 0.67767 | valid_accuracy: 0.67784 |  0:21:40s
epoch 75 | loss: 0.59364 | train_auc: 0.75729 | train_balanced_accuracy: 0.69043 | train_accuracy: 0.69043 | valid_auc: 0.73303 | valid_balanced_accuracy: 0.6736  | valid_accuracy: 0.67359 |  0:21:57s
epoch 76 | loss: 0.59268 | train_auc: 0.75892 | train_balanced_accuracy: 0.69263 | train_accuracy: 0.69291 | valid_auc: 0.73479 | valid_balanced_accuracy: 0.67788 | valid_accuracy: 0.67816 |  0:22:15s
epoch 77 | loss: 0.58778 | train_auc: 0.75732 | train_balanced_accuracy: 0.68774 | train_accuracy: 0.68791 | valid_auc: 0.73392 | valid_balanced_accuracy: 0.66964 | valid_accuracy: 0.66981 |  0:22:32s
epoch 78 | loss: 0.58511 | train_auc: 0.74463 | train_balanced_accuracy: 0.67899 | train_accuracy: 0.67898 | valid_auc: 0.72768 | valid_balanced_accuracy: 0.67234 | valid_accuracy: 0.67233 |  0:22:50s
epoch 79 | loss: 0.58511 | train_auc: 0.74786 | train_balanced_accuracy: 0.68319 | train_accuracy: 0.68335 | valid_auc: 0.72909 | valid_balanced_accuracy: 0.67358 | valid_accuracy: 0.67375 |  0:23:07s
epoch 80 | loss: 0.59156 | train_auc: 0.71388 | train_balanced_accuracy: 0.6575  | train_accuracy: 0.65754 | valid_auc: 0.70839 | valid_balanced_accuracy: 0.65642 | valid_accuracy: 0.65644 |  0:23:22s
epoch 81 | loss: 0.59176 | train_auc: 0.67587 | train_balanced_accuracy: 0.62828 | train_accuracy: 0.62858 | valid_auc: 0.6792  | valid_balanced_accuracy: 0.63503 | valid_accuracy: 0.63535 |  0:23:40s
epoch 82 | loss: 0.58707 | train_auc: 0.71493 | train_balanced_accuracy: 0.6553  | train_accuracy: 0.65526 | valid_auc: 0.7061  | valid_balanced_accuracy: 0.64721 | valid_accuracy: 0.64715 |  0:23:56s
epoch 83 | loss: 0.58941 | train_auc: 0.73479 | train_balanced_accuracy: 0.67055 | train_accuracy: 0.6708  | valid_auc: 0.72266 | valid_balanced_accuracy: 0.66657 | valid_accuracy: 0.66682 |  0:24:14s
epoch 84 | loss: 0.59407 | train_auc: 0.71505 | train_balanced_accuracy: 0.65693 | train_accuracy: 0.65699 | valid_auc: 0.71045 | valid_balanced_accuracy: 0.65875 | valid_accuracy: 0.6588  |  0:24:33s
epoch 85 | loss: 0.59133 | train_auc: 0.7083  | train_balanced_accuracy: 0.651   | train_accuracy: 0.65105 | valid_auc: 0.70236 | valid_balanced_accuracy: 0.65377 | valid_accuracy: 0.65376 |  0:24:50s

Early stopping occurred at epoch 85 with best_epoch = 65 and best_valid_accuracy = 0.68083
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 3/5; 69/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.686 total time=25.0min
[CV 4/5; 69/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.82984 | train_auc: 0.53573 | train_balanced_accuracy: 0.51959 | train_accuracy: 0.51747 | valid_auc: 0.53585 | valid_balanced_accuracy: 0.52006 | valid_accuracy: 0.51794 |  0:00:16s
epoch 1  | loss: 0.73833 | train_auc: 0.51846 | train_balanced_accuracy: 0.50884 | train_accuracy: 0.50586 | valid_auc: 0.52205 | valid_balanced_accuracy: 0.50711 | valid_accuracy: 0.50409 |  0:00:34s
epoch 2  | loss: 0.70154 | train_auc: 0.54021 | train_balanced_accuracy: 0.51498 | train_accuracy: 0.51216 | valid_auc: 0.54231 | valid_balanced_accuracy: 0.51372 | valid_accuracy: 0.51086 |  0:00:51s
epoch 3  | loss: 0.69317 | train_auc: 0.5454  | train_balanced_accuracy: 0.51509 | train_accuracy: 0.51212 | valid_auc: 0.54764 | valid_balanced_accuracy: 0.51418 | valid_accuracy: 0.51117 |  0:01:09s
epoch 4  | loss: 0.68245 | train_auc: 0.56262 | train_balanced_accuracy: 0.52998 | train_accuracy: 0.52742 | valid_auc: 0.56584 | valid_balanced_accuracy: 0.52408 | valid_accuracy: 0.52156 |  0:01:26s
epoch 5  | loss: 0.67545 | train_auc: 0.57789 | train_balanced_accuracy: 0.53423 | train_accuracy: 0.53175 | valid_auc: 0.57787 | valid_balanced_accuracy: 0.53491 | valid_accuracy: 0.53242 |  0:01:44s
epoch 6  | loss: 0.66675 | train_auc: 0.60157 | train_balanced_accuracy: 0.54923 | train_accuracy: 0.54686 | valid_auc: 0.59689 | valid_balanced_accuracy: 0.54598 | valid_accuracy: 0.54359 |  0:02:01s
epoch 7  | loss: 0.66377 | train_auc: 0.6166  | train_balanced_accuracy: 0.54746 | train_accuracy: 0.54481 | valid_auc: 0.60608 | valid_balanced_accuracy: 0.54248 | valid_accuracy: 0.53982 |  0:02:17s
epoch 8  | loss: 0.65849 | train_auc: 0.61867 | train_balanced_accuracy: 0.56291 | train_accuracy: 0.56063 | valid_auc: 0.60845 | valid_balanced_accuracy: 0.56023 | valid_accuracy: 0.55792 |  0:02:35s
epoch 9  | loss: 0.6533  | train_auc: 0.63554 | train_balanced_accuracy: 0.57034 | train_accuracy: 0.56819 | valid_auc: 0.62322 | valid_balanced_accuracy: 0.56682 | valid_accuracy: 0.56468 |  0:02:52s
epoch 10 | loss: 0.64766 | train_auc: 0.64343 | train_balanced_accuracy: 0.58434 | train_accuracy: 0.5827  | valid_auc: 0.63225 | valid_balanced_accuracy: 0.57477 | valid_accuracy: 0.57318 |  0:03:08s
epoch 11 | loss: 0.64922 | train_auc: 0.65423 | train_balanced_accuracy: 0.58687 | train_accuracy: 0.5851  | valid_auc: 0.64084 | valid_balanced_accuracy: 0.57571 | valid_accuracy: 0.57397 |  0:03:25s
epoch 12 | loss: 0.64031 | train_auc: 0.66256 | train_balanced_accuracy: 0.59543 | train_accuracy: 0.59384 | valid_auc: 0.64761 | valid_balanced_accuracy: 0.58186 | valid_accuracy: 0.58026 |  0:03:43s
epoch 13 | loss: 0.64042 | train_auc: 0.66843 | train_balanced_accuracy: 0.59475 | train_accuracy: 0.59301 | valid_auc: 0.65498 | valid_balanced_accuracy: 0.57884 | valid_accuracy: 0.57712 |  0:04:00s
epoch 14 | loss: 0.63736 | train_auc: 0.67602 | train_balanced_accuracy: 0.61075 | train_accuracy: 0.60966 | valid_auc: 0.66023 | valid_balanced_accuracy: 0.60087 | valid_accuracy: 0.59978 |  0:04:16s
epoch 15 | loss: 0.63995 | train_auc: 0.6764  | train_balanced_accuracy: 0.61119 | train_accuracy: 0.60989 | valid_auc: 0.65884 | valid_balanced_accuracy: 0.59433 | valid_accuracy: 0.59301 |  0:04:33s
epoch 16 | loss: 0.63162 | train_auc: 0.68319 | train_balanced_accuracy: 0.61793 | train_accuracy: 0.61686 | valid_auc: 0.66616 | valid_balanced_accuracy: 0.60509 | valid_accuracy: 0.60403 |  0:04:51s
epoch 17 | loss: 0.6257  | train_auc: 0.68958 | train_balanced_accuracy: 0.62231 | train_accuracy: 0.6213  | valid_auc: 0.67612 | valid_balanced_accuracy: 0.61163 | valid_accuracy: 0.61064 |  0:05:10s
epoch 18 | loss: 0.63454 | train_auc: 0.69505 | train_balanced_accuracy: 0.63536 | train_accuracy: 0.63472 | valid_auc: 0.6816  | valid_balanced_accuracy: 0.62621 | valid_accuracy: 0.62559 |  0:05:29s
epoch 19 | loss: 0.62411 | train_auc: 0.69899 | train_balanced_accuracy: 0.6384  | train_accuracy: 0.63783 | valid_auc: 0.68569 | valid_balanced_accuracy: 0.62657 | valid_accuracy: 0.62606 |  0:05:47s
epoch 20 | loss: 0.62452 | train_auc: 0.69993 | train_balanced_accuracy: 0.64688 | train_accuracy: 0.6468  | valid_auc: 0.68371 | valid_balanced_accuracy: 0.63433 | valid_accuracy: 0.63425 |  0:06:03s
epoch 21 | loss: 0.62295 | train_auc: 0.70333 | train_balanced_accuracy: 0.6474  | train_accuracy: 0.64735 | valid_auc: 0.69148 | valid_balanced_accuracy: 0.63711 | valid_accuracy: 0.63708 |  0:06:21s
epoch 22 | loss: 0.62486 | train_auc: 0.7075  | train_balanced_accuracy: 0.64873 | train_accuracy: 0.64857 | valid_auc: 0.69435 | valid_balanced_accuracy: 0.64038 | valid_accuracy: 0.64023 |  0:06:40s
epoch 23 | loss: 0.62014 | train_auc: 0.71127 | train_balanced_accuracy: 0.64948 | train_accuracy: 0.64924 | valid_auc: 0.69591 | valid_balanced_accuracy: 0.63812 | valid_accuracy: 0.63787 |  0:06:58s
epoch 24 | loss: 0.62098 | train_auc: 0.7141  | train_balanced_accuracy: 0.65484 | train_accuracy: 0.65463 | valid_auc: 0.69988 | valid_balanced_accuracy: 0.64576 | valid_accuracy: 0.64558 |  0:07:15s
epoch 25 | loss: 0.61624 | train_auc: 0.71759 | train_balanced_accuracy: 0.6549  | train_accuracy: 0.65459 | valid_auc: 0.69885 | valid_balanced_accuracy: 0.64115 | valid_accuracy: 0.64086 |  0:07:32s
epoch 26 | loss: 0.61484 | train_auc: 0.7217  | train_balanced_accuracy: 0.66023 | train_accuracy: 0.65998 | valid_auc: 0.70524 | valid_balanced_accuracy: 0.64486 | valid_accuracy: 0.64463 |  0:07:48s
epoch 27 | loss: 0.61683 | train_auc: 0.71964 | train_balanced_accuracy: 0.65897 | train_accuracy: 0.65872 | valid_auc: 0.70334 | valid_balanced_accuracy: 0.64409 | valid_accuracy: 0.64385 |  0:08:06s
epoch 28 | loss: 0.61428 | train_auc: 0.72563 | train_balanced_accuracy: 0.66603 | train_accuracy: 0.66592 | valid_auc: 0.70845 | valid_balanced_accuracy: 0.64975 | valid_accuracy: 0.64967 |  0:08:22s
epoch 29 | loss: 0.61266 | train_auc: 0.72865 | train_balanced_accuracy: 0.66811 | train_accuracy: 0.6682  | valid_auc: 0.7122  | valid_balanced_accuracy: 0.65649 | valid_accuracy: 0.65659 |  0:08:40s
epoch 30 | loss: 0.60741 | train_auc: 0.73327 | train_balanced_accuracy: 0.67177 | train_accuracy: 0.6719  | valid_auc: 0.71818 | valid_balanced_accuracy: 0.66103 | valid_accuracy: 0.66116 |  0:08:58s
epoch 31 | loss: 0.60942 | train_auc: 0.73133 | train_balanced_accuracy: 0.6693  | train_accuracy: 0.66962 | valid_auc: 0.71787 | valid_balanced_accuracy: 0.66209 | valid_accuracy: 0.66242 |  0:09:15s
epoch 32 | loss: 0.60606 | train_auc: 0.72764 | train_balanced_accuracy: 0.6642  | train_accuracy: 0.66462 | valid_auc: 0.71302 | valid_balanced_accuracy: 0.65978 | valid_accuracy: 0.66021 |  0:09:32s
epoch 33 | loss: 0.6104  | train_auc: 0.72965 | train_balanced_accuracy: 0.66598 | train_accuracy: 0.66643 | valid_auc: 0.7179  | valid_balanced_accuracy: 0.65996 | valid_accuracy: 0.66037 |  0:09:49s
epoch 34 | loss: 0.60764 | train_auc: 0.74031 | train_balanced_accuracy: 0.67691 | train_accuracy: 0.67725 | valid_auc: 0.72213 | valid_balanced_accuracy: 0.66235 | valid_accuracy: 0.66273 |  0:10:05s
epoch 35 | loss: 0.60299 | train_auc: 0.73919 | train_balanced_accuracy: 0.67648 | train_accuracy: 0.6769  | valid_auc: 0.72324 | valid_balanced_accuracy: 0.66229 | valid_accuracy: 0.66273 |  0:10:24s
epoch 36 | loss: 0.60391 | train_auc: 0.74114 | train_balanced_accuracy: 0.67594 | train_accuracy: 0.67631 | valid_auc: 0.72384 | valid_balanced_accuracy: 0.665   | valid_accuracy: 0.66541 |  0:10:43s
epoch 37 | loss: 0.6019  | train_auc: 0.73916 | train_balanced_accuracy: 0.67442 | train_accuracy: 0.67461 | valid_auc: 0.71879 | valid_balanced_accuracy: 0.6606  | valid_accuracy: 0.66084 |  0:11:00s
epoch 38 | loss: 0.60401 | train_auc: 0.74369 | train_balanced_accuracy: 0.68004 | train_accuracy: 0.68032 | valid_auc: 0.72444 | valid_balanced_accuracy: 0.67074 | valid_accuracy: 0.67107 |  0:11:17s
epoch 39 | loss: 0.60246 | train_auc: 0.74363 | train_balanced_accuracy: 0.67864 | train_accuracy: 0.67867 | valid_auc: 0.72584 | valid_balanced_accuracy: 0.66236 | valid_accuracy: 0.66242 |  0:11:34s
epoch 40 | loss: 0.60016 | train_auc: 0.74244 | train_balanced_accuracy: 0.68111 | train_accuracy: 0.68134 | valid_auc: 0.72392 | valid_balanced_accuracy: 0.65994 | valid_accuracy: 0.66021 |  0:11:51s
epoch 41 | loss: 0.60328 | train_auc: 0.74021 | train_balanced_accuracy: 0.67771 | train_accuracy: 0.678   | valid_auc: 0.72021 | valid_balanced_accuracy: 0.6618  | valid_accuracy: 0.6621  |  0:12:10s
epoch 42 | loss: 0.5995  | train_auc: 0.74027 | train_balanced_accuracy: 0.68157 | train_accuracy: 0.68181 | valid_auc: 0.72296 | valid_balanced_accuracy: 0.66209 | valid_accuracy: 0.66242 |  0:12:28s
epoch 43 | loss: 0.60088 | train_auc: 0.74375 | train_balanced_accuracy: 0.68105 | train_accuracy: 0.68119 | valid_auc: 0.72787 | valid_balanced_accuracy: 0.66899 | valid_accuracy: 0.66918 |  0:12:47s
epoch 44 | loss: 0.60146 | train_auc: 0.74065 | train_balanced_accuracy: 0.67645 | train_accuracy: 0.67642 | valid_auc: 0.72433 | valid_balanced_accuracy: 0.66037 | valid_accuracy: 0.66037 |  0:13:03s
epoch 45 | loss: 0.59744 | train_auc: 0.73474 | train_balanced_accuracy: 0.67106 | train_accuracy: 0.67139 | valid_auc: 0.72079 | valid_balanced_accuracy: 0.66032 | valid_accuracy: 0.66069 |  0:13:20s
epoch 46 | loss: 0.60424 | train_auc: 0.73956 | train_balanced_accuracy: 0.67556 | train_accuracy: 0.67576 | valid_auc: 0.72325 | valid_balanced_accuracy: 0.66294 | valid_accuracy: 0.6632  |  0:13:39s
epoch 47 | loss: 0.59656 | train_auc: 0.72979 | train_balanced_accuracy: 0.6668  | train_accuracy: 0.66714 | valid_auc: 0.71706 | valid_balanced_accuracy: 0.65981 | valid_accuracy: 0.66021 |  0:13:57s
epoch 48 | loss: 0.5992  | train_auc: 0.74051 | train_balanced_accuracy: 0.67753 | train_accuracy: 0.67792 | valid_auc: 0.72605 | valid_balanced_accuracy: 0.66745 | valid_accuracy: 0.66793 |  0:14:14s
epoch 49 | loss: 0.59771 | train_auc: 0.73959 | train_balanced_accuracy: 0.67841 | train_accuracy: 0.67875 | valid_auc: 0.72105 | valid_balanced_accuracy: 0.65856 | valid_accuracy: 0.65895 |  0:14:33s
epoch 50 | loss: 0.59963 | train_auc: 0.72701 | train_balanced_accuracy: 0.66864 | train_accuracy: 0.66891 | valid_auc: 0.71523 | valid_balanced_accuracy: 0.65879 | valid_accuracy: 0.65911 |  0:14:51s
epoch 51 | loss: 0.59424 | train_auc: 0.68813 | train_balanced_accuracy: 0.63077 | train_accuracy: 0.63169 | valid_auc: 0.67958 | valid_balanced_accuracy: 0.62379 | valid_accuracy: 0.6248  |  0:15:09s
epoch 52 | loss: 0.59139 | train_auc: 0.66771 | train_balanced_accuracy: 0.61805 | train_accuracy: 0.6189  | valid_auc: 0.66239 | valid_balanced_accuracy: 0.61522 | valid_accuracy: 0.61615 |  0:15:26s
epoch 53 | loss: 0.59413 | train_auc: 0.68547 | train_balanced_accuracy: 0.6324  | train_accuracy: 0.63311 | valid_auc: 0.68348 | valid_balanced_accuracy: 0.63299 | valid_accuracy: 0.63377 |  0:15:43s
epoch 54 | loss: 0.59741 | train_auc: 0.6624  | train_balanced_accuracy: 0.61847 | train_accuracy: 0.6191  | valid_auc: 0.66251 | valid_balanced_accuracy: 0.62569 | valid_accuracy: 0.62638 |  0:16:01s
epoch 55 | loss: 0.59411 | train_auc: 0.64793 | train_balanced_accuracy: 0.61205 | train_accuracy: 0.61272 | valid_auc: 0.64489 | valid_balanced_accuracy: 0.61048 | valid_accuracy: 0.61127 |  0:16:21s
epoch 56 | loss: 0.59385 | train_auc: 0.62246 | train_balanced_accuracy: 0.58847 | train_accuracy: 0.58904 | valid_auc: 0.63117 | valid_balanced_accuracy: 0.59992 | valid_accuracy: 0.60057 |  0:16:37s
epoch 57 | loss: 0.59611 | train_auc: 0.61139 | train_balanced_accuracy: 0.58716 | train_accuracy: 0.58762 | valid_auc: 0.61916 | valid_balanced_accuracy: 0.59637 | valid_accuracy: 0.59695 |  0:16:55s
epoch 58 | loss: 0.59682 | train_auc: 0.64105 | train_balanced_accuracy: 0.60195 | train_accuracy: 0.6023  | valid_auc: 0.64679 | valid_balanced_accuracy: 0.60181 | valid_accuracy: 0.6023  |  0:17:13s

Early stopping occurred at epoch 58 with best_epoch = 38 and best_valid_accuracy = 0.67107
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 4/5; 69/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.668 total time=17.3min
[CV 5/5; 69/69] START classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:75: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_dims changed from [] to [2, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 47, 2, 2, 2, 2, 2, 2]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_emb_dim changed from 1 to [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
  warnings.warn(wrn_msg)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/abstract_model.py:105: UserWarning: Pretraining: cat_idxs changed from [] to [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23]
  warnings.warn(wrn_msg)
epoch 0  | loss: 0.84175 | train_auc: 0.51352 | train_balanced_accuracy: 0.50936 | train_accuracy: 0.50732 | valid_auc: 0.51717 | valid_balanced_accuracy: 0.51503 | valid_accuracy: 0.51291 |  0:00:18s
epoch 1  | loss: 0.75409 | train_auc: 0.49073 | train_balanced_accuracy: 0.50955 | train_accuracy: 0.50704 | valid_auc: 0.49849 | valid_balanced_accuracy: 0.51769 | valid_accuracy: 0.51511 |  0:00:34s
epoch 2  | loss: 0.71658 | train_auc: 0.5203  | train_balanced_accuracy: 0.51483 | train_accuracy: 0.51204 | valid_auc: 0.52534 | valid_balanced_accuracy: 0.52034 | valid_accuracy: 0.51747 |  0:00:52s
epoch 3  | loss: 0.69343 | train_auc: 0.54547 | train_balanced_accuracy: 0.51768 | train_accuracy: 0.51475 | valid_auc: 0.54703 | valid_balanced_accuracy: 0.52487 | valid_accuracy: 0.52188 |  0:01:09s
epoch 4  | loss: 0.67584 | train_auc: 0.57788 | train_balanced_accuracy: 0.52864 | train_accuracy: 0.52589 | valid_auc: 0.58032 | valid_balanced_accuracy: 0.53602 | valid_accuracy: 0.53321 |  0:01:26s
epoch 5  | loss: 0.67003 | train_auc: 0.59374 | train_balanced_accuracy: 0.53618 | train_accuracy: 0.5334  | valid_auc: 0.59253 | valid_balanced_accuracy: 0.53965 | valid_accuracy: 0.53683 |  0:01:42s
epoch 6  | loss: 0.66319 | train_auc: 0.6137  | train_balanced_accuracy: 0.55725 | train_accuracy: 0.555   | valid_auc: 0.61014 | valid_balanced_accuracy: 0.56645 | valid_accuracy: 0.56421 |  0:02:00s
epoch 7  | loss: 0.65787 | train_auc: 0.62817 | train_balanced_accuracy: 0.57965 | train_accuracy: 0.57771 | valid_auc: 0.62444 | valid_balanced_accuracy: 0.58019 | valid_accuracy: 0.57822 |  0:02:18s
epoch 8  | loss: 0.65265 | train_auc: 0.63605 | train_balanced_accuracy: 0.57675 | train_accuracy: 0.57487 | valid_auc: 0.63163 | valid_balanced_accuracy: 0.57778 | valid_accuracy: 0.57586 |  0:02:35s
epoch 9  | loss: 0.64783 | train_auc: 0.63829 | train_balanced_accuracy: 0.58067 | train_accuracy: 0.57901 | valid_auc: 0.63297 | valid_balanced_accuracy: 0.57664 | valid_accuracy: 0.57491 |  0:02:53s
epoch 10 | loss: 0.64691 | train_auc: 0.65632 | train_balanced_accuracy: 0.60028 | train_accuracy: 0.59872 | valid_auc: 0.65273 | valid_balanced_accuracy: 0.59461 | valid_accuracy: 0.59301 |  0:03:11s
epoch 11 | loss: 0.64133 | train_auc: 0.65851 | train_balanced_accuracy: 0.60495 | train_accuracy: 0.60352 | valid_auc: 0.65453 | valid_balanced_accuracy: 0.60172 | valid_accuracy: 0.60025 |  0:03:30s
epoch 12 | loss: 0.64145 | train_auc: 0.66377 | train_balanced_accuracy: 0.60092 | train_accuracy: 0.59935 | valid_auc: 0.65967 | valid_balanced_accuracy: 0.59979 | valid_accuracy: 0.59821 |  0:03:48s
epoch 13 | loss: 0.64305 | train_auc: 0.67488 | train_balanced_accuracy: 0.61455 | train_accuracy: 0.61363 | valid_auc: 0.6705  | valid_balanced_accuracy: 0.61157 | valid_accuracy: 0.61064 |  0:04:06s
epoch 14 | loss: 0.63297 | train_auc: 0.68492 | train_balanced_accuracy: 0.62209 | train_accuracy: 0.6211  | valid_auc: 0.67882 | valid_balanced_accuracy: 0.61858 | valid_accuracy: 0.61756 |  0:04:24s
epoch 15 | loss: 0.63127 | train_auc: 0.69314 | train_balanced_accuracy: 0.63305 | train_accuracy: 0.63255 | valid_auc: 0.68787 | valid_balanced_accuracy: 0.62882 | valid_accuracy: 0.62827 |  0:04:43s
epoch 16 | loss: 0.63071 | train_auc: 0.69753 | train_balanced_accuracy: 0.63878 | train_accuracy: 0.63834 | valid_auc: 0.69118 | valid_balanced_accuracy: 0.6319  | valid_accuracy: 0.63141 |  0:05:03s
epoch 17 | loss: 0.62982 | train_auc: 0.70283 | train_balanced_accuracy: 0.64149 | train_accuracy: 0.64113 | valid_auc: 0.69652 | valid_balanced_accuracy: 0.63778 | valid_accuracy: 0.63739 |  0:05:21s
epoch 18 | loss: 0.62997 | train_auc: 0.70367 | train_balanced_accuracy: 0.64288 | train_accuracy: 0.64243 | valid_auc: 0.6942  | valid_balanced_accuracy: 0.63803 | valid_accuracy: 0.63755 |  0:05:39s
epoch 19 | loss: 0.62511 | train_auc: 0.7083  | train_balanced_accuracy: 0.65052 | train_accuracy: 0.65046 | valid_auc: 0.70118 | valid_balanced_accuracy: 0.6411  | valid_accuracy: 0.64101 |  0:05:56s
epoch 20 | loss: 0.62183 | train_auc: 0.71195 | train_balanced_accuracy: 0.65582 | train_accuracy: 0.65581 | valid_auc: 0.70468 | valid_balanced_accuracy: 0.64731 | valid_accuracy: 0.64731 |  0:06:14s
epoch 21 | loss: 0.62056 | train_auc: 0.71341 | train_balanced_accuracy: 0.65798 | train_accuracy: 0.65789 | valid_auc: 0.70393 | valid_balanced_accuracy: 0.64926 | valid_accuracy: 0.6492  |  0:06:33s
epoch 22 | loss: 0.61793 | train_auc: 0.71762 | train_balanced_accuracy: 0.65879 | train_accuracy: 0.65895 | valid_auc: 0.70736 | valid_balanced_accuracy: 0.64697 | valid_accuracy: 0.64715 |  0:06:51s
epoch 23 | loss: 0.61695 | train_auc: 0.71895 | train_balanced_accuracy: 0.66155 | train_accuracy: 0.66183 | valid_auc: 0.70801 | valid_balanced_accuracy: 0.65003 | valid_accuracy: 0.6503  |  0:07:08s
epoch 24 | loss: 0.6202  | train_auc: 0.72105 | train_balanced_accuracy: 0.66179 | train_accuracy: 0.6621  | valid_auc: 0.71281 | valid_balanced_accuracy: 0.65547 | valid_accuracy: 0.65581 |  0:07:24s
epoch 25 | loss: 0.61676 | train_auc: 0.72381 | train_balanced_accuracy: 0.66263 | train_accuracy: 0.66289 | valid_auc: 0.71541 | valid_balanced_accuracy: 0.65446 | valid_accuracy: 0.65471 |  0:07:41s
epoch 26 | loss: 0.61597 | train_auc: 0.72606 | train_balanced_accuracy: 0.66823 | train_accuracy: 0.66856 | valid_auc: 0.7138  | valid_balanced_accuracy: 0.65498 | valid_accuracy: 0.65534 |  0:07:59s
epoch 27 | loss: 0.61304 | train_auc: 0.72654 | train_balanced_accuracy: 0.66557 | train_accuracy: 0.666   | valid_auc: 0.71265 | valid_balanced_accuracy: 0.65191 | valid_accuracy: 0.65234 |  0:08:17s
epoch 28 | loss: 0.61439 | train_auc: 0.72857 | train_balanced_accuracy: 0.666   | train_accuracy: 0.66604 | valid_auc: 0.71515 | valid_balanced_accuracy: 0.65688 | valid_accuracy: 0.65691 |  0:08:34s
epoch 29 | loss: 0.61424 | train_auc: 0.727   | train_balanced_accuracy: 0.66336 | train_accuracy: 0.66372 | valid_auc: 0.7125  | valid_balanced_accuracy: 0.65356 | valid_accuracy: 0.65392 |  0:08:51s
epoch 30 | loss: 0.61384 | train_auc: 0.72367 | train_balanced_accuracy: 0.66213 | train_accuracy: 0.66242 | valid_auc: 0.71464 | valid_balanced_accuracy: 0.65582 | valid_accuracy: 0.65612 |  0:09:10s
epoch 31 | loss: 0.60972 | train_auc: 0.72367 | train_balanced_accuracy: 0.66416 | train_accuracy: 0.66423 | valid_auc: 0.71246 | valid_balanced_accuracy: 0.65386 | valid_accuracy: 0.65392 |  0:09:28s
epoch 32 | loss: 0.61348 | train_auc: 0.72035 | train_balanced_accuracy: 0.66025 | train_accuracy: 0.66045 | valid_auc: 0.71344 | valid_balanced_accuracy: 0.65133 | valid_accuracy: 0.65156 |  0:09:45s
epoch 33 | loss: 0.615   | train_auc: 0.72407 | train_balanced_accuracy: 0.66497 | train_accuracy: 0.66529 | valid_auc: 0.71313 | valid_balanced_accuracy: 0.65468 | valid_accuracy: 0.65502 |  0:10:01s
epoch 34 | loss: 0.60687 | train_auc: 0.71186 | train_balanced_accuracy: 0.65781 | train_accuracy: 0.65785 | valid_auc: 0.70772 | valid_balanced_accuracy: 0.6504  | valid_accuracy: 0.65046 |  0:10:21s
epoch 35 | loss: 0.61096 | train_auc: 0.71207 | train_balanced_accuracy: 0.65648 | train_accuracy: 0.65671 | valid_auc: 0.70627 | valid_balanced_accuracy: 0.65449 | valid_accuracy: 0.65471 |  0:10:40s
epoch 36 | loss: 0.60562 | train_auc: 0.7133  | train_balanced_accuracy: 0.65529 | train_accuracy: 0.65577 | valid_auc: 0.70546 | valid_balanced_accuracy: 0.65062 | valid_accuracy: 0.65109 |  0:10:57s
epoch 37 | loss: 0.60712 | train_auc: 0.72542 | train_balanced_accuracy: 0.66714 | train_accuracy: 0.66722 | valid_auc: 0.71375 | valid_balanced_accuracy: 0.65903 | valid_accuracy: 0.65911 |  0:11:15s
epoch 38 | loss: 0.60802 | train_auc: 0.71852 | train_balanced_accuracy: 0.65953 | train_accuracy: 0.65986 | valid_auc: 0.714   | valid_balanced_accuracy: 0.65029 | valid_accuracy: 0.65061 |  0:11:32s
epoch 39 | loss: 0.60718 | train_auc: 0.72025 | train_balanced_accuracy: 0.661   | train_accuracy: 0.66108 | valid_auc: 0.71109 | valid_balanced_accuracy: 0.65591 | valid_accuracy: 0.65596 |  0:11:49s
epoch 40 | loss: 0.60614 | train_auc: 0.71979 | train_balanced_accuracy: 0.66331 | train_accuracy: 0.66372 | valid_auc: 0.70945 | valid_balanced_accuracy: 0.65132 | valid_accuracy: 0.65172 |  0:12:07s
epoch 41 | loss: 0.60611 | train_auc: 0.713   | train_balanced_accuracy: 0.65469 | train_accuracy: 0.65494 | valid_auc: 0.70774 | valid_balanced_accuracy: 0.65542 | valid_accuracy: 0.65565 |  0:12:25s
epoch 42 | loss: 0.60757 | train_auc: 0.7159  | train_balanced_accuracy: 0.65882 | train_accuracy: 0.65888 | valid_auc: 0.70863 | valid_balanced_accuracy: 0.6543  | valid_accuracy: 0.65439 |  0:12:43s
epoch 43 | loss: 0.60273 | train_auc: 0.7427  | train_balanced_accuracy: 0.67859 | train_accuracy: 0.67898 | valid_auc: 0.72663 | valid_balanced_accuracy: 0.66363 | valid_accuracy: 0.66399 |  0:12:59s
epoch 44 | loss: 0.60249 | train_auc: 0.73709 | train_balanced_accuracy: 0.6765  | train_accuracy: 0.67682 | valid_auc: 0.72295 | valid_balanced_accuracy: 0.66054 | valid_accuracy: 0.66084 |  0:13:18s
epoch 45 | loss: 0.60226 | train_auc: 0.7288  | train_balanced_accuracy: 0.6669  | train_accuracy: 0.66757 | valid_auc: 0.71686 | valid_balanced_accuracy: 0.65423 | valid_accuracy: 0.65486 |  0:13:34s
epoch 46 | loss: 0.60561 | train_auc: 0.72798 | train_balanced_accuracy: 0.66931 | train_accuracy: 0.66985 | valid_auc: 0.71315 | valid_balanced_accuracy: 0.65843 | valid_accuracy: 0.65895 |  0:13:51s
epoch 47 | loss: 0.60543 | train_auc: 0.72441 | train_balanced_accuracy: 0.66574 | train_accuracy: 0.66616 | valid_auc: 0.71412 | valid_balanced_accuracy: 0.65589 | valid_accuracy: 0.65628 |  0:14:08s
epoch 48 | loss: 0.60319 | train_auc: 0.72813 | train_balanced_accuracy: 0.67164 | train_accuracy: 0.6721  | valid_auc: 0.71613 | valid_balanced_accuracy: 0.65805 | valid_accuracy: 0.65848 |  0:14:28s
epoch 49 | loss: 0.5999  | train_auc: 0.73875 | train_balanced_accuracy: 0.67648 | train_accuracy: 0.67686 | valid_auc: 0.72674 | valid_balanced_accuracy: 0.66131 | valid_accuracy: 0.66163 |  0:14:47s
epoch 50 | loss: 0.59878 | train_auc: 0.73313 | train_balanced_accuracy: 0.67287 | train_accuracy: 0.67308 | valid_auc: 0.72248 | valid_balanced_accuracy: 0.66049 | valid_accuracy: 0.66069 |  0:15:04s
epoch 51 | loss: 0.60235 | train_auc: 0.71733 | train_balanced_accuracy: 0.66388 | train_accuracy: 0.66423 | valid_auc: 0.70779 | valid_balanced_accuracy: 0.65152 | valid_accuracy: 0.65187 |  0:15:23s
epoch 52 | loss: 0.60056 | train_auc: 0.72239 | train_balanced_accuracy: 0.66607 | train_accuracy: 0.66655 | valid_auc: 0.71038 | valid_balanced_accuracy: 0.65789 | valid_accuracy: 0.65833 |  0:15:41s
epoch 53 | loss: 0.60444 | train_auc: 0.72482 | train_balanced_accuracy: 0.6673  | train_accuracy: 0.66789 | valid_auc: 0.71095 | valid_balanced_accuracy: 0.6543  | valid_accuracy: 0.65486 |  0:15:59s
epoch 54 | loss: 0.60548 | train_auc: 0.73157 | train_balanced_accuracy: 0.6712  | train_accuracy: 0.67155 | valid_auc: 0.71869 | valid_balanced_accuracy: 0.66255 | valid_accuracy: 0.66289 |  0:16:15s
epoch 55 | loss: 0.60436 | train_auc: 0.73672 | train_balanced_accuracy: 0.67503 | train_accuracy: 0.6752  | valid_auc: 0.72183 | valid_balanced_accuracy: 0.66099 | valid_accuracy: 0.66116 |  0:16:33s
epoch 56 | loss: 0.6034  | train_auc: 0.741   | train_balanced_accuracy: 0.6766  | train_accuracy: 0.67705 | valid_auc: 0.72809 | valid_balanced_accuracy: 0.66833 | valid_accuracy: 0.66871 |  0:16:51s
epoch 57 | loss: 0.5973  | train_auc: 0.75092 | train_balanced_accuracy: 0.68774 | train_accuracy: 0.68807 | valid_auc: 0.73335 | valid_balanced_accuracy: 0.67139 | valid_accuracy: 0.6717  |  0:17:10s
epoch 58 | loss: 0.59796 | train_auc: 0.74736 | train_balanced_accuracy: 0.68398 | train_accuracy: 0.68394 | valid_auc: 0.73301 | valid_balanced_accuracy: 0.66832 | valid_accuracy: 0.66824 |  0:17:29s
epoch 59 | loss: 0.60234 | train_auc: 0.75092 | train_balanced_accuracy: 0.68421 | train_accuracy: 0.68449 | valid_auc: 0.7353  | valid_balanced_accuracy: 0.67272 | valid_accuracy: 0.67296 |  0:17:45s
epoch 60 | loss: 0.6003  | train_auc: 0.75104 | train_balanced_accuracy: 0.6843  | train_accuracy: 0.68441 | valid_auc: 0.73481 | valid_balanced_accuracy: 0.67303 | valid_accuracy: 0.67312 |  0:18:03s
epoch 61 | loss: 0.6044  | train_auc: 0.75004 | train_balanced_accuracy: 0.68551 | train_accuracy: 0.68551 | valid_auc: 0.7375  | valid_balanced_accuracy: 0.67611 | valid_accuracy: 0.67611 |  0:18:21s
epoch 62 | loss: 0.59423 | train_auc: 0.74114 | train_balanced_accuracy: 0.6778  | train_accuracy: 0.67816 | valid_auc: 0.73013 | valid_balanced_accuracy: 0.66618 | valid_accuracy: 0.66651 |  0:18:39s
epoch 63 | loss: 0.59783 | train_auc: 0.74117 | train_balanced_accuracy: 0.67709 | train_accuracy: 0.67737 | valid_auc: 0.73138 | valid_balanced_accuracy: 0.66593 | valid_accuracy: 0.66619 |  0:18:56s
epoch 64 | loss: 0.59452 | train_auc: 0.7432  | train_balanced_accuracy: 0.68051 | train_accuracy: 0.68079 | valid_auc: 0.72973 | valid_balanced_accuracy: 0.66168 | valid_accuracy: 0.66195 |  0:19:15s
epoch 65 | loss: 0.60463 | train_auc: 0.74438 | train_balanced_accuracy: 0.68198 | train_accuracy: 0.68217 | valid_auc: 0.73006 | valid_balanced_accuracy: 0.66698 | valid_accuracy: 0.66714 |  0:19:32s
epoch 66 | loss: 0.59613 | train_auc: 0.7463  | train_balanced_accuracy: 0.68397 | train_accuracy: 0.68414 | valid_auc: 0.72877 | valid_balanced_accuracy: 0.6662  | valid_accuracy: 0.66635 |  0:19:50s
epoch 67 | loss: 0.59702 | train_auc: 0.74569 | train_balanced_accuracy: 0.68076 | train_accuracy: 0.68126 | valid_auc: 0.73079 | valid_balanced_accuracy: 0.6665  | valid_accuracy: 0.66698 |  0:20:09s
epoch 68 | loss: 0.59631 | train_auc: 0.73308 | train_balanced_accuracy: 0.67094 | train_accuracy: 0.67115 | valid_auc: 0.72028 | valid_balanced_accuracy: 0.66317 | valid_accuracy: 0.66336 |  0:20:25s
epoch 69 | loss: 0.59611 | train_auc: 0.75371 | train_balanced_accuracy: 0.68686 | train_accuracy: 0.68732 | valid_auc: 0.73675 | valid_balanced_accuracy: 0.67361 | valid_accuracy: 0.67406 |  0:20:43s
epoch 70 | loss: 0.59546 | train_auc: 0.75369 | train_balanced_accuracy: 0.68791 | train_accuracy: 0.68807 | valid_auc: 0.7368  | valid_balanced_accuracy: 0.6725  | valid_accuracy: 0.67265 |  0:21:00s
epoch 71 | loss: 0.59723 | train_auc: 0.75253 | train_balanced_accuracy: 0.687   | train_accuracy: 0.68744 | valid_auc: 0.73198 | valid_balanced_accuracy: 0.6669  | valid_accuracy: 0.6673  |  0:21:19s
epoch 72 | loss: 0.59299 | train_auc: 0.75675 | train_balanced_accuracy: 0.69194 | train_accuracy: 0.6922  | valid_auc: 0.73702 | valid_balanced_accuracy: 0.67712 | valid_accuracy: 0.67737 |  0:21:37s
epoch 73 | loss: 0.59217 | train_auc: 0.75253 | train_balanced_accuracy: 0.687   | train_accuracy: 0.6874  | valid_auc: 0.73489 | valid_balanced_accuracy: 0.67181 | valid_accuracy: 0.67218 |  0:21:54s
epoch 74 | loss: 0.59302 | train_auc: 0.75743 | train_balanced_accuracy: 0.69047 | train_accuracy: 0.69055 | valid_auc: 0.73772 | valid_balanced_accuracy: 0.67794 | valid_accuracy: 0.678   |  0:22:12s
epoch 75 | loss: 0.59123 | train_auc: 0.75848 | train_balanced_accuracy: 0.69124 | train_accuracy: 0.69145 | valid_auc: 0.7389  | valid_balanced_accuracy: 0.67545 | valid_accuracy: 0.67564 |  0:22:31s
epoch 76 | loss: 0.59155 | train_auc: 0.75526 | train_balanced_accuracy: 0.68802 | train_accuracy: 0.68831 | valid_auc: 0.73842 | valid_balanced_accuracy: 0.67347 | valid_accuracy: 0.67375 |  0:22:47s
epoch 77 | loss: 0.59079 | train_auc: 0.74509 | train_balanced_accuracy: 0.6837  | train_accuracy: 0.68406 | valid_auc: 0.73105 | valid_balanced_accuracy: 0.6687  | valid_accuracy: 0.66903 |  0:23:05s
epoch 78 | loss: 0.58992 | train_auc: 0.73339 | train_balanced_accuracy: 0.67231 | train_accuracy: 0.67249 | valid_auc: 0.72351 | valid_balanced_accuracy: 0.66536 | valid_accuracy: 0.66556 |  0:23:25s
epoch 79 | loss: 0.59063 | train_auc: 0.75151 | train_balanced_accuracy: 0.68689 | train_accuracy: 0.68713 | valid_auc: 0.73615 | valid_balanced_accuracy: 0.67038 | valid_accuracy: 0.6706  |  0:23:43s
epoch 80 | loss: 0.59382 | train_auc: 0.74668 | train_balanced_accuracy: 0.68325 | train_accuracy: 0.6837  | valid_auc: 0.72822 | valid_balanced_accuracy: 0.66702 | valid_accuracy: 0.66745 |  0:24:02s
epoch 81 | loss: 0.58793 | train_auc: 0.7548  | train_balanced_accuracy: 0.68728 | train_accuracy: 0.68748 | valid_auc: 0.73654 | valid_balanced_accuracy: 0.67246 | valid_accuracy: 0.67265 |  0:24:19s
epoch 82 | loss: 0.59098 | train_auc: 0.75734 | train_balanced_accuracy: 0.69064 | train_accuracy: 0.69079 | valid_auc: 0.73674 | valid_balanced_accuracy: 0.67695 | valid_accuracy: 0.67705 |  0:24:38s
epoch 83 | loss: 0.58836 | train_auc: 0.76081 | train_balanced_accuracy: 0.6932  | train_accuracy: 0.69354 | valid_auc: 0.73707 | valid_balanced_accuracy: 0.6761  | valid_accuracy: 0.67642 |  0:24:58s
epoch 84 | loss: 0.59088 | train_auc: 0.75204 | train_balanced_accuracy: 0.68766 | train_accuracy: 0.68795 | valid_auc: 0.7351  | valid_balanced_accuracy: 0.6749  | valid_accuracy: 0.67517 |  0:25:15s
epoch 85 | loss: 0.59436 | train_auc: 0.7593  | train_balanced_accuracy: 0.69305 | train_accuracy: 0.6935  | valid_auc: 0.73802 | valid_balanced_accuracy: 0.67379 | valid_accuracy: 0.67422 |  0:25:31s
epoch 86 | loss: 0.58835 | train_auc: 0.75864 | train_balanced_accuracy: 0.69123 | train_accuracy: 0.69173 | valid_auc: 0.73473 | valid_balanced_accuracy: 0.66783 | valid_accuracy: 0.66824 |  0:25:48s
epoch 87 | loss: 0.58709 | train_auc: 0.75742 | train_balanced_accuracy: 0.6917  | train_accuracy: 0.69189 | valid_auc: 0.73897 | valid_balanced_accuracy: 0.67551 | valid_accuracy: 0.67564 |  0:26:06s
epoch 88 | loss: 0.59013 | train_auc: 0.75806 | train_balanced_accuracy: 0.69011 | train_accuracy: 0.69055 | valid_auc: 0.73529 | valid_balanced_accuracy: 0.67111 | valid_accuracy: 0.67155 |  0:26:23s
epoch 89 | loss: 0.58878 | train_auc: 0.75044 | train_balanced_accuracy: 0.68122 | train_accuracy: 0.68181 | valid_auc: 0.72938 | valid_balanced_accuracy: 0.66611 | valid_accuracy: 0.66667 |  0:26:42s
epoch 90 | loss: 0.58553 | train_auc: 0.7587  | train_balanced_accuracy: 0.69142 | train_accuracy: 0.69185 | valid_auc: 0.73768 | valid_balanced_accuracy: 0.67398 | valid_accuracy: 0.67438 |  0:26:59s
epoch 91 | loss: 0.58829 | train_auc: 0.75677 | train_balanced_accuracy: 0.68799 | train_accuracy: 0.68799 | valid_auc: 0.74075 | valid_balanced_accuracy: 0.67359 | valid_accuracy: 0.67359 |  0:27:16s
epoch 92 | loss: 0.58346 | train_auc: 0.75556 | train_balanced_accuracy: 0.68798 | train_accuracy: 0.68803 | valid_auc: 0.73964 | valid_balanced_accuracy: 0.67228 | valid_accuracy: 0.67233 |  0:27:34s
epoch 93 | loss: 0.58979 | train_auc: 0.74241 | train_balanced_accuracy: 0.67447 | train_accuracy: 0.67469 | valid_auc: 0.73021 | valid_balanced_accuracy: 0.66523 | valid_accuracy: 0.66541 |  0:27:53s
epoch 94 | loss: 0.58901 | train_auc: 0.73722 | train_balanced_accuracy: 0.67225 | train_accuracy: 0.67225 | valid_auc: 0.72547 | valid_balanced_accuracy: 0.66591 | valid_accuracy: 0.66588 |  0:28:13s

Early stopping occurred at epoch 94 with best_epoch = 74 and best_valid_accuracy = 0.678
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/pytorch_tabnet/callbacks.py:172: UserWarning: Best weights from best epoch are automatically used!
  warnings.warn(wrn_msg)
[CV 5/5; 69/69] END classifier__estimator=TabNetClassifierTuner(n_d=8, n_a=8, n_steps=3, gamma=1.3, cat_idxs=[], cat_dims=[], cat_emb_dim=1, n_independent=2, n_shared=2, epsilon=1e-15, momentum=0.02, lambda_sparse=0.001, seed=0, clip_value=1, verbose=1, optimizer_fn=<class 'torch.optim.adam.Adam'>, optimizer_params={'lr': 0.02}, scheduler_fn=None, scheduler_params={}, mask_type='sparsemax', input_dim=None, output_dim=None, device_name='auto', n_shared_decoder=1, n_indep_decoder=1), classifier__estimator__clip_value=1, classifier__estimator__mask_type=entmax, classifier__estimator__momentum=0.4, classifier__estimator__optimizer_fn=<class 'torch.optim.adam.Adam'>, classifier__estimator__optimizer_params={'lr': 0.001}, classifier__estimator__scheduler_fn=<class 'torch.optim.lr_scheduler.StepLR'>, classifier__estimator__scheduler_params={'step_size': 10, 'gamma': 0.95}, classifier__estimator__seed=42, classifier__estimator__verbose=1;, score=0.677 total time=28.3min
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/model_selection/_validation.py:378: FitFailedWarning: 
10 fits failed out of a total of 345.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
10 fits failed with the following error:
Traceback (most recent call last):
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/sklearn_tuner/model_selection_tuner/_validation_tuner.py", line 178, in _fit_and_score_tuner
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/pipeline.py", line 382, in fit
    self._final_estimator.fit(Xt, y, **fit_params_last_step)
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/clf_switcher.py", line 20, in fit
    self.estimator.fit(x, y)
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/tree/_classes.py", line 969, in fit
    super().fit(
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/tree/_classes.py", line 265, in fit
    check_scalar(
  File "/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/utils/validation.py", line 1480, in check_scalar
    raise ValueError(
ValueError: min_samples_split == 1, must be >= 2.

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/home/externo/rafaelrm/algoritmos/dev/precoce-ms-classification/.venv-precoce-ms/lib/python3.8/site-packages/sklearn/model_selection/_search.py:953: UserWarning: One or more of the test scores are non-finite: [0.63411547 0.70026672 0.69679196 0.69752224 0.69462648 0.70026672
 0.69679196 0.69752224 0.69462648        nan 0.63726337 0.66093377
 0.67324726        nan 0.64464151 0.66342664 0.67299537 0.66523967
 0.66420715 0.66591954 0.6649123  0.6652145  0.66501306 0.66534042
 0.66534043 0.66450939 0.66612106 0.66602023 0.70165175 0.68792843
 0.70381744 0.73292707 0.7346897  0.73453858 0.73388398 0.73521853
 0.73496669 0.70550473 0.70701552 0.7059327  0.70623491 0.70784661
 0.70900488 0.70759469 0.70686442 0.69336708 0.68923779 0.66257053
 0.6884065  0.68833122 0.66463544 0.69140313 0.68984191 0.67082961
 0.6905721  0.69147866 0.67002403 0.69404709 0.69235999 0.67631977
 0.69598597 0.69336727 0.67616868 0.69558306 0.6929895  0.67553909
 0.69263712 0.69369462 0.67299588]
  warnings.warn(
--------------------- RESULTS ---------------------

CSV gerado com sucesso em: ./runs/results/cv_results-19-02-2023_13:10:21.csv.
Function generate_new_csv Took 0:00:00.045630

Cross validation results:
    mean_fit_time  std_fit_time  mean_score_time  std_score_time  ... split4_test_score mean_test_score std_test_score rank_test_score
35       3.343783      0.231869         0.966947        0.062244  ...          0.733191        0.735219       0.002361               1
36       5.340682      0.050882         1.569046        0.017838  ...          0.731302        0.734967       0.002443               2
32       3.551769      0.269051         0.978802        0.029329  ...          0.732435        0.734690       0.001967               3
33       6.001298      0.499029         1.699588        0.025874  ...          0.732183        0.734539       0.002601               4
34       1.015258      0.025536         0.241535        0.007723  ...          0.734702        0.733884       0.004669               5
31       0.868259      0.079525         0.209262        0.005696  ...          0.730169        0.732927       0.002728               6
42       0.644572      0.040760         0.024918        0.002029  ...          0.705993        0.709005       0.002122               7
41       0.436639      0.035317         0.026849        0.004706  ...          0.707127        0.707847       0.002552               8
43       0.869832      0.060190         0.027148        0.003352  ...          0.707630        0.707595       0.001906               9
38       0.697094      0.088340         0.024654        0.001830  ...          0.704860        0.707016       0.001952              10
44       1.087365      0.025245         0.031324        0.003322  ...          0.704357        0.706864       0.001416              11
40       1.101840      0.055962         0.032245        0.003119  ...          0.706749        0.706235       0.000466              12
39       0.855250      0.055670         0.025672        0.001704  ...          0.703349        0.705933       0.001835              13
37       0.454213      0.053892         0.030365        0.001547  ...          0.705742        0.705505       0.002355              14
30      20.568707      6.005946         0.070171        0.006927  ...          0.719088        0.703817       0.009991              15
28      14.661269      2.986313         0.042261        0.008665  ...          0.700957        0.701652       0.003667              16
5        0.267556      0.012176         0.717599        0.071674  ...          0.702090        0.700267       0.005121              17
1        0.265375      0.033553         0.820702        0.118105  ...          0.702090        0.700267       0.005121              17
7        0.268220      0.009728         0.783032        0.051360  ...          0.701209        0.697522       0.003509              19
3        0.268692      0.021714         0.805289        0.071304  ...          0.701209        0.697522       0.003509              19
2        0.263636      0.017731         0.767683        0.043706  ...          0.696676        0.696792       0.002874              21
6        0.266603      0.007223         0.694995        0.040765  ...          0.696676        0.696792       0.002874              21
60    1275.955802    278.263808         6.133929        0.559089  ...          0.695669        0.695986       0.004018              23
63    1316.445101    320.254962         5.784002        0.439539  ...          0.700453        0.695583       0.005925              24
8        0.267127      0.010676         0.764637        0.043288  ...          0.700201        0.694626       0.005209              25
4        0.269394      0.007479         0.820855        0.023645  ...          0.700201        0.694626       0.005209              25
57    1248.764019    145.338120         6.133760        0.318975  ...          0.687736        0.694047       0.006387              27
67    1322.414804    270.394634         5.860685        0.421669  ...          0.688492        0.693695       0.005919              28
61    1254.676723     84.968940         5.672700        0.433567  ...          0.690884        0.693367       0.004613              29
45    1315.660382    316.474692         5.359452        0.571857  ...          0.693150        0.693367       0.003308              30
64    1279.433595     63.725266         5.933778        0.166257  ...          0.689373        0.692989       0.003720              31
66    1128.640004    229.596048         5.625095        0.513301  ...          0.697683        0.692637       0.005485              32
58    1214.687580    131.118687         5.570681        0.226412  ...          0.689751        0.692360       0.004139              33
55    1733.689357    208.009687         5.864477        0.444757  ...          0.691136        0.691479       0.000815              34
51    1279.962995    207.512978         5.817426        0.195310  ...          0.694535        0.691403       0.002338              35
54    1260.477150    206.725588         5.909751        0.386026  ...          0.689373        0.690572       0.001786              36
52    1405.968817    295.323004         5.975755        0.307109  ...          0.687988        0.689842       0.006971              37
46    1302.650734    330.112995         5.591695        0.332120  ...          0.689877        0.689238       0.008434              38
48    1056.980998    175.893407         5.879883        0.475259  ...          0.695039        0.688407       0.004580              39
49    1232.069442    297.197233         5.895313        0.357158  ...          0.689877        0.688331       0.007067              40
29       6.325700      2.764149         0.039973        0.003952  ...          0.688995        0.687928       0.006367              41
59    1459.639046    578.566352         5.727275        0.436613  ...          0.683581        0.676320       0.006287              42
62    1464.388251    580.105048         6.065624        0.235069  ...          0.683833        0.676169       0.006260              43
65    1460.197645    589.082173         5.624168        0.133879  ...          0.683959        0.675539       0.007124              44
12       0.414911      0.054913         0.030765        0.003279  ...          0.664694        0.673247       0.005543              45
68    1305.578266    273.971313         5.437203        0.276454  ...          0.677159        0.672996       0.007389              46
16       0.459880      0.015266         0.031762        0.002841  ...          0.665198        0.672995       0.005441              47
53    1978.221192    860.100701         5.923285        0.469086  ...          0.674641        0.670830       0.013248              48
56    1652.579176    263.743355         5.356552        0.246651  ...          0.668094        0.670024       0.004955              49
26       3.493642      1.379192         0.032488        0.003353  ...          0.665198        0.666121       0.003022              50
27      12.038626      4.641201         0.085528        0.008715  ...          0.663561        0.666020       0.003233              51
19       0.319482      0.065601         0.021473        0.002368  ...          0.666331        0.665920       0.003734              52
24       0.285024      0.018360         0.024597        0.003373  ...          0.664946        0.665340       0.002892              53
23       0.501118      0.034630         0.023871        0.002193  ...          0.664946        0.665340       0.002926              54
17       0.176699      0.019548         0.025581        0.007072  ...          0.662679        0.665240       0.003214              55
21       0.383444      0.067867         0.019513        0.000988  ...          0.664316        0.665214       0.002967              56
22       0.246809      0.005087         0.020586        0.001688  ...          0.664316        0.665013       0.002711              57
20       0.207831      0.013359         0.019553        0.002236  ...          0.663183        0.664912       0.003078              58
50    1642.442301    914.706983         5.842995        0.233287  ...          0.674641        0.664635       0.010073              59
25       6.994272      1.665189         0.052153        0.012348  ...          0.663309        0.664509       0.002256              60
18       0.150908      0.006062         0.019354        0.000799  ...          0.662176        0.664207       0.003251              61
15       0.500072      0.007972         0.031975        0.002230  ...          0.659783        0.663427       0.004558              62
47    1348.469562    481.156971         5.615459        0.106057  ...          0.664316        0.662571       0.008373              63
11       0.424211      0.010075         0.028735        0.003100  ...          0.653488        0.660934       0.006209              64
14       0.638101      0.074564         0.032295        0.001988  ...          0.647444        0.644642       0.002043              65
10       0.533420      0.067636         0.033614        0.001738  ...          0.630446        0.637263       0.005453              66
0        0.793979      0.420140         0.583660        0.228946  ...          0.640141        0.634115       0.005572              67
9        0.122944      0.009306         0.000000        0.000000  ...               NaN             NaN            NaN              69
13       0.117335      0.005872         0.000000        0.000000  ...               NaN             NaN            NaN              68

[69 rows x 43 columns]
Object saved in file: ./runs/best_estimators/best_pipe-19-02-2023_13:10:22.joblib
Object saved in file: ./runs/best_estimators/best_estimator-RandomForestClassifier-19-02-2023_13:10:24.joblib
Best estimator: RandomForestClassifier(criterion='entropy', n_estimators=700, n_jobs=-1,
                       random_state=42)
Object saved in file: ./runs/encoders_scalers/column_transformer-19-02-2023_13:10:26.joblib
Internal CV score obtained by the best set of parameters: 0.7352185251673398
Best params: {'classifier__estimator': RandomForestClassifier(criterion='entropy', n_estimators=700, n_jobs=-1,
                       random_state=42), 'classifier__estimator__criterion': 'entropy', 'classifier__estimator__n_estimators': 700, 'classifier__estimator__n_jobs': -1, 'classifier__estimator__random_state': 42}
Scorer function: make_scorer(accuracy_score)
The number of CV splits: 5
Seconds used for refitting the best model on the whole dataset: 10.103759050369263
Whether the scorers compute several metrics: False
The number of features when fit is performed: 22
Names of features seen during fit: ['Tipificacao' 'QTD_ANIMAIS_LOTE' 'Peso'
 'QuestionarioClassificacaoEstabel' 'ILP' 'IFP' 'ILPF'
 'QuestionarioPossuiOutrosIncentiv' 'QuestionarioFabricaRacao'
 'regua de manejo' 'identificacao individual' 'rastreamento SISBOV'
 'participa de aliancas mercadolog' 'QuestionarioPraticaRecuperacaoPa'
 'Confinamento' 'Suplementacao_a_campo' 'SemiConfinamento' 'tot3m_Chuva'
 'med3m_formITUinst' 'med3m_NDVI' 'med3m_preR_milho' 'med3m_preR_boi']

!!!>> When you observe high training accuracy, but low test accuracy, it is likely that you encountered overfitting problem.
Training set score: 1.0
Test set score: 0.7416658273743579

CSV gerado com sucesso em: ./runs/results/grid_search_results-19-02-2023_13:10:30.csv.
Function generate_new_csv Took 0:00:00.007120

*****INICIO CONFUSION MATRIX DISPLAY******
Figure confusion_matrix_display-19-02-2023_13:10:34.png saved in ./plots/ directory.
*****FIM CONFUSION MATRIX DISPLAY******

Function confusion_matrix_display Took 0:00:00.263763


--- Test data performance ---
Test Acurácia: 0.7416658273743579
Test Acurácia Balanceada: 0.741650456482045
Test Revocação: 0.7438
Test Micro Revocação: 0.7416658273743579
Test Macro Revocação: 0.741650456482045
Test Precisão: 0.7433539876074355
Test Micro Precisão: 0.7416658273743579
Test Macro Precisão: 0.741652633267786
Test F1: 0.7435769269219235
Test Micro F1: 0.7416658273743579
Test Macro F1: 0.7416514771595919
Test Coeficiente Kappa: 0.48330300149197236
Test Coeficiente de Correlação de Matthews: 0.4833030897449289
Test Log Loss: 0.5180291450482938
Test ROC AUC Score: 0.8231595252586732

CSV gerado com sucesso em: ./runs/results/performance_results-19-02-2023_13:10:34.csv.
Function generate_new_csv Took 0:00:00.001403

              precision    recall  f1-score   support

           0       0.74      0.74      0.74      4929
           1       0.74      0.74      0.74      5000

    accuracy                           0.74      9929
   macro avg       0.74      0.74      0.74      9929
weighted avg       0.74      0.74      0.74      9929


CSV gerado com sucesso em: ./runs/results/classification_report-19-02-2023_13:10:34.csv.
Function generate_new_csv Took 0:00:00.000964

Function run_grid_search Took 1 day, 22:06:22.882705

